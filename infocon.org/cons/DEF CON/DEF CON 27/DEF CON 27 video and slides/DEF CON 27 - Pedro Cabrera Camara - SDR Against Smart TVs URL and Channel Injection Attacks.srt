00:00:00.033,00:00:05.272
>>Alright so please give a warm
welcome to, Pedro Cabrera who is
talking about SDR against smart

00:00:05.272,00:00:10.277
TVs, URL, and channel injection
attacks. [Applause] >>Thank you,
thank you very much, uh yes I am

00:00:16.350,00:00:22.789
Pedro Cabrera the founder of my
own company, Elthon Shield, and
I am in love with uh, software

00:00:22.789,00:00:28.328
definitive radio as you are uh,
going to see in this
presentation, uh I’ve been uh

00:00:28.328,00:00:34.668
working long time with, uh
network mobile operators doing
pen testing on uh well, doing

00:00:34.668,00:00:40.407
some kind of a security
research. And, uh, also in love
with drones, and drone hijacking

00:00:40.407,00:00:46.647
attacks, I love them. Ham radio
and, and drones photography. I
don’t like to talk about me, I

00:00:46.647,00:00:52.452
prefer to talk about this
presentation. I divided five
main uh sections. I uh would

00:00:52.452,00:00:58.992
like to introduce you a little
bit uh the HbbTV, uh system. And
how we can receive digital

00:00:58.992,00:01:04.431
television in our Linux box.
Once we learn how to receive
television I think we were able

00:01:04.431,00:01:10.237
to move forward into the channel
injection. We will transmit our
own channel. We will play a

00:01:10.237,00:01:15.175
little bit with the different uh
receiving stations, antennae
facilities and so on playing

00:01:15.175,00:01:20.180
with the, attacks code or impact
and finally, we will move to a
worse URL injection attack

00:01:22.583,00:01:27.154
targeting the smart TV browser
and of course, why not,
conclusions. So HbbTV uh, stands

00:01:27.154,00:01:29.723
for Hybrid broadband and
broadcast television. It’s like
kind of think we are, everyday

00:01:29.723,00:01:34.728
hearing about uh customized
hybridization. Television has
been there from since 1940 and

00:01:44.938,00:01:50.344
they are just passive boxes that
receive signals from the
broadcast signal and make their

00:01:50.344,00:01:55.349
magic to turning to video, but
in 2009, waahoop, thank you,
sorry European uh, came with a

00:02:00.654,00:02:06.493
project merging two existing
projects, German and French
project to say hey, why not to

00:02:06.493,00:02:11.498
make interaction- interactivity
television so we can offer uh,
customize advertisement to the

00:02:14.501,00:02:19.506
audience. And how they achieved
this design, if you, uh take a
look at the right of the screen,

00:02:22.209,00:02:28.615
you will see a red by-direction
arrow, because the smart TV
receives from the broadcast

00:02:28.615,00:02:33.620
signal, an URL, a URL sorry, and
will send its uh get uh request
to this web server, nothing new

00:02:38.692,00:02:44.097
it’s just a webserver. But
through this webpage it’s called
in the standard it’s called an

00:02:44.097,00:02:49.102
application, television and
webserver will interact. So, in
that case, the, audience who are

00:02:51.238,00:02:56.243
watching TV, with their remote
they’re able able sorry to
interact with uh, TV- TV

00:02:58.845,00:03:04.618
channel. And let me introduce
you a very uh generic, this is
of course our simplification of

00:03:04.618,00:03:10.824
our generic TV uh, network
diagram. I want just to share
you the key elements, generally

00:03:10.824,00:03:17.230
the contents it’s uh at the
left, think about reporters
traveling with these vans with

00:03:17.230,00:03:22.235
uh huge satellites dish on top,
they are transmitting uh content
of real-time towards through uh

00:03:24.371,00:03:29.643
acquisition network to the main
head-end, they are receiving
content from TV studios,

00:03:29.643,00:03:35.649
reporters, third parties,
whatever. They need to take all
this content and process, let’s

00:03:35.649,00:03:41.755
say, to be ready to be available
in all the TV’s, if we are
talking about the national TV

00:03:41.755,00:03:48.728
channel, all the TV’s in the
country uh must receive this, uh
signal. So this is made through

00:03:48.728,00:03:54.468
a distribution network, see now,
it’s processed and then
delivered to the whole country

00:03:54.468,00:03:59.473
through this distribution
network. Okay, and Hbbtv relies
in the digital video broadcast

00:04:02.342,00:04:08.515
standard, there are three
different flavors, satellite,
terrestrial and cable. We were

00:04:08.515,00:04:14.654
curious in the, we are talking
about the smart TV’s at home and
we were curious in the

00:04:14.654,00:04:19.226
terrestrial 1, DVB-T. I don’t
know why but in Spain we like to
rename things with a different

00:04:19.226,00:04:24.231
name, so we renamed these as
TDT. uh of course if anyone is
going to look any specification

00:04:26.800,00:04:31.805
it’s nothing about TDT, it’s DVB
terrestrial, DVB-T. And they are
using uh these parameters they

00:04:34.107,00:04:38.512
are very low parameter. It’s
country could uh have different
implementations, there are

00:04:38.512,00:04:44.551
different modulations, different
brandwidth, different uh, guard
interval and uh so on but I just

00:04:44.551,00:04:49.556
want uh to make sure that uh all
these uh parameters will be in
account for later

00:04:49.556,00:04:55.996
configurations. And if you have
been playing around with RTL-SDR
it is really nice that they are

00:04:55.996,00:05:02.736
at somehow, they are related in
history. When I started to play
with RTL-SDR, uh of course I

00:05:02.736,00:05:08.074
think all of us we are dealing
with spectrum analysis and there
is a maximum of these sample

00:05:08.074,00:05:14.481
rate. We can not go in below 2
point 4 of mega samples per
second, it’s supposed that some

00:05:14.481,00:05:19.486
people achieve higher value 3,
but wait a- wait a minute I just
told you that the channel

00:05:21.788,00:05:26.793
bandwidth is 8 megahertz, how
this devices are able to treat 8
megahurtz channels bandwidth,

00:05:30.197,00:05:34.534
but when I- we want to play with
them there are only 2 mega
samples per second or 2

00:05:34.534,00:05:40.440
megahurtz it’s the same. I
always wonder like, what? Why
because of that? So in order to

00:05:40.440,00:05:46.846
understand that I want to show
you this again, it’s a
simplification of DVB-T receiver

00:05:46.846,00:05:53.220
diagram there are 2 main, uh,
elements, the tuner is the first
element that we will take data

00:05:53.220,00:05:59.159
from the analog to digital
converter. When you do look on
the internet for this RTL-SDR

00:05:59.159,00:06:04.965
devices I’m sure you will
realize there are different
tuners, Rafael 820 or Elonix

00:06:04.965,00:06:09.970
8000 uh, sorry E 4000, this is
the tuner, where we select our
frequency and we will give this

00:06:12.973,00:06:17.978
frequency to the next element,
it’s the DeModulator. And Eric
Fry in 2010 realized that if we

00:06:20.680,00:06:26.820
change this device driver we are
able to bypass the hardware
deModulator. Hardware

00:06:26.820,00:06:32.792
demodulator is able to treat
this 8 megahertz single, and of
course, demodulate generating

00:06:32.792,00:06:39.232
this MPEG 2 transport a stream
signal that finally will be the
multiplexer into audio video

00:06:39.232,00:06:44.904
metadata if what we are
wondering is to watch TV but
they find out that changing the

00:06:44.904,00:06:49.709
drivers we are able to bypass
this hardware deModulator and
the Realtek RTL2832 it’s able to

00:06:49.709,00:06:56.149
give us raw IQ sample, this is
what we are using, and because
of this uh, different

00:06:56.149,00:07:02.589
engineering mode, let’s call
this our secret mode or user
mode the chip set is not going

00:07:02.589,00:07:09.429
to give us anymore 8 megahertz
bandwidth, this is this kind of
limit between 2 point 4 and 3

00:07:09.429,00:07:16.002
point 2 mega samples per second
coming from. If you confuse the
uh demodulator this is a

00:07:16.002,00:07:21.007
standard diagram of all the
elements in charge of the signal
in order to give us an MPEG 2

00:07:23.176,00:07:28.982
transport stream. And we’re
going, we would like to do this
by our own, in our computer

00:07:28.982,00:07:33.987
using GNU radio. That’s what
Bogdan Diaconescu create in
2013, in his project GR-DVBT

00:07:37.791,00:07:42.796
after 2 years, I think 2015, he
donates this project to the GNU
radio project under the GR-DVBT

00:07:45.665,00:07:50.303
much more, it’s not just the
DVB-T there are much more
digital television standards we

00:07:50.303,00:07:55.308
can receive and transmit. So, uh
also there is also, sorry Ron
Economos he create DTV- utils,

00:07:58.978,00:08:05.418
with these utils we are able to
transmit DVB-T with our blade RF
and it is really easy to allow

00:08:05.418,00:08:12.425
this script to use another kind
of SDR generic SDR, like hackRF,
Lime SDR and so on. So all the

00:08:12.425,00:08:18.298
parameters if you remember at
the beginning of the DVB-T or
Spanish TDT in this case we need

00:08:18.298,00:08:22.602
to configure all these
workflows, it’s not just a
standard plug and play that we

00:08:22.602,00:08:28.775
run the GNU radio diagram and we
will see television in our
computer. We need to adapt these

00:08:28.775,00:08:35.148
script with our implementation
or complementation of this
terrestrial television. We are

00:08:35.148,00:08:40.387
finishing this introduction,
it’s just to let uh these
elements and come on what is

00:08:40.387,00:08:46.226
this multi-place we are talking
about digital television. There,
but changed from analog, the

00:08:46.226,00:08:52.298
previous one is if you realize
in this frequency when you take
your channel list, there are a

00:08:52.298,00:08:56.870
lot of different channels and
stations sharing the same
frequency because they are multi

00:08:56.870,00:09:03.143
plexil in the same signal, if
you, if you use hackRF and we
tune into this uh signal

00:09:03.143,00:09:09.282
frequency, we will see just a
bunch of 8 megahertz signal and
inside there are the different

00:09:09.282,00:09:15.555
channel station multiplexes that
does what it mean. If you, uh,
we use the hackR F sweep utility

00:09:15.555,00:09:22.328
this very nice view of the whole
TBS spectrum we can take the
whole 400 megahertz and we don’t

00:09:22.328,00:09:27.467
need anymore to go to this web
pages where we have listed this,
uh the TV stations and

00:09:27.467,00:09:32.705
frequencies that this always a
nightmare lot of the different
uh TV manufacturers have

00:09:32.705,00:09:38.578
problems with their channels,
their lower ones or the higher
ones frequency most of the times

00:09:38.578,00:09:44.217
they don’t have problems, sorry
to tune. It’s a different way to
see all these channels in the

00:09:44.217,00:09:50.356
same time. The same can be
achieved using the RTL-SDR, if
you know these utility the RTL

00:09:50.356,00:09:55.361
underscore power, will generate
a CSV file and uh using a python
utility we can transfer into a

00:09:57.964,00:10:03.670
nice image, like this one, so is
the same, same different, sorry
the only difference is the

00:10:03.670,00:10:10.410
hackRF is real-time, and uh RTL
needs to treat this information
offline. But we will generate a

00:10:10.410,00:10:15.415
nice view of whole TV spectrum
and we will find out who is
transmitting on the frequencies.

00:10:17.650,00:10:23.923
And let me finish with this, eh,
background of hijacking, we want
to, to do a channel injection,

00:10:23.923,00:10:28.928
or uh hijack television, we
look, uh backward to the
history, there are two uh nice,

00:10:31.030,00:10:36.035
uh occasions in the past, in
1986 and 1987 Captain Midnight
and Max Headroom this taken from

00:10:39.672,00:10:44.677
the greek paper, of course. This
two uh real cases of TV channel
hijacking were in the United

00:10:47.113,00:10:52.118
States one is the, the first one
was a tele-tel signal being uh
impersonated and the 1987 was uh

00:10:55.455,00:11:01.961
a two different interruptions,
with a man with this mask, uh
singing and doing a strange

00:11:01.961,00:11:08.535
things. Also in the Lebanon in
2006, uh anti-Hezbollah
propaganda was being uh used to

00:11:08.535,00:11:14.073
what- impersonate. And if we
accuse with the smart TV’s, what
went on so far. Probably you

00:11:14.073,00:11:21.014
will remember weeping angels CIA
Wikileaks, that uh you ca, we
can turn Samsung smart TV into a

00:11:21.014,00:11:26.019
microphone. But this attack
requires local access in order
to do this exploitation. 2015,

00:11:28.288,00:11:33.293
uh theoretical attacks about
this uh hijacking uh start to
roll and two years ago Rafael

00:11:36.062,00:11:42.335
Scheel in 2017 hacking a smart
tv presentation so how to
exploit two different

00:11:42.335,00:11:48.808
vulnerabilities of two different
Samsung smart TV’s. I think one
was javascript umm flash video

00:11:48.808,00:11:53.813
vulnerabilities, but here you
see, real was not uh SDL was a
proprietary uh transceiver to

00:11:57.417,00:12:02.722
transmit his uh signal, his
poison signal let’s call it.
Using a windows software

00:12:02.722,00:12:09.429
everything proprietary that was
uh one of main motivations to
create these, I’m not excuses my

00:12:09.429,00:12:14.000
work, my research in
manufacturers, specific
manufactur - manufacturers

00:12:14.000,00:12:20.473
sorry, or zero-day. This is to
create an open source
methodology so we can play with

00:12:20.473,00:12:26.546
our SDRL devices not just any of
them, not just one manufacturer
hackRF letter F whatever, with

00:12:26.546,00:12:31.551
open source software in order to
research our smart TV’s
vulnerabilities. So, let’s move

00:12:33.820,00:12:39.792
forward with our first attack,
the channel injection. What we
would like to do now is to

00:12:39.792,00:12:44.797
transmit our own TV signal, so
we are going to impersonate with
our uh equipment, with our

00:12:46.933,00:12:51.938
laptop the whole TV network. We
will transmit with our SDRL
device. We can transmit using

00:12:55.775,00:13:00.713
the radio or we can transmit
using the wire. Ok. How we
achieve this, how we accomplish

00:13:02.749,00:13:08.354
this mission. We need to take
our poison video file and we
need to put some ingredients

00:13:08.354,00:13:13.993
because the video files needs to
add some parameters, some
metadata in order of the

00:13:13.993,00:13:18.998
television uh, demodulator to
take this signal as a valid
ones. Once we’ve forged this uh

00:13:21.534,00:13:26.539
valid transport a stream we can
broadcast the transport stream
with a gr-dtv utility and of

00:13:28.574,00:13:34.947
course we will be on air. In
order to take this or generate
this transport stream video,

00:13:34.947,00:13:41.521
this poison file, we could use
as we are just talking about uh
video or channel injection we

00:13:41.521,00:13:46.392
can use a very simple attack
using ffmpeg. We could take any
video file with any colleague

00:13:46.392,00:13:52.899
and output it in a transport
stream and put all the
parameters you have uh below

00:13:52.899,00:13:59.739
network ID and stream sorry,
stream ID, service ID and so on.
We need to take this exactly the

00:13:59.739,00:14:05.712
same parameters as the valid
channel we are, we want to
replace or to impersonate. Or we

00:14:05.712,00:14:10.983
can use openCaster, openCaster
is much more complicated, it’s
not a common line, it’s python

00:14:10.983,00:14:17.056
script, but we have all the
parameters later off for the URL
injection attack, we will need

00:14:17.056,00:14:22.061
openCaster. Again we need to
modify all these 4 parameters
and how to take these parameters

00:14:25.098,00:14:31.604
when we face our face, our first
sorry, project we didn’t know
this parameter values, but using

00:14:31.604,00:14:38.411
caffing for example and IS
dexhub utility to watch tv on
linux double clicking on uh the

00:14:38.411,00:14:44.016
channel station we came up, this
small window and we will show up
not only the frequency but the

00:14:44.016,00:14:50.289
network ID, the stream ID all
the parameters we need to
impersonate are there. If we

00:14:50.289,00:14:55.728
don’t like if you don’t like
dexhub graphical utilities we
can use DVBv5 scan inside the

00:14:55.728,00:15:00.666
DVBv5 tools it’s just common
line and will create a text file
where, once per uh channel and

00:15:04.370,00:15:11.010
all the parameters inside, so
it’s really easy we take all
this parameters we forge, our

00:15:11.010,00:15:16.015
own, transport a stream. And,
that’s the original television
antennae the white one, bladeRF

00:15:21.487,00:15:26.492
you will see a small antenna.
I’m ready, this is not uh still
uh transmitting, it’s waiting.

00:15:28.494,00:15:33.499
We saw we’re watching TV Spanish
24 hour news channel. So we will
start this mission, Pedro on

00:15:37.170,00:15:42.175
air. Here we are injecting our
own channel. >>[applause] >>Once
we stop the attack the real

00:15:49.215,00:15:54.220
channel came back because we are
impersonating, impersonating
sorry the same parameters. So we

00:15:56.289,00:16:01.227
could do uh, sorry, uh
persistent attack or just quick
attack to do, uh, I don’t know,

00:16:04.964,00:16:09.969
to do uh, to show our neighbors
or fathers or family or whatever
some, kidding. But what if we

00:16:12.538,00:16:18.544
want not just attack, uh this is
the most simple attack but
thinking about how this antennas

00:16:18.544,00:16:23.783
distribution uh, is not another
word, but how antennae
distribution works we could

00:16:23.783,00:16:30.289
think, because radio, uh is
sometimes complicated and
expensive you want to attack

00:16:30.289,00:16:36.128
some uh distant house or
whatever, we need to add on top
of this uh bladeRF propeller

00:16:36.128,00:16:41.968
amplifiers filter directional
antennae and this is going be a
chaos. But sometimes it is much

00:16:41.968,00:16:47.673
more easier to identify our
antennae facility. Antennas
facilities distribute is the

00:16:47.673,00:16:52.812
signal once it has been received
from the antennae through the
whole, think about a huge

00:16:52.812,00:16:57.817
building there’s only one or two
antennas on the floor and they
are distributing the same,

00:16:57.817,00:17:03.890
distributing an amplifier the
same signal through the whole
building or residential area. So

00:17:03.890,00:17:08.895
we can poison all the receiving
area or our target. In order to
do that we need to study how

00:17:12.164,00:17:19.005
this uh, antennae facility has
been designed, usually this is
the most simple and easy ones.

00:17:19.005,00:17:25.444
We see two wires coming from the
top they are the terrestrial and
satellite antenna, and there

00:17:25.444,00:17:30.449
it’s been splitted into three
outputs, one per each house.
More complex uh, uh facilities

00:17:33.452,00:17:39.492
has a huge uh amplifiers because
in this case because this a very
big residential area and

00:17:39.492,00:17:44.830
antennae facility was really
outside in a huge tower so they
need amplifier signal coming

00:17:44.830,00:17:50.603
from the antennae and then it’s
been divided with this two
splitters. This is our cascade

00:17:50.603,00:17:56.342
installation, this is a splitter
with each model of the
residential uh, area has each

00:17:56.342,00:18:02.315
own different model with again
new amplifier and new splitter.
If we realize attack, sorry if

00:18:02.315,00:18:07.320
we design, if we inject our
channel at the beginning we will
poison the whole residential

00:18:09.522,00:18:14.527
area. If we poison our signal uh
in the house that we want to
attack, we just attacking one

00:18:16.562,00:18:21.567
house. I want to show you, how
we can do that. This is a very
small installation, there are

00:18:23.903,00:18:28.908
just two televisions. What is
really. Sorry. Here we are. Yes.
There are two televisions. I’m

00:18:39.385,00:18:44.624
removing the original wire
coming from the roof with the
original antennae, so signal

00:18:44.624,00:18:49.628
will go out, we will lost
signal. You will see that
television is 3D is uh event in

00:18:51.764,00:18:58.437
different from when bladeRF is
already transmitting, oh no, no
sorry it’s not already, I’m just

00:18:58.437,00:19:03.376
going to plug our poison signal
and now we are transmitting with
the ur- DVB util sorry, here I

00:19:06.278,00:19:11.651
am first one is receiving my
signal, I don’t know why, first
of all and the second but they

00:19:11.651,00:19:16.655
are synchronized if you realize.
Even if one takes more time,
they uh doing this the

00:19:18.724,00:19:23.729
demodulation process not at the
same speed, but I will remove
again the wire. And when the

00:19:26.499,00:19:31.504
original signal came, both of
this two televisions will again
be synchronized I mean content.

00:19:35.908,00:19:41.947
I want just to show you that
this is not photoshopped or
video editing, proof of concept

00:19:41.947,00:19:48.254
that the signal cames in the
same time. Proving that we can
attack more one televisions in

00:19:48.254,00:19:53.259
one attack. And of course we are
always talking about drone
attacks. It’s really uh easy to

00:19:56.128,00:20:01.701
attack an antennae if we are
using a drone because we can
hover in the antennae facility

00:20:01.701,00:20:06.705
and we don’t need to get inside
the building and uh get access
to the building or whatever, so

00:20:06.705,00:20:12.745
I want to test how easy is to
rent a drone, because I don’t
want to use my drone for that

00:20:12.745,00:20:18.117
[speaker laughs] who knows and I
have a very huge uh problem, I
really don’t know the amount,

00:20:18.117,00:20:22.988
how much weight can carry one of
these commercial drones, these
drones is a phantom three

00:20:22.988,00:20:29.762
phantom four. They are not
manufactured to carry any load.
So there is no specifications

00:20:29.762,00:20:34.967
from the manufacturer about the
amount of weight they are able
to carry. But we have a lot of

00:20:34.967,00:20:41.373
the videos on youtube of crazy
people taking these buckets full
of water with rope and they

00:20:41.373,00:20:48.180
start to fly they are uh
measuring uh 500 grams, one
kilograms they are really crazy.

00:20:48.180,00:20:53.185
So after seeing a lot of these
crazy videos and finding this
web page, I get myself a limit,

00:20:55.287,00:21:00.226
300 grams that was the weight I
need for my payload and that
fits perfectly with a hackRF, a

00:21:04.296,00:21:09.301
power bank and Odroid C2. I was
not uh very impossible to do
this attack with a raspberry P3.

00:21:11.370,00:21:17.076
I-I really tried believe me a
lot of times but doesn’t have a
computational resource enough to

00:21:17.076,00:21:22.848
do our transmission constantly
in time and we want our victim
to really realize and see our

00:21:22.848,00:21:27.853
video, so I am using a Odroid C2
and all of this stuff is just
300 grams. So we need to do this

00:21:31.357,00:21:36.362
design to really stick and not
to move in the drone for the
dynamic flight if we are flying

00:21:38.397,00:21:43.502
with the components moving our
gravity center is going to be
moving and for sure the drone is

00:21:43.502,00:21:50.142
going to finish on the floor and
crashing. So, take this 3
elements stick them very good,

00:21:50.142,00:21:55.781
adapt our scripts because Odroid
C2 is not able to generate
content in real-time, everything

00:21:55.781,00:22:00.719
the Odroid is transmitting the
already poisoned media generated
in another computer. And after a

00:22:03.088,00:22:08.093
few days working. I think there
should be sound in this video.
Thank you guys, this is my

00:22:19.271,00:22:24.977
favorite one, sorry. [music]
Here we are getting ready for
the flight, touching everything

00:22:24.977,00:22:43.829
[music] you will see now I am
going to use a lot of cameras to
show this demonstration we are

00:22:43.829,00:22:50.769
recording from another drone,
the mothering you will see in
the video. And this uh bottom

00:22:50.769,00:22:57.009
left screen is mobile, it’s
going to get into the house and
we will recording the television

00:22:57.009,00:23:02.748
for you. You will see the
attack, all the stages. As much
as I am getting close to the

00:23:02.748,00:23:09.822
antennae my poison signal is
going to person- impersonate the
original channel. This is from

00:23:09.822,00:23:20.699
the maverick pgi maverick. Also,
believe me it’s not so easy to
hover this antenna. I don’t want

00:23:20.699,00:23:27.840
to get it started, and here we
are getting closer enough to
transmit our poison video.

00:23:27.840,00:23:34.046
[audience applause] Thank you
very much [audience applause]
That is a real drone attack so

00:23:34.046,00:23:39.351
now it’s not just a theoretical
attack it’s a practical attack.
Now let me just uh sum up,

00:23:39.351,00:23:46.025
because these 3 videos are just
proof of concept. I don’t have
any [inaudible] or a private

00:23:46.025,00:23:51.397
company support in order to
demonstrate that these video’s
or these attacks could be done

00:23:51.397,00:23:59.471
much wider not just securing on
one smart TV, because this
television networks uh, they are

00:23:59.471,00:24:04.910
decided, they are a lot of
elements from the heading you
will remember at the beginning.

00:24:04.910,00:24:12.985
The heading once is generate
this transport a stream it’s
been distribute, but in a very

00:24:12.985,00:24:20.626
stupid way, they trust each
other, so if we inject this uh,
poison video, but not in our

00:24:20.626,00:24:25.664
house, if we are able to inject
in the main head end, we will
inject this video to the whole

00:24:25.664,00:24:31.403
country. Of course they need
insider uh, uh not uh attack,
but we need some deep internal

00:24:31.403,00:24:37.209
network knowledge or uh someone
inside of this company that help
us to carry on with this attack

00:24:37.209,00:24:42.147
if we want to confuse the
heading, transmitter centers
they are more, much more easier

00:24:42.147,00:24:48.087
because they are not, there is
no one eh, national one, there
are a lot of transmitter center

00:24:48.087,00:24:53.792
primary ones. And the favorite
ones they are the gap filler.
Gap filler is a very stupid

00:24:53.792,00:24:59.898
repeater they have 2 antennas,
one antennae receives
television, the receives sorry

00:24:59.898,00:25:06.705
the original signal and
amplifies this signal towards
this shallow area. So if we take

00:25:06.705,00:25:12.378
the same drone and we do realize
the same attack and instead of
hovering the antennae we hover

00:25:12.378,00:25:18.450
over the gap filler our signal
is going to be transmitted to
all this area it’s a very nice

00:25:18.450,00:25:24.590
attack, but of course in order
to demonstrate we need some
permission and some someone that

00:25:24.590,00:25:30.662
help us in order to do these
videos that I don’t have, I am
very sorry. Ok, we’ve show, I

00:25:30.662,00:25:37.035
show you how to inject uh just
video, this is the-the the most
funnest attacks but this we

00:25:37.035,00:25:46.111
mentioned at the beginning HbbTV
uses an URL. If we uh, do uh a
ARP poison attack to our smart

00:25:46.111,00:25:53.652
TV we will see that every 5
seconds 5 or to 3 seconds the
smart TV is sending this get

00:25:53.652,00:26:00.159
Http get requests to the other
servers if you will realize they
are just web servers, I don’t

00:26:00.159,00:26:06.198
know why they like to put this
HbbTV dot s and then my name but
anyway they are standard web

00:26:06.198,00:26:13.772
servers. I think this is the way
they are misering our audience,
our, which channels we are

00:26:13.772,00:26:20.145
watching everyone. This is not
an attack just I want to show
you because this is [inaudible]

00:26:20.145,00:26:26.318
how this is work you realize how
television it’s off, I’m just
starting the ARP Poison attack.

00:26:26.318,00:26:35.794
I will put on TV and show you
how these channels are every, 2
seconds 3 seconds with this,

00:26:35.794,00:26:42.668
this audio reginal legit legit
sorry. Http request launa this
is the main national TV channel

00:26:42.668,00:26:49.708
in Spain, and there we are with
this uh, I don’t know what they
call this application red

00:26:49.708,00:26:56.014
button, this a HIbb HbbTV sorry
application called red button.
This is how it should work, and

00:26:56.014,00:27:05.390
what we want to do right now, we
are now taking care of the video
file, but we want to take care

00:27:05.390,00:27:15.133
now it’s uh metadata, a new, a
new parameter in the URL and now
probably we don’t want to inject

00:27:15.133,00:27:21.807
video, if if you think about
this attack I want my victim not
to realize that he is under

00:27:21.807,00:27:28.447
attack. He will continue
watching the original TV we will
do a video replay. He get the

00:27:28.447,00:27:34.086
original video of the original
channel because we are going to
use another SDRL to take the

00:27:34.086,00:27:39.591
original video and we will
inject this original video it
has not been modified but the

00:27:39.591,00:27:46.131
tackle will be the attack sorry
will be in the URL we will
poison only the URL maintaining

00:27:46.131,00:27:53.238
on the the original video. That
can only be done using
openCaster. We need to replicate

00:27:53.238,00:27:59.177
short kind of uh reverse
engineering because we need to
maintain all the original

00:27:59.177,00:28:07.786
parameters of our this uh tv
channel or TV station. And only
thing, the only thing we need to

00:28:07.786,00:28:15.260
modify is this 3 parameters of
the applications, name, root and
path. And let me show you that

00:28:15.260,00:28:22.434
inside the smart TV there are 2
browsers the HbbTV browsers it’s
totally transparent for the user

00:28:22.434,00:28:31.076
and the user browser for sure.
User could open uh hoot or uh
fancy eh browser in order to

00:28:31.076,00:28:37.849
read newspaper or whatever. So
each attack or the attacks I am
going to show you could be meh-

00:28:37.849,00:28:44.823
modified if we want to attack
the HbbTV browser or the user
browser. We know which browser

00:28:44.823,00:28:50.729
we are attacking because of the
user agent. Once we have this
get request in our poison or eh

00:28:50.729,00:28:57.736
the web server, taking care of
the uh, taking a look, sorry of
the use- user agent if you

00:28:57.736,00:29:06.478
realize for the Samsung TV the
first one it’s HbbTV 1 dot 2 dot
1 meaning that we are talking to

00:29:06.478,00:29:12.517
the HbbTV browser and the black
1, the Mozilla is the user
browser both of them leak very

00:29:12.517,00:29:21.727
important information about
manufacturer and model, what
does it mean? That we can scan

00:29:21.727,00:29:29.835
smart TV’s remotely if we just
are listening for this URLS URL
sorry, with our fake

00:29:29.835,00:29:37.843
transmission we are able to scan
for smart TV public IP addresses
model manufacturers and the

00:29:37.843,00:29:45.951
channels, because we could use a
different URL per channel. Let
me show you because there is a

00:29:45.951,00:29:52.524
lot of information, let me show
you, I am going to use 4
terminals. In the upper left is

00:29:52.524,00:30:02.000
the dvbv zap, we will just use
our uh RTL sdrl to tune the
original channel. With the DVB

00:30:02.000,00:30:09.841
snoop I want to take this eh
original video and put uh into
our uh transport the stream

00:30:09.841,00:30:19.918
file. With the bottom left
[speaker laughs] Tscbrmuxer I
will poison only the URL. I will

00:30:19.918,00:30:27.526
maintain all the parameters but
I will just modify the URL and
finally, with the gr-dvbtv I

00:30:27.526,00:30:41.640
will transmit this poison signal
to our victim. Yup, [video
noise] that’s again the same

00:30:41.640,00:30:48.013
white antennae this is the
second SDR this a NooElec very
tiny as SDR device with the

00:30:48.013,00:30:52.651
original antennae. Laptop is
ready for attack. It’s not yet
doing anything, it’s just being

00:30:52.651,00:30:59.458
ready, [Spanish Television
Plays] and Television there is
no URL, sorry for the, it is

00:30:59.458,00:31:05.430
really complicated to record and
to be doing all the rest of the
stuff. I will now start to tune

00:31:05.430,00:31:12.771
the small RTL SDR device I’m
tuning the television. I will
start to record to a file

00:31:12.771,00:31:21.713
transport a stream file. A few
seconds of uh buffer, call these
like a buffer. And now we are

00:31:21.713,00:31:27.352
modifying, I am injecting the
URL and now I am transmitting.
You don’t see any difference,

00:31:27.352,00:31:35.627
because I am using the same
video, but now Defcon 27 index 4
this is my post in URL now I can

00:31:35.627,00:31:42.100
scan your smart TV. I could be
able to take your manufacturer
model and public IP addresses,

00:31:42.100,00:31:49.341
as I am attacking all of these
TV channels multiplexes, if the
user do something and change to

00:31:49.341,00:31:54.613
another channel, we will
continue scanning his
preferences of channel and

00:31:54.613,00:32:02.621
audience I am very bad with this
sucking process but uh, index 2
if you realize I will pause the

00:32:02.621,00:32:11.296
video the upper request is eh
Defcon 27 index 4 and below
request is index 27 index sorry

00:32:11.296,00:32:22.140
Defcon 27 index 2 that’s how we
can scan or poison different
channels. Now that we are able

00:32:22.140,00:32:32.117
[audience applause] thank you
very much. If we think all the
options that we have, now that

00:32:32.117,00:32:40.025
we are able to forge and use our
own web server to attack our
victims. I think that after so

00:32:40.025,00:32:47.465
many years playing around with
this uh web pages captive web
pages, I think of course social

00:32:47.465,00:32:53.772
engineering, we could create an
advance exploit in order to take
the wifi information from the

00:32:53.772,00:32:59.010
smart TV because of course smart
TV is connected to the wifi, but
why not just ask our victim

00:32:59.010,00:33:05.317
[inaudible] eh guy I am your
smart TV I have just been
upgraded I really would like to

00:33:05.317,00:33:12.490
confirm with you your wifi
network, would you be so kind
please to let me know sorry,

00:33:12.490,00:33:23.501
ehhup. Here we are, [video
playing noise] would you be so
kind to let me know what your

00:33:23.501,00:33:34.279
wifi [inaudible] [speaker
laughs] Ok I will use a text
file it’s empty. I will store

00:33:34.279,00:33:43.255
the wifi answer of our audience
in the listed file. We are
transmitting now our poison URL.

00:33:43.255,00:33:49.494
television is set to render,
dear user has been successfully
upgraded, as we have been

00:33:49.494,00:33:57.035
scanning, we can create a really
nice captive web page with our
manufacturer image and of course

00:33:57.035,00:34:02.540
this is just a proof of concept
and I will publish for you so I
don’t want to give you a real uh

00:34:02.540,00:34:10.916
let’s say social engineering and
URL when he typed the wifi we
have the user input, once he

00:34:10.916,00:34:20.892
accept uh just, second try, he
some random characters just to
show you this proof of concept.

00:34:20.892,00:34:31.870
Is in o’s. Once the user accept
if we check this text file
content. Has the user input.

00:34:31.870,00:34:38.977
[audience applause] This
applause is not deserved because
this is just a stupid webserver

00:34:38.977,00:34:44.449
you realize, this is the
powerful of this methodology we
could create very creative

00:34:44.449,00:34:51.356
attacks towards the final users
of the smart TV’s. same with the
key logging, that doesn't make

00:34:51.356,00:34:58.630
sense in the HbbTV browser,
because HbbTV browser is uh
passive, that makes us only with

00:34:58.630,00:35:06.271
the user browser and same with
the crypto mining attacks, think
about if we are able to inject

00:35:06.271,00:35:11.910
this crypto mining in javascript
in I don’t know thousands or
hundreds of thousands of the

00:35:11.910,00:35:18.316
smart TV’s they will be so kind
as to do this crypto mining for
us, maybe we are retired in 2

00:35:18.316,00:35:25.390
days I don’t know. I really
would like, but as you know this
is uh Monero CoinHive for Monero

00:35:25.390,00:35:33.064
and they stopped the service I
think March this year. This is
really a pity, let me show you

00:35:33.064,00:35:42.507
[video plays] uh, the difficult
uh side here is you have been
playing with these uh Monero

00:35:42.507,00:35:49.748
CoinHive is the alt to start
feature. You don’t want the user
to press the button start to

00:35:49.748,00:35:57.489
start mining right? You want
this to be a automatically
attack. uh long time ago the alt

00:35:57.489,00:36:03.094
to start feature was uh
publically available to everyone
to modify but of course if this

00:36:03.094,00:36:10.201
was a used in a lot of web pages
eh illegally or to do so in this
kind of attack uh can I uh

00:36:10.201,00:36:19.577
remove the alt to start feature
and force the user to do eh this
uh, manual start. So uh an

00:36:19.577,00:36:26.584
anonymous friend lent me the
original javascript code, so I
don’t uh we don’t need the alt

00:36:26.584,00:36:34.959
to start uh press, it will start
automatically this uh crypto
mining. Once we changed the

00:36:34.959,00:36:45.770
channel to take this uh poison
URL, I am using these uh small
square we are- if you realize

00:36:45.770,00:36:51.476
the second request is the
javascript. We inject the
javascript file lasexta slash

00:36:51.476,00:37:00.018
simple UE mean dot GS this is
the small javascript file in
order to start mining. So I will

00:37:00.018,00:37:07.025
start in the Y shark I will
change the filter to show you
the CoinHive IP address

00:37:07.025,00:37:16.835
everything was under https so we
don’t know we don’t have the
Https request but we will see

00:37:16.835,00:37:21.773
all the Https communications
from the smart TV towards the
CoinHive web servers mining. And

00:37:21.773,00:37:29.414
uh, also I was wondering what
else we could do with our smart
TV. the browser, we would like

00:37:29.414,00:37:38.690
to face the user browser. If you
remember beef application, beef
software to hook the browsers. I

00:37:38.690,00:37:48.633
want to use a ND I-I love this
utility ettercap from uh socket
evil ND eh ettercap will be in

00:37:48.633,00:37:55.573
charge of inject this a hook dot
uh javascript file to hook the
user browser, when I hook the

00:37:55.573,00:38:01.713
user browser, I will use beef
just as a very simple
application to create an

00:38:01.713,00:38:10.655
invisible frame and what for? We
will have Metasploit running
with own to pwn and of course in

00:38:10.655,00:38:17.195
this invisible frame we’re going
to smart TV to listen to
Metasploit own to pwn. And

00:38:17.195,00:38:26.571
in that moment Metasploit will
be scanned for vulnerabilities
in our smart TV browser. and,

00:38:26.571,00:38:33.211
here we are, [Spanish TV plays]
everything is ready, I want to
show to you the ettercap

00:38:33.211,00:38:43.488
javascript file everything we
need to modify here it’s uh the
URL of our hook dot GS uh hook

00:38:43.488,00:38:51.329
let’s say uh javascript file. Of
course it’s locally ettercap is
ready, beef has already been

00:38:51.329,00:38:57.969
started, listening to any
browser being compromised and
now the user will open his

00:38:57.969,00:39:20.458
favorite newspaper. [Spanish TV
continues] [Computer pings] As
you see below new hooked browser

00:39:20.458,00:39:27.398
ID blah blah blah browser are
now hook domain el mundo dot S
is the newspaper we have hooked

00:39:27.398,00:39:39.143
the browser now move to
Metasploit copy the URL created
for the auto pwn here we are

00:39:39.143,00:39:56.494
with the beef modules invisible
frame [Spanish TV continues] and
we inject. Under all this auto

00:39:56.494,00:40:08.673
pwn running. You can check all
the models are looking for
vulnerabilities in the smart TV

00:40:08.673,00:40:19.550
user browser. [audience
applause] Thank you. So it’s eh
real easy to conclude this first

00:40:19.550,00:40:26.858
conclusion, probably you are
aware that uh the principle of
this attacks is the lack of

00:40:26.858,00:40:32.363
authentication in the radio
level, there is no
authentication at all, this

00:40:32.363,00:40:39.837
vulnerability or this flag of
the sign is eh also the same for
the GPS we could create with

00:40:39.837,00:40:47.412
SDRL device our own GPS
constellation. None of the GPS
clients will try to authenticate

00:40:47.412,00:40:53.117
our sales and same for the
network of the mobile networks
probably you are aware that 3g

00:40:53.117,00:40:59.791
and 4g mobile fake mobile
networks at some stage of the
process they will do a mutual

00:40:59.791,00:41:06.431
authentication, but does this
mutual authentication take place
after the identification we

00:41:06.431,00:41:14.038
still nowadays have 3g MC
cultures and 4g MC cultures and
the base of this attacks is

00:41:14.038,00:41:21.079
because the mobile device is
enabled to authenticate this
signal. They will always pick

00:41:21.079,00:41:28.286
the best signal, the stronger
one, that’s it. It’s the same
basic of these attacks so

00:41:28.286,00:41:34.292
probably it’s time in order to
implement some kind of
authentication in the lower

00:41:34.292,00:41:43.101
levels and in the other hand
when we always go to buy a smart
TV I think I don’t know the

00:41:43.101,00:41:50.341
percentage but probably 99
percentage of us we are just
concerned about size, inches the

00:41:50.341,00:41:56.948
amount is the inches of our
smart TV, bigger, lower, that’s
everything that we care about

00:41:56.948,00:42:03.821
the smart TV but probably after
seeing these attacks probably
it’s time to think about same as

00:42:03.821,00:42:10.561
the smart phones about security
about the operative system,
underlying our smart TV I want

00:42:10.561,00:42:17.702
to have a smart TV that uh from
time to time patches of this
vulnerabilities and take uh

00:42:17.702,00:42:25.376
secure browser not any browser
from I don’t know where in in
time, in place. I want uh some

00:42:25.376,00:42:33.251
operating system taking care of
security if I want to connect my
smart TV to the internet

00:42:33.251,00:42:36.454
[speaker laugh] that I would not
recommend to anyone. So Thank
you very much, I want to Thank

00:42:36.454,00:42:43.227
Gonzalo, Pepe, Alvaro, and N0p
for helping me with this uh
research. To record these videos

00:42:43.227,00:42:50.001
was not been easy at all uh, of
course, I want to thank all of
you to be here with me today

00:42:50.001,00:42:55.740
thank you very much. [Applause]

