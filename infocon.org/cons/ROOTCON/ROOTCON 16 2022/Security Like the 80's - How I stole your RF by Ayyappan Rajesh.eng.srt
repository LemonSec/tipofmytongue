1
00:00:00,000 --> 00:00:02,399
security like the 80s how I stole your

2
00:00:02,399 --> 00:00:05,660
RF and we'll be exploring cve 2020 to

3
00:00:05,660 --> 00:00:10,620
27254 and more here at root con 16. so

4
00:00:10,620 --> 00:00:13,440
who am I my name is iPhone Rajesh and

5
00:00:13,440 --> 00:00:16,260
I'm I am an aspiring security researcher

6
00:00:16,260 --> 00:00:19,039
and student uh here at UMass Dartmouth

7
00:00:19,039 --> 00:00:21,660
uh you can follow me on Twitter and even

8
00:00:21,660 --> 00:00:23,760
check out my GitHub repository and

9
00:00:23,760 --> 00:00:26,640
here's my website as well

10
00:00:26,640 --> 00:00:30,779
and I worked on this project along with

11
00:00:30,779 --> 00:00:33,960
Papa Mikhail also known as scorp and

12
00:00:33,960 --> 00:00:36,059
he's the sub gigahertz architect at

13
00:00:36,059 --> 00:00:38,700
flipper devices the company that makes

14
00:00:38,700 --> 00:00:40,800
the famous flipper zero and you can

15
00:00:40,800 --> 00:00:43,020
reach out to him on telegram or even

16
00:00:43,020 --> 00:00:45,899
check out his GitHub

17
00:00:45,899 --> 00:00:49,320
so what got me into hacking my journey

18
00:00:49,320 --> 00:00:52,500
started about seven to eight years ago

19
00:00:52,500 --> 00:00:55,140
um after watching videos on YouTube such

20
00:00:55,140 --> 00:00:56,039
as

21
00:00:56,039 --> 00:00:58,559
um uh Dr Charlie Miller and Chris

22
00:00:58,559 --> 00:01:02,520
valsak's uh videos on the famous Jeep

23
00:01:02,520 --> 00:01:05,880
hack hack 5 videos and even uh Stanley

24
00:01:05,880 --> 00:01:09,259
kafka's open sesame attack

25
00:01:09,479 --> 00:01:13,020
so small disclaimer

26
00:01:13,020 --> 00:01:15,420
um yeah all of this is only for

27
00:01:15,420 --> 00:01:17,580
informational and educational purposes

28
00:01:17,580 --> 00:01:21,479
only and most of all no key fobs were

29
00:01:21,479 --> 00:01:23,820
harmed in the making of this video and

30
00:01:23,820 --> 00:01:26,220
everything that I will be talking about

31
00:01:26,220 --> 00:01:29,460
over here are already known and it can

32
00:01:29,460 --> 00:01:32,040
be readily found on the internet and if

33
00:01:32,040 --> 00:01:34,140
you'd like to everything's already up on

34
00:01:34,140 --> 00:01:36,240
my GitHub repository you can go download

35
00:01:36,240 --> 00:01:38,040
the files

36
00:01:38,040 --> 00:01:39,659
um go through things learn how to

37
00:01:39,659 --> 00:01:42,119
demodulate it yourself and even download

38
00:01:42,119 --> 00:01:44,579
the custom firmware for the flipper zero

39
00:01:44,579 --> 00:01:46,619
that I'll be talking about soon

40
00:01:46,619 --> 00:01:48,420
so

41
00:01:48,420 --> 00:01:51,600
story time so how did I get into this

42
00:01:51,600 --> 00:01:54,119
right so I was doing this

43
00:01:54,119 --> 00:01:55,860
um course last semester under my

44
00:01:55,860 --> 00:02:01,140
professor Hong Liu and um for the class

45
00:02:01,140 --> 00:02:03,420
um we had to do either one of the

46
00:02:03,420 --> 00:02:05,579
projects which was experiment a cyber

47
00:02:05,579 --> 00:02:07,200
security solution or understand the

48
00:02:07,200 --> 00:02:09,899
cyber security incident and

49
00:02:09,899 --> 00:02:13,500
for this I decided to do type A which

50
00:02:13,500 --> 00:02:15,480
was experiment a cyber security solution

51
00:02:15,480 --> 00:02:18,360
and I thought it was a perfect time to

52
00:02:18,360 --> 00:02:20,280
pick up a hacker if and try something

53
00:02:20,280 --> 00:02:21,120
new

54
00:02:21,120 --> 00:02:24,360
so I was searching around for ideas and

55
00:02:24,360 --> 00:02:27,360
I came across this cve which was 2019

56
00:02:27,360 --> 00:02:30,180
tour 626 which spoke about a simple

57
00:02:30,180 --> 00:02:34,560
replay attack on a Honda HRV 2017 and

58
00:02:34,560 --> 00:02:37,560
as far as I knew rolling codes have been

59
00:02:37,560 --> 00:02:40,739
out for about 20 years and I personally

60
00:02:40,739 --> 00:02:42,720
didn't believe that a simple replay

61
00:02:42,720 --> 00:02:45,239
attack would work so

62
00:02:45,239 --> 00:02:48,060
what did I do I picked up a hakare from

63
00:02:48,060 --> 00:02:50,819
Facebook Marketplace learned new radio

64
00:02:50,819 --> 00:02:54,360
through Justin montreblano's uh

65
00:02:54,360 --> 00:02:56,879
a video from the car hacking Village on

66
00:02:56,879 --> 00:03:00,360
Guru radio and basically submitted for a

67
00:03:00,360 --> 00:03:04,519
new cve which was assigned as cve

68
00:03:04,519 --> 00:03:09,180
2022-27254 and I did this work uh with

69
00:03:09,180 --> 00:03:11,159
Blake Berry also known as hacking into

70
00:03:11,159 --> 00:03:15,300
your heart until the CBE submission

71
00:03:15,300 --> 00:03:17,879
and here's another picture of that too

72
00:03:17,879 --> 00:03:22,920
so this was featured in the media such

73
00:03:22,920 --> 00:03:27,120
as the record Fox News threat post and

74
00:03:27,120 --> 00:03:28,920
even the register

75
00:03:28,920 --> 00:03:32,519
and I was also interviewed by Abc's Good

76
00:03:32,519 --> 00:03:34,200
Morning America

77
00:03:34,200 --> 00:03:37,140
and yeah that's pretty much about it so

78
00:03:37,140 --> 00:03:38,879
a little more about keyless entry

79
00:03:38,879 --> 00:03:42,379
systems so

80
00:03:42,659 --> 00:03:45,900
in vehicles after 2040 in

81
00:03:45,900 --> 00:03:48,659
um most of it like over 72 percent

82
00:03:48,659 --> 00:03:51,299
already have it and after 2019 that

83
00:03:51,299 --> 00:03:53,940
number has only gone up to 91 percent

84
00:03:53,940 --> 00:03:55,620
and

85
00:03:55,620 --> 00:03:58,200
um we can all expect this number to keep

86
00:03:58,200 --> 00:04:00,900
Rising even because even the lower end

87
00:04:00,900 --> 00:04:03,060
trims of cars now come default with

88
00:04:03,060 --> 00:04:04,680
keyless entry which is an amazing

89
00:04:04,680 --> 00:04:05,819
feature

90
00:04:05,819 --> 00:04:09,540
so what we'll be exploiting over here is

91
00:04:09,540 --> 00:04:11,879
the remote keyless entry as opposed to

92
00:04:11,879 --> 00:04:13,980
the passive keyless entry so the remote

93
00:04:13,980 --> 00:04:16,560
keyless entry was first introduced in

94
00:04:16,560 --> 00:04:20,160
1982 uh uh On A Renault Fuego and it

95
00:04:20,160 --> 00:04:23,100
operates at either 350 and 433 or 868

96
00:04:23,100 --> 00:04:24,840
megahertz depending

97
00:04:24,840 --> 00:04:26,520
on which part of the world you're from

98
00:04:26,520 --> 00:04:32,100
so the way remote keyless entry works is

99
00:04:32,100 --> 00:04:34,620
um you press a button on your key fob

100
00:04:34,620 --> 00:04:37,620
and it's as good as broadcasting a

101
00:04:37,620 --> 00:04:40,320
password maybe 15 30 feet away from you

102
00:04:40,320 --> 00:04:44,040
and everyone can listen to it and only

103
00:04:44,040 --> 00:04:46,620
your car knows that yes that's the right

104
00:04:46,620 --> 00:04:48,360
password and only then it will unlock

105
00:04:48,360 --> 00:04:52,020
for you so there's no verification or

106
00:04:52,020 --> 00:04:54,240
any form of two-way handshake it's

107
00:04:54,240 --> 00:04:58,919
purely a one-way thing so a little more

108
00:04:58,919 --> 00:05:02,820
about rke so because it's every because

109
00:05:02,820 --> 00:05:04,320
everything is dealing with frequency

110
00:05:04,320 --> 00:05:06,060
over here you have three types of

111
00:05:06,060 --> 00:05:08,400
modulation which is amplitude key

112
00:05:08,400 --> 00:05:10,560
shifting frequency key shifting and face

113
00:05:10,560 --> 00:05:13,139
key shifting and like like the name

114
00:05:13,139 --> 00:05:15,840
suggests the data is transmitted either

115
00:05:15,840 --> 00:05:18,060
in the amplitude frequency or the phase

116
00:05:18,060 --> 00:05:20,400
of the wave but in this case we'll be

117
00:05:20,400 --> 00:05:23,699
looking at frequency key shifting

118
00:05:23,699 --> 00:05:25,979
because that's what the key fob operates

119
00:05:25,979 --> 00:05:29,460
on so a little more about static and

120
00:05:29,460 --> 00:05:32,759
rolling keys so like the fixed code

121
00:05:32,759 --> 00:05:34,080
suggests

122
00:05:34,080 --> 00:05:36,600
it's like the same password or same code

123
00:05:36,600 --> 00:05:38,940
being sent over and over again it never

124
00:05:38,940 --> 00:05:42,360
expires whereas on a rolling code every

125
00:05:42,360 --> 00:05:46,020
time the button is pressed the code

126
00:05:46,020 --> 00:05:49,979
keeps rolling and it keeps changing so

127
00:05:49,979 --> 00:05:52,320
even if someone did intercept it you

128
00:05:52,320 --> 00:05:54,660
could not use the same code

129
00:05:54,660 --> 00:05:57,960
and do a simple repeat attack like this

130
00:05:57,960 --> 00:06:00,120
so the tool is that I used throughout

131
00:06:00,120 --> 00:06:03,060
this was fccid.io

132
00:06:03,060 --> 00:06:05,400
um any RF transceiver I personally use

133
00:06:05,400 --> 00:06:07,560
the hack RF

134
00:06:07,560 --> 00:06:10,560
um and the usrp and then moved on to the

135
00:06:10,560 --> 00:06:13,020
flipper zero and for analyzing and

136
00:06:13,020 --> 00:06:15,300
understanding what the wave looks like

137
00:06:15,300 --> 00:06:18,419
um you could use gqrx or spy Str based

138
00:06:18,419 --> 00:06:21,240
on your OS and what you prefer otherwise

139
00:06:21,240 --> 00:06:23,880
another cool tool is the universal radio

140
00:06:23,880 --> 00:06:27,720
hacker which is really user friendly and

141
00:06:27,720 --> 00:06:30,539
good for people new to

142
00:06:30,539 --> 00:06:33,960
um messing around with any sort of uh RF

143
00:06:33,960 --> 00:06:36,060
signals and then glue radio which is

144
00:06:36,060 --> 00:06:39,960
another another amazing open source tool

145
00:06:39,960 --> 00:06:42,120
so

146
00:06:42,120 --> 00:06:46,220
the FCC ID for this is kr5b

147
00:06:46,220 --> 00:06:50,039
krv52x on the which we can get through

148
00:06:50,039 --> 00:06:54,500
the key fob and here's a picture of the

149
00:06:54,500 --> 00:06:56,580
document itself

150
00:06:56,580 --> 00:06:59,520
so looking at this we can already tell

151
00:06:59,520 --> 00:07:01,560
that it's some sort of frequency key

152
00:07:01,560 --> 00:07:04,560
shifting and we know that it's around

153
00:07:04,560 --> 00:07:07,199
433.62

154
00:07:07,199 --> 00:07:09,240
six one two four thirty three point six

155
00:07:09,240 --> 00:07:13,380
seven megahertz ish but we can we can

156
00:07:13,380 --> 00:07:16,199
dig deeper into this and then the RF

157
00:07:16,199 --> 00:07:18,240
currency was like the hack RF flipper

158
00:07:18,240 --> 00:07:20,900
zero yardstick one in the usrp 10 to 10

159
00:07:20,900 --> 00:07:24,479
uh help you receive and transmit any

160
00:07:24,479 --> 00:07:27,000
sort of RF signal something that I

161
00:07:27,000 --> 00:07:28,919
should mention is that the hack RF and

162
00:07:28,919 --> 00:07:32,039
the usrp are software defined radios

163
00:07:32,039 --> 00:07:33,660
um whereas The Flipper 0 and the

164
00:07:33,660 --> 00:07:36,060
yardstick one are computer controlled

165
00:07:36,060 --> 00:07:38,460
radio devices so one main difference

166
00:07:38,460 --> 00:07:42,000
between these two is that uh for a

167
00:07:42,000 --> 00:07:44,160
software defined radio all you need to

168
00:07:44,160 --> 00:07:46,800
know is the frequency and you can simply

169
00:07:46,800 --> 00:07:50,099
tell it okay listen on this frequency uh

170
00:07:50,099 --> 00:07:52,319
save it and play it back whereas for a

171
00:07:52,319 --> 00:07:54,780
flipper zero or a yardstick one you'd

172
00:07:54,780 --> 00:07:57,599
need to tell it exactly the exact

173
00:07:57,599 --> 00:08:00,000
specifications such as

174
00:08:00,000 --> 00:08:00,660
um

175
00:08:00,660 --> 00:08:03,180
what's the Frequency it's on what sort

176
00:08:03,180 --> 00:08:05,280
of modulation what sort of encoding

177
00:08:05,280 --> 00:08:06,960
decoding

178
00:08:06,960 --> 00:08:09,180
um the difference between the

179
00:08:09,180 --> 00:08:11,039
frequencies every time it shifts and

180
00:08:11,039 --> 00:08:12,720
things like that

181
00:08:12,720 --> 00:08:17,460
so our first tool gqrx can show us that

182
00:08:17,460 --> 00:08:21,900
um it's again FSK like the fccid.io

183
00:08:21,900 --> 00:08:23,580
document suggested

184
00:08:23,580 --> 00:08:26,039
and here's a little video of that and

185
00:08:26,039 --> 00:08:28,800
then s by SDR does the same it's just

186
00:08:28,800 --> 00:08:31,500
that I use that on Mac OS and this was

187
00:08:31,500 --> 00:08:34,200
on a Windows

188
00:08:34,200 --> 00:08:37,500
and this tells you a little more about

189
00:08:37,500 --> 00:08:40,380
the way the key fob operates so it's at

190
00:08:40,380 --> 00:08:44,640
433 as well as for 34 megahertz ish

191
00:08:44,640 --> 00:08:48,620
so uh universal radio hacker is the

192
00:08:48,620 --> 00:08:50,640
user-friendly app I was talking about

193
00:08:50,640 --> 00:08:53,120
and you can do everything from capturing

194
00:08:53,120 --> 00:08:55,740
demodulating flipping and even

195
00:08:55,740 --> 00:08:57,300
transmitting

196
00:08:57,300 --> 00:08:59,580
um any RF signal that you'd like through

197
00:08:59,580 --> 00:09:01,260
any device

198
00:09:01,260 --> 00:09:04,800
so this is the flowchart for glue radio

199
00:09:04,800 --> 00:09:07,320
and this is how it's captured so all

200
00:09:07,320 --> 00:09:09,360
it's doing is taking it from the osmocom

201
00:09:09,360 --> 00:09:11,940
source which is the hack RF and then

202
00:09:11,940 --> 00:09:15,120
just saving it so these were the

203
00:09:15,120 --> 00:09:16,260
um

204
00:09:16,260 --> 00:09:19,260
settings that I had used for gnu radio

205
00:09:19,260 --> 00:09:20,820
and you can download these files from

206
00:09:20,820 --> 00:09:22,440
GitHub as well if you'd like to try this

207
00:09:22,440 --> 00:09:25,200
out and here's the same file for

208
00:09:25,200 --> 00:09:28,260
transmitting so after saving the file uh

209
00:09:28,260 --> 00:09:31,320
you can simply multiply it by a constant

210
00:09:31,320 --> 00:09:33,180
throttle it to the sample rate for the

211
00:09:33,180 --> 00:09:36,720
hack RF which was uh 2m and then just

212
00:09:36,720 --> 00:09:38,880
send it to the hacker and it will do

213
00:09:38,880 --> 00:09:39,800
whatever

214
00:09:39,800 --> 00:09:42,600
the file says

215
00:09:42,600 --> 00:09:46,100
so here's a little video

216
00:10:16,440 --> 00:10:18,560
thank you

217
00:10:33,899 --> 00:10:36,959
so like the video I showed you I first

218
00:10:36,959 --> 00:10:41,399
used the start file to and and Replay

219
00:10:41,399 --> 00:10:43,680
that in order to start the car and then

220
00:10:43,680 --> 00:10:45,720
replay the unlock file so I could not

221
00:10:45,720 --> 00:10:50,640
only unlock your car but also started

222
00:10:50,640 --> 00:10:53,820
um and this is another one of my

223
00:10:53,820 --> 00:10:56,300
favorites

224
00:11:06,480 --> 00:11:09,180
so like you saw the key fob has a

225
00:11:09,180 --> 00:11:11,459
feature where you can roll down all your

226
00:11:11,459 --> 00:11:14,160
windows and even open the sunroof and in

227
00:11:14,160 --> 00:11:15,120
the summer

228
00:11:15,120 --> 00:11:17,640
I'm a huge fan of this because uh having

229
00:11:17,640 --> 00:11:19,740
a black car doesn't really help and it's

230
00:11:19,740 --> 00:11:22,200
really hot so using this feature really

231
00:11:22,200 --> 00:11:24,600
helps it cool the cool the car down or

232
00:11:24,600 --> 00:11:27,480
get some air in but let's say I didn't

233
00:11:27,480 --> 00:11:30,060
like someone didn't like me

234
00:11:30,060 --> 00:11:32,399
um and they did the same attack on me

235
00:11:32,399 --> 00:11:36,600
and they captured the the same file for

236
00:11:36,600 --> 00:11:39,600
rolling down the windows and sunroof and

237
00:11:39,600 --> 00:11:42,120
then came back in the winter and repaid

238
00:11:42,120 --> 00:11:44,339
it this this is pretty much what could

239
00:11:44,339 --> 00:11:45,660
happen to you

240
00:11:45,660 --> 00:11:47,760
and

241
00:11:47,760 --> 00:11:50,459
moving on digging deeper into the actual

242
00:11:50,459 --> 00:11:53,579
key fob so after opening up the key fob

243
00:11:53,579 --> 00:11:56,940
this is what it looks like and when you

244
00:11:56,940 --> 00:11:59,160
take a closer look at it

245
00:11:59,160 --> 00:12:04,100
um at the data sheet for the nxp

246
00:12:04,100 --> 00:12:08,820
pcf7900 you can then look at the

247
00:12:08,820 --> 00:12:13,019
actually pins for this so this

248
00:12:13,019 --> 00:12:16,079
um this chip uses

249
00:12:16,079 --> 00:12:20,339
um SPI and all of this was done by Scott

250
00:12:20,339 --> 00:12:22,560
um who took only one night and three

251
00:12:22,560 --> 00:12:25,320
beers to reverse engineer the entire key

252
00:12:25,320 --> 00:12:28,260
fob so

253
00:12:28,260 --> 00:12:31,560
a little more about this so SPI was

254
00:12:31,560 --> 00:12:34,500
developed by Motorola by Motorola in the

255
00:12:34,500 --> 00:12:37,260
1980s and it supports either three wire

256
00:12:37,260 --> 00:12:41,339
or four wire and it consists of

257
00:12:41,339 --> 00:12:45,060
um your serial output uh Morsi which

258
00:12:45,060 --> 00:12:47,160
stands for master output slave input

259
00:12:47,160 --> 00:12:49,500
miso which stands for master input slave

260
00:12:49,500 --> 00:12:52,620
output and sclk which is the serial

261
00:12:52,620 --> 00:12:56,040
clock so in this case

262
00:12:56,040 --> 00:12:58,500
um we just use the the key fob over here

263
00:12:58,500 --> 00:12:59,760
just used

264
00:12:59,760 --> 00:13:02,279
um the three pin output and like the

265
00:13:02,279 --> 00:13:06,139
pictures uh where you can see we used

266
00:13:06,139 --> 00:13:09,540
Sala logic to understand what's going on

267
00:13:09,540 --> 00:13:13,320
in the actual key fob and here's a

268
00:13:13,320 --> 00:13:15,720
picture of that so

269
00:13:15,720 --> 00:13:19,079
this is what it looks like so we use the

270
00:13:19,079 --> 00:13:23,880
mercy the Miso and the the clock and

271
00:13:23,880 --> 00:13:25,800
figure out what's what's going on inside

272
00:13:25,800 --> 00:13:27,240
so

273
00:13:27,240 --> 00:13:29,339
you might be asked to

274
00:13:29,339 --> 00:13:33,000
what do these numbers mean and what

275
00:13:33,000 --> 00:13:36,839
significance does it have so to quote to

276
00:13:36,839 --> 00:13:40,860
quote Dr Weil it's in the data sheet and

277
00:13:40,860 --> 00:13:43,800
um after looking at it more closely you

278
00:13:43,800 --> 00:13:46,680
can then see that each one of those

279
00:13:46,680 --> 00:13:51,360
numbers like 0b 1 1 1 0 1 1 1

280
00:13:51,360 --> 00:13:53,279
um actually meant

281
00:13:53,279 --> 00:13:56,220
um was was nothing but an instruction

282
00:13:56,220 --> 00:13:59,480
for the key fob and what it should do so

283
00:13:59,480 --> 00:14:02,339
this is the useful information that we

284
00:14:02,339 --> 00:14:03,420
extracted

285
00:14:03,420 --> 00:14:07,040
so such as miso zero

286
00:14:07,040 --> 00:14:11,279
b1000 100 meant toggling the lower bit

287
00:14:11,279 --> 00:14:15,839
for the FSK and then

288
00:14:15,839 --> 00:14:17,519
um the picture that was there in the

289
00:14:17,519 --> 00:14:19,980
first uh in the first slide was actually

290
00:14:19,980 --> 00:14:21,959
the one for the baud rate which was

291
00:14:21,959 --> 00:14:24,019
0b011

292
00:14:24,019 --> 00:14:27,720
0011 which does nothing but

293
00:14:27,720 --> 00:14:32,519
um uh tell the key fob to select a

294
00:14:32,519 --> 00:14:34,320
certain word rate which we've calculated

295
00:14:34,320 --> 00:14:37,320
over here so throughout this thing

296
00:14:37,320 --> 00:14:39,959
um we found out that

297
00:14:39,959 --> 00:14:43,519
it operates at 433

298
00:14:43,519 --> 00:14:48,779
657070 Hertz by looking at the frequency

299
00:14:48,779 --> 00:14:50,760
config one low byte which we've

300
00:14:50,760 --> 00:14:52,800
determined through the data sheet and

301
00:14:52,800 --> 00:14:56,600
then like likewise it's at

302
00:14:56,600 --> 00:15:00,480
434.1769 uh 48 Hertz and we all we

303
00:15:00,480 --> 00:15:03,060
already knew that it's at it has a

304
00:15:03,060 --> 00:15:06,300
frequency shifting key modulation but

305
00:15:06,300 --> 00:15:08,880
the deviation wasn't precise through

306
00:15:08,880 --> 00:15:12,480
gqrx or S by Str so that's why this

307
00:15:12,480 --> 00:15:14,699
helped and we know that too now and we

308
00:15:14,699 --> 00:15:17,820
even know the baud rate and which is

309
00:15:17,820 --> 00:15:20,160
very important for what we're about to

310
00:15:20,160 --> 00:15:24,360
do next so after that

311
00:15:24,360 --> 00:15:27,480
um after looking at the

312
00:15:27,480 --> 00:15:30,540
signal we can tell that it's Manchester

313
00:15:30,540 --> 00:15:37,139
encoded so how do you calculate or how

314
00:15:37,139 --> 00:15:40,380
do you demodulate it rather because it's

315
00:15:40,380 --> 00:15:42,480
still encoded by something and if you

316
00:15:42,480 --> 00:15:45,899
want to uh change it to Binary you would

317
00:15:45,899 --> 00:15:48,720
need to know how to be modulated so to

318
00:15:48,720 --> 00:15:51,620
do that remember the number 62.81

319
00:15:51,620 --> 00:15:54,540
microseconds and then this is all you do

320
00:15:54,540 --> 00:15:56,279
so to calculate the Manchester bit rate

321
00:15:56,279 --> 00:15:58,260
you divide one second by the shortest

322
00:15:58,260 --> 00:16:01,620
duration which was 62.81 microseconds

323
00:16:01,620 --> 00:16:04,320
and divide that by two

324
00:16:04,320 --> 00:16:07,339
um so that gives you about

325
00:16:07,339 --> 00:16:10,380
7961 kilobytes per second and that's a

326
00:16:10,380 --> 00:16:12,180
quick math for you

327
00:16:12,180 --> 00:16:15,120
um so now what so we already had the

328
00:16:15,120 --> 00:16:17,459
previous file and then just by using

329
00:16:17,459 --> 00:16:20,040
another analyzer for uh decoding

330
00:16:20,040 --> 00:16:23,880
Manchester we feed in the bit rate and

331
00:16:23,880 --> 00:16:26,180
then even though the

332
00:16:26,180 --> 00:16:28,079
screenshot over here doesn't highlight

333
00:16:28,079 --> 00:16:29,940
it we

334
00:16:29,940 --> 00:16:33,000
um also enter the Preamble bits to

335
00:16:33,000 --> 00:16:35,459
ignore which was 20

336
00:16:35,459 --> 00:16:38,220
um and the software does it for you it

337
00:16:38,220 --> 00:16:40,139
will just demodulate everything that you

338
00:16:40,139 --> 00:16:42,600
have and like you see over here it gives

339
00:16:42,600 --> 00:16:46,500
the whole value in either binary or in

340
00:16:46,500 --> 00:16:49,680
hexadecimal for short and

341
00:16:49,680 --> 00:16:52,740
so you might be asking why did we do

342
00:16:52,740 --> 00:16:57,240
this right so uh like I said earlier The

343
00:16:57,240 --> 00:17:00,300
Flipper 0 is not an Str and you need to

344
00:17:00,300 --> 00:17:03,120
tell it exactly what to do so then using

345
00:17:03,120 --> 00:17:06,059
all this information uh Scott wrote

346
00:17:06,059 --> 00:17:09,900
custom firmware and made this happen so

347
00:17:09,900 --> 00:17:12,439
we now have uh

348
00:17:12,439 --> 00:17:16,859
433.65 and 434.17 frequency added custom

349
00:17:16,859 --> 00:17:19,799
to The Flipper and also a modulation

350
00:17:19,799 --> 00:17:22,740
which we named Honda one and there's

351
00:17:22,740 --> 00:17:24,780
Honda 2 as well which is more sensitive

352
00:17:24,780 --> 00:17:28,980
but it does the same thing and it is FSK

353
00:17:28,980 --> 00:17:31,260
and it follows all the parameters as you

354
00:17:31,260 --> 00:17:35,220
saw earlier and here's a picture of the

355
00:17:35,220 --> 00:17:38,640
sprcr capture so as you can see right

356
00:17:38,640 --> 00:17:41,039
below you have the actual key fob

357
00:17:41,039 --> 00:17:44,100
capture and then above that you have the

358
00:17:44,100 --> 00:17:47,580
flipper 0 as well and as the picture

359
00:17:47,580 --> 00:17:50,039
suggests the capture for The Flipper

360
00:17:50,039 --> 00:17:51,780
zero when it's replayed

361
00:17:51,780 --> 00:17:53,700
um it is a bit noisy and that's because

362
00:17:53,700 --> 00:17:57,900
of the cco1 chip which is already known

363
00:17:57,900 --> 00:17:59,400
but

364
00:17:59,400 --> 00:18:01,200
does it really get the work done it

365
00:18:01,200 --> 00:18:03,600
looks the same but does it work let's

366
00:18:03,600 --> 00:18:06,020
find out

367
00:18:40,140 --> 00:18:42,320
foreign

368
00:18:55,460 --> 00:18:58,919
all you need is this bad boy a flipper

369
00:18:58,919 --> 00:19:01,919
zero and you can capture

370
00:19:01,919 --> 00:19:05,280
um any key fob for any most 10th gen

371
00:19:05,280 --> 00:19:08,280
Hondas and just do a simple replay and

372
00:19:08,280 --> 00:19:11,100
it will work so

373
00:19:11,100 --> 00:19:13,919
time for some memes you guys might have

374
00:19:13,919 --> 00:19:16,500
heard of a Civic with a laptop it's the

375
00:19:16,500 --> 00:19:19,860
most feared thing in the car community

376
00:19:19,860 --> 00:19:22,799
um and this is a cool picture as well on

377
00:19:22,799 --> 00:19:24,179
the right where someone actually managed

378
00:19:24,179 --> 00:19:26,760
to get Linux on their car car's

379
00:19:26,760 --> 00:19:28,260
infotainment system rather

380
00:19:28,260 --> 00:19:29,580
so

381
00:19:29,580 --> 00:19:32,760
imagine a Civic with a laptop and a

382
00:19:32,760 --> 00:19:35,340
hacker F1 isn't it the ultimate War

383
00:19:35,340 --> 00:19:38,700
driving setup so through like like the

384
00:19:38,700 --> 00:19:40,260
picture shows

385
00:19:40,260 --> 00:19:44,700
um all you need to do is wait in a a

386
00:19:44,700 --> 00:19:46,500
parking garage or rather than even

387
00:19:46,500 --> 00:19:48,179
having a laptop you could just leave

388
00:19:48,179 --> 00:19:51,059
this in a tiny little bag

389
00:19:51,059 --> 00:19:52,980
um come the next day analyze everything

390
00:19:52,980 --> 00:19:55,919
load it onto a flipper zero and then you

391
00:19:55,919 --> 00:19:58,799
can essentially go replay the same

392
00:19:58,799 --> 00:20:02,760
capture and pretty much open

393
00:20:02,760 --> 00:20:06,900
every anyone's got up so

394
00:20:06,900 --> 00:20:08,940
you might ask what's the solution to

395
00:20:08,940 --> 00:20:12,720
this so I'm not gonna suggest

396
00:20:12,720 --> 00:20:15,419
um putting your keys in a variety of

397
00:20:15,419 --> 00:20:18,000
pouch and actually a true word for it

398
00:20:18,000 --> 00:20:20,280
um because it's not a permanent solution

399
00:20:20,280 --> 00:20:23,039
right and uh even then you'd have to

400
00:20:23,039 --> 00:20:25,679
remove the key from your Faraday pouch

401
00:20:25,679 --> 00:20:29,340
every time you need to go uh open your

402
00:20:29,340 --> 00:20:32,220
car or drive it so

403
00:20:32,220 --> 00:20:34,980
rolling codes right so you're telling me

404
00:20:34,980 --> 00:20:38,640
to prevent a simple replay attack

405
00:20:38,640 --> 00:20:40,320
um just use rolling codes because every

406
00:20:40,320 --> 00:20:42,419
time you press the button even if

407
00:20:42,419 --> 00:20:45,059
someone hears the password

408
00:20:45,059 --> 00:20:47,700
um it still expired there's no way you

409
00:20:47,700 --> 00:20:49,200
can go use

410
00:20:49,200 --> 00:20:52,440
um an expired code to unlock

411
00:20:52,440 --> 00:20:54,919
right

412
00:20:55,020 --> 00:20:57,960
yeah I don't think so so

413
00:20:57,960 --> 00:21:01,980
um my body Kevin to 600 uh who's uh part

414
00:21:01,980 --> 00:21:03,980
of the kayaking Village

415
00:21:03,980 --> 00:21:06,360
in China

416
00:21:06,360 --> 00:21:08,280
um actually came up with a flaw called

417
00:21:08,280 --> 00:21:11,640
as uh rolling pawn and we also found out

418
00:21:11,640 --> 00:21:14,340
that the same vulnerability was also

419
00:21:14,340 --> 00:21:18,120
spoken about by my friend Levy and his

420
00:21:18,120 --> 00:21:21,720
uh his professor at uh black hat and

421
00:21:21,720 --> 00:21:25,940
their talk was called rollback so

422
00:21:26,280 --> 00:21:30,059
um I guess it's even uh ruling codes

423
00:21:30,059 --> 00:21:33,600
aren't safe because all they're doing is

424
00:21:33,600 --> 00:21:35,159
um replaying

425
00:21:35,159 --> 00:21:37,740
um a sequence of captures in a certain

426
00:21:37,740 --> 00:21:40,140
order so that

427
00:21:40,140 --> 00:21:43,320
um the pseudorandom number generator

428
00:21:43,320 --> 00:21:45,360
in the car the counter gets

429
00:21:45,360 --> 00:21:48,600
re-synchronized so think of uh rolling

430
00:21:48,600 --> 00:21:51,419
codes as a for Loop so every time you

431
00:21:51,419 --> 00:21:54,000
press a button just imagine

432
00:21:54,000 --> 00:21:56,940
um I keeps incrementing every time and

433
00:21:56,940 --> 00:21:59,100
the password or code keeps changing but

434
00:21:59,100 --> 00:22:02,100
imagine if you already had an old

435
00:22:02,100 --> 00:22:05,220
capture for a certain value of I and you

436
00:22:05,220 --> 00:22:07,620
were able to re-synchronize the car to

437
00:22:07,620 --> 00:22:10,860
that value of I and then use an expired

438
00:22:10,860 --> 00:22:12,960
code

439
00:22:12,960 --> 00:22:14,760
um against it which is now valid

440
00:22:14,760 --> 00:22:16,140
according to the car

441
00:22:16,140 --> 00:22:20,000
and here's a short demo of that

442
00:22:30,170 --> 00:22:37,970
[Music]

443
00:22:43,410 --> 00:22:49,789
[Music]

444
00:22:56,170 --> 00:22:59,339
[Music]

445
00:23:05,340 --> 00:23:09,360
so there you go so even a newer car

446
00:23:09,360 --> 00:23:11,280
which has rolling codes is now

447
00:23:11,280 --> 00:23:13,919
vulnerable and according to the

448
00:23:13,919 --> 00:23:16,500
researchers at black hat

449
00:23:16,500 --> 00:23:19,919
um they estimate about 70 percent of uh

450
00:23:19,919 --> 00:23:22,140
asian-made cars to be affected by this

451
00:23:22,140 --> 00:23:25,340
vulnerability and are working towards

452
00:23:25,340 --> 00:23:28,679
finding out what cars are vulnerable to

453
00:23:28,679 --> 00:23:29,580
this

454
00:23:29,580 --> 00:23:31,440
um attack and

455
00:23:31,440 --> 00:23:33,299
they still don't know why which is

456
00:23:33,299 --> 00:23:36,480
really alarming so

457
00:23:36,480 --> 00:23:39,059
uh when Kevin first came up with this

458
00:23:39,059 --> 00:23:41,400
research uh Honda claimed that it wasn't

459
00:23:41,400 --> 00:23:44,280
possible same thing like a simple replay

460
00:23:44,280 --> 00:23:47,640
attack when I put mine out and here he

461
00:23:47,640 --> 00:23:49,860
stopped to his friend uh Rob Stumpf and

462
00:23:49,860 --> 00:23:52,200
he read an article about the about the

463
00:23:52,200 --> 00:23:55,799
same on the drive and actually proved

464
00:23:55,799 --> 00:23:58,700
that the rolling Pawn or rollback attack

465
00:23:58,700 --> 00:24:02,940
still works on a newer Honda

466
00:24:02,940 --> 00:24:04,860
and

467
00:24:04,860 --> 00:24:09,480
this is what happened after that too so

468
00:24:09,480 --> 00:24:11,460
um they did say that there is no

469
00:24:11,460 --> 00:24:12,780
indication that they reported

470
00:24:12,780 --> 00:24:15,659
vulnerability to unlock and lock doors

471
00:24:15,659 --> 00:24:18,600
results in an ability to drive an Acura

472
00:24:18,600 --> 00:24:20,280
or a Honda vehicle

473
00:24:20,280 --> 00:24:22,860
um and that's partly true because

474
00:24:22,860 --> 00:24:26,159
um to drive away with the car there

475
00:24:26,159 --> 00:24:28,799
still is an immobilizer present within

476
00:24:28,799 --> 00:24:31,380
and you'd need the passive keyless entry

477
00:24:31,380 --> 00:24:33,780
uh system

478
00:24:33,780 --> 00:24:35,760
um in order to do that so that's the

479
00:24:35,760 --> 00:24:37,620
only way you can disable that I mean

480
00:24:37,620 --> 00:24:39,960
sure you can use a relay attack but then

481
00:24:39,960 --> 00:24:42,179
that's not worth looking for over here

482
00:24:42,179 --> 00:24:43,380
so

483
00:24:43,380 --> 00:24:46,320
when they said this I thought to myself

484
00:24:46,320 --> 00:24:50,100
challenge accepted and here's a little

485
00:24:50,100 --> 00:24:52,980
video of how I stole my own car in just

486
00:24:52,980 --> 00:24:55,320
under four minutes using

487
00:24:55,320 --> 00:24:59,960
um another tool and a flipper zero

488
00:25:16,140 --> 00:25:18,260
thank you

489
00:25:36,240 --> 00:25:40,450
[Music]

490
00:25:45,820 --> 00:25:49,960
[Music]

491
00:26:12,480 --> 00:26:15,480
foreign

492
00:26:43,559 --> 00:26:46,220
oops

493
00:27:01,750 --> 00:27:04,869
[Music]

494
00:27:52,200 --> 00:27:55,159
foreign

495
00:28:18,659 --> 00:28:21,659
foreign

496
00:28:58,200 --> 00:29:00,840
so like you saw once you have physical

497
00:29:00,840 --> 00:29:03,360
access into the car

498
00:29:03,360 --> 00:29:06,059
um almost everyone knows that there's

499
00:29:06,059 --> 00:29:08,700
the OBD2 port located right under the

500
00:29:08,700 --> 00:29:10,980
steering wheel and which gives you

501
00:29:10,980 --> 00:29:13,740
access into the car and

502
00:29:13,740 --> 00:29:16,919
um through that although we use a key

503
00:29:16,919 --> 00:29:18,899
programmer over here

504
00:29:18,899 --> 00:29:20,940
um I'm sure you could do the same with

505
00:29:20,940 --> 00:29:25,020
just an OBD2 to a USB and a laptop

506
00:29:25,020 --> 00:29:29,340
running any any sort of software where

507
00:29:29,340 --> 00:29:30,320
you can

508
00:29:30,320 --> 00:29:34,320
send canvas messages and access the UDS

509
00:29:34,320 --> 00:29:36,419
so

510
00:29:36,419 --> 00:29:38,700
um here's an example of that we already

511
00:29:38,700 --> 00:29:41,640
have J Turner's

512
00:29:41,640 --> 00:29:44,340
uh kantot which he also gave a talk

513
00:29:44,340 --> 00:29:46,620
about at car hacking Village and I'm

514
00:29:46,620 --> 00:29:48,899
sure he's giving one at root con too so

515
00:29:48,899 --> 00:29:52,020
with software like this it would take no

516
00:29:52,020 --> 00:29:54,299
time for someone just to download a

517
00:29:54,299 --> 00:29:57,840
script uh plug it into a car and do

518
00:29:57,840 --> 00:29:59,880
whatever they wanted because once you

519
00:29:59,880 --> 00:30:02,039
have physical access into the car

520
00:30:02,039 --> 00:30:04,500
if you know what you're doing

521
00:30:04,500 --> 00:30:07,080
um you could drive away

522
00:30:07,080 --> 00:30:08,820
um and do whatever you want with the car

523
00:30:08,820 --> 00:30:10,679
like it's your own

524
00:30:10,679 --> 00:30:12,419
so

525
00:30:12,419 --> 00:30:16,740
um this is a very serious issue

526
00:30:16,740 --> 00:30:18,299
um and

527
00:30:18,299 --> 00:30:19,799
um there's also a senator from

528
00:30:19,799 --> 00:30:22,740
Massachusetts who who sent out letters

529
00:30:22,740 --> 00:30:26,460
to most of the automotive companies

530
00:30:26,460 --> 00:30:30,059
um asking them questions as to why this

531
00:30:30,059 --> 00:30:31,799
um rise in vehicle that was happening

532
00:30:31,799 --> 00:30:34,020
and

533
00:30:34,020 --> 00:30:38,520
in fact the nhsda approximates the cost

534
00:30:38,520 --> 00:30:40,559
of stolen vehicles to be about seven

535
00:30:40,559 --> 00:30:43,980
billion dollars in 2020 alone and those

536
00:30:43,980 --> 00:30:45,840
statistics are only for the United

537
00:30:45,840 --> 00:30:49,080
States just imagine uh what the damage

538
00:30:49,080 --> 00:30:51,960
on the number will be for worldwide

539
00:30:51,960 --> 00:30:55,500
right and about 804

540
00:30:55,500 --> 00:30:57,899
000 Vehicles were stolen in 2020 alone

541
00:30:57,899 --> 00:31:00,779
again and that again is only for the

542
00:31:00,779 --> 00:31:03,480
United States so

543
00:31:03,480 --> 00:31:05,399
we did

544
00:31:05,399 --> 00:31:10,440
um have a 2018 Civic uh hatchback at the

545
00:31:10,440 --> 00:31:12,720
car hacking Village during Defcon a few

546
00:31:12,720 --> 00:31:15,840
weeks ago and I was doing demos for

547
00:31:15,840 --> 00:31:18,120
everyone that came and

548
00:31:18,120 --> 00:31:19,860
um we also had the firmware available

549
00:31:19,860 --> 00:31:22,500
when they scanned the QR code

550
00:31:22,500 --> 00:31:26,880
for The Flipper zero and uh as well as

551
00:31:26,880 --> 00:31:30,600
the unlock and lock files for the car so

552
00:31:30,600 --> 00:31:33,120
only if you had a flipper zero I could

553
00:31:33,120 --> 00:31:35,940
um I would help you out and help you set

554
00:31:35,940 --> 00:31:38,039
it up for your flipper zero and then you

555
00:31:38,039 --> 00:31:39,779
could go mess around with the car have

556
00:31:39,779 --> 00:31:42,360
fun and here's a picture of that and

557
00:31:42,360 --> 00:31:43,080
then

558
00:31:43,080 --> 00:31:45,659
on the right we have a picture of uh the

559
00:31:45,659 --> 00:31:48,480
whole kayaking Village team who uh I'm

560
00:31:48,480 --> 00:31:51,179
really grateful for for having me there

561
00:31:51,179 --> 00:31:57,600
um and also I had the honor to meet the

562
00:31:57,600 --> 00:32:00,179
president's cyber security advisor uh

563
00:32:00,179 --> 00:32:03,960
who's also the national director for

564
00:32:03,960 --> 00:32:06,600
cyber security for America uh John

565
00:32:06,600 --> 00:32:08,340
English and he gave me this really cool

566
00:32:08,340 --> 00:32:11,520
challenge coin as well and

567
00:32:11,520 --> 00:32:14,700
um he also played with the flipper zero

568
00:32:14,700 --> 00:32:17,700
and managed to unlock and lock the car

569
00:32:17,700 --> 00:32:20,340
so that was something really cool that

570
00:32:20,340 --> 00:32:23,039
we did at the car hacking Village

571
00:32:23,039 --> 00:32:23,580
um

572
00:32:23,580 --> 00:32:26,940
so what next

573
00:32:26,940 --> 00:32:29,340
um you can join us on this journey too

574
00:32:29,340 --> 00:32:32,700
so even though this presentation only

575
00:32:32,700 --> 00:32:35,279
spoke about fixed Goods

576
00:32:35,279 --> 00:32:38,539
um Kevin and the other researchers from

577
00:32:38,539 --> 00:32:42,299
uh the black hat dog called rollback are

578
00:32:42,299 --> 00:32:45,539
actively working towards making a

579
00:32:45,539 --> 00:32:47,460
database of every single car affected

580
00:32:47,460 --> 00:32:49,200
out there whether it's

581
00:32:49,200 --> 00:32:52,140
um due to a simple replay attack or a

582
00:32:52,140 --> 00:32:54,240
rollback attack and we're exploring

583
00:32:54,240 --> 00:32:57,240
other attack factors as well so if you'd

584
00:32:57,240 --> 00:32:58,220
like to

585
00:32:58,220 --> 00:33:01,580
learn and try this out on your own car

586
00:33:01,580 --> 00:33:05,640
you can sign up at the Google form or by

587
00:33:05,640 --> 00:33:08,159
scanning the QR code below and the

588
00:33:08,159 --> 00:33:09,419
reason why

589
00:33:09,419 --> 00:33:11,399
um we all feel that it's very important

590
00:33:11,399 --> 00:33:14,640
is because uh just because the number of

591
00:33:14,640 --> 00:33:16,740
share just discuss the sheer number of

592
00:33:16,740 --> 00:33:20,640
cars out there and uh the fact that a

593
00:33:20,640 --> 00:33:24,659
Honda Civic in the United States versus

594
00:33:24,659 --> 00:33:26,820
Philippines or India is going to be very

595
00:33:26,820 --> 00:33:28,200
different

596
00:33:28,200 --> 00:33:30,600
um due to different regulations or laws

597
00:33:30,600 --> 00:33:34,799
or whatever and having an exact

598
00:33:34,799 --> 00:33:35,700
um

599
00:33:35,700 --> 00:33:39,539
a number of cars affected by this or

600
00:33:39,539 --> 00:33:41,580
knowing what cars affected by this would

601
00:33:41,580 --> 00:33:44,760
not only help law enforcement but would

602
00:33:44,760 --> 00:33:47,519
also help consumers in understanding

603
00:33:47,519 --> 00:33:48,179
um

604
00:33:48,179 --> 00:33:50,159
uh whether their car is affected or not

605
00:33:50,159 --> 00:33:52,140
and hopefully

606
00:33:52,140 --> 00:33:55,500
um this this whole initiative uh would

607
00:33:55,500 --> 00:33:58,380
bring about a positive positive impact

608
00:33:58,380 --> 00:34:01,740
on Automotive cyber security and help

609
00:34:01,740 --> 00:34:04,200
create keyless entry systems uh a tad

610
00:34:04,200 --> 00:34:07,260
bit more safer so please feel free to

611
00:34:07,260 --> 00:34:09,060
scan it you can reach out to any of us

612
00:34:09,060 --> 00:34:11,760
and we'd be more than uh happy to help

613
00:34:11,760 --> 00:34:14,159
you and these were the stickers that I

614
00:34:14,159 --> 00:34:17,099
was giving out at car hacking Village at

615
00:34:17,099 --> 00:34:19,679
Defcon as well so on the left we have

616
00:34:19,679 --> 00:34:23,639
the cve 2022 to 7254 sticker and on the

617
00:34:23,639 --> 00:34:25,859
right we had the rolling phone sticker

618
00:34:25,859 --> 00:34:27,540
as well so

619
00:34:27,540 --> 00:34:29,820
a huge thank you to everyone the Flippa

620
00:34:29,820 --> 00:34:32,159
zero team my friend Avicii who designed

621
00:34:32,159 --> 00:34:34,800
the stickers actually uh the College of

622
00:34:34,800 --> 00:34:37,320
Engineering at UMass Dartmouth

623
00:34:37,320 --> 00:34:38,580
um

624
00:34:38,580 --> 00:34:40,320
um East Coast chickpeas for helping me

625
00:34:40,320 --> 00:34:43,320
out with the programming Keys uh car

626
00:34:43,320 --> 00:34:46,080
hacking Village Defcon

627
00:34:46,080 --> 00:34:49,560
um McDonald's and mass cyber Center as

628
00:34:49,560 --> 00:34:53,040
well as root con and everyone that made

629
00:34:53,040 --> 00:34:56,219
this happen including Dax uh Jay and

630
00:34:56,219 --> 00:34:59,400
everyone else and a huge shout out to

631
00:34:59,400 --> 00:35:02,940
the umassd cyber security Center and

632
00:35:02,940 --> 00:35:05,940
professor kaslingham fiendella professor

633
00:35:05,940 --> 00:35:10,099
Liu Zhao Professor Weil as well as my

634
00:35:10,099 --> 00:35:12,780
mentor Sam Curry

635
00:35:12,780 --> 00:35:16,560
um and Jerry Woody uh Conor McLaughlin

636
00:35:16,560 --> 00:35:19,380
and everyone from kayak English Robert

637
00:35:19,380 --> 00:35:24,960
Justin Jesse uh and everyone yeah so

638
00:35:24,960 --> 00:35:25,740
um

639
00:35:25,740 --> 00:35:28,680
here's uh more references of further

640
00:35:28,680 --> 00:35:31,020
reading if you'd like to do and in case

641
00:35:31,020 --> 00:35:33,720
you can't find anything here or if you'd

642
00:35:33,720 --> 00:35:35,700
like to know more about this uh feel

643
00:35:35,700 --> 00:35:40,920
free to reach out to me and yeah have to

644
00:35:40,920 --> 00:35:43,220
plan it

