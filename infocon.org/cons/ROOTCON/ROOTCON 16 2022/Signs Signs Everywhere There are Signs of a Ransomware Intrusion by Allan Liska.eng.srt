1
00:00:00,000 --> 00:00:04,940
something here that is the Chinese apt

2
00:00:12,120 --> 00:00:14,780
all right

3
00:00:21,960 --> 00:00:23,760
there we go

4
00:00:23,760 --> 00:00:25,439
um so I was hoping y'all would play

5
00:00:25,439 --> 00:00:27,180
science science everywhere they're signs

6
00:00:27,180 --> 00:00:28,380
because I don't think anybody in this

7
00:00:28,380 --> 00:00:29,519
audience is old enough to actually

8
00:00:29,519 --> 00:00:31,439
recognize that song

9
00:00:31,439 --> 00:00:35,160
um but uh this is only for old people

10
00:00:35,160 --> 00:00:38,219
um which James to your point

11
00:00:38,219 --> 00:00:40,680
you left off stage four

12
00:00:40,680 --> 00:00:44,100
I to use your to use your Jedi analogy I

13
00:00:44,100 --> 00:00:46,860
am Obi-Wan Kenobi sitting in Tatooine

14
00:00:46,860 --> 00:00:49,800
hanging out with Jawas and sand people

15
00:00:49,800 --> 00:00:53,959
just everybody leave me alone

16
00:00:54,239 --> 00:00:57,000
so uh this actually this presentation

17
00:00:57,000 --> 00:00:59,460
started as a Twitter thread so Twitter

18
00:00:59,460 --> 00:01:03,180
can do things good sometimes feel free

19
00:01:03,180 --> 00:01:04,979
to follow me on there or don't I don't

20
00:01:04,979 --> 00:01:06,180
care

21
00:01:06,180 --> 00:01:07,920
um

22
00:01:07,920 --> 00:01:09,659
we're going to talk a little bit about

23
00:01:09,659 --> 00:01:11,520
some of the signs that are ransomware

24
00:01:11,520 --> 00:01:13,380
this is actually a ransomware threat

25
00:01:13,380 --> 00:01:15,900
hunting presentation but I call it sign

26
00:01:15,900 --> 00:01:18,659
signs because it's a little less scary

27
00:01:18,659 --> 00:01:20,759
than saying thread hunting I find when

28
00:01:20,759 --> 00:01:23,460
you start uh talking about threat

29
00:01:23,460 --> 00:01:25,380
hunting you get half the audience is

30
00:01:25,380 --> 00:01:27,540
like nah man we ain't ready for that but

31
00:01:27,540 --> 00:01:29,220
you really are you just don't know it

32
00:01:29,220 --> 00:01:30,900
yet so we're going to talk about some of

33
00:01:30,900 --> 00:01:32,820
that before we do that let's talk a

34
00:01:32,820 --> 00:01:36,180
little bit about uh uh what ransomware

35
00:01:36,180 --> 00:01:38,220
looks like this year

36
00:01:38,220 --> 00:01:40,500
and I know you all suck at raising your

37
00:01:40,500 --> 00:01:43,320
hands but I'm going to try this again

38
00:01:43,320 --> 00:01:44,340
um

39
00:01:44,340 --> 00:01:45,780
how many people think there are more

40
00:01:45,780 --> 00:01:47,460
ransomware attacks this year than last

41
00:01:47,460 --> 00:01:49,079
year

42
00:01:49,079 --> 00:01:51,180
all right how many think there are fewer

43
00:01:51,180 --> 00:01:52,920
ransomware attacks this year than last

44
00:01:52,920 --> 00:01:55,159
year

45
00:01:55,380 --> 00:01:56,880
all right

46
00:01:56,880 --> 00:01:59,280
how many all have no opinion

47
00:01:59,280 --> 00:02:01,439
yeah okay I figured most of you

48
00:02:01,439 --> 00:02:04,860
um so 1900 ransomware attacks in uh

49
00:02:04,860 --> 00:02:08,038
posted to extortion sites in 2022 that

50
00:02:08,038 --> 00:02:10,919
is actually up from the previous year to

51
00:02:10,919 --> 00:02:12,959
this point however

52
00:02:12,959 --> 00:02:15,720
I always have to emphasize this the

53
00:02:15,720 --> 00:02:17,940
number of attacks posted to ransomware

54
00:02:17,940 --> 00:02:20,760
extortion sites is not a full picture of

55
00:02:20,760 --> 00:02:22,800
the number of ransomware attacks most

56
00:02:22,800 --> 00:02:24,540
ransomware attacks never make it to

57
00:02:24,540 --> 00:02:26,180
extortion sites

58
00:02:26,180 --> 00:02:28,800
we've also seen this year 35 law

59
00:02:28,800 --> 00:02:30,060
enforcement action taken against

60
00:02:30,060 --> 00:02:31,680
ransomware groups which was way more

61
00:02:31,680 --> 00:02:34,020
than in previous years and this is just

62
00:02:34,020 --> 00:02:36,420
a trend of what's been happening in

63
00:02:36,420 --> 00:02:39,420
ransomware extortion sites

64
00:02:39,420 --> 00:02:41,360
new this year

65
00:02:41,360 --> 00:02:43,400
we have

66
00:02:43,400 --> 00:02:46,080
170 new ransomware groups that we've

67
00:02:46,080 --> 00:02:49,860
identified in all of last year there

68
00:02:49,860 --> 00:02:53,640
were about 150. now I say new ransomware

69
00:02:53,640 --> 00:02:55,560
groups that doesn't mean new ransomware

70
00:02:55,560 --> 00:02:57,900
variants the problem is in the last year

71
00:02:57,900 --> 00:03:00,360
we've seen Revo code leaked we've seen

72
00:03:00,360 --> 00:03:03,300
Conti code linked we've now seen lockbid

73
00:03:03,300 --> 00:03:05,519
code leak and I'm loving for those of

74
00:03:05,519 --> 00:03:07,500
you that follow this kind of stuff I'm

75
00:03:07,500 --> 00:03:09,540
loving the Meltdown locket lock bit is

76
00:03:09,540 --> 00:03:11,879
having because those guys

77
00:03:11,879 --> 00:03:14,459
um and uh

78
00:03:14,459 --> 00:03:16,260
um you know so what we're seeing is

79
00:03:16,260 --> 00:03:19,019
we're seeing a lot of groups that are

80
00:03:19,019 --> 00:03:21,780
saying the ransomware is a service which

81
00:03:21,780 --> 00:03:23,879
has been driving ransomware for the last

82
00:03:23,879 --> 00:03:25,920
two years A lot of people are starting

83
00:03:25,920 --> 00:03:27,900
to realize

84
00:03:27,900 --> 00:03:29,640
um oh yeah if I join up with the

85
00:03:29,640 --> 00:03:31,800
ransomware as a service offering I'm

86
00:03:31,800 --> 00:03:33,540
likely going to get nabbed by the police

87
00:03:33,540 --> 00:03:36,780
since they're in kind of everything so

88
00:03:36,780 --> 00:03:38,879
more and more ransomer groups are kind

89
00:03:38,879 --> 00:03:40,440
of saying you know what I'm just going

90
00:03:40,440 --> 00:03:42,780
to stay small kind of like artisanal

91
00:03:42,780 --> 00:03:45,659
ransomware except using stolen code from

92
00:03:45,659 --> 00:03:48,420
one of the big groups that was leaked

93
00:03:48,420 --> 00:03:49,680
um

94
00:03:49,680 --> 00:03:52,379
we're also seeing ransomware actors get

95
00:03:52,379 --> 00:03:55,700
more creative with their extortion

96
00:03:55,700 --> 00:03:58,379
there's been a whole lot of that what we

97
00:03:58,379 --> 00:04:00,720
call the kind of expanded extortion

98
00:04:00,720 --> 00:04:03,180
ecosystem so you know most of the time

99
00:04:03,180 --> 00:04:05,159
when we think about extortion right now

100
00:04:05,159 --> 00:04:06,480
we think

101
00:04:06,480 --> 00:04:10,620
pay to get your files unlocked or you

102
00:04:10,620 --> 00:04:12,720
know pay not to have your files posted

103
00:04:12,720 --> 00:04:14,879
to one of the extortion sites or the

104
00:04:14,879 --> 00:04:16,798
data League sites but we're actually

105
00:04:16,798 --> 00:04:19,798
seeing a big growth in this kind of

106
00:04:19,798 --> 00:04:22,160
industry where we see ransomware groups

107
00:04:22,160 --> 00:04:25,100
threatening to launch DDOS attacks

108
00:04:25,100 --> 00:04:28,740
reaching out to victims either clients

109
00:04:28,740 --> 00:04:31,320
or business partners to let them know

110
00:04:31,320 --> 00:04:33,780
that they've been hit with ransomware uh

111
00:04:33,780 --> 00:04:36,300
some personal attacks we've seen them

112
00:04:36,300 --> 00:04:38,699
going uh threatening to report to stock

113
00:04:38,699 --> 00:04:40,040
exchanges

114
00:04:40,040 --> 00:04:42,380
specifically targeting

115
00:04:42,380 --> 00:04:45,900
the c-suites endpoints and grabbing

116
00:04:45,900 --> 00:04:48,180
devices off of there or grabbing

117
00:04:48,180 --> 00:04:49,919
sensitive files off their using

118
00:04:49,919 --> 00:04:53,580
negotiation really that's kind of if

119
00:04:53,580 --> 00:04:55,620
there's a way to be a bastard about a

120
00:04:55,620 --> 00:04:57,840
ransomware attack the ransomware actors

121
00:04:57,840 --> 00:05:00,860
have found a way to uh to do that

122
00:05:00,860 --> 00:05:04,680
so uh we're we're definitely seeing much

123
00:05:04,680 --> 00:05:09,780
much more that and continue you too and

124
00:05:09,780 --> 00:05:12,840
my personal favorite is the fact that

125
00:05:12,840 --> 00:05:14,520
they get the ransomware actors

126
00:05:14,520 --> 00:05:18,380
themselves they get all upset with you

127
00:05:18,380 --> 00:05:22,500
if you get upset with them so like for

128
00:05:22,500 --> 00:05:25,080
example we've seen this in uh ransomware

129
00:05:25,080 --> 00:05:26,639
attacks against schools which are really

130
00:05:26,639 --> 00:05:29,460
really bad this year what will happen is

131
00:05:29,460 --> 00:05:30,900
the school refuses to pay because

132
00:05:30,900 --> 00:05:33,060
schools don't have enough money to pay a

133
00:05:33,060 --> 00:05:34,680
hundred thousand two hundred thousand or

134
00:05:34,680 --> 00:05:37,199
five hundred thousand dollar in Ransom

135
00:05:37,199 --> 00:05:39,960
um and so those send the the ransomware

136
00:05:39,960 --> 00:05:41,580
actor will send a note to the parents

137
00:05:41,580 --> 00:05:43,500
saying your school refuses to pay and

138
00:05:43,500 --> 00:05:45,060
your kids stuff is going to be exposed

139
00:05:45,060 --> 00:05:46,620
on the internet because your school

140
00:05:46,620 --> 00:05:49,020
refuses to pay well no the kids stuff's

141
00:05:49,020 --> 00:05:50,220
going to be exposed on the internet

142
00:05:50,220 --> 00:05:51,720
because you're a bastard just accept

143
00:05:51,720 --> 00:05:53,880
that and stop trying to blame the school

144
00:05:53,880 --> 00:05:55,620
for doing the right thing and not paying

145
00:05:55,620 --> 00:05:57,240
you

146
00:05:57,240 --> 00:05:59,820
anyway that's kind of where we are with

147
00:05:59,820 --> 00:06:02,100
ransomware and now we're going to talk a

148
00:06:02,100 --> 00:06:06,000
little bit about threat hunting and how

149
00:06:06,000 --> 00:06:09,240
you as an organization can find the

150
00:06:09,240 --> 00:06:11,039
ransomware actor before they do bad

151
00:06:11,039 --> 00:06:13,199
things in your network

152
00:06:13,199 --> 00:06:14,820
um

153
00:06:14,820 --> 00:06:16,500
threat hunting doesn't have to be scary

154
00:06:16,500 --> 00:06:18,479
it can be there's a lot there's really

155
00:06:18,479 --> 00:06:19,620
you can do really complicated and

156
00:06:19,620 --> 00:06:21,300
amazing things with thread hunting but

157
00:06:21,300 --> 00:06:23,039
there's some simple basic things that a

158
00:06:23,039 --> 00:06:24,840
lot of orgs don't do you know again what

159
00:06:24,840 --> 00:06:27,060
you said covering the basics

160
00:06:27,060 --> 00:06:29,699
um uh you know there's a lot of simple

161
00:06:29,699 --> 00:06:31,500
basic things that you can do to look for

162
00:06:31,500 --> 00:06:33,000
ransomware actors in your network before

163
00:06:33,000 --> 00:06:34,979
they do things

164
00:06:34,979 --> 00:06:38,460
um and so but enough organ most

165
00:06:38,460 --> 00:06:40,319
organizations don't do that and we're

166
00:06:40,319 --> 00:06:43,199
going to help you get ahead of them

167
00:06:43,199 --> 00:06:44,940
um before I do that I want to talk

168
00:06:44,940 --> 00:06:47,400
really quickly about the dwell time

169
00:06:47,400 --> 00:06:50,580
uh if you Google hey how long is the

170
00:06:50,580 --> 00:06:52,020
average ransomware actor in your network

171
00:06:52,020 --> 00:06:54,300
you'll come up with a number 43 days

172
00:06:54,300 --> 00:06:56,340
that's wrong please don't believe that

173
00:06:56,340 --> 00:06:58,500
you don't have 43 days to find the rants

174
00:06:58,500 --> 00:07:00,000
more actor

175
00:07:00,000 --> 00:07:02,340
um now you also see like if you look at

176
00:07:02,340 --> 00:07:04,680
dfir report which I love if you get a

177
00:07:04,680 --> 00:07:05,520
chance

178
00:07:05,520 --> 00:07:07,680
sign up for dfir report get their

179
00:07:07,680 --> 00:07:09,479
regular reports they do a great job of

180
00:07:09,479 --> 00:07:12,780
really sharing valuable information you

181
00:07:12,780 --> 00:07:14,220
know they'll have headlines like

182
00:07:14,220 --> 00:07:16,319
ransomware you know uh ransomware

183
00:07:16,319 --> 00:07:17,940
initial access to deployment in five

184
00:07:17,940 --> 00:07:18,900
hours

185
00:07:18,900 --> 00:07:21,060
it's usually more than five hours you

186
00:07:21,060 --> 00:07:23,220
normally have a couple days to maybe a

187
00:07:23,220 --> 00:07:25,259
week between when the initial access

188
00:07:25,259 --> 00:07:28,139
broker gains that first access and when

189
00:07:28,139 --> 00:07:30,800
ransomware is finally deployed

190
00:07:30,800 --> 00:07:33,900
so you do have some dwell time you do

191
00:07:33,900 --> 00:07:36,240
have time to uh

192
00:07:36,240 --> 00:07:39,900
you do have time to find the ransomware

193
00:07:39,900 --> 00:07:42,680
actor you just don't have the 43 days

194
00:07:42,680 --> 00:07:45,479
and also and we'll talk about this more

195
00:07:45,479 --> 00:07:46,440
in a minute

196
00:07:46,440 --> 00:07:48,539
I can't step away I guess huh

197
00:07:48,539 --> 00:07:51,000
um the um

198
00:07:51,000 --> 00:07:53,639
there's normally more than one party

199
00:07:53,639 --> 00:07:55,440
involved in a ransomware attack you have

200
00:07:55,440 --> 00:07:56,940
the initial access broker and you have

201
00:07:56,940 --> 00:07:59,240
the ransomware actor just keep in mind

202
00:07:59,240 --> 00:08:02,400
that when you are talking about the

203
00:08:02,400 --> 00:08:04,139
stages

204
00:08:04,139 --> 00:08:05,940
so

205
00:08:05,940 --> 00:08:08,160
let's talk about what a ransomware

206
00:08:08,160 --> 00:08:09,780
attack looks like

207
00:08:09,780 --> 00:08:12,539
this is what most ransomware attacks

208
00:08:12,539 --> 00:08:13,319
look like

209
00:08:13,319 --> 00:08:15,599
all right you start with your initial

210
00:08:15,599 --> 00:08:17,460
access and your initial access is

211
00:08:17,460 --> 00:08:19,199
normally carried out by a third party

212
00:08:19,199 --> 00:08:22,080
not the actual ransomware actor there

213
00:08:22,080 --> 00:08:23,940
are a number of ways that ransomware

214
00:08:23,940 --> 00:08:26,879
actors gain that initial access you have

215
00:08:26,879 --> 00:08:29,280
phishing credential stuffing and reuse

216
00:08:29,280 --> 00:08:30,960
and I can tell you that credential

217
00:08:30,960 --> 00:08:33,599
stuffing and reuse for the most part has

218
00:08:33,599 --> 00:08:35,458
overtaken fishing there are a couple of

219
00:08:35,458 --> 00:08:37,320
groups that still heavily rely on

220
00:08:37,320 --> 00:08:40,020
fishing but most groups that are using

221
00:08:40,020 --> 00:08:42,299
initial access Brokers love credential

222
00:08:42,299 --> 00:08:44,339
stuffing and credential reuse because

223
00:08:44,339 --> 00:08:46,200
there's like 10 billion and that's not

224
00:08:46,200 --> 00:08:47,700
an exaggerated number there are

225
00:08:47,700 --> 00:08:49,200
literally 10 billion credentials

226
00:08:49,200 --> 00:08:51,240
available for sale or free on

227
00:08:51,240 --> 00:08:53,580
underground markets I will not use the

228
00:08:53,580 --> 00:08:55,440
term dark web that's a made-up marketing

229
00:08:55,440 --> 00:08:57,720
term and every time that somebody uses

230
00:08:57,720 --> 00:08:59,880
dark web in a presentation today you

231
00:08:59,880 --> 00:09:01,260
usually have to get a shot from these

232
00:09:01,260 --> 00:09:03,120
people and drink it I'm pretty sure

233
00:09:03,120 --> 00:09:04,740
somebody crowdstrike that made up that

234
00:09:04,740 --> 00:09:07,200
term too so blame Aaron every time you

235
00:09:07,200 --> 00:09:08,940
have to take a drink

236
00:09:08,940 --> 00:09:10,080
um

237
00:09:10,080 --> 00:09:14,220
uh we also see um we also see a big

238
00:09:14,220 --> 00:09:16,200
increase in third party intrusions so

239
00:09:16,200 --> 00:09:17,640
your partners

240
00:09:17,640 --> 00:09:19,140
um that are connected into your network

241
00:09:19,140 --> 00:09:21,180
uh especially your managed service

242
00:09:21,180 --> 00:09:23,940
providers they're often targeted and

243
00:09:23,940 --> 00:09:26,519
kind of like the way nation-state actors

244
00:09:26,519 --> 00:09:29,399
gain initial access the ransomware

245
00:09:29,399 --> 00:09:31,200
actors have figured out oh if I land in

246
00:09:31,200 --> 00:09:34,019
this person who has access to 20 or 30

247
00:09:34,019 --> 00:09:36,779
other uh networks rather than deploy the

248
00:09:36,779 --> 00:09:38,279
ransomware here I'm going to use their

249
00:09:38,279 --> 00:09:41,040
access to jump to the next one big

250
00:09:41,040 --> 00:09:42,779
increase in that and you definitely want

251
00:09:42,779 --> 00:09:44,360
to keep an eye on that

252
00:09:44,360 --> 00:09:47,820
exploitation uh last year we tracked 52

253
00:09:47,820 --> 00:09:50,399
different exploits that were that were

254
00:09:50,399 --> 00:09:52,080
used by ransomware actors to gain

255
00:09:52,080 --> 00:09:53,339
initial access

256
00:09:53,339 --> 00:09:56,820
to be clear all but one of those that

257
00:09:56,820 --> 00:10:00,300
was the case attack were known exploits

258
00:10:00,300 --> 00:10:02,279
that there was already proof of concept

259
00:10:02,279 --> 00:10:04,920
code out for so while the ransomware

260
00:10:04,920 --> 00:10:08,160
actors have the money to uh to build out

261
00:10:08,160 --> 00:10:10,320
zero days and so on for the most part

262
00:10:10,320 --> 00:10:12,300
they don't have to because y'all don't

263
00:10:12,300 --> 00:10:14,040
patch your stuff

264
00:10:14,040 --> 00:10:16,279
um I hate to be rude but it's true

265
00:10:16,279 --> 00:10:18,959
there's too many networks out there that

266
00:10:18,959 --> 00:10:20,279
are leaving things exposed to the

267
00:10:20,279 --> 00:10:22,200
internet especially VPN concentrators

268
00:10:22,200 --> 00:10:24,959
with Transformer actors love to hit

269
00:10:24,959 --> 00:10:27,600
um and nation states love to hit them

270
00:10:27,600 --> 00:10:30,660
too uh are out there unpatched they find

271
00:10:30,660 --> 00:10:33,959
them they patch them and then bam

272
00:10:33,959 --> 00:10:36,120
uh the new thing that we're seeing that

273
00:10:36,120 --> 00:10:38,100
a lot of ransomware actors are

274
00:10:38,100 --> 00:10:40,200
interested in specifically lockbid and

275
00:10:40,200 --> 00:10:42,540
lapses Insider threat they're looking to

276
00:10:42,540 --> 00:10:46,560
pay employees in your company to click

277
00:10:46,560 --> 00:10:48,600
on a link install a USB drive whatever

278
00:10:48,600 --> 00:10:51,420
we saw this last year with Tesla they

279
00:10:51,420 --> 00:10:54,360
offered him a million dollars to uh they

280
00:10:54,360 --> 00:10:56,459
offered a guy a Tesla a million bucks to

281
00:10:56,459 --> 00:10:59,060
uh

282
00:11:02,880 --> 00:11:04,320
okay

283
00:11:04,320 --> 00:11:06,060
um I guess y'all don't get to see this

284
00:11:06,060 --> 00:11:10,680
uh my stepping on something or

285
00:11:10,680 --> 00:11:14,180
is it my bad laptop

286
00:11:15,060 --> 00:11:16,920
okay we're good

287
00:11:16,920 --> 00:11:18,300
um I'm sorry I made the joke about

288
00:11:18,300 --> 00:11:20,760
crowdstrike please don't uh hack my

289
00:11:20,760 --> 00:11:22,740
presentation anymore

290
00:11:22,740 --> 00:11:23,399
um

291
00:11:23,399 --> 00:11:26,579
anyway uh uh you know and he called the

292
00:11:26,579 --> 00:11:28,800
FBI but ask yourself

293
00:11:28,800 --> 00:11:30,540
how many employees in your organization

294
00:11:30,540 --> 00:11:32,579
would well maybe not hear called the FBI

295
00:11:32,579 --> 00:11:35,940
but we call the equivalent of the FBI if

296
00:11:35,940 --> 00:11:37,200
um if they were offered a million

297
00:11:37,200 --> 00:11:39,899
dollars to insert a thumb drive

298
00:11:39,899 --> 00:11:41,640
um uh

299
00:11:41,640 --> 00:11:43,920
the thing is right now they're not very

300
00:11:43,920 --> 00:11:45,839
good at this

301
00:11:45,839 --> 00:11:46,380
um

302
00:11:46,380 --> 00:11:50,399
and so it's not that big of a threat yet

303
00:11:50,399 --> 00:11:52,140
but the fact that they're thinking about

304
00:11:52,140 --> 00:11:54,120
it means you as an organization should

305
00:11:54,120 --> 00:11:56,279
be thinking about it

306
00:11:56,279 --> 00:11:57,480
um

307
00:11:57,480 --> 00:11:59,100
once they're in the network the

308
00:11:59,100 --> 00:12:00,899
reconnaissance and the lateral movement

309
00:12:00,899 --> 00:12:04,800
is the longest part of the time that the

310
00:12:04,800 --> 00:12:06,360
ransomware actor spends in the network

311
00:12:06,360 --> 00:12:08,760
that is where they have to gain a niche

312
00:12:08,760 --> 00:12:10,079
they have to gain that initial access

313
00:12:10,079 --> 00:12:13,680
they have to gain admin access they have

314
00:12:13,680 --> 00:12:15,899
to find all the yummy things in the

315
00:12:15,899 --> 00:12:18,480
network they have to get access to your

316
00:12:18,480 --> 00:12:20,940
your active directory controller every

317
00:12:20,940 --> 00:12:22,800
single ransomware actor wants access to

318
00:12:22,800 --> 00:12:25,320
your uh you know to your your domain

319
00:12:25,320 --> 00:12:28,260
controller so that should whatever Extra

320
00:12:28,260 --> 00:12:29,880
Protection you need to put around that

321
00:12:29,880 --> 00:12:31,680
you really should like wrap it in bubble

322
00:12:31,680 --> 00:12:33,240
wrap and whatever else you need to do

323
00:12:33,240 --> 00:12:35,700
but we see the same tools being used

324
00:12:35,700 --> 00:12:39,600
over and over again Cobalt strike uh you

325
00:12:39,600 --> 00:12:41,459
know like the Chinese actors and the

326
00:12:41,459 --> 00:12:44,220
Russian actors and the Iranian actors

327
00:12:44,220 --> 00:12:46,980
the um

328
00:12:46,980 --> 00:12:49,860
the nice people who deploy ransomware

329
00:12:49,860 --> 00:12:52,200
love themselves some Cobalt strike they

330
00:12:52,200 --> 00:12:54,660
also love sliver that's another similar

331
00:12:54,660 --> 00:12:56,760
tool to Cobalt strike there's a whole

332
00:12:56,760 --> 00:12:59,639
lot of living off the land as well

333
00:12:59,639 --> 00:13:01,200
but then there are tools that they like

334
00:13:01,200 --> 00:13:03,420
to use inside the network

335
00:13:03,420 --> 00:13:07,200
um uh ad Recon ad fine Bloodhound Mimi

336
00:13:07,200 --> 00:13:08,519
cats

337
00:13:08,519 --> 00:13:11,579
um uh Lovins we see these kind of tools

338
00:13:11,579 --> 00:13:14,100
being used over and over again and

339
00:13:14,100 --> 00:13:15,360
they're looking for your domain

340
00:13:15,360 --> 00:13:17,100
controllers your windows servers your

341
00:13:17,100 --> 00:13:20,339
esxi servers and your Linux servers

342
00:13:20,339 --> 00:13:20,940
um

343
00:13:20,940 --> 00:13:23,700
almost all ransomware variants now have

344
00:13:23,700 --> 00:13:27,360
an esxi and a Linux version

345
00:13:27,360 --> 00:13:30,240
um so they are going after those servers

346
00:13:30,240 --> 00:13:32,399
once they've gotten the access they need

347
00:13:32,399 --> 00:13:34,019
and they found all the good files they

348
00:13:34,019 --> 00:13:35,940
have to exfiltrate those files and they

349
00:13:35,940 --> 00:13:37,980
are not subtle about it they will take

350
00:13:37,980 --> 00:13:39,899
and they will shove out gigs of data

351
00:13:39,899 --> 00:13:43,079
across your firewall all at once using

352
00:13:43,079 --> 00:13:45,720
the same kind of tools uh steel bits

353
00:13:45,720 --> 00:13:49,800
7-Zip wind SCP arclone Mega sync and

354
00:13:49,800 --> 00:13:52,079
then they'll deploy the ransomware and

355
00:13:52,079 --> 00:13:54,480
then after the ransomware they'll start

356
00:13:54,480 --> 00:13:56,880
the negotiation process blah blah blah

357
00:13:56,880 --> 00:13:59,160
and then if you refuse to pay or you're

358
00:13:59,160 --> 00:14:01,800
slow to respond they will

359
00:14:01,800 --> 00:14:02,420
um

360
00:14:02,420 --> 00:14:05,519
they they will uh upload your data to

361
00:14:05,519 --> 00:14:07,380
extortion sites

362
00:14:07,380 --> 00:14:10,560
so when we talk about the kind of things

363
00:14:10,560 --> 00:14:11,940
we're going to talk about when we get to

364
00:14:11,940 --> 00:14:13,639
threat hunting

365
00:14:13,639 --> 00:14:15,959
every Network's a little bit different

366
00:14:15,959 --> 00:14:18,420
so you're going to see a lot of Yara

367
00:14:18,420 --> 00:14:20,220
roll signal rules and other things that

368
00:14:20,220 --> 00:14:22,620
I'm going to share with you that may

369
00:14:22,620 --> 00:14:24,660
work in your network they may not the

370
00:14:24,660 --> 00:14:26,279
idea is to take this intelligence

371
00:14:26,279 --> 00:14:28,860
wherever you get it from you want to use

372
00:14:28,860 --> 00:14:30,420
that to build your thread hunting

373
00:14:30,420 --> 00:14:33,120
packages in your network refine those

374
00:14:33,120 --> 00:14:35,519
searches and record them into your

375
00:14:35,519 --> 00:14:38,160
regular security workflow so with few

376
00:14:38,160 --> 00:14:40,980
exceptions most of the new intelligence

377
00:14:40,980 --> 00:14:43,740
that you get should not be a regular

378
00:14:43,740 --> 00:14:46,199
threat hunting pattern it should go into

379
00:14:46,199 --> 00:14:48,899
your security workflow after you've

380
00:14:48,899 --> 00:14:51,060
refined it and then given feedback to

381
00:14:51,060 --> 00:14:53,160
the source to say hey again to your

382
00:14:53,160 --> 00:14:55,199
point about sharing you want to make

383
00:14:55,199 --> 00:14:57,420
this better

384
00:14:57,420 --> 00:14:59,760
effective threat hunting only works when

385
00:14:59,760 --> 00:15:01,440
you have good Network hygiene I know

386
00:15:01,440 --> 00:15:03,480
that's obvious but I have to say it like

387
00:15:03,480 --> 00:15:06,779
it's one of those things that drives me

388
00:15:06,779 --> 00:15:09,060
nuts if you do really good asset

389
00:15:09,060 --> 00:15:10,740
management or really good vulnerability

390
00:15:10,740 --> 00:15:12,839
management no one's going to ask you to

391
00:15:12,839 --> 00:15:15,060
speak at RSA or black hat because that's

392
00:15:15,060 --> 00:15:17,760
not cool and sexy but hey I've got a

393
00:15:17,760 --> 00:15:19,440
presentation on thread hunting and it

394
00:15:19,440 --> 00:15:21,959
really doesn't matter whether or not

395
00:15:21,959 --> 00:15:24,300
you've done the basics you can have

396
00:15:24,300 --> 00:15:26,220
threat hunting and that'll get you

397
00:15:26,220 --> 00:15:28,199
invited to speak at RSA and black hat

398
00:15:28,199 --> 00:15:31,199
because it's cool and sexy

399
00:15:31,199 --> 00:15:31,800
um

400
00:15:31,800 --> 00:15:34,320
number one thing

401
00:15:34,320 --> 00:15:36,120
you've spent all this money on your

402
00:15:36,120 --> 00:15:38,399
endpoint detection tool first thing the

403
00:15:38,399 --> 00:15:39,600
ransomware actor is going to do when

404
00:15:39,600 --> 00:15:41,100
they get in the network is shut that off

405
00:15:41,100 --> 00:15:42,600
because they know whatever detection

406
00:15:42,600 --> 00:15:44,459
tool you have in there will probably

407
00:15:44,459 --> 00:15:46,199
detect their activity

408
00:15:46,199 --> 00:15:48,720
so the number one thing I tell people to

409
00:15:48,720 --> 00:15:50,220
if you take anything away from this

410
00:15:50,220 --> 00:15:53,220
presentation alert and react when a

411
00:15:53,220 --> 00:15:55,019
third party process shuts off your

412
00:15:55,019 --> 00:15:56,820
endpoint detection tool because it's

413
00:15:56,820 --> 00:15:59,160
probably a bad thing that is getting

414
00:15:59,160 --> 00:16:01,800
ready to get started in your network too

415
00:16:01,800 --> 00:16:04,800
many organizations don't do that you

416
00:16:04,800 --> 00:16:06,959
know it goes off it's a low-level alert

417
00:16:06,959 --> 00:16:09,060
when you check it three weeks later it's

418
00:16:09,060 --> 00:16:10,320
already too late you've been hit with

419
00:16:10,320 --> 00:16:13,920
ransomware so long when a third-party

420
00:16:13,920 --> 00:16:18,079
tool shuts off your endpoint detection

421
00:16:18,120 --> 00:16:20,760
um for initial access quack bot uh

422
00:16:20,760 --> 00:16:23,279
quackbot for those uh ransomware groups

423
00:16:23,279 --> 00:16:25,800
that um are deploying a loader or the

424
00:16:25,800 --> 00:16:27,300
initial access Brokers that are

425
00:16:27,300 --> 00:16:31,019
deploying a loader uh quackbot is a

426
00:16:31,019 --> 00:16:33,360
really great tool is a tool that they

427
00:16:33,360 --> 00:16:36,300
often use we see quackbot associated

428
00:16:36,300 --> 00:16:37,680
with a lot of different ransomware

429
00:16:37,680 --> 00:16:40,160
groups and other malware as well

430
00:16:40,160 --> 00:16:44,820
so this is uh this is a Yar roll for

431
00:16:44,820 --> 00:16:47,639
um for detecting quack bots so if you

432
00:16:47,639 --> 00:16:52,019
have some sort of EDR or edx tool you

433
00:16:52,019 --> 00:16:56,279
can plug this in and look for crackpot

434
00:16:56,279 --> 00:16:58,699
alerts

435
00:16:59,300 --> 00:17:02,880
same thing so sakulish is part of a lot

436
00:17:02,880 --> 00:17:04,380
of different fishing campaigns and

437
00:17:04,380 --> 00:17:05,880
you'll see a lot of different variants

438
00:17:05,880 --> 00:17:09,119
of stockholish so having signature

439
00:17:09,119 --> 00:17:12,059
detection looking for Yara rolls you

440
00:17:12,059 --> 00:17:14,040
know suck galicious basically an

441
00:17:14,040 --> 00:17:16,199
obfuscate the JavaScript so there are

442
00:17:16,199 --> 00:17:18,599
ways to detect it again through EDR or

443
00:17:18,599 --> 00:17:20,099
through your mail program your mail

444
00:17:20,099 --> 00:17:22,199
security system if your mail security

445
00:17:22,199 --> 00:17:24,599
system allows the ingestion of Yar rolls

446
00:17:24,599 --> 00:17:28,579
which is always a good thing to find out

447
00:17:29,520 --> 00:17:30,360
um

448
00:17:30,360 --> 00:17:32,340
every ransomware group almost every

449
00:17:32,340 --> 00:17:34,740
ransomware group that I've seen uses

450
00:17:34,740 --> 00:17:36,780
Powershell

451
00:17:36,780 --> 00:17:37,740
um

452
00:17:37,740 --> 00:17:39,780
and you probably use Powershell in your

453
00:17:39,780 --> 00:17:41,880
network too so this is kind of the

454
00:17:41,880 --> 00:17:43,500
exception to the role of the the

455
00:17:43,500 --> 00:17:45,720
workflow this is more of like a Sans

456
00:17:45,720 --> 00:17:50,100
type of threat hunting or a um or if

457
00:17:50,100 --> 00:17:51,720
you've ever taken any of Chris Saunders

458
00:17:51,720 --> 00:17:55,020
course uh his course on thread hunting

459
00:17:55,020 --> 00:17:55,980
um

460
00:17:55,980 --> 00:17:57,960
so first thing I'm going to tell you is

461
00:17:57,960 --> 00:17:59,820
if you're not logging Powershell you

462
00:17:59,820 --> 00:18:01,919
should be logging Powershell and I get

463
00:18:01,919 --> 00:18:04,100
it

464
00:18:05,039 --> 00:18:06,840
there's you're already logging too much

465
00:18:06,840 --> 00:18:10,020
stuff right uh I I I I don't know how

466
00:18:10,020 --> 00:18:11,760
old you all are but I remember when

467
00:18:11,760 --> 00:18:14,160
Splunk used to be the cool fun company

468
00:18:14,160 --> 00:18:16,919
that handed out all the fun t-shirts at

469
00:18:16,919 --> 00:18:19,320
conferences and now it eats up like half

470
00:18:19,320 --> 00:18:20,880
of your security budget because you've

471
00:18:20,880 --> 00:18:22,440
got so many things that you want to log

472
00:18:22,440 --> 00:18:25,500
into it and so I'm telling you yes log

473
00:18:25,500 --> 00:18:27,720
power shell and yes I know it's going to

474
00:18:27,720 --> 00:18:30,360
cost you another fifty thousand dollars

475
00:18:30,360 --> 00:18:32,460
a year to log all the Powershell in your

476
00:18:32,460 --> 00:18:34,740
network but there's so much value to be

477
00:18:34,740 --> 00:18:37,140
gained by threat hunting for Powershell

478
00:18:37,140 --> 00:18:40,140
so just like anything else there are

479
00:18:40,140 --> 00:18:41,220
certain things that the ransomware

480
00:18:41,220 --> 00:18:42,660
actors love to do with Powershell they

481
00:18:42,660 --> 00:18:45,059
love to disable admin accounts or create

482
00:18:45,059 --> 00:18:47,460
new admin accounts so you want to look

483
00:18:47,460 --> 00:18:49,020
for those kind of activities in

484
00:18:49,020 --> 00:18:50,700
Powershell

485
00:18:50,700 --> 00:18:52,860
um look for new scripts things that

486
00:18:52,860 --> 00:18:55,140
haven't been previously run your admins

487
00:18:55,140 --> 00:18:57,660
probably have your it team probably has

488
00:18:57,660 --> 00:18:59,820
a lot of Powershell that they run in the

489
00:18:59,820 --> 00:19:01,380
network but those scripts have been

490
00:19:01,380 --> 00:19:03,240
around for a long time they they run

491
00:19:03,240 --> 00:19:05,700
fairly regularly

492
00:19:05,700 --> 00:19:08,940
um so looking for new scripts is a great

493
00:19:08,940 --> 00:19:10,799
way to find Powershell and that's a real

494
00:19:10,799 --> 00:19:12,600
easy threat hunting search because it's

495
00:19:12,600 --> 00:19:14,460
like oh hey this script's never run

496
00:19:14,460 --> 00:19:16,799
before let's go check it out yeah so

497
00:19:16,799 --> 00:19:19,620
this is the kind of like

498
00:19:19,620 --> 00:19:21,720
training wheels thread hunting that you

499
00:19:21,720 --> 00:19:22,980
can do

500
00:19:22,980 --> 00:19:25,320
once you've baselined the Powershell of

501
00:19:25,320 --> 00:19:27,299
your network this is a great way to get

502
00:19:27,299 --> 00:19:29,660
started scripts running at odd times

503
00:19:29,660 --> 00:19:32,280
especially the the Russian threat actors

504
00:19:32,280 --> 00:19:34,559
they love to do things on Friday night

505
00:19:34,559 --> 00:19:36,660
and Saturday night so looking for them

506
00:19:36,660 --> 00:19:38,160
at odd times

507
00:19:38,160 --> 00:19:41,340
and then what else and this is where

508
00:19:41,340 --> 00:19:44,760
your unique Network means that you have

509
00:19:44,760 --> 00:19:47,700
to find the things that are different to

510
00:19:47,700 --> 00:19:49,799
your network I'm not going to know

511
00:19:49,799 --> 00:19:52,260
everything that is unusual about your

512
00:19:52,260 --> 00:19:54,900
network but you should once you've built

513
00:19:54,900 --> 00:19:57,539
that Baseline anything that stands out

514
00:19:57,539 --> 00:19:59,100
from that Baseline is something you

515
00:19:59,100 --> 00:20:01,919
should be investigating

516
00:20:01,919 --> 00:20:04,140
sensitive commands I'm not talking about

517
00:20:04,140 --> 00:20:07,220
porn I'm talking about

518
00:20:07,220 --> 00:20:09,840
sensitive commands that are used in a

519
00:20:09,840 --> 00:20:11,220
lot of ransomware attacks ransomware

520
00:20:11,220 --> 00:20:13,760
actors love to use who am I task list

521
00:20:13,760 --> 00:20:16,679
synthesis info ipconfig all there are a

522
00:20:16,679 --> 00:20:18,900
few other commands that the ransomware

523
00:20:18,900 --> 00:20:21,660
actors regularly run so tracking these

524
00:20:21,660 --> 00:20:22,919
kind of commands could be again

525
00:20:22,919 --> 00:20:25,679
indicative of an early ransomware attack

526
00:20:25,679 --> 00:20:27,600
or an employee up to no good either way

527
00:20:27,600 --> 00:20:29,280
you can catch them

528
00:20:29,280 --> 00:20:31,860
if you don't have a way of logging these

529
00:20:31,860 --> 00:20:33,240
kind of commands being run so if you

530
00:20:33,240 --> 00:20:34,380
don't have any jar in your network

531
00:20:34,380 --> 00:20:37,980
things Canary offers a free Canary that

532
00:20:37,980 --> 00:20:39,900
you can install into the registry of

533
00:20:39,900 --> 00:20:42,360
your endpoints it's a great tool you get

534
00:20:42,360 --> 00:20:44,039
an email notification or you can have it

535
00:20:44,039 --> 00:20:46,020
sent to a website if you if you've got

536
00:20:46,020 --> 00:20:48,080
some sort of pager rotation

537
00:20:48,080 --> 00:20:51,140
but I highly recommend checking that out

538
00:20:51,140 --> 00:20:54,419
it's a great way to again early on in

539
00:20:54,419 --> 00:20:56,280
the ransomware attack before the

540
00:20:56,280 --> 00:20:57,960
ransomware actor has a chance to do any

541
00:20:57,960 --> 00:21:01,860
damage finding these commands being run

542
00:21:01,860 --> 00:21:04,280
can be really good

543
00:21:04,280 --> 00:21:08,700
oh yeah man sorry to disrupt your but

544
00:21:08,700 --> 00:21:10,740
I'm smiling here so you know what we're

545
00:21:10,740 --> 00:21:12,120
going to give you right

546
00:21:12,120 --> 00:21:15,120
Margo

547
00:21:17,460 --> 00:21:20,640
or we can get that for you later but for

548
00:21:20,640 --> 00:21:21,440
now

549
00:21:21,440 --> 00:21:25,620
you drink this one thank you so it's a

550
00:21:25,620 --> 00:21:28,440
tradition in your fun uh that we started

551
00:21:28,440 --> 00:21:29,400
today

552
00:21:29,400 --> 00:21:33,559
so ladies and gentlemen

553
00:21:36,380 --> 00:21:41,360
[Music]

554
00:21:41,360 --> 00:21:43,660
thank you

555
00:21:43,660 --> 00:21:46,799
[Applause]

556
00:21:50,340 --> 00:21:53,059
all right

557
00:21:53,159 --> 00:21:54,059
um

558
00:21:54,059 --> 00:21:55,919
looking for gooeys

559
00:21:55,919 --> 00:21:57,900
so

560
00:21:57,900 --> 00:21:59,940
ransomware actors tend to be a bunch of

561
00:21:59,940 --> 00:22:01,380
gen Z's that don't know how to use

562
00:22:01,380 --> 00:22:03,720
command line because they suck

563
00:22:03,720 --> 00:22:05,780
um

564
00:22:05,940 --> 00:22:09,740
I'm only saying that because I'm drunk

565
00:22:10,679 --> 00:22:12,600
honestly the problem is as an American

566
00:22:12,600 --> 00:22:14,760
by law I'm required to have a Diet Coke

567
00:22:14,760 --> 00:22:16,320
every two hours and I haven't had one

568
00:22:16,320 --> 00:22:18,059
since I've been in country and I'm

569
00:22:18,059 --> 00:22:20,280
starting to go into withdrawal

570
00:22:20,280 --> 00:22:21,840
um

571
00:22:21,840 --> 00:22:24,840
so but seriously Ransom actors loved

572
00:22:24,840 --> 00:22:26,520
their gooeys they love to use screen

573
00:22:26,520 --> 00:22:29,100
connect any desks Flagstop any other

574
00:22:29,100 --> 00:22:31,020
remote gooey products that that are out

575
00:22:31,020 --> 00:22:34,260
there if your organization doesn't allow

576
00:22:34,260 --> 00:22:36,059
the use of those guise and you probably

577
00:22:36,059 --> 00:22:38,340
don't that's a great thing to look for

578
00:22:38,340 --> 00:22:40,320
inside your network and again if you

579
00:22:40,320 --> 00:22:41,640
have crowdstrike you can load those

580
00:22:41,640 --> 00:22:43,320
hashes in because they're legitimate

581
00:22:43,320 --> 00:22:45,720
tools the hashes don't change that often

582
00:22:45,720 --> 00:22:47,760
you can load those hashes and anytime

583
00:22:47,760 --> 00:22:51,120
they pop up you can go ahead and you can

584
00:22:51,120 --> 00:22:51,780
um

585
00:22:51,780 --> 00:22:55,200
alert on those and investigate

586
00:22:55,200 --> 00:22:57,960
Cobalt strike this is a little more

587
00:22:57,960 --> 00:23:00,419
advanced but there are a lot of really

588
00:23:00,419 --> 00:23:02,760
great Yara rules and sigma rules for

589
00:23:02,760 --> 00:23:04,679
finding Cobalt strike and there are a

590
00:23:04,679 --> 00:23:07,919
lot of tools that are built into uh EDR

591
00:23:07,919 --> 00:23:08,940
um I know a lot of you are taking

592
00:23:08,940 --> 00:23:11,159
pictures of this which probably sucks I

593
00:23:11,159 --> 00:23:13,020
did send the presentation over to the

594
00:23:13,020 --> 00:23:14,640
organizers

595
00:23:14,640 --> 00:23:16,679
um it's you know and you're welcome to

596
00:23:16,679 --> 00:23:18,000
take all the pictures you want believe

597
00:23:18,000 --> 00:23:18,900
me

598
00:23:18,900 --> 00:23:22,380
um but uh it's probably easy to cut and

599
00:23:22,380 --> 00:23:24,240
paste out of the presentation so feel

600
00:23:24,240 --> 00:23:25,740
free to send that out to anybody who

601
00:23:25,740 --> 00:23:27,240
wants it

602
00:23:27,240 --> 00:23:30,659
um so looking around for indicators of

603
00:23:30,659 --> 00:23:32,940
cobalt strike is a great way to do it

604
00:23:32,940 --> 00:23:34,740
the nice thing is for the most part

605
00:23:34,740 --> 00:23:36,799
they're using older versions of cracked

606
00:23:36,799 --> 00:23:40,080
uh uh Cobalt strike because the newer

607
00:23:40,080 --> 00:23:42,360
versions haven't been cracked yet

608
00:23:42,360 --> 00:23:45,179
um so again you can find the hashes and

609
00:23:45,179 --> 00:23:46,860
you'll be able to use them

610
00:23:46,860 --> 00:23:48,780
the other thing you can look for though

611
00:23:48,780 --> 00:23:51,419
which I find really interesting and

612
00:23:51,419 --> 00:23:53,220
again and I apologize for making you

613
00:23:53,220 --> 00:23:55,860
collect even more logs if you are if

614
00:23:55,860 --> 00:23:57,480
you've got cismon and you're running

615
00:23:57,480 --> 00:23:59,460
sysmon in your network which again you

616
00:23:59,460 --> 00:24:01,440
absolutely should be

617
00:24:01,440 --> 00:24:05,640
um uh Cobalt strike creates uh default

618
00:24:05,640 --> 00:24:10,559
pipes or beacons and they use pipes

619
00:24:10,559 --> 00:24:14,039
formatted as s m SSE Dash four numbers

620
00:24:14,039 --> 00:24:15,780
Dash server

621
00:24:15,780 --> 00:24:18,179
that is consistent now you can change

622
00:24:18,179 --> 00:24:20,460
that and if you're a red team or you'll

623
00:24:20,460 --> 00:24:22,320
probably go and change that for whatever

624
00:24:22,320 --> 00:24:25,140
reason the ransomware actors don't so

625
00:24:25,140 --> 00:24:26,880
that's something that you can absolutely

626
00:24:26,880 --> 00:24:29,820
look for event ID 17 pipe created and

627
00:24:29,820 --> 00:24:35,220
event ID event ID 18 pipe connected in

628
00:24:35,220 --> 00:24:37,440
order to detect the possible use of

629
00:24:37,440 --> 00:24:39,299
cobalt strike in the network

630
00:24:39,299 --> 00:24:40,919
the very least

631
00:24:40,919 --> 00:24:43,440
you catch your red teamers uh trying to

632
00:24:43,440 --> 00:24:45,240
do things in your network and the blue

633
00:24:45,240 --> 00:24:48,659
team wins one so it's all good

634
00:24:48,659 --> 00:24:51,059
add find add find is a tool that we

635
00:24:51,059 --> 00:24:52,940
don't see a lot of people talking about

636
00:24:52,940 --> 00:24:55,919
but almost every ransomware campaign

637
00:24:55,919 --> 00:24:58,620
that I've been in hasn't uh not been in

638
00:24:58,620 --> 00:25:01,980
as an investigated just to be clear

639
00:25:01,980 --> 00:25:05,220
um uh it's gone

640
00:25:05,220 --> 00:25:06,900
um you know there's at least six

641
00:25:06,900 --> 00:25:08,460
different ransomware groups and with

642
00:25:08,460 --> 00:25:11,100
affiliate structure and so on that means

643
00:25:11,100 --> 00:25:12,720
there are probably dozens if not

644
00:25:12,720 --> 00:25:15,659
hundreds of Affiliates using it but ADV

645
00:25:15,659 --> 00:25:17,940
find is a way of basically doing

646
00:25:17,940 --> 00:25:20,280
analysis of the active directory server

647
00:25:20,280 --> 00:25:23,159
and this is a sigma rule for detecting

648
00:25:23,159 --> 00:25:24,600
ad find there are a lot of really good

649
00:25:24,600 --> 00:25:27,120
ones Florian Roth maintains a fantastic

650
00:25:27,120 --> 00:25:29,340
collection of Yar and sigma rules to

651
00:25:29,340 --> 00:25:32,039
detect ransomware actors

652
00:25:32,039 --> 00:25:33,900
um on GitHub so if you follow him on

653
00:25:33,900 --> 00:25:36,419
Twitter you should be able to do that

654
00:25:36,419 --> 00:25:37,919
um

655
00:25:37,919 --> 00:25:40,740
data transfer ransomware actors love to

656
00:25:40,740 --> 00:25:42,320
use mega.io

657
00:25:42,320 --> 00:25:46,380
for their data transfer and any of the

658
00:25:46,380 --> 00:25:48,720
sort of associated domains so mega.io

659
00:25:48,720 --> 00:25:53,580
mega.nz Etc if you don't use Mega Dido

660
00:25:53,580 --> 00:25:55,440
Io if that's not an authorized service

661
00:25:55,440 --> 00:25:57,419
in your company just go ahead and block

662
00:25:57,419 --> 00:25:58,260
it

663
00:25:58,260 --> 00:25:59,940
ransomware actors will find a way around

664
00:25:59,940 --> 00:26:01,919
it they can set up uh you know another

665
00:26:01,919 --> 00:26:04,260
server and get the data over but you'll

666
00:26:04,260 --> 00:26:06,360
have a thing to look for you'll have a

667
00:26:06,360 --> 00:26:08,640
an alert to look for if somebody's

668
00:26:08,640 --> 00:26:11,299
trying to connect out to mega.nz or

669
00:26:11,299 --> 00:26:15,600
mega.io and again look for the tools

670
00:26:15,600 --> 00:26:19,200
that they use to transfer datas

671
00:26:19,200 --> 00:26:22,140
um again our clone 7-Zip I will tell you

672
00:26:22,140 --> 00:26:25,020
if you use zoom in your network the

673
00:26:25,020 --> 00:26:25,860
um

674
00:26:25,860 --> 00:26:31,320
uh the um updates of Zoom use 7-Zip I

675
00:26:31,320 --> 00:26:32,880
found that out the hard way because we

676
00:26:32,880 --> 00:26:34,799
have a uh we have the detection in our

677
00:26:34,799 --> 00:26:35,820
Network

678
00:26:35,820 --> 00:26:37,500
um that looks for 7-Zip because it's not

679
00:26:37,500 --> 00:26:40,620
an authorized transfer tool and when the

680
00:26:40,620 --> 00:26:43,340
neck the the next Zoom update happened

681
00:26:43,340 --> 00:26:47,340
uh our screens went uh bright red

682
00:26:47,340 --> 00:26:49,740
um so listen learned there

683
00:26:49,740 --> 00:26:52,440
um but our clone Mega sync

684
00:26:52,440 --> 00:26:54,840
um 7-Zip all of these tools if they're

685
00:26:54,840 --> 00:26:57,240
not authorized in your network look for

686
00:26:57,240 --> 00:27:00,419
the hashes and the signatures there

687
00:27:00,419 --> 00:27:03,000
um that's a big way to detect the data

688
00:27:03,000 --> 00:27:06,120
transfer and hopefully stop it early you

689
00:27:06,120 --> 00:27:08,640
know the other way is and this is really

690
00:27:08,640 --> 00:27:11,880
Network specific again looking for large

691
00:27:11,880 --> 00:27:14,039
file transfers the ransomware actors

692
00:27:14,039 --> 00:27:15,840
aren't subtle they get all the data on

693
00:27:15,840 --> 00:27:18,179
one box and then push it out to whatever

694
00:27:18,179 --> 00:27:21,240
their upload server is all at once so

695
00:27:21,240 --> 00:27:22,799
looking for a really large file

696
00:27:22,799 --> 00:27:25,440
transfers to unusual domains in your

697
00:27:25,440 --> 00:27:27,480
firewall logs can be a really helpful

698
00:27:27,480 --> 00:27:29,640
way of detecting it not everybody has

699
00:27:29,640 --> 00:27:31,440
the ability to do that or even to Define

700
00:27:31,440 --> 00:27:33,120
what is considered a really large

701
00:27:33,120 --> 00:27:35,940
transfer but it is one way to go about

702
00:27:35,940 --> 00:27:37,100
it

703
00:27:37,100 --> 00:27:40,860
Shadow copy deletion I always hesitate

704
00:27:40,860 --> 00:27:43,799
to include this one in here because

705
00:27:43,799 --> 00:27:47,220
while every ransomware actor absolutely

706
00:27:47,220 --> 00:27:48,900
does this or every ransomware I've ever

707
00:27:48,900 --> 00:27:51,360
seen does this so basically before

708
00:27:51,360 --> 00:27:53,659
they've installed the ransomware

709
00:27:53,659 --> 00:27:55,919
they have to delete the local Shadow

710
00:27:55,919 --> 00:27:57,600
copies otherwise you'll just restore

711
00:27:57,600 --> 00:28:00,419
everything from the shadow copies so you

712
00:28:00,419 --> 00:28:02,279
can detect the shadow copies being

713
00:28:02,279 --> 00:28:06,120
deleted the problem is you have minutes

714
00:28:06,120 --> 00:28:09,299
to react before the encryption starts

715
00:28:09,299 --> 00:28:11,640
after the shadow copy is deleted and I

716
00:28:11,640 --> 00:28:13,140
know most

717
00:28:13,140 --> 00:28:15,480
socks that I've seen

718
00:28:15,480 --> 00:28:18,240
need at least 15 minutes from when an

719
00:28:18,240 --> 00:28:19,919
incident happens before it hits an

720
00:28:19,919 --> 00:28:22,919
analyst dashboard by then it's too late

721
00:28:22,919 --> 00:28:25,919
your thing's already being encrypted now

722
00:28:25,919 --> 00:28:28,020
that being said if you've got like a

723
00:28:28,020 --> 00:28:29,779
sword tool or something that automates

724
00:28:29,779 --> 00:28:33,120
you can hey something just deleted all

725
00:28:33,120 --> 00:28:35,460
the shadow copies let's automate the

726
00:28:35,460 --> 00:28:38,940
process of uh killing the process that

727
00:28:38,940 --> 00:28:40,620
they did

728
00:28:40,620 --> 00:28:44,520
so if your organization is using a sore

729
00:28:44,520 --> 00:28:46,020
tool like that where you can automate

730
00:28:46,020 --> 00:28:46,980
this

731
00:28:46,980 --> 00:28:49,679
that's a great way to uh to stop that

732
00:28:49,679 --> 00:28:51,779
and I know some of the edrs have the

733
00:28:51,779 --> 00:28:53,460
ability to do that as well built into

734
00:28:53,460 --> 00:28:55,559
there you have to trust the automation

735
00:28:55,559 --> 00:28:57,600
there and hope that nothing else

736
00:28:57,600 --> 00:28:59,159
actually ever deletes all the shadow

737
00:28:59,159 --> 00:29:01,860
copies which so far there's nothing I've

738
00:29:01,860 --> 00:29:04,559
seen which does do that

739
00:29:04,559 --> 00:29:05,940
and

740
00:29:05,940 --> 00:29:08,039
I did it and we're only six minutes

741
00:29:08,039 --> 00:29:09,720
behind schedule so I haven't kept you

742
00:29:09,720 --> 00:29:11,460
too much from lunch

743
00:29:11,460 --> 00:29:12,059
um

744
00:29:12,059 --> 00:29:14,400
hopefully this was helpful I really

745
00:29:14,400 --> 00:29:16,020
appreciate everybody coming and I really

746
00:29:16,020 --> 00:29:18,179
really want to thank the organizers of

747
00:29:18,179 --> 00:29:20,399
root con for accepting my presentation

748
00:29:20,399 --> 00:29:22,440
and inviting me out here this has been

749
00:29:22,440 --> 00:29:24,720
an amazing experience and and I love the

750
00:29:24,720 --> 00:29:26,520
fog I feel like I'm in a Stephen King

751
00:29:26,520 --> 00:29:28,740
movie I expect large flying insects to

752
00:29:28,740 --> 00:29:32,279
come out and eat us at some point today

753
00:29:32,279 --> 00:29:34,980
um but thank you all for coming and I'll

754
00:29:34,980 --> 00:29:36,120
be around at lunch if you have any

755
00:29:36,120 --> 00:29:39,439
questions I'm happier to take them

756
00:29:39,600 --> 00:29:41,779
foreign

757
00:29:47,840 --> 00:29:50,760
y'all pretend like I'm talking and

758
00:29:50,760 --> 00:29:54,260
you're listening with wrapped attention

759
00:29:56,220 --> 00:29:57,960
all right fantastic now I can keep my

760
00:29:57,960 --> 00:30:00,740
job for another year

761
00:30:00,899 --> 00:30:02,690
thank you all very much

762
00:30:02,690 --> 00:30:06,519
[Applause]

