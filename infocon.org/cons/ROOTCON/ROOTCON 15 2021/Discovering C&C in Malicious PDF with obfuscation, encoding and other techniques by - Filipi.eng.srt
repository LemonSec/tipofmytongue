1
00:00:02,480 --> 00:00:04,319
hello everyone thank you for joining so

2
00:00:04,319 --> 00:00:05,839
my name is philippe pedes and today

3
00:00:05,839 --> 00:00:07,200
we're going to talk about discovering

4
00:00:07,200 --> 00:00:08,400
cnc

5
00:00:08,400 --> 00:00:10,800
in malicious pdf using some techniques

6
00:00:10,800 --> 00:00:13,840
like uh confusions encoding so here my

7
00:00:13,840 --> 00:00:16,160
contacts on twitter actually feliperius

8
00:00:16,160 --> 00:00:17,039
and

9
00:00:17,039 --> 00:00:19,680
here we have some context about me

10
00:00:19,680 --> 00:00:21,439
in my projects in the github and

11
00:00:21,439 --> 00:00:22,560
linkedin

12
00:00:22,560 --> 00:00:25,039
and here my webpage if you'd like to see

13
00:00:25,039 --> 00:00:27,039
some projects that i have been working

14
00:00:27,039 --> 00:00:27,920
there

15
00:00:27,920 --> 00:00:29,840
i have some talks that i have been

16
00:00:29,840 --> 00:00:31,760
participating some events having

17
00:00:31,760 --> 00:00:34,480
articles there so just some informations

18
00:00:34,480 --> 00:00:36,000
about my projects right so let me

19
00:00:36,000 --> 00:00:38,239
introduce myself today i'm a principal

20
00:00:38,239 --> 00:00:40,239
security engineer at talk desk top desk

21
00:00:40,239 --> 00:00:42,239
this is a company from portugal by the

22
00:00:42,239 --> 00:00:44,879
way and uh responsible to sell some

23
00:00:44,879 --> 00:00:47,039
contact center as a services but my

24
00:00:47,039 --> 00:00:49,280
focus there is to work with a

25
00:00:49,280 --> 00:00:51,360
security in uh

26
00:00:51,360 --> 00:00:54,160
with the product in the environment

27
00:00:54,160 --> 00:00:56,079
and i'm security research at saint

28
00:00:56,079 --> 00:00:57,760
segura san diego it's a brazilian

29
00:00:57,760 --> 00:00:59,440
company and by the way i'm talking from

30
00:00:59,440 --> 00:01:01,920
brazil now here in sao paulo and since

31
00:01:01,920 --> 00:01:04,080
it's a company responsible to provide a

32
00:01:04,080 --> 00:01:06,080
10 solutions a privilege access

33
00:01:06,080 --> 00:01:09,760
management but my my my role there it's

34
00:01:09,760 --> 00:01:11,680
made a researches and presenting these

35
00:01:11,680 --> 00:01:14,479
researches in some conference and uh

36
00:01:14,479 --> 00:01:16,640
this company appears in many different

37
00:01:16,640 --> 00:01:19,439
reporters like gartner foreigners and

38
00:01:19,439 --> 00:01:21,680
cooper cooper colley and and so on and

39
00:01:21,680 --> 00:01:23,840
so on and i'm advocate of the hacking

40
00:01:23,840 --> 00:01:25,759
standard crime it's an awesome project

41
00:01:25,759 --> 00:01:27,600
the focus and this project leads talk

42
00:01:27,600 --> 00:01:29,920
about the hacking because it's hacking

43
00:01:29,920 --> 00:01:32,799
it's really uh mindset it's how you can

44
00:01:32,799 --> 00:01:34,640
you know look into the same software so

45
00:01:34,640 --> 00:01:37,119
how you can look into more deeply and

46
00:01:37,119 --> 00:01:39,439
how you active your creative mind so

47
00:01:39,439 --> 00:01:41,600
that's the idea of the haki right so

48
00:01:41,600 --> 00:01:43,600
it's not a crime so when you talk about

49
00:01:43,600 --> 00:01:45,280
the cyber criminals it's a cyber

50
00:01:45,280 --> 00:01:46,799
criminal it's not a hacking so this is

51
00:01:46,799 --> 00:01:49,520
the idea of this project and i am a

52
00:01:49,520 --> 00:01:51,119
coordinator of the staff team of the

53
00:01:51,119 --> 00:01:53,439
deafcom group here in sao paulo it's a

54
00:01:53,439 --> 00:01:55,759
big community here and i'm stroke

55
00:01:55,759 --> 00:01:57,759
instructor of the hacker security i have

56
00:01:57,759 --> 00:02:00,079
owl hackers act i have a course of the

57
00:02:00,079 --> 00:02:02,159
moral analysis in portuguese language of

58
00:02:02,159 --> 00:02:04,079
course and i am structured

59
00:02:04,079 --> 00:02:05,040
and

60
00:02:05,040 --> 00:02:06,880
writer and have viewer in this three

61
00:02:06,880 --> 00:02:09,119
magazine in europe and by the way i have

62
00:02:09,119 --> 00:02:11,200
the course some courses in about the

63
00:02:11,200 --> 00:02:12,560
mower attack

64
00:02:12,560 --> 00:02:15,200
uh with accutane strategy right so in

65
00:02:15,200 --> 00:02:17,280
the pandas magazine and that's some

66
00:02:17,280 --> 00:02:19,040
informations about me right so let's

67
00:02:19,040 --> 00:02:21,920
talk about our main talk today and first

68
00:02:21,920 --> 00:02:23,440
of all i'd like to put all those people

69
00:02:23,440 --> 00:02:24,879
in the same page so i would like to

70
00:02:24,879 --> 00:02:26,959
explain more just a simple definition so

71
00:02:26,959 --> 00:02:29,360
what is a thread right so it's not

72
00:02:29,360 --> 00:02:31,120
definition strong flip it's definitely

73
00:02:31,120 --> 00:02:32,879
from this iso it's defined as a

74
00:02:32,879 --> 00:02:34,720
potential cause

75
00:02:34,720 --> 00:02:36,800
of an incident that may cause arms into

76
00:02:36,800 --> 00:02:38,640
the systems and organizations it's

77
00:02:38,640 --> 00:02:40,640
really important to understand that that

78
00:02:40,640 --> 00:02:42,720
because we we're gonna talk about the

79
00:02:42,720 --> 00:02:45,280
malware right so what is exactly what

80
00:02:45,280 --> 00:02:47,519
risk real correlations of the modern

81
00:02:47,519 --> 00:02:49,840
threads right so in this case the threat

82
00:02:49,840 --> 00:02:52,480
it's more related to a softer attacks or

83
00:02:52,480 --> 00:02:54,560
maybe a theft of the intellectual

84
00:02:54,560 --> 00:02:57,519
property or identity death or sabotage

85
00:02:57,519 --> 00:02:59,680
or information distortions are example

86
00:02:59,680 --> 00:03:01,840
the information securities threats it's

87
00:03:01,840 --> 00:03:04,720
just a simple definitions but if you see

88
00:03:04,720 --> 00:03:06,159
here you can see

89
00:03:06,159 --> 00:03:08,560
many thing is related to a software so

90
00:03:08,560 --> 00:03:11,120
how you can explore the software so

91
00:03:11,120 --> 00:03:13,519
but of course remember it's related to a

92
00:03:13,519 --> 00:03:15,920
potential incident right so when you

93
00:03:15,920 --> 00:03:17,920
have some thread you need to investigate

94
00:03:17,920 --> 00:03:19,680
more that you need to looking more

95
00:03:19,680 --> 00:03:22,560
deeply about that and you can see about

96
00:03:22,560 --> 00:03:24,000
the behavior so because of this

97
00:03:24,000 --> 00:03:26,239
important you understand what is exactly

98
00:03:26,239 --> 00:03:29,519
a threat okay so let me explain more

99
00:03:29,519 --> 00:03:31,280
about the some

100
00:03:31,280 --> 00:03:33,360
steps about if you would like to use in

101
00:03:33,360 --> 00:03:35,360
the more analysis so the first step is

102
00:03:35,360 --> 00:03:37,440
you need to identify or identification

103
00:03:37,440 --> 00:03:39,680
steps about the artifact because you

104
00:03:39,680 --> 00:03:41,280
don't know if it's malicious or not

105
00:03:41,280 --> 00:03:43,840
about the sample you have a sample right

106
00:03:43,840 --> 00:03:45,920
artifact so maybe you can find some

107
00:03:45,920 --> 00:03:48,000
malware malicious software or maldoc

108
00:03:48,000 --> 00:03:49,840
malicious document so this is simple

109
00:03:49,840 --> 00:03:51,200
definitions about that so the

110
00:03:51,200 --> 00:03:52,879
identification is that it's a pretty

111
00:03:52,879 --> 00:03:55,360
important step when you need to perform

112
00:03:55,360 --> 00:03:57,439
something related to a malware analysis

113
00:03:57,439 --> 00:03:59,120
or more painting

114
00:03:59,120 --> 00:04:01,439
another name of ready hunting about the

115
00:04:01,439 --> 00:04:04,400
threads or ascend binary okay so after

116
00:04:04,400 --> 00:04:05,760
that you can choose what the best

117
00:04:05,760 --> 00:04:07,599
methodology you can apply this if you're

118
00:04:07,599 --> 00:04:09,519
using a statistic analysis or dynamic

119
00:04:09,519 --> 00:04:11,680
analysis so my recommendations to you

120
00:04:11,680 --> 00:04:13,920
it's always to using when you're

121
00:04:13,920 --> 00:04:15,599
performing some analysis you need to

122
00:04:15,599 --> 00:04:17,759
produce something right so you need to

123
00:04:17,759 --> 00:04:20,160
have something touchable okay and

124
00:04:20,160 --> 00:04:21,519
because of this you need to produce some

125
00:04:21,519 --> 00:04:23,440
report because this report you can

126
00:04:23,440 --> 00:04:26,320
present you this to some coordinator or

127
00:04:26,320 --> 00:04:28,400
some manager or whatever

128
00:04:28,400 --> 00:04:30,639
but when do you register these

129
00:04:30,639 --> 00:04:32,720
informations you can look in more deeply

130
00:04:32,720 --> 00:04:34,160
about that and you can improve your

131
00:04:34,160 --> 00:04:36,000
skills because you need to register all

132
00:04:36,000 --> 00:04:38,240
those steps that you perform in these

133
00:04:38,240 --> 00:04:40,320
analysis okay and this is very important

134
00:04:40,320 --> 00:04:42,560
so then after that you can improve your

135
00:04:42,560 --> 00:04:45,520
defenses mechanism why because when you

136
00:04:45,520 --> 00:04:48,080
discover what is exactly that path

137
00:04:48,080 --> 00:04:49,759
during these analysis you can improve

138
00:04:49,759 --> 00:04:52,080
your knowledge and these uh defenses

139
00:04:52,080 --> 00:04:54,240
mechanisms your security sensors in your

140
00:04:54,240 --> 00:04:56,160
environment your organizations okay this

141
00:04:56,160 --> 00:04:58,639
is a very important so another point is

142
00:04:58,639 --> 00:05:00,880
you can building the cyber threat

143
00:05:00,880 --> 00:05:02,400
intelligence you can create this

144
00:05:02,400 --> 00:05:04,240
intelligence in your company even your

145
00:05:04,240 --> 00:05:06,400
company it's bigger or small it's not a

146
00:05:06,400 --> 00:05:08,639
problem you have many different

147
00:05:08,639 --> 00:05:11,440
tools to help you in in how you can

148
00:05:11,440 --> 00:05:13,280
create this cyber threat intelligence

149
00:05:13,280 --> 00:05:15,360
why you it's important to create that

150
00:05:15,360 --> 00:05:18,080
because the cyber because the threats

151
00:05:18,080 --> 00:05:19,680
are changing on the time so we need to

152
00:05:19,680 --> 00:05:21,600
strengthen the cyber resilience it's a

153
00:05:21,600 --> 00:05:23,680
good reward right resilience but

154
00:05:23,680 --> 00:05:25,680
basically you need to improve that

155
00:05:25,680 --> 00:05:27,600
because the threads are the threads are

156
00:05:27,600 --> 00:05:29,759
changing all the time so let me explain

157
00:05:29,759 --> 00:05:31,600
some simple definitions about

158
00:05:31,600 --> 00:05:33,919
statistical analysis and i don't i don't

159
00:05:33,919 --> 00:05:35,600
have a time to explain more details

160
00:05:35,600 --> 00:05:38,000
about that but it's a simple uh

161
00:05:38,000 --> 00:05:40,160
explorations of automotives this usually

162
00:05:40,160 --> 00:05:42,800
is the first step in the maori studies

163
00:05:42,800 --> 00:05:44,720
why is the first because usually the

164
00:05:44,720 --> 00:05:46,800
statistics cannot describe

165
00:05:46,800 --> 00:05:49,199
the process that you you analyze in some

166
00:05:49,199 --> 00:05:52,080
program code or maybe the structure of

167
00:05:52,080 --> 00:05:54,320
this code or maybe if you find some

168
00:05:54,320 --> 00:05:57,360
functions imported by the dll inside of

169
00:05:57,360 --> 00:05:59,600
this binary so you have a binary you

170
00:05:59,600 --> 00:06:01,520
have inside of this binary you have some

171
00:06:01,520 --> 00:06:03,919
dlls and these dlls have some functions

172
00:06:03,919 --> 00:06:06,319
important so you can looking more deeply

173
00:06:06,319 --> 00:06:08,319
about that the statistical analysis so

174
00:06:08,319 --> 00:06:10,639
maybe you are thinking about so philippe

175
00:06:10,639 --> 00:06:11,440
when

176
00:06:11,440 --> 00:06:13,360
you will talking about the reversal

177
00:06:13,360 --> 00:06:15,759
engineering reversal engineer it's part

178
00:06:15,759 --> 00:06:17,600
of technique that you can be using in

179
00:06:17,600 --> 00:06:19,680
the statistical analysis and dynamic

180
00:06:19,680 --> 00:06:21,280
analysis we've been using both of them

181
00:06:21,280 --> 00:06:23,520
okay but it's a technique that you can

182
00:06:23,520 --> 00:06:26,080
apply in this methodology okay because

183
00:06:26,080 --> 00:06:28,160
when you using this uh reversing

184
00:06:28,160 --> 00:06:30,000
engineering you can looking more deeply

185
00:06:30,000 --> 00:06:31,600
about the some

186
00:06:31,600 --> 00:06:33,440
dll as i mentioned but you're looking

187
00:06:33,440 --> 00:06:34,560
more uh

188
00:06:34,560 --> 00:06:37,360
deeply to see in assembly uh program

189
00:06:37,360 --> 00:06:39,759
language so how you can look in this uh

190
00:06:39,759 --> 00:06:42,240
uh process work is in the background or

191
00:06:42,240 --> 00:06:45,199
in a more in the low level actually so

192
00:06:45,199 --> 00:06:47,280
so in this case you're looking more

193
00:06:47,280 --> 00:06:49,680
deeply to using today in reverse and

194
00:06:49,680 --> 00:06:51,120
engineer but i've been talking just a

195
00:06:51,120 --> 00:06:53,280
concept about the statisticalize okay

196
00:06:53,280 --> 00:06:55,520
and the program in this case

197
00:06:55,520 --> 00:06:57,599
it doesn't run in this time and of

198
00:06:57,599 --> 00:06:59,280
course it depends of the program because

199
00:06:59,280 --> 00:07:01,440
you need to use some programs so if you

200
00:07:01,440 --> 00:07:04,479
run the program uh you using another

201
00:07:04,479 --> 00:07:06,800
methodology but just to clarify that

202
00:07:06,800 --> 00:07:09,039
okay but usually this process is more

203
00:07:09,039 --> 00:07:12,319
safe okay because you doesn't run the

204
00:07:12,319 --> 00:07:14,479
binary in this time you can look in the

205
00:07:14,479 --> 00:07:16,400
behavior not behavior you can look in

206
00:07:16,400 --> 00:07:18,160
the same characteristics inside of the

207
00:07:18,160 --> 00:07:20,400
binary some functions and of course you

208
00:07:20,400 --> 00:07:21,840
need to understand more about the

209
00:07:21,840 --> 00:07:24,160
functions the dlls the libraries and

210
00:07:24,160 --> 00:07:26,000
something like that okay on the other

211
00:07:26,000 --> 00:07:28,000
hand you have a dynamic analysis in this

212
00:07:28,000 --> 00:07:31,120
case it's only or solely on behavior

213
00:07:31,120 --> 00:07:33,919
analysis okay so you will look in more

214
00:07:33,919 --> 00:07:36,800
the interaction of the malware has when

215
00:07:36,800 --> 00:07:39,120
the malware itself is executed in the

216
00:07:39,120 --> 00:07:41,280
environment okay so in this case it

217
00:07:41,280 --> 00:07:43,840
knows uh it's not like a run-time

218
00:07:43,840 --> 00:07:45,840
analysis because you need to run the

219
00:07:45,840 --> 00:07:47,919
mower or in this case you don't know if

220
00:07:47,919 --> 00:07:50,080
you see if you're mower or not you run

221
00:07:50,080 --> 00:07:52,800
the binary in the some

222
00:07:52,800 --> 00:07:54,879
environment and you see the behavior and

223
00:07:54,879 --> 00:07:56,800
this is the dynamic analysis remember

224
00:07:56,800 --> 00:07:58,080
when you talk about the reversing

225
00:07:58,080 --> 00:08:00,720
engineer you can look into this and some

226
00:08:00,720 --> 00:08:02,960
tools that can help you in this dynamic

227
00:08:02,960 --> 00:08:05,280
analysis and you can see the reverse

228
00:08:05,280 --> 00:08:07,039
engineer but again it's a part of

229
00:08:07,039 --> 00:08:09,199
technique using in both of them

230
00:08:09,199 --> 00:08:11,599
techniques so of course it can be easily

231
00:08:11,599 --> 00:08:14,160
automated this uh dynamic analysis using

232
00:08:14,160 --> 00:08:16,160
some tools to help you one of these

233
00:08:16,160 --> 00:08:18,400
tools that you can use in this concept

234
00:08:18,400 --> 00:08:20,879
it's called sandbox when you have some

235
00:08:20,879 --> 00:08:22,560
controller environment with a virtual

236
00:08:22,560 --> 00:08:24,800
machine and you can pick up this mower

237
00:08:24,800 --> 00:08:27,919
and you can perform it or run this mower

238
00:08:27,919 --> 00:08:29,759
or this sample inside of this virtual

239
00:08:29,759 --> 00:08:32,958
machine and you can see the behavior but

240
00:08:32,958 --> 00:08:35,519
understand that the point it's very

241
00:08:35,519 --> 00:08:37,760
important you understand is

242
00:08:37,760 --> 00:08:39,599
when you as a cook is in sandbox you

243
00:08:39,599 --> 00:08:42,399
need to have some engines right inside

244
00:08:42,399 --> 00:08:43,679
of the sandbox

245
00:08:43,679 --> 00:08:45,600
of course you can

246
00:08:45,600 --> 00:08:48,560
create your own virtual machine but you

247
00:08:48,560 --> 00:08:50,800
can execute the mower inside there you

248
00:08:50,800 --> 00:08:53,600
can just if you can see if it is

249
00:08:53,600 --> 00:08:55,519
infected or not but you don't have any

250
00:08:55,519 --> 00:08:57,600
engines but when you're using some

251
00:08:57,600 --> 00:09:00,399
sandbox to the market uh

252
00:09:00,399 --> 00:09:02,480
like you know uh

253
00:09:02,480 --> 00:09:05,519
any or or joey sandbox or another

254
00:09:05,519 --> 00:09:08,000
different services they have some

255
00:09:08,000 --> 00:09:09,680
engines inside of the sandbox that you

256
00:09:09,680 --> 00:09:11,120
can see or maybe you can use it for

257
00:09:11,120 --> 00:09:14,399
example uh drug food roof it's a pretty

258
00:09:14,399 --> 00:09:16,320
nice open source

259
00:09:16,320 --> 00:09:18,560
sandbox tools they have some engines

260
00:09:18,560 --> 00:09:20,240
inside that and then they when you

261
00:09:20,240 --> 00:09:22,480
perform that you can running seminars

262
00:09:22,480 --> 00:09:23,920
and by the way if you have some doubts

263
00:09:23,920 --> 00:09:25,920
about this kind of sandbox in open

264
00:09:25,920 --> 00:09:27,360
source or not you can send them a

265
00:09:27,360 --> 00:09:29,040
message and i can send you the link to

266
00:09:29,040 --> 00:09:31,600
you okay so just a concept okay let me

267
00:09:31,600 --> 00:09:34,320
talk about the before to talk about the

268
00:09:34,320 --> 00:09:35,760
physical and logical structure i would

269
00:09:35,760 --> 00:09:38,399
like to present you some important thing

270
00:09:38,399 --> 00:09:40,720
about this this basis okay remember when

271
00:09:40,720 --> 00:09:43,760
i i talked about the information

272
00:09:43,760 --> 00:09:46,640
uh in steps the identification steps

273
00:09:46,640 --> 00:09:48,560
when you need to understand it when you

274
00:09:48,560 --> 00:09:50,240
receive some sample to to as it could

275
00:09:50,240 --> 00:09:52,399
some analyze like me here i have some

276
00:09:52,399 --> 00:09:54,800
samples here i have the amazon i don't

277
00:09:54,800 --> 00:09:56,959
know what exactly is this kind of file

278
00:09:56,959 --> 00:09:59,600
invoice pdf maybe it's a pdf so i have

279
00:09:59,600 --> 00:10:01,680
it here malwarehunts.python probably has

280
00:10:01,680 --> 00:10:02,839
a python

281
00:10:02,839 --> 00:10:04,560
resume

282
00:10:04,560 --> 00:10:07,040
just as a simple documents okay so i can

283
00:10:07,040 --> 00:10:10,079
just as i put the file command it's a

284
00:10:10,079 --> 00:10:12,800
a tool that can help me okay to identify

285
00:10:12,800 --> 00:10:14,560
this kind of file so let me check here

286
00:10:14,560 --> 00:10:17,200
amazon so we have here the basically

287
00:10:17,200 --> 00:10:19,920
amazon microsoft word okay it's a word

288
00:10:19,920 --> 00:10:21,680
to see to investigate more about that

289
00:10:21,680 --> 00:10:24,000
okay let's check another we have here

290
00:10:24,000 --> 00:10:26,800
the let me check here the pdf so no cd

291
00:10:26,800 --> 00:10:30,399
it's a file resume no resume it's uh

292
00:10:30,399 --> 00:10:32,959
lowercase resume dot pdf it's another

293
00:10:32,959 --> 00:10:35,279
pdf okay let me check here there's mower

294
00:10:35,279 --> 00:10:37,360
hunting it's a good name maybe the

295
00:10:37,360 --> 00:10:40,880
malicious okay fire file mower hunting

296
00:10:40,880 --> 00:10:42,800
dock pine in this case it's a pirate

297
00:10:42,800 --> 00:10:44,800
script okay it's totally

298
00:10:44,800 --> 00:10:47,440
uh understood it's a it's a simple it's

299
00:10:47,440 --> 00:10:50,160
a malware okay so but my point here we

300
00:10:50,160 --> 00:10:52,079
need understand those base so how i can

301
00:10:52,079 --> 00:10:54,480
improve my bases so that's my point here

302
00:10:54,480 --> 00:10:55,760
it's very important to understand

303
00:10:55,760 --> 00:10:57,839
something so what is exactly five

304
00:10:57,839 --> 00:11:00,399
determine the file type

305
00:11:00,399 --> 00:11:02,560
but here we have a good key

306
00:11:02,560 --> 00:11:04,800
important so how the file works in the

307
00:11:04,800 --> 00:11:06,240
next ground

308
00:11:06,240 --> 00:11:07,680
in this case you can see here the

309
00:11:07,680 --> 00:11:10,720
concept so the concept of the of a magic

310
00:11:10,720 --> 00:11:12,079
something

311
00:11:12,079 --> 00:11:15,200
when you execute this they have some

312
00:11:15,200 --> 00:11:16,880
magic something

313
00:11:16,880 --> 00:11:19,200
called what what is magic philip in this

314
00:11:19,200 --> 00:11:22,079
case this file have a magic number so

315
00:11:22,079 --> 00:11:25,360
the explanation is all those binary have

316
00:11:25,360 --> 00:11:26,959
a magic number

317
00:11:26,959 --> 00:11:29,360
what is exactly a magic number is a

318
00:11:29,360 --> 00:11:32,800
storage or it's uh something because for

319
00:11:32,800 --> 00:11:34,640
if you don't know it's a something it's

320
00:11:34,640 --> 00:11:36,720
started in a particular place near the

321
00:11:36,720 --> 00:11:39,120
beginning of the file that tells the

322
00:11:39,120 --> 00:11:41,680
unix operational systems okay that the

323
00:11:41,680 --> 00:11:43,600
file is a binary executable so this is

324
00:11:43,600 --> 00:11:46,640
identification of the binary so this is

325
00:11:46,640 --> 00:11:51,440
a way has uh this is a way has a file

326
00:11:51,440 --> 00:11:54,079
tools that i am executing here works so

327
00:11:54,079 --> 00:11:56,639
when i execute this they have something

328
00:11:56,639 --> 00:11:59,040
inside of the the unix spot of army if

329
00:11:59,040 --> 00:12:01,519
you see here take a look at this the

330
00:12:01,519 --> 00:12:03,839
information identifying this file is

331
00:12:03,839 --> 00:12:06,000
ready from

332
00:12:06,000 --> 00:12:10,399
atc dash magic slash dash match and the

333
00:12:10,399 --> 00:12:14,000
compiled magic file is in this place so

334
00:12:14,000 --> 00:12:15,360
you can

335
00:12:15,360 --> 00:12:18,079
see these that you have the

336
00:12:18,079 --> 00:12:20,480
tools inside of the unix platform

337
00:12:20,480 --> 00:12:23,360
compiled as we can see here so when we

338
00:12:23,360 --> 00:12:25,440
execute this we can return you can

339
00:12:25,440 --> 00:12:27,519
receive some information about that so

340
00:12:27,519 --> 00:12:29,360
when you perform when you use a code

341
00:12:29,360 --> 00:12:32,000
when you run the file command these

342
00:12:32,000 --> 00:12:34,399
funds this this command execute this in

343
00:12:34,399 --> 00:12:37,279
the background is and show us some

344
00:12:37,279 --> 00:12:40,000
informations about the file but so let's

345
00:12:40,000 --> 00:12:42,959
uh see some important thing here so let

346
00:12:42,959 --> 00:12:44,720
me

347
00:12:44,720 --> 00:12:47,760
using the mower here and let me take

348
00:12:47,760 --> 00:12:50,800
this um i have here let me cut here for

349
00:12:50,800 --> 00:12:52,959
example and now you put here another

350
00:12:52,959 --> 00:12:57,279
different thing here like percent pdf

351
00:12:57,279 --> 00:12:58,600
dash

352
00:12:58,600 --> 00:13:01,920
1.9 for example let me save here and

353
00:13:01,920 --> 00:13:03,760
let's see what happened in this case if

354
00:13:03,760 --> 00:13:05,600
i use into the same

355
00:13:05,600 --> 00:13:07,200
file here take a look at this so now i

356
00:13:07,200 --> 00:13:09,839
don't have more python script as we can

357
00:13:09,839 --> 00:13:11,120
see here

358
00:13:11,120 --> 00:13:13,519
below it's not a python script so now we

359
00:13:13,519 --> 00:13:15,880
have a pdf document version

360
00:13:15,880 --> 00:13:20,079
1.9 why because i'm manipulating

361
00:13:20,079 --> 00:13:22,399
the magic number in this specifically

362
00:13:22,399 --> 00:13:25,360
file okay that's a good point here so i

363
00:13:25,360 --> 00:13:27,519
have here for example let me show you

364
00:13:27,519 --> 00:13:31,120
file it's a magic and magic

365
00:13:31,120 --> 00:13:34,560
i have here the all those databases of

366
00:13:34,560 --> 00:13:37,200
the magic the the file so here i

367
00:13:37,200 --> 00:13:40,000
downloaded basically the from the debian

368
00:13:40,000 --> 00:13:42,800
platform the source of the mover and

369
00:13:42,800 --> 00:13:45,279
here had no hour sorry the source of the

370
00:13:45,279 --> 00:13:49,680
file and here we have many different

371
00:13:49,680 --> 00:13:52,160
um

372
00:13:52,320 --> 00:13:55,120
strings not strings many uh

373
00:13:55,120 --> 00:13:58,480
rules uh related to some uh

374
00:13:58,480 --> 00:14:00,720
binaries like let me show you here like

375
00:14:00,720 --> 00:14:02,639
a javascript for example let me go

376
00:14:02,639 --> 00:14:05,040
there's some javascript just to show you

377
00:14:05,040 --> 00:14:06,880
some informations about that so

378
00:14:06,880 --> 00:14:09,360
javascript and take a look that so here

379
00:14:09,360 --> 00:14:11,760
if you see in some informations in the

380
00:14:11,760 --> 00:14:14,639
beginning of the file for example here i

381
00:14:14,639 --> 00:14:17,920
have some important thing so let me copy

382
00:14:17,920 --> 00:14:18,800
here

383
00:14:18,800 --> 00:14:21,920
and if i return here in my root and

384
00:14:21,920 --> 00:14:23,519
malware

385
00:14:23,519 --> 00:14:24,959
so let me

386
00:14:24,959 --> 00:14:27,680
change one more time this file again so

387
00:14:27,680 --> 00:14:29,279
let me cut here

388
00:14:29,279 --> 00:14:31,360
and i will pass here

389
00:14:31,360 --> 00:14:34,000
let me save and yes

390
00:14:34,000 --> 00:14:36,320
so if you see here take a look that so

391
00:14:36,320 --> 00:14:39,040
now i have a node.js script

392
00:14:39,040 --> 00:14:40,560
and if you see

393
00:14:40,560 --> 00:14:44,800
here i have a js

394
00:14:44,800 --> 00:14:47,199
file executable okay because i'm

395
00:14:47,199 --> 00:14:49,680
manipulating so how so how i show you

396
00:14:49,680 --> 00:14:51,360
here in the

397
00:14:51,360 --> 00:14:53,920
in this file this is the database okay

398
00:14:53,920 --> 00:14:57,120
and how the file works in some

399
00:14:57,120 --> 00:14:59,440
rules inside of that so that's a pretty

400
00:14:59,440 --> 00:15:01,440
important you understand all those steps

401
00:15:01,440 --> 00:15:03,600
and all those spaces okay so because of

402
00:15:03,600 --> 00:15:05,760
this i would like to explain you how

403
00:15:05,760 --> 00:15:07,519
important it is you understand about

404
00:15:07,519 --> 00:15:09,680
those bases about the file about the

405
00:15:09,680 --> 00:15:12,160
strings and something like that remember

406
00:15:12,160 --> 00:15:13,600
this is the first steps it's not a

407
00:15:13,600 --> 00:15:16,079
reverse engineer okay just to clarify

408
00:15:16,079 --> 00:15:18,240
but you need to understand to see some

409
00:15:18,240 --> 00:15:20,959
characteristics like for example if you

410
00:15:20,959 --> 00:15:23,360
see here in the windows platform i have

411
00:15:23,360 --> 00:15:25,920
here some files in windows for example

412
00:15:25,920 --> 00:15:28,560
let's check here i have simple and have

413
00:15:28,560 --> 00:15:32,399
ios so if you're using strings

414
00:15:32,399 --> 00:15:35,120
a because i would like to see all those

415
00:15:35,120 --> 00:15:37,600
informations inside that are you using

416
00:15:37,600 --> 00:15:39,040
pod to grab

417
00:15:39,040 --> 00:15:41,600
some informations about what some

418
00:15:41,600 --> 00:15:45,360
expression regular about the dlls okay

419
00:15:45,360 --> 00:15:48,079
so i'm using strings to collect some

420
00:15:48,079 --> 00:15:49,279
information

421
00:15:49,279 --> 00:15:51,040
a to see all those informations are

422
00:15:51,040 --> 00:15:53,199
using graph to

423
00:15:53,199 --> 00:15:55,680
to selected some strings using the

424
00:15:55,680 --> 00:15:57,759
expression the expression regularly the

425
00:15:57,759 --> 00:16:00,000
name of the expression is dll okay if i

426
00:16:00,000 --> 00:16:01,360
execute this

427
00:16:01,360 --> 00:16:03,759
let's check what i found here i need to

428
00:16:03,759 --> 00:16:06,160
set the the

429
00:16:06,160 --> 00:16:07,519
the file right

430
00:16:07,519 --> 00:16:10,000
i forgot the file let me put in the file

431
00:16:10,000 --> 00:16:12,800
here it's a whis okay

432
00:16:12,800 --> 00:16:14,160
it's a binary

433
00:16:14,160 --> 00:16:16,720
let's check here yes it's a hoodie

434
00:16:16,720 --> 00:16:21,759
it's not here it's returning here and a

435
00:16:21,759 --> 00:16:24,399
it's a who is and okay

436
00:16:24,399 --> 00:16:26,800
so now i have this is we have the allow

437
00:16:26,800 --> 00:16:29,120
take a look that so this is all those

438
00:16:29,120 --> 00:16:31,279
dlls that i that i have inside of that

439
00:16:31,279 --> 00:16:33,120
so this is informations that you can

440
00:16:33,120 --> 00:16:37,120
find using the strings common so how

441
00:16:37,120 --> 00:16:40,800
strings works exactly so sometimes when

442
00:16:40,800 --> 00:16:43,920
you as a putting some string some string

443
00:16:43,920 --> 00:16:46,399
don't appears to you in the comments why

444
00:16:46,399 --> 00:16:48,399
because if you see here in the manner of

445
00:16:48,399 --> 00:16:50,560
the strings philip i don't like to read

446
00:16:50,560 --> 00:16:51,759
it man

447
00:16:51,759 --> 00:16:54,000
i i don't like to but in this hour in

448
00:16:54,000 --> 00:16:56,480
our attack in our area we need to read

449
00:16:56,480 --> 00:16:58,079
so take a look at that so the printing

450
00:16:58,079 --> 00:17:00,079
the sequence of the printable characters

451
00:17:00,079 --> 00:17:02,160
okay and here we have the import

452
00:17:02,160 --> 00:17:04,400
important information so

453
00:17:04,400 --> 00:17:06,640
uh string sprint the printable character

454
00:17:06,640 --> 00:17:09,679
is sequences that are at least four

455
00:17:09,679 --> 00:17:12,400
characteristic characters long so take a

456
00:17:12,400 --> 00:17:14,400
look there's important thing so because

457
00:17:14,400 --> 00:17:16,559
of these when you execute the strings

458
00:17:16,559 --> 00:17:19,119
you didn't see the mz signatures or the

459
00:17:19,119 --> 00:17:22,079
pe signatures in a binary when you talk

460
00:17:22,079 --> 00:17:24,480
about the pe right so because of these

461
00:17:24,480 --> 00:17:27,359
simple explanations but we need to read

462
00:17:27,359 --> 00:17:29,200
that we need to understand that you

463
00:17:29,200 --> 00:17:31,280
understand okay so let me return into

464
00:17:31,280 --> 00:17:33,280
the presentation so let's talk about the

465
00:17:33,280 --> 00:17:35,200
physical and and the logical structure

466
00:17:35,200 --> 00:17:37,200
of the pdf okay

467
00:17:37,200 --> 00:17:39,679
so the structure of the pdf in general

468
00:17:39,679 --> 00:17:42,480
we have a four main parts in a pdf the

469
00:17:42,480 --> 00:17:44,880
header okay the body and the cross

470
00:17:44,880 --> 00:17:47,039
reference table or x table and the

471
00:17:47,039 --> 00:17:49,440
trailer okay so this is the four parts

472
00:17:49,440 --> 00:17:51,520
that you have in some pdf the structure

473
00:17:51,520 --> 00:17:53,760
of the pdf usually you have here the

474
00:17:53,760 --> 00:17:55,360
version in the beginning in the header

475
00:17:55,360 --> 00:17:58,080
it's pretty common in in many different

476
00:17:58,080 --> 00:18:00,640
binaries okay inside of the board you

477
00:18:00,640 --> 00:18:02,160
have more uh

478
00:18:02,160 --> 00:18:04,320
you know funny things not funny things

479
00:18:04,320 --> 00:18:06,960
but like a pages emoji phones or

480
00:18:06,960 --> 00:18:09,280
bookmarks not a many

481
00:18:09,280 --> 00:18:11,200
actually many important things

482
00:18:11,200 --> 00:18:13,120
um you know understanding this is the

483
00:18:13,120 --> 00:18:14,559
vocal here

484
00:18:14,559 --> 00:18:16,400
here and the cross reference table is

485
00:18:16,400 --> 00:18:17,679
important thing because it's the

486
00:18:17,679 --> 00:18:20,640
locations of the object ethan the file

487
00:18:20,640 --> 00:18:24,240
and for a random access i mean all those

488
00:18:24,240 --> 00:18:26,240
objects is access

489
00:18:26,240 --> 00:18:28,559
references is another kind of object

490
00:18:28,559 --> 00:18:31,200
inside of the same pdf okay and we talk

491
00:18:31,200 --> 00:18:33,280
about the trailer we have a locations of

492
00:18:33,280 --> 00:18:35,760
the certain certain objects within the

493
00:18:35,760 --> 00:18:38,640
bore i mean it's if you see here all

494
00:18:38,640 --> 00:18:39,840
those uh

495
00:18:39,840 --> 00:18:41,679
trailer and pro reference table is

496
00:18:41,679 --> 00:18:42,640
linked

497
00:18:42,640 --> 00:18:45,039
in each one okay it's very important so

498
00:18:45,039 --> 00:18:47,600
let me show you the demo here about the

499
00:18:47,600 --> 00:18:50,160
sample that i received to analyze okay

500
00:18:50,160 --> 00:18:52,799
just a pdf so when i receive this pdf i

501
00:18:52,799 --> 00:18:55,760
need to see exactly what is this sample

502
00:18:55,760 --> 00:18:58,320
so we have here the pdf the cv like a

503
00:18:58,320 --> 00:19:01,120
resume okay so it's pretty common every

504
00:19:01,120 --> 00:19:03,600
company receive nowadays okay so first

505
00:19:03,600 --> 00:19:06,559
of all to see if this pdf is this small

506
00:19:06,559 --> 00:19:08,240
is simple with

507
00:19:08,240 --> 00:19:11,520
uh pdf or not so i using the file again

508
00:19:11,520 --> 00:19:13,520
and after that they're using pdf id this

509
00:19:13,520 --> 00:19:16,160
tool is created by dj steven and by the

510
00:19:16,160 --> 00:19:17,600
way there's pictures about the

511
00:19:17,600 --> 00:19:19,840
instructions from the j stephens

512
00:19:19,840 --> 00:19:21,840
blog so as you can see here you have a

513
00:19:21,840 --> 00:19:25,440
15s object you have some strings in this

514
00:19:25,440 --> 00:19:28,240
case two and you have five javascript as

515
00:19:28,240 --> 00:19:29,919
you can see here so

516
00:19:29,919 --> 00:19:31,600
uh you need to investigate more that

517
00:19:31,600 --> 00:19:33,679
because if you have five javascript in a

518
00:19:33,679 --> 00:19:36,720
pdf so it's a for my opinion

519
00:19:36,720 --> 00:19:38,880
it's totally malicious okay because

520
00:19:38,880 --> 00:19:40,480
usually you don't have any javascript

521
00:19:40,480 --> 00:19:42,880
inside of the pdf and you have here then

522
00:19:42,880 --> 00:19:45,200
open action so philip was that means

523
00:19:45,200 --> 00:19:48,240
open actions it's a simple explanation

524
00:19:48,240 --> 00:19:51,600
this is a functions when the pdf has

525
00:19:51,600 --> 00:19:54,320
the user don't need to click it the user

526
00:19:54,320 --> 00:19:56,559
don't need to interact with the file

527
00:19:56,559 --> 00:19:58,720
okay the only action the user needs to

528
00:19:58,720 --> 00:20:01,039
execute is for example if the user

529
00:20:01,039 --> 00:20:03,200
received by email to download the sample

530
00:20:03,200 --> 00:20:06,960
or if the having a server that someone

531
00:20:06,960 --> 00:20:09,679
uploaded the cv or this resume okay so

532
00:20:09,679 --> 00:20:11,360
when this um

533
00:20:11,360 --> 00:20:13,840
resume is uploaded to the server and the

534
00:20:13,840 --> 00:20:15,440
storage of the server

535
00:20:15,440 --> 00:20:17,520
the user don't need to click again okay

536
00:20:17,520 --> 00:20:21,120
it's a it's a simple so because they

537
00:20:21,120 --> 00:20:23,840
have this open action function i mean

538
00:20:23,840 --> 00:20:27,440
this the file is executed itself

539
00:20:27,440 --> 00:20:31,120
with uh no one actions or interactive of

540
00:20:31,120 --> 00:20:33,280
the users okay so it's it's pretty

541
00:20:33,280 --> 00:20:35,280
dangerous because the user don't need to

542
00:20:35,280 --> 00:20:39,120
click to as it could okay so let me see

543
00:20:39,120 --> 00:20:42,000
more information so i see that they have

544
00:20:42,000 --> 00:20:44,240
five javascript and they have an open

545
00:20:44,240 --> 00:20:45,919
actions so after that they're using the

546
00:20:45,919 --> 00:20:48,000
pdf parses another tool from the da

547
00:20:48,000 --> 00:20:49,840
stevens to

548
00:20:49,840 --> 00:20:52,960
to see some informations about the

549
00:20:52,960 --> 00:20:56,400
the pdf so my idea is to see to to find

550
00:20:56,400 --> 00:20:58,960
something more deeply about that so i

551
00:20:58,960 --> 00:21:01,600
have i see here about the javascript so

552
00:21:01,600 --> 00:21:04,000
i use sub-s to search about the

553
00:21:04,000 --> 00:21:06,320
javascript so as you can see here we

554
00:21:06,320 --> 00:21:07,600
have

555
00:21:07,600 --> 00:21:08,559
three

556
00:21:08,559 --> 00:21:11,760
referenced here in an object 7 and

557
00:21:11,760 --> 00:21:15,919
object 1 and object 12 okay because i

558
00:21:15,919 --> 00:21:19,360
when i execute the pdf id if i see three

559
00:21:19,360 --> 00:21:22,960
so if you see here i execute the js and

560
00:21:22,960 --> 00:21:24,799
as you can see here two

561
00:21:24,799 --> 00:21:27,760
new reference object one and object 12.

562
00:21:27,760 --> 00:21:29,679
so we have five

563
00:21:29,679 --> 00:21:32,240
javascript so this is a slash

564
00:21:32,240 --> 00:21:34,880
is a part of the content inside of the

565
00:21:34,880 --> 00:21:38,159
pdf and as you can see here so

566
00:21:38,159 --> 00:21:40,559
let me explain something here it's just

567
00:21:40,559 --> 00:21:43,360
to to thank you to give you um to bring

568
00:21:43,360 --> 00:21:46,000
you some thoughts uh probably when i'm

569
00:21:46,000 --> 00:21:48,000
supposing of course but probably when dj

570
00:21:48,000 --> 00:21:50,320
stephen create these tools

571
00:21:50,320 --> 00:21:51,280
of course

572
00:21:51,280 --> 00:21:54,640
he investigated a lot and many different

573
00:21:54,640 --> 00:21:57,919
ideas and probably he find he found

574
00:21:57,919 --> 00:21:59,520
different uh

575
00:21:59,520 --> 00:22:02,240
informations like open actions or or not

576
00:22:02,240 --> 00:22:04,880
actually like you know uh a job screen

577
00:22:04,880 --> 00:22:07,200
encryption informations or maybe

578
00:22:07,200 --> 00:22:10,080
some automatic automated

579
00:22:10,080 --> 00:22:12,880
automations or automatically

580
00:22:12,880 --> 00:22:15,120
automatically it's not correct word but

581
00:22:15,120 --> 00:22:17,520
uh some words or some characteristics of

582
00:22:17,520 --> 00:22:20,320
the pdf they found something and because

583
00:22:20,320 --> 00:22:22,159
of this they create this kind of slash

584
00:22:22,159 --> 00:22:24,960
to identify them to seem more easier for

585
00:22:24,960 --> 00:22:27,200
us to see about this information in the

586
00:22:27,200 --> 00:22:31,440
pdf so when you for example uh

587
00:22:31,440 --> 00:22:33,760
try to create some tools to help you to

588
00:22:33,760 --> 00:22:35,679
help the community it's very important

589
00:22:35,679 --> 00:22:37,120
you see about that the behavior

590
00:22:37,120 --> 00:22:39,840
understand the behavior of the file and

591
00:22:39,840 --> 00:22:42,480
after that you can create your own tool

592
00:22:42,480 --> 00:22:44,880
and this is a pretty pretty nice because

593
00:22:44,880 --> 00:22:46,240
of this it's very important you

594
00:22:46,240 --> 00:22:47,360
understand

595
00:22:47,360 --> 00:22:50,559
those bases okay so it's because of this

596
00:22:50,559 --> 00:22:52,640
it's easy to identify this information

597
00:22:52,640 --> 00:22:56,159
so okay so let me explain more about the

598
00:22:56,159 --> 00:22:59,760
pdf parcel again i will see some

599
00:22:59,760 --> 00:23:02,400
informations about the room output

600
00:23:02,400 --> 00:23:04,480
because i would like to see all those

601
00:23:04,480 --> 00:23:08,240
run data inside of this pdf so as it

602
00:23:08,240 --> 00:23:11,039
could be pdf person dash w it's in this

603
00:23:11,039 --> 00:23:13,679
case it's the run okay and i set here

604
00:23:13,679 --> 00:23:15,840
the pdf and pipe lasts because i'd like

605
00:23:15,840 --> 00:23:18,159
to start in the beginning of the file so

606
00:23:18,159 --> 00:23:19,919
first of all we have the object one and

607
00:23:19,919 --> 00:23:21,840
take a look that we have a seven

608
00:23:21,840 --> 00:23:24,640
reference here i mean in the object one

609
00:23:24,640 --> 00:23:26,480
remember in the explanations about the

610
00:23:26,480 --> 00:23:29,039
cross reference table it's referring

611
00:23:29,039 --> 00:23:31,280
okay and take a look at this we have an

612
00:23:31,280 --> 00:23:34,000
open actions it's totally linked

613
00:23:34,000 --> 00:23:37,600
with the javascript so here you can

614
00:23:37,600 --> 00:23:39,760
we can understand here that you have an

615
00:23:39,760 --> 00:23:42,080
open actions remember what is an open

616
00:23:42,080 --> 00:23:44,480
action you don't need to click again so

617
00:23:44,480 --> 00:23:45,919
as i could something you just need to

618
00:23:45,919 --> 00:23:48,480
download the sample or uploading from

619
00:23:48,480 --> 00:23:50,960
the web server for example and after

620
00:23:50,960 --> 00:23:53,200
that the file viewers

621
00:23:53,200 --> 00:23:55,360
it is it could itself

622
00:23:55,360 --> 00:23:57,520
this open action but

623
00:23:57,520 --> 00:24:00,240
the file will reset the javascript as we

624
00:24:00,240 --> 00:24:02,320
can see here this open actions is

625
00:24:02,320 --> 00:24:04,960
certainly linked with the javascript

626
00:24:04,960 --> 00:24:07,520
okay so that's the point here so here

627
00:24:07,520 --> 00:24:09,600
you can understand more information

628
00:24:09,600 --> 00:24:12,559
about this behavior okay object two and

629
00:24:12,559 --> 00:24:15,279
three remember we have a 15 and take a

630
00:24:15,279 --> 00:24:17,200
look there's another reference object

631
00:24:17,200 --> 00:24:20,080
four we have a more two new reference

632
00:24:20,080 --> 00:24:21,679
eight and nine

633
00:24:21,679 --> 00:24:24,799
but we need to see about the 15 objects

634
00:24:24,799 --> 00:24:27,200
okay in object seven we have another

635
00:24:27,200 --> 00:24:29,760
reference object 10 so

636
00:24:29,760 --> 00:24:32,880
we have 10 objects referenced so in the

637
00:24:32,880 --> 00:24:35,520
object 10 we have a javascript reference

638
00:24:35,520 --> 00:24:37,760
object 8 just uh

639
00:24:37,760 --> 00:24:40,159
information about the image reference

640
00:24:40,159 --> 00:24:42,640
object 9 you have a more order new

641
00:24:42,640 --> 00:24:45,600
reference object 11 take a look this all

642
00:24:45,600 --> 00:24:48,159
those objects it's linked in each one

643
00:24:48,159 --> 00:24:49,039
okay

644
00:24:49,039 --> 00:24:50,880
and objects 10 we have here the

645
00:24:50,880 --> 00:24:53,440
javascript remember and another

646
00:24:53,440 --> 00:24:55,039
reference object

647
00:24:55,039 --> 00:24:56,080
12

648
00:24:56,080 --> 00:24:58,080
inside of the object 11 we have the

649
00:24:58,080 --> 00:25:00,880
first streaming so usually the the

650
00:25:00,880 --> 00:25:02,159
attacker

651
00:25:02,159 --> 00:25:04,799
when they when he would like to put some

652
00:25:04,799 --> 00:25:06,640
malicious code they like to use in the

653
00:25:06,640 --> 00:25:09,440
some string to compress something inside

654
00:25:09,440 --> 00:25:11,279
of that so because of this we have this

655
00:25:11,279 --> 00:25:14,640
streaming so here maybe i could invest i

656
00:25:14,640 --> 00:25:16,559
could investigate more because i have

657
00:25:16,559 --> 00:25:18,080
here the streaming and you have here the

658
00:25:18,080 --> 00:25:20,400
sun function flat the code so when you

659
00:25:20,400 --> 00:25:21,840
have this information inside of this

660
00:25:21,840 --> 00:25:23,760
stream it means that you need to decode

661
00:25:23,760 --> 00:25:25,919
something basically we need to decode

662
00:25:25,919 --> 00:25:28,960
this streaming in the left the left is

663
00:25:28,960 --> 00:25:31,840
it's the size right of this uh streaming

664
00:25:31,840 --> 00:25:34,159
basically it's a simple explanation and

665
00:25:34,159 --> 00:25:36,320
inside of the object 12 we have another

666
00:25:36,320 --> 00:25:38,880
reference object 13 and take a look

667
00:25:38,880 --> 00:25:41,120
that's that we have the javascript

668
00:25:41,120 --> 00:25:43,120
inside the object 13

669
00:25:43,120 --> 00:25:44,080
but

670
00:25:44,080 --> 00:25:47,039
we have the stream in the sizes speaker

671
00:25:47,039 --> 00:25:48,799
is different it's different the first

672
00:25:48,799 --> 00:25:51,039
remember that so probably this is the

673
00:25:51,039 --> 00:25:53,279
main object that we need to investigate

674
00:25:53,279 --> 00:25:55,760
more deeply because the size is totally

675
00:25:55,760 --> 00:25:57,520
it's high when you compare with another

676
00:25:57,520 --> 00:26:00,159
okay and um

677
00:26:00,159 --> 00:26:02,960
so i'm just uh writing here and i write

678
00:26:02,960 --> 00:26:05,120
by the way wrong it's not a mailing but

679
00:26:05,120 --> 00:26:08,159
a main point to investigate so okay let

680
00:26:08,159 --> 00:26:10,320
me looking more deeply about that so i

681
00:26:10,320 --> 00:26:12,400
have another choose to using here in

682
00:26:12,400 --> 00:26:14,960
this investigation investigation it's a

683
00:26:14,960 --> 00:26:17,440
pdf tikka it's another two but these two

684
00:26:17,440 --> 00:26:19,760
is not from the g7 by the way

685
00:26:19,760 --> 00:26:22,799
it's uh two to manipulate some uh pdf

686
00:26:22,799 --> 00:26:25,520
okay all those tools that i'm using as

687
00:26:25,520 --> 00:26:27,520
you can see here i'm using from the

688
00:26:27,520 --> 00:26:29,440
debian platform okay or in this case

689
00:26:29,440 --> 00:26:31,919
it's a kala linux okay so this is some

690
00:26:31,919 --> 00:26:33,200
information that you can use in this

691
00:26:33,200 --> 00:26:35,520
platform and i view using this the

692
00:26:35,520 --> 00:26:37,840
specific function here is the functions

693
00:26:37,840 --> 00:26:40,640
about the uncompressed because my idea

694
00:26:40,640 --> 00:26:42,799
here is to uncompress all those

695
00:26:42,799 --> 00:26:46,400
informations inside of the pdf remember

696
00:26:46,400 --> 00:26:49,279
not the pdf but not only the pdf but

697
00:26:49,279 --> 00:26:50,159
mainly

698
00:26:50,159 --> 00:26:53,200
mainly in the pd in the object 13

699
00:26:53,200 --> 00:26:56,480
remember because i have there uh the big

700
00:26:56,480 --> 00:26:58,480
sizer of the

701
00:26:58,480 --> 00:27:01,360
streaming remember in the object 13. so

702
00:27:01,360 --> 00:27:03,600
okay as i could this i set the output in

703
00:27:03,600 --> 00:27:04,320
this

704
00:27:04,320 --> 00:27:07,279
name called i use i i send the output to

705
00:27:07,279 --> 00:27:10,480
the dump.txt and all those informations

706
00:27:10,480 --> 00:27:12,640
are inside of that so if you see here

707
00:27:12,640 --> 00:27:14,320
take a look what i found here the

708
00:27:14,320 --> 00:27:17,279
streaming i there's obfuscate here

709
00:27:17,279 --> 00:27:19,279
something noticeably i using the flat

710
00:27:19,279 --> 00:27:21,760
decoder the code is information so here

711
00:27:21,760 --> 00:27:24,000
is the first technique using buying the

712
00:27:24,000 --> 00:27:26,640
attacker so here we have the javascript

713
00:27:26,640 --> 00:27:29,279
but this the javascript is using the

714
00:27:29,279 --> 00:27:31,120
obfuscation technique so this is the

715
00:27:31,120 --> 00:27:33,279
first technique used by the attacker

716
00:27:33,279 --> 00:27:35,520
they're using the javascript obfuscated

717
00:27:35,520 --> 00:27:38,240
you know to difficult uh the analog the

718
00:27:38,240 --> 00:27:39,679
analysis from the

719
00:27:39,679 --> 00:27:41,440
researchers or they are not more

720
00:27:41,440 --> 00:27:43,840
analysis or something like that so first

721
00:27:43,840 --> 00:27:48,720
of all when i i did this um

722
00:27:48,720 --> 00:27:50,640
this javascript take a look that we can

723
00:27:50,640 --> 00:27:52,240
see here some uh

724
00:27:52,240 --> 00:27:54,399
standard behavior right so we can see

725
00:27:54,399 --> 00:27:55,919
here the letter

726
00:27:55,919 --> 00:27:58,320
and the numbers and percent here and

727
00:27:58,320 --> 00:28:00,799
then something different color but we

728
00:28:00,799 --> 00:28:04,080
have here the evil parameters so

729
00:28:04,080 --> 00:28:06,880
i try to manipulate something in these

730
00:28:06,880 --> 00:28:08,960
evil parameters because if you are

731
00:28:08,960 --> 00:28:10,799
talking about the

732
00:28:10,799 --> 00:28:13,440
javascript so probably we have some web

733
00:28:13,440 --> 00:28:16,960
applications uh or some webpages related

734
00:28:16,960 --> 00:28:18,480
or are

735
00:28:18,480 --> 00:28:20,640
related to this right and i because of

736
00:28:20,640 --> 00:28:23,279
this i created this sample doc html

737
00:28:23,279 --> 00:28:25,520
because my idea here is to publish this

738
00:28:25,520 --> 00:28:27,760
javascript in some browser this is my

739
00:28:27,760 --> 00:28:30,640
idea here so i using this evil parameter

740
00:28:30,640 --> 00:28:32,960
to change this parameter to a document

741
00:28:32,960 --> 00:28:35,200
right because i'd like to print these

742
00:28:35,200 --> 00:28:37,200
informations to the soft skate this

743
00:28:37,200 --> 00:28:40,080
javascript in the

744
00:28:40,080 --> 00:28:42,880
web page of course are using some

745
00:28:42,880 --> 00:28:45,039
comments here just to help me in this

746
00:28:45,039 --> 00:28:47,520
demo and i used this evil parameter to

747
00:28:47,520 --> 00:28:51,200
change just to show you and i saved the

748
00:28:51,200 --> 00:28:53,760
file here as you can see i need to give

749
00:28:53,760 --> 00:28:55,600
the permission to

750
00:28:55,600 --> 00:28:59,600
to access this um this page did not page

751
00:28:59,600 --> 00:29:02,000
this file in a web browser actually and

752
00:29:02,000 --> 00:29:03,440
after that i can

753
00:29:03,440 --> 00:29:05,440
execute this sample in

754
00:29:05,440 --> 00:29:07,679
in some uh browser to open in this

755
00:29:07,679 --> 00:29:10,720
browser okay so let's see here let's see

756
00:29:10,720 --> 00:29:13,840
what happened here

757
00:29:14,720 --> 00:29:16,799
as a good business in the firefox symbol

758
00:29:16,799 --> 00:29:18,880
so let's see what happened now and if

759
00:29:18,880 --> 00:29:21,200
you see here i'm opening the browser and

760
00:29:21,200 --> 00:29:23,520
take a look what i found here

761
00:29:23,520 --> 00:29:26,559
i found the payload variable payload

762
00:29:26,559 --> 00:29:29,120
what that means payload philip so if you

763
00:29:29,120 --> 00:29:30,960
know what is payload knows about that

764
00:29:30,960 --> 00:29:32,320
but if you don't know you explain more

765
00:29:32,320 --> 00:29:34,640
about that payloads is a part of package

766
00:29:34,640 --> 00:29:36,960
uh responsible to this this uh to

767
00:29:36,960 --> 00:29:39,200
download in the victim machine and this

768
00:29:39,200 --> 00:29:41,679
specific pack package is responsible to

769
00:29:41,679 --> 00:29:44,960
return a callback to the cnc or commonly

770
00:29:44,960 --> 00:29:47,440
controller from that packet i mean so

771
00:29:47,440 --> 00:29:49,760
this javascript has an exploit and is

772
00:29:49,760 --> 00:29:52,000
exploited responsible to

773
00:29:52,000 --> 00:29:54,480
download the payload and this payload

774
00:29:54,480 --> 00:29:57,520
again this payload is uh is responsible

775
00:29:57,520 --> 00:30:00,000
to go back to cnc so let's see first of

776
00:30:00,000 --> 00:30:01,360
all inside of the pdf we have a

777
00:30:01,360 --> 00:30:04,159
javascript with a place exploit with the

778
00:30:04,159 --> 00:30:06,880
code and this javascript using that same

779
00:30:06,880 --> 00:30:10,159
multiplication techniques and after that

780
00:30:10,159 --> 00:30:12,080
this javascript will download the

781
00:30:12,080 --> 00:30:14,240
payload inside of this machine so take a

782
00:30:14,240 --> 00:30:16,080
look at this the percent letters and

783
00:30:16,080 --> 00:30:18,640
numbers this is a standard behavior

784
00:30:18,640 --> 00:30:19,440
uh

785
00:30:19,440 --> 00:30:21,440
standard lights as you can see here so

786
00:30:21,440 --> 00:30:23,440
this is maybe a uh uh

787
00:30:23,440 --> 00:30:25,600
interesting for me okay so i need to

788
00:30:25,600 --> 00:30:27,279
when i see that i can finish because it

789
00:30:27,279 --> 00:30:30,240
totally malicious the fire but i do i i

790
00:30:30,240 --> 00:30:32,480
i saw i saw that and i i tried to

791
00:30:32,480 --> 00:30:35,039
investigate more about that because i

792
00:30:35,039 --> 00:30:36,799
saw i saw more informations and i tried

793
00:30:36,799 --> 00:30:39,520
to investigate more okay and of course

794
00:30:39,520 --> 00:30:41,679
we can agree with me this symbol is

795
00:30:41,679 --> 00:30:44,320
totally malicious okay so the idea if i

796
00:30:44,320 --> 00:30:45,840
finally try to

797
00:30:45,840 --> 00:30:47,600
understand if the sample is malicious or

798
00:30:47,600 --> 00:30:49,120
not it's totally malicious but i

799
00:30:49,120 --> 00:30:51,360
continue to investigate to

800
00:30:51,360 --> 00:30:54,000
try if i found some another

801
00:30:54,000 --> 00:30:57,120
informations right and so now i have

802
00:30:57,120 --> 00:31:00,159
here the payload right so this is the

803
00:31:00,159 --> 00:31:01,279
the

804
00:31:01,279 --> 00:31:03,120
the package or the information package

805
00:31:03,120 --> 00:31:07,039
the informations about this payload okay

806
00:31:07,039 --> 00:31:08,880
because we see the variable remember

807
00:31:08,880 --> 00:31:10,880
that var dash

808
00:31:10,880 --> 00:31:14,480
equals payload var equal payload and i

809
00:31:14,480 --> 00:31:16,559
call that and i pass here in this

810
00:31:16,559 --> 00:31:18,880
payload file and after that are using

811
00:31:18,880 --> 00:31:22,399
sats to cut this percent to cut this

812
00:31:22,399 --> 00:31:24,480
behavior as you can see here so here we

813
00:31:24,480 --> 00:31:27,679
can see another uh techniques used by

814
00:31:27,679 --> 00:31:30,240
the attacker these are unicode

815
00:31:30,240 --> 00:31:33,600
techniques to using what to encode some

816
00:31:33,600 --> 00:31:36,720
informations inside of that so i

817
00:31:36,720 --> 00:31:40,159
basically now i using this uh i copied

818
00:31:40,159 --> 00:31:42,559
this code to generate a new file and

819
00:31:42,559 --> 00:31:46,320
this file i called it's not ac2 e2s ec2

820
00:31:46,320 --> 00:31:48,559
actually it's a um

821
00:31:48,559 --> 00:31:51,519
it's an old version of the utf-8

822
00:31:51,519 --> 00:31:52,559
uh

823
00:31:52,559 --> 00:31:55,840
because the evolution now it's a utf-080

824
00:31:55,840 --> 00:31:59,440
so this is the old okay just to

825
00:31:59,440 --> 00:32:00,880
explain this another technique so the

826
00:32:00,880 --> 00:32:02,640
attacker is using why

827
00:32:02,640 --> 00:32:05,200
what using the javascript associated the

828
00:32:05,200 --> 00:32:07,760
second they're using the uh of payload

829
00:32:07,760 --> 00:32:09,519
to download in the victim machine and

830
00:32:09,519 --> 00:32:11,120
they're using the

831
00:32:11,120 --> 00:32:14,320
euc-2 and it's not an to e2c it's easy

832
00:32:14,320 --> 00:32:17,039
to the correct name and uh if i remember

833
00:32:17,039 --> 00:32:18,640
it's easy too but i will show you and

834
00:32:18,640 --> 00:32:20,159
this is another platform in the windows

835
00:32:20,159 --> 00:32:22,960
now it's easy to to encode so here i

836
00:32:22,960 --> 00:32:26,000
will explain the same the same

837
00:32:26,000 --> 00:32:28,559
file but now using the windows machine

838
00:32:28,559 --> 00:32:30,240
because probably if you are thinking

839
00:32:30,240 --> 00:32:32,960
felipe i like it to using windows i

840
00:32:32,960 --> 00:32:35,279
don't like to use in linux i don't know

841
00:32:35,279 --> 00:32:36,960
why but no words about that are you

842
00:32:36,960 --> 00:32:39,200
using in the windows platform to show

843
00:32:39,200 --> 00:32:41,519
you another possibility okay so as you

844
00:32:41,519 --> 00:32:43,919
can see here i i download the same

845
00:32:43,919 --> 00:32:46,720
package okay the dump docs decks in real

846
00:32:46,720 --> 00:32:49,440
payload i copped this and i will using

847
00:32:49,440 --> 00:32:52,640
another platform called maozilla as you

848
00:32:52,640 --> 00:32:56,399
can see here okay so i will pass here

849
00:32:56,399 --> 00:32:59,760
this and i'm using uh let me just pause

850
00:32:59,760 --> 00:33:02,399
here to explain uh i will

851
00:33:02,399 --> 00:33:05,039
copy i pass here the same code as you

852
00:33:05,039 --> 00:33:08,320
can see the same standard uh

853
00:33:08,320 --> 00:33:10,880
behavior percent ladder and number

854
00:33:10,880 --> 00:33:13,880
numbers i passed here and i using

855
00:33:13,880 --> 00:33:15,519
ecs2

856
00:33:15,519 --> 00:33:17,200
we have the s e

857
00:33:17,200 --> 00:33:20,799
c s two okay so this is the two uh the

858
00:33:20,799 --> 00:33:22,840
old techniques used by the

859
00:33:22,840 --> 00:33:26,000
um is a different way because again the

860
00:33:26,000 --> 00:33:29,760
evolution is otf8 okay so

861
00:33:29,760 --> 00:33:33,120
i pass here and i will using to to

862
00:33:33,120 --> 00:33:36,320
encode this to generate a new exa file

863
00:33:36,320 --> 00:33:38,960
binary why i do that it's a simple

864
00:33:38,960 --> 00:33:41,279
because usually the mower is executing

865
00:33:41,279 --> 00:33:43,039
in the windows platform so because of

866
00:33:43,039 --> 00:33:46,320
this i generate in this x binary file

867
00:33:46,320 --> 00:33:48,480
right because my id here is to execute

868
00:33:48,480 --> 00:33:51,440
this file in the windows platform

869
00:33:51,440 --> 00:33:54,240
because of that i generate in this exa

870
00:33:54,240 --> 00:33:56,720
file binary so i generate and i call

871
00:33:56,720 --> 00:33:59,519
them cnc doc binary okay or dipole dot

872
00:33:59,519 --> 00:34:02,399
pin as you can see and i use here the dj

873
00:34:02,399 --> 00:34:04,799
steven suites if you can using this

874
00:34:04,799 --> 00:34:07,600
platform this many uh package of the

875
00:34:07,600 --> 00:34:09,918
tools we can using in the windows and

876
00:34:09,918 --> 00:34:12,320
i'm using one of this another tools

877
00:34:12,320 --> 00:34:14,879
called the shore okay and i call the

878
00:34:14,879 --> 00:34:18,399
binary and i set here the protocol okay

879
00:34:18,399 --> 00:34:21,040
to try and find some informations about

880
00:34:21,040 --> 00:34:23,040
that so take a look what i found here

881
00:34:23,040 --> 00:34:24,000
wow

882
00:34:24,000 --> 00:34:25,760
the common controller from the attacker

883
00:34:25,760 --> 00:34:29,040
it's a simple okay remember this is a

884
00:34:29,040 --> 00:34:31,119
payload inside of the payload it's a

885
00:34:31,119 --> 00:34:33,599
callback from the cnc the attacker so

886
00:34:33,599 --> 00:34:35,839
here is the ip from the attacker and

887
00:34:35,839 --> 00:34:37,760
this attacker in this case

888
00:34:37,760 --> 00:34:42,000
it was in estonia era right so if you

889
00:34:42,000 --> 00:34:44,239
i put here some ip some information

890
00:34:44,239 --> 00:34:46,079
about that in the very total to see

891
00:34:46,079 --> 00:34:49,679
about some engines okay it's uh clear

892
00:34:49,679 --> 00:34:52,320
clear in some engines but in the first

893
00:34:52,320 --> 00:34:54,480
point for example it's a malicious in

894
00:34:54,480 --> 00:34:56,560
the commode it's uh

895
00:34:56,560 --> 00:34:59,440
suspicious and it's from estonia by the

896
00:34:59,440 --> 00:35:00,839
way here

897
00:35:00,839 --> 00:35:04,079
and and if you see here in the community

898
00:35:04,079 --> 00:35:04,960
and uh

899
00:35:04,960 --> 00:35:06,640
and i i can explain more about these

900
00:35:06,640 --> 00:35:08,960
ages but the idea is just to explain

901
00:35:08,960 --> 00:35:11,200
more about the the informations related

902
00:35:11,200 --> 00:35:14,400
to this specifically main ip address

903
00:35:14,400 --> 00:35:15,280
okay

904
00:35:15,280 --> 00:35:18,640
and it's not new it's old as we can see

905
00:35:18,640 --> 00:35:22,000
here okay and we have more references

906
00:35:22,000 --> 00:35:24,480
here about the some urls using and if

907
00:35:24,480 --> 00:35:26,720
you see here in the community in the

908
00:35:26,720 --> 00:35:29,040
details now in details actually okay so

909
00:35:29,040 --> 00:35:30,640
here's as you can see the which means to

910
00:35:30,640 --> 00:35:32,480
exploit sites

911
00:35:32,480 --> 00:35:34,000
and uh

912
00:35:34,000 --> 00:35:36,160
and you can see here that username

913
00:35:36,160 --> 00:35:39,440
alicia's pdf to attack an adult reader

914
00:35:39,440 --> 00:35:41,040
plug-in as we

915
00:35:41,040 --> 00:35:44,560
saw in this presentations okay so here

916
00:35:44,560 --> 00:35:46,960
you'd like to if you usually in the the

917
00:35:46,960 --> 00:35:48,400
conference the people asking me about

918
00:35:48,400 --> 00:35:50,320
some recommendations i can recommend

919
00:35:50,320 --> 00:35:52,800
these awesome books if you want it's a

920
00:35:52,800 --> 00:35:55,119
mastering modern artisans and techniques

921
00:35:55,119 --> 00:35:56,880
and some hours

922
00:35:56,880 --> 00:35:58,800
and more techniques and more ready

923
00:35:58,800 --> 00:36:00,560
hunting and practical

924
00:36:00,560 --> 00:36:01,440
uh

925
00:36:01,440 --> 00:36:04,720
related from ready hunting and uh

926
00:36:04,720 --> 00:36:07,680
and don't forget hack the planet always

927
00:36:07,680 --> 00:36:09,760
okay and uh

928
00:36:09,760 --> 00:36:11,359
if you have any questions so please let

929
00:36:11,359 --> 00:36:14,079
me know my contacts again and then thank

930
00:36:14,079 --> 00:36:15,839
you thank you for joining one more time

931
00:36:15,839 --> 00:36:18,000
and if you have any questions so please

932
00:36:18,000 --> 00:36:21,320
let me know

