1
00:00:02,320 --> 00:00:04,480
good afternoon and everyone my name is

2
00:00:04,480 --> 00:00:07,520
juan carlo licodine and i'm here to talk

3
00:00:07,520 --> 00:00:11,840
about my um my talk entitled using

4
00:00:11,840 --> 00:00:14,799
wordpress comment section as a cnc

5
00:00:14,799 --> 00:00:17,919
for fun

6
00:00:19,920 --> 00:00:22,560
before we could we we start i just want

7
00:00:22,560 --> 00:00:26,080
to talk about what a cnc is

8
00:00:26,080 --> 00:00:29,199
for those who don't know a cnc is

9
00:00:29,199 --> 00:00:32,079
command and control this is a computer

10
00:00:32,079 --> 00:00:34,399
controlled by an attacker which is used

11
00:00:34,399 --> 00:00:36,480
to send commands to systems that are

12
00:00:36,480 --> 00:00:39,920
compromised by malware and this is also

13
00:00:39,920 --> 00:00:41,840
the place wherein they receive the

14
00:00:41,840 --> 00:00:45,039
stolen data from a target if you would

15
00:00:45,039 --> 00:00:46,320
look at

16
00:00:46,320 --> 00:00:49,200
the diagram right here on the right we

17
00:00:49,200 --> 00:00:51,600
have our command and control server this

18
00:00:51,600 --> 00:00:54,320
can be any computer it can be a server

19
00:00:54,320 --> 00:00:56,879
it can be anything and this is what we

20
00:00:56,879 --> 00:00:59,840
use as our communications channel so

21
00:00:59,840 --> 00:01:03,120
that the bot master or the attacker can

22
00:01:03,120 --> 00:01:06,560
communicate to the bots that are located

23
00:01:06,560 --> 00:01:09,439
anywhere in the world

24
00:01:09,439 --> 00:01:13,360
cnc can also be referred to as c2 and

25
00:01:13,360 --> 00:01:16,000
cnc

26
00:01:16,799 --> 00:01:17,920
okay

27
00:01:17,920 --> 00:01:20,400
but first a little bit about myself my

28
00:01:20,400 --> 00:01:23,040
name is juan carlo li codine

29
00:01:23,040 --> 00:01:26,320
and i currently work as a cyber security

30
00:01:26,320 --> 00:01:28,560
engineer

31
00:01:28,560 --> 00:01:31,439
prior to switching to cyber security i

32
00:01:31,439 --> 00:01:34,240
was actually a programmer slash

33
00:01:34,240 --> 00:01:37,040
game developer for the last 10 plus

34
00:01:37,040 --> 00:01:38,079
years

35
00:01:38,079 --> 00:01:39,520
and

36
00:01:39,520 --> 00:01:42,799
during my free time what i do is i

37
00:01:42,799 --> 00:01:45,040
i make cyber security tools for

38
00:01:45,040 --> 00:01:49,360
defensive and offensive operations

39
00:01:49,360 --> 00:01:54,159
so the reason why all of this started is

40
00:01:54,159 --> 00:01:56,640
one of my recent projects is a remote

41
00:01:56,640 --> 00:01:58,320
access tool

42
00:01:58,320 --> 00:01:59,680
or a rat

43
00:01:59,680 --> 00:02:00,880
and

44
00:02:00,880 --> 00:02:03,439
if you don't know what this is this is a

45
00:02:03,439 --> 00:02:05,040
program that

46
00:02:05,040 --> 00:02:07,920
is installed on a computer and it allows

47
00:02:07,920 --> 00:02:10,878
an external user to access it

48
00:02:10,878 --> 00:02:13,360
from outside the network

49
00:02:13,360 --> 00:02:15,760
this one has a lot of legitimate uses

50
00:02:15,760 --> 00:02:18,239
but it is also used by

51
00:02:18,239 --> 00:02:20,800
uh by threat actors

52
00:02:20,800 --> 00:02:24,400
for malware and those and for

53
00:02:24,400 --> 00:02:26,879
for external access

54
00:02:26,879 --> 00:02:29,920
and when i made this tool right here uh

55
00:02:29,920 --> 00:02:32,160
what i did was i used the traditional

56
00:02:32,160 --> 00:02:35,360
approach to cnc which is what i showed

57
00:02:35,360 --> 00:02:37,360
you a while ago

58
00:02:37,360 --> 00:02:39,200
i have a server and then this is the

59
00:02:39,200 --> 00:02:42,080
server that serves as the communications

60
00:02:42,080 --> 00:02:43,120
channel

61
00:02:43,120 --> 00:02:47,599
for uh the bots and the bot master

62
00:02:48,560 --> 00:02:51,680
but just last year i came across this um

63
00:02:51,680 --> 00:02:55,120
talk this root con talk uh from sir ian

64
00:02:55,120 --> 00:02:57,360
and siri and son uh and the talk is

65
00:02:57,360 --> 00:03:00,640
titled pursuing evasive custom command

66
00:03:00,640 --> 00:03:01,840
and control

67
00:03:01,840 --> 00:03:04,400
you could watch that uh on youtube

68
00:03:04,400 --> 00:03:06,239
the link right here

69
00:03:06,239 --> 00:03:08,879
and one of the topics that they talked

70
00:03:08,879 --> 00:03:11,280
about is that

71
00:03:11,280 --> 00:03:14,000
threat actors are now moving away from

72
00:03:14,000 --> 00:03:16,800
the traditional approach of cnc

73
00:03:16,800 --> 00:03:18,959
and they are now looking for

74
00:03:18,959 --> 00:03:24,000
different and novel ideas to use as cncs

75
00:03:24,000 --> 00:03:26,720
and for example for the past five years

76
00:03:26,720 --> 00:03:28,720
we have seen

77
00:03:28,720 --> 00:03:32,959
malicious actors trying to use social

78
00:03:32,959 --> 00:03:35,120
media services

79
00:03:35,120 --> 00:03:37,920
and public services like instagram

80
00:03:37,920 --> 00:03:40,720
telegram and a whole lot more of

81
00:03:40,720 --> 00:03:42,400
services

82
00:03:42,400 --> 00:03:44,159
like for example if you would look here

83
00:03:44,159 --> 00:03:45,599
on the right

84
00:03:45,599 --> 00:03:48,640
in britney spears instagram page wherein

85
00:03:48,640 --> 00:03:50,799
a lot of people are leaving their

86
00:03:50,799 --> 00:03:52,560
comments

87
00:03:52,560 --> 00:03:55,680
you can use that as a cover wherein you

88
00:03:55,680 --> 00:03:58,640
could slip in a hidden message so that

89
00:03:58,640 --> 00:04:01,360
only the bot and the bot master will

90
00:04:01,360 --> 00:04:04,959
understand the communication

91
00:04:04,959 --> 00:04:08,159
others also use a telegram

92
00:04:08,159 --> 00:04:10,879
wherein a telegram client

93
00:04:10,879 --> 00:04:12,799
is installed by the malware on the

94
00:04:12,799 --> 00:04:16,079
target machine and then from there it is

95
00:04:16,079 --> 00:04:18,560
the telegram client is used to

96
00:04:18,560 --> 00:04:19,839
communicate

97
00:04:19,839 --> 00:04:22,880
uh with the you know with the botmaster

98
00:04:22,880 --> 00:04:25,680
so they are using this as a

99
00:04:25,680 --> 00:04:28,240
an encrypted tunnel

100
00:04:28,240 --> 00:04:30,800
and and others like this one for example

101
00:04:30,800 --> 00:04:32,720
it's a little more blatant

102
00:04:32,720 --> 00:04:34,560
this one is using twitter as you could

103
00:04:34,560 --> 00:04:35,440
see the

104
00:04:35,440 --> 00:04:37,919
the commands are just out in the open

105
00:04:37,919 --> 00:04:39,840
and they just don't care

106
00:04:39,840 --> 00:04:44,000
ddos ip address stop visit this url and

107
00:04:44,000 --> 00:04:46,240
so on

108
00:04:46,240 --> 00:04:48,320
and as you could see

109
00:04:48,320 --> 00:04:50,400
you can see that

110
00:04:50,400 --> 00:04:53,840
there has been a lot of experimentation

111
00:04:53,840 --> 00:04:56,880
in custom cncs and people are always

112
00:04:56,880 --> 00:05:00,639
trying to look for a different

113
00:05:00,639 --> 00:05:03,199
communications channel

114
00:05:03,199 --> 00:05:05,840
and this really interested me

115
00:05:05,840 --> 00:05:08,000
and i wondered okay

116
00:05:08,000 --> 00:05:09,360
i wonder

117
00:05:09,360 --> 00:05:12,080
what other services that i can come up

118
00:05:12,080 --> 00:05:16,639
with that can be used as a cnc server

119
00:05:16,639 --> 00:05:19,680
so i i thought about it and um i

120
00:05:19,680 --> 00:05:21,199
realized

121
00:05:21,199 --> 00:05:24,880
uh how about wordpress

122
00:05:24,880 --> 00:05:26,160
if you don't know

123
00:05:26,160 --> 00:05:29,360
wordpress is a blogging cms or a content

124
00:05:29,360 --> 00:05:31,680
management system

125
00:05:31,680 --> 00:05:34,960
that is used by

126
00:05:34,960 --> 00:05:37,039
this is used so that you could be able

127
00:05:37,039 --> 00:05:39,360
to easily post

128
00:05:39,360 --> 00:05:42,400
your blogs your end for other people to

129
00:05:42,400 --> 00:05:43,199
use

130
00:05:43,199 --> 00:05:45,440
the comment section so that you could be

131
00:05:45,440 --> 00:05:46,560
able to

132
00:05:46,560 --> 00:05:48,639
share information

133
00:05:48,639 --> 00:05:52,479
this one is used everywhere well almost

134
00:05:52,479 --> 00:05:54,800
but it is very prevalent

135
00:05:54,800 --> 00:05:55,100
um

136
00:05:55,100 --> 00:05:56,240
[Music]

137
00:05:56,240 --> 00:05:58,080
and um

138
00:05:58,080 --> 00:06:01,759
there are even websites that you don't

139
00:06:01,759 --> 00:06:03,680
there are even websites that are not

140
00:06:03,680 --> 00:06:06,560
blogs that use wordpress and that's

141
00:06:06,560 --> 00:06:08,720
because wordpress is a very very

142
00:06:08,720 --> 00:06:11,919
powerful platform

143
00:06:11,919 --> 00:06:14,319
and the reason why i i wanted to use

144
00:06:14,319 --> 00:06:18,639
wordpress is because i have a lot of

145
00:06:18,639 --> 00:06:21,840
experience with with the platform

146
00:06:21,840 --> 00:06:23,759
especially when during my early days as

147
00:06:23,759 --> 00:06:25,919
a web developer

148
00:06:25,919 --> 00:06:28,240
it also helps that wordpress is open

149
00:06:28,240 --> 00:06:29,440
source

150
00:06:29,440 --> 00:06:31,520
and i know

151
00:06:31,520 --> 00:06:33,520
from experience that one of the things

152
00:06:33,520 --> 00:06:37,280
that wordpress has is that you can leave

153
00:06:37,280 --> 00:06:39,440
a comment anonymously

154
00:06:39,440 --> 00:06:40,800
meaning you don't have to create an

155
00:06:40,800 --> 00:06:43,840
account as long as you post a comment

156
00:06:43,840 --> 00:06:45,440
you provide a name

157
00:06:45,440 --> 00:06:47,280
and you provide an email even though

158
00:06:47,280 --> 00:06:49,919
it's not a valid email

159
00:06:49,919 --> 00:06:53,360
wordpress would accept that comment

160
00:06:53,360 --> 00:06:54,800
and this is when

161
00:06:54,800 --> 00:06:56,000
i

162
00:06:56,000 --> 00:07:00,479
this is when an idea popped into my head

163
00:07:01,120 --> 00:07:02,560
okay

164
00:07:02,560 --> 00:07:04,800
so the idea goes like this

165
00:07:04,800 --> 00:07:08,319
imagine we have a target blog

166
00:07:08,319 --> 00:07:13,039
and this blog is let's say a sports blog

167
00:07:13,039 --> 00:07:15,840
the master the bot master would post a

168
00:07:15,840 --> 00:07:18,160
comment on that blog

169
00:07:18,160 --> 00:07:20,319
in the form of a spam comment we want to

170
00:07:20,319 --> 00:07:22,080
hide it we don't we don't want to just

171
00:07:22,080 --> 00:07:22,880
um

172
00:07:22,880 --> 00:07:26,400
uh post the the the command like info

173
00:07:26,400 --> 00:07:28,319
we're just gonna hide it a bit and we're

174
00:07:28,319 --> 00:07:29,120
gonna

175
00:07:29,120 --> 00:07:32,000
put on some random spam comment and then

176
00:07:32,000 --> 00:07:33,840
at the very end that's the time that

177
00:07:33,840 --> 00:07:36,000
we're in we will put the comment the

178
00:07:36,000 --> 00:07:37,039
command

179
00:07:37,039 --> 00:07:38,800
like this contains commands from master

180
00:07:38,800 --> 00:07:40,960
the boss this can be

181
00:07:40,960 --> 00:07:43,840
info command or exfiltrate command or

182
00:07:43,840 --> 00:07:45,440
shutdown command

183
00:07:45,440 --> 00:07:46,639
whatever

184
00:07:46,639 --> 00:07:51,599
so as soon as that comment gets posted

185
00:07:51,599 --> 00:07:52,879
on the blog

186
00:07:52,879 --> 00:07:54,879
the bots on the other hand

187
00:07:54,879 --> 00:07:57,360
would then continuously monitor they

188
00:07:57,360 --> 00:07:59,199
would continuously watch the comment

189
00:07:59,199 --> 00:08:01,919
section and try to see if the mo the

190
00:08:01,919 --> 00:08:02,960
master

191
00:08:02,960 --> 00:08:05,759
posted a message for them

192
00:08:05,759 --> 00:08:07,840
and they would go through each comment

193
00:08:07,840 --> 00:08:09,520
and then when they see it they would

194
00:08:09,520 --> 00:08:11,680
parse the command

195
00:08:11,680 --> 00:08:13,039
very simple

196
00:08:13,039 --> 00:08:14,639
so from here

197
00:08:14,639 --> 00:08:17,360
you could see that this is the beginning

198
00:08:17,360 --> 00:08:20,479
of the idea wherein we would be using

199
00:08:20,479 --> 00:08:22,960
the wordpress blog as the communication

200
00:08:22,960 --> 00:08:23,919
channel

201
00:08:23,919 --> 00:08:26,960
the botmaster posts a comment the bots

202
00:08:26,960 --> 00:08:29,280
wait for the comment and then the bots

203
00:08:29,280 --> 00:08:31,680
can post their own comments the boss can

204
00:08:31,680 --> 00:08:34,000
then uh process that comment so you

205
00:08:34,000 --> 00:08:36,799
could have a two-way communication and

206
00:08:36,799 --> 00:08:39,440
you're using the wordpress blog as your

207
00:08:39,440 --> 00:08:41,279
channel

208
00:08:41,279 --> 00:08:42,080
now

209
00:08:42,080 --> 00:08:44,080
this is very good and i really like the

210
00:08:44,080 --> 00:08:47,760
idea but the problem is

211
00:08:47,760 --> 00:08:50,399
everyone hates spam

212
00:08:50,399 --> 00:08:52,959
everyone

213
00:08:53,120 --> 00:08:55,680
if you're gonna be using a wordpress

214
00:08:55,680 --> 00:08:58,720
blog as your communications channel

215
00:08:58,720 --> 00:09:02,240
you will be accumulating lots of spam or

216
00:09:02,240 --> 00:09:05,040
you're gonna be adding lots of spam

217
00:09:05,040 --> 00:09:07,920
that the owner of the bugs will be able

218
00:09:07,920 --> 00:09:09,279
to see

219
00:09:09,279 --> 00:09:11,519
and when they see lots of

220
00:09:11,519 --> 00:09:13,839
lots of spam comments

221
00:09:13,839 --> 00:09:15,920
of course you have to expect that what

222
00:09:15,920 --> 00:09:18,000
they'll do is that they would try to

223
00:09:18,000 --> 00:09:20,480
look for ways to stop the spam from

224
00:09:20,480 --> 00:09:23,120
further spam from coming in

225
00:09:23,120 --> 00:09:25,279
and some of them would do this by

226
00:09:25,279 --> 00:09:28,399
turning on auto moderation

227
00:09:28,399 --> 00:09:30,800
auto moderation is wherein the comment

228
00:09:30,800 --> 00:09:33,279
is automatically sent to a moderation

229
00:09:33,279 --> 00:09:35,440
queue for review

230
00:09:35,440 --> 00:09:37,680
if it's in the moderation queue it would

231
00:09:37,680 --> 00:09:40,560
not appear on the on the blog not unless

232
00:09:40,560 --> 00:09:43,200
the blog owner approves it

233
00:09:43,200 --> 00:09:45,040
so that means

234
00:09:45,040 --> 00:09:47,920
if auto moderation queue is turned on

235
00:09:47,920 --> 00:09:51,680
if we post a comment others or the bots

236
00:09:51,680 --> 00:09:53,839
won't be able to see it

237
00:09:53,839 --> 00:09:55,920
because of course the blog owner won't

238
00:09:55,920 --> 00:09:59,599
approve that because it's spam right

239
00:10:00,000 --> 00:10:00,880
so

240
00:10:00,880 --> 00:10:03,440
that is the downside of this initial

241
00:10:03,440 --> 00:10:06,720
idea notice it's initial

242
00:10:06,720 --> 00:10:09,360
because for this idea to work a blog

243
00:10:09,360 --> 00:10:12,480
needs to be unmoderated

244
00:10:12,480 --> 00:10:15,279
and one other problem is that moderation

245
00:10:15,279 --> 00:10:18,320
is turned on by default that means if

246
00:10:18,320 --> 00:10:21,200
you download wordpress right now

247
00:10:21,200 --> 00:10:22,079
the

248
00:10:22,079 --> 00:10:25,839
the the option for auto moderation is

249
00:10:25,839 --> 00:10:27,600
automatically turned on

250
00:10:27,600 --> 00:10:30,240
and no user would

251
00:10:30,240 --> 00:10:32,160
in the in the right mind would turn this

252
00:10:32,160 --> 00:10:33,360
off

253
00:10:33,360 --> 00:10:35,279
so

254
00:10:35,279 --> 00:10:37,519
so with this idea it would be really

255
00:10:37,519 --> 00:10:40,399
hard for you to look for blogs that are

256
00:10:40,399 --> 00:10:42,240
unmoderated

257
00:10:42,240 --> 00:10:44,160
so the answer now is

258
00:10:44,160 --> 00:10:45,360
okay

259
00:10:45,360 --> 00:10:48,560
i i don't want to just to stop right

260
00:10:48,560 --> 00:10:50,560
here this is just a

261
00:10:50,560 --> 00:10:52,880
a small downside

262
00:10:52,880 --> 00:10:56,000
so i figured okay uh what if i try to

263
00:10:56,000 --> 00:10:57,760
look for another way

264
00:10:57,760 --> 00:11:01,920
uh to use wordpress as a cnc server

265
00:11:01,920 --> 00:11:04,720
so what i did was i

266
00:11:04,720 --> 00:11:07,279
researched a bit more and i tested it a

267
00:11:07,279 --> 00:11:08,320
bit more

268
00:11:08,320 --> 00:11:11,279
and i learned that

269
00:11:11,279 --> 00:11:15,839
if a blog has auto moderation turned on

270
00:11:15,920 --> 00:11:18,320
and when you post a comment

271
00:11:18,320 --> 00:11:20,720
and it is held for moderation

272
00:11:20,720 --> 00:11:24,800
a unique preview link will be generated

273
00:11:24,800 --> 00:11:27,440
something like this

274
00:11:27,440 --> 00:11:29,440
it would take it would redirect you to

275
00:11:29,440 --> 00:11:31,839
this link and it would show you the the

276
00:11:31,839 --> 00:11:34,000
comment that you posted so this is the

277
00:11:34,000 --> 00:11:36,800
comment that you posted and there's also

278
00:11:36,800 --> 00:11:39,519
a message right here saying your comment

279
00:11:39,519 --> 00:11:43,760
is awaiting moderation this is a preview

280
00:11:43,760 --> 00:11:44,720
now

281
00:11:44,720 --> 00:11:46,480
what's great about this this preview

282
00:11:46,480 --> 00:11:48,959
link is that as long as you have this

283
00:11:48,959 --> 00:11:51,760
link you could see

284
00:11:51,760 --> 00:11:53,680
this comment that you've made

285
00:11:53,680 --> 00:11:56,079
you can even share it to other people

286
00:11:56,079 --> 00:11:58,320
have them visit this link and they could

287
00:11:58,320 --> 00:12:00,399
be able to see the comment that you

288
00:12:00,399 --> 00:12:02,800
posted

289
00:12:03,040 --> 00:12:05,279
that's that's a that's an idea right

290
00:12:05,279 --> 00:12:06,320
there

291
00:12:06,320 --> 00:12:09,279
but the problem is that the preview link

292
00:12:09,279 --> 00:12:10,399
will expire

293
00:12:10,399 --> 00:12:11,760
in 10 minutes

294
00:12:11,760 --> 00:12:13,920
so there is an expiration

295
00:12:13,920 --> 00:12:16,880
time wherein this preview will be

296
00:12:16,880 --> 00:12:18,240
accessible

297
00:12:18,240 --> 00:12:20,880
when that time expires if you visit this

298
00:12:20,880 --> 00:12:23,200
link again nothing will happen or it

299
00:12:23,200 --> 00:12:25,839
will show you just a page

300
00:12:25,839 --> 00:12:28,880
without the comment

301
00:12:28,880 --> 00:12:32,160
okay so with that laid out

302
00:12:32,160 --> 00:12:35,200
uh i kind of got the idea okay i think i

303
00:12:35,200 --> 00:12:37,920
have an idea on how we could use this

304
00:12:37,920 --> 00:12:40,719
going forward

305
00:12:41,279 --> 00:12:43,440
the problem here's the problem

306
00:12:43,440 --> 00:12:45,920
the master the botmaster would send the

307
00:12:45,920 --> 00:12:47,920
command to the vlog or a comment to the

308
00:12:47,920 --> 00:12:48,800
blog

309
00:12:48,800 --> 00:12:50,839
and the comment gets

310
00:12:50,839 --> 00:12:53,279
automotivated a preview link will be

311
00:12:53,279 --> 00:12:55,360
generated which we could see here at the

312
00:12:55,360 --> 00:12:56,399
bottom

313
00:12:56,399 --> 00:12:57,680
and

314
00:12:57,680 --> 00:13:00,320
if we want the bots to view the comment

315
00:13:00,320 --> 00:13:03,360
that the bot master posted we need we

316
00:13:03,360 --> 00:13:05,040
also need to have this

317
00:13:05,040 --> 00:13:06,399
link right here

318
00:13:06,399 --> 00:13:09,120
but since only the bot master sees it

319
00:13:09,120 --> 00:13:11,519
the bots can't be able to see it

320
00:13:11,519 --> 00:13:14,160
that's the dilemma so how will the bots

321
00:13:14,160 --> 00:13:16,800
know the preview url of the command

322
00:13:16,800 --> 00:13:18,639
the answer

323
00:13:18,639 --> 00:13:22,240
we generate the preview link ourselves

324
00:13:22,240 --> 00:13:23,040
so

325
00:13:23,040 --> 00:13:24,720
if the bot

326
00:13:24,720 --> 00:13:28,000
generates the same preview link that the

327
00:13:28,000 --> 00:13:30,800
bot master receives then that means we

328
00:13:30,800 --> 00:13:33,120
can be the bots can be able to see the

329
00:13:33,120 --> 00:13:35,440
comments that was posted

330
00:13:35,440 --> 00:13:36,480
okay

331
00:13:36,480 --> 00:13:40,720
but but how can we do that well we need

332
00:13:40,720 --> 00:13:41,440
uh

333
00:13:41,440 --> 00:13:45,120
we we need to understand how wordpress

334
00:13:45,120 --> 00:13:47,600
creates the preview link

335
00:13:47,600 --> 00:13:50,480
thankfully wordpress is open source

336
00:13:50,480 --> 00:13:53,839
that means it gave me a way for me to

337
00:13:53,839 --> 00:13:55,680
understand how it works

338
00:13:55,680 --> 00:13:58,160
so a little bit of information is that

339
00:13:58,160 --> 00:14:00,959
this is the preview link

340
00:14:00,959 --> 00:14:03,920
and we have two important parts in this

341
00:14:03,920 --> 00:14:06,480
preview link the first part here in blue

342
00:14:06,480 --> 00:14:07,680
is the

343
00:14:07,680 --> 00:14:09,680
the url

344
00:14:09,680 --> 00:14:11,120
of the blog

345
00:14:11,120 --> 00:14:13,680
this is the permalink of the post and

346
00:14:13,680 --> 00:14:15,279
you have these two

347
00:14:15,279 --> 00:14:18,000
highlighted data which is the unapproved

348
00:14:18,000 --> 00:14:20,320
and moderation hash

349
00:14:20,320 --> 00:14:22,880
the unapproved index is very simple this

350
00:14:22,880 --> 00:14:25,199
is the number assigned to the comment

351
00:14:25,199 --> 00:14:28,800
while it is in moderation queue

352
00:14:28,800 --> 00:14:31,519
so if you post a comment

353
00:14:31,519 --> 00:14:34,240
you would be assigned a certain number

354
00:14:34,240 --> 00:14:37,680
for example you you got a 2369

355
00:14:37,680 --> 00:14:40,480
if you post another comment immediately

356
00:14:40,480 --> 00:14:42,880
after the first one you will get

357
00:14:42,880 --> 00:14:44,959
this number would increase

358
00:14:44,959 --> 00:14:46,800
and it would be two three seven zero and

359
00:14:46,800 --> 00:14:48,399
so on

360
00:14:48,399 --> 00:14:49,440
okay

361
00:14:49,440 --> 00:14:51,040
the reason why this is important is

362
00:14:51,040 --> 00:14:53,440
because we want to be able to get

363
00:14:53,440 --> 00:14:56,320
the moderate unapproved index of our

364
00:14:56,320 --> 00:14:58,320
botmaster

365
00:14:58,320 --> 00:15:01,440
how about the moderation hash

366
00:15:01,440 --> 00:15:04,560
this is a unique hash a nd5 hash that is

367
00:15:04,560 --> 00:15:07,760
generated with the following formula

368
00:15:07,760 --> 00:15:09,920
as long as you know the date and time

369
00:15:09,920 --> 00:15:13,360
the comment was posted along with the wp

370
00:15:13,360 --> 00:15:16,639
auth key and the wp of salt you can get

371
00:15:16,639 --> 00:15:18,240
the moderation hash

372
00:15:18,240 --> 00:15:22,079
okay i'll explain this a bit more

373
00:15:22,959 --> 00:15:24,560
so for now let's try to get the

374
00:15:24,560 --> 00:15:27,199
unapproved index imagine

375
00:15:27,199 --> 00:15:30,240
the bot master posts a comment

376
00:15:30,240 --> 00:15:32,240
the bot master would then receive a

377
00:15:32,240 --> 00:15:33,759
preview link

378
00:15:33,759 --> 00:15:35,360
and for example

379
00:15:35,360 --> 00:15:39,759
he gets an unapproved index of 2369

380
00:15:39,759 --> 00:15:42,800
immediately after that the boat the bot

381
00:15:42,800 --> 00:15:45,279
would then post its own comment it can

382
00:15:45,279 --> 00:15:46,560
be anything

383
00:15:46,560 --> 00:15:49,279
the bot will then receive a preview link

384
00:15:49,279 --> 00:15:51,360
which is two three seventy it's

385
00:15:51,360 --> 00:15:52,800
immediately after

386
00:15:52,800 --> 00:15:54,800
we know that we've posted immediately

387
00:15:54,800 --> 00:15:56,800
after the bot master

388
00:15:56,800 --> 00:15:59,120
that means how can we get this number

389
00:15:59,120 --> 00:16:00,320
right here

390
00:16:00,320 --> 00:16:01,120
well

391
00:16:01,120 --> 00:16:03,440
we could we could assume that since our

392
00:16:03,440 --> 00:16:06,720
comment is 23170 the botmaster's comment

393
00:16:06,720 --> 00:16:09,440
would have an unapproved index less than

394
00:16:09,440 --> 00:16:11,040
two three seventy

395
00:16:11,040 --> 00:16:13,279
we can just brute force that we could

396
00:16:13,279 --> 00:16:15,199
visit two three six five

397
00:16:15,199 --> 00:16:16,880
two three six six two three seven two

398
00:16:16,880 --> 00:16:18,959
six eight and then two three six nine

399
00:16:18,959 --> 00:16:21,519
and then we have the an approved index

400
00:16:21,519 --> 00:16:23,120
of our botmaster

401
00:16:23,120 --> 00:16:24,399
okay

402
00:16:24,399 --> 00:16:27,519
one down one more to go

403
00:16:27,519 --> 00:16:29,440
how about the how about the moderation

404
00:16:29,440 --> 00:16:31,040
hash

405
00:16:31,040 --> 00:16:33,440
i've mentioned that there is a formula

406
00:16:33,440 --> 00:16:35,839
and we know when the date we can find

407
00:16:35,839 --> 00:16:37,759
out when the date and time

408
00:16:37,759 --> 00:16:40,240
the the comment will be posted

409
00:16:40,240 --> 00:16:41,839
the problem

410
00:16:41,839 --> 00:16:44,399
is the wp auth key

411
00:16:44,399 --> 00:16:48,240
and the wp auth salt

412
00:16:48,240 --> 00:16:50,880
this is a problem because this is found

413
00:16:50,880 --> 00:16:54,399
inside a configuration file called wp

414
00:16:54,399 --> 00:16:56,399
config.php

415
00:16:56,399 --> 00:16:59,279
and this is only accessible to the owner

416
00:16:59,279 --> 00:17:02,079
of the website or the owner of the blog

417
00:17:02,079 --> 00:17:04,079
so if you want to find out what this is

418
00:17:04,079 --> 00:17:05,919
if you want to compute the moderation

419
00:17:05,919 --> 00:17:06,880
hash

420
00:17:06,880 --> 00:17:09,520
you need to get these two items

421
00:17:09,520 --> 00:17:12,240
uh one option is to hack it but of

422
00:17:12,240 --> 00:17:13,520
course

423
00:17:13,520 --> 00:17:15,679
uh for me i don't want that to be an

424
00:17:15,679 --> 00:17:16,799
option

425
00:17:16,799 --> 00:17:19,439
so that is off the table

426
00:17:19,439 --> 00:17:21,679
okay so

427
00:17:21,679 --> 00:17:23,679
so that's the problem we want to get the

428
00:17:23,679 --> 00:17:26,079
moderation hash but we don't have these

429
00:17:26,079 --> 00:17:27,919
two information

430
00:17:27,919 --> 00:17:30,080
how can we get the moderation hash

431
00:17:30,080 --> 00:17:31,120
without

432
00:17:31,120 --> 00:17:33,840
hacking the website

433
00:17:35,039 --> 00:17:36,960
the answer is to

434
00:17:36,960 --> 00:17:38,720
get the moderation hash

435
00:17:38,720 --> 00:17:41,679
and the way for us to do that is that

436
00:17:41,679 --> 00:17:44,640
instead of computing for the hash

437
00:17:44,640 --> 00:17:45,840
what if

438
00:17:45,840 --> 00:17:47,280
the bot

439
00:17:47,280 --> 00:17:50,000
would post a comment as the same time as

440
00:17:50,000 --> 00:17:52,480
the master

441
00:17:52,480 --> 00:17:54,240
let me explain

442
00:17:54,240 --> 00:17:57,039
if the bots and the master

443
00:17:57,039 --> 00:18:01,840
posts at exactly 12 20

444
00:18:01,840 --> 00:18:04,160
and you have to keep in mind the seconds

445
00:18:04,160 --> 00:18:06,240
are discarded so even if you post at 12

446
00:18:06,240 --> 00:18:09,200
20 0 0 or 12 20

447
00:18:09,200 --> 00:18:10,640
15

448
00:18:10,640 --> 00:18:12,640
all of them will get the same moderation

449
00:18:12,640 --> 00:18:16,080
hash because remember the formula is

450
00:18:16,080 --> 00:18:18,799
the date and time the comment was posted

451
00:18:18,799 --> 00:18:21,120
so what you will do is just

452
00:18:21,120 --> 00:18:23,919
post at the same time

453
00:18:23,919 --> 00:18:25,200
okay

454
00:18:25,200 --> 00:18:26,880
so to make it clear

455
00:18:26,880 --> 00:18:29,919
how this works let's go to a

456
00:18:29,919 --> 00:18:33,280
a brief diagram

457
00:18:33,520 --> 00:18:36,480
let us say currently our current time is

458
00:18:36,480 --> 00:18:39,360
12 11.

459
00:18:39,919 --> 00:18:42,559
we could set that the bot master

460
00:18:42,559 --> 00:18:45,280
will always post comment every 10

461
00:18:45,280 --> 00:18:46,640
minutes

462
00:18:46,640 --> 00:18:48,080
why ten minutes

463
00:18:48,080 --> 00:18:51,440
is because we want the bots for everyone

464
00:18:51,440 --> 00:18:52,799
to understand

465
00:18:52,799 --> 00:18:55,280
uh do we want

466
00:18:55,280 --> 00:18:58,080
to have a schedule on when the bot

467
00:18:58,080 --> 00:18:59,840
master will be posting

468
00:18:59,840 --> 00:19:02,160
if we have a schedule the bots can be

469
00:19:02,160 --> 00:19:05,039
able to look in advance

470
00:19:05,039 --> 00:19:07,039
and try to wait for the when the

471
00:19:07,039 --> 00:19:09,200
botmaster will post

472
00:19:09,200 --> 00:19:12,320
for example it's currently 12 11

473
00:19:12,320 --> 00:19:14,640
and the bot master knows that the next

474
00:19:14,640 --> 00:19:17,360
time window is 12 20 again every 10

475
00:19:17,360 --> 00:19:22,160
minutes 11 12 10 12 20 12 30 and so on

476
00:19:22,160 --> 00:19:24,640
the bot master will prepare the message

477
00:19:24,640 --> 00:19:27,200
and on the other hand the bots

478
00:19:27,200 --> 00:19:30,320
would prepare to receive the message

479
00:19:30,320 --> 00:19:32,559
and they know also that the time window

480
00:19:32,559 --> 00:19:36,320
is 12 20 so both the boat both the bot

481
00:19:36,320 --> 00:19:38,960
master and the bot will wait for the 12

482
00:19:38,960 --> 00:19:41,440
20.

483
00:19:41,600 --> 00:19:44,720
12 280 comes along a few seconds later

484
00:19:44,720 --> 00:19:46,799
and then the bot master would send the

485
00:19:46,799 --> 00:19:47,840
message

486
00:19:47,840 --> 00:19:50,559
with the command right here

487
00:19:50,559 --> 00:19:53,039
and then the the bot master will receive

488
00:19:53,039 --> 00:19:55,919
a preview link

489
00:19:56,000 --> 00:19:58,160
one second after that

490
00:19:58,160 --> 00:20:01,679
the bot would also send a message

491
00:20:01,679 --> 00:20:05,520
and because they posted on the same time

492
00:20:05,520 --> 00:20:09,200
again the seconds are disregarded 12 20

493
00:20:09,200 --> 00:20:11,840
they would have the same moderation hash

494
00:20:11,840 --> 00:20:13,840
cd and so on

495
00:20:13,840 --> 00:20:17,039
cd and so on for the bot master

496
00:20:17,039 --> 00:20:19,200
the only difference is that

497
00:20:19,200 --> 00:20:22,240
the bot master who posted first guess

498
00:20:22,240 --> 00:20:25,760
2369 and the bot who's posted second

499
00:20:25,760 --> 00:20:28,400
gets to 370.

500
00:20:28,400 --> 00:20:30,880
now we now know what the moderation hash

501
00:20:30,880 --> 00:20:33,679
is we just need to get the

502
00:20:33,679 --> 00:20:35,840
unapproved index

503
00:20:35,840 --> 00:20:37,760
and that's very simple we're just going

504
00:20:37,760 --> 00:20:39,120
to brute force it

505
00:20:39,120 --> 00:20:40,480
we're just going to

506
00:20:40,480 --> 00:20:43,039
send an html request for

507
00:20:43,039 --> 00:20:44,480
this url

508
00:20:44,480 --> 00:20:47,440
of course since there is no 2367 it will

509
00:20:47,440 --> 00:20:49,520
return a four or four

510
00:20:49,520 --> 00:20:52,559
two three six eight again four or four

511
00:20:52,559 --> 00:20:55,200
and then finally two three six nine

512
00:20:55,200 --> 00:20:57,520
it's the same preview link as the bot

513
00:20:57,520 --> 00:21:00,240
master that means

514
00:21:00,240 --> 00:21:01,600
the message

515
00:21:01,600 --> 00:21:04,480
it's uh the the response would be 200 or

516
00:21:04,480 --> 00:21:08,000
okay that means we have finally found

517
00:21:08,000 --> 00:21:10,640
the message

518
00:21:11,039 --> 00:21:12,559
so there you have it

519
00:21:12,559 --> 00:21:16,080
this is how the bot master and the bot

520
00:21:16,080 --> 00:21:18,320
can be able to communicate

521
00:21:18,320 --> 00:21:21,200
every time someone posts a comment the

522
00:21:21,200 --> 00:21:23,919
other party would just then

523
00:21:23,919 --> 00:21:26,720
try to generate the preview link that

524
00:21:26,720 --> 00:21:28,400
the other party

525
00:21:28,400 --> 00:21:29,600
received

526
00:21:29,600 --> 00:21:32,080
and from here we could have a back and

527
00:21:32,080 --> 00:21:34,640
forth communication between the bot

528
00:21:34,640 --> 00:21:36,960
master and the bots

529
00:21:36,960 --> 00:21:37,919
okay

530
00:21:37,919 --> 00:21:40,640
so if you haven't wrapped your head

531
00:21:40,640 --> 00:21:42,240
around all of that

532
00:21:42,240 --> 00:21:43,600
explanation

533
00:21:43,600 --> 00:21:46,480
uh let's have a live demo shall we

534
00:21:46,480 --> 00:21:48,480
okay

535
00:21:48,480 --> 00:21:49,840
let me

536
00:21:49,840 --> 00:21:54,559
oh before that let me first show you

537
00:21:54,559 --> 00:21:57,200
how the comments section work very fast

538
00:21:57,200 --> 00:21:59,120
here is a blog

539
00:21:59,120 --> 00:22:01,440
with a blog a comment section

540
00:22:01,440 --> 00:22:04,400
if i post a comment say hello world

541
00:22:04,400 --> 00:22:07,120
hello world

542
00:22:07,120 --> 00:22:10,559
notice that i am this is my current url

543
00:22:10,559 --> 00:22:12,799
if i post a comment

544
00:22:12,799 --> 00:22:14,400
i would then be

545
00:22:14,400 --> 00:22:17,440
redirected to the preview url

546
00:22:17,440 --> 00:22:19,280
we would see that we have the moderation

547
00:22:19,280 --> 00:22:21,360
hash right here i hope you guys can see

548
00:22:21,360 --> 00:22:22,320
that

549
00:22:22,320 --> 00:22:25,520
and the unapproved index right here

550
00:22:25,520 --> 00:22:28,400
and from here this is the comment that

551
00:22:28,400 --> 00:22:29,679
we posted

552
00:22:29,679 --> 00:22:31,919
this is the message that tells us that

553
00:22:31,919 --> 00:22:35,360
tells us that it is awaiting moderation

554
00:22:35,360 --> 00:22:36,880
if we try

555
00:22:36,880 --> 00:22:39,440
to visit the same hello world post

556
00:22:39,440 --> 00:22:42,000
without the preview url

557
00:22:42,000 --> 00:22:44,400
let's try visiting that

558
00:22:44,400 --> 00:22:46,559
you would see that

559
00:22:46,559 --> 00:22:48,480
you can't see the comment

560
00:22:48,480 --> 00:22:50,240
on the other hand

561
00:22:50,240 --> 00:22:52,240
if we would go to the

562
00:22:52,240 --> 00:22:55,360
the wp admin the administrator page we

563
00:22:55,360 --> 00:22:58,400
could see that hey hello there this is

564
00:22:58,400 --> 00:23:01,280
the comment that we posted but

565
00:23:01,280 --> 00:23:02,799
it is currently

566
00:23:02,799 --> 00:23:05,600
uh in the moderation queue that means

567
00:23:05,600 --> 00:23:08,559
it's not yet approved

568
00:23:08,559 --> 00:23:10,320
all right

569
00:23:10,320 --> 00:23:11,919
with that first step

570
00:23:11,919 --> 00:23:15,120
let me first let me show you the poc or

571
00:23:15,120 --> 00:23:18,640
the proof of concept code that i created

572
00:23:18,640 --> 00:23:21,440
to show you how this works

573
00:23:21,440 --> 00:23:23,520
now

574
00:23:23,520 --> 00:23:25,360
first on the upper left would be the

575
00:23:25,360 --> 00:23:26,960
server

576
00:23:26,960 --> 00:23:29,440
this is the bot master client

577
00:23:29,440 --> 00:23:31,600
and here on the upper right and up in

578
00:23:31,600 --> 00:23:33,520
the lower right would be the clients or

579
00:23:33,520 --> 00:23:35,120
the bots

580
00:23:35,120 --> 00:23:36,720
what would happen here is i'm going to

581
00:23:36,720 --> 00:23:39,440
run them all of them at the same time

582
00:23:39,440 --> 00:23:40,400
and then

583
00:23:40,400 --> 00:23:42,720
i can from the server i can send

584
00:23:42,720 --> 00:23:46,000
commands for example i'll type info

585
00:23:46,000 --> 00:23:48,400
this means the server would tell the

586
00:23:48,400 --> 00:23:50,880
client send me an information about the

587
00:23:50,880 --> 00:23:54,320
machines wherein you are

588
00:23:54,640 --> 00:23:56,720
running from and since this is just a

589
00:23:56,720 --> 00:23:59,520
test they will just generate a random

590
00:23:59,520 --> 00:24:02,240
string of letters and numbers uh just to

591
00:24:02,240 --> 00:24:03,520
say now okay

592
00:24:03,520 --> 00:24:06,240
that this is the data and

593
00:24:06,240 --> 00:24:08,640
and the client would then send this that

594
00:24:08,640 --> 00:24:13,120
same data block back to the server

595
00:24:13,360 --> 00:24:15,840
once that has been generated and once

596
00:24:15,840 --> 00:24:18,080
that back and forth has been done the

597
00:24:18,080 --> 00:24:20,640
data that the server has received will

598
00:24:20,640 --> 00:24:22,960
be will appear here on the lower left

599
00:24:22,960 --> 00:24:25,360
these are the exfiltrated data

600
00:24:25,360 --> 00:24:26,480
okay

601
00:24:26,480 --> 00:24:28,240
so i explained that because it's just

602
00:24:28,240 --> 00:24:31,840
gonna happen really quick okay

603
00:24:31,840 --> 00:24:32,880
let me

604
00:24:32,880 --> 00:24:34,880
make it verbose on this i don't know let

605
00:24:34,880 --> 00:24:35,600
me

606
00:24:35,600 --> 00:24:37,840
let let's run it

607
00:24:37,840 --> 00:24:40,400
the server will run waiting for a

608
00:24:40,400 --> 00:24:41,919
command from me

609
00:24:41,919 --> 00:24:43,840
i'll run the client as well and the

610
00:24:43,840 --> 00:24:45,679
second client as well

611
00:24:45,679 --> 00:24:48,480
and if i type info

612
00:24:48,480 --> 00:24:50,240
it will send an info command to the

613
00:24:50,240 --> 00:24:52,000
clients

614
00:24:52,000 --> 00:24:54,559
and then the client would wait for the

615
00:24:54,559 --> 00:24:57,840
next time window

616
00:24:57,840 --> 00:24:59,440
and at the same time they will be

617
00:24:59,440 --> 00:25:01,039
posting

618
00:25:01,039 --> 00:25:01,919
um

619
00:25:01,919 --> 00:25:03,600
the same comment for them to get the

620
00:25:03,600 --> 00:25:06,320
same moderation hash

621
00:25:06,320 --> 00:25:08,960
so it's gonna take a bit of a while

622
00:25:08,960 --> 00:25:11,120
because again we're waiting on a time

623
00:25:11,120 --> 00:25:12,240
window

624
00:25:12,240 --> 00:25:14,240
so that's that's one of the downsides

625
00:25:14,240 --> 00:25:16,640
with this approach uh but you can you

626
00:25:16,640 --> 00:25:18,960
can change the code so that you can have

627
00:25:18,960 --> 00:25:22,799
a lower waiting time in between

628
00:25:22,799 --> 00:25:24,320
uh

629
00:25:24,320 --> 00:25:26,159
let me check if

630
00:25:26,159 --> 00:25:29,840
in a in the admin page if we could see

631
00:25:29,840 --> 00:25:32,720
if there are any new posts okay

632
00:25:32,720 --> 00:25:35,279
so yes there are this is the post that

633
00:25:35,279 --> 00:25:37,600
we made hello world and as you could see

634
00:25:37,600 --> 00:25:38,880
there are now

635
00:25:38,880 --> 00:25:40,400
new

636
00:25:40,400 --> 00:25:41,200
uh

637
00:25:41,200 --> 00:25:44,480
comments that are posted let me see why

638
00:25:44,480 --> 00:25:46,320
is it not working

639
00:25:46,320 --> 00:25:48,960
uh sending info command

640
00:25:48,960 --> 00:25:50,080
huh

641
00:25:50,080 --> 00:25:52,080
all right let me try again

642
00:25:52,080 --> 00:25:53,840
let me try again

643
00:25:53,840 --> 00:25:56,799
let me try again okay that's fine this

644
00:25:56,799 --> 00:25:59,919
is just a poc this is not yet a a usable

645
00:25:59,919 --> 00:26:03,039
tool let me make it verbose

646
00:26:03,039 --> 00:26:04,880
as well as for this one

647
00:26:04,880 --> 00:26:07,520
and for this one it's gonna be rather

648
00:26:07,520 --> 00:26:11,039
noisy but that's fine okay

649
00:26:11,039 --> 00:26:13,279
um okay

650
00:26:13,279 --> 00:26:16,559
so it's gonna be sending info command

651
00:26:16,559 --> 00:26:18,159
and it's gonna wait

652
00:26:18,159 --> 00:26:19,520
okay so as you can see it's brute

653
00:26:19,520 --> 00:26:20,799
forcing

654
00:26:20,799 --> 00:26:22,799
and it's trying to see if the client has

655
00:26:22,799 --> 00:26:26,320
sent a message to the botmaster

656
00:26:26,320 --> 00:26:28,480
but since the clients did not send

657
00:26:28,480 --> 00:26:30,880
anything it just stops

658
00:26:30,880 --> 00:26:35,120
for now we are waiting 0.7 minutes

659
00:26:35,120 --> 00:26:37,279
for the bot masters to send its info

660
00:26:37,279 --> 00:26:39,840
command

661
00:26:40,400 --> 00:26:42,159
point seven minutes

662
00:26:42,159 --> 00:26:43,600
okay there you go

663
00:26:43,600 --> 00:26:44,960
you could see

664
00:26:44,960 --> 00:26:47,600
that the info that the command was

665
00:26:47,600 --> 00:26:49,919
was uh was posted

666
00:26:49,919 --> 00:26:52,720
and we got the preview link right here

667
00:26:52,720 --> 00:26:54,960
if if we would go back

668
00:26:54,960 --> 00:26:56,880
if we would open the preview link we

669
00:26:56,880 --> 00:26:58,880
would see oh there you go

670
00:26:58,880 --> 00:27:00,559
this is the comment

671
00:27:00,559 --> 00:27:02,000
posted

672
00:27:02,000 --> 00:27:02,799
by

673
00:27:02,799 --> 00:27:05,919
the um the bot master and you would see

674
00:27:05,919 --> 00:27:08,720
that this is the

675
00:27:08,720 --> 00:27:11,440
this is the command that we

676
00:27:11,440 --> 00:27:13,919
that we wanted to uh that we wanted the

677
00:27:13,919 --> 00:27:16,640
bots to see

678
00:27:18,080 --> 00:27:22,640
if we go here you would see that

679
00:27:22,640 --> 00:27:25,679
all of the information are still in the

680
00:27:25,679 --> 00:27:28,320
moderation queue but as you can see 1

681
00:27:28,320 --> 00:27:30,880
900 comments don't worry um

682
00:27:30,880 --> 00:27:32,720
i've been testing it a lot so i've

683
00:27:32,720 --> 00:27:35,200
accumulated a lot of spam comments uh

684
00:27:35,200 --> 00:27:36,799
but going back

685
00:27:36,799 --> 00:27:38,240
all right

686
00:27:38,240 --> 00:27:40,559
uh actually it's already done

687
00:27:40,559 --> 00:27:43,200
the info was sent to the client the

688
00:27:43,200 --> 00:27:45,360
client received the info command and

689
00:27:45,360 --> 00:27:46,799
then sent

690
00:27:46,799 --> 00:27:50,000
the uh no the the data and the data is

691
00:27:50,000 --> 00:27:52,399
here right here

692
00:27:52,399 --> 00:27:55,440
i mentioned this is exfiltrated data

693
00:27:55,440 --> 00:27:57,440
and these are just random

694
00:27:57,440 --> 00:28:01,039
data that the client1 and client2 sent

695
00:28:01,039 --> 00:28:04,880
if we would look at the admin section

696
00:28:04,880 --> 00:28:07,760
let me see what was the message p5 and

697
00:28:07,760 --> 00:28:09,600
6g

698
00:28:09,600 --> 00:28:11,120
p5

699
00:28:11,120 --> 00:28:14,159
there you go now p5

700
00:28:14,159 --> 00:28:16,960
there you go so this is the same comment

701
00:28:16,960 --> 00:28:18,080
where in

702
00:28:18,080 --> 00:28:20,080
uh the client one

703
00:28:20,080 --> 00:28:21,279
posted

704
00:28:21,279 --> 00:28:24,159
onto the server and as you could see

705
00:28:24,159 --> 00:28:27,679
the server or the botmaster was able to

706
00:28:27,679 --> 00:28:31,559
to get that data

707
00:28:31,600 --> 00:28:33,919
okay so with all of the text that are

708
00:28:33,919 --> 00:28:36,159
are here it's really hard to

709
00:28:36,159 --> 00:28:37,039
um

710
00:28:37,039 --> 00:28:38,799
it might be a little too confusing and

711
00:28:38,799 --> 00:28:40,880
that is why i explained it

712
00:28:40,880 --> 00:28:42,000
before

713
00:28:42,000 --> 00:28:45,600
i showed the live demo uh but the only

714
00:28:45,600 --> 00:28:48,399
thing that you need to know is that

715
00:28:48,399 --> 00:28:50,640
they are using

716
00:28:50,640 --> 00:28:51,600
the

717
00:28:51,600 --> 00:28:53,679
the comments section and they are

718
00:28:53,679 --> 00:28:56,720
sending the ins the commands like this

719
00:28:56,720 --> 00:28:58,559
one info

720
00:28:58,559 --> 00:29:00,559
and then they receive that command and

721
00:29:00,559 --> 00:29:02,320
then after a while

722
00:29:02,320 --> 00:29:05,840
the the client would then send the data

723
00:29:05,840 --> 00:29:07,600
so right now it's just a randomly

724
00:29:07,600 --> 00:29:10,880
generated string but in the future

725
00:29:10,880 --> 00:29:12,640
uh what it can have is that say for

726
00:29:12,640 --> 00:29:15,120
example you want to

727
00:29:15,120 --> 00:29:16,399
send the

728
00:29:16,399 --> 00:29:17,360
all the

729
00:29:17,360 --> 00:29:20,880
host info then you could have a longer

730
00:29:20,880 --> 00:29:23,679
message right here

731
00:29:23,679 --> 00:29:26,960
and from here you could see that the

732
00:29:26,960 --> 00:29:28,320
the poc

733
00:29:28,320 --> 00:29:30,240
actually works

734
00:29:30,240 --> 00:29:31,679
hopefully

735
00:29:31,679 --> 00:29:33,120
that has

736
00:29:33,120 --> 00:29:35,120
intrigued you in some way i'm just going

737
00:29:35,120 --> 00:29:37,279
to stop all of them

738
00:29:37,279 --> 00:29:38,480
otherwise they're going to be

739
00:29:38,480 --> 00:29:40,880
accumulating a lot of

740
00:29:40,880 --> 00:29:42,559
spam comments

741
00:29:42,559 --> 00:29:44,559
all right

742
00:29:44,559 --> 00:29:47,679
okay so hopefully i was able to

743
00:29:47,679 --> 00:29:49,200
to show

744
00:29:49,200 --> 00:29:52,080
how the you know how the process works

745
00:29:52,080 --> 00:29:54,399
if you want to know more about the

746
00:29:54,399 --> 00:29:56,080
technical details

747
00:29:56,080 --> 00:29:58,240
you could visit this link for the

748
00:29:58,240 --> 00:30:00,240
project right here

749
00:30:00,240 --> 00:30:01,120
now

750
00:30:01,120 --> 00:30:04,399
my explanation is a bit simplified

751
00:30:04,399 --> 00:30:06,880
there are still a lot of things that are

752
00:30:06,880 --> 00:30:08,960
happening behind the scenes

753
00:30:08,960 --> 00:30:10,559
that

754
00:30:10,559 --> 00:30:12,720
for for this whole thing to work so if

755
00:30:12,720 --> 00:30:14,480
you're interested in this

756
00:30:14,480 --> 00:30:17,600
feel free to check out this uh demo link

757
00:30:17,600 --> 00:30:22,880
or this um project link here on github

758
00:30:22,880 --> 00:30:25,120
okay lastly

759
00:30:25,120 --> 00:30:27,120
what i'll do is

760
00:30:27,120 --> 00:30:29,840
there is another

761
00:30:29,840 --> 00:30:31,520
there is another way

762
00:30:31,520 --> 00:30:34,240
to be able to send message and i'm just

763
00:30:34,240 --> 00:30:35,760
gonna touch this

764
00:30:35,760 --> 00:30:37,679
i'm just going to touch on this a little

765
00:30:37,679 --> 00:30:39,840
bit

766
00:30:40,320 --> 00:30:42,880
one other thing that i found is that

767
00:30:42,880 --> 00:30:45,120
when a comment has already been posted

768
00:30:45,120 --> 00:30:46,480
before

769
00:30:46,480 --> 00:30:48,159
a message is shown

770
00:30:48,159 --> 00:30:49,279
saying

771
00:30:49,279 --> 00:30:51,919
duplicate comment detected so that means

772
00:30:51,919 --> 00:30:53,679
if you post hello

773
00:30:53,679 --> 00:30:55,760
and you post hello again

774
00:30:55,760 --> 00:30:57,279
this would appear

775
00:30:57,279 --> 00:30:58,799
makes sense

776
00:30:58,799 --> 00:31:01,360
and i realized that we could also use

777
00:31:01,360 --> 00:31:03,840
this as a way to acknowledge if a

778
00:31:03,840 --> 00:31:06,480
message has been received

779
00:31:06,480 --> 00:31:09,360
here's an example

780
00:31:09,519 --> 00:31:12,399
botmaster sent a command a while ago

781
00:31:12,399 --> 00:31:14,080
now the bot

782
00:31:14,080 --> 00:31:16,640
needs to send the exfiltrated data back

783
00:31:16,640 --> 00:31:18,880
to the botmaster

784
00:31:18,880 --> 00:31:20,480
along with the message

785
00:31:20,480 --> 00:31:22,960
there will be an identifier for example

786
00:31:22,960 --> 00:31:25,360
abc123

787
00:31:25,360 --> 00:31:27,760
it will post that message the botmaster

788
00:31:27,760 --> 00:31:30,080
will parse that message it will receive

789
00:31:30,080 --> 00:31:32,880
the exfoliated data and then it would

790
00:31:32,880 --> 00:31:34,880
post a comment again

791
00:31:34,880 --> 00:31:38,159
this time it would say abc123

792
00:31:38,159 --> 00:31:39,760
received

793
00:31:39,760 --> 00:31:42,080
it will post that

794
00:31:42,080 --> 00:31:43,840
next thing that will happen is that the

795
00:31:43,840 --> 00:31:44,720
bot

796
00:31:44,720 --> 00:31:48,120
would post that same message again

797
00:31:48,120 --> 00:31:50,559
abc123 received

798
00:31:50,559 --> 00:31:53,279
and because the bot master already

799
00:31:53,279 --> 00:31:56,240
posted that same message that exact same

800
00:31:56,240 --> 00:31:57,679
message

801
00:31:57,679 --> 00:32:00,240
the message the warning message wherein

802
00:32:00,240 --> 00:32:03,360
duplicate comment detected will appear

803
00:32:03,360 --> 00:32:06,080
this means we can confirm that the bot

804
00:32:06,080 --> 00:32:08,720
master received the comment that you

805
00:32:08,720 --> 00:32:10,159
sent

806
00:32:10,159 --> 00:32:12,799
if not that means the bot master did not

807
00:32:12,799 --> 00:32:15,760
receive it and the bot can resend the

808
00:32:15,760 --> 00:32:18,080
exfiltrated data again

809
00:32:18,080 --> 00:32:19,279
okay

810
00:32:19,279 --> 00:32:22,240
so that is also one way of doing this

811
00:32:22,240 --> 00:32:25,919
and it is also found in the poc

812
00:32:25,919 --> 00:32:29,840
project link that i sent

813
00:32:30,960 --> 00:32:32,399
all right technical details are

814
00:32:32,399 --> 00:32:34,480
simplified and so on i've already

815
00:32:34,480 --> 00:32:36,399
mentioned that

816
00:32:36,399 --> 00:32:37,120
so

817
00:32:37,120 --> 00:32:39,919
there you have it you have seen the the

818
00:32:39,919 --> 00:32:41,840
poc in action

819
00:32:41,840 --> 00:32:44,640
hopefully i was able to properly explain

820
00:32:44,640 --> 00:32:47,679
how it works how it uses the wordpress

821
00:32:47,679 --> 00:32:50,320
blog as a communications channel

822
00:32:50,320 --> 00:32:53,039
so the question now is

823
00:32:53,039 --> 00:32:56,799
how feasible is this approach

824
00:32:56,799 --> 00:32:58,720
in terms of scalability

825
00:32:58,720 --> 00:33:02,320
how feasible this is is this

826
00:33:02,320 --> 00:33:04,159
if there are more bots that are

827
00:33:04,159 --> 00:33:07,679
communicating using the same channel

828
00:33:07,679 --> 00:33:09,440
that would mean

829
00:33:09,440 --> 00:33:11,360
that would be a problem because the blog

830
00:33:11,360 --> 00:33:13,760
owner would then be bombarded with lots

831
00:33:13,760 --> 00:33:16,320
and lots of comments

832
00:33:16,320 --> 00:33:19,760
the answer to this is well

833
00:33:19,760 --> 00:33:23,158
excuse me

834
00:33:25,039 --> 00:33:26,880
the answer to this

835
00:33:26,880 --> 00:33:29,440
is that maybe you can use a pool of

836
00:33:29,440 --> 00:33:31,679
different blogs

837
00:33:31,679 --> 00:33:33,679
and you could assign a

838
00:33:33,679 --> 00:33:36,640
a specific blog for each bot

839
00:33:36,640 --> 00:33:40,399
that means you have spread the the

840
00:33:40,399 --> 00:33:42,720
you could spread the traffic to two

841
00:33:42,720 --> 00:33:45,039
different blogs

842
00:33:45,039 --> 00:33:47,360
that is that is one of the alternatives

843
00:33:47,360 --> 00:33:49,840
that you could do

844
00:33:49,840 --> 00:33:50,840
how about

845
00:33:50,840 --> 00:33:52,799
detectability

846
00:33:52,799 --> 00:33:55,679
can a defender be able to detect

847
00:33:55,679 --> 00:33:57,760
this kind of

848
00:33:57,760 --> 00:34:00,320
cnc

849
00:34:00,799 --> 00:34:02,799
we can use auto-moderation to our

850
00:34:02,799 --> 00:34:03,919
advantage

851
00:34:03,919 --> 00:34:05,120
remember

852
00:34:05,120 --> 00:34:07,200
because a comment

853
00:34:07,200 --> 00:34:10,159
because the comment gets posted uh gets

854
00:34:10,159 --> 00:34:12,719
sent to the auto moderation queue

855
00:34:12,719 --> 00:34:14,320
if a defender

856
00:34:14,320 --> 00:34:17,040
decides to visit that same link

857
00:34:17,040 --> 00:34:18,800
the only thing they'll see is that no

858
00:34:18,800 --> 00:34:20,320
comments

859
00:34:20,320 --> 00:34:22,800
because there are well there are no

860
00:34:22,800 --> 00:34:23,839
comments

861
00:34:23,839 --> 00:34:25,918
because the comments or the the messages

862
00:34:25,918 --> 00:34:28,719
that we used for exfiltrating

863
00:34:28,719 --> 00:34:29,918
is

864
00:34:29,918 --> 00:34:31,040
in the

865
00:34:31,040 --> 00:34:35,280
uh the communic the moderation queue

866
00:34:35,280 --> 00:34:38,480
only the owner of the block can see that

867
00:34:38,480 --> 00:34:40,079
and we can further

868
00:34:40,079 --> 00:34:44,159
uh hide our actions or hide our

869
00:34:44,159 --> 00:34:46,960
our data by obfuscating the

870
00:34:46,960 --> 00:34:49,839
data even more

871
00:34:53,280 --> 00:34:56,399
how do we able to stop this um it can be

872
00:34:56,399 --> 00:34:58,720
stopped with anti-spam plugins

873
00:34:58,720 --> 00:35:00,079
unfortunately

874
00:35:00,079 --> 00:35:04,000
i tried my best to try to look for a way

875
00:35:04,000 --> 00:35:06,720
to circumvent anti-spam

876
00:35:06,720 --> 00:35:07,839
and

877
00:35:07,839 --> 00:35:10,160
well that is why there's an industry as

878
00:35:10,160 --> 00:35:10,960
to

879
00:35:10,960 --> 00:35:13,280
circumventing an anti-spam plugins

880
00:35:13,280 --> 00:35:16,000
because a lot of spammers want to try to

881
00:35:16,000 --> 00:35:17,839
look for a solution to that

882
00:35:17,839 --> 00:35:18,800
so

883
00:35:18,800 --> 00:35:20,400
and this is the same problem that we

884
00:35:20,400 --> 00:35:21,200
have

885
00:35:21,200 --> 00:35:24,480
if a blog is using an anti-spam plugins

886
00:35:24,480 --> 00:35:26,800
just look for a different blog there are

887
00:35:26,800 --> 00:35:28,480
lots and lots of blogs

888
00:35:28,480 --> 00:35:31,200
that aren't using plug-ins just look for

889
00:35:31,200 --> 00:35:35,040
a mom-and-pop blog and then you're fine

890
00:35:35,040 --> 00:35:37,200
another way to stop this is that if

891
00:35:37,200 --> 00:35:39,040
wordpress devs

892
00:35:39,040 --> 00:35:40,960
change how the preview link generation

893
00:35:40,960 --> 00:35:42,240
works

894
00:35:42,240 --> 00:35:44,000
the great thing about the wordpress

895
00:35:44,000 --> 00:35:45,280
developers

896
00:35:45,280 --> 00:35:47,599
are they are always very

897
00:35:47,599 --> 00:35:49,920
um

898
00:35:49,920 --> 00:35:51,359
they're always very

899
00:35:51,359 --> 00:35:55,440
sensitive about these kinds of um

900
00:35:55,760 --> 00:35:58,720
these kinds of problems so that if this

901
00:35:58,720 --> 00:35:59,440
is

902
00:35:59,440 --> 00:36:01,920
if this is reported then they might

903
00:36:01,920 --> 00:36:04,000
change it they've they've already done

904
00:36:04,000 --> 00:36:06,079
it in the past they've already

905
00:36:06,079 --> 00:36:07,920
changed how the preview link generation

906
00:36:07,920 --> 00:36:13,440
works that means they might do it again

907
00:36:13,440 --> 00:36:15,440
but it's okay because i just the reason

908
00:36:15,440 --> 00:36:17,680
why i created this is that i just wanted

909
00:36:17,680 --> 00:36:19,119
to explore

910
00:36:19,119 --> 00:36:23,119
how to use wordpress as a viable option

911
00:36:23,119 --> 00:36:25,839
for a cnc

912
00:36:25,839 --> 00:36:27,200
as a summary

913
00:36:27,200 --> 00:36:29,520
we have seen how it works

914
00:36:29,520 --> 00:36:32,400
hopefully i was able to properly

915
00:36:32,400 --> 00:36:34,240
show and

916
00:36:34,240 --> 00:36:35,760
explain

917
00:36:35,760 --> 00:36:36,720
how

918
00:36:36,720 --> 00:36:38,880
the technical details

919
00:36:38,880 --> 00:36:41,200
we know that it has a lot of upsides

920
00:36:41,200 --> 00:36:42,320
which is

921
00:36:42,320 --> 00:36:44,720
a lot of plugs can be used as a channel

922
00:36:44,720 --> 00:36:47,520
because even if they are auto moderated

923
00:36:47,520 --> 00:36:50,720
it's fine we can see from then that

924
00:36:50,720 --> 00:36:52,640
there will be no cost for the attacker

925
00:36:52,640 --> 00:36:54,400
because we are using

926
00:36:54,400 --> 00:36:56,880
the server that other people have

927
00:36:56,880 --> 00:36:58,160
are using

928
00:36:58,160 --> 00:37:00,160
no signups no accounts because you can

929
00:37:00,160 --> 00:37:02,320
post anonymously

930
00:37:02,320 --> 00:37:05,440
the downsides however is the delays i

931
00:37:05,440 --> 00:37:07,760
mentioned a while a while ago that you

932
00:37:07,760 --> 00:37:10,480
have to wait for specific time slots

933
00:37:10,480 --> 00:37:14,160
sometimes this isn't a problem

934
00:37:14,160 --> 00:37:16,240
but there are also timing issues for

935
00:37:16,240 --> 00:37:18,320
example what if the server replies

936
00:37:18,320 --> 00:37:19,760
really really slow

937
00:37:19,760 --> 00:37:22,320
that means your timing your timing which

938
00:37:22,320 --> 00:37:23,440
is the

939
00:37:23,440 --> 00:37:25,760
which is this approach is highly

940
00:37:25,760 --> 00:37:27,280
dependent on

941
00:37:27,280 --> 00:37:30,400
if the timing is is is broken

942
00:37:30,400 --> 00:37:32,240
it won't work properly

943
00:37:32,240 --> 00:37:33,599
so

944
00:37:33,599 --> 00:37:35,440
that is one of the downsides of this

945
00:37:35,440 --> 00:37:36,960
approach

946
00:37:36,960 --> 00:37:38,320
okay

947
00:37:38,320 --> 00:37:39,200
so

948
00:37:39,200 --> 00:37:40,480
i think that's it

949
00:37:40,480 --> 00:37:42,100
i do hope i was able to

950
00:37:42,100 --> 00:37:44,240
[Music]

951
00:37:44,240 --> 00:37:45,520
inspire

952
00:37:45,520 --> 00:37:48,320
a lot of you to

953
00:37:48,320 --> 00:37:50,640
with with my project this is the

954
00:37:50,640 --> 00:37:52,880
wordpress c2 project

955
00:37:52,880 --> 00:37:55,440
again if you want to learn more feel

956
00:37:55,440 --> 00:37:57,839
free to visit these links right here i'm

957
00:37:57,839 --> 00:38:00,320
also available at accidental rebel and

958
00:38:00,320 --> 00:38:01,680
as always

959
00:38:01,680 --> 00:38:05,078
hack the planet

