1
00:00:29,039 --> 00:00:30,480
next uh

2
00:00:30,480 --> 00:00:32,960
agenda is uh the curious case of weird

3
00:00:32,960 --> 00:00:35,280
phone calls in the middle of the night

4
00:00:35,280 --> 00:00:37,760
by sharon brezenov

5
00:00:37,760 --> 00:00:39,040
so this

6
00:00:39,040 --> 00:00:43,120
in this talk the author describes the

7
00:00:43,120 --> 00:00:45,600
process in which

8
00:00:45,600 --> 00:00:48,800
the the author exploited a series of

9
00:00:48,800 --> 00:00:50,320
intercom systems

10
00:00:50,320 --> 00:00:52,399
to

11
00:00:52,399 --> 00:00:54,800
access the video feed feed from those

12
00:00:54,800 --> 00:00:56,480
systems

13
00:00:56,480 --> 00:00:59,520
without authorizations and and unlock um

14
00:00:59,520 --> 00:01:00,719
the doors

15
00:01:00,719 --> 00:01:02,079
um

16
00:01:02,079 --> 00:01:04,319
so um

17
00:01:04,319 --> 00:01:05,119
uh

18
00:01:05,119 --> 00:01:07,920
let's um

19
00:01:08,400 --> 00:01:13,400
so uh the the legend will begin

20
00:01:14,640 --> 00:01:16,960
hi everyone and welcome to my talk the

21
00:01:16,960 --> 00:01:19,759
curious case of weird phone calls in the

22
00:01:19,759 --> 00:01:21,920
middle of the night i'm sharon so let's

23
00:01:21,920 --> 00:01:23,360
begin

24
00:01:23,360 --> 00:01:24,799
so

25
00:01:24,799 --> 00:01:26,240
a few words about myself i'm a

26
00:01:26,240 --> 00:01:28,000
vulnerability research team leader

27
00:01:28,000 --> 00:01:29,040
clearly

28
00:01:29,040 --> 00:01:30,880
i'm leading the vulnerability research

29
00:01:30,880 --> 00:01:33,840
in scada iot mobile and malware

30
00:01:33,840 --> 00:01:35,439
topics

31
00:01:35,439 --> 00:01:38,159
i'm doing quite a lot of competitions or

32
00:01:38,159 --> 00:01:40,479
city halves i've played in defcon and

33
00:01:40,479 --> 00:01:41,600
pawn to on

34
00:01:41,600 --> 00:01:43,759
and as you can see on the screen this is

35
00:01:43,759 --> 00:01:46,799
my awesome lab or playground as i call

36
00:01:46,799 --> 00:01:47,680
it

37
00:01:47,680 --> 00:01:49,439
where i'm researching

38
00:01:49,439 --> 00:01:51,920
mostly ot and iot devices so i'm

39
00:01:51,920 --> 00:01:54,159
breaking them apart trying to poke

40
00:01:54,159 --> 00:01:56,079
around and the firmware and trying to

41
00:01:56,079 --> 00:01:58,000
poke around the horror and understand

42
00:01:58,000 --> 00:01:59,920
how they all how they operate how they

43
00:01:59,920 --> 00:02:01,759
work and how can i

44
00:02:01,759 --> 00:02:03,040
exploit

45
00:02:03,040 --> 00:02:05,280
security issues that i'm finding

46
00:02:05,280 --> 00:02:07,280
so today we're going to talk about

47
00:02:07,280 --> 00:02:09,199
intercoms

48
00:02:09,199 --> 00:02:10,959
intercoms are standalone voice

49
00:02:10,959 --> 00:02:14,080
communication devices uh for use within

50
00:02:14,080 --> 00:02:18,000
buildings or vessels like ships or boats

51
00:02:18,000 --> 00:02:20,000
we use intercoms to transfer voice

52
00:02:20,000 --> 00:02:22,560
communication over short distances and

53
00:02:22,560 --> 00:02:24,560
usually they're configured in a closed

54
00:02:24,560 --> 00:02:26,239
loop within a building

55
00:02:26,239 --> 00:02:28,879
intercoms used to consist of a couple of

56
00:02:28,879 --> 00:02:31,760
boxes with speakers connected by cables

57
00:02:31,760 --> 00:02:34,800
with an audio amplifier between

58
00:02:34,800 --> 00:02:37,680
the two units but today intercoms are

59
00:02:37,680 --> 00:02:40,000
far more advanced creatures and they're

60
00:02:40,000 --> 00:02:42,640
packed with lots of functionality

61
00:02:42,640 --> 00:02:44,400
you can see here a couple of examples

62
00:02:44,400 --> 00:02:46,720
that i've placed so on the left side you

63
00:02:46,720 --> 00:02:50,319
have a very old intercom device named

64
00:02:50,319 --> 00:02:53,120
speaking tubes or voice pipes and these

65
00:02:53,120 --> 00:02:55,040
devices are

66
00:02:55,040 --> 00:02:57,760
based on two cones connected by an air

67
00:02:57,760 --> 00:02:58,959
pipe

68
00:02:58,959 --> 00:03:01,040
through which speech can be transmitted

69
00:03:01,040 --> 00:03:03,680
over an extended distance and it was

70
00:03:03,680 --> 00:03:06,080
used mainly on watercrafts like boats

71
00:03:06,080 --> 00:03:08,319
and ships and this is actually the

72
00:03:08,319 --> 00:03:11,840
oldest intercom i was able to find

73
00:03:11,840 --> 00:03:13,599
evidence too

74
00:03:13,599 --> 00:03:15,280
in the middle we have an early day

75
00:03:15,280 --> 00:03:17,280
intercom

76
00:03:17,280 --> 00:03:20,159
which is fairly simple device uh very

77
00:03:20,159 --> 00:03:22,480
similar to the tin can telephone where

78
00:03:22,480 --> 00:03:24,400
it had two cups connected through a

79
00:03:24,400 --> 00:03:26,480
string and the sound was transmitted

80
00:03:26,480 --> 00:03:28,959
through vibrations

81
00:03:28,959 --> 00:03:31,519
uh on the right side we have the

82
00:03:31,519 --> 00:03:33,120
well-known

83
00:03:33,120 --> 00:03:34,640
classic intercom

84
00:03:34,640 --> 00:03:37,599
in the form of two or four wires so two

85
00:03:37,599 --> 00:03:41,040
wire connection uh intercoms provide

86
00:03:41,040 --> 00:03:42,879
voice communication in one direction at

87
00:03:42,879 --> 00:03:45,040
a time so it's half duplex and you would

88
00:03:45,040 --> 00:03:47,040
need to press a button in order to

89
00:03:47,040 --> 00:03:49,040
transfer audio

90
00:03:49,040 --> 00:03:50,959
or speech

91
00:03:50,959 --> 00:03:53,040
on the other side we have four wire

92
00:03:53,040 --> 00:03:55,519
intercoms that are full duplex which

93
00:03:55,519 --> 00:03:57,439
means people can transmit and receive

94
00:03:57,439 --> 00:03:59,519
audio at the same time

95
00:03:59,519 --> 00:04:02,480
so these are the older kind of old slash

96
00:04:02,480 --> 00:04:05,519
classic intercom devices

97
00:04:05,519 --> 00:04:08,159
and the modern intercoms are far more

98
00:04:08,159 --> 00:04:09,360
advanced

99
00:04:09,360 --> 00:04:12,159
iot devices that are fully packed with

100
00:04:12,159 --> 00:04:14,080
functionality

101
00:04:14,080 --> 00:04:15,439
so from

102
00:04:15,439 --> 00:04:17,918
video to door control these new era

103
00:04:17,918 --> 00:04:20,478
intercoms are no longer used just for

104
00:04:20,478 --> 00:04:22,560
audio communications and it's very

105
00:04:22,560 --> 00:04:24,960
common to see built-in cameras in almost

106
00:04:24,960 --> 00:04:27,520
all of them so again on the left side we

107
00:04:27,520 --> 00:04:30,479
have closed-loop ip-based intercoms

108
00:04:30,479 --> 00:04:31,840
which are

109
00:04:31,840 --> 00:04:34,720
used usually inside houses and buildings

110
00:04:34,720 --> 00:04:36,080
internally

111
00:04:36,080 --> 00:04:38,880
so this means they're communicating

112
00:04:38,880 --> 00:04:41,600
iep based inside a lan

113
00:04:41,600 --> 00:04:43,919
and on the right side we have the new

114
00:04:43,919 --> 00:04:46,400
cloud-based intercoms which are trans

115
00:04:46,400 --> 00:04:48,880
transmitting data through a cloud or

116
00:04:48,880 --> 00:04:51,040
external server on the internet and from

117
00:04:51,040 --> 00:04:53,840
the external server or the cloud it

118
00:04:53,840 --> 00:04:55,600
transfers the information

119
00:04:55,600 --> 00:04:58,320
usually to your smartphone and so the

120
00:04:58,320 --> 00:05:00,560
smartphone can see the video that the

121
00:05:00,560 --> 00:05:04,160
intercom the outdoor unit is

122
00:05:04,160 --> 00:05:05,600
recording

123
00:05:05,600 --> 00:05:07,919
and obviously since these are iot

124
00:05:07,919 --> 00:05:10,800
devices with camera and

125
00:05:10,800 --> 00:05:13,360
audio listening capabilities these

126
00:05:13,360 --> 00:05:16,080
devices are very lucrative for attackers

127
00:05:16,080 --> 00:05:16,880
and

128
00:05:16,880 --> 00:05:19,440
they're kind of a

129
00:05:19,440 --> 00:05:22,320
big target and juicy target for

130
00:05:22,320 --> 00:05:25,120
attackers to attack so

131
00:05:25,120 --> 00:05:27,280
enough with history uh now i want to

132
00:05:27,280 --> 00:05:30,080
tell you uh the story uh

133
00:05:30,080 --> 00:05:32,960
that we're all all here for

134
00:05:32,960 --> 00:05:35,120
uh so it all started with one weird

135
00:05:35,120 --> 00:05:37,600
phone call from my friend

136
00:05:37,600 --> 00:05:40,000
it was the middle of the night

137
00:05:40,000 --> 00:05:40,880
and

138
00:05:40,880 --> 00:05:41,680
he

139
00:05:41,680 --> 00:05:43,120
called me

140
00:05:43,120 --> 00:05:46,080
uh with some craziness and uh told me

141
00:05:46,080 --> 00:05:48,880
that he started to receive weird phone

142
00:05:48,880 --> 00:05:51,919
calls uh in the middle of the night and

143
00:05:51,919 --> 00:05:54,800
he could not figure out why so these

144
00:05:54,800 --> 00:05:57,039
weird phone calls uh as you can see here

145
00:05:57,039 --> 00:05:59,360
on the left side of the screen uh are

146
00:05:59,360 --> 00:06:01,840
kind of non-started numbers

147
00:06:01,840 --> 00:06:04,720
and when when he answered these weird

148
00:06:04,720 --> 00:06:06,720
phone calls the

149
00:06:06,720 --> 00:06:08,960
intercom app that they just installed a

150
00:06:08,960 --> 00:06:11,759
few days ago was opened and they started

151
00:06:11,759 --> 00:06:14,560
to see a video stream of an office

152
00:06:14,560 --> 00:06:16,800
somewhere around the world and each time

153
00:06:16,800 --> 00:06:17,840
a different

154
00:06:17,840 --> 00:06:21,199
number called him in a crazy hour

155
00:06:21,199 --> 00:06:23,840
and when he pressed the the call to

156
00:06:23,840 --> 00:06:26,479
answer it the app was opened and he

157
00:06:26,479 --> 00:06:29,280
started to see a video stream of unknown

158
00:06:29,280 --> 00:06:30,479
office

159
00:06:30,479 --> 00:06:32,960
and obviously i was very interested to

160
00:06:32,960 --> 00:06:34,639
understand what's going on obviously

161
00:06:34,639 --> 00:06:37,360
it's a bug in the intercom system that

162
00:06:37,360 --> 00:06:39,520
he bought a few days ago but

163
00:06:39,520 --> 00:06:42,479
why and how can he see video streams of

164
00:06:42,479 --> 00:06:44,240
different intercoms around the world it

165
00:06:44,240 --> 00:06:46,000
doesn't make sense

166
00:06:46,000 --> 00:06:47,039
so

167
00:06:47,039 --> 00:06:49,840
then i started my online research

168
00:06:49,840 --> 00:06:51,919
and when i started my online research i

169
00:06:51,919 --> 00:06:54,000
asked my friend for the name of the

170
00:06:54,000 --> 00:06:56,400
company that made the intercom and the

171
00:06:56,400 --> 00:06:58,720
name of the mobile app installed he told

172
00:06:58,720 --> 00:06:59,599
me

173
00:06:59,599 --> 00:07:00,560
it's

174
00:07:00,560 --> 00:07:04,639
a local brand that what he thought

175
00:07:04,639 --> 00:07:07,120
and then the name of the app was too

176
00:07:07,120 --> 00:07:09,280
easy so i just started from there

177
00:07:09,280 --> 00:07:10,880
started to google

178
00:07:10,880 --> 00:07:13,039
and search for youtube videos with

179
00:07:13,039 --> 00:07:16,160
installation guides and how people are

180
00:07:16,160 --> 00:07:18,400
setting up their own intercom devices

181
00:07:18,400 --> 00:07:20,880
and i just wanted to see some equipment

182
00:07:20,880 --> 00:07:22,160
and some

183
00:07:22,160 --> 00:07:24,080
guides of how to install and set up

184
00:07:24,080 --> 00:07:26,080
these kind of devices

185
00:07:26,080 --> 00:07:27,039
so

186
00:07:27,039 --> 00:07:29,919
i saw lots of different panels touch

187
00:07:29,919 --> 00:07:33,360
screen panels and outdoor units

188
00:07:33,360 --> 00:07:34,960
as you can see here this is the outdoor

189
00:07:34,960 --> 00:07:37,599
unit and the touch screens

190
00:07:37,599 --> 00:07:40,720
and you can see different menus of

191
00:07:40,720 --> 00:07:41,680
these

192
00:07:41,680 --> 00:07:43,759
mobile mobile apps that are connected to

193
00:07:43,759 --> 00:07:45,039
the intercom

194
00:07:45,039 --> 00:07:46,720
and even people

195
00:07:46,720 --> 00:07:48,479
showing how they're configuring their

196
00:07:48,479 --> 00:07:49,919
own devices

197
00:07:49,919 --> 00:07:52,080
and then i started to search how can i

198
00:07:52,080 --> 00:07:53,680
buy these devices and what are the

199
00:07:53,680 --> 00:07:54,720
different

200
00:07:54,720 --> 00:07:56,960
device types that are available on the

201
00:07:56,960 --> 00:08:00,639
market and i came to realize that most

202
00:08:00,639 --> 00:08:03,759
of these devices are distributed locally

203
00:08:03,759 --> 00:08:06,080
but they're manufactured by a chinese

204
00:08:06,080 --> 00:08:08,720
company named vtec

205
00:08:08,720 --> 00:08:10,720
and vtec

206
00:08:10,720 --> 00:08:13,440
manufactures all of these devices and

207
00:08:13,440 --> 00:08:17,680
distributes it around the world so

208
00:08:17,680 --> 00:08:20,240
i had a fairly good understanding of the

209
00:08:20,240 --> 00:08:23,599
logistics of what happened and

210
00:08:23,599 --> 00:08:25,520
we have the vita company which is the

211
00:08:25,520 --> 00:08:28,800
oem original equipment manufacturer

212
00:08:28,800 --> 00:08:30,639
they're manufacturing different intercom

213
00:08:30,639 --> 00:08:32,399
devices

214
00:08:32,399 --> 00:08:34,320
cameras and

215
00:08:34,320 --> 00:08:36,640
touch screens and they're distributing

216
00:08:36,640 --> 00:08:38,559
it around the world through local

217
00:08:38,559 --> 00:08:40,958
distributors so for example in israel we

218
00:08:40,958 --> 00:08:42,559
have the door company

219
00:08:42,559 --> 00:08:45,440
and in the uk we have the cdvi company

220
00:08:45,440 --> 00:08:48,240
and these companies are taking the the

221
00:08:48,240 --> 00:08:51,519
equipment white labeling it as if it was

222
00:08:51,519 --> 00:08:53,360
locally made and

223
00:08:53,360 --> 00:08:54,800
that's why you're seeing in your

224
00:08:54,800 --> 00:08:57,360
building a local company

225
00:08:57,360 --> 00:09:00,000
uh on the intercom uh so they're doing

226
00:09:00,000 --> 00:09:01,839
this around the world i gave you two

227
00:09:01,839 --> 00:09:04,160
examples but actually i found uh many

228
00:09:04,160 --> 00:09:06,320
more countries with local distributors

229
00:09:06,320 --> 00:09:08,880
that are are doing that white labeling

230
00:09:08,880 --> 00:09:11,600
uh intercom products

231
00:09:11,600 --> 00:09:13,760
so i started to dig around the manuals

232
00:09:13,760 --> 00:09:15,519
to understand how these devices are

233
00:09:15,519 --> 00:09:18,720
working and what i discovered is this is

234
00:09:18,720 --> 00:09:20,800
a two wire system

235
00:09:20,800 --> 00:09:23,120
you have the outdoor unit on the left

236
00:09:23,120 --> 00:09:25,200
you have uh the power supply and the bus

237
00:09:25,200 --> 00:09:27,440
terminal hub in the middle and on the

238
00:09:27,440 --> 00:09:30,080
right you have touch screens uh that can

239
00:09:30,080 --> 00:09:32,320
be dc chained if you are if you have a

240
00:09:32,320 --> 00:09:34,160
building with lots of apartments you

241
00:09:34,160 --> 00:09:36,080
want in each apartment to have this kind

242
00:09:36,080 --> 00:09:39,200
of a panel so when someone rings on the

243
00:09:39,200 --> 00:09:42,399
intercom outside of the building

244
00:09:42,399 --> 00:09:45,519
the right panel in the right apartment

245
00:09:45,519 --> 00:09:46,720
will

246
00:09:46,720 --> 00:09:50,080
be ringing so i started to look for more

247
00:09:50,080 --> 00:09:53,120
uh videos more guides more uh online

248
00:09:53,120 --> 00:09:55,519
information because this is the awesome

249
00:09:55,519 --> 00:09:57,760
part of the research and this is for

250
00:09:57,760 --> 00:10:00,399
example some images that i pulled from

251
00:10:00,399 --> 00:10:02,320
one of the videos

252
00:10:02,320 --> 00:10:03,920
and you can see here the outdoor

253
00:10:03,920 --> 00:10:06,160
intercom unit and you can see the home

254
00:10:06,160 --> 00:10:07,440
unit

255
00:10:07,440 --> 00:10:09,920
and i quickly realized that the home

256
00:10:09,920 --> 00:10:10,800
unit

257
00:10:10,800 --> 00:10:12,320
is uh

258
00:10:12,320 --> 00:10:15,120
ip based so from one side it

259
00:10:15,120 --> 00:10:16,880
communicates with the intercom via two

260
00:10:16,880 --> 00:10:19,600
two-wire system and on the other side

261
00:10:19,600 --> 00:10:22,959
it has wi-fi and ip and it communicates

262
00:10:22,959 --> 00:10:24,720
to a cloud service

263
00:10:24,720 --> 00:10:27,920
so if you cannot answer

264
00:10:27,920 --> 00:10:29,680
in your home because you're not home and

265
00:10:29,680 --> 00:10:31,680
someone rings the intercom

266
00:10:31,680 --> 00:10:34,399
then it will the call will be diverted

267
00:10:34,399 --> 00:10:36,560
through the cloud to the mobile app that

268
00:10:36,560 --> 00:10:38,880
you needed to configure and bind with

269
00:10:38,880 --> 00:10:41,760
your home unit

270
00:10:41,760 --> 00:10:45,200
so i started to dig around these topics

271
00:10:45,200 --> 00:10:46,720
as well how

272
00:10:46,720 --> 00:10:49,120
the diverted model is working how people

273
00:10:49,120 --> 00:10:51,920
are configuring these modes and i

274
00:10:51,920 --> 00:10:52,880
quickly

275
00:10:52,880 --> 00:10:53,760
uh

276
00:10:53,760 --> 00:10:56,079
realized that

277
00:10:56,079 --> 00:10:57,920
the two-wire system is communicating

278
00:10:57,920 --> 00:11:01,200
with a panel which is a gateway and the

279
00:11:01,200 --> 00:11:03,519
gateway transfers the call

280
00:11:03,519 --> 00:11:06,399
through sip uh to the cloud and from

281
00:11:06,399 --> 00:11:07,200
there

282
00:11:07,200 --> 00:11:08,240
it will

283
00:11:08,240 --> 00:11:11,680
redirt or the vertical to the mobile app

284
00:11:11,680 --> 00:11:14,560
that is connected to the gateway

285
00:11:14,560 --> 00:11:15,680
but

286
00:11:15,680 --> 00:11:16,800
i was

287
00:11:16,800 --> 00:11:19,279
very curious to understand how

288
00:11:19,279 --> 00:11:21,920
a factory account is present so

289
00:11:21,920 --> 00:11:23,839
in their manuals

290
00:11:23,839 --> 00:11:26,560
they're saying that a factory account is

291
00:11:26,560 --> 00:11:29,440
presented actually you just need to

292
00:11:29,440 --> 00:11:32,720
connect the system uh set up your system

293
00:11:32,720 --> 00:11:34,959
at your home without configuring any

294
00:11:34,959 --> 00:11:37,200
username or password and it will just

295
00:11:37,200 --> 00:11:39,120
work out of the box

296
00:11:39,120 --> 00:11:40,720
so

297
00:11:40,720 --> 00:11:42,880
at first i could not understand how how

298
00:11:42,880 --> 00:11:45,279
can it be because if i'm buying my own

299
00:11:45,279 --> 00:11:48,160
system and just working with a default

300
00:11:48,160 --> 00:11:50,320
user and a password how

301
00:11:50,320 --> 00:11:52,959
my system won't

302
00:11:52,959 --> 00:11:55,200
be mixed with other systems

303
00:11:55,200 --> 00:11:57,680
and then i started

304
00:11:57,680 --> 00:11:59,279
to understand why i started this

305
00:11:59,279 --> 00:12:02,639
research because there was such a mix

306
00:12:02,639 --> 00:12:03,760
and

307
00:12:03,760 --> 00:12:06,959
at this point i thought i understand i

308
00:12:06,959 --> 00:12:08,560
was starting to understand what's going

309
00:12:08,560 --> 00:12:11,200
on and what happened to my friend

310
00:12:11,200 --> 00:12:13,920
and to explain this i first need to take

311
00:12:13,920 --> 00:12:17,200
you a few years back to skype

312
00:12:17,200 --> 00:12:19,440
and if you remember skype you had a

313
00:12:19,440 --> 00:12:22,720
special bot special account support.com

314
00:12:22,720 --> 00:12:25,839
that you can just call anytime you want

315
00:12:25,839 --> 00:12:28,560
and it will automatically answers you

316
00:12:28,560 --> 00:12:30,800
and it will

317
00:12:30,800 --> 00:12:33,440
transmit the audio it receives from you

318
00:12:33,440 --> 00:12:34,399
so

319
00:12:34,399 --> 00:12:37,440
it's kind of an echo automatic bot that

320
00:12:37,440 --> 00:12:39,760
always answers you and it's a very

321
00:12:39,760 --> 00:12:42,800
special number in the skype network

322
00:12:42,800 --> 00:12:45,600
and i quickly realized that this is

323
00:12:45,600 --> 00:12:48,160
exactly what happens here

324
00:12:48,160 --> 00:12:51,760
vtech under cloud had a test account

325
00:12:51,760 --> 00:12:53,680
which anyone

326
00:12:53,680 --> 00:12:57,040
can use to try and set up a call

327
00:12:57,040 --> 00:12:59,120
and you can actually

328
00:12:59,120 --> 00:13:02,000
set up or test this account from

329
00:13:02,000 --> 00:13:04,720
anywhere you can test it from the home

330
00:13:04,720 --> 00:13:06,880
unit and you can also test it from the

331
00:13:06,880 --> 00:13:09,519
mobile app so if you press here on the

332
00:13:09,519 --> 00:13:11,519
test account it will actually configure

333
00:13:11,519 --> 00:13:14,079
the mobile application to communicate

334
00:13:14,079 --> 00:13:17,279
with this echo reply bot that will

335
00:13:17,279 --> 00:13:19,519
answer you automatically

336
00:13:19,519 --> 00:13:21,360
but this is

337
00:13:21,360 --> 00:13:24,800
a sip network and so if you configure a

338
00:13:24,800 --> 00:13:28,399
device with a specific account and you

339
00:13:28,399 --> 00:13:30,079
know the password

340
00:13:30,079 --> 00:13:32,800
which was easy easily guessable

341
00:13:32,800 --> 00:13:36,000
then you could configure another device

342
00:13:36,000 --> 00:13:39,440
with this test account and so anyone who

343
00:13:39,440 --> 00:13:40,880
will try

344
00:13:40,880 --> 00:13:43,040
to communicate with this desk account

345
00:13:43,040 --> 00:13:44,720
will reach to you

346
00:13:44,720 --> 00:13:47,440
so let's see the chain of events and

347
00:13:47,440 --> 00:13:50,000
we'll understand what what's going on

348
00:13:50,000 --> 00:13:52,959
so first we have some somewhere we have

349
00:13:52,959 --> 00:13:55,680
an intercom that someone is ringing on

350
00:13:55,680 --> 00:13:56,880
the doorbell

351
00:13:56,880 --> 00:13:58,880
because they're at the office and they

352
00:13:58,880 --> 00:14:01,839
want to get

353
00:14:01,839 --> 00:14:04,560
the home unit that is connected through

354
00:14:04,560 --> 00:14:09,600
two wires to this intercom is ringing

355
00:14:09,600 --> 00:14:12,160
but no one is there so a diverted

356
00:14:12,160 --> 00:14:15,440
account is activated but for some reason

357
00:14:15,440 --> 00:14:18,320
in those home units the diverted account

358
00:14:18,320 --> 00:14:19,839
that is configured

359
00:14:19,839 --> 00:14:21,920
is the test account

360
00:14:21,920 --> 00:14:24,160
because maybe someone accidentally

361
00:14:24,160 --> 00:14:25,680
pressed on the

362
00:14:25,680 --> 00:14:27,199
test account

363
00:14:27,199 --> 00:14:29,040
settings

364
00:14:29,040 --> 00:14:30,959
then what happens is the diverted

365
00:14:30,959 --> 00:14:34,160
account is uh being activated and the

366
00:14:34,160 --> 00:14:36,160
call is transferred through the internet

367
00:14:36,160 --> 00:14:38,000
through their cloud service

368
00:14:38,000 --> 00:14:39,279
to

369
00:14:39,279 --> 00:14:40,079
the

370
00:14:40,079 --> 00:14:43,600
test account but for some reason uh my

371
00:14:43,600 --> 00:14:45,040
friend's phone

372
00:14:45,040 --> 00:14:48,000
got set up with the test account and so

373
00:14:48,000 --> 00:14:49,920
the call was diverted to the test

374
00:14:49,920 --> 00:14:51,920
account which is now configured on my

375
00:14:51,920 --> 00:14:53,920
friend's phone

376
00:14:53,920 --> 00:14:54,959
and

377
00:14:54,959 --> 00:14:57,519
since it has the test account configured

378
00:14:57,519 --> 00:14:59,440
on his phone he started to receive all

379
00:14:59,440 --> 00:15:00,880
those different

380
00:15:00,880 --> 00:15:04,160
test accounts from all of these offices

381
00:15:04,160 --> 00:15:07,279
so when he answered these phone calls

382
00:15:07,279 --> 00:15:10,720
he saw the office where some miserable

383
00:15:10,720 --> 00:15:13,199
person tried to get in and no one

384
00:15:13,199 --> 00:15:14,720
answers them

385
00:15:14,720 --> 00:15:15,680
so

386
00:15:15,680 --> 00:15:17,920
this was kind of the the case of my

387
00:15:17,920 --> 00:15:21,040
friend and to prove this to test this i

388
00:15:21,040 --> 00:15:24,399
actually uh set up my own environment

389
00:15:24,399 --> 00:15:26,880
with my own

390
00:15:26,880 --> 00:15:29,440
test account and i waited for a few

391
00:15:29,440 --> 00:15:31,040
weeks and

392
00:15:31,040 --> 00:15:32,720
when i came back after after you a few

393
00:15:32,720 --> 00:15:34,800
weeks i let it run for a few weeks and

394
00:15:34,800 --> 00:15:37,519
when i came back i saw lots of different

395
00:15:37,519 --> 00:15:39,920
calls from all over the world from all

396
00:15:39,920 --> 00:15:41,120
different

397
00:15:41,120 --> 00:15:43,040
accounts

398
00:15:43,040 --> 00:15:44,399
trying to

399
00:15:44,399 --> 00:15:48,160
reach the test account which i took over

400
00:15:48,160 --> 00:15:49,120
because

401
00:15:49,120 --> 00:15:52,000
i was able to log in as the test account

402
00:15:52,000 --> 00:15:54,959
and the test account is i was able to

403
00:15:54,959 --> 00:15:57,279
find a test account because i reversed

404
00:15:57,279 --> 00:15:58,079
the

405
00:15:58,079 --> 00:16:00,639
the application i saw what number it

406
00:16:00,639 --> 00:16:03,120
tries to communicate with

407
00:16:03,120 --> 00:16:04,240
and so

408
00:16:04,240 --> 00:16:07,120
uh it was very easy to guess

409
00:16:07,120 --> 00:16:08,959
that the test account is just five five

410
00:16:08,959 --> 00:16:10,560
five five five to understand that the

411
00:16:10,560 --> 00:16:13,040
test account is five five five five and

412
00:16:13,040 --> 00:16:15,759
the password was the same so the same as

413
00:16:15,759 --> 00:16:16,959
the username

414
00:16:16,959 --> 00:16:17,680
and

415
00:16:17,680 --> 00:16:20,560
if you log in to the zip network of the

416
00:16:20,560 --> 00:16:23,759
vtec cloud with this test account the

417
00:16:23,759 --> 00:16:24,560
last

418
00:16:24,560 --> 00:16:26,399
the last one that will

419
00:16:26,399 --> 00:16:28,240
log in to this test account will

420
00:16:28,240 --> 00:16:31,040
override and will start receiving calls

421
00:16:31,040 --> 00:16:33,120
from all over the world

422
00:16:33,120 --> 00:16:35,360
from devices that are configured to

423
00:16:35,360 --> 00:16:37,440
divert the call to the

424
00:16:37,440 --> 00:16:38,959
test account

425
00:16:38,959 --> 00:16:40,079
so

426
00:16:40,079 --> 00:16:42,079
this was the case of

427
00:16:42,079 --> 00:16:43,839
my friends

428
00:16:43,839 --> 00:16:45,440
intercom

429
00:16:45,440 --> 00:16:47,839
and obviously it just

430
00:16:47,839 --> 00:16:49,040
opened

431
00:16:49,040 --> 00:16:52,320
my interest and started and i started to

432
00:16:52,320 --> 00:16:55,120
to dig even deeper so i asked myself

433
00:16:55,120 --> 00:16:58,480
okay but uh can it get worse

434
00:16:58,480 --> 00:17:00,240
so again i

435
00:17:00,240 --> 00:17:01,839
went back to the manual because at the

436
00:17:01,839 --> 00:17:03,519
time i did not have the firmware and the

437
00:17:03,519 --> 00:17:05,280
device yet

438
00:17:05,280 --> 00:17:08,559
and i saw a section that

439
00:17:08,559 --> 00:17:10,640
talks about surveillance mode so

440
00:17:10,640 --> 00:17:12,640
surveillance door station

441
00:17:12,640 --> 00:17:13,599
and

442
00:17:13,599 --> 00:17:16,319
so it happens that not only you can

443
00:17:16,319 --> 00:17:19,520
reach from the intercom to the gateway

444
00:17:19,520 --> 00:17:21,679
and diverted to your phone but you can

445
00:17:21,679 --> 00:17:23,919
also do the opposite direction so you

446
00:17:23,919 --> 00:17:27,359
can from your phone that is

447
00:17:27,359 --> 00:17:30,320
binded to the home unit you from the

448
00:17:30,320 --> 00:17:33,120
phone you can start surveillance mode or

449
00:17:33,120 --> 00:17:34,960
monitor mode

450
00:17:34,960 --> 00:17:36,960
which actually

451
00:17:36,960 --> 00:17:38,640
calls the cloud

452
00:17:38,640 --> 00:17:40,640
enters the zip network and through the

453
00:17:40,640 --> 00:17:42,000
cloud

454
00:17:42,000 --> 00:17:43,520
it will

455
00:17:43,520 --> 00:17:45,600
be redirected to the home unit

456
00:17:45,600 --> 00:17:48,160
configured at your home

457
00:17:48,160 --> 00:17:51,919
and this was very interesting because

458
00:17:51,919 --> 00:17:54,400
the intercom to the home unit and the

459
00:17:54,400 --> 00:17:56,880
smartphone is kind of the the obvious of

460
00:17:56,880 --> 00:17:59,760
how intercom modern intercoms will work

461
00:17:59,760 --> 00:18:04,000
but if you can open at will the camera

462
00:18:04,000 --> 00:18:06,240
in someone's intercom

463
00:18:06,240 --> 00:18:08,160
this is scary so

464
00:18:08,160 --> 00:18:11,360
uh this what happened this what started

465
00:18:11,360 --> 00:18:14,080
the the real interest and now i really

466
00:18:14,080 --> 00:18:16,320
wanted to research this device get the

467
00:18:16,320 --> 00:18:18,480
firmware and buy the device so

468
00:18:18,480 --> 00:18:20,960
this was the time that uh i decided to

469
00:18:20,960 --> 00:18:23,200
buy the device and i started to search

470
00:18:23,200 --> 00:18:26,320
for the firmware and as i called it i

471
00:18:26,320 --> 00:18:28,960
let the party begin so let's see what

472
00:18:28,960 --> 00:18:31,280
we're dealing with we have

473
00:18:31,280 --> 00:18:32,960
a device

474
00:18:32,960 --> 00:18:33,919
dt

475
00:18:33,919 --> 00:18:37,760
607 this is a outdoor unit a keypad with

476
00:18:37,760 --> 00:18:40,240
a camera it's a two-wire system it's

477
00:18:40,240 --> 00:18:42,720
connected to a wi-fi monitor in this

478
00:18:42,720 --> 00:18:46,960
case i bought the dx471

479
00:18:46,960 --> 00:18:48,559
uh and

480
00:18:48,559 --> 00:18:50,480
this device is from one side

481
00:18:50,480 --> 00:18:52,559
communicates to the undercom3 two-wire

482
00:18:52,559 --> 00:18:54,559
system and from the other side it come

483
00:18:54,559 --> 00:18:57,039
it has a wi-fi capabilities so it

484
00:18:57,039 --> 00:18:59,919
communicates through their cloud service

485
00:18:59,919 --> 00:19:02,160
to the mobile smartphones

486
00:19:02,160 --> 00:19:05,200
and obviously what's interesting here is

487
00:19:05,200 --> 00:19:08,720
the wi-fi monitor or on the touchscreen

488
00:19:08,720 --> 00:19:11,679
because it has the wi-fi capabilities

489
00:19:11,679 --> 00:19:14,640
and obviously when we're communicating

490
00:19:14,640 --> 00:19:15,440
uh

491
00:19:15,440 --> 00:19:17,440
with the mobile app it will communicate

492
00:19:17,440 --> 00:19:19,360
with this device which will command

493
00:19:19,360 --> 00:19:22,000
through the two-wire on the intercom so

494
00:19:22,000 --> 00:19:25,039
obviously my research was around this

495
00:19:25,039 --> 00:19:26,080
device

496
00:19:26,080 --> 00:19:28,240
so this is a

497
00:19:28,240 --> 00:19:30,799
a two-wire system device which has

498
00:19:30,799 --> 00:19:33,280
ethernet or wi-fi capabilities it can

499
00:19:33,280 --> 00:19:35,440
communicate to the cloud

500
00:19:35,440 --> 00:19:37,120
and

501
00:19:37,120 --> 00:19:39,679
it's a very fairly simple video door

502
00:19:39,679 --> 00:19:42,799
system with uh kind of uh

503
00:19:42,799 --> 00:19:44,720
sip capabilities

504
00:19:44,720 --> 00:19:46,720
and what i wanted to do at this at the

505
00:19:46,720 --> 00:19:49,120
time was to get the firmware so i just

506
00:19:49,120 --> 00:19:50,559
started to google

507
00:19:50,559 --> 00:19:51,640
uh

508
00:19:51,640 --> 00:19:54,880
dx471 firmware and i started to look for

509
00:19:54,880 --> 00:19:57,360
all kinds of different forums and

510
00:19:57,360 --> 00:19:59,840
eventually i was able to find the

511
00:19:59,840 --> 00:20:02,400
firmware the firmware is linux based

512
00:20:02,400 --> 00:20:04,640
operating system

513
00:20:04,640 --> 00:20:08,080
it runs on arm little indian 32 bit and

514
00:20:08,080 --> 00:20:10,960
the main binary is called dx

515
00:20:10,960 --> 00:20:13,120
471 this was

516
00:20:13,120 --> 00:20:15,440
11 megabytes

517
00:20:15,440 --> 00:20:18,240
binary with symbols so it was very easy

518
00:20:18,240 --> 00:20:20,880
to do the reverse engineering here

519
00:20:20,880 --> 00:20:23,679
uh and so i started to look around this

520
00:20:23,679 --> 00:20:25,600
binary uh

521
00:20:25,600 --> 00:20:28,159
what what it does how it receives calls

522
00:20:28,159 --> 00:20:31,679
uh how it communicates uh with different

523
00:20:31,679 --> 00:20:35,120
devices how it goes out to the cloud

524
00:20:35,120 --> 00:20:37,760
so i did kind of this initial

525
00:20:37,760 --> 00:20:40,000
reconnaissance on the firmware and then

526
00:20:40,000 --> 00:20:43,600
i moved to research the mobile app so

527
00:20:43,600 --> 00:20:45,600
the mobile app is called the too easy

528
00:20:45,600 --> 00:20:49,039
app and this i researched the android

529
00:20:49,039 --> 00:20:51,440
version so i downloaded the apk and

530
00:20:51,440 --> 00:20:53,679
started to reverse and generic uh

531
00:20:53,679 --> 00:20:56,320
obviously it's java based and

532
00:20:56,320 --> 00:20:57,280
quite

533
00:20:57,280 --> 00:21:00,480
fast i realized that the sip client is

534
00:21:00,480 --> 00:21:04,799
line phone uh and it actually uses a sip

535
00:21:04,799 --> 00:21:08,799
protocol stack named bella sip

536
00:21:08,799 --> 00:21:12,080
so these are the the two platforms the

537
00:21:12,080 --> 00:21:13,760
firmware and the mobile app that i

538
00:21:13,760 --> 00:21:17,360
started to reverse engineer and

539
00:21:17,360 --> 00:21:19,039
i started to ask myself a couple of

540
00:21:19,039 --> 00:21:22,080
questions a research leading questions

541
00:21:22,080 --> 00:21:23,919
uh i started to

542
00:21:23,919 --> 00:21:24,640
to

543
00:21:24,640 --> 00:21:26,799
question myself what am i looking for

544
00:21:26,799 --> 00:21:28,640
i'm looking for how the authentication

545
00:21:28,640 --> 00:21:30,000
is working

546
00:21:30,000 --> 00:21:32,320
how the cloud connection is working how

547
00:21:32,320 --> 00:21:34,880
did the revert mode is working

548
00:21:34,880 --> 00:21:36,960
so i started with all of these questions

549
00:21:36,960 --> 00:21:39,840
and specifically i started to search for

550
00:21:39,840 --> 00:21:43,039
the sip related code flows because

551
00:21:43,039 --> 00:21:46,400
i knew that sip is involved here

552
00:21:46,400 --> 00:21:49,120
the c protocol is involved here and

553
00:21:49,120 --> 00:21:51,600
these two devices both the mobile app

554
00:21:51,600 --> 00:21:54,480
and the home unit are both connected to

555
00:21:54,480 --> 00:21:56,080
the sip network

556
00:21:56,080 --> 00:21:56,960
so

557
00:21:56,960 --> 00:22:00,080
i was able to understand that the the

558
00:22:00,080 --> 00:22:02,720
sip uh protocol

559
00:22:02,720 --> 00:22:05,600
stack was uh beliship and

560
00:22:05,600 --> 00:22:08,000
it's a protocol stacked by a company

561
00:22:08,000 --> 00:22:10,840
named line phone which is a quite

562
00:22:10,840 --> 00:22:12,360
popular uh

563
00:22:12,360 --> 00:22:15,200
c protocol company

564
00:22:15,200 --> 00:22:16,000
and

565
00:22:16,000 --> 00:22:18,320
i started to dig around those areas to

566
00:22:18,320 --> 00:22:20,960
understand the entire flows of

567
00:22:20,960 --> 00:22:23,039
what happens from what

568
00:22:23,039 --> 00:22:24,880
what happens from when you click on the

569
00:22:24,880 --> 00:22:27,520
intercom it's ringing on the arm unit

570
00:22:27,520 --> 00:22:30,240
and no one answers it diverts it through

571
00:22:30,240 --> 00:22:31,919
the sip network

572
00:22:31,919 --> 00:22:34,480
to your mobile app on your smartphone

573
00:22:34,480 --> 00:22:36,320
through the cloud so this is the flow

574
00:22:36,320 --> 00:22:38,559
that i reversed engineered

575
00:22:38,559 --> 00:22:40,559
so before we're talking about this flow

576
00:22:40,559 --> 00:22:43,520
let's talk about the sip protocol so

577
00:22:43,520 --> 00:22:46,000
the c protocol session initiation

578
00:22:46,000 --> 00:22:47,360
protocol

579
00:22:47,360 --> 00:22:50,320
is a single in protocol used for

580
00:22:50,320 --> 00:22:52,400
initiating uh maintaining and

581
00:22:52,400 --> 00:22:54,960
determinating real-time sessions uh that

582
00:22:54,960 --> 00:22:57,039
includes voice and video

583
00:22:57,039 --> 00:22:59,360
for messaging applications or voice

584
00:22:59,360 --> 00:23:01,919
voip applications so basically you have

585
00:23:01,919 --> 00:23:04,640
this kind of a virtual telephone network

586
00:23:04,640 --> 00:23:06,880
you have a sip client in the middle you

587
00:23:06,880 --> 00:23:08,880
have the the sip server

588
00:23:08,880 --> 00:23:11,600
and obviously the goal of this protocol

589
00:23:11,600 --> 00:23:14,240
is to make sure that uh one client is

590
00:23:14,240 --> 00:23:17,600
able to signal and transfer audio and

591
00:23:17,600 --> 00:23:20,000
video to the other client so they are

592
00:23:20,000 --> 00:23:22,480
connected through the sip

593
00:23:22,480 --> 00:23:24,080
network and

594
00:23:24,080 --> 00:23:26,880
in this net this protocol is is fairly

595
00:23:26,880 --> 00:23:30,880
simple it runs over udp 5060 and it is

596
00:23:30,880 --> 00:23:35,679
very well defined in rfc 2543

597
00:23:35,679 --> 00:23:36,799
and

598
00:23:36,799 --> 00:23:38,960
initiating a call

599
00:23:38,960 --> 00:23:42,159
or and making a call is a fairly simple

600
00:23:42,159 --> 00:23:43,039
uh

601
00:23:43,039 --> 00:23:46,159
sequence so first one client uses the

602
00:23:46,159 --> 00:23:48,320
invite

603
00:23:48,320 --> 00:23:50,880
function code of the c protocol

604
00:23:50,880 --> 00:23:53,039
and it needs to send it to the zip

605
00:23:53,039 --> 00:23:55,760
server the sip server in this case is

606
00:23:55,760 --> 00:23:57,600
used just for

607
00:23:57,600 --> 00:24:00,720
relaying relaying the the traffic to the

608
00:24:00,720 --> 00:24:02,240
other client you want you wish to

609
00:24:02,240 --> 00:24:04,159
communicate with so you're basically

610
00:24:04,159 --> 00:24:06,720
telling the server hey i want to phone

611
00:24:06,720 --> 00:24:09,919
this and that client so the other client

612
00:24:09,919 --> 00:24:12,799
receives the message as is and it

613
00:24:12,799 --> 00:24:15,200
responds with okay it's ringing on my

614
00:24:15,200 --> 00:24:16,960
side which means

615
00:24:16,960 --> 00:24:19,919
uh i received the call but

616
00:24:19,919 --> 00:24:22,640
not sure that i want to answer yet

617
00:24:22,640 --> 00:24:24,880
and once the

618
00:24:24,880 --> 00:24:26,799
once the other client wants to answer

619
00:24:26,799 --> 00:24:30,799
they send 200 okay and the call is

620
00:24:30,799 --> 00:24:34,559
started and now data is transferred

621
00:24:34,559 --> 00:24:37,440
between two parties so audio and video

622
00:24:37,440 --> 00:24:39,120
depends on the application and

623
00:24:39,120 --> 00:24:40,960
eventually when one of the sides wants

624
00:24:40,960 --> 00:24:43,520
to terminate the call they will send a

625
00:24:43,520 --> 00:24:45,440
by function call

626
00:24:45,440 --> 00:24:47,120
in the c protocol

627
00:24:47,120 --> 00:24:48,960
which was which will result if

628
00:24:48,960 --> 00:24:51,440
everything is okay with 200 okay so

629
00:24:51,440 --> 00:24:53,120
let's see how it looks how the protocol

630
00:24:53,120 --> 00:24:54,880
looks like so you can see here a

631
00:24:54,880 --> 00:24:56,080
sequence

632
00:24:56,080 --> 00:24:59,520
of uh of sip

633
00:24:59,520 --> 00:25:01,440
communication and

634
00:25:01,440 --> 00:25:03,679
obviously sip

635
00:25:03,679 --> 00:25:05,919
the sip network has many clients and

636
00:25:05,919 --> 00:25:07,279
each client is

637
00:25:07,279 --> 00:25:08,720
needs to be

638
00:25:08,720 --> 00:25:09,679
unique

639
00:25:09,679 --> 00:25:12,559
so it has some kind of identification

640
00:25:12,559 --> 00:25:15,600
and in order to make uh

641
00:25:15,600 --> 00:25:17,600
in order to authenticate

642
00:25:17,600 --> 00:25:20,080
to the server there is a challenge a

643
00:25:20,080 --> 00:25:22,720
simple challenge response algorithm

644
00:25:22,720 --> 00:25:24,799
defined in the sip rfc and the c

645
00:25:24,799 --> 00:25:27,279
protocol and basically what it does it

646
00:25:27,279 --> 00:25:28,720
takes uh

647
00:25:28,720 --> 00:25:31,760
the method the uri

648
00:25:31,760 --> 00:25:35,039
and the nonce which is the challenge and

649
00:25:35,039 --> 00:25:37,279
it is being combined with the username

650
00:25:37,279 --> 00:25:38,880
and password and so

651
00:25:38,880 --> 00:25:40,720
if the server

652
00:25:40,720 --> 00:25:41,600
uh

653
00:25:41,600 --> 00:25:44,159
the server sent to the client uh the

654
00:25:44,159 --> 00:25:46,240
challenge and the client responded with

655
00:25:46,240 --> 00:25:47,679
a response and

656
00:25:47,679 --> 00:25:49,760
the server checks the response to make

657
00:25:49,760 --> 00:25:51,840
sure that the client really has the

658
00:25:51,840 --> 00:25:54,799
username and the password uh so what it

659
00:25:54,799 --> 00:25:56,640
means that the client

660
00:25:56,640 --> 00:25:58,240
is really

661
00:25:58,240 --> 00:26:01,279
with who it declares is

662
00:26:01,279 --> 00:26:04,080
uh and so this authentication

663
00:26:04,080 --> 00:26:05,919
mechanism

664
00:26:05,919 --> 00:26:09,039
is fairly simple it was quite easy

665
00:26:09,039 --> 00:26:11,039
to find it in the reverse engineering

666
00:26:11,039 --> 00:26:12,240
process

667
00:26:12,240 --> 00:26:15,200
and what i did is i went back to the

668
00:26:15,200 --> 00:26:17,600
manual to understand

669
00:26:17,600 --> 00:26:19,200
if you remember

670
00:26:19,200 --> 00:26:23,120
there is some kind of default account

671
00:26:23,120 --> 00:26:25,760
shipped with these devices so

672
00:26:25,760 --> 00:26:27,919
i really wanted to understand what what

673
00:26:27,919 --> 00:26:30,480
is the meaning of this device so i went

674
00:26:30,480 --> 00:26:32,880
back to the manual and i saw that in

675
00:26:32,880 --> 00:26:33,840
case

676
00:26:33,840 --> 00:26:34,880
that

677
00:26:34,880 --> 00:26:36,720
uh

678
00:26:36,720 --> 00:26:37,440
the

679
00:26:37,440 --> 00:26:39,520
the communication does not work you can

680
00:26:39,520 --> 00:26:42,320
always touch on use default

681
00:26:42,320 --> 00:26:43,200
on

682
00:26:43,200 --> 00:26:46,720
the the panel so what it means is that

683
00:26:46,720 --> 00:26:48,720
you can configure

684
00:26:48,720 --> 00:26:51,760
your own password and maybe change it

685
00:26:51,760 --> 00:26:52,640
but

686
00:26:52,640 --> 00:26:54,720
they are suggesting and they're

687
00:26:54,720 --> 00:26:56,559
recommending that if it doesn't work

688
00:26:56,559 --> 00:26:58,799
properly just use the default and in any

689
00:26:58,799 --> 00:27:00,720
case they're shipping all the devices

690
00:27:00,720 --> 00:27:03,039
with you default credentials

691
00:27:03,039 --> 00:27:06,159
so i thought myself how is it possible

692
00:27:06,159 --> 00:27:08,080
because each device should be uniquely

693
00:27:08,080 --> 00:27:10,159
identified in the zip network it can't

694
00:27:10,159 --> 00:27:11,679
be that they're shipping all the devices

695
00:27:11,679 --> 00:27:12,880
with the same

696
00:27:12,880 --> 00:27:16,720
credentials how does the server know uh

697
00:27:16,720 --> 00:27:18,559
and and i also ask myself how does this

698
00:27:18,559 --> 00:27:20,320
ever know that the password was reset if

699
00:27:20,320 --> 00:27:23,520
you're using uh use defaults then it

700
00:27:23,520 --> 00:27:26,159
needs somewhat somehow to transfer to

701
00:27:26,159 --> 00:27:28,480
the server that

702
00:27:28,480 --> 00:27:30,880
the credentials were

703
00:27:30,880 --> 00:27:33,360
back to default

704
00:27:33,360 --> 00:27:35,200
and so

705
00:27:35,200 --> 00:27:37,679
i quickly realized that something is

706
00:27:37,679 --> 00:27:40,000
wrong here this is uh

707
00:27:40,000 --> 00:27:43,760
this is a very bad design and probably

708
00:27:43,760 --> 00:27:46,960
it can be easily exploitable

709
00:27:46,960 --> 00:27:49,200
so what i tried to do

710
00:27:49,200 --> 00:27:52,080
is i tried to collect credentials uh

711
00:27:52,080 --> 00:27:54,799
from all these different images and all

712
00:27:54,799 --> 00:27:58,320
these uh kind of uh manuals that i saw

713
00:27:58,320 --> 00:28:01,360
so this was kind of the collection

714
00:28:01,360 --> 00:28:04,000
credentials ocean part and what i did i

715
00:28:04,000 --> 00:28:06,080
just went over different

716
00:28:06,080 --> 00:28:09,120
photos different pictures and

717
00:28:09,120 --> 00:28:11,440
i wanted to see both the username and

718
00:28:11,440 --> 00:28:14,080
the password that are configured in all

719
00:28:14,080 --> 00:28:16,640
of these devices so i could a good

720
00:28:16,640 --> 00:28:17,919
understanding of

721
00:28:17,919 --> 00:28:19,919
what are the authentication credentials

722
00:28:19,919 --> 00:28:22,320
for the zip networks for these devices

723
00:28:22,320 --> 00:28:24,320
so i really just went through all the

724
00:28:24,320 --> 00:28:25,520
youtube

725
00:28:25,520 --> 00:28:27,440
videos and all the photos that i

726
00:28:27,440 --> 00:28:29,919
collected all the manuals and i started

727
00:28:29,919 --> 00:28:31,120
to collect

728
00:28:31,120 --> 00:28:33,760
usernames and passwords and

729
00:28:33,760 --> 00:28:36,000
to try to understand what's going on how

730
00:28:36,000 --> 00:28:38,480
users how devices are shipped with

731
00:28:38,480 --> 00:28:41,440
default credentials so at this point of

732
00:28:41,440 --> 00:28:42,960
in time i had

733
00:28:42,960 --> 00:28:46,399
something like a 20 and 20 accounts 20

734
00:28:46,399 --> 00:28:48,320
usernames

735
00:28:48,320 --> 00:28:49,360
and

736
00:28:49,360 --> 00:28:51,840
i started to understand what's going on

737
00:28:51,840 --> 00:28:55,200
so the wi-fi monitor had

738
00:28:55,200 --> 00:28:58,000
uh so the wi-fi monitor and the mobile

739
00:28:58,000 --> 00:29:00,880
applications needs to to know each other

740
00:29:00,880 --> 00:29:02,960
so these are two clients in the zip

741
00:29:02,960 --> 00:29:04,880
network and they want to communicate

742
00:29:04,880 --> 00:29:06,880
with each other they want to signal uh

743
00:29:06,880 --> 00:29:08,799
to each other hey i want to make a call

744
00:29:08,799 --> 00:29:11,520
phone call with you so they they need to

745
00:29:11,520 --> 00:29:14,559
know what is the username of the other

746
00:29:14,559 --> 00:29:16,240
party

747
00:29:16,240 --> 00:29:19,039
and i collected enough username and

748
00:29:19,039 --> 00:29:20,559
passwords to understand there is a

749
00:29:20,559 --> 00:29:23,760
pattern so the wi-fi monitor always

750
00:29:23,760 --> 00:29:27,520
started with zero four zero zero one and

751
00:29:27,520 --> 00:29:28,399
then

752
00:29:28,399 --> 00:29:31,360
some kind of uh random hexadecim decimal

753
00:29:31,360 --> 00:29:33,840
digit abcdefg

754
00:29:33,840 --> 00:29:37,120
and the mobile phone the the mobile app

755
00:29:37,120 --> 00:29:38,000
had

756
00:29:38,000 --> 00:29:40,480
kind of the same pattern

757
00:29:40,480 --> 00:29:44,240
but it started with 0e so

758
00:29:44,240 --> 00:29:45,279
if

759
00:29:45,279 --> 00:29:47,840
the phone the mobile app and the wi-fi

760
00:29:47,840 --> 00:29:50,080
monitor were

761
00:29:50,080 --> 00:29:54,080
connected they had the same username

762
00:29:54,080 --> 00:29:57,120
except the wi-fi monitor had four here

763
00:29:57,120 --> 00:29:58,720
on the second byte

764
00:29:58,720 --> 00:30:01,120
on the second nibble and the mobile app

765
00:30:01,120 --> 00:30:03,919
had e on the second label so

766
00:30:03,919 --> 00:30:05,600
they didn't really need to know each

767
00:30:05,600 --> 00:30:08,960
other they just needed to know their own

768
00:30:08,960 --> 00:30:11,919
username and the other party will have

769
00:30:11,919 --> 00:30:14,000
four or e depending if it's a wi-fi

770
00:30:14,000 --> 00:30:16,399
monitor or the mobile app so how it

771
00:30:16,399 --> 00:30:19,600
looks like in a visualized sip network

772
00:30:19,600 --> 00:30:21,200
this is how it visualized so we have the

773
00:30:21,200 --> 00:30:24,480
wi-fi net monitor which is a valid zip

774
00:30:24,480 --> 00:30:26,720
client and we have the mobile app which

775
00:30:26,720 --> 00:30:29,840
is a valid zip client as well and they

776
00:30:29,840 --> 00:30:31,760
know each other because they're sharing

777
00:30:31,760 --> 00:30:33,840
the same kind of the same username

778
00:30:33,840 --> 00:30:36,159
except for the second nibble

779
00:30:36,159 --> 00:30:36,960
and

780
00:30:36,960 --> 00:30:39,279
i really wanted to understand

781
00:30:39,279 --> 00:30:41,360
where this username comes from because

782
00:30:41,360 --> 00:30:44,080
obviously if this is the mechanism all

783
00:30:44,080 --> 00:30:45,840
the different devices

784
00:30:45,840 --> 00:30:48,240
would need to be shipped with different

785
00:30:48,240 --> 00:30:50,880
usernames otherwise it will be a mess

786
00:30:50,880 --> 00:30:52,960
but we do know that this system is

787
00:30:52,960 --> 00:30:55,039
working so different devices has

788
00:30:55,039 --> 00:30:57,360
different usernames but since it's

789
00:30:57,360 --> 00:30:59,519
pre-configured on the devices when

790
00:30:59,519 --> 00:31:01,519
they're shipped there must be some kind

791
00:31:01,519 --> 00:31:03,600
of a unique a

792
00:31:03,600 --> 00:31:04,640
method

793
00:31:04,640 --> 00:31:06,880
to obtain this username which will be

794
00:31:06,880 --> 00:31:09,440
shared among the mobile app and the

795
00:31:09,440 --> 00:31:11,679
wi-fi monitor the gateway

796
00:31:11,679 --> 00:31:14,000
so obviously i turned to

797
00:31:14,000 --> 00:31:16,799
reverse engineering again to see how the

798
00:31:16,799 --> 00:31:19,600
username is being derived

799
00:31:19,600 --> 00:31:22,080
and i quickly realized that the username

800
00:31:22,080 --> 00:31:25,039
is derived from a unique chip

801
00:31:25,039 --> 00:31:28,320
that is shipped on these devices so

802
00:31:28,320 --> 00:31:30,559
obviously the username cannot be derived

803
00:31:30,559 --> 00:31:31,919
just from the firmware because the

804
00:31:31,919 --> 00:31:33,760
firmware is the same for

805
00:31:33,760 --> 00:31:36,080
for all the devices it needs to be a

806
00:31:36,080 --> 00:31:38,000
hardware uh

807
00:31:38,000 --> 00:31:41,120
unique identification and so it happens

808
00:31:41,120 --> 00:31:44,559
there is this chip ds2411

809
00:31:44,559 --> 00:31:46,640
uh which

810
00:31:46,640 --> 00:31:47,840
uh

811
00:31:47,840 --> 00:31:50,159
which has a very nice

812
00:31:50,159 --> 00:31:53,440
uh capability or functionality that it

813
00:31:53,440 --> 00:31:57,039
stores a unique 48-bit serial number so

814
00:31:57,039 --> 00:31:59,200
it's very similar to a mac

815
00:31:59,200 --> 00:32:00,399
every

816
00:32:00,399 --> 00:32:01,440
every

817
00:32:01,440 --> 00:32:03,919
nic network interface card has a unique

818
00:32:03,919 --> 00:32:05,039
mac

819
00:32:05,039 --> 00:32:07,200
and this is because there is a chip

820
00:32:07,200 --> 00:32:10,799
there that has a unique identification

821
00:32:10,799 --> 00:32:13,919
that the the firmware can read the id

822
00:32:13,919 --> 00:32:17,360
from and to use it as a unique mac in

823
00:32:17,360 --> 00:32:20,080
the network so it it really is the same

824
00:32:20,080 --> 00:32:22,799
so this chip holds a unique 48-bit

825
00:32:22,799 --> 00:32:24,399
serial number

826
00:32:24,399 --> 00:32:25,440
and

827
00:32:25,440 --> 00:32:28,080
because this is a unique serial number

828
00:32:28,080 --> 00:32:30,080
the company thought it will be a good

829
00:32:30,080 --> 00:32:32,640
candidate to be a username in the zip

830
00:32:32,640 --> 00:32:34,399
network and so

831
00:32:34,399 --> 00:32:37,360
what happens is that the gateway the

832
00:32:37,360 --> 00:32:39,840
wi-fi monitor

833
00:32:39,840 --> 00:32:41,600
is reading this

834
00:32:41,600 --> 00:32:44,240
serial number from the chip and uses

835
00:32:44,240 --> 00:32:45,039
this

836
00:32:45,039 --> 00:32:48,000
as a unique username that will be shared

837
00:32:48,000 --> 00:32:48,960
among

838
00:32:48,960 --> 00:32:51,679
both the wi-fi gateway and

839
00:32:51,679 --> 00:32:52,720
the

840
00:32:52,720 --> 00:32:54,799
the mobile the mobile app and the wi-fi

841
00:32:54,799 --> 00:32:57,840
gateway so this is how we obtained the

842
00:32:57,840 --> 00:33:01,840
username through this chip ds2411

843
00:33:01,840 --> 00:33:04,720
now the question remains

844
00:33:04,720 --> 00:33:06,880
where the password comes from

845
00:33:06,880 --> 00:33:08,480
so obviously

846
00:33:08,480 --> 00:33:09,600
i

847
00:33:09,600 --> 00:33:10,960
started

848
00:33:10,960 --> 00:33:12,960
to think how can they derive the

849
00:33:12,960 --> 00:33:14,799
password because obviously it would be

850
00:33:14,799 --> 00:33:16,880
it would need to be derived from the

851
00:33:16,880 --> 00:33:20,080
username somehow with a fixed algorithm

852
00:33:20,080 --> 00:33:23,279
and turned out that i was right so

853
00:33:23,279 --> 00:33:26,000
since the username is being read from

854
00:33:26,000 --> 00:33:27,760
this chip

855
00:33:27,760 --> 00:33:30,000
the password is

856
00:33:30,000 --> 00:33:31,360
using this

857
00:33:31,360 --> 00:33:32,320
as a

858
00:33:32,320 --> 00:33:34,080
the username as a sid

859
00:33:34,080 --> 00:33:36,399
to a fixed simple algorithm to generate

860
00:33:36,399 --> 00:33:39,440
the password and so

861
00:33:39,440 --> 00:33:42,000
the fixed simple algorithm is very

862
00:33:42,000 --> 00:33:42,960
simple

863
00:33:42,960 --> 00:33:45,279
actually it's md5 the last it's a

864
00:33:45,279 --> 00:33:47,760
manipulation of the last two digits of

865
00:33:47,760 --> 00:33:50,320
the md5 and that's how they're creating

866
00:33:50,320 --> 00:33:52,080
their password

867
00:33:52,080 --> 00:33:53,039
yeah

868
00:33:53,039 --> 00:33:54,799
not good so

869
00:33:54,799 --> 00:33:56,640
let's do a quick recap of what's going

870
00:33:56,640 --> 00:33:58,240
on here

871
00:33:58,240 --> 00:33:59,200
we have

872
00:33:59,200 --> 00:34:01,760
the vt company that implemented

873
00:34:01,760 --> 00:34:04,480
two zip accounts one for the wi-fi

874
00:34:04,480 --> 00:34:06,960
module at your home and one for the

875
00:34:06,960 --> 00:34:08,639
mobile app

876
00:34:08,639 --> 00:34:11,599
and these two zip accounts are derived

877
00:34:11,599 --> 00:34:14,719
from the same unique serial that is

878
00:34:14,719 --> 00:34:16,760
being read from the

879
00:34:16,760 --> 00:34:21,199
ds2411 chip on the dx home panel

880
00:34:21,199 --> 00:34:24,960
and these do these usernames are sharing

881
00:34:24,960 --> 00:34:28,000
the same data except the home panel

882
00:34:28,000 --> 00:34:30,719
monitor account starts with zero four

883
00:34:30,719 --> 00:34:33,280
and the derived account the averted

884
00:34:33,280 --> 00:34:34,399
account

885
00:34:34,399 --> 00:34:36,960
for the mobile app is starting with zero

886
00:34:36,960 --> 00:34:38,079
e

887
00:34:38,079 --> 00:34:38,879
and

888
00:34:38,879 --> 00:34:42,960
the password for those accounts are just

889
00:34:42,960 --> 00:34:46,079
the last two bytes of

890
00:34:46,079 --> 00:34:49,520
the md5 of this username so it's very

891
00:34:49,520 --> 00:34:52,399
easy to generate passwords and on the

892
00:34:52,399 --> 00:34:54,879
screen schematics here you can see the

893
00:34:54,879 --> 00:34:56,000
intercom

894
00:34:56,000 --> 00:34:56,879
is

895
00:34:56,879 --> 00:35:00,720
uh is ringing to the wi-fi monitor which

896
00:35:00,720 --> 00:35:04,400
has the o zero account o zero username

897
00:35:04,400 --> 00:35:06,960
and when no one answers it will divert

898
00:35:06,960 --> 00:35:09,119
the account endeavor the call through

899
00:35:09,119 --> 00:35:12,079
the cloud service to the xero e account

900
00:35:12,079 --> 00:35:14,720
on your mobile phone and that's why we

901
00:35:14,720 --> 00:35:17,359
saw that all the phone calls that we

902
00:35:17,359 --> 00:35:20,320
received when we did the the testing was

903
00:35:20,320 --> 00:35:23,520
from zero four because what actually

904
00:35:23,520 --> 00:35:24,640
rings

905
00:35:24,640 --> 00:35:27,520
what actually calls the mobile app is

906
00:35:27,520 --> 00:35:30,560
the wi-fi monitor which has the zero

907
00:35:30,560 --> 00:35:32,960
four and it represents the

908
00:35:32,960 --> 00:35:34,400
intercom

909
00:35:34,400 --> 00:35:35,440
so

910
00:35:35,440 --> 00:35:39,680
at this point uh i i thought about

911
00:35:39,680 --> 00:35:43,440
how easy it is to obtain usernames and

912
00:35:43,440 --> 00:35:46,240
to derive their passwords because all of

913
00:35:46,240 --> 00:35:48,400
these devices are using kind of uh

914
00:35:48,400 --> 00:35:51,040
default credentials and and

915
00:35:51,040 --> 00:35:52,480
i

916
00:35:52,480 --> 00:35:54,720
i kind of find you based on my

917
00:35:54,720 --> 00:35:56,160
experience with this device that

918
00:35:56,160 --> 00:35:58,880
changing the password uh changing the

919
00:35:58,880 --> 00:36:00,560
username is not possible and changing

920
00:36:00,560 --> 00:36:03,359
the password is very difficult and the

921
00:36:03,359 --> 00:36:05,280
company even recommends in their manual

922
00:36:05,280 --> 00:36:06,960
to restore the default if it doesn't

923
00:36:06,960 --> 00:36:08,880
work

924
00:36:08,880 --> 00:36:09,680
so

925
00:36:09,680 --> 00:36:12,800
i thought maybe we can

926
00:36:12,800 --> 00:36:15,040
be imposter maybe we can

927
00:36:15,040 --> 00:36:17,280
uh try to

928
00:36:17,280 --> 00:36:18,800
uh

929
00:36:18,800 --> 00:36:21,280
to mask ourselves as a different account

930
00:36:21,280 --> 00:36:23,599
so what i did i did something very very

931
00:36:23,599 --> 00:36:25,520
simple i i knew how the password is

932
00:36:25,520 --> 00:36:27,040
being derived

933
00:36:27,040 --> 00:36:29,200
and i had lots of different accounts so

934
00:36:29,200 --> 00:36:31,440
all i did is open the mobile app changed

935
00:36:31,440 --> 00:36:32,880
the settings the username and the

936
00:36:32,880 --> 00:36:35,200
password to a random account that i

937
00:36:35,200 --> 00:36:37,920
found and i generated the password too

938
00:36:37,920 --> 00:36:41,839
and i just entered the surveillance mode

939
00:36:41,839 --> 00:36:45,920
and when i did this i saw suddenly uh

940
00:36:45,920 --> 00:36:49,119
the arm entrance of some

941
00:36:49,119 --> 00:36:51,920
random home somewhere in the world so

942
00:36:51,920 --> 00:36:55,040
it was it was very funny uh experience

943
00:36:55,040 --> 00:36:58,160
to open a camera in someone's uh home

944
00:36:58,160 --> 00:36:59,040
house

945
00:36:59,040 --> 00:37:02,960
uh and it was very scary too uh so what

946
00:37:02,960 --> 00:37:04,240
i did

947
00:37:04,240 --> 00:37:06,160
instead of living this

948
00:37:06,160 --> 00:37:09,440
uh aside i decided to write my own code

949
00:37:09,440 --> 00:37:12,320
to generate qr codes because it will it

950
00:37:12,320 --> 00:37:14,560
will be easier to scan qr codes and

951
00:37:14,560 --> 00:37:16,160
enter all the

952
00:37:16,160 --> 00:37:17,599
all the different

953
00:37:17,599 --> 00:37:19,119
accounts

954
00:37:19,119 --> 00:37:20,720
and and

955
00:37:20,720 --> 00:37:22,880
i started to see what accounts are

956
00:37:22,880 --> 00:37:24,640
really working so i

957
00:37:24,640 --> 00:37:26,320
basically what i did is i used the

958
00:37:26,320 --> 00:37:27,599
mobile app

959
00:37:27,599 --> 00:37:30,560
with the qr generator that i built

960
00:37:30,560 --> 00:37:31,359
to

961
00:37:31,359 --> 00:37:34,240
uh enter surveillance mode of different

962
00:37:34,240 --> 00:37:36,640
accounts around the world

963
00:37:36,640 --> 00:37:37,520
now

964
00:37:37,520 --> 00:37:40,320
this was a manual process and

965
00:37:40,320 --> 00:37:41,599
i'm a

966
00:37:41,599 --> 00:37:43,680
kind of automation guy

967
00:37:43,680 --> 00:37:45,920
so what i decided is to understand the

968
00:37:45,920 --> 00:37:48,880
entire mechanism of how the diverted

969
00:37:48,880 --> 00:37:50,400
call is transferred through the cloud

970
00:37:50,400 --> 00:37:53,359
service back to them

971
00:37:53,359 --> 00:37:55,920
back to the mobile app and to do that i

972
00:37:55,920 --> 00:37:57,599
really needed to understand all the

973
00:37:57,599 --> 00:38:00,880
cloud management protocols

974
00:38:00,880 --> 00:38:01,599
so

975
00:38:01,599 --> 00:38:04,480
there are three particles that the

976
00:38:04,480 --> 00:38:06,720
vtec implemented as part of their cloud

977
00:38:06,720 --> 00:38:09,440
service the first one is for user

978
00:38:09,440 --> 00:38:11,920
management protocol which runs over tcp

979
00:38:11,920 --> 00:38:13,839
port 8848

980
00:38:13,839 --> 00:38:15,920
and this protocol is used for

981
00:38:15,920 --> 00:38:17,680
registering accounts so when you're

982
00:38:17,680 --> 00:38:21,040
buying a new device it needs to register

983
00:38:21,040 --> 00:38:23,359
itself on the sip network so it uses

984
00:38:23,359 --> 00:38:24,240
this

985
00:38:24,240 --> 00:38:26,560
account this protocol to register the

986
00:38:26,560 --> 00:38:29,839
account and it has three function codes

987
00:38:29,839 --> 00:38:31,680
so we have function called one for

988
00:38:31,680 --> 00:38:34,720
registering account 3 for changing

989
00:38:34,720 --> 00:38:36,880
password and 5

990
00:38:36,880 --> 00:38:38,800
to reset password to

991
00:38:38,800 --> 00:38:40,880
default so

992
00:38:40,880 --> 00:38:43,280
at this time i understood how can the

993
00:38:43,280 --> 00:38:46,480
panel click on reset to default and it

994
00:38:46,480 --> 00:38:48,880
will just work because what it ha what

995
00:38:48,880 --> 00:38:51,520
it does is just issuing this function

996
00:38:51,520 --> 00:38:54,800
called five request over tcp port 8848

997
00:38:54,800 --> 00:38:56,240
and it will reset the password on the

998
00:38:56,240 --> 00:38:57,680
server too

999
00:38:57,680 --> 00:38:58,839
so

1000
00:38:58,839 --> 00:39:01,280
uh this was the first protocol i

1001
00:39:01,280 --> 00:39:03,920
researched the second one was the update

1002
00:39:03,920 --> 00:39:05,680
protocol which

1003
00:39:05,680 --> 00:39:07,440
was not very interesting for me at the

1004
00:39:07,440 --> 00:39:10,160
time just for checking updates

1005
00:39:10,160 --> 00:39:12,079
and the last protocol is the user

1006
00:39:12,079 --> 00:39:14,720
interaction which is used

1007
00:39:14,720 --> 00:39:17,920
to perform the login to the cloud so

1008
00:39:17,920 --> 00:39:19,760
every time

1009
00:39:19,760 --> 00:39:21,200
every time

1010
00:39:21,200 --> 00:39:23,440
you want to start a call you would need

1011
00:39:23,440 --> 00:39:26,560
to log in to the cloud and you could

1012
00:39:26,560 --> 00:39:29,200
interact with the cloud by sending uh

1013
00:39:29,200 --> 00:39:32,800
some special dtmf codes and reading jpeg

1014
00:39:32,800 --> 00:39:36,640
data through function codes 16 and 34.

1015
00:39:36,640 --> 00:39:39,200
so i reversed engineer these protocols

1016
00:39:39,200 --> 00:39:41,280
and i did some blind protocol analysis

1017
00:39:41,280 --> 00:39:42,720
to understand how they're working and i

1018
00:39:42,720 --> 00:39:46,800
wrote my own clients in python

1019
00:39:46,800 --> 00:39:47,839
and then

1020
00:39:47,839 --> 00:39:50,960
what i did is i started to pwn and

1021
00:39:50,960 --> 00:39:54,640
intercom at scale so what i wanted to do

1022
00:39:54,640 --> 00:39:58,160
is i wanted to have the capabilities of

1023
00:39:58,160 --> 00:39:59,280
opening

1024
00:39:59,280 --> 00:40:02,079
cameras streams of different intercoms

1025
00:40:02,079 --> 00:40:03,280
around the world

1026
00:40:03,280 --> 00:40:04,400
i wanted

1027
00:40:04,400 --> 00:40:06,160
to have the functionality of

1028
00:40:06,160 --> 00:40:08,400
transmitting audio and i wanted to have

1029
00:40:08,400 --> 00:40:10,480
the functionality of unlocking the doors

1030
00:40:10,480 --> 00:40:12,400
because these intercoms are not just for

1031
00:40:12,400 --> 00:40:15,119
voice communication they're also

1032
00:40:15,119 --> 00:40:16,079
used

1033
00:40:16,079 --> 00:40:17,839
for door control

1034
00:40:17,839 --> 00:40:20,880
so i wanted these three capabilities in

1035
00:40:20,880 --> 00:40:22,880
my own client

1036
00:40:22,880 --> 00:40:24,480
and i wanted to do this

1037
00:40:24,480 --> 00:40:27,040
on any intercom i choose

1038
00:40:27,040 --> 00:40:30,319
so the first thing i did was finding

1039
00:40:30,319 --> 00:40:32,960
users and it was quite easy because i

1040
00:40:32,960 --> 00:40:33,920
knew

1041
00:40:33,920 --> 00:40:37,119
the first three bytes were zero four

1042
00:40:37,119 --> 00:40:40,079
zero zero and then one so all i needed

1043
00:40:40,079 --> 00:40:42,160
to guess is this nibble

1044
00:40:42,160 --> 00:40:44,000
uh the

1045
00:40:44,000 --> 00:40:46,960
the sixth nibble and three more bytes

1046
00:40:46,960 --> 00:40:49,440
and it was very easy to to write a quick

1047
00:40:49,440 --> 00:40:50,720
brute force

1048
00:40:50,720 --> 00:40:51,440
uh

1049
00:40:51,440 --> 00:40:52,400
software

1050
00:40:52,400 --> 00:40:54,960
that will just try to log in to

1051
00:40:54,960 --> 00:40:58,640
different sip accounts in the vtexcip

1052
00:40:58,640 --> 00:40:59,680
network

1053
00:40:59,680 --> 00:41:01,680
and i started to

1054
00:41:01,680 --> 00:41:04,880
to log to audit many valid accounts on

1055
00:41:04,880 --> 00:41:07,280
the network and i saved these accounts

1056
00:41:07,280 --> 00:41:08,319
because

1057
00:41:08,319 --> 00:41:10,640
i just brute forced the username and i

1058
00:41:10,640 --> 00:41:14,800
derived the password from the username

1059
00:41:14,800 --> 00:41:17,680
now i had lots of accounts and i wanted

1060
00:41:17,680 --> 00:41:19,119
to automate

1061
00:41:19,119 --> 00:41:22,319
and i i started to check these accounts

1062
00:41:22,319 --> 00:41:24,880
if they're working and all the accounts

1063
00:41:24,880 --> 00:41:27,040
really worked so there was an intercom

1064
00:41:27,040 --> 00:41:28,560
that i could open

1065
00:41:28,560 --> 00:41:31,040
this the video stream to

1066
00:41:31,040 --> 00:41:33,680
but what i wanted is to see if i can do

1067
00:41:33,680 --> 00:41:35,520
this it's skill so

1068
00:41:35,520 --> 00:41:38,560
i didn't want to take valid accounts

1069
00:41:38,560 --> 00:41:40,480
generated the qr code

1070
00:41:40,480 --> 00:41:42,800
enter it to the mobile app and then see

1071
00:41:42,800 --> 00:41:45,359
if it's working i wanted to scan the

1072
00:41:45,359 --> 00:41:48,400
entire intercom the entire network

1073
00:41:48,400 --> 00:41:51,599
and receive video streams of all these

1074
00:41:51,599 --> 00:41:54,640
intercoms so i asked myself

1075
00:41:54,640 --> 00:41:57,280
can i fully automate this the entire

1076
00:41:57,280 --> 00:41:58,800
process

1077
00:41:58,800 --> 00:41:59,760
and

1078
00:41:59,760 --> 00:42:01,920
to do that i needed to understand how

1079
00:42:01,920 --> 00:42:04,720
data is transferred so how media audio

1080
00:42:04,720 --> 00:42:07,359
and video is transferred on

1081
00:42:07,359 --> 00:42:10,079
on these calls so i need to understand

1082
00:42:10,079 --> 00:42:12,560
the multimedia protocol stack how it's

1083
00:42:12,560 --> 00:42:14,720
working so i need to understand how the

1084
00:42:14,720 --> 00:42:17,119
signaling is working using the sip

1085
00:42:17,119 --> 00:42:20,720
protocol how metadata of what ports are

1086
00:42:20,720 --> 00:42:23,359
are being listened for audient video

1087
00:42:23,359 --> 00:42:25,359
i needed to understand how the quality

1088
00:42:25,359 --> 00:42:27,200
of service protocols

1089
00:42:27,200 --> 00:42:29,599
are working and the media itself which

1090
00:42:29,599 --> 00:42:32,400
is the audio and video and how to decode

1091
00:42:32,400 --> 00:42:33,280
them

1092
00:42:33,280 --> 00:42:36,000
so obviously i started with the sip the

1093
00:42:36,000 --> 00:42:39,280
signaling and this protocol

1094
00:42:39,280 --> 00:42:41,520
we've talked about this before it's on

1095
00:42:41,520 --> 00:42:43,040
udp

1096
00:42:43,040 --> 00:42:45,920
5060 and it's a fairly similar protocol

1097
00:42:45,920 --> 00:42:49,599
textual based uh like http and what it

1098
00:42:49,599 --> 00:42:52,400
does uh is signaling so

1099
00:42:52,400 --> 00:42:53,359
it

1100
00:42:53,359 --> 00:42:56,400
us it tells its ring it tells the other

1101
00:42:56,400 --> 00:42:58,640
party that we want to start communicate

1102
00:42:58,640 --> 00:43:01,200
so what happens is when you open the

1103
00:43:01,200 --> 00:43:03,760
surveillance mode what will happen is

1104
00:43:03,760 --> 00:43:05,920
the mobile app which is

1105
00:43:05,920 --> 00:43:08,640
authenticated inside the zip network

1106
00:43:08,640 --> 00:43:11,040
will send the signaling request the

1107
00:43:11,040 --> 00:43:12,400
invite request

1108
00:43:12,400 --> 00:43:14,480
to the wi-fi monitor which is also

1109
00:43:14,480 --> 00:43:17,440
connected to the sip network and will uh

1110
00:43:17,440 --> 00:43:20,079
basically say that it wants to start a

1111
00:43:20,079 --> 00:43:21,839
session

1112
00:43:21,839 --> 00:43:23,040
now

1113
00:43:23,040 --> 00:43:24,240
it's not just

1114
00:43:24,240 --> 00:43:26,160
open a session they want to transfer

1115
00:43:26,160 --> 00:43:28,000
audio and video so

1116
00:43:28,000 --> 00:43:29,760
for that

1117
00:43:29,760 --> 00:43:33,680
uh we need to transfer some data one of

1118
00:43:33,680 --> 00:43:36,240
one of the capabilities of zip is

1119
00:43:36,240 --> 00:43:39,040
transferring dtmf signaling so we can

1120
00:43:39,040 --> 00:43:40,960
actually transfer

1121
00:43:40,960 --> 00:43:41,839
uh

1122
00:43:41,839 --> 00:43:45,200
data over sip so

1123
00:43:45,200 --> 00:43:47,839
uh intercoms when you're pressing the

1124
00:43:47,839 --> 00:43:49,920
keypad and the key is correct the door

1125
00:43:49,920 --> 00:43:51,920
will open so

1126
00:43:51,920 --> 00:43:54,560
if we want to open the door remotely we

1127
00:43:54,560 --> 00:43:57,440
can signal the special codes over the

1128
00:43:57,440 --> 00:43:59,839
sip network so for example if we want to

1129
00:43:59,839 --> 00:44:03,520
start the zip call and open the camera

1130
00:44:03,520 --> 00:44:06,400
we would need to send through sip the

1131
00:44:06,400 --> 00:44:09,119
correct monitor code that will open the

1132
00:44:09,119 --> 00:44:12,960
camera and start uh streaming video so

1133
00:44:12,960 --> 00:44:15,599
how we will do this is we will use sip

1134
00:44:15,599 --> 00:44:19,440
and we will signal the different uh the

1135
00:44:19,440 --> 00:44:22,079
different numbers or letters so in this

1136
00:44:22,079 --> 00:44:24,480
case we're signaling 1

1137
00:44:24,480 --> 00:44:27,680
0 0 0 hash

1138
00:44:27,680 --> 00:44:29,440
and it will

1139
00:44:29,440 --> 00:44:31,119
it will reach the

1140
00:44:31,119 --> 00:44:34,000
wi-fi module and the wi-fi module will

1141
00:44:34,000 --> 00:44:36,480
convert it to dtmf signals

1142
00:44:36,480 --> 00:44:38,160
through the two-wire system to the

1143
00:44:38,160 --> 00:44:41,440
intercom so that's how we will open the

1144
00:44:41,440 --> 00:44:44,400
camera on the the

1145
00:44:44,400 --> 00:44:46,560
intercom itself

1146
00:44:46,560 --> 00:44:49,520
so again sip is used to signal and to

1147
00:44:49,520 --> 00:44:52,640
send dtmf codes to the intercom to start

1148
00:44:52,640 --> 00:44:54,480
some kind of functionality on the

1149
00:44:54,480 --> 00:44:57,119
outdoor the intercom itself

1150
00:44:57,119 --> 00:44:59,280
the next protocol i need to understand

1151
00:44:59,280 --> 00:45:02,000
was sdp which is session description

1152
00:45:02,000 --> 00:45:05,520
protocol and this protocol uh actually

1153
00:45:05,520 --> 00:45:08,160
coordinate the ports that the data will

1154
00:45:08,160 --> 00:45:10,319
be transferred on so you can see here

1155
00:45:10,319 --> 00:45:12,160
that sdp com

1156
00:45:12,160 --> 00:45:14,800
coordinates the audio ports and the

1157
00:45:14,800 --> 00:45:17,359
video ports that will be

1158
00:45:17,359 --> 00:45:20,319
audio and video data will be

1159
00:45:20,319 --> 00:45:23,040
transferred through

1160
00:45:23,040 --> 00:45:24,800
the next protocol is a real-time

1161
00:45:24,800 --> 00:45:27,680
transport control protocol which

1162
00:45:27,680 --> 00:45:30,640
transfers information out of the band

1163
00:45:30,640 --> 00:45:32,240
out of banned information about

1164
00:45:32,240 --> 00:45:34,640
statistics and the control information

1165
00:45:34,640 --> 00:45:38,640
for the rtp session and rtp session is

1166
00:45:38,640 --> 00:45:40,640
real-time trust fund protocol which

1167
00:45:40,640 --> 00:45:42,079
transfers

1168
00:45:42,079 --> 00:45:45,040
audio and video data so this is where

1169
00:45:45,040 --> 00:45:47,440
the the real data is being transferred

1170
00:45:47,440 --> 00:45:50,319
from the mobile app to the wi-fi module

1171
00:45:50,319 --> 00:45:52,960
that are both connected through the zip

1172
00:45:52,960 --> 00:45:54,160
network

1173
00:45:54,160 --> 00:45:55,200
so

1174
00:45:55,200 --> 00:45:57,119
let's see an example this is a pickup i

1175
00:45:57,119 --> 00:46:01,839
recorded uh when i did all my uh my

1176
00:46:01,839 --> 00:46:05,040
trial and errors uh so the first part is

1177
00:46:05,040 --> 00:46:07,839
using sip to set up a call the next part

1178
00:46:07,839 --> 00:46:10,960
is sip answering a call

1179
00:46:10,960 --> 00:46:12,720
and after that

1180
00:46:12,720 --> 00:46:15,599
information about ports what what are

1181
00:46:15,599 --> 00:46:18,079
the audio ports and the video ports

1182
00:46:18,079 --> 00:46:19,760
uh um

1183
00:46:19,760 --> 00:46:22,560
are being shared and then we have the

1184
00:46:22,560 --> 00:46:25,119
video which starts with a blue screen

1185
00:46:25,119 --> 00:46:26,319
because

1186
00:46:26,319 --> 00:46:28,880
it only opens uh

1187
00:46:28,880 --> 00:46:31,520
the the wi-fi monitor

1188
00:46:31,520 --> 00:46:34,960
only opens uh the the video stream but

1189
00:46:34,960 --> 00:46:37,119
it's not the the real stream from the

1190
00:46:37,119 --> 00:46:39,839
intercom because we did not signal the

1191
00:46:39,839 --> 00:46:41,839
intercom to open the camera yet so at

1192
00:46:41,839 --> 00:46:44,240
the first we have just blue screen and

1193
00:46:44,240 --> 00:46:46,240
only after signaling

1194
00:46:46,240 --> 00:46:49,359
the the correct code the monitor code

1195
00:46:49,359 --> 00:46:52,240
through the same protocol only then

1196
00:46:52,240 --> 00:46:54,000
the the

1197
00:46:54,000 --> 00:46:55,760
video stream the real video stream of

1198
00:46:55,760 --> 00:46:57,680
from the intercom will be transferred

1199
00:46:57,680 --> 00:46:59,599
with real image

1200
00:46:59,599 --> 00:47:01,839
so at this point in time we only have

1201
00:47:01,839 --> 00:47:03,920
blue screen because we did not signal

1202
00:47:03,920 --> 00:47:06,400
the intercom to open the camera at and

1203
00:47:06,400 --> 00:47:08,640
after that we have the authentication so

1204
00:47:08,640 --> 00:47:10,240
we're sending the authentication

1205
00:47:10,240 --> 00:47:11,760
function code

1206
00:47:11,760 --> 00:47:12,560
uh

1207
00:47:12,560 --> 00:47:15,440
to to the server and only then we have a

1208
00:47:15,440 --> 00:47:17,920
live video because only then we can

1209
00:47:17,920 --> 00:47:21,280
really communicate with the device and

1210
00:47:21,280 --> 00:47:24,079
everything is authenticated

1211
00:47:24,079 --> 00:47:25,760
let's see how it's working in this

1212
00:47:25,760 --> 00:47:27,520
diagram that i've prepared so at first

1213
00:47:27,520 --> 00:47:30,480
we have uh the sip

1214
00:47:30,480 --> 00:47:32,800
register account so we need to log in

1215
00:47:32,800 --> 00:47:35,599
into the network the sip network as a

1216
00:47:35,599 --> 00:47:38,720
mobile app as in poster in the mobile in

1217
00:47:38,720 --> 00:47:40,400
in the zip network

1218
00:47:40,400 --> 00:47:43,760
the vtec gateway or the cloud server and

1219
00:47:43,760 --> 00:47:46,319
server is okay and then we want to

1220
00:47:46,319 --> 00:47:48,400
signal the other party that we want to

1221
00:47:48,400 --> 00:47:50,079
start communicating with so we're

1222
00:47:50,079 --> 00:47:53,359
sending a sip invite request

1223
00:47:53,359 --> 00:47:56,720
and it reaches the home unit so the the

1224
00:47:56,720 --> 00:47:59,119
sip invite reaches the home unit which

1225
00:47:59,119 --> 00:48:01,119
responds with ok

1226
00:48:01,119 --> 00:48:04,559
then we're authenticating through tcp

1227
00:48:04,559 --> 00:48:06,480
8850

1228
00:48:06,480 --> 00:48:09,280
to the cloud which means we are

1229
00:48:09,280 --> 00:48:12,400
uh a valid account in the network and

1230
00:48:12,400 --> 00:48:13,520
the cloud

1231
00:48:13,520 --> 00:48:15,599
uh confirms so

1232
00:48:15,599 --> 00:48:16,800
it's okay

1233
00:48:16,800 --> 00:48:19,680
and then we're signaling the dtmf codes

1234
00:48:19,680 --> 00:48:23,200
to open the camera on the intercom unit

1235
00:48:23,200 --> 00:48:24,880
and only then we're starting to receive

1236
00:48:24,880 --> 00:48:28,960
rtp data which is video and audio so

1237
00:48:28,960 --> 00:48:30,880
i've repaired here

1238
00:48:30,880 --> 00:48:31,920
this is

1239
00:48:31,920 --> 00:48:34,000
my automation that does all of this so

1240
00:48:34,000 --> 00:48:35,839
first we're finding a username a valid

1241
00:48:35,839 --> 00:48:37,040
username

1242
00:48:37,040 --> 00:48:38,720
and we're registering into the zip

1243
00:48:38,720 --> 00:48:42,240
network starting rtp server on our side

1244
00:48:42,240 --> 00:48:44,480
because this is our automation that

1245
00:48:44,480 --> 00:48:46,880
mimics the entire process

1246
00:48:46,880 --> 00:48:48,559
uh

1247
00:48:48,559 --> 00:48:50,240
and then we're

1248
00:48:50,240 --> 00:48:52,800
establishing a call

1249
00:48:52,800 --> 00:48:55,040
sending a sip invite

1250
00:48:55,040 --> 00:48:57,839
coordinating ports and codecs for the

1251
00:48:57,839 --> 00:49:01,040
audio and video and starting rtrtp data

1252
00:49:01,040 --> 00:49:04,880
transfer so what happens so far is we

1253
00:49:04,880 --> 00:49:08,079
pressed the surveillance mode

1254
00:49:08,079 --> 00:49:11,040
and now we have a blue screen

1255
00:49:11,040 --> 00:49:13,200
at this time because we did not

1256
00:49:13,200 --> 00:49:17,599
send any dtmf signals to the ho to the

1257
00:49:17,599 --> 00:49:19,680
intercom so currently

1258
00:49:19,680 --> 00:49:20,559
uh

1259
00:49:20,559 --> 00:49:23,599
there is no real image to send

1260
00:49:23,599 --> 00:49:24,720
to us

1261
00:49:24,720 --> 00:49:26,800
and only after we're authenticating and

1262
00:49:26,800 --> 00:49:29,119
sending signal dtm and we're signaling

1263
00:49:29,119 --> 00:49:32,000
dtmf codes only then the camera on the

1264
00:49:32,000 --> 00:49:34,559
intercom itself is opened and the data

1265
00:49:34,559 --> 00:49:36,720
is transferred through the two wire to

1266
00:49:36,720 --> 00:49:39,680
the gateway the home unit and diverted

1267
00:49:39,680 --> 00:49:41,760
through the sip network through the

1268
00:49:41,760 --> 00:49:44,400
cloud to our mobile app and finally we

1269
00:49:44,400 --> 00:49:46,880
have image

1270
00:49:46,880 --> 00:49:50,720
so here is an example of different

1271
00:49:50,720 --> 00:49:52,720
different intercoms that i was able to

1272
00:49:52,720 --> 00:49:54,559
interact with as you can see my

1273
00:49:54,559 --> 00:49:56,800
automation scanned a lot of intercoms

1274
00:49:56,800 --> 00:49:58,559
and i was able to open

1275
00:49:58,559 --> 00:50:01,119
camera streams uh for a lot of intercoms

1276
00:50:01,119 --> 00:50:02,480
around the world

1277
00:50:02,480 --> 00:50:03,920
and

1278
00:50:03,920 --> 00:50:05,440
i did not really

1279
00:50:05,440 --> 00:50:07,200
discuss it

1280
00:50:07,200 --> 00:50:08,480
thoroughly but

1281
00:50:08,480 --> 00:50:10,000
through the sip

1282
00:50:10,000 --> 00:50:11,839
i was able to receive the real the

1283
00:50:11,839 --> 00:50:14,240
external ip address of these devices so

1284
00:50:14,240 --> 00:50:17,119
i was able to map the country of which

1285
00:50:17,119 --> 00:50:19,280
these devices are located in

1286
00:50:19,280 --> 00:50:21,359
so as you can see here

1287
00:50:21,359 --> 00:50:24,400
uh i was able to find lots of devices

1288
00:50:24,400 --> 00:50:25,680
here uh

1289
00:50:25,680 --> 00:50:29,359
the account is uh 222 but i was able to

1290
00:50:29,359 --> 00:50:31,760
find lots of devices from germany europe

1291
00:50:31,760 --> 00:50:34,559
uh and actually all over the world

1292
00:50:34,559 --> 00:50:36,960
so let's see a short demo of how it

1293
00:50:36,960 --> 00:50:39,280
looks like in real

1294
00:50:39,280 --> 00:50:42,319
so first

1295
00:50:43,920 --> 00:50:46,160
first this is the the automation so as

1296
00:50:46,160 --> 00:50:47,920
you can see

1297
00:50:47,920 --> 00:50:49,680
i have

1298
00:50:49,680 --> 00:50:53,359
all the automation discussed running

1299
00:50:53,359 --> 00:50:56,319
and what he does is logging into the zip

1300
00:50:56,319 --> 00:50:57,440
network

1301
00:50:57,440 --> 00:51:01,200
authenticating sending uh

1302
00:51:01,200 --> 00:51:02,640
sending

1303
00:51:02,640 --> 00:51:04,800
all that all the relevant commands to

1304
00:51:04,800 --> 00:51:07,359
authenticate and then starting to listen

1305
00:51:07,359 --> 00:51:09,200
on ports

1306
00:51:09,200 --> 00:51:12,000
receiving data

1307
00:51:12,000 --> 00:51:15,440
and finally we will have our

1308
00:51:15,440 --> 00:51:17,839
video stream being transferred to us we

1309
00:51:17,839 --> 00:51:22,000
will decode it uses using the codecs

1310
00:51:22,000 --> 00:51:24,480
that were coordinated

1311
00:51:24,480 --> 00:51:27,599
in the sdp

1312
00:51:27,599 --> 00:51:30,000
and finally we will have our video

1313
00:51:30,000 --> 00:51:32,319
stream

1314
00:51:34,960 --> 00:51:38,240
so here's an example

1315
00:51:39,599 --> 00:51:41,920
and what we receive is something like

1316
00:51:41,920 --> 00:51:44,160
this

1317
00:51:44,319 --> 00:51:47,599
lots of video streams being transferred

1318
00:51:47,599 --> 00:51:51,839
to us from all around the world

1319
00:52:06,079 --> 00:52:08,400
okay this was our demo

1320
00:52:08,400 --> 00:52:10,079
uh so

1321
00:52:10,079 --> 00:52:13,359
we were able to pawn all the features of

1322
00:52:13,359 --> 00:52:15,200
the intercoms were able to open camera

1323
00:52:15,200 --> 00:52:17,520
streams and were able to unlock the door

1324
00:52:17,520 --> 00:52:18,960
through

1325
00:52:18,960 --> 00:52:21,200
sip signaling and also we were able to

1326
00:52:21,200 --> 00:52:23,680
transfer audio

1327
00:52:23,680 --> 00:52:26,160
at scale so we kind of

1328
00:52:26,160 --> 00:52:28,960
opened the cameras for lots of devices

1329
00:52:28,960 --> 00:52:30,480
around the world

1330
00:52:30,480 --> 00:52:32,960
now obviously we we tried to do a

1331
00:52:32,960 --> 00:52:34,880
responsible disclosure but it was kind

1332
00:52:34,880 --> 00:52:37,200
of difficult we sent an email to the

1333
00:52:37,200 --> 00:52:38,960
company saying hey

1334
00:52:38,960 --> 00:52:41,440
we found the design flow this security

1335
00:52:41,440 --> 00:52:43,359
design flow i want to

1336
00:52:43,359 --> 00:52:44,559
uh

1337
00:52:44,559 --> 00:52:47,839
report to you in a responsible manner

1338
00:52:47,839 --> 00:52:49,440
and

1339
00:52:49,440 --> 00:52:52,400
we sent another email and another email

1340
00:52:52,400 --> 00:52:55,760
and another email they ignored us

1341
00:52:55,760 --> 00:52:58,160
so we really tried to

1342
00:52:58,160 --> 00:53:00,559
disclose it to the vendor uh we started

1343
00:53:00,559 --> 00:53:03,760
in april uh we sent multiple emails we

1344
00:53:03,760 --> 00:53:06,559
even called them uh but we could not

1345
00:53:06,559 --> 00:53:09,680
receive any any response and we even

1346
00:53:09,680 --> 00:53:12,640
reported this to cert ielt

1347
00:53:12,640 --> 00:53:15,440
which is the third of israel but uh they

1348
00:53:15,440 --> 00:53:17,839
failed at communicating with the vendor

1349
00:53:17,839 --> 00:53:19,520
too so

1350
00:53:19,520 --> 00:53:21,839
uh we could not do anything and uh we're

1351
00:53:21,839 --> 00:53:25,200
just releasing this research as is

1352
00:53:25,200 --> 00:53:28,640
so to sum up uh a bad authentication

1353
00:53:28,640 --> 00:53:30,880
design flow allowed us to remotely

1354
00:53:30,880 --> 00:53:32,720
control vtec intercoms all around the

1355
00:53:32,720 --> 00:53:34,160
world uh

1356
00:53:34,160 --> 00:53:37,599
it was easy to guess account ideas we

1357
00:53:37,599 --> 00:53:40,559
also it was easy to collect account ids

1358
00:53:40,559 --> 00:53:42,480
because they're based on the serial in

1359
00:53:42,480 --> 00:53:43,480
the

1360
00:53:43,480 --> 00:53:46,720
ds2411 it's like having a username based

1361
00:53:46,720 --> 00:53:49,359
on your mac address which don't do that

1362
00:53:49,359 --> 00:53:52,720
uh known password abbreviation algorithm

1363
00:53:52,720 --> 00:53:55,280
was uh was in use

1364
00:53:55,280 --> 00:53:56,400
from

1365
00:53:56,400 --> 00:53:58,720
the username

1366
00:53:58,720 --> 00:54:01,119
a cloud management protocols

1367
00:54:01,119 --> 00:54:04,240
allows password override to default

1368
00:54:04,240 --> 00:54:05,760
without

1369
00:54:05,760 --> 00:54:07,760
any kind of

1370
00:54:07,760 --> 00:54:10,960
external authentication mechanisms and

1371
00:54:10,960 --> 00:54:12,160
by

1372
00:54:12,160 --> 00:54:14,400
taking all of this we're able to

1373
00:54:14,400 --> 00:54:17,359
create an automation that will

1374
00:54:17,359 --> 00:54:18,960
take video streams from different

1375
00:54:18,960 --> 00:54:20,400
intercoms around the world and we can

1376
00:54:20,400 --> 00:54:22,720
unlock doors open camera strings and

1377
00:54:22,720 --> 00:54:25,520
play sounds on these devices

1378
00:54:25,520 --> 00:54:27,440
the company did not reply to our

1379
00:54:27,440 --> 00:54:29,520
disclosure efforts we tried multiple

1380
00:54:29,520 --> 00:54:31,680
times we emailed them called them we

1381
00:54:31,680 --> 00:54:34,079
even tried to involve certain

1382
00:54:34,079 --> 00:54:36,480
organizations but we were not successful

1383
00:54:36,480 --> 00:54:38,880
at communicating them

1384
00:54:38,880 --> 00:54:42,319
and that's it thank you everyone and i

1385
00:54:42,319 --> 00:54:45,680
hope that one day uh we will add s to

1386
00:54:45,680 --> 00:54:48,480
iot thank you

1387
00:54:48,480 --> 00:54:50,880
sorry

1388
00:54:50,880 --> 00:54:53,839
this is

1389
00:55:16,319 --> 00:55:18,799
talk

