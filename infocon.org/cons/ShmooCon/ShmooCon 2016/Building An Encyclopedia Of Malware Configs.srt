1
00:00:00,000 --> 00:00:06,230
they've seen in the things you've done
online feedback and also that we still

2
00:00:06,230 --> 00:00:11,360
have a bunch of t-shirts for sale and
also previous years he searched for sale

3
00:00:11,360 --> 00:00:15,139
if you didn't get those previous years
are half price and of course all of the

4
00:00:15,139 --> 00:00:20,859
benefits go to the charity of your
choice so please help our charities I

5
00:00:20,859 --> 00:00:27,750
have at least some I know how much is
large t shirt you can wear life it's so

6
00:00:27,750 --> 00:00:41,559
wonderful and when this like you know
someone who has a large for the best

7
00:00:41,559 --> 00:00:43,570
response

8
00:00:43,570 --> 00:00:48,520
dickey's and is not afraid of getting
hit on the head with him right there see

9
00:00:48,520 --> 00:01:03,250
how far I can get this isn't gonna gonna
throw it all the visits to like that and

10
00:01:03,250 --> 00:01:15,140
this one video this way to be sitting up
front to get up and move right and I

11
00:01:15,140 --> 00:01:22,580
hope that you had a good time to talk
today because I'm very interested in in

12
00:01:22,580 --> 00:01:29,720
new ways to classify malware so that we
can use them for other data analysis so

13
00:01:29,720 --> 00:01:36,340
jon is has been a while you were 16

14
00:01:36,340 --> 00:01:44,990
ok he went to Fidelis security he's an
avid travel but he teaches at the

15
00:01:44,990 --> 00:01:49,460
University of Illinois as well and when
I asked him what he did for fun he said

16
00:01:49,460 --> 00:01:51,770
he has four kids and no time for fun

17
00:01:51,770 --> 00:01:59,050
mr speaker

18
00:01:59,050 --> 00:02:05,789
thank you hope you're not too hungover
from last night or at least you

19
00:02:05,790 --> 00:02:10,280
recovered somewhat from it can you know
I'm John beyond but I talked about

20
00:02:10,280 --> 00:02:15,720
building an encyclopedia of malware
configurations are you read the bio a

21
00:02:15,720 --> 00:02:19,840
little bit part of what goes into why
I'm doing this right

22
00:02:19,840 --> 00:02:24,340
several takedowns oriented groups some
very active with law enforcement trying

23
00:02:24,340 --> 00:02:29,660
to prosecute actors behind their
criminal operations so that kind of goes

24
00:02:29,660 --> 00:02:33,880
into why I develop and how I develop the
things that i doing creates some biases

25
00:02:33,880 --> 00:02:38,109
in my data collection that that we may
or may not get time to get into you know

26
00:02:38,110 --> 00:02:42,390
the short version of that is I just like
to burn things I i grew up in the

27
00:02:42,390 --> 00:02:46,329
eighties and nineties you know I
attention span of 30 seconds and I get

28
00:02:46,330 --> 00:02:51,420
bored easy so generally start on my
talks you know this general problem

29
00:02:51,420 --> 00:02:56,030
statement and all of your family with it
caused some form of this right you know

30
00:02:56,030 --> 00:03:00,330
as defenders of the white house crowd
right there are more criminal operators

31
00:03:00,330 --> 00:03:04,010
and there are people doing work right
we've got unlimited job security forever

32
00:03:04,010 --> 00:03:09,149
as long as we're right there is much
more malware then there's reverse

33
00:03:09,150 --> 00:03:14,940
engineer reverse everything we do is
public and it is very very hard to

34
00:03:14,940 --> 00:03:18,600
actually get criminal prosecutions to
happen the two that i've been involved

35
00:03:18,600 --> 00:03:24,230
in that actually gotten T and Verizon
stage almost about a year and about 10

36
00:03:24,230 --> 00:03:32,500
different countries involved so you know
the economy does not favor us this talk

37
00:03:32,500 --> 00:03:34,250
more about an hour or so

38
00:03:34,250 --> 00:03:38,560
this little brat fearsome virustotal by
shows the number of submissions that

39
00:03:38,560 --> 00:03:43,800
they've gotten the last seven days had
suggested it right and the orange line i

40
00:03:43,800 --> 00:03:48,310
think is the most pressing one night
that's the number of distinct new files

41
00:03:48,310 --> 00:03:53,500
detected by something roughly 400,000
Iraq alright there's no way that any

42
00:03:53,500 --> 00:03:57,220
human being can process all of that
stuff you still need reverse engineers

43
00:03:57,220 --> 00:04:01,859
but you need to get useful information
out of that and more humorous way of

44
00:04:01,860 --> 00:04:05,810
putting that is right that Chinese
hackers can't hire enough people to keep

45
00:04:05,810 --> 00:04:08,980
track of all of our abilities right for
those who saw the Onion article from

46
00:04:08,980 --> 00:04:14,690
three months ago it's hilarious right
because it's true so short version is a

47
00:04:14,690 --> 00:04:22,590
bad news we're doomed good news is I'm
gonna job security so you know so first

48
00:04:22,590 --> 00:04:23,070
right

49
00:04:23,070 --> 00:04:25,520
talk a little bit about threat
intelligence a lot of people talk about

50
00:04:25,520 --> 00:04:29,640
this and and and you know there's a
Twitter account but I really makes fun

51
00:04:29,640 --> 00:04:34,409
of a lot of people do it wrong you know
but this is important to where I'm going

52
00:04:34,410 --> 00:04:39,020
with some aspects of this talk right
there's data right you know tons of IP's

53
00:04:39,020 --> 00:04:45,460
domains whatever pick list of data
everything all right you know that's

54
00:04:45,460 --> 00:04:49,469
just information that doesn't make an
intelligence intelligence you know is

55
00:04:49,470 --> 00:04:54,810
critically examining information to
create some actionable conclusion there

56
00:04:54,810 --> 00:04:59,810
has to be some fraud involved and to get
an idea of what the day

57
00:04:59,810 --> 00:05:04,750
is really telling you a list of IP
addresses domains hashers whatever that

58
00:05:04,750 --> 00:05:08,370
you can buy from X security company that
got fifty million dollars in VC funding

59
00:05:08,370 --> 00:05:13,260
isn't necessarily intelligence that just
tons of times data and part of that

60
00:05:13,260 --> 00:05:17,110
involves analyzing the adversary in and
getting in their head which won't talk

61
00:05:17,110 --> 00:05:21,530
too much about here but knowing their
their motivations you know their

62
00:05:21,530 --> 00:05:29,000
dispositions and what they intend to do
so how to deal with you know a million

63
00:05:29,000 --> 00:05:33,250
plus samples of malware potential
malware

64
00:05:33,250 --> 00:05:38,410
reverse engineering is off the table no
one you know no one has the bandwidth to

65
00:05:38,410 --> 00:05:43,520
do that cuz it takes that takes too much
time dynamic analysis yeah you can do

66
00:05:43,520 --> 00:05:48,659
some of that but the standard analysis
window for a sample from a sunny

67
00:05:48,660 --> 00:05:53,100
dynamics and boxes about five minutes
right so you need a small data center to

68
00:05:53,100 --> 00:05:57,450
start processing all of that stuff and
there's problems with with dynamic

69
00:05:57,450 --> 00:05:58,800
analysis that we won't go into

70
00:05:58,800 --> 00:06:04,199
antics and boxing now you can do some
static analysis if you know how to put

71
00:06:04,199 --> 00:06:07,419
the pieces out and that's what we're
gonna talk about here and that's very

72
00:06:07,419 --> 00:06:13,520
very fast I was able to process maybe a
quarter terabyte of malware just to the

73
00:06:13,520 --> 00:06:18,270
static analysis piece within about an
hour window and not not using the

74
00:06:18,270 --> 00:06:22,508
high-end hardware this is very very fast
and get you a lot of information from

75
00:06:22,509 --> 00:06:27,060
malware that you know how to work with
and pulley information statically to get

76
00:06:27,060 --> 00:06:32,030
all that data and then start pushing
stuff that you can't do statically to

77
00:06:32,030 --> 00:06:35,138
dynamics and boxing and then to human to
human

78
00:06:35,139 --> 00:06:39,610
reverse engineers the idea of making
things a little bit more so more

79
00:06:39,610 --> 00:06:44,710
efficient so starter kit to start this
almost everything except the future

80
00:06:44,710 --> 00:06:48,628
malware you know is open source you can
need this talk and do this today if you

81
00:06:48,629 --> 00:06:53,530
want and by all means go have fun if you
if you choose to do it so you start with

82
00:06:53,530 --> 00:06:57,419
an original we started with rats but now
we're doing more than that we'll talk

83
00:06:57,419 --> 00:07:02,859
about that a second but whatever you get
is fine and the reasons rats is that

84
00:07:02,860 --> 00:07:06,810
there is a rat two quarters out there
that's open source we'll talk about the

85
00:07:06,810 --> 00:07:10,889
second figure out what selection
algorithm to say okay run this decoder

86
00:07:10,889 --> 00:07:13,560
and then run whatever is appropriate

87
00:07:13,560 --> 00:07:18,300
rip all the information output in the
database alright so internally like the

88
00:07:18,300 --> 00:07:21,440
Splunk that's everybody's favorite
bitbucket but then we'll share it out

89
00:07:21,440 --> 00:07:26,020
using this once that something available
all that's open source in to have links

90
00:07:26,020 --> 00:07:27,810
here in a second

91
00:07:27,810 --> 00:07:32,550
you know so why are rats kind of a
prototype for doing this kind of stuff

92
00:07:32,550 --> 00:07:37,289
single-stage malware you know the
configuration of what really matters

93
00:07:37,289 --> 00:07:37,628
right

94
00:07:37,629 --> 00:07:41,740
anybody can use dark comment one of the
most prolific rats out there but you

95
00:07:41,740 --> 00:07:45,389
really care more about the configuration
than you do that all you really need to

96
00:07:45,389 --> 00:07:48,889
say about our common as its dark comedy
shareware to be going up to in some of

97
00:07:48,889 --> 00:07:50,590
the other attributes

98
00:07:50,590 --> 00:07:56,880
but rats are not only just you know the
script 2000 and 2001 Telligent agencies

99
00:07:56,880 --> 00:08:01,600
use it I N attackers use it right it's
it's a good espionage tool you know

100
00:08:01,600 --> 00:08:05,690
whether you're fifteen year old and new
moms basement trying to spy on

101
00:08:05,690 --> 00:08:08,170
somebody's webcam or you wanna

102
00:08:08,170 --> 00:08:12,090
bank executives it's it's a good tool
for the job as long as you can deal with

103
00:08:12,090 --> 00:08:18,780
keeping an undetected dozens of
well-known types to work with but again

104
00:08:18,780 --> 00:08:24,119
you know we do it we do it from what
amounts so the idea is a good start

105
00:08:24,120 --> 00:08:28,900
prototypes to start developing the
tradecraft move along so you know you've

106
00:08:28,900 --> 00:08:33,199
got this what can you do with all of
these action figs well you can start

107
00:08:33,200 --> 00:08:37,940
burning them all right I can whack
thousands of these you know in one pop

108
00:08:37,940 --> 00:08:46,830
when I'm bored on a Friday night so
ultimately I said this gonna go to law

109
00:08:46,830 --> 00:08:52,040
enforcement starts to start trying to
clean stuff up automatically sync

110
00:08:52,040 --> 00:08:56,800
calling this a possibility and that's
that's its own talk right now we're

111
00:08:56,800 --> 00:09:00,089
gonna talk to your ignore is is the
mining the data correlations because

112
00:09:00,090 --> 00:09:03,670
that's where things start to get really
really interesting when you start seeing

113
00:09:03,670 --> 00:09:08,630
how an individual is changing their
malware overtime or changing the

114
00:09:08,630 --> 00:09:12,560
configuration or for that matter
switching now where families now you can

115
00:09:12,560 --> 00:09:17,469
start knowing something more about the
adversary other than this is engineer at

116
00:09:17,470 --> 00:09:19,870
this is talking to this hostname

117
00:09:19,870 --> 00:09:24,210
right now you can kind of see where
they're moving and get a better idea of

118
00:09:24,210 --> 00:09:32,220
what what's going on behind them this
year is the first piece a puzzle I said

119
00:09:32,220 --> 00:09:36,490
malware decoders Kevin Breen makes us
not mine right as thirty-some-odd I

120
00:09:36,490 --> 00:09:41,290
forget exactly thirty to forty some
oddities that he open source right so if

121
00:09:41,290 --> 00:09:46,819
you get a malware samples it dumps out
to configure an example of that

122
00:09:46,819 --> 00:09:51,978
but uses Python very fast and very
efficient cause you know it's it takes

123
00:09:51,979 --> 00:09:53,749
you know whatever pieces

124
00:09:53,749 --> 00:09:59,739
binary that its configuration items and
that changes between our tights and says

125
00:09:59,739 --> 00:10:03,199
here's what you need to know here's all
the configuration that's relevant and

126
00:10:03,199 --> 00:10:07,419
that's all pretty much all anyone would
ever need to know about maybe samples

127
00:10:07,419 --> 00:10:13,859
actively developed a few melhem you know
he'll he'll make changes so you know

128
00:10:13,859 --> 00:10:18,739
Kevin Cummins a good guy loves what he
does some sources of power

129
00:10:18,739 --> 00:10:23,459
virustotal being a commercial one right
everybody knows virustotal for

130
00:10:23,459 --> 00:10:28,108
enterprises that have security programs
Microsoft has a buyer programme Pires

131
00:10:28,109 --> 00:10:32,350
information Alliance where they can give
malware and some of their telemetry out

132
00:10:32,350 --> 00:10:36,379
it's a good program to be involved in
and that's saying something cuz I'm kind

133
00:10:36,379 --> 00:10:41,649
of an anti Microsoft but this is
something that Microsoft us you know and

134
00:10:41,649 --> 00:10:46,039
they're sharing programs internal
sources that we develop and in the end

135
00:10:46,039 --> 00:10:49,199
of the day it's about a quarter terabyte
of malware that word processing right

136
00:10:49,199 --> 00:10:53,349
now and hopefully get that up a whole
lot higher and if you have now where you

137
00:10:53,350 --> 00:10:57,509
wanna trade then by all means let's talk
and figure out what kind of exchange

138
00:10:57,509 --> 00:11:05,119
looking for for that every malware has
some kind of configuration items at the

139
00:11:05,119 --> 00:11:10,199
very minimum c2 information now we need
to talk to somewhere needs to figure out

140
00:11:10,199 --> 00:11:15,149
where that is in practice though there's
a lot of other items that go into it

141
00:11:15,149 --> 00:11:19,939
some of the richest just configuration
right do I want to turn off McAfee do I

142
00:11:19,939 --> 00:11:24,649
want to have anti Sandboxie into the bug
and do I want to install on this path

143
00:11:24,649 --> 00:11:28,850
right to this registry key there's a lot
of information and there's also some

144
00:11:28,850 --> 00:11:32,109
free-form text fields now fewer criminal

145
00:11:32,109 --> 00:11:37,289
I love criminals writing tax and free
form text deals that really makes my job

146
00:11:37,289 --> 00:11:43,799
easier I have no idea why you do that
but please keep doing it so you know

147
00:11:43,799 --> 00:11:44,540
that's

148
00:11:44,540 --> 00:11:47,469
really you know where you can get some
interesting correlation get some

149
00:11:47,470 --> 00:11:48,250
interesting data

150
00:11:48,250 --> 00:11:53,650
there's also some fix things mutex being
a good example we can correlate based on

151
00:11:53,650 --> 00:11:57,430
new tax everything else changes but the
mutex being random you have to push a

152
00:11:57,430 --> 00:12:02,770
button to re- randomized that provide
something that lets you map various

153
00:12:02,770 --> 00:12:08,270
campaigns together to the same after
overtime so as an example of some of the

154
00:12:08,270 --> 00:12:12,689
configuration right here is dark comet
now not typically sophisticated but it's

155
00:12:12,690 --> 00:12:17,490
out there is eight to ten thousand
samples of dark comedy you know in a

156
00:12:17,490 --> 00:12:22,270
given month right so campaign campaign I
D why in the world

157
00:12:22,270 --> 00:12:26,110
anyone would do anything but a default
value for campaign idea I have no idea

158
00:12:26,110 --> 00:12:31,670
just 16 as the fall right you know but
dark comment wall so happily allow you

159
00:12:31,670 --> 00:12:38,579
to use FTP to get you looks so we'll
have to authenticate to an FTP server so

160
00:12:38,580 --> 00:12:43,620
you see username and password not this
particular sample right so a lot of

161
00:12:43,620 --> 00:12:47,610
information right that you can use a
fairly fairly quickly and some things

162
00:12:47,610 --> 00:12:53,150
that are a little bit you know a little
bit less clear that how high you would

163
00:12:53,150 --> 00:12:58,250
operationalize it immediately you know
me text and Genco trends so I will talk

164
00:12:58,250 --> 00:13:01,900
about that again and Jarret you see
similar things but different different

165
00:13:01,900 --> 00:13:05,579
field it's a different now where does
things differently right this case

166
00:13:05,580 --> 00:13:10,020
writes the registry registry value again
as a randomly generated thing you gotta

167
00:13:10,020 --> 00:13:14,199
push a button to randomize it so that
can provide some ability to correlate

168
00:13:14,200 --> 00:13:19,930
between different samples you know host
domain name pour some configuration

169
00:13:19,930 --> 00:13:21,849
items

170
00:13:21,850 --> 00:13:26,940
dumping this place at the wrong text
version of this you know into a CSV

171
00:13:26,940 --> 00:13:30,510
you know like this you got hash value
description

172
00:13:30,510 --> 00:13:36,410
campaign I D you see the third one in
their right that's obvious know

173
00:13:36,410 --> 00:13:41,120
something discreet that I could say
who's using my campaign campaign idk

174
00:13:41,120 --> 00:13:46,130
other things the last night I'm on there
is username and password for an FTP

175
00:13:46,130 --> 00:13:50,500
server I redacted it sorry I didn't
think it was entirely appropriate to put

176
00:13:50,500 --> 00:13:55,990
somebody's username and password on a
slider to talk but there were also the

177
00:13:55,990 --> 00:13:59,710
same values so on top of putting that
stuff in their malware they're done

178
00:13:59,710 --> 00:14:06,700
they're not even doing that
authentication so they go to greg is

179
00:14:06,700 --> 00:14:12,530
that the brothers on amuse why people do
that I have no idea but thanks for doing

180
00:14:12,530 --> 00:14:16,569
so between all the families and actually
this whole lot more fields are just ran

181
00:14:16,570 --> 00:14:20,940
the ball all slides you know this gets
to how difficult it is the kind of data

182
00:14:20,940 --> 00:14:25,290
normalize all this stuff every piece of
malware has its own configuration items

183
00:14:25,290 --> 00:14:30,620
that are called something you've got all
of these lists of fields and not all of

184
00:14:30,620 --> 00:14:34,180
them were used and not all of them are
necessarily useful you know from an

185
00:14:34,180 --> 00:14:37,989
intelligence perspective whether
something turns off eighty or not I

186
00:14:37,990 --> 00:14:42,600
don't know if it's not irrelevant but
it's probably not the most useful

187
00:14:42,600 --> 00:14:49,640
information there so you know I said you
know how can you win in the venture

188
00:14:49,640 --> 00:14:53,380
capital gains you know you could take
all these si toos or just rip it from

189
00:14:53,380 --> 00:14:54,320
virustotal

190
00:14:54,320 --> 00:14:58,280
with a low cost of an epi ki you know
anything that ever to text get the

191
00:14:58,280 --> 00:15:03,110
network information you know get your
venture capital funding you know

192
00:15:03,110 --> 00:15:07,780
create some map right and there then
there's your money and people do this I

193
00:15:07,780 --> 00:15:11,270
don't know if the viable business model
of people get real money for it but

194
00:15:11,270 --> 00:15:15,010
that's really not the most useful thing
other things need to be done with this

195
00:15:15,010 --> 00:15:18,760
data and we talked in depth more before
using it

196
00:15:18,760 --> 00:15:24,870
before making conclusions based on so I
store all this data locally

197
00:15:24,870 --> 00:15:28,400
virustotal kids a lot of it the
virustotal doesn't keep configuration

198
00:15:28,400 --> 00:15:32,720
information there some aspects that it
will have you text and cases network

199
00:15:32,720 --> 00:15:36,310
information of the sample runs you know
but if you have all of that

200
00:15:36,310 --> 00:15:40,640
configuration information local now
you'd start correlating and and will

201
00:15:40,640 --> 00:15:50,400
show a little bit about that so the key
point however is that the key point for

202
00:15:50,400 --> 00:15:54,290
this however is that when you observe
stuff the time you may not even know

203
00:15:54,290 --> 00:15:59,089
what you're looking for a very very
often it's just like a week later

204
00:15:59,090 --> 00:16:03,090
citizen incident almost all incidents
are already in use in an organization by

205
00:16:03,090 --> 00:16:06,200
the time they were observed by time
someone responds to it if you knew what

206
00:16:06,200 --> 00:16:11,120
to look for you have a rule in place to
stop something if I knew what malware

207
00:16:11,120 --> 00:16:16,490
malware si toos where I can block at a
perimeter firewall right probably not

208
00:16:16,490 --> 00:16:20,690
the most efficient thing to do but you
could do that this allows you to kind of

209
00:16:20,690 --> 00:16:24,970
go back now I know something more about
what I'm looking for now let's see

210
00:16:24,970 --> 00:16:30,070
historically what is also mapped to that
pattern tonight even that backwards in

211
00:16:30,070 --> 00:16:34,330
time depending on how long this runs and
I'm hoping to run ten years of malware

212
00:16:34,330 --> 00:16:38,300
threw it at some point the future now I
can map back somewhat somebody's been

213
00:16:38,300 --> 00:16:43,319
doing for eight months which is very
useful information a lot of the

214
00:16:43,320 --> 00:16:48,370
prosecution's happen because it's not
just a discreet attack a discrete-event

215
00:16:48,370 --> 00:16:55,030
its ability to map that actors behavior
over time and to find the point where

216
00:16:55,030 --> 00:17:00,650
they screwed something or did something
to expose her identity as an example

217
00:17:00,650 --> 00:17:07,168
didi for BC did Oscar bitcoins guy was
arrested last month in

218
00:17:07,169 --> 00:17:11,989
in eastern europe and the way that
prosecution happened a very generic

219
00:17:11,989 --> 00:17:15,809
level that I could talk about right is
taking all of the emails all the

220
00:17:15,809 --> 00:17:20,480
indications that attack in the hole in
total and be able to map all the

221
00:17:20,480 --> 00:17:24,939
behavior back to a single person doing
that term one discrete event one bid

222
00:17:24,939 --> 00:17:29,330
when wallet one email and headers very
hard but being of the process over all

223
00:17:29,330 --> 00:17:33,408
of it then patterns emerged that start
to be able to correlate back to an

224
00:17:33,409 --> 00:17:38,929
individual that's why the historical
information important

225
00:17:38,929 --> 00:17:44,850
the other thing is I'm more of a network
oriented guy again I don't really do

226
00:17:44,850 --> 00:17:48,869
much endpoint stuff it's not as
interesting for me that's fine we all

227
00:17:48,869 --> 00:17:53,289
have our preferences so when I first
started gathering this you know I focus

228
00:17:53,289 --> 00:17:58,200
more on the sea to stop you know give me
the network indications because I know

229
00:17:58,200 --> 00:18:02,600
what to do with that stuff but then
somehow space guys come on hey you know

230
00:18:02,600 --> 00:18:07,519
what we can do IOC's we can we can use
this data in forensics or whatever and

231
00:18:07,519 --> 00:18:13,249
some other pieces become more useful so
even then my particular use cases

232
00:18:13,249 --> 00:18:18,169
shifted over time so I get a co-host
base IOC backtrace it all sorts of

233
00:18:18,169 --> 00:18:26,859
interesting things you can do here so
most of these rats malware families have

234
00:18:26,859 --> 00:18:32,230
you know they're free-form items
campaign I D past mutex registry keys

235
00:18:32,230 --> 00:18:35,019
you know these tend to be the
interesting things to correlate offer

236
00:18:35,019 --> 00:18:40,609
just doing you know basically you know
histogram statistical model another some

237
00:18:40,609 --> 00:18:42,840
have authentication information thank
you very much

238
00:18:42,840 --> 00:18:48,330
malware you know all of it can be
correlating to specific things for some

239
00:18:48,330 --> 00:18:49,790
particular reason

240
00:18:49,790 --> 00:18:53,010
criminals like using campaign IDs

241
00:18:53,010 --> 00:18:57,430
containerized thanks I have no idea why
you would do that unless you're making

242
00:18:57,430 --> 00:19:03,240
sure you change your campaign idea every
time but people do that so in the case

243
00:19:03,240 --> 00:19:09,190
of dark comment right here is just wrong
counts campaign ideas that was seen just

244
00:19:09,190 --> 00:19:13,750
16 get sixteen men the fall then you
have a whole bunch of other things

245
00:19:13,750 --> 00:19:21,080
kurbaan you'll see a bunch of iterations
of that which is Turkish victim recalled

246
00:19:21,080 --> 00:19:28,260
right there some Spanish stuff in there
occasionally have some things in Iraq so

247
00:19:28,260 --> 00:19:31,240
you know you in that campaign and he
might tell me something about the

248
00:19:31,240 --> 00:19:34,730
language somebody likes to speak not
enough to make a conclusion but it's

249
00:19:34,730 --> 00:19:38,870
interesting you know I don't know many
people who have picked the Turkish

250
00:19:38,870 --> 00:19:42,709
language to choose campaign ID's unless
you're familiar with Turkish language

251
00:19:42,710 --> 00:19:47,570
but it could be somebody who's trying to
deceive but useful information

252
00:19:47,570 --> 00:19:51,960
anybody does constitutional analysis
usually write the interesting data at

253
00:19:51,960 --> 00:19:56,370
the margins the most frequent and the
least not so much in this particular

254
00:19:56,370 --> 00:20:00,189
case was the most frequent going to fall
values the least frequent is going to be

255
00:20:00,190 --> 00:20:04,050
a one-time observance and that doesn't
give you much like the interesting

256
00:20:04,050 --> 00:20:08,810
correlations will be somewhere in the
middle and and we'll show you that you

257
00:20:08,810 --> 00:20:15,310
know sometimes interesting names right
so this is for JSOC a java-based rat you

258
00:20:15,310 --> 00:20:18,679
know discrete campaign ideas right and
obviously the one in Boulder someone

259
00:20:18,680 --> 00:20:22,320
just looking at this and what's
interesting an obvious specific

260
00:20:22,320 --> 00:20:27,850
reference August 21st to 24th fadely
seems familiar to me you know was there

261
00:20:27,850 --> 00:20:29,600
a bombing on August 24

262
00:20:29,600 --> 00:20:32,330
well in fact it was

263
00:20:32,330 --> 00:20:36,529
right this this happened to be a
discrete terrorist event and aircraft

264
00:20:36,529 --> 00:20:40,960
bombing in the Russian Federation 2004
alright so now this seems to be really

265
00:20:40,960 --> 00:20:45,830
interesting so now let's just dig deeper
says I'm not correlate on anything any

266
00:20:45,830 --> 00:20:50,090
JSOC it then with bombing the title I
met this probably not the most readable

267
00:20:50,090 --> 00:20:56,299
slide but you'll see in bold the same c2
and then you see fresh underscore bomb

268
00:20:56,299 --> 00:21:01,190
August bombing july first bombing 1st
July bombing August 24th bombing

269
00:21:01,190 --> 00:21:08,299
September 30 same after you know and
then you know some iteration of bomb you

270
00:21:08,299 --> 00:21:17,789
know in their title so looking a little
bit deeper right us- based see to an

271
00:21:17,789 --> 00:21:26,879
aggressive you know after which is no I
P so you know nothing a typical there so

272
00:21:26,880 --> 00:21:30,299
this is kind of a counter example of
correlation just because people like

273
00:21:30,299 --> 00:21:33,460
making spurious correlations right and
that's the biggest outcome of big data

274
00:21:33,460 --> 00:21:39,409
spurious spurious conclusions and that's
that's obviously sarcasm right you know

275
00:21:39,409 --> 00:21:43,870
but despite the ominous name right this
individual just likes calling his his

276
00:21:43,870 --> 00:21:48,389
attacks bombings right has nothing to do
and just happened to be you know I'd

277
00:21:48,389 --> 00:21:49,250
coincidence

278
00:21:49,250 --> 00:21:54,730
you know however you know if you're a
media media driven security researcher

279
00:21:54,730 --> 00:21:59,539
you know you're gonna see this and you
gotta write a blog post about some you

280
00:21:59,539 --> 00:22:04,090
know probably chechen dissident who is
running J socket and memorial

281
00:22:04,090 --> 00:22:09,039
this bombing attack right you know but
being able to pull a backward shows that

282
00:22:09,039 --> 00:22:14,260
that's pretty much crap

283
00:22:14,260 --> 00:22:17,299
correlating with me taxes and we talked
about that a little bit now we're gonna

284
00:22:17,299 --> 00:22:21,779
do in practice right interesting data is
in the middle right you know so this is

285
00:22:21,779 --> 00:22:22,830
all of them right

286
00:22:22,830 --> 00:22:29,408
1867 I think that's just one decoder
just has everything a mutex Pune many

287
00:22:29,409 --> 00:22:37,590
CDC underscore mutex dash and a random
77 character alphanumeric string right

288
00:22:37,590 --> 00:22:42,330
you press and the dark comedy venue
pressroom randomized it regenerates that

289
00:22:42,330 --> 00:22:50,029
72 strength so I just picked one of
those right 1 p.m. SPT not terribly

290
00:22:50,029 --> 00:22:54,809
likely in the real world that you're
gonna find two separate individuals who

291
00:22:54,809 --> 00:22:58,879
end up with the same attacks
theoretically possible but not probably

292
00:22:58,880 --> 00:23:05,250
likely running back you know everything
that map to that mutex you know what are

293
00:23:05,250 --> 00:23:10,649
common I see things that despite the
discrete IP addresses or host names you

294
00:23:10,649 --> 00:23:15,360
know time for starting from July to
December so five months

295
00:23:15,360 --> 00:23:19,510
uses all except in that one incident
right there in August all use the same

296
00:23:19,510 --> 00:23:24,129
campaign idea of urs tsunami able to sit
there and take a look at an actress is

297
00:23:24,130 --> 00:23:28,250
now I know where he's been for about
five months you know which is very

298
00:23:28,250 --> 00:23:32,279
useful information because I might be
able to you know have a Boxee is

299
00:23:32,279 --> 00:23:36,380
whatever grab it and then get some more
information but this is very useful now

300
00:23:36,380 --> 00:23:40,630
I can see patterns of behavior which
gets you to analyzing adversary

301
00:23:40,630 --> 00:23:44,370
capabilities and motivations because
one-time event doesn't give you a parent

302
00:23:44,370 --> 00:23:48,158
is does nothing much to analyze except
the technical and a one-time of that

303
00:23:48,159 --> 00:23:52,620
knowing this for instance I can start
manipulating this guy and then see how

304
00:23:52,620 --> 00:23:58,889
he moves I can provoke him and see what
happens I can you know do network traces

305
00:23:58,890 --> 00:24:03,520
are flows on those addresses and sees is
this just contain rising operations

306
00:24:03,520 --> 00:24:07,690
whereas one set of victim talking here
one set of it to talking there you know

307
00:24:07,690 --> 00:24:11,559
get a better understanding of exactly
what this person is doing right and

308
00:24:11,559 --> 00:24:12,559
those dates

309
00:24:12,559 --> 00:24:16,389
isn't you know it's just a date when the
bell were restricted to write this

310
00:24:16,389 --> 00:24:19,879
probably coming from virustotal this
malware could be going out all the time

311
00:24:19,879 --> 00:24:23,740
just because something is in July
doesn't mean that that malware is not

312
00:24:23,740 --> 00:24:28,960
still in circulation so very interesting
things that you can do like some with

313
00:24:28,960 --> 00:24:33,210
new taxes this next one to call the
Ashley Madison correlation password

314
00:24:33,210 --> 00:24:36,779
correlation tracked by everybody
remembers him Ashley Madison Ashley

315
00:24:36,779 --> 00:24:41,519
Madison half-right somebody sit there
and took a look at all the passwords in

316
00:24:41,519 --> 00:24:47,360
the database and found that 400,000
female accounts were created by the same

317
00:24:47,360 --> 00:24:52,330
for people because they all use the same
strong password right you know so you're

318
00:24:52,330 --> 00:24:56,330
able to create people based on strong
password to tell everybody do a strong

319
00:24:56,330 --> 00:25:00,449
password you know which is good for you
please do strong passwords but it also

320
00:25:00,450 --> 00:25:04,620
becomes a unique identifier correlate
somebody even if everything else is

321
00:25:04,620 --> 00:25:05,580
different

322
00:25:05,580 --> 00:25:10,100
odds are the same person is not going to
have the same strong past work so in

323
00:25:10,100 --> 00:25:14,360
this game is a funny thing for Ashley
Madison right you know 1 2008 Gmail

324
00:25:14,360 --> 00:25:18,750
accounts which shouldn't be surprising
but we can do that also with this new at

325
00:25:18,750 --> 00:25:24,529
this database could be some there's also
FTP user names and passwords some

326
00:25:24,529 --> 00:25:29,139
malware families will have in essence of
password to authenticate client to

327
00:25:29,139 --> 00:25:34,908
server so you can start using some of
that here is a case of you know

328
00:25:34,909 --> 00:25:39,370
basically a royalist just pass word
count unique password councilman in the

329
00:25:39,370 --> 00:25:44,289
database right so something's admin
administrator so even even hacker

330
00:25:44,289 --> 00:25:48,720
criminals can't do good passwords that
pic something in here

331
00:25:48,720 --> 00:25:55,539
version 2013 highly specific Middle
Atlas there so let's see you know bob's

332
00:25:55,539 --> 00:25:59,570
are somebody's probably not going to put
that in there to individuals are going

333
00:25:59,570 --> 00:26:05,439
to do that twice so your case points to
three different seats whose you know

334
00:26:05,440 --> 00:26:12,919
samples man is one of the last one is in
hong kong actually yeah and the other

335
00:26:12,919 --> 00:26:19,549
two are in hong kong so don't know too
much rice poison ivy so to rack don't

336
00:26:19,549 --> 00:26:22,710
know too much else about that but
concurrent correlate things just based

337
00:26:22,710 --> 00:26:27,669
on that password right so very
interesting things that you can do the

338
00:26:27,669 --> 00:26:30,830
technique can also feed domain
generation algorithms right there's a

339
00:26:30,830 --> 00:26:35,629
lot of malware out there right that used
eg ace and you know soon

340
00:26:35,630 --> 00:26:40,940
a mathematical formula to create
pseudo-random host names to use of c2

341
00:26:40,940 --> 00:26:46,960
communications so I usually based on
some cedar some set of inputs right so

342
00:26:46,960 --> 00:26:52,020
you can process now we're just to get
that information and be able to pull

343
00:26:52,020 --> 00:26:57,789
that out because in this case for 10
bucks the maybe a hundred hundred twenty

344
00:26:57,789 --> 00:27:04,158
different sets seat information for tiny
banker to write so just being able to

345
00:27:04,159 --> 00:27:08,419
keep track of that how that changes and
feed that into whatever you're doing in

346
00:27:08,419 --> 00:27:13,559
in terms of surveillance different talk
entirely but you see here

347
00:27:13,559 --> 00:27:15,610
top

348
00:27:15,610 --> 00:27:22,049
CNC if you the first host name that it
uses see all these at the bottom and

349
00:27:22,049 --> 00:27:27,860
then the seidman top ERC board so what
those three things given 10 but DGA

350
00:27:27,860 --> 00:27:32,790
script which is I'm getting downvoted
you can now generate the domains for the

351
00:27:32,790 --> 00:27:38,559
sample which might be all that you need
for coming back now all this generally I

352
00:27:38,559 --> 00:27:41,678
should say not all of it about
two-thirds of it use DNS right for c2

353
00:27:41,679 --> 00:27:48,790
communication right now my dad is biased
heavily towards rats for now so that

354
00:27:48,790 --> 00:27:53,399
affects you know the reliability of that
data right a lot of people say hey

355
00:27:53,400 --> 00:27:58,360
listen I've got a database of 400,000
configurations here come by it well

356
00:27:58,360 --> 00:28:02,699
those hundred thousand configurations
can be complete crap so what this shows

357
00:28:02,700 --> 00:28:07,130
you right here is that you know the
biggest percentage roughly sixty some

358
00:28:07,130 --> 00:28:12,360
odd percent of DNS information in those
configurations is an ex domain does not

359
00:28:12,360 --> 00:28:18,729
resolve which means I'm so anyone
indicator that is no use to you you know

360
00:28:18,730 --> 00:28:24,809
now we'll talk about that that's that
you know there is there is reason to

361
00:28:24,809 --> 00:28:28,910
keep that around but I but in the
present point in time it is useless

362
00:28:28,910 --> 00:28:34,950
information right there's always a next
big chunk RFC 1918 addresses could be

363
00:28:34,950 --> 00:28:38,450
testing could be something else will
talk about that specific case in a

364
00:28:38,450 --> 00:28:45,049
second and then 0000 right which is when
no ip suspends a suspends one of their

365
00:28:45,049 --> 00:28:49,840
host names they pointed to Quad zeros
are not just what they do so

366
00:28:49,840 --> 00:28:52,970
a fair bit of these were already
suspended by suspended by the provider

367
00:28:52,970 --> 00:29:00,220
so most rats right certainly
historically or not no longer actively

368
00:29:00,220 --> 00:29:04,549
resolving now you could use passive DNS
or some other techniques to figure out

369
00:29:04,549 --> 00:29:10,190
where those who are that's useful for
investigative purposes but passive DNS

370
00:29:10,190 --> 00:29:16,000
does miss quite a bit right just cover
rush a quiz about 25% of the host names

371
00:29:16,000 --> 00:29:21,100
and I saw Miller configurations we were
not caught by passive DNS not entirely

372
00:29:21,100 --> 00:29:24,110
scientific because I kept running
against maybe I'll admit they kept

373
00:29:24,110 --> 00:29:29,399
shutting down but the other key point to
remember this is just something because

374
00:29:29,399 --> 00:29:33,289
because something is an ex domain or
something

375
00:29:33,289 --> 00:29:39,029
resolves to 1918 space doesn't mean it's
not still militias right DNS is under

376
00:29:39,029 --> 00:29:43,379
control of the adversary for their names
of their domains they can do what they

377
00:29:43,379 --> 00:29:44,370
want

378
00:29:44,370 --> 00:29:51,039
many sophisticated attackers up to and
including intelligence agencies get that

379
00:29:51,039 --> 00:29:56,460
they don't need to have their si toos up
24 7 365 they only need their seat is up

380
00:29:56,460 --> 00:29:59,909
to the 15 or 30 minutes at their
operational so we'll have it resolved

381
00:29:59,909 --> 00:30:04,690
the malware happily beacons out for 30
minutes while they're doing whatever

382
00:30:04,690 --> 00:30:07,960
operational goals that they're doing and
then they're done and they turn it off

383
00:30:07,960 --> 00:30:13,649
so it's just because something is an ex
domain doesn't mean it's useless useless

384
00:30:13,649 --> 00:30:19,250
it just means it's not valuable
information right now so still keeping

385
00:30:19,250 --> 00:30:23,600
that around and possibly resolving it
every now and then to see if it changes

386
00:30:23,600 --> 00:30:28,158
and track that is is very important
information certainly get to those times

387
00:30:28,159 --> 00:30:33,759
when they are operational and now I know
where they live and the other thing to

388
00:30:33,759 --> 00:30:38,429
keep that host hostname around us to the
thing to bear in mind is that most rap

389
00:30:38,429 --> 00:30:43,179
protocols don't have hostname in the
header they're not HTTP days so you

390
00:30:43,179 --> 00:30:48,250
still have to do something with those
host names to make that into a network

391
00:30:48,250 --> 00:30:54,139
detectable item so you know where the
rats live in terms of a weird to see

392
00:30:54,139 --> 00:30:58,250
Tues live right is a top cities top
countries right and if you're an

393
00:30:58,250 --> 00:31:01,690
unsophisticated venture capital fund
intelligence from you gonna say hey look

394
00:31:01,690 --> 00:31:06,360
the FSB has internet business you know
it's it's the most common second most

395
00:31:06,360 --> 00:31:12,699
common country you know Cairo Egypt
Istanbul we saw the Turkish stuff before

396
00:31:12,700 --> 00:31:13,400
baghdad

397
00:31:13,400 --> 00:31:18,630
you know interesting stuff maybe its
Isis whatever no no not really you know

398
00:31:18,630 --> 00:31:22,840
it's time for your trip but Jack White
just because something is somewhere

399
00:31:22,840 --> 00:31:28,290
doesn't mean a country is behind it
which is the biggest source of all of

400
00:31:28,290 --> 00:31:32,899
these over-hyped news articles that we
see you know there's there's a malware

401
00:31:32,900 --> 00:31:35,190
seats who in russia that means the
Russian government shutdown this

402
00:31:35,190 --> 00:31:42,540
powerplant cool story bro so yeah if you
do that just stop just stop I'm tired of

403
00:31:42,540 --> 00:31:48,790
figuring out why the way these stories
are crap so he point correlation is not

404
00:31:48,790 --> 00:31:52,040
causation you know just because
something happens to be russia doesn't

405
00:31:52,040 --> 00:31:58,129
mean russia's involved with it but again
to keep in mind almost all of the data

406
00:31:58,130 --> 00:32:03,500
in security investigations is generally
under the control of the attacker who

407
00:32:03,500 --> 00:32:06,110
has the ability and means to deceive you

408
00:32:06,110 --> 00:32:15,459
DNS is a great example you know for all
of these hutus i think is the first

409
00:32:15,460 --> 00:32:18,550
example right is a malware configuration
dot com

410
00:32:18,550 --> 00:32:24,180
third line to the top probably can see
if the domain the seats who is quite 888

411
00:32:24,180 --> 00:32:30,920
how many people here think that Google
is in running a dark comedy too I think

412
00:32:30,920 --> 00:32:35,929
if I Google doesn't need to run iraq
walks right

413
00:32:35,929 --> 00:32:43,970
you know they have it all you know so
you know this is somebody

414
00:32:43,970 --> 00:32:49,580
testing something screen with data you
know a subset of attackers who do know

415
00:32:49,580 --> 00:32:54,379
we mind virustotal we do know we mind
DNS indicators actively tried to poison

416
00:32:54,379 --> 00:32:58,789
that information on another aspect of
what I do is DGA surveillance to resolve

417
00:32:58,789 --> 00:33:02,908
all the domains and active DGAC I've
seen people put quite a tener the

418
00:33:02,909 --> 00:33:07,879
adversary himself resolve it the quality
and I got a call I'm using your IP list

419
00:33:07,879 --> 00:33:14,939
and will block in Google why you doin
man stopped you know before no I'm not

420
00:33:14,940 --> 00:33:19,309
gonna create a white list of IP
addresses to DNS reservist in there just

421
00:33:19,309 --> 00:33:22,950
because that would be very very
destructive but no I'm not gonna get the

422
00:33:22,950 --> 00:33:27,879
business of waitlists just because
something points in there that there's a

423
00:33:27,879 --> 00:33:31,189
member configuration doesn't mean it out
some other thing has to be done with it

424
00:33:31,190 --> 00:33:35,909
right so attackers know we're doing this
they throw money in the water we talked

425
00:33:35,909 --> 00:33:39,830
about the DGA stuff but attackers could
have easily submit stuff and he GNE do

426
00:33:39,830 --> 00:33:44,610
so all the time and just because a seat
in a given country or whatever doesn't

427
00:33:44,610 --> 00:33:50,340
mean anything in and of itself it is a
data point that is not sufficient to go

428
00:33:50,340 --> 00:33:58,408
to the analysis so example 273 makes two
colors their public and if you look at

429
00:33:58,409 --> 00:34:04,610
all those records are public out there
has 141 forge a socket that particular

430
00:34:04,610 --> 00:34:09,509
actor knew that Kevin bring was writing
a decoder forge a socket so he would

431
00:34:09,510 --> 00:34:14,829
change the encryption key then encrypts
the dropper that

432
00:34:14,829 --> 00:34:19,589
is sent out from the builders he changed
the password is changed to Kevin

433
00:34:19,589 --> 00:34:24,509
bringing is the game right so
intentionally trying to change something

434
00:34:24,509 --> 00:34:27,759
but also intentionally knowing what
we're doing right that's just an example

435
00:34:27,759 --> 00:34:32,039
is that what we do is public right the
attackers can operate in pipe private

436
00:34:32,039 --> 00:34:36,589
but generally we're making products are
doing something almost everything that

437
00:34:36,589 --> 00:34:43,149
we do is public and the attackers
response talked a little bit about this

438
00:34:43,149 --> 00:34:45,190
DNS resolution point in time

439
00:34:45,190 --> 00:34:48,869
some tankers will resolve when actively
in operation and point them elsewhere

440
00:34:48,869 --> 00:34:52,779
when not in use right and they could
point to quite soon just to get somebody

441
00:34:52,779 --> 00:34:56,708
say you know what I'm not looking at
this skunk binary whatever know it

442
00:34:56,708 --> 00:35:01,719
actually could be something so being
mindful of bad in the data right now

443
00:35:01,719 --> 00:35:05,579
there's edged cases right so gripped
along right has configuration it's

444
00:35:05,579 --> 00:35:09,979
ransomware but their configuration
contains a list of compromised websites

445
00:35:09,979 --> 00:35:14,359
and have PHP files that begin the
process of getting encryption key to

446
00:35:14,359 --> 00:35:21,219
encrypt data on Invicta machines right
so you could block over this compromise

447
00:35:21,219 --> 00:35:27,359
sites that that's not a bad option I
don't know particularly good one this

448
00:35:27,359 --> 00:35:33,319
compromise sites are probably blocking
potentially valid use right and it's not

449
00:35:33,319 --> 00:35:38,170
just click the wall that uses
compromised sites in doing stuff or for

450
00:35:38,170 --> 00:35:43,150
that matter you know how many times has
a delivery networks served up

451
00:35:43,150 --> 00:35:47,029
wishes / block New York Times because
they they do

452
00:35:47,029 --> 00:35:52,799
interstitial ads that may or may not be
compromised so you know maybe a block it

453
00:35:52,799 --> 00:35:58,940
maybe you don't write a similar problem
with worthless based eta is where you

454
00:35:58,940 --> 00:36:03,319
know they used the Declaration of
Independence to create a hostname

455
00:36:03,319 --> 00:36:08,619
you know those may have interesting
collisions with real stuff for one of

456
00:36:08,619 --> 00:36:12,529
the domains generated by Rob next couple
of months ago was independence dot com

457
00:36:12,529 --> 00:36:16,140
that's not a malicious site that's a
thing right

458
00:36:16,140 --> 00:36:20,430
it just so happens to collision with
reality and then last in which is really

459
00:36:20,430 --> 00:36:24,899
interesting right there is a small
subset of now where that uses basically

460
00:36:24,900 --> 00:36:30,180
in coded IP addresses what I mean by
that is something and DNS against you

461
00:36:30,180 --> 00:36:34,200
and IP address and then some function
takes an IP address and converts it to

462
00:36:34,200 --> 00:36:39,790
what it really should be so you may be
pointing to an IP address just doing DNS

463
00:36:39,790 --> 00:36:45,670
resolution that says hey you know it's
195 whatever but really this is

464
00:36:45,670 --> 00:36:50,550
processed inside the malware that
converts the DNS resolve IP address to

465
00:36:50,550 --> 00:36:54,760
what actually the IP address should be
this all these interesting edge cases to

466
00:36:54,760 --> 00:37:00,040
deal with you know using this also you
can sit there and look for si toos you

467
00:37:00,040 --> 00:37:03,680
might not otherwise see my data relies
on otherwise getting there were two

468
00:37:03,680 --> 00:37:07,450
processes you know but I don't have 100
percent disability right the more

469
00:37:07,450 --> 00:37:12,930
targeted an attack is the likelihood of
me seeing that anybody seen it drops off

470
00:37:12,930 --> 00:37:18,830
significantly so you can use so many
strains to use run-ins showdown to find

471
00:37:18,830 --> 00:37:24,220
seats who's right so a search here a
couple of drinks and then you start

472
00:37:24,220 --> 00:37:28,040
finding put 1604 which is the default
are common part but it can be anything

473
00:37:28,040 --> 00:37:32,200
you want so showdown can find some of
these heat Tuesday didn't start adding

474
00:37:32,200 --> 00:37:39,939
to your own data and there's also some
parts of data that are in the

475
00:37:39,940 --> 00:37:45,740
configuration itself that also might be
of interest so in a case of SSL

476
00:37:45,740 --> 00:37:53,129
Certificates J socket for instance the
the builder the builder also doubles as

477
00:37:53,130 --> 00:37:59,280
a controller and it is all over SSL
which all builders have the same SSL

478
00:37:59,280 --> 00:38:03,790
certificate because it's just built in
it doesn't randomly generated so pulling

479
00:38:03,790 --> 00:38:05,050
that out

480
00:38:05,050 --> 00:38:08,140
can give you some interesting
information right so first you know

481
00:38:08,140 --> 00:38:12,379
you've got necessary that she knows no
malicious anytime you see that certainly

482
00:38:12,380 --> 00:38:14,250
handshake you know you've got a problem

483
00:38:14,250 --> 00:38:18,560
ok that's certainly a viable you can
also do some searching with a showdown

484
00:38:18,560 --> 00:38:19,330
but

485
00:38:19,330 --> 00:38:22,950
it's not working quite right yet but
it's an interesting thing with the issue

486
00:38:22,950 --> 00:38:24,700
of the silliest right

487
00:38:24,700 --> 00:38:29,410
oddly specific thing you know french
organization the silliest thing the

488
00:38:29,410 --> 00:38:34,899
silliest right it's oddly specific of
something that doesn't look so I google

489
00:38:34,900 --> 00:38:41,540
it goes to this blog post of somebody
who talks about how to create but it's

490
00:38:41,540 --> 00:38:46,770
just a job hippie store thing which is
how to create input in SLC SSL

491
00:38:46,770 --> 00:38:51,850
certificate and a job a keystore and Jay
socket uses that certificate to make

492
00:38:51,850 --> 00:38:55,650
sure no man in the middle work because
if it gets a certificate doesn't expect

493
00:38:55,650 --> 00:39:02,390
it then it just drops the connection so
the author Jay socket use this blog post

494
00:39:02,390 --> 00:39:07,690
specifically follow these instructions
up to and including the issuer name and

495
00:39:07,690 --> 00:39:15,380
country for awhile he even used the same
password that was in that blog post of

496
00:39:15,380 --> 00:39:19,670
storms pass he was smart enough to
realize that that was a bad life

497
00:39:19,670 --> 00:39:24,090
decision and change that you know but I
can try the blog post he was using for

498
00:39:24,090 --> 00:39:28,310
instructions so I said

499
00:39:28,310 --> 00:39:35,480
some families some families of rats and
malware also use apks apks have to be

500
00:39:35,480 --> 00:39:42,270
signed so those signing certificates
then become useful stuff to go find

501
00:39:42,270 --> 00:39:43,290
other things right

502
00:39:43,290 --> 00:39:48,430
you know a lot of a lot of Android
malicious apps I mean it's kind of

503
00:39:48,430 --> 00:39:53,009
tricking people outside the App Store
but there is a fair bit of malicious

504
00:39:53,010 --> 00:39:56,640
apps that still make it into the App
Store and now if I'm able to sit and

505
00:39:56,640 --> 00:40:00,920
observe hey this builder bill to this
you know this

506
00:40:00,920 --> 00:40:05,750
apk signing certificate now I can go
hunting the App Store not only Google's

507
00:40:05,750 --> 00:40:09,870
but some of the other third-party app
stores and they'll find related malware

508
00:40:09,870 --> 00:40:16,549
right and in hundreds and thousands but
certainly in the hundreds of cases you

509
00:40:16,550 --> 00:40:21,120
know we'd we found malware in the stores
just by doing significant correlation

510
00:40:21,120 --> 00:40:30,100
yeah so this for jason has an Android
park part of it right so this the

511
00:40:30,100 --> 00:40:34,580
details for its builder what was most
interesting out of this and why I think

512
00:40:34,580 --> 00:40:36,750
Google should have called it on their
own right

513
00:40:36,750 --> 00:40:43,470
some third party in AU writer for
Android is not gonna have or as a sign

514
00:40:43,470 --> 00:40:47,180
in as the issuer for a signing
certificate that ought to be something

515
00:40:47,180 --> 00:40:54,589
that's caught and the other thing is
there is actually a Cincinnati work done

516
00:40:54,590 --> 00:40:58,760
or was about a hundred years ago now is
known as y'all are something like that

517
00:40:58,760 --> 00:41:03,240
so but it's certainly not in the
European Union all of that is invalid

518
00:41:03,240 --> 00:41:07,850
right it was even skipped past your
ballpark you know state or again

519
00:41:07,850 --> 00:41:14,098
country-code European Union I'm sure the
search engine of the world could manage

520
00:41:14,099 --> 00:41:23,410
to figure out that piece of data just a
thought so what's next I said all this

521
00:41:23,410 --> 00:41:27,960
DNS stuff this point in time so there
needs to be something on the front end

522
00:41:27,960 --> 00:41:30,869
or something on the back and that takes
a look at that information to do some

523
00:41:30,869 --> 00:41:35,099
kind of validation right if somebody
isn't hell bent on creating firewall

524
00:41:35,099 --> 00:41:35,849
rules right

525
00:41:35,849 --> 00:41:39,489
resolve all this stuff get its IP
addresses all the continually if it

526
00:41:39,489 --> 00:41:44,460
doesn't resolve find drop it and then
just to kind of us in JFK has put 1604

527
00:41:44,460 --> 00:41:51,279
open on 889 890 Google doesn't read our
comment so that should come back to get

528
00:41:51,279 --> 00:41:55,640
you some basic information with which to
us now I can at least create a

529
00:41:55,640 --> 00:42:00,470
relatively high confidence fire will set
but still take additional scrutiny on

530
00:42:00,470 --> 00:42:06,308
tape or 25 and 80 and 443 a small
handful number of ports you know but if

531
00:42:06,309 --> 00:42:12,390
the ports open the IP to DNS resolves
nine-page firewall rules you know and

532
00:42:12,390 --> 00:42:18,308
and and start getting to operationalize
in it I wanna get to a point processing

533
00:42:18,309 --> 00:42:24,339
historic 18 months right now but going
back you know fire still has a huge

534
00:42:24,339 --> 00:42:28,960
datasets Microsoft anybody who has won
right I thought I'd love to run my stuff

535
00:42:28,960 --> 00:42:32,509
over to get into the databases and
eventually I will share this out with

536
00:42:32,509 --> 00:42:36,979
missed so pay attention for that we will
give this back to the community I do

537
00:42:36,979 --> 00:42:40,189
work for security company but this is
something here everybody here is a great

538
00:42:40,190 --> 00:42:45,680
intelligence tool have fun with it and
tell us tell us what you can do I said

539
00:42:45,680 --> 00:42:50,538
said you know my long-term goal is to
burn incense all the things I can't shut

540
00:42:50,539 --> 00:42:54,210
shut things down and put somebody in
prison and sinkhole it and start trying

541
00:42:54,210 --> 00:43:01,460
to clean up coming to see junior you
will be Bullet Bill anytime hulaville

542
00:43:01,460 --> 00:43:07,710
so final point we are hiring you know
I've got three or four openings at the

543
00:43:07,710 --> 00:43:12,080
center of the day so if you're looking
if you like this stuff by means get in

544
00:43:12,080 --> 00:43:16,609
touch you wanna share malware otherwise
work on any other things I'm interested

545
00:43:16,609 --> 00:43:22,540
in do dat das however an somewhere you
know come find me and let's burn things

546
00:43:22,540 --> 00:43:44,890
thanks everybody who's helped with this
my team in particular any questions yes

547
00:43:44,890 --> 00:43:53,020
this this is just a domain the question
was whether any DJs DJs part of this DNS

548
00:43:53,020 --> 00:43:54,500
resolution so let me answer is No

549
00:43:54,500 --> 00:44:01,390
this is this is just a static stuff for
DJs if you like I was saying if you

550
00:44:01,390 --> 00:44:07,640
strip out sinkholes it's like 99% 98 99
percent and you know the biggest the

551
00:44:07,640 --> 00:44:14,810
biggest registrant of DGA domains
security companies and other questions

552
00:44:14,810 --> 00:44:30,119
true

553
00:44:30,119 --> 00:44:36,109
the question is how have I used sponsor
and analysis to correlate whether a

554
00:44:36,109 --> 00:44:42,230
given host name as a DGA there are
people who have done that the problem

555
00:44:42,230 --> 00:44:49,779
comes into his first two problems money
is the only Latin I used non Latin

556
00:44:49,779 --> 00:44:53,650
language host names that make sense
right you know somebody translating

557
00:44:53,650 --> 00:44:59,519
China Chinese into last night for domain
name you tend to get some weirdness

558
00:44:59,519 --> 00:45:07,439
there but the biggest problem with that
is yeah I can be fairly confident tell

559
00:45:07,440 --> 00:45:09,170
you somethings the DGA

560
00:45:09,170 --> 00:45:14,309
domain but mapping that back in reverse
engineering it into an algorithm to go

561
00:45:14,309 --> 00:45:17,950
to a family is where things get
difficult because our kind of flexible

562
00:45:17,950 --> 00:45:25,499
classification of EEG aces character set
thanks to oldies we don't have much else

563
00:45:25,499 --> 00:45:27,770
to work with you so

564
00:45:27,770 --> 00:45:32,070
there's there needs to be more work on
that particular piece that makes sense

565
00:45:32,070 --> 00:45:41,290
there was another question this general
regional daughter and other hand

566
00:45:41,290 --> 00:45:56,270
let me off easy nobody wants to throw
anything at me the side YouTube yes

567
00:45:56,270 --> 00:46:01,850
what about miss attribution and nation
states who are trying to mimic other

568
00:46:01,850 --> 00:46:10,380
entities our nation states to create
geopolitical tom foolery right why

569
00:46:10,380 --> 00:46:15,150
policy using the stuff in and of itself
there has to be more analysis done to

570
00:46:15,150 --> 00:46:19,090
really call it intelligence but this is
this is this is Dana I mean you can make

571
00:46:19,090 --> 00:46:23,220
some intelligence conclusions and some
cases but yeah if I were if I were the

572
00:46:23,220 --> 00:46:28,220
CIA or the NSA yeah I'd be making people
think I was China all day long

573
00:46:28,220 --> 00:46:33,740
somebody else oh absolutely intelligence
agents will do that but that takes data

574
00:46:33,740 --> 00:46:39,649
and a human spending time to figure it
out because eventually given enough data

575
00:46:39,650 --> 00:46:43,650
enough observable events you can start
saying well that doesn't really matter

576
00:46:43,650 --> 00:46:49,970
to what they ought to be doing if i were
intelligence agency and an error and

577
00:46:49,970 --> 00:47:05,328
seeing that the max on anybody else

578
00:47:05,329 --> 00:47:19,079
Bayesian analysis where you may believe
something as malware but don't know they

579
00:47:19,079 --> 00:47:22,099
can do that I don't know if I have a
long enough data set where where that

580
00:47:22,099 --> 00:47:26,660
would yield as much fruit but but yeah I
mean if I get ten years of malware then

581
00:47:26,660 --> 00:47:36,379
yet and we're talking Bayesian and other
really really neat things

582
00:47:36,380 --> 00:47:44,700
anybody else or another question

583
00:47:44,700 --> 00:47:45,810
all right thank you

