1
00:00:00,000 --> 00:00:08,019
well good afternoon my name's requests
and I work for a company called support

2
00:00:08,019 --> 00:00:13,030
intelligence and I think the stock is
going to dovetail really nicely with

3
00:00:13,030 --> 00:00:22,600
previous gentleman I to do lunch with
images and movies before I get started

4
00:00:22,600 --> 00:00:26,199
dyslexic person and I'm always
interested in meeting other dyslexic

5
00:00:26,199 --> 00:00:30,500
people especially if you're from the bay
area we have some things that we're

6
00:00:30,500 --> 00:00:36,160
going to get started this year about
dyslexic entrepreneurs so definitely

7
00:00:36,160 --> 00:00:48,319
catch me in the hallway and so where we
are today and this is about the

8
00:00:48,320 --> 00:00:54,070
challenges that were trying to demand
you heard about the last gentleman Jamie

9
00:00:54,070 --> 00:00:59,230
and I believe was working against and so
on a daily basis we're looking at

10
00:00:59,230 --> 00:01:05,099
millions of applications that we have to
decide if they are going to run or not

11
00:01:05,099 --> 00:01:11,250
we have hundreds of thousands of
websites domain names URLs thousand-seat

12
00:01:11,250 --> 00:01:17,930
ease millions of DJs and thousands of
new york signatures that we got us in

13
00:01:17,930 --> 00:01:24,619
the enter our devices and so the problem
that we have is I consider similar to

14
00:01:24,619 --> 00:01:30,710
the halting problem which is it's still
hard to figure out whether or not we

15
00:01:30,710 --> 00:01:39,130
should run some code halting problem is
as during a problem in determining when

16
00:01:39,130 --> 00:01:43,908
a program's gonna stop when I want to
talk about today is deciding whether or

17
00:01:43,909 --> 00:01:50,140
not we should start a program and so
this gets into an asymmetric problem for

18
00:01:50,140 --> 00:01:55,870
us as defenders of networks where we
have a strategy but it's

19
00:01:55,870 --> 00:02:00,610
to identify the compromised in points so
we end up with a whole bunch of data

20
00:02:00,610 --> 00:02:06,039
feeds that we put in our devices to list
all the evil things that shouldn't do

21
00:02:06,040 --> 00:02:13,670
and so we use a whole bunch of
biological metaphors to describe these

22
00:02:13,670 --> 00:02:17,679
activities none of which work nearly as
well as the actual biological

23
00:02:17,680 --> 00:02:26,010
equivalents and so if our immune systems
worked as well as our firewalls we'd be

24
00:02:26,010 --> 00:02:34,220
all that so I gotta get two concepts
across the rest of the talk and those

25
00:02:34,220 --> 00:02:39,470
two concepts start with this idea of an
information apex ok and an example of

26
00:02:39,470 --> 00:02:44,990
this is trying to figure out how many
real voters there are in america that

27
00:02:44,990 --> 00:02:50,050
are eligible to vote that are enrolled
or on the voting rolls and so if we try

28
00:02:50,050 --> 00:02:53,610
and count all of the voters on these
roles we have way more than we have

29
00:02:53,610 --> 00:02:58,470
americans and so the Pew Charitable
Trusts and IBM got together

30
00:02:58,470 --> 00:03:04,430
collected a bunch of voter rolls and
clustered the individuals and so what

31
00:03:04,430 --> 00:03:11,340
happened was there dana the dataset was
growing and as it grew and they started

32
00:03:11,340 --> 00:03:19,070
to cluster the individual voters adding
another voter didn't have a lot of data

33
00:03:19,070 --> 00:03:23,820
to the dataset right if you have three
rows that are on the scene people that's

34
00:03:23,820 --> 00:03:29,600
really went into teams and so your
dataset begins to get smaller as you add

35
00:03:29,600 --> 00:03:35,530
more days right it's the opposite a
hockey stick problem and so what we want

36
00:03:35,530 --> 00:03:43,820
to do is find that asymptote where our
data growth rate turns negative and so

37
00:03:43,820 --> 00:03:48,820
the second idea that I want to get
across is something that I made up and

38
00:03:48,820 --> 00:03:53,959
being dyslexic I don't know how to spell
this word but image application which is

39
00:03:53,959 --> 00:04:00,390
where we take a piece of data and turn
it into a pixel and so for the rest of

40
00:04:00,390 --> 00:04:02,569
the talk is about how we do this with

41
00:04:02,569 --> 00:04:11,819
applications spam e-mail anything
scaffolding HTML and so doing this we

42
00:04:11,819 --> 00:04:17,509
can convert these datasets in the images
and then eventually into a 64 bit

43
00:04:17,509 --> 00:04:24,610
identifier that is essentially a
excellent is 64 bit face face so when

44
00:04:24,610 --> 00:04:28,349
those pixels are next to each other
information that they're related to

45
00:04:28,349 --> 00:04:33,400
similar and so that's what we're trying
to do is find similar images which is

46
00:04:33,400 --> 00:04:39,549
like with the fella before me was having
an issue so turns out really hard to do

47
00:04:39,550 --> 00:04:46,680
with the CPU it's very expensive in time
in computer and so we do with GPUs know

48
00:04:46,680 --> 00:04:54,419
this is an example of image of vacation
we can't read there but our sons can and

49
00:04:54,419 --> 00:05:00,400
each pixel is actually part of a dataset
and this one will turn into a URL for

50
00:05:00,400 --> 00:05:06,179
your time we're gonna talk about though
is a particular kind

51
00:05:06,180 --> 00:05:11,570
gonna do something with the data we're
gonna put it into something called a

52
00:05:11,570 --> 00:05:15,719
space-filling curve and so this is the
first time I saw space filling her and

53
00:05:15,720 --> 00:05:23,259
this is the internet on xkcd for example
I'm gonna show you some examples of the

54
00:05:23,259 --> 00:05:29,389
image of occasion of being a guy like
DNA lot everybody should it's it's in

55
00:05:29,389 --> 00:05:34,940
everyone of ourselves and this
particular DNA that i'm gonna show you

56
00:05:34,940 --> 00:05:42,099
is packed in a space-filling curve but
this is a two dimensional space filling

57
00:05:42,099 --> 00:05:48,729
curve of a bolo which just yesterday the
United Nations said that Sierra Leone is

58
00:05:48,729 --> 00:05:58,080
free of a bola today someone died from
it yeah so this is a 16 killer by a

59
00:05:58,080 --> 00:06:03,359
virus that kills humans right and on the
left you see it in color on the right

60
00:06:03,360 --> 00:06:05,330
you see it in black and white

61
00:06:05,330 --> 00:06:14,830
so this is an all DNA is packed all
eukaryotes prokaryotes

62
00:06:14,830 --> 00:06:18,680
this way eukaryotes which is basically
people in animal models of other stuff

63
00:06:18,680 --> 00:06:26,460
pack near me in a in space filling curve
and you can display those in either 2d

64
00:06:26,460 --> 00:06:33,330
or 3d now the second time I was playing
around space-filling curves was with IP

65
00:06:33,330 --> 00:06:38,740
addresses so this is the internet and a
space-filling curve and this is the

66
00:06:38,740 --> 00:06:45,760
virus response in 2007 to a virus and so
these since we in sync all the demands

67
00:06:45,760 --> 00:06:52,420
that this particular virus used and we
were able to display in a simple image

68
00:06:52,420 --> 00:07:01,100
the representation each pixel here is a
IP address or so it's 255 IP addresses

69
00:07:01,100 --> 00:07:10,930
for pics and the number of infected
hosts in color so is the same concept

70
00:07:10,930 --> 00:07:16,120
same thing that can as using space
filling curve but this is a program now

71
00:07:16,120 --> 00:07:20,490
this program happens to like stealing
your passwords for your bank's accounts

72
00:07:20,490 --> 00:07:32,620
and also had a really low detection rate
on total so what i'm talking bout is

73
00:07:32,620 --> 00:07:39,260
this kind of data and we can cluster all
kinds of things like web content which

74
00:07:39,260 --> 00:07:44,090
has utility that you heard already in
detecting phishing pages and fishing

75
00:07:44,090 --> 00:07:51,700
vacation I'm gonna show you how to do it
with email in SMTP streams and finally

76
00:07:51,700 --> 00:07:56,659
it's really about safety profile safety
can we run this program and this is a

77
00:07:56,660 --> 00:08:03,750
really quick way to determine if we can
run a program without running it and so

78
00:08:03,750 --> 00:08:11,340
this is the first movie seriously hope
it plays yes okay so this is a cluster

79
00:08:11,340 --> 00:08:17,150
of malware is actually not an hour it's
a potentially unwanted program that is

80
00:08:17,150 --> 00:08:21,460
published by a legal entity that
publishes tens of thousands of these per

81
00:08:21,460 --> 00:08:21,830
day

82
00:08:21,830 --> 00:08:25,770
so it gets through any violence and it
takes over

83
00:08:25,770 --> 00:08:31,210
advertising essentially providing ads
for you you can see the indy five the

84
00:08:31,210 --> 00:08:36,340
top of the page and what you're seeing
is how they change the code in this

85
00:08:36,340 --> 00:08:52,070
particular binary where each each a
image I wanted to tell you there but in

86
00:08:52,070 --> 00:09:03,200
here is SMTP and what you're seeing is
this is a Fed wire SMTP that went out to

87
00:09:03,200 --> 00:09:09,830
see if owns a month ago and what it was
doing was convincing us that the Fed was

88
00:09:09,830 --> 00:09:15,310
gonna be down for a couple of hours for
maintenance and they needed to change

89
00:09:15,310 --> 00:09:20,000
the time that they sent their wires and
so when you get done that your CFO got

90
00:09:20,000 --> 00:09:27,100
owned and what was happening here is you
notice that it's much more muted image

91
00:09:27,100 --> 00:09:35,650
and that's because email is 7 bids so we
don't have kids in email only carriage

92
00:09:35,650 --> 00:09:41,360
return and only the carriage return and
line feed happened to be control codes

93
00:09:41,360 --> 00:09:49,130
and so little black pixels the move
around or the CRLs that individual

94
00:09:49,130 --> 00:09:54,730
eighty by record links for an email you
can also see the header in the top

95
00:09:54,730 --> 00:09:59,840
left-hand portion of the screen and
that's what moves the imagery on the

96
00:09:59,840 --> 00:10:04,760
interesting thing here is that there is
some texture that doesn't change and

97
00:10:04,760 --> 00:10:11,810
that's what we leverage to identify
these ok so here's another movie and

98
00:10:11,810 --> 00:10:20,010
this is a Trojan and not much is going
to change in this image I don't know if

99
00:10:20,010 --> 00:10:25,180
you can see a couple of pixels that
change near the bottom when you see the

100
00:10:25,180 --> 00:10:25,800
whole thing

101
00:10:25,800 --> 00:10:32,979
and so this is literally thousands of
samples of a piece of power that has a

102
00:10:32,980 --> 00:10:43,610
pretty low on oil and what we're gonna
do is now where that's what this is done

103
00:10:43,610 --> 00:10:50,290
converting to an image and then place
that image images because they look

104
00:10:50,290 --> 00:10:56,130
similar problem that the previous
gentleman was trying to attack which is

105
00:10:56,130 --> 00:11:02,860
how do you sort these images and so it's
looking for similarities rate so it's a

106
00:11:02,860 --> 00:11:07,640
test for similarly like I said it's hard
to do on a CPU even with a bunch of

107
00:11:07,640 --> 00:11:14,990
quarters it's best on FPGA is but
meantime if she's really expenses but

108
00:11:14,990 --> 00:11:25,089
GPUs are fairly inexpensive and cheap in
power usage so the user used to schedule

109
00:11:25,089 --> 00:11:32,190
the code that's gonna run on the GPUs
and manage moving around we were able to

110
00:11:32,190 --> 00:11:36,820
get our clustering times down to just
under half hour just over half of a

111
00:11:36,820 --> 00:11:42,279
millisecond per sample right so when you
have an Internet scale problem you have

112
00:11:42,279 --> 00:11:47,800
to think about how much energy you use
the previous gentleman had a strategy

113
00:11:47,800 --> 00:11:54,959
and it took too much time it took too
much time in his cube down or it takes

114
00:11:54,959 --> 00:11:59,890
too much time in the case of sandboxing
right we're gonna run each sample five

115
00:11:59,890 --> 00:12:05,170
minutes so I came up with this idea of
what I call an influential and that is

116
00:12:05,170 --> 00:12:09,949
how much energy it takes to make a
decision and what we're doing is we're

117
00:12:09,949 --> 00:12:15,439
making a decision about whether or not
we should run a program and we want to

118
00:12:15,440 --> 00:12:20,160
make that decision as fast as possible
in the least amount of energy and so I

119
00:12:20,160 --> 00:12:23,880
came up with this idea that an
individual is a unit of Information

120
00:12:23,880 --> 00:12:28,820
calculated in jewels but express the
time to calculate the information in

121
00:12:28,820 --> 00:12:32,800
what s/s is the same as a jewel or a

122
00:12:32,800 --> 00:12:37,569
a new meter and so if you like this kind
of stuff there's a reference there for

123
00:12:37,570 --> 00:12:43,279
an idea that information is actually
heat and published on some of this

124
00:12:43,279 --> 00:12:50,689
thinking last year our best
classification times were in in June and

125
00:12:50,690 --> 00:12:56,160
we were able to get actually in June are
best kept classification times were

126
00:12:56,160 --> 00:13:00,949
about 33 milliseconds per sample we get
a couple of hundred thousand samples a

127
00:13:00,950 --> 00:13:07,399
day and we need to get through them and
33 seconds in a couple of hours to get

128
00:13:07,399 --> 00:13:13,920
through all of them know if we were to
sandbox them just a second

129
00:13:13,920 --> 00:13:20,050
our most recent work has been on the
easy 95 and the Altera FPGAs which have

130
00:13:20,050 --> 00:13:25,959
been a lot of fun to work with all
writing in OpenCL we got our operations

131
00:13:25,959 --> 00:13:31,018
down to about eighty eight risk
operations all integer math which gave

132
00:13:31,019 --> 00:13:37,410
us a computer in fragile point eight
eight so we're less than in less than an

133
00:13:37,410 --> 00:13:38,310
individual

134
00:13:38,310 --> 00:13:44,930
10 if we compare that to sandboxing we
get you know boxing is extracting

135
00:13:44,930 --> 00:13:50,270
features that you can learn whether or
not you want around five minutes

136
00:13:50,270 --> 00:13:54,520
sometimes twenty minutes ending on what
kinda counters you find your gonna run

137
00:13:54,520 --> 00:14:00,029
that a bunch of GM's we can work through
the problem of what it takes to do that

138
00:14:00,029 --> 00:14:03,649
for three hundred thousand samples which
you'd need like six hundred and twenty

139
00:14:03,649 --> 00:14:08,670
five samples analyzed per server
pronounced 480 servers running hundred

140
00:14:08,670 --> 00:14:14,630
GM's each which is 13 racks of year to
you servers and we figure we're running

141
00:14:14,630 --> 00:14:24,040
20 47 1810 just short of a mega want to
do that to sandbox that many samples and

142
00:14:24,040 --> 00:14:28,240
so one of the reasons I really like
fractals space-filling curves are

143
00:14:28,240 --> 00:14:33,220
fractal fractals are the kind of
mathematics that nature uses and nature

144
00:14:33,220 --> 00:14:39,670
uses that math because it is a very
special place in design

145
00:14:39,670 --> 00:14:44,819
so usually you hear your boss or maybe
you tell your boss I can either do it

146
00:14:44,820 --> 00:14:51,270
fast and cheap or I can do a cheap and
high quality but you can't pick 3 nature

147
00:14:51,270 --> 00:14:57,360
doesn't do that nature pics all three
and that's why using this kind of math

148
00:14:57,360 --> 00:15:03,730
is very useful it's also highly
paralyzing just like a lot of biology is

149
00:15:03,730 --> 00:15:10,780
and so you get all three you get quality
speed and efficiency and so when you put

150
00:15:10,780 --> 00:15:15,660
this together in trying to do analysis
for files it lets you focus on the

151
00:15:15,660 --> 00:15:19,689
unknown unknowns we get a filter for the
things that we really want to

152
00:15:19,690 --> 00:15:26,980
concentrate on and get to leave the rest
behind and so to work the three hundred

153
00:15:26,980 --> 00:15:34,630
thousand samples a day we get about
20,000 new clusters a day and 92% of the

154
00:15:34,630 --> 00:15:39,780
files we take in ingest are able to sit
in to establish clusters which means we

155
00:15:39,780 --> 00:15:44,360
don't have to go to work on that file as
we know what it's going to do we know

156
00:15:44,360 --> 00:15:50,930
it's like this other one that we've
already analyzed and so we have another

157
00:15:50,930 --> 00:15:58,120
80,000 files that are close to another
another cluster and so we inherit their

158
00:15:58,120 --> 00:16:03,040
property ins which leaves us about 4.8%
that we actually submit to sandboxes

159
00:16:03,040 --> 00:16:09,449
third-party analysis so this is a lot
like coffee right if you took away the

160
00:16:09,450 --> 00:16:12,380
costing from your department for your
company

161
00:16:12,380 --> 00:16:18,990
not much work would get done but if if
you let people use coffee it allows them

162
00:16:18,990 --> 00:16:24,940
to focus and that's what we're doing
here lets us focus it buys time to work

163
00:16:24,940 --> 00:16:26,310
on the things that are important

164
00:16:26,310 --> 00:16:30,969
facilitates accounting functions as an
indexer kind of sort and let you triage

165
00:16:30,970 --> 00:16:36,890
gave him the most important thing is
that you get an asymmetric advantage you

166
00:16:36,890 --> 00:16:40,410
remove your opponents asymmetric
advantage that they're using

167
00:16:40,410 --> 00:16:51,100
ng polymorph the code so that it gets by
Arno cystic needs and so once you've got

168
00:16:51,100 --> 00:16:57,699
a bunch of clusters you can as we've
shown earlier you can look at the

169
00:16:57,699 --> 00:17:02,079
clusters and find the areas that are not
changing and from that you can write a

170
00:17:02,079 --> 00:17:09,230
signature and so we have a whole bunch
of devices these companies companies

171
00:17:09,230 --> 00:17:13,849
that provide and there's many more that
provide capabilities for ingesting your

172
00:17:13,849 --> 00:17:19,849
signatures and so if you want to produce
your signatures or if you use these

173
00:17:19,849 --> 00:17:29,100
organizations you can take your
signatures and consumed

174
00:17:29,100 --> 00:17:34,980
and so research has been around trying
to produce more your signatures and I'll

175
00:17:34,980 --> 00:17:40,330
show you some examples where we can't it
doesn't work in every case but we can

176
00:17:40,330 --> 00:17:44,689
still clustering them we're trying to
get down to a hundred and 50

177
00:17:44,690 --> 00:17:51,070
microseconds per or per sample which
would be about a quarter of an

178
00:17:51,070 --> 00:17:59,049
influential and influential is about the
same amount of we measure in calories

179
00:17:59,049 --> 00:18:07,120
like food right so if those two there's
about 4,000 calories in a in a journal

180
00:18:07,120 --> 00:18:18,370
or maybe I've got them backwards there's
yes it's 40 per calorie incorrect me

181
00:18:18,370 --> 00:18:25,000
here gonna get it and so if we wanted to
relate to a piece of food it would be

182
00:18:25,000 --> 00:18:32,929
roughly if you could make the skin off
of a almond it would be part of that and

183
00:18:32,929 --> 00:18:39,120
so that's not bad to make a decision and
related to the heat billion food calorie

184
00:18:39,120 --> 00:18:52,469
so I'm gonna leave you with this one
which is my last movie is a win32 virus

185
00:18:52,470 --> 00:18:59,909
that likes to infect your land and moved
through your network and then it's used

186
00:18:59,909 --> 00:19:06,720
to deedar websites and you can see it's
pretty complicated on how they move the

187
00:19:06,720 --> 00:19:12,460
stuff around it's also not well detected
and there's thousands of these new and a

188
00:19:12,460 --> 00:19:19,950
but if we can custom it saves us work I
just think it's it's one of the more

189
00:19:19,950 --> 00:19:30,039
interesting looking viruses so contact
details thank you

