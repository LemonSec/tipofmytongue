1
00:00:02,640 --> 00:00:05,819
[Music]

2
00:00:08,800 --> 00:00:10,559
good afternoon everyone thanks for

3
00:00:10,559 --> 00:00:12,960
joining today we're going to talk about

4
00:00:12,960 --> 00:00:15,360
shadow pad one of the most successful

5
00:00:15,360 --> 00:00:17,840
paid back door in chinese espionage

6
00:00:17,840 --> 00:00:19,680
shadow pad was used as the primary

7
00:00:19,680 --> 00:00:22,080
backdoors of several infamous attacks

8
00:00:22,080 --> 00:00:24,400
including c-cleaner xyron and

9
00:00:24,400 --> 00:00:26,640
shadowhammer supply chain attacks

10
00:00:26,640 --> 00:00:28,480
in this talk we would like to address

11
00:00:28,480 --> 00:00:30,640
the following questions why did it

12
00:00:30,640 --> 00:00:32,800
become the primary choice in those high

13
00:00:32,800 --> 00:00:34,160
impact attacks

14
00:00:34,160 --> 00:00:36,399
what makes it so special in the pages of

15
00:00:36,399 --> 00:00:38,079
chinese espionage

16
00:00:38,079 --> 00:00:40,079
what threat actors are using shadowpad

17
00:00:40,079 --> 00:00:41,760
in their operations

18
00:00:41,760 --> 00:00:45,120
and ultimately how does the emergence of

19
00:00:45,120 --> 00:00:47,120
shadow pad impact the wider threat

20
00:00:47,120 --> 00:00:51,199
landscape from chinese aspirant actors

21
00:00:51,199 --> 00:00:53,280
i'm egen and now i'm a threat

22
00:00:53,280 --> 00:00:55,920
intelligence researcher at sentinel one

23
00:00:55,920 --> 00:00:58,480
i personally focus on malware analysis

24
00:00:58,480 --> 00:01:01,199
and chinese espionage campaign tracking

25
00:01:01,199 --> 00:01:03,920
prior to sentiment 1 i was a tire 3

26
00:01:03,920 --> 00:01:06,240
analyst to offer in-depth analysis to

27
00:01:06,240 --> 00:01:08,640
incident response cases

28
00:01:08,640 --> 00:01:11,280
together with me is joy chun he's a

29
00:01:11,280 --> 00:01:12,720
threat intelligence researcher at

30
00:01:12,720 --> 00:01:15,680
centon1 his major area of research

31
00:01:15,680 --> 00:01:18,000
includes incident response apd

32
00:01:18,000 --> 00:01:19,600
investigation

33
00:01:19,600 --> 00:01:21,439
malware analysis and cryptography

34
00:01:21,439 --> 00:01:24,080
analysis

35
00:01:24,560 --> 00:01:26,560
today we will start with some background

36
00:01:26,560 --> 00:01:28,560
history of shadow pad

37
00:01:28,560 --> 00:01:30,720
then we will dig into its technical

38
00:01:30,720 --> 00:01:32,640
details and the business model behind

39
00:01:32,640 --> 00:01:34,000
this back door

40
00:01:34,000 --> 00:01:36,240
after that we will introduce some of the

41
00:01:36,240 --> 00:01:38,720
threat actors who are using shadow pad

42
00:01:38,720 --> 00:01:40,640
at the end we will discuss how

43
00:01:40,640 --> 00:01:42,399
shadowpack changes the attacker's

44
00:01:42,399 --> 00:01:45,759
operations and the landscape

45
00:01:45,840 --> 00:01:47,680
before we jump into the details of

46
00:01:47,680 --> 00:01:49,600
shadowpad let's start from some

47
00:01:49,600 --> 00:01:52,880
historical background of it

48
00:01:52,880 --> 00:01:55,119
so what is shadowpad

49
00:01:55,119 --> 00:01:57,759
it's a modular backdoor which means it

50
00:01:57,759 --> 00:02:00,079
is formed of a bunch of plugins and it

51
00:02:00,079 --> 00:02:02,159
is in show code format

52
00:02:02,159 --> 00:02:04,079
every plugin contains a specific

53
00:02:04,079 --> 00:02:07,040
functionality and you can plug or unplug

54
00:02:07,040 --> 00:02:10,239
a plugin in memory from the cnc server

55
00:02:10,239 --> 00:02:12,319
this offer good extendability to

56
00:02:12,319 --> 00:02:15,120
shadowpad's functionality

57
00:02:15,120 --> 00:02:16,800
shutterpad has been used by some

58
00:02:16,800 --> 00:02:19,360
high-profile threat actors and it was

59
00:02:19,360 --> 00:02:21,280
used in those campaigns as one of the

60
00:02:21,280 --> 00:02:24,000
primary backdoors for intrusion

61
00:02:24,000 --> 00:02:26,080
for example it appeared in some

62
00:02:26,080 --> 00:02:27,520
well-known supply chain attacks

63
00:02:27,520 --> 00:02:31,040
conducted by abd-41 including net sauron

64
00:02:31,040 --> 00:02:34,239
shadowhammer and alleged c cleaner

65
00:02:34,239 --> 00:02:36,959
another another high-profile group tick

66
00:02:36,959 --> 00:02:39,519
and tonto team also used it to attack

67
00:02:39,519 --> 00:02:42,000
japan aerospace exploration agency and

68
00:02:42,000 --> 00:02:43,280
other victims

69
00:02:43,280 --> 00:02:46,959
we will cover more details later

70
00:02:47,040 --> 00:02:49,280
when we try trace back to the emergence

71
00:02:49,280 --> 00:02:51,599
of shadow pad we need to spend some time

72
00:02:51,599 --> 00:02:53,840
discussing another back door called plug

73
00:02:53,840 --> 00:02:54,800
x

74
00:02:54,800 --> 00:02:57,040
plug x is also a plugin based backdoor

75
00:02:57,040 --> 00:02:58,800
in show called format

76
00:02:58,800 --> 00:03:00,800
the major difference between plug x and

77
00:03:00,800 --> 00:03:03,519
shadow pad is that the plugins of plug x

78
00:03:03,519 --> 00:03:05,760
cannot be plugged or unplugged during

79
00:03:05,760 --> 00:03:07,440
runtime

80
00:03:07,440 --> 00:03:10,640
regarding the use of these two backdoors

81
00:03:10,640 --> 00:03:12,640
shadowpad is only shared beyond this

82
00:03:12,640 --> 00:03:14,959
limited set of users based on our

83
00:03:14,959 --> 00:03:15,920
knowledge

84
00:03:15,920 --> 00:03:18,480
while plugx is widely used and sold to

85
00:03:18,480 --> 00:03:21,760
different people in public

86
00:03:22,080 --> 00:03:23,840
what's the relationship between these

87
00:03:23,840 --> 00:03:25,519
two backdoors

88
00:03:25,519 --> 00:03:27,120
there are already some reports that

89
00:03:27,120 --> 00:03:29,599
discuss their code similarity and we

90
00:03:29,599 --> 00:03:32,400
will not cover more on this part here

91
00:03:32,400 --> 00:03:35,680
we discovered another piece of evidence

92
00:03:35,680 --> 00:03:38,480
actually plug x and shadow pad share the

93
00:03:38,480 --> 00:03:41,040
same project name sc

94
00:03:41,040 --> 00:03:43,519
we extracted the pdb strings of the

95
00:03:43,519 --> 00:03:46,480
controllers and you can see s controller

96
00:03:46,480 --> 00:03:48,319
and sc in them

97
00:03:48,319 --> 00:03:50,480
this suggests that shadowpad is highly

98
00:03:50,480 --> 00:03:52,959
likely the successor project of

99
00:03:52,959 --> 00:03:57,519
of plugx with a related project base

100
00:03:57,519 --> 00:04:00,319
if we dig deeper to the author of plug x

101
00:04:00,319 --> 00:04:03,439
we can trace back to the name whg aka

102
00:04:03,439 --> 00:04:04,560
waku

103
00:04:04,560 --> 00:04:07,120
he was based in sichuan china

104
00:04:07,120 --> 00:04:09,120
and he was an experienced programmer

105
00:04:09,120 --> 00:04:10,879
with deep knowledge of backdoors and

106
00:04:10,879 --> 00:04:12,400
hacking tools

107
00:04:12,400 --> 00:04:15,280
according to a report from atnt his

108
00:04:15,280 --> 00:04:19,279
nickname showed up in some plug examples

109
00:04:19,279 --> 00:04:21,680
besides he claimed that he was selling

110
00:04:21,680 --> 00:04:23,919
some shared software on his personal

111
00:04:23,919 --> 00:04:26,720
website back in 2006.

112
00:04:26,720 --> 00:04:29,280
it means that he was used to monetizing

113
00:04:29,280 --> 00:04:31,199
his malware development skills and the

114
00:04:31,199 --> 00:04:33,199
programs he produced

115
00:04:33,199 --> 00:04:35,040
also he was sharing some deep

116
00:04:35,040 --> 00:04:36,800
connections with one of the biggest

117
00:04:36,800 --> 00:04:38,080
users of

118
00:04:38,080 --> 00:04:40,960
shadowpad apd-41 and we would address

119
00:04:40,960 --> 00:04:43,840
this later

120
00:04:44,800 --> 00:04:46,960
after the background introduction we can

121
00:04:46,960 --> 00:04:49,840
move to something more technical

122
00:04:49,840 --> 00:04:52,240
as i mentioned earlier shadowpad is a

123
00:04:52,240 --> 00:04:53,919
modular design

124
00:04:53,919 --> 00:04:56,080
it is formed of a bunch of plugins with

125
00:04:56,080 --> 00:04:58,479
different functionalities inside

126
00:04:58,479 --> 00:05:01,360
this picture shows a brief concept

127
00:05:01,360 --> 00:05:03,840
first there is a layer of affascated

128
00:05:03,840 --> 00:05:05,440
show called loader

129
00:05:05,440 --> 00:05:07,440
it decrypts and loads a plugin called

130
00:05:07,440 --> 00:05:08,639
root

131
00:05:08,639 --> 00:05:10,800
you can easily tell what root is by its

132
00:05:10,800 --> 00:05:11,759
name

133
00:05:11,759 --> 00:05:14,320
this is the a very basic plugin to

134
00:05:14,320 --> 00:05:16,880
decrypt and load other plugins which are

135
00:05:16,880 --> 00:05:19,039
embedded inside the samples

136
00:05:19,039 --> 00:05:19,919
and

137
00:05:19,919 --> 00:05:22,000
it contains the block of encrypted

138
00:05:22,000 --> 00:05:24,320
configurations

139
00:05:24,320 --> 00:05:26,880
the plugins will be loaded into memory

140
00:05:26,880 --> 00:05:28,639
and they will be kept in a linked list

141
00:05:28,639 --> 00:05:30,639
for further reference

142
00:05:30,639 --> 00:05:32,560
on the right is the structure of a

143
00:05:32,560 --> 00:05:35,199
plugin node in the linked list

144
00:05:35,199 --> 00:05:37,280
there is some metadata like the

145
00:05:37,280 --> 00:05:40,160
timestamp of a plugin the plugin id the

146
00:05:40,160 --> 00:05:42,320
size the base memory address of the

147
00:05:42,320 --> 00:05:45,680
plugin and export function table

148
00:05:45,680 --> 00:05:47,600
aside from the plugins embedded in the

149
00:05:47,600 --> 00:05:49,840
sample additional plugins could be

150
00:05:49,840 --> 00:05:51,759
uploaded to the infected host from the

151
00:05:51,759 --> 00:05:53,520
cnc servers

152
00:05:53,520 --> 00:05:56,160
for example if the disk plugin is not

153
00:05:56,160 --> 00:05:58,000
embedded inside the sample at the first

154
00:05:58,000 --> 00:05:58,880
place

155
00:05:58,880 --> 00:06:01,199
after shadowpad connects back to the cnc

156
00:06:01,199 --> 00:06:03,840
server the attacker can upload the disk

157
00:06:03,840 --> 00:06:06,479
plugin through the controller the plugin

158
00:06:06,479 --> 00:06:08,960
will be sent to the infected computer

159
00:06:08,960 --> 00:06:11,039
and the backdoor will decrypt it load it

160
00:06:11,039 --> 00:06:12,880
into the memory and store it in the

161
00:06:12,880 --> 00:06:14,720
linked list as well

162
00:06:14,720 --> 00:06:17,919
this gives the user a big a big factor

163
00:06:17,919 --> 00:06:20,160
flexibility to add plugins whenever they

164
00:06:20,160 --> 00:06:22,400
need

165
00:06:22,479 --> 00:06:24,800
from the sample sets we collected we got

166
00:06:24,800 --> 00:06:26,960
22 unique plugins

167
00:06:26,960 --> 00:06:30,400
i briefly divide the plugins to two sets

168
00:06:30,400 --> 00:06:32,720
the first set is basic set

169
00:06:32,720 --> 00:06:34,960
this set of plugins covers the routine

170
00:06:34,960 --> 00:06:37,039
from the installation of the shadow pad

171
00:06:37,039 --> 00:06:38,479
like decrypting

172
00:06:38,479 --> 00:06:40,560
configuration installing it for

173
00:06:40,560 --> 00:06:43,120
persistency and firing back the first

174
00:06:43,120 --> 00:06:46,080
become connection back to the cnc server

175
00:06:46,080 --> 00:06:48,960
in other words with this set of plugins

176
00:06:48,960 --> 00:06:50,720
the backdoor can build the connection

177
00:06:50,720 --> 00:06:52,479
with the cnc servers

178
00:06:52,479 --> 00:06:54,639
but at this moment it will not contain

179
00:06:54,639 --> 00:06:58,080
any other backdoor functionalities

180
00:06:58,080 --> 00:07:00,479
the second set is utilities

181
00:07:00,479 --> 00:07:02,800
this set contains the plugins with all

182
00:07:02,800 --> 00:07:05,199
kinds of backdoor functionalities such

183
00:07:05,199 --> 00:07:07,840
as browsing disks managing services and

184
00:07:07,840 --> 00:07:10,960
registries executing show commands

185
00:07:10,960 --> 00:07:14,319
key logging screen control and so on

186
00:07:14,319 --> 00:07:16,720
only with this plugins shadowpad can

187
00:07:16,720 --> 00:07:18,160
present the functionalities of a

188
00:07:18,160 --> 00:07:19,360
backdoor

189
00:07:19,360 --> 00:07:22,639
so to use shadowpad the users need to

190
00:07:22,639 --> 00:07:26,319
have utility plugins

191
00:07:26,720 --> 00:07:29,360
regarding the configuration this table

192
00:07:29,360 --> 00:07:30,720
shows all the columns in the

193
00:07:30,720 --> 00:07:32,240
configuration

194
00:07:32,240 --> 00:07:34,960
the first two columns of set product key

195
00:07:34,960 --> 00:07:37,440
and offset nodes are the identifiers of

196
00:07:37,440 --> 00:07:38,800
the campaign

197
00:07:38,800 --> 00:07:41,199
they could be randomly generated

198
00:07:41,199 --> 00:07:43,520
and later comes the binary path the

199
00:07:43,520 --> 00:07:46,400
service settings and run key registries

200
00:07:46,400 --> 00:07:48,400
the default name of the service is my

201
00:07:48,400 --> 00:07:49,280
test

202
00:07:49,280 --> 00:07:51,280
this could be a useful indicator to

203
00:07:51,280 --> 00:07:53,039
check shadow pad infections in some

204
00:07:53,039 --> 00:07:54,240
cases

205
00:07:54,240 --> 00:07:57,120
and there comes the spawn process to do

206
00:07:57,120 --> 00:07:59,840
code injections cnc servers proxy types

207
00:07:59,840 --> 00:08:02,479
and dns

208
00:08:02,479 --> 00:08:05,360
in 2020 another new version of shadowpad

209
00:08:05,360 --> 00:08:07,919
was found by positive technologies

210
00:08:07,919 --> 00:08:09,759
the infection chain of the new version

211
00:08:09,759 --> 00:08:12,240
includes three components

212
00:08:12,240 --> 00:08:14,319
the first one is the legitimate

213
00:08:14,319 --> 00:08:15,440
legitimate

214
00:08:15,440 --> 00:08:18,800
executable log.exe and it will site load

215
00:08:18,800 --> 00:08:22,479
an obfuscated loader called log.dll

216
00:08:22,479 --> 00:08:24,560
this loader will then read and decrypt

217
00:08:24,560 --> 00:08:27,680
another piece of payload lock.dat

218
00:08:27,680 --> 00:08:30,960
log.d8t is the manual code of shadowpad

219
00:08:30,960 --> 00:08:33,279
which is also obfuscated with the same

220
00:08:33,279 --> 00:08:34,640
technique

221
00:08:34,640 --> 00:08:36,958
besides the sample is obfuscated with

222
00:08:36,958 --> 00:08:39,200
control flow flattening technique this

223
00:08:39,200 --> 00:08:41,200
is the new application technique on

224
00:08:41,200 --> 00:08:45,120
shadow pad which we didn't see before

225
00:08:45,120 --> 00:08:47,040
the configuration of this new version

226
00:08:47,040 --> 00:08:49,040
looks pretty similar to the previous

227
00:08:49,040 --> 00:08:51,600
version except that it includes more

228
00:08:51,600 --> 00:08:54,000
details of the infection chain so as

229
00:08:54,000 --> 00:08:56,080
here shows there are columns for the

230
00:08:56,080 --> 00:08:58,480
installation directory the legitimate

231
00:08:58,480 --> 00:09:01,440
executable name the load the loader name

232
00:09:01,440 --> 00:09:04,320
and the payload name

233
00:09:04,640 --> 00:09:06,640
next we are going to introduce one

234
00:09:06,640 --> 00:09:08,959
version of the shadow pack controllers

235
00:09:08,959 --> 00:09:10,880
we discovered it in an attacker's

236
00:09:10,880 --> 00:09:13,920
hacking package through private research

237
00:09:13,920 --> 00:09:16,000
this controller helps us a lot in this

238
00:09:16,000 --> 00:09:18,399
research because it allows us to get a

239
00:09:18,399 --> 00:09:21,040
much closer look at how shadowpad works

240
00:09:21,040 --> 00:09:23,920
and how it was originally designed

241
00:09:23,920 --> 00:09:27,279
this is version 1.0 in 2015.

242
00:09:27,279 --> 00:09:29,360
it was written in delphi and the

243
00:09:29,360 --> 00:09:31,360
controller contains both the binary

244
00:09:31,360 --> 00:09:35,200
builder and the cnc listener at in1

245
00:09:35,200 --> 00:09:37,200
the shadow pad samples built by this

246
00:09:37,200 --> 00:09:39,120
controller are a little bit simpler than

247
00:09:39,120 --> 00:09:40,800
the later version

248
00:09:40,800 --> 00:09:42,880
but the samples are already constructed

249
00:09:42,880 --> 00:09:44,560
in a very much similar way to the

250
00:09:44,560 --> 00:09:48,320
samples after 2017.

251
00:09:48,320 --> 00:09:50,480
by right clicking on any single

252
00:09:50,480 --> 00:09:52,480
infection host we will enter the

253
00:09:52,480 --> 00:09:55,200
measurement console of the back door

254
00:09:55,200 --> 00:09:57,120
so first you will see the default plugin

255
00:09:57,120 --> 00:09:57,920
list

256
00:09:57,920 --> 00:09:59,839
these plugins are the plugins which are

257
00:09:59,839 --> 00:10:02,000
embedded inside the backdoor samples by

258
00:10:02,000 --> 00:10:03,680
default

259
00:10:03,680 --> 00:10:05,920
if you want to use other plugins you

260
00:10:05,920 --> 00:10:08,160
need to right click the console choose

261
00:10:08,160 --> 00:10:10,959
add and import the plugins

262
00:10:10,959 --> 00:10:13,680
then the plugins will be uploaded

263
00:10:13,680 --> 00:10:15,680
after that you will see the uploaded

264
00:10:15,680 --> 00:10:18,079
plugins in red and you can start using

265
00:10:18,079 --> 00:10:21,279
those plugins with the menu on the left

266
00:10:21,279 --> 00:10:23,440
to be noted you can only upload the

267
00:10:23,440 --> 00:10:25,760
plugins but the list of the control

268
00:10:25,760 --> 00:10:28,480
interface interface is fixed

269
00:10:28,480 --> 00:10:30,880
so even if you have an additional plugin

270
00:10:30,880 --> 00:10:33,360
like a plug-in pipe here you still

271
00:10:33,360 --> 00:10:35,600
cannot use it because there is no

272
00:10:35,600 --> 00:10:39,600
control interface of pipe in the list

273
00:10:40,079 --> 00:10:42,480
then here comes the builder the builder

274
00:10:42,480 --> 00:10:44,720
allows us to configure different columns

275
00:10:44,720 --> 00:10:46,880
like campaign codes and nodes

276
00:10:46,880 --> 00:10:49,680
they can also be randomly generated

277
00:10:49,680 --> 00:10:51,680
and then there are some anti-debugging

278
00:10:51,680 --> 00:10:52,560
set

279
00:10:52,560 --> 00:10:54,480
debugging settings and the installation

280
00:10:54,480 --> 00:10:55,760
settings

281
00:10:55,760 --> 00:10:57,920
also we can modify the process to be

282
00:10:57,920 --> 00:11:00,480
spawned and injected during runtime

283
00:11:00,480 --> 00:11:02,560
of course we can add the cnc servers

284
00:11:02,560 --> 00:11:05,519
with different protocols to connect

285
00:11:05,519 --> 00:11:07,600
after we finish the settings we can

286
00:11:07,600 --> 00:11:09,680
export the current settings and import

287
00:11:09,680 --> 00:11:11,600
them next time

288
00:11:11,600 --> 00:11:13,519
and then we can build it

289
00:11:13,519 --> 00:11:15,760
there's an option to build it as an

290
00:11:15,760 --> 00:11:18,800
executable but the loader is pretty dumb

291
00:11:18,800 --> 00:11:20,880
and we didn't source any samples with

292
00:11:20,880 --> 00:11:22,480
this loader

293
00:11:22,480 --> 00:11:24,240
this function might be improved in the

294
00:11:24,240 --> 00:11:26,640
later version but it seems that most of

295
00:11:26,640 --> 00:11:28,720
the users only generate show code and

296
00:11:28,720 --> 00:11:31,839
use their own loaders

297
00:11:32,320 --> 00:11:34,320
the discovery of the controller allows

298
00:11:34,320 --> 00:11:36,640
us to check more deeply on how shadowpad

299
00:11:36,640 --> 00:11:38,800
works from the attacker side

300
00:11:38,800 --> 00:11:40,880
in the next section we are going to

301
00:11:40,880 --> 00:11:43,279
introduce the ecosystem and the business

302
00:11:43,279 --> 00:11:45,120
model behind shadowpad from our

303
00:11:45,120 --> 00:11:48,560
observation and assessment

304
00:11:48,640 --> 00:11:50,160
let's start from the structure of the

305
00:11:50,160 --> 00:11:51,440
controller

306
00:11:51,440 --> 00:11:54,320
the plugins are placed in a directory

307
00:11:54,320 --> 00:11:56,160
whenever the user needs to upload a

308
00:11:56,160 --> 00:11:58,560
plugin they can choose the one they need

309
00:11:58,560 --> 00:12:00,320
from the directory

310
00:12:00,320 --> 00:12:02,160
so in theory

311
00:12:02,160 --> 00:12:04,320
any plugin encrypted and compressed in

312
00:12:04,320 --> 00:12:07,040
the correct format could be uploaded

313
00:12:07,040 --> 00:12:09,440
if anyone wants to add a new plugin he

314
00:12:09,440 --> 00:12:11,760
or she can develop one and upload it to

315
00:12:11,760 --> 00:12:14,160
the client side

316
00:12:14,160 --> 00:12:16,959
but in practice the user needs an

317
00:12:16,959 --> 00:12:18,880
interface on the controller to interact

318
00:12:18,880 --> 00:12:20,720
with the plugins

319
00:12:20,720 --> 00:12:23,120
when we track the controller we will see

320
00:12:23,120 --> 00:12:25,920
those interfaces listed on the left and

321
00:12:25,920 --> 00:12:28,079
there is no option to upload a new

322
00:12:28,079 --> 00:12:30,639
interface from any new plugin

323
00:12:30,639 --> 00:12:32,720
this means that the controller is not

324
00:12:32,720 --> 00:12:35,040
designed to accept new plugins

325
00:12:35,040 --> 00:12:37,360
the list of available plugins is highly

326
00:12:37,360 --> 00:12:40,320
controlled by the developer

327
00:12:40,320 --> 00:12:42,880
based on the controller we now know that

328
00:12:42,880 --> 00:12:44,560
shadowpad is not designed to be

329
00:12:44,560 --> 00:12:46,959
extendable by a random user

330
00:12:46,959 --> 00:12:48,160
the develop

331
00:12:48,160 --> 00:12:50,240
the developer controls which plugins

332
00:12:50,240 --> 00:12:53,120
could be added and used so shadowhead is

333
00:12:53,120 --> 00:12:56,000
not an open framework like metasploit to

334
00:12:56,000 --> 00:12:59,680
accept other self-developed plugins

335
00:12:59,680 --> 00:13:01,680
then why is it designed to be a plugin

336
00:13:01,680 --> 00:13:04,079
based malware and allows remote upload

337
00:13:04,079 --> 00:13:05,680
to the plugins

338
00:13:05,680 --> 00:13:08,399
probably it is because the developer can

339
00:13:08,399 --> 00:13:10,560
easily control the plugins to be used by

340
00:13:10,560 --> 00:13:12,320
the any user

341
00:13:12,320 --> 00:13:14,480
if a developer wants to remove certain

342
00:13:14,480 --> 00:13:17,120
functionalities he or she only needs to

343
00:13:17,120 --> 00:13:19,519
remove that plugin from the directory

344
00:13:19,519 --> 00:13:21,279
and does not need to recompile the

345
00:13:21,279 --> 00:13:24,480
controller and the malware again

346
00:13:24,480 --> 00:13:26,880
next let's check the plugins embedded

347
00:13:26,880 --> 00:13:28,480
inside the samples

348
00:13:28,480 --> 00:13:30,959
as i described beforehand there are some

349
00:13:30,959 --> 00:13:32,880
plugins embedded in the sample by

350
00:13:32,880 --> 00:13:35,440
default and additional plugins can be

351
00:13:35,440 --> 00:13:38,399
uploaded remotely later on

352
00:13:38,399 --> 00:13:41,040
we plot the plugin numbers across around

353
00:13:41,040 --> 00:13:43,199
100 samples

354
00:13:43,199 --> 00:13:45,680
as you can see most of the samples only

355
00:13:45,680 --> 00:13:48,079
contain less than 9 plugins and the

356
00:13:48,079 --> 00:13:51,040
plugins are the basic set including root

357
00:13:51,040 --> 00:13:53,920
plugins config extol online and the

358
00:13:53,920 --> 00:13:56,399
plugins for cnc communication

359
00:13:56,399 --> 00:13:58,880
this plugin can can only finish the

360
00:13:58,880 --> 00:14:00,800
installation and send the bcom to the

361
00:14:00,800 --> 00:14:02,639
cnc servers

362
00:14:02,639 --> 00:14:04,480
no other functionalities could be

363
00:14:04,480 --> 00:14:05,680
presented

364
00:14:05,680 --> 00:14:07,600
if the attackers want to use other

365
00:14:07,600 --> 00:14:09,839
functions they need to upload those

366
00:14:09,839 --> 00:14:13,199
plugins from the cnc servers

367
00:14:13,199 --> 00:14:15,440
other two distributions are both special

368
00:14:15,440 --> 00:14:16,560
cases

369
00:14:16,560 --> 00:14:19,120
the samples with 10 plugins are special

370
00:14:19,120 --> 00:14:21,600
version packed with vm protect

371
00:14:21,600 --> 00:14:23,120
and all of the plugins are with

372
00:14:23,120 --> 00:14:25,120
different plugin ids

373
00:14:25,120 --> 00:14:26,720
the samples might have been used by

374
00:14:26,720 --> 00:14:29,600
ipd41 for some campaigns including

375
00:14:29,600 --> 00:14:31,839
shadowhammer

376
00:14:31,839 --> 00:14:34,000
the final category is the sample with

377
00:14:34,000 --> 00:14:36,000
additional utility plugins embedded

378
00:14:36,000 --> 00:14:38,639
inside which means the attackers by

379
00:14:38,639 --> 00:14:41,120
default can use those plugins

380
00:14:41,120 --> 00:14:43,120
they do not need to upload those plugins

381
00:14:43,120 --> 00:14:44,639
manually

382
00:14:44,639 --> 00:14:46,720
the samples in this category are all

383
00:14:46,720 --> 00:14:48,959
packed by the same packers while the

384
00:14:48,959 --> 00:14:50,880
packers seem not to be provided by

385
00:14:50,880 --> 00:14:53,519
default with the shadow pad builders

386
00:14:53,519 --> 00:14:55,680
the users of this set of samples might

387
00:14:55,680 --> 00:14:57,360
have been some people with high

388
00:14:57,360 --> 00:14:59,839
privileged access to shadowpad

389
00:14:59,839 --> 00:15:02,320
and the developer of shadowpad provides

390
00:15:02,320 --> 00:15:04,399
them a special version of builder to

391
00:15:04,399 --> 00:15:06,880
build the samples with utility plugins

392
00:15:06,880 --> 00:15:09,839
embedded inside

393
00:15:09,920 --> 00:15:12,320
from the above observation we can see

394
00:15:12,320 --> 00:15:14,560
that most of the samples do not have

395
00:15:14,560 --> 00:15:17,199
utility plugins embedded inside

396
00:15:17,199 --> 00:15:20,079
the users need to upload other plugins

397
00:15:20,079 --> 00:15:22,240
other utility plugins remotely through

398
00:15:22,240 --> 00:15:24,399
the controller and as i mentioned

399
00:15:24,399 --> 00:15:26,560
earlier the plugins can be easily

400
00:15:26,560 --> 00:15:28,720
removed from the package you just need

401
00:15:28,720 --> 00:15:31,519
to remove them from the directory

402
00:15:31,519 --> 00:15:34,399
besides we found tick use the tool with

403
00:15:34,399 --> 00:15:36,240
the same functionality of the plugin

404
00:15:36,240 --> 00:15:38,320
called software in an overlapped time

405
00:15:38,320 --> 00:15:39,360
frame

406
00:15:39,360 --> 00:15:41,440
tick was one of the active users of

407
00:15:41,440 --> 00:15:43,759
shadowpad and started to have access to

408
00:15:43,759 --> 00:15:46,800
shadowpad from atlas 2018

409
00:15:46,800 --> 00:15:48,560
while they used shadowpad as the man

410
00:15:48,560 --> 00:15:51,040
backdoor for intrusion they sometimes

411
00:15:51,040 --> 00:15:53,360
still develop some small tools

412
00:15:53,360 --> 00:15:55,839
we discovered a tool from them to list

413
00:15:55,839 --> 00:15:57,519
off the installed software on the

414
00:15:57,519 --> 00:16:00,399
infected host but around the same time

415
00:16:00,399 --> 00:16:02,320
shadowpad already had a plugin called

416
00:16:02,320 --> 00:16:05,759
software which did exactly the same

417
00:16:05,759 --> 00:16:08,480
by this we can assess that tech do not

418
00:16:08,480 --> 00:16:11,120
have access to that plugin and that was

419
00:16:11,120 --> 00:16:13,279
why they need to develop another tool

420
00:16:13,279 --> 00:16:16,240
for the same purpose

421
00:16:16,399 --> 00:16:18,399
so the plugins should be provided

422
00:16:18,399 --> 00:16:19,680
separately

423
00:16:19,680 --> 00:16:21,759
the developer of shadowpad could decide

424
00:16:21,759 --> 00:16:23,839
which plugins they are going to give to

425
00:16:23,839 --> 00:16:25,040
the users

426
00:16:25,040 --> 00:16:27,120
and not all of the users have access to

427
00:16:27,120 --> 00:16:28,800
all of the plugins

428
00:16:28,800 --> 00:16:31,360
at the same time they also offer special

429
00:16:31,360 --> 00:16:33,199
versions of shadowpad builder to high

430
00:16:33,199 --> 00:16:35,839
privileged users which allow them to

431
00:16:35,839 --> 00:16:38,560
build samples samples with more plugins

432
00:16:38,560 --> 00:16:41,758
embedded by default

433
00:16:42,240 --> 00:16:44,079
so here is the brief summary of the

434
00:16:44,079 --> 00:16:46,079
potential business model behind shadow

435
00:16:46,079 --> 00:16:47,120
pad

436
00:16:47,120 --> 00:16:49,759
first of all it is highly likely a sold

437
00:16:49,759 --> 00:16:50,800
malware

438
00:16:50,800 --> 00:16:54,079
its ancestor plugx was a sold malware

439
00:16:54,079 --> 00:16:56,639
while the author also had demonstrative

440
00:16:56,639 --> 00:16:58,800
records of selling malware and tools to

441
00:16:58,800 --> 00:17:00,000
others

442
00:17:00,000 --> 00:17:02,560
but shadowpad should only be accessed by

443
00:17:02,560 --> 00:17:04,400
a limited set of users

444
00:17:04,400 --> 00:17:06,480
we do not see a wide distribution like

445
00:17:06,480 --> 00:17:08,959
the case of plug x

446
00:17:08,959 --> 00:17:11,439
besides the utility plugins need to be

447
00:17:11,439 --> 00:17:13,199
bought separately

448
00:17:13,199 --> 00:17:15,280
the developer does not provide all of

449
00:17:15,280 --> 00:17:17,359
the available plugins to the users by

450
00:17:17,359 --> 00:17:18,480
default

451
00:17:18,480 --> 00:17:20,799
and sometimes he or she offers special

452
00:17:20,799 --> 00:17:24,079
versions to some high privileged users

453
00:17:24,079 --> 00:17:26,559
also shadowpath is only provided to a

454
00:17:26,559 --> 00:17:29,440
limited set of users as we do not see a

455
00:17:29,440 --> 00:17:31,520
wide distribution like plugx during our

456
00:17:31,520 --> 00:17:33,840
study

457
00:17:34,960 --> 00:17:37,120
thanks egen for sharing those technical

458
00:17:37,120 --> 00:17:39,600
details about shadowpad next we are

459
00:17:39,600 --> 00:17:41,120
going to discuss

460
00:17:41,120 --> 00:17:46,120
who have sx 2 shadowhead

461
00:17:46,480 --> 00:17:48,720
as we mentioned before shadow pad is

462
00:17:48,720 --> 00:17:50,799
sold privately to a limited set of

463
00:17:50,799 --> 00:17:52,080
customers

464
00:17:52,080 --> 00:17:54,480
we identified at least five activity

465
00:17:54,480 --> 00:17:58,559
actors that using shadowpad since 2017

466
00:17:58,559 --> 00:18:01,440
including apt-41 ticket downloading

467
00:18:01,440 --> 00:18:04,400
operation rate bonus operation rate kaku

468
00:18:04,400 --> 00:18:06,480
and fishmonger

469
00:18:06,480 --> 00:18:08,880
some other vendors also mentioned other

470
00:18:08,880 --> 00:18:11,280
potential users of shadowpad

471
00:18:11,280 --> 00:18:13,679
including lucky mouse and the tropic

472
00:18:13,679 --> 00:18:15,120
trooper

473
00:18:15,120 --> 00:18:17,360
but we don't have the visibility on

474
00:18:17,360 --> 00:18:18,880
those parts

475
00:18:18,880 --> 00:18:22,320
so in this section we will only focus on

476
00:18:22,320 --> 00:18:26,760
those five actors activities

477
00:18:28,000 --> 00:18:30,559
the first one is apd41

478
00:18:30,559 --> 00:18:34,320
apd41 is the accept naming convention

479
00:18:34,320 --> 00:18:35,520
of the

480
00:18:35,520 --> 00:18:38,480
activities conducted by two subgroups

481
00:18:38,480 --> 00:18:40,160
barium and lead

482
00:18:40,160 --> 00:18:42,480
some of the actors were identified by

483
00:18:42,480 --> 00:18:46,400
the u.s department of justice in 2020

484
00:18:46,400 --> 00:18:49,679
all of the defendants were based in

485
00:18:49,679 --> 00:18:52,640
chengdu sinchon

486
00:18:52,640 --> 00:18:55,440
barium was one of the

487
00:18:55,440 --> 00:18:58,240
most earliest threat groups that got

488
00:18:58,240 --> 00:19:01,120
access to shadow pad

489
00:19:01,120 --> 00:19:03,760
the primary attack company is the gaming

490
00:19:03,760 --> 00:19:06,160
industry

491
00:19:06,160 --> 00:19:08,160
and they also conduct several supply

492
00:19:08,160 --> 00:19:09,440
chain attack

493
00:19:09,440 --> 00:19:12,640
including nasaram shadowhammer and the

494
00:19:12,640 --> 00:19:14,799
cc cleaner

495
00:19:14,799 --> 00:19:16,799
in shadowhammer instant

496
00:19:16,799 --> 00:19:18,799
the sample of shadowpad were highly

497
00:19:18,799 --> 00:19:20,559
customized

498
00:19:20,559 --> 00:19:23,520
compared to other shadowpad samples

499
00:19:23,520 --> 00:19:26,000
every layer of shadow code and the

500
00:19:26,000 --> 00:19:27,440
plugin

501
00:19:27,440 --> 00:19:30,320
was packed with vmprotect

502
00:19:30,320 --> 00:19:33,280
and the plugins had a different set of

503
00:19:33,280 --> 00:19:35,440
plugin ids

504
00:19:35,440 --> 00:19:37,760
another subgroup lead

505
00:19:37,760 --> 00:19:39,760
also used shadow pad

506
00:19:39,760 --> 00:19:41,520
and other backdoors

507
00:19:41,520 --> 00:19:44,080
to attack victims

508
00:19:44,080 --> 00:19:46,640
for both financial and exponential

509
00:19:46,640 --> 00:19:49,120
purpose

510
00:19:50,480 --> 00:19:53,679
one of the actors wrote aka dialing

511
00:19:53,679 --> 00:19:54,720
megwe

512
00:19:54,720 --> 00:19:58,240
were used to cooperating with whg

513
00:19:58,240 --> 00:20:01,440
who is the author of plug x we mentioned

514
00:20:01,440 --> 00:20:02,799
before

515
00:20:02,799 --> 00:20:04,840
they developed some malwares

516
00:20:04,840 --> 00:20:07,280
together back in the days

517
00:20:07,280 --> 00:20:08,559
rose

518
00:20:08,559 --> 00:20:14,320
was a member of the hacking group ncph

519
00:20:14,960 --> 00:20:17,840
so what is ncph

520
00:20:17,840 --> 00:20:20,559
ncph was a hacking group

521
00:20:20,559 --> 00:20:22,480
founded by rose and his friend in

522
00:20:22,480 --> 00:20:24,000
chengdu

523
00:20:24,000 --> 00:20:28,240
ncph means network cracking program and

524
00:20:28,240 --> 00:20:30,000
hacking

525
00:20:30,000 --> 00:20:32,400
they released some malwares and hacking

526
00:20:32,400 --> 00:20:34,640
tools on their website

527
00:20:34,640 --> 00:20:35,919
for example

528
00:20:35,919 --> 00:20:38,320
they released a series of

529
00:20:38,320 --> 00:20:41,679
remote access trojans called ncph remote

530
00:20:41,679 --> 00:20:43,840
control software

531
00:20:43,840 --> 00:20:46,000
the controller and the builder were

532
00:20:46,000 --> 00:20:50,320
freely shared on ncph website

533
00:20:50,320 --> 00:20:52,799
but they also declared the source code

534
00:20:52,799 --> 00:20:55,039
on sale

535
00:20:55,039 --> 00:20:56,559
ncph

536
00:20:56,559 --> 00:20:59,280
remote control software was code

537
00:20:59,280 --> 00:21:02,640
developed by rose and whg they put their

538
00:21:02,640 --> 00:21:06,320
name on the controller

539
00:21:07,120 --> 00:21:09,760
rose and whg both had great malware

540
00:21:09,760 --> 00:21:12,080
development skills and

541
00:21:12,080 --> 00:21:14,840
were well known in chinese hacking

542
00:21:14,840 --> 00:21:17,919
community as you can see

543
00:21:17,919 --> 00:21:20,480
they both were used to monetize their

544
00:21:20,480 --> 00:21:22,480
software and the malware development

545
00:21:22,480 --> 00:21:24,960
skills

546
00:21:25,360 --> 00:21:27,600
considering the long-term affiliation

547
00:21:27,600 --> 00:21:30,400
relationship between rose and wg

548
00:21:30,400 --> 00:21:32,960
we suspect that rose likely had high

549
00:21:32,960 --> 00:21:35,360
privileged access to shadowhead

550
00:21:35,360 --> 00:21:37,840
or he might have even

551
00:21:37,840 --> 00:21:40,720
been a code developer

552
00:21:40,720 --> 00:21:43,440
this could also explain why rose was

553
00:21:43,440 --> 00:21:45,840
able to use a special version of shadow

554
00:21:45,840 --> 00:21:49,918
pad in some of the attacks

555
00:21:51,280 --> 00:21:53,520
here is another group's tick and tango

556
00:21:53,520 --> 00:21:54,799
team

557
00:21:54,799 --> 00:21:56,960
kik and tando ting have been an active

558
00:21:56,960 --> 00:22:00,320
user of shadowpad since 2018.

559
00:22:00,320 --> 00:22:02,960
those two groups merge into a new

560
00:22:02,960 --> 00:22:05,440
institution during the reorganization of

561
00:22:05,440 --> 00:22:07,200
poa

562
00:22:07,200 --> 00:22:09,360
they already be identified significant

563
00:22:09,360 --> 00:22:12,880
resource sharing between them

564
00:22:12,880 --> 00:22:14,880
such as the overlap of cnc

565
00:22:14,880 --> 00:22:16,159
infrastructure

566
00:22:16,159 --> 00:22:18,799
and the utility of similar

567
00:22:18,799 --> 00:22:20,799
tool set

568
00:22:20,799 --> 00:22:23,760
a notable change after the merge was

569
00:22:23,760 --> 00:22:26,559
that they start to use shadow pad as

570
00:22:26,559 --> 00:22:28,400
their primary backdoor

571
00:22:28,400 --> 00:22:29,200
for

572
00:22:29,200 --> 00:22:32,799
conducting intrusion activity

573
00:22:32,799 --> 00:22:34,080
in the past

574
00:22:34,080 --> 00:22:35,919
they were known to develop their own

575
00:22:35,919 --> 00:22:38,840
back doors for their own

576
00:22:38,840 --> 00:22:40,720
operations

577
00:22:40,720 --> 00:22:42,960
throughout 2019

578
00:22:42,960 --> 00:22:45,520
tick craft and send spear efficient

579
00:22:45,520 --> 00:22:48,640
emails to deliver shadow pad in victims

580
00:22:48,640 --> 00:22:51,679
network for information steering and

581
00:22:51,679 --> 00:22:52,840
long-term

582
00:22:52,840 --> 00:22:56,799
experience in 2020 town nothing explodes

583
00:22:56,799 --> 00:23:03,760
cv 2019 knight 489 and cbe 2020 8468 in

584
00:23:03,760 --> 00:23:06,559
trent michael's security solutions

585
00:23:06,559 --> 00:23:09,039
that were exposed in the internet

586
00:23:09,039 --> 00:23:11,520
in order to deliver shadow pad into

587
00:23:11,520 --> 00:23:16,240
internal network for further explanation

588
00:23:16,640 --> 00:23:18,960
based on the simple set we collect

589
00:23:18,960 --> 00:23:20,960
tk and tunnel team used at least five

590
00:23:20,960 --> 00:23:23,200
different versions of shadowpad

591
00:23:23,200 --> 00:23:26,559
however all of the samples only contain

592
00:23:26,559 --> 00:23:30,240
the basic set of plugins

593
00:23:30,480 --> 00:23:32,720
because they still have the ability to

594
00:23:32,720 --> 00:23:35,200
develop tools by themselves

595
00:23:35,200 --> 00:23:37,520
although they turn from self-developed

596
00:23:37,520 --> 00:23:40,320
backdoors to the awkward or liquid

597
00:23:40,320 --> 00:23:41,760
backdoors

598
00:23:41,760 --> 00:23:44,240
they still develop some customized tools

599
00:23:44,240 --> 00:23:46,159
for instruction

600
00:23:46,159 --> 00:23:48,799
such as modified minicads a screen

601
00:23:48,799 --> 00:23:52,480
capture tool a package transmission tool

602
00:23:52,480 --> 00:23:54,880
a tool to list all of the software in

603
00:23:54,880 --> 00:23:56,159
your computer

604
00:23:56,159 --> 00:24:00,240
and vbscript command executable tool

605
00:24:00,240 --> 00:24:02,960
in addition we found a vbscript command

606
00:24:02,960 --> 00:24:05,120
is killer tool builder which can

607
00:24:05,120 --> 00:24:07,440
generate a payload of vbscript with

608
00:24:07,440 --> 00:24:10,080
billing evasion technical to bypass

609
00:24:10,080 --> 00:24:12,640
trade micro products

610
00:24:12,640 --> 00:24:15,039
most important of all why we think

611
00:24:15,039 --> 00:24:17,279
shadow pad sell plugins

612
00:24:17,279 --> 00:24:19,840
because we saw this case

613
00:24:19,840 --> 00:24:22,799
tick decided not to buy full version of

614
00:24:22,799 --> 00:24:23,760
it

615
00:24:23,760 --> 00:24:25,840
and they decided to create a tool by

616
00:24:25,840 --> 00:24:28,399
themselves

617
00:24:30,640 --> 00:24:32,640
here is another cluster

618
00:24:32,640 --> 00:24:35,360
we cut a shadow pad activity cluster

619
00:24:35,360 --> 00:24:37,600
which adds not clear link to unknown

620
00:24:37,600 --> 00:24:39,039
thread groups

621
00:24:39,039 --> 00:24:41,440
we also track this activity and name it

622
00:24:41,440 --> 00:24:44,880
as a operation rate bonus

623
00:24:44,880 --> 00:24:46,640
the first activity of shadow pad we

624
00:24:46,640 --> 00:24:50,640
discovered occurred at the end of 2019.

625
00:24:50,640 --> 00:24:52,320
all the samples we collect from

626
00:24:52,320 --> 00:24:55,039
operation rate bonus were wrong in the

627
00:24:55,039 --> 00:24:58,720
same version of shadow pad

628
00:24:58,720 --> 00:25:00,720
during our investigation

629
00:25:00,720 --> 00:25:03,600
we also spot other backdoors in use

630
00:25:03,600 --> 00:25:04,640
such as

631
00:25:04,640 --> 00:25:07,520
white bird ice frog and customized

632
00:25:07,520 --> 00:25:10,240
instance of pc sure

633
00:25:10,240 --> 00:25:12,400
the actors share interesting and india

634
00:25:12,400 --> 00:25:15,760
targets with several dns domains proof

635
00:25:15,760 --> 00:25:19,440
in some india institution

636
00:25:20,640 --> 00:25:23,360
and another small set of shadow patch

637
00:25:23,360 --> 00:25:24,480
simple

638
00:25:24,480 --> 00:25:27,600
without clear attribution in a public

639
00:25:27,600 --> 00:25:29,840
domain

640
00:25:30,000 --> 00:25:31,760
interesting part is

641
00:25:31,760 --> 00:25:34,720
all of the cnc server extract from the

642
00:25:34,720 --> 00:25:36,000
samples

643
00:25:36,000 --> 00:25:40,720
had the same self-signed certificates

644
00:25:40,880 --> 00:25:43,600
some related samples were documented to

645
00:25:43,600 --> 00:25:45,760
be a part of the

646
00:25:45,760 --> 00:25:47,600
truck slogan attack

647
00:25:47,600 --> 00:25:51,678
according to the report by eset

648
00:25:52,880 --> 00:25:55,120
another activity cluster

649
00:25:55,120 --> 00:25:59,120
has been active since at least 2018

650
00:25:59,120 --> 00:26:02,559
and we call it fishmonger

651
00:26:02,559 --> 00:26:05,520
the victim including university

652
00:26:05,520 --> 00:26:08,159
government media sector technology

653
00:26:08,159 --> 00:26:11,840
company and healthy organizations

654
00:26:11,840 --> 00:26:14,960
that conducted kovil 19 research in hong

655
00:26:14,960 --> 00:26:19,919
kong taiwan india and the u.s

656
00:26:20,159 --> 00:26:22,320
the cluster is tracking based on the

657
00:26:22,320 --> 00:26:26,080
overlap of infrastructure and indicators

658
00:26:26,080 --> 00:26:28,799
as well as some behavior connection

659
00:26:28,799 --> 00:26:31,440
between different campaigns

660
00:26:31,440 --> 00:26:34,559
back in 2019 the actor used a special

661
00:26:34,559 --> 00:26:37,200
version of shadowpad which allowed them

662
00:26:37,200 --> 00:26:40,159
to generate samples with a handful of

663
00:26:40,159 --> 00:26:42,960
plugins embedded by default

664
00:26:42,960 --> 00:26:45,919
in 2020 they gained access to a new

665
00:26:45,919 --> 00:26:48,400
version of shadowpad which had update

666
00:26:48,400 --> 00:26:52,159
and more advanced application technicals

667
00:26:52,159 --> 00:26:55,520
we focused on those

668
00:26:55,520 --> 00:26:57,840
self-signed certificate

669
00:26:57,840 --> 00:26:58,640
in

670
00:26:58,640 --> 00:27:01,760
is installed on several cnc servers of

671
00:27:01,760 --> 00:27:05,279
shadow pen and the spider

672
00:27:05,279 --> 00:27:08,720
so this group use shadowpad and spider

673
00:27:08,720 --> 00:27:11,440
as their primary backdoors for long term

674
00:27:11,440 --> 00:27:12,720
monitoring

675
00:27:12,720 --> 00:27:15,760
on their target now

676
00:27:17,679 --> 00:27:20,240
this section we are going to talk about

677
00:27:20,240 --> 00:27:23,360
how does shadow pad emerge influence the

678
00:27:23,360 --> 00:27:25,200
threatened landscape of chinese

679
00:27:25,200 --> 00:27:28,000
exponential activities

680
00:27:28,000 --> 00:27:30,640
we will use a famous chinese exponent

681
00:27:30,640 --> 00:27:32,880
actors as an example

682
00:27:32,880 --> 00:27:35,360
and we have been monitoring this group

683
00:27:35,360 --> 00:27:38,719
at least four years

684
00:27:39,600 --> 00:27:42,480
it is not a secret that the number of

685
00:27:42,480 --> 00:27:44,960
chinese threat groups develop their own

686
00:27:44,960 --> 00:27:48,320
tool set based on their needed during

687
00:27:48,320 --> 00:27:49,840
operations

688
00:27:49,840 --> 00:27:50,880
however

689
00:27:50,880 --> 00:27:53,440
in order to establish explanance

690
00:27:53,440 --> 00:27:57,120
directors will also need other tooling

691
00:27:57,120 --> 00:28:00,559
to edit to their operations

692
00:28:00,559 --> 00:28:02,640
for example mini cats

693
00:28:02,640 --> 00:28:07,120
h-train plug-x and ghost

694
00:28:07,120 --> 00:28:10,399
or the popularity of malware originally

695
00:28:10,399 --> 00:28:13,919
such as shadowpad and kobo strike

696
00:28:13,919 --> 00:28:17,120
among chinese experiment groups

697
00:28:17,120 --> 00:28:20,720
here we use tick as an example

698
00:28:20,720 --> 00:28:23,919
it was one of the most

699
00:28:23,919 --> 00:28:26,960
active users of shadow pad according to

700
00:28:26,960 --> 00:28:28,640
our research

701
00:28:28,640 --> 00:28:32,000
prior to this tig was documented to be

702
00:28:32,000 --> 00:28:34,960
using self-developed backdoors

703
00:28:34,960 --> 00:28:37,760
including deserved xsm

704
00:28:37,760 --> 00:28:41,279
and deck adapter

705
00:28:41,279 --> 00:28:43,600
there's a notable change we discovered

706
00:28:43,600 --> 00:28:45,840
during the monitoring of the thread

707
00:28:45,840 --> 00:28:46,720
groups

708
00:28:46,720 --> 00:28:48,880
and we draw this change

709
00:28:48,880 --> 00:28:51,120
to a timeline table

710
00:28:51,120 --> 00:28:53,039
here

711
00:28:53,039 --> 00:28:54,799
according to the timeline

712
00:28:54,799 --> 00:28:57,760
we could see this actor stopped the use

713
00:28:57,760 --> 00:29:00,960
of their self-developed backdoors and

714
00:29:00,960 --> 00:29:03,760
started to using the backdoors they

715
00:29:03,760 --> 00:29:05,840
bought

716
00:29:05,840 --> 00:29:10,320
and named this backdoor as casper

717
00:29:10,960 --> 00:29:16,640
this backdoor casper is the shadow pad

718
00:29:18,559 --> 00:29:20,399
so

719
00:29:20,399 --> 00:29:23,360
what is the benefit of this change and

720
00:29:23,360 --> 00:29:24,960
why they decide

721
00:29:24,960 --> 00:29:26,399
to use

722
00:29:26,399 --> 00:29:28,559
self-develop back doors

723
00:29:28,559 --> 00:29:29,360
to

724
00:29:29,360 --> 00:29:32,639
awkward back doors

725
00:29:33,679 --> 00:29:36,640
there are two answers that could answer

726
00:29:36,640 --> 00:29:38,640
those questions

727
00:29:38,640 --> 00:29:41,120
first one is actor want to

728
00:29:41,120 --> 00:29:43,120
lower the cost

729
00:29:43,120 --> 00:29:46,320
spend less time on well-designed malware

730
00:29:46,320 --> 00:29:49,919
and reduce the human resource to develop

731
00:29:49,919 --> 00:29:52,480
the malwares

732
00:29:52,480 --> 00:29:55,039
especially when it contains some

733
00:29:55,039 --> 00:29:58,320
complicated functionality like vnc

734
00:29:58,320 --> 00:30:01,360
it is hard to ensure such functionality

735
00:30:01,360 --> 00:30:04,320
will not crash the program on the client

736
00:30:04,320 --> 00:30:05,760
side

737
00:30:05,760 --> 00:30:08,480
if the attackers outsourcing the

738
00:30:08,480 --> 00:30:10,640
development of backdoors

739
00:30:10,640 --> 00:30:12,559
they do not need to spend doing

740
00:30:12,559 --> 00:30:15,520
development and qa testing

741
00:30:15,520 --> 00:30:17,679
they can put more resource

742
00:30:17,679 --> 00:30:22,679
on the other part of operations

743
00:30:23,360 --> 00:30:25,679
second one is the occurring backdoors

744
00:30:25,679 --> 00:30:28,159
usually will keep enhance the stability

745
00:30:28,159 --> 00:30:30,240
and the usability

746
00:30:30,240 --> 00:30:33,520
the seller need to have a good well for

747
00:30:33,520 --> 00:30:35,360
their product

748
00:30:35,360 --> 00:30:36,399
so

749
00:30:36,399 --> 00:30:38,880
they will pro provide newest version of

750
00:30:38,880 --> 00:30:42,080
backdoors with new feature added

751
00:30:42,080 --> 00:30:44,880
or like shadow pad with a complete set

752
00:30:44,880 --> 00:30:46,399
of plugins

753
00:30:46,399 --> 00:30:48,399
it covers most of the important

754
00:30:48,399 --> 00:30:50,799
functional of back doors

755
00:30:50,799 --> 00:30:51,919
such as

756
00:30:51,919 --> 00:30:55,120
disk browsering shell command execution

757
00:30:55,120 --> 00:30:58,399
remote desktop and so on

758
00:30:58,399 --> 00:31:01,360
it is flexible to allow attacker decide

759
00:31:01,360 --> 00:31:03,600
which plugin to buy

760
00:31:03,600 --> 00:31:06,240
and those kind of private assault

761
00:31:06,240 --> 00:31:09,200
malware unlike community malwares

762
00:31:09,200 --> 00:31:12,000
found in a cyber criminal or underground

763
00:31:12,000 --> 00:31:14,559
forums

764
00:31:17,039 --> 00:31:19,600
so here now we can make up our

765
00:31:19,600 --> 00:31:22,399
conclusions

766
00:31:26,480 --> 00:31:28,799
when we're doing this research we keep

767
00:31:28,799 --> 00:31:33,440
asking ourselves those three questions

768
00:31:33,440 --> 00:31:36,159
why do the actors choose to use shadow

769
00:31:36,159 --> 00:31:37,039
pad

770
00:31:37,039 --> 00:31:40,159
and why shadow pad is not disappearing

771
00:31:40,159 --> 00:31:41,679
how should a pet affect their

772
00:31:41,679 --> 00:31:44,320
intelligence

773
00:31:45,200 --> 00:31:48,399
about why actors choose shadowpad

774
00:31:48,399 --> 00:31:51,600
we come up some ideas

775
00:31:51,600 --> 00:31:54,480
shadowpad was created by an experienced

776
00:31:54,480 --> 00:31:55,760
development

777
00:31:55,760 --> 00:31:58,000
and it is also under activity

778
00:31:58,000 --> 00:31:59,840
maintenance

779
00:31:59,840 --> 00:32:02,559
on both its functionality and its

780
00:32:02,559 --> 00:32:05,039
anti-forensic capability

781
00:32:05,039 --> 00:32:08,720
so that is good for actors

782
00:32:08,720 --> 00:32:09,679
also

783
00:32:09,679 --> 00:32:12,080
using shadowpad reduce the cost of

784
00:32:12,080 --> 00:32:14,799
development and using shadowpad could

785
00:32:14,799 --> 00:32:17,360
make security company hard to do further

786
00:32:17,360 --> 00:32:20,320
research about it

787
00:32:20,799 --> 00:32:22,880
and the second question why should a pay

788
00:32:22,880 --> 00:32:24,960
is not disappearing

789
00:32:24,960 --> 00:32:28,080
one of the reason is that malware still

790
00:32:28,080 --> 00:32:30,399
under update right now

791
00:32:30,399 --> 00:32:33,200
with more advanced application and

792
00:32:33,200 --> 00:32:36,320
persistent technicals

793
00:32:36,320 --> 00:32:40,720
the only reason is shadow pad

794
00:32:41,120 --> 00:32:43,120
it comes because shadow pad is a

795
00:32:43,120 --> 00:32:45,840
powerful back door with so many

796
00:32:45,840 --> 00:32:47,840
functionality

797
00:32:47,840 --> 00:32:50,720
and so good for long-term expansion

798
00:32:50,720 --> 00:32:53,840
operations and good at keeping self

799
00:32:53,840 --> 00:32:57,840
still see under radar

800
00:32:59,679 --> 00:33:02,000
the last question how should

801
00:33:02,000 --> 00:33:04,399
affect threat intelligence

802
00:33:04,399 --> 00:33:06,000
to be honest

803
00:33:06,000 --> 00:33:08,000
effect a lot

804
00:33:08,000 --> 00:33:09,919
if threat intelligence researchers want

805
00:33:09,919 --> 00:33:12,240
to do attribution research

806
00:33:12,240 --> 00:33:15,279
they need to require careful validation

807
00:33:15,279 --> 00:33:17,600
and a strong inventory

808
00:33:17,600 --> 00:33:19,200
to support

809
00:33:19,200 --> 00:33:23,039
so that it could help the community's

810
00:33:23,039 --> 00:33:26,080
effort to identify chinese exponential

811
00:33:26,080 --> 00:33:28,399
groups

812
00:33:31,760 --> 00:33:32,480
so

813
00:33:32,480 --> 00:33:34,240
here is our talk

814
00:33:34,240 --> 00:33:36,399
thank you for your attentions if you

815
00:33:36,399 --> 00:33:39,200
have any questions please feel free to

816
00:33:39,200 --> 00:33:42,200
ask

817
00:33:43,200 --> 00:33:46,369
[Music]

