1
00:00:02,640 --> 00:00:05,819
[Music]

2
00:00:08,639 --> 00:00:10,000
hello everyone

3
00:00:10,000 --> 00:00:12,240
in this talk we'd like to show you about

4
00:00:12,240 --> 00:00:13,840
the manga family

5
00:00:13,840 --> 00:00:18,000
titled where is the cuckoo egg

6
00:00:18,320 --> 00:00:21,840
let us introduce ourselves

7
00:00:24,560 --> 00:00:27,760
we are malware analysts at ntt security

8
00:00:27,760 --> 00:00:30,760
japan

9
00:00:30,960 --> 00:00:33,440
as an introduction we explain an

10
00:00:33,440 --> 00:00:36,559
overview of this presentation

11
00:00:36,559 --> 00:00:38,879
as we reported last year

12
00:00:38,879 --> 00:00:41,280
we found an unknown malware which had

13
00:00:41,280 --> 00:00:44,879
started from royal road rdf weaponizer

14
00:00:44,879 --> 00:00:47,680
in operation long time id

15
00:00:47,680 --> 00:00:51,280
we named that malware as d-manga

16
00:00:51,280 --> 00:00:52,879
during the research

17
00:00:52,879 --> 00:00:56,079
we found that it has various versions

18
00:00:56,079 --> 00:00:59,280
and also we found its variant

19
00:00:59,280 --> 00:01:03,920
named albanitas and as manager

20
00:01:03,920 --> 00:01:07,439
when we dug into it more deeply

21
00:01:07,439 --> 00:01:10,640
we found that some apt groups seem to

22
00:01:10,640 --> 00:01:12,560
share them

23
00:01:12,560 --> 00:01:15,520
t manga like malwarets were discovered

24
00:01:15,520 --> 00:01:18,240
in east and southeast asia of

25
00:01:18,240 --> 00:01:19,840
asian countries

26
00:01:19,840 --> 00:01:22,240
recently

27
00:01:22,240 --> 00:01:23,119
so

28
00:01:23,119 --> 00:01:25,280
the manga family is one of the most

29
00:01:25,280 --> 00:01:29,200
influent malware families there

30
00:01:29,200 --> 00:01:30,880
for these reasons

31
00:01:30,880 --> 00:01:32,960
it's important to share the information

32
00:01:32,960 --> 00:01:35,680
about timongo family

33
00:01:35,680 --> 00:01:38,159
in this talk we'll share the information

34
00:01:38,159 --> 00:01:39,840
like following

35
00:01:39,840 --> 00:01:41,280
first

36
00:01:41,280 --> 00:01:43,920
we'll explain the detailed detailed

37
00:01:43,920 --> 00:01:45,680
analysis results

38
00:01:45,680 --> 00:01:50,320
about t monger albanutas and s manager

39
00:01:50,320 --> 00:01:51,439
next

40
00:01:51,439 --> 00:01:55,040
we'll talk about family tree attribution

41
00:01:55,040 --> 00:01:57,119
and relationship

42
00:01:57,119 --> 00:01:58,479
finally

43
00:01:58,479 --> 00:02:00,560
we'll share hunting tips

44
00:02:00,560 --> 00:02:04,079
especially apt groups might be belong to

45
00:02:04,079 --> 00:02:05,840
china and

46
00:02:05,840 --> 00:02:09,799
and wrap it up

47
00:02:10,160 --> 00:02:12,239
let's take a look at mobile analysis

48
00:02:12,239 --> 00:02:14,560
first

49
00:02:15,200 --> 00:02:16,480
first of all

50
00:02:16,480 --> 00:02:19,040
we'll explain about an isis result of d

51
00:02:19,040 --> 00:02:21,440
manga

52
00:02:21,440 --> 00:02:23,280
as you can see here

53
00:02:23,280 --> 00:02:25,840
t-monger has three elements

54
00:02:25,840 --> 00:02:26,959
set up

55
00:02:26,959 --> 00:02:29,440
mlml dll

56
00:02:29,440 --> 00:02:31,840
and client

57
00:02:31,840 --> 00:02:34,319
client is a rot

58
00:02:34,319 --> 00:02:37,120
so the goal of the tea manga should be

59
00:02:37,120 --> 00:02:39,840
to infect our host with

60
00:02:39,840 --> 00:02:42,319
client

61
00:02:42,480 --> 00:02:46,160
set up emerald dll and client

62
00:02:46,160 --> 00:02:48,480
are the common elements

63
00:02:48,480 --> 00:02:51,840
through team manga family

64
00:02:54,080 --> 00:02:57,040
the overview of setup behavior is like

65
00:02:57,040 --> 00:02:58,640
this

66
00:02:58,640 --> 00:02:59,840
first

67
00:02:59,840 --> 00:03:03,040
the manga confirmed it if it has been

68
00:03:03,040 --> 00:03:07,280
already launched by itself

69
00:03:07,360 --> 00:03:10,159
we'll explain it in detail in the next

70
00:03:10,159 --> 00:03:12,400
slide

71
00:03:12,400 --> 00:03:14,480
and then it checks

72
00:03:14,480 --> 00:03:18,000
if the process has admin privileges by

73
00:03:18,000 --> 00:03:23,040
using wind apis is user admin

74
00:03:26,080 --> 00:03:29,680
in order to evade multiple launching

75
00:03:29,680 --> 00:03:33,760
setup has a specific implementation

76
00:03:33,760 --> 00:03:36,400
setup creates an event

77
00:03:36,400 --> 00:03:39,840
with create event function

78
00:03:39,840 --> 00:03:43,840
and if create event is failed

79
00:03:43,840 --> 00:03:47,840
setup will stop itself

80
00:03:48,400 --> 00:03:52,400
in all versions of the manga

81
00:03:52,400 --> 00:03:54,720
the created event names will be the

82
00:03:54,720 --> 00:03:59,560
rejects condition in this slide

83
00:04:00,080 --> 00:04:01,439
next

84
00:04:01,439 --> 00:04:04,080
this is the overview of emerald dlr

85
00:04:04,080 --> 00:04:07,200
activity in team manga

86
00:04:07,200 --> 00:04:11,360
it generates an rc4 key first

87
00:04:11,360 --> 00:04:15,280
then it decrypts config data

88
00:04:15,280 --> 00:04:18,478
by using that key

89
00:04:18,639 --> 00:04:22,079
the decrypted config data includes

90
00:04:22,079 --> 00:04:26,840
ip addresses and port numbers of cnc cnc

91
00:04:26,840 --> 00:04:28,560
server

92
00:04:28,560 --> 00:04:31,520
like in this slide

93
00:04:31,600 --> 00:04:36,240
the rat client uses this data

94
00:04:36,240 --> 00:04:39,600
after that mldl deflates

95
00:04:39,600 --> 00:04:43,040
existing data in resource section on the

96
00:04:43,040 --> 00:04:44,560
memory

97
00:04:44,560 --> 00:04:47,040
and executes it

98
00:04:47,040 --> 00:04:49,759
executed data on the memory

99
00:04:49,759 --> 00:04:52,720
its client

100
00:04:54,080 --> 00:04:57,520
modll implements export function named

101
00:04:57,520 --> 00:04:59,440
entery

102
00:04:59,440 --> 00:05:00,320
and

103
00:05:00,320 --> 00:05:02,800
this function name is characteristic of

104
00:05:02,800 --> 00:05:05,440
t family

105
00:05:05,440 --> 00:05:06,880
and theory

106
00:05:06,880 --> 00:05:10,160
may be a type of entry

107
00:05:10,160 --> 00:05:12,960
you can find this kind of typos in key

108
00:05:12,960 --> 00:05:14,479
manga family

109
00:05:14,479 --> 00:05:15,759
for example

110
00:05:15,759 --> 00:05:17,520
t manga

111
00:05:17,520 --> 00:05:21,120
may be a typo of team manager

112
00:05:21,120 --> 00:05:23,360
and a string was done

113
00:05:23,360 --> 00:05:25,520
in pdb path

114
00:05:25,520 --> 00:05:28,320
may also be typo of

115
00:05:28,320 --> 00:05:30,880
watson

116
00:05:33,120 --> 00:05:35,919
here we have an activity overview of

117
00:05:35,919 --> 00:05:38,720
client in tea manga

118
00:05:38,720 --> 00:05:43,440
client steals information from the host

119
00:05:44,560 --> 00:05:47,280
and the still information

120
00:05:47,280 --> 00:05:48,080
is

121
00:05:48,080 --> 00:05:50,800
such as os architecture

122
00:05:50,800 --> 00:05:54,880
drive and so on

123
00:05:56,479 --> 00:06:00,880
then make some mutex and connect to the

124
00:06:00,880 --> 00:06:06,360
cnc server to run other route

125
00:06:07,840 --> 00:06:10,720
this is a list of implemented commands

126
00:06:10,720 --> 00:06:12,639
in client

127
00:06:12,639 --> 00:06:14,720
the manga client

128
00:06:14,720 --> 00:06:18,400
has a lot of commands

129
00:06:18,880 --> 00:06:20,400
downloading

130
00:06:20,400 --> 00:06:22,880
downloading and uploading files

131
00:06:22,880 --> 00:06:24,800
starting process

132
00:06:24,800 --> 00:06:26,400
key logging

133
00:06:26,400 --> 00:06:28,000
screen capturing

134
00:06:28,000 --> 00:06:30,639
and so on

135
00:06:32,240 --> 00:06:35,280
traffic data between the infected host

136
00:06:35,280 --> 00:06:37,440
and cng server

137
00:06:37,440 --> 00:06:41,600
is encrypted by rc4

138
00:06:41,919 --> 00:06:45,120
the decrypted traffic data

139
00:06:45,120 --> 00:06:47,199
has an id

140
00:06:47,199 --> 00:06:50,479
commands an essential data for each

141
00:06:50,479 --> 00:06:52,880
command

142
00:06:53,759 --> 00:06:57,680
starting for bytes data in traffic

143
00:06:57,680 --> 00:06:59,840
is the id

144
00:06:59,840 --> 00:07:03,039
and this id is lead from

145
00:07:03,039 --> 00:07:05,840
process ie

146
00:07:06,960 --> 00:07:09,919
the algorithm to calculate

147
00:07:09,919 --> 00:07:12,000
the id

148
00:07:12,000 --> 00:07:16,520
is in the blog of the presentation

149
00:07:18,110 --> 00:07:19,919
[Music]

150
00:07:19,919 --> 00:07:22,800
we got a t-monger generator as shown

151
00:07:22,800 --> 00:07:24,400
here

152
00:07:24,400 --> 00:07:29,198
this tool can generate ammo dll

153
00:07:29,680 --> 00:07:33,440
set ip addresses and port numbers for

154
00:07:33,440 --> 00:07:34,639
clients

155
00:07:34,639 --> 00:07:37,840
cnc servers

156
00:07:38,240 --> 00:07:41,039
the generated mlo dll

157
00:07:41,039 --> 00:07:42,840
by these two

158
00:07:42,840 --> 00:07:46,720
runs runs a rat client

159
00:07:46,720 --> 00:07:50,319
which we explained before

160
00:07:50,319 --> 00:07:53,199
from this slide we'll show the analysis

161
00:07:53,199 --> 00:07:55,520
result of albanutus

162
00:07:55,520 --> 00:07:58,160
tacflow with admin privileges is like

163
00:07:58,160 --> 00:07:59,759
this

164
00:07:59,759 --> 00:08:02,560
alba newton's begins with fake flight

165
00:08:02,560 --> 00:08:03,599
fake ex

166
00:08:03,599 --> 00:08:07,960
fake excel file utas.xlsx

167
00:08:08,160 --> 00:08:11,280
and end with a fileless rat

168
00:08:11,280 --> 00:08:12,879
names

169
00:08:12,879 --> 00:08:16,000
client x dot dll

170
00:08:16,000 --> 00:08:17,759
as you can see here

171
00:08:17,759 --> 00:08:20,639
there are more related files than t

172
00:08:20,639 --> 00:08:21,919
monger

173
00:08:21,919 --> 00:08:25,280
but albanitas also has three comma

174
00:08:25,280 --> 00:08:26,879
elements

175
00:08:26,879 --> 00:08:28,479
set up

176
00:08:28,479 --> 00:08:30,080
employ dll

177
00:08:30,080 --> 00:08:32,719
and client

178
00:08:32,719 --> 00:08:35,360
and their role is almost same as t

179
00:08:35,360 --> 00:08:37,760
monger

180
00:08:39,360 --> 00:08:41,919
this is an attack flaw without adding

181
00:08:41,919 --> 00:08:44,240
privileges

182
00:08:44,240 --> 00:08:47,760
you can realize that the attack flow is

183
00:08:47,760 --> 00:08:52,880
a bit of different from previous one

184
00:08:52,880 --> 00:08:54,399
the persistence

185
00:08:54,399 --> 00:08:58,800
method is a big differences

186
00:08:59,680 --> 00:09:02,959
if setup has admin privileges

187
00:09:02,959 --> 00:09:06,640
it will establish the persistence by

188
00:09:06,640 --> 00:09:09,519
using windows service

189
00:09:09,519 --> 00:09:11,279
but if not

190
00:09:11,279 --> 00:09:14,000
setup will use a registry

191
00:09:14,000 --> 00:09:17,279
current version run

192
00:09:18,880 --> 00:09:21,600
as we mentioned in attack floor

193
00:09:21,600 --> 00:09:25,839
albanitas has more files

194
00:09:25,839 --> 00:09:30,720
in setup and mlo dll than t monger

195
00:09:30,720 --> 00:09:32,640
but setup

196
00:09:32,640 --> 00:09:35,120
and mlo dln part

197
00:09:35,120 --> 00:09:38,560
runs like teamongo

198
00:09:38,560 --> 00:09:40,480
the difference is

199
00:09:40,480 --> 00:09:45,680
amlo dln malware in albanutas such as xp

200
00:09:45,680 --> 00:09:47,839
exprint.dll

201
00:09:47,839 --> 00:09:49,040
and

202
00:09:49,040 --> 00:09:52,040
vjsc.dll

203
00:09:52,399 --> 00:09:55,519
is siteloaded by a legitimate

204
00:09:55,519 --> 00:09:58,800
signed binary file

205
00:09:59,839 --> 00:10:00,959
and

206
00:10:00,959 --> 00:10:04,880
that binary is a visual jsharp

207
00:10:04,880 --> 00:10:07,519
command tool

208
00:10:08,160 --> 00:10:11,040
here you can see activity overview of

209
00:10:11,040 --> 00:10:13,839
albanita's client

210
00:10:13,839 --> 00:10:15,120
client

211
00:10:15,120 --> 00:10:16,560
decrypts

212
00:10:16,560 --> 00:10:19,920
config data by rc4

213
00:10:19,920 --> 00:10:21,680
the config data

214
00:10:21,680 --> 00:10:25,199
is inside of itself

215
00:10:25,279 --> 00:10:28,880
the decrypted data has url

216
00:10:28,880 --> 00:10:32,959
so client uses that url to communicate

217
00:10:32,959 --> 00:10:36,000
with a cnc server

218
00:10:36,000 --> 00:10:38,480
client access it to the

219
00:10:38,480 --> 00:10:42,079
cnc server several times

220
00:10:42,079 --> 00:10:43,040
first

221
00:10:43,040 --> 00:10:45,360
obtaining new cnc server of the

222
00:10:45,360 --> 00:10:47,680
addresses

223
00:10:47,680 --> 00:10:48,800
next

224
00:10:48,800 --> 00:10:51,519
sending infected host information to new

225
00:10:51,519 --> 00:10:54,000
cnc servers

226
00:10:54,000 --> 00:10:54,880
then

227
00:10:54,880 --> 00:10:56,959
communicating with the

228
00:10:56,959 --> 00:11:01,839
cnc servers to execute command

229
00:11:04,640 --> 00:11:08,480
client downloads html file cnc server

230
00:11:08,480 --> 00:11:11,279
from cnc server

231
00:11:11,279 --> 00:11:16,480
the html file is like this image

232
00:11:17,200 --> 00:11:20,000
the downloaded downloaded file contains

233
00:11:20,000 --> 00:11:22,320
encoded data so

234
00:11:22,320 --> 00:11:25,440
client decodes the data to obtain new

235
00:11:25,440 --> 00:11:29,200
cnc server ip addresses

236
00:11:29,200 --> 00:11:31,040
you can check detailed

237
00:11:31,040 --> 00:11:36,319
detailed decoding logic in our paper

238
00:11:38,720 --> 00:11:41,680
client sends fast information

239
00:11:41,680 --> 00:11:46,000
like this form of url to a new cnc

240
00:11:46,000 --> 00:11:48,320
server

241
00:11:48,320 --> 00:11:51,440
url consists in five parts

242
00:11:51,440 --> 00:11:54,160
ucnc server ip address

243
00:11:54,160 --> 00:11:57,200
fixed value form

244
00:11:57,200 --> 00:11:59,200
random value

245
00:11:59,200 --> 00:12:00,560
string length

246
00:12:00,560 --> 00:12:02,880
of number five

247
00:12:02,880 --> 00:12:04,240
and string

248
00:12:04,240 --> 00:12:06,399
encrypted

249
00:12:06,399 --> 00:12:07,440
by

250
00:12:07,440 --> 00:12:09,040
a s

251
00:12:09,040 --> 00:12:12,880
2 5 6 and base 6 c4

252
00:12:12,880 --> 00:12:15,600
third part of uln is based on the

253
00:12:15,600 --> 00:12:19,600
command executed system time

254
00:12:21,360 --> 00:12:24,399
i'll albany test client

255
00:12:24,399 --> 00:12:29,120
has some commands but less than t manga

256
00:12:29,120 --> 00:12:31,120
command execution

257
00:12:31,120 --> 00:12:34,399
download download and upload files

258
00:12:34,399 --> 00:12:36,800
and exit

259
00:12:36,800 --> 00:12:38,480
it seemed that

260
00:12:38,480 --> 00:12:41,279
client has minimum possible command to

261
00:12:41,279 --> 00:12:44,320
run as a route

262
00:12:45,839 --> 00:12:48,320
at the end of analysis part we'll

263
00:12:48,320 --> 00:12:51,040
explain about s manager

264
00:12:51,040 --> 00:12:54,320
here we can see the attack flow of s

265
00:12:54,320 --> 00:12:55,920
manager

266
00:12:55,920 --> 00:12:59,440
it seems more like t manga

267
00:12:59,440 --> 00:13:02,320
on the page shows

268
00:13:02,320 --> 00:13:03,120
we

269
00:13:03,120 --> 00:13:06,240
we haven't got a sample of s manager

270
00:13:06,240 --> 00:13:07,519
client

271
00:13:07,519 --> 00:13:11,360
but we guess as manager also has client

272
00:13:11,360 --> 00:13:15,120
from the analysis result of mlo dll

273
00:13:15,120 --> 00:13:17,760
in s manager

274
00:13:17,760 --> 00:13:20,639
we'll talk about our hypothesis

275
00:13:20,639 --> 00:13:23,040
rater

276
00:13:24,480 --> 00:13:26,399
as manager set up

277
00:13:26,399 --> 00:13:29,519
behavior is like this

278
00:13:29,519 --> 00:13:30,720
first

279
00:13:30,720 --> 00:13:34,720
setup drops the stored cap file

280
00:13:34,720 --> 00:13:36,800
in resource section

281
00:13:36,800 --> 00:13:39,279
and the compresses

282
00:13:39,279 --> 00:13:42,240
employ dll from the cab file

283
00:13:42,240 --> 00:13:43,199
next

284
00:13:43,199 --> 00:13:47,920
setup overwrites config data of mldl as

285
00:13:47,920 --> 00:13:50,880
shown in this slide

286
00:13:50,880 --> 00:13:54,320
the actual data has cnc servers info and

287
00:13:54,320 --> 00:13:56,399
so on

288
00:13:56,399 --> 00:13:57,199
then

289
00:13:57,199 --> 00:13:59,279
setup establishes

290
00:13:59,279 --> 00:14:03,199
the persistence of dll by registering a

291
00:14:03,199 --> 00:14:05,360
service

292
00:14:05,360 --> 00:14:07,760
if setup has

293
00:14:07,760 --> 00:14:10,800
admin previous keys

294
00:14:10,800 --> 00:14:13,360
if no admin previous is

295
00:14:13,360 --> 00:14:19,199
mlo bll will be executed by win exec

296
00:14:21,680 --> 00:14:25,680
the behavior of s manager modll

297
00:14:25,680 --> 00:14:29,199
is to connect to a cnc server

298
00:14:29,199 --> 00:14:32,240
and to execute commands from the cnc

299
00:14:32,240 --> 00:14:34,320
server

300
00:14:34,320 --> 00:14:38,240
when emol dll connects to cng server

301
00:14:38,240 --> 00:14:43,440
it uses a characteristic protocol

302
00:14:43,519 --> 00:14:45,680
and microsoft

303
00:14:45,680 --> 00:14:48,959
security provider interface

304
00:14:48,959 --> 00:14:51,440
to authenticate and encrypt the

305
00:14:51,440 --> 00:14:54,000
connection

306
00:14:56,000 --> 00:14:58,399
only two commands are implemented

307
00:14:58,399 --> 00:15:01,760
in ammo dll in s manager

308
00:15:01,760 --> 00:15:02,959
first

309
00:15:02,959 --> 00:15:05,360
download and execute an

310
00:15:05,360 --> 00:15:08,000
executable file

311
00:15:08,000 --> 00:15:09,199
second

312
00:15:09,199 --> 00:15:12,240
send the infected host information to

313
00:15:12,240 --> 00:15:15,839
the cnc server

314
00:15:20,399 --> 00:15:22,480
we haven't got a sample

315
00:15:22,480 --> 00:15:24,839
client

316
00:15:24,839 --> 00:15:26,720
but

317
00:15:26,720 --> 00:15:29,839
mldln doesn't have

318
00:15:29,839 --> 00:15:31,759
so much command

319
00:15:31,759 --> 00:15:35,120
to run as a rat

320
00:15:35,199 --> 00:15:38,160
but it has a command to download and

321
00:15:38,160 --> 00:15:39,279
execute

322
00:15:39,279 --> 00:15:42,720
an executable file

323
00:15:43,680 --> 00:15:47,600
and tmongo family has a rad function

324
00:15:47,600 --> 00:15:49,040
function malware

325
00:15:49,040 --> 00:15:50,079
called

326
00:15:50,079 --> 00:15:52,560
client

327
00:15:52,959 --> 00:15:56,000
so we guessed that as manager should

328
00:15:56,000 --> 00:15:58,000
also have

329
00:15:58,000 --> 00:15:59,920
client

330
00:15:59,920 --> 00:16:02,000
and it may be down

331
00:16:02,000 --> 00:16:04,000
downloaded file

332
00:16:04,000 --> 00:16:07,800
from mlo dll

333
00:16:08,240 --> 00:16:09,440
from here

334
00:16:09,440 --> 00:16:14,160
we'll present family tree of tea manga

335
00:16:14,480 --> 00:16:17,600
before explaining the manga family tree

336
00:16:17,600 --> 00:16:20,880
we show our definition and aliases of

337
00:16:20,880 --> 00:16:22,880
the manga family

338
00:16:22,880 --> 00:16:26,320
about alba newton's and blue traveler

339
00:16:26,320 --> 00:16:29,600
we wrote that we wouldn't mention the

340
00:16:29,600 --> 00:16:33,279
relationship because we didn't get any

341
00:16:33,279 --> 00:16:36,639
concrete example information

342
00:16:36,639 --> 00:16:38,160
however

343
00:16:38,160 --> 00:16:39,759
recently

344
00:16:39,759 --> 00:16:42,160
group ib researchers

345
00:16:42,160 --> 00:16:44,160
reported that

346
00:16:44,160 --> 00:16:48,240
they should have strong association

347
00:16:48,240 --> 00:16:51,279
about as manager and font net

348
00:16:51,279 --> 00:16:55,680
in order to introduce the transition of

349
00:16:55,680 --> 00:16:59,680
phantom net and as manager

350
00:17:00,320 --> 00:17:03,040
will strictly treat them

351
00:17:03,040 --> 00:17:04,799
are separated

352
00:17:04,799 --> 00:17:07,520
into these

353
00:17:09,039 --> 00:17:12,240
here we can see a table

354
00:17:12,240 --> 00:17:15,839
this table shows the similarities of

355
00:17:15,839 --> 00:17:17,039
team manga

356
00:17:17,039 --> 00:17:20,559
albanutus and its manager

357
00:17:20,559 --> 00:17:22,720
you realize that

358
00:17:22,720 --> 00:17:24,319
the manga

359
00:17:24,319 --> 00:17:29,039
and albanites have a lot in common

360
00:17:29,760 --> 00:17:31,520
the differences

361
00:17:31,520 --> 00:17:34,400
are the existence of string

362
00:17:34,400 --> 00:17:36,799
to generate encrypt key

363
00:17:36,799 --> 00:17:40,000
and calling func export function get

364
00:17:40,000 --> 00:17:41,679
plugin object

365
00:17:41,679 --> 00:17:44,880
from client or not

366
00:17:44,960 --> 00:17:46,799
on the other hand

367
00:17:46,799 --> 00:17:49,760
as manager seems like different from

368
00:17:49,760 --> 00:17:51,360
others

369
00:17:51,360 --> 00:17:52,480
target

370
00:17:52,480 --> 00:17:54,000
compile time

371
00:17:54,000 --> 00:17:56,480
western in user path

372
00:17:56,480 --> 00:18:00,080
and compression algorithm

373
00:18:00,080 --> 00:18:02,400
however

374
00:18:02,400 --> 00:18:06,320
it also has a lot of common items

375
00:18:06,320 --> 00:18:07,520
especially

376
00:18:07,520 --> 00:18:10,080
string to generate

377
00:18:10,080 --> 00:18:11,600
encrypt key

378
00:18:11,600 --> 00:18:13,039
includes

379
00:18:13,039 --> 00:18:15,120
same value

380
00:18:15,120 --> 00:18:17,679
and calling export function get logging

381
00:18:17,679 --> 00:18:20,799
object from client

382
00:18:20,799 --> 00:18:22,799
are same as

383
00:18:22,799 --> 00:18:25,360
albanites

384
00:18:25,360 --> 00:18:26,720
next

385
00:18:26,720 --> 00:18:29,520
we'll describe team anger family tree

386
00:18:29,520 --> 00:18:32,639
from our research

387
00:18:33,120 --> 00:18:36,080
let us let us discuss about dimanga

388
00:18:36,080 --> 00:18:38,559
family tree

389
00:18:38,559 --> 00:18:40,000
so

390
00:18:40,000 --> 00:18:42,240
we'll check about their relations in

391
00:18:42,240 --> 00:18:44,720
detail

392
00:18:46,160 --> 00:18:47,120
first

393
00:18:47,120 --> 00:18:49,120
we'll explain about the relationship

394
00:18:49,120 --> 00:18:53,200
between bbs rat and phantom net

395
00:18:53,200 --> 00:18:56,960
bbs fraud has the same mutex as old

396
00:18:56,960 --> 00:18:58,880
phantom net

397
00:18:58,880 --> 00:19:00,160
also

398
00:19:00,160 --> 00:19:03,200
the characteristic export function

399
00:19:03,200 --> 00:19:04,160
named

400
00:19:04,160 --> 00:19:06,799
entry

401
00:19:07,039 --> 00:19:09,600
may come from bbs rats

402
00:19:09,600 --> 00:19:11,440
enter

403
00:19:11,440 --> 00:19:12,880
we'll explain

404
00:19:12,880 --> 00:19:14,559
the details

405
00:19:14,559 --> 00:19:18,320
in attribution and relationship section

406
00:19:18,320 --> 00:19:20,000
later

407
00:19:20,000 --> 00:19:23,440
but for the for those reasons

408
00:19:23,440 --> 00:19:27,760
there may be association between them

409
00:19:28,400 --> 00:19:29,360
next

410
00:19:29,360 --> 00:19:33,120
fundament quantum net and as manager

411
00:19:33,120 --> 00:19:35,360
the oldest file

412
00:19:35,360 --> 00:19:36,799
sample

413
00:19:36,799 --> 00:19:39,679
that we found was

414
00:19:39,679 --> 00:19:40,880
phantomnet

415
00:19:40,880 --> 00:19:41,840
from

416
00:19:41,840 --> 00:19:42,799
may

417
00:19:42,799 --> 00:19:45,799
2017

418
00:19:45,840 --> 00:19:47,600
at this time

419
00:19:47,600 --> 00:19:50,480
phantom then might have been used

420
00:19:50,480 --> 00:19:52,400
to target

421
00:19:52,400 --> 00:19:54,960
organizations in the u.s

422
00:19:54,960 --> 00:19:56,880
or singapore

423
00:19:56,880 --> 00:20:00,000
until may 2020

424
00:20:00,000 --> 00:20:02,640
after s manager appeared

425
00:20:02,640 --> 00:20:05,039
in july 2020

426
00:20:05,039 --> 00:20:07,919
quantum net disappeared

427
00:20:07,919 --> 00:20:10,080
their implementations

428
00:20:10,080 --> 00:20:11,039
are

429
00:20:11,039 --> 00:20:12,559
so similar

430
00:20:12,559 --> 00:20:15,600
that we consider that as manager is the

431
00:20:15,600 --> 00:20:16,880
successor

432
00:20:16,880 --> 00:20:20,280
of quantumnet

433
00:20:21,120 --> 00:20:22,000
then

434
00:20:22,000 --> 00:20:25,840
the manga and albanites

435
00:20:26,720 --> 00:20:28,080
to begin with

436
00:20:28,080 --> 00:20:31,520
we clarify the relationship between

437
00:20:31,520 --> 00:20:34,960
t manga and alphanutes

438
00:20:34,960 --> 00:20:37,520
this table shows

439
00:20:37,520 --> 00:20:40,559
data of d manga and

440
00:20:40,559 --> 00:20:43,200
albanitas

441
00:20:43,200 --> 00:20:44,320
here

442
00:20:44,320 --> 00:20:46,320
we can find that the completion

443
00:20:46,320 --> 00:20:50,080
timestamp is around 2025

444
00:20:50,080 --> 00:20:52,640
as we draw red square

445
00:20:52,640 --> 00:20:54,799
on the table

446
00:20:54,799 --> 00:20:57,520
we guessed that they have been compiled

447
00:20:57,520 --> 00:21:00,799
in the same environment

448
00:21:00,799 --> 00:21:03,679
also if the pdb paths

449
00:21:03,679 --> 00:21:05,039
are true

450
00:21:05,039 --> 00:21:09,120
team manga started being created around

451
00:21:09,120 --> 00:21:12,879
april 2019

452
00:21:13,600 --> 00:21:15,200
furthermore

453
00:21:15,200 --> 00:21:18,640
we get that albany test has been created

454
00:21:18,640 --> 00:21:22,320
between the creation times of the manga

455
00:21:22,320 --> 00:21:25,200
version 4 4.5

456
00:21:25,200 --> 00:21:27,200
and version

457
00:21:27,200 --> 00:21:29,679
6.2

458
00:21:29,679 --> 00:21:33,360
comparing with t manga version 4.5 and

459
00:21:33,360 --> 00:21:35,679
6.2

460
00:21:35,679 --> 00:21:39,919
6.2 has a lot of similarity

461
00:21:39,919 --> 00:21:44,039
to albany desk

462
00:21:45,760 --> 00:21:49,360
there is also reported that t manga and

463
00:21:49,360 --> 00:21:51,840
alma newton's were used in the same

464
00:21:51,840 --> 00:21:54,640
attack campaign

465
00:21:54,640 --> 00:21:57,360
so we considered team manga and

466
00:21:57,360 --> 00:21:59,039
alternates

467
00:21:59,039 --> 00:22:02,159
to be extreme extremely

468
00:22:02,159 --> 00:22:04,480
close

469
00:22:07,200 --> 00:22:10,480
here we'll discuss about the origin of

470
00:22:10,480 --> 00:22:12,799
albanutus

471
00:22:12,799 --> 00:22:18,000
first albanites was used in june 2020

472
00:22:18,000 --> 00:22:19,200
then

473
00:22:19,200 --> 00:22:22,240
quantum net switched to as manager in

474
00:22:22,240 --> 00:22:24,720
july 2020

475
00:22:24,720 --> 00:22:28,960
these terms are very close

476
00:22:30,799 --> 00:22:35,919
next the relationship between albanites

477
00:22:35,919 --> 00:22:37,919
and ti manga

478
00:22:37,919 --> 00:22:40,400
is clear

479
00:22:40,400 --> 00:22:41,679
finally

480
00:22:41,679 --> 00:22:43,039
his manager

481
00:22:43,039 --> 00:22:45,919
has some similar similar implementation

482
00:22:45,919 --> 00:22:47,520
to

483
00:22:47,520 --> 00:22:50,799
t manga and albanitas

484
00:22:50,799 --> 00:22:52,320
for these reasons

485
00:22:52,320 --> 00:22:55,440
t manga and phantom net

486
00:22:55,440 --> 00:22:56,400
codes

487
00:22:56,400 --> 00:22:58,240
might be merged

488
00:22:58,240 --> 00:23:03,600
to create albanitas in june 2020

489
00:23:05,280 --> 00:23:08,720
at the end of this section we show you

490
00:23:08,720 --> 00:23:12,640
the current situation of t mango family

491
00:23:12,640 --> 00:23:14,480
about tea manga

492
00:23:14,480 --> 00:23:20,080
version 6.2 was observed in june 2020

493
00:23:20,080 --> 00:23:22,960
and in may 2021

494
00:23:22,960 --> 00:23:25,440
the observation of an s manager like

495
00:23:25,440 --> 00:23:28,559
malware named male o

496
00:23:28,559 --> 00:23:30,799
was reported

497
00:23:30,799 --> 00:23:31,919
also

498
00:23:31,919 --> 00:23:35,600
another s module like as manager like

499
00:23:35,600 --> 00:23:39,600
malware might be used in june 2021

500
00:23:39,600 --> 00:23:43,120
in east asia and orthanya

501
00:23:43,120 --> 00:23:47,279
we call this malware dns core

502
00:23:47,279 --> 00:23:49,200
for these reasons

503
00:23:49,200 --> 00:23:53,279
team manga and as manager valiants

504
00:23:53,279 --> 00:23:57,039
may continue developing currently

505
00:23:57,039 --> 00:23:58,480
therefore

506
00:23:58,480 --> 00:24:02,919
we need to check their trends

507
00:24:04,799 --> 00:24:06,640
and in this section

508
00:24:06,640 --> 00:24:08,480
we'll talk about t manga family

509
00:24:08,480 --> 00:24:12,400
attribution and relationship

510
00:24:12,400 --> 00:24:15,360
this table is about operations that we

511
00:24:15,360 --> 00:24:20,240
observed and other researchers reported

512
00:24:20,240 --> 00:24:22,480
because of attacking

513
00:24:22,480 --> 00:24:24,799
to same targets and using the same

514
00:24:24,799 --> 00:24:27,840
malware as shown in the table

515
00:24:27,840 --> 00:24:30,960
the relationships between ta48 and lucky

516
00:24:30,960 --> 00:24:35,679
moss have middle to high certainty

517
00:24:36,799 --> 00:24:38,320
on the other hand

518
00:24:38,320 --> 00:24:42,640
how about as manager related operation

519
00:24:42,640 --> 00:24:44,320
as you can see here

520
00:24:44,320 --> 00:24:46,960
in operation science site

521
00:24:46,960 --> 00:24:50,480
threat groups haven't been clarified

522
00:24:50,480 --> 00:24:53,279
and their target is vietnam

523
00:24:53,279 --> 00:24:54,080
so

524
00:24:54,080 --> 00:24:58,080
it's different from other campaigns

525
00:24:59,200 --> 00:25:01,919
this is an image of the relationship

526
00:25:01,919 --> 00:25:06,559
between tier 48 and s manager

527
00:25:06,799 --> 00:25:09,600
vietnam is one of the southeast asian

528
00:25:09,600 --> 00:25:11,039
countries

529
00:25:11,039 --> 00:25:13,279
a group targeting two

530
00:25:13,279 --> 00:25:15,039
east asia

531
00:25:15,039 --> 00:25:16,640
is ta-413

532
00:25:16,640 --> 00:25:18,559
[Music]

533
00:25:18,559 --> 00:25:22,400
some researchers guessed that tm-413 had

534
00:25:22,400 --> 00:25:26,559
some association with ta-48

535
00:25:26,559 --> 00:25:29,440
we guessed that quantum net is the

536
00:25:29,440 --> 00:25:30,960
predecessor

537
00:25:30,960 --> 00:25:33,600
of s manager

538
00:25:33,600 --> 00:25:36,159
and fountain that might be downloaded by

539
00:25:36,159 --> 00:25:39,279
farm tiny dream backdoor

540
00:25:39,279 --> 00:25:42,159
funny dream backdoor is a malware used

541
00:25:42,159 --> 00:25:44,640
by funny dream

542
00:25:44,640 --> 00:25:46,960
that overlaps

543
00:25:46,960 --> 00:25:50,760
some part of ta-413

544
00:25:50,880 --> 00:25:53,360
from the results of the

545
00:25:53,360 --> 00:25:55,440
malware analysis

546
00:25:55,440 --> 00:25:58,559
as manager may share the code with t

547
00:25:58,559 --> 00:26:02,000
mangu and uberneutas

548
00:26:02,000 --> 00:26:03,279
thus

549
00:26:03,279 --> 00:26:05,120
it is possible that

550
00:26:05,120 --> 00:26:08,880
tiny dream or ta1413

551
00:26:08,880 --> 00:26:14,320
has been related to operation sign site

552
00:26:17,120 --> 00:26:18,159
next

553
00:26:18,159 --> 00:26:21,679
about df-48 and roaming tiger

554
00:26:21,679 --> 00:26:24,880
as we explain family tree section

555
00:26:24,880 --> 00:26:28,480
some part of implementations in bbs rat

556
00:26:28,480 --> 00:26:32,400
and phantom net are similar

557
00:26:32,400 --> 00:26:36,559
also bbs rat has some similar points to

558
00:26:36,559 --> 00:26:39,760
ts manager

559
00:26:39,760 --> 00:26:42,880
roaming tiger use pbs rod and their

560
00:26:42,880 --> 00:26:47,679
targets are east asian countries

561
00:26:47,679 --> 00:26:51,200
the target is same as ta-48

562
00:26:51,200 --> 00:26:54,799
and they used team manga

563
00:26:54,799 --> 00:26:58,080
as we mentioned here

564
00:26:58,080 --> 00:27:02,799
bbs rock is close to t manga family

565
00:27:02,799 --> 00:27:04,400
therefore

566
00:27:04,400 --> 00:27:07,520
roaming tiger may have some relationship

567
00:27:07,520 --> 00:27:08,480
with

568
00:27:08,480 --> 00:27:11,440
tf48

569
00:27:12,960 --> 00:27:14,640
we draw the

570
00:27:14,640 --> 00:27:15,919
image

571
00:27:15,919 --> 00:27:16,960
of the

572
00:27:16,960 --> 00:27:20,159
association of threat groups and shared

573
00:27:20,159 --> 00:27:23,120
tools and malware

574
00:27:23,120 --> 00:27:25,039
tools and malwares

575
00:27:25,039 --> 00:27:26,559
in here

576
00:27:26,559 --> 00:27:30,639
are the recent major examples

577
00:27:31,520 --> 00:27:35,919
as we can see here some pieces of tools

578
00:27:35,919 --> 00:27:38,080
and malwares may be

579
00:27:38,080 --> 00:27:39,120
shared

580
00:27:39,120 --> 00:27:42,080
not only by a single group

581
00:27:42,080 --> 00:27:44,080
but among several

582
00:27:44,080 --> 00:27:46,480
groups

583
00:27:46,559 --> 00:27:48,640
it will be possible that

584
00:27:48,640 --> 00:27:52,240
these groups shared two

585
00:27:52,320 --> 00:27:55,039
it will be possible that these groups

586
00:27:55,039 --> 00:27:56,000
share

587
00:27:56,000 --> 00:27:58,720
tools and malwares

588
00:27:58,720 --> 00:28:00,480
if so

589
00:28:00,480 --> 00:28:03,120
the manga family may be shared more

590
00:28:03,120 --> 00:28:05,200
widely than now

591
00:28:05,200 --> 00:28:07,919
in the future

592
00:28:09,440 --> 00:28:10,399
well

593
00:28:10,399 --> 00:28:15,479
we are going to wrap up our presentation

594
00:28:16,640 --> 00:28:19,200
before closing this presentation

595
00:28:19,200 --> 00:28:22,720
let us introduce hunting tips

596
00:28:22,720 --> 00:28:24,159
first

597
00:28:24,159 --> 00:28:26,480
pay attention to supply chain attack

598
00:28:26,480 --> 00:28:28,159
cases

599
00:28:28,159 --> 00:28:29,279
remember

600
00:28:29,279 --> 00:28:32,159
in operation stealthy trident

601
00:28:32,159 --> 00:28:35,039
and operation sign site

602
00:28:35,039 --> 00:28:38,320
attacker attackers used supply chain

603
00:28:38,320 --> 00:28:39,840
attack

604
00:28:39,840 --> 00:28:42,880
but the targeted softwares weren't

605
00:28:42,880 --> 00:28:46,720
famous like solar winds

606
00:28:46,720 --> 00:28:48,320
in those cases

607
00:28:48,320 --> 00:28:51,760
attackers targeted at political or

608
00:28:51,760 --> 00:28:55,440
related organizations of mongolia and

609
00:28:55,440 --> 00:28:58,440
vietnam

610
00:28:59,120 --> 00:29:02,080
focus on the attribution especially

611
00:29:02,080 --> 00:29:05,678
chinese apd groups

612
00:29:06,240 --> 00:29:09,440
if you want to research apt groups

613
00:29:09,440 --> 00:29:12,640
especially china-related groups

614
00:29:12,640 --> 00:29:16,399
you should focus on their attribution

615
00:29:16,399 --> 00:29:18,240
in particular

616
00:29:18,240 --> 00:29:20,559
one of the most important points to

617
00:29:20,559 --> 00:29:22,799
check

618
00:29:24,080 --> 00:29:27,480
one of the

619
00:29:28,399 --> 00:29:29,919
in particular

620
00:29:29,919 --> 00:29:32,320
one of the most important points

621
00:29:32,320 --> 00:29:33,679
is to check

622
00:29:33,679 --> 00:29:36,480
the shared tools

623
00:29:36,480 --> 00:29:37,919
our research

624
00:29:37,919 --> 00:29:41,279
about team anger started when we

625
00:29:41,279 --> 00:29:43,120
researched a

626
00:29:43,120 --> 00:29:47,440
sample of royal road rtf weaponizer

627
00:29:47,440 --> 00:29:50,399
used by tf48

628
00:29:50,399 --> 00:29:52,000
our shared tool

629
00:29:52,000 --> 00:29:55,840
may draw another two

630
00:30:01,600 --> 00:30:02,640
third

631
00:30:02,640 --> 00:30:05,840
research carefully

632
00:30:05,840 --> 00:30:08,960
these points

633
00:30:08,960 --> 00:30:10,080
third

634
00:30:10,080 --> 00:30:13,760
research carefully these points

635
00:30:13,760 --> 00:30:16,559
we researched

636
00:30:17,919 --> 00:30:20,480
we researched out that

637
00:30:20,480 --> 00:30:23,360
these are the important points to hunt

638
00:30:23,360 --> 00:30:25,600
the mango family

639
00:30:25,600 --> 00:30:29,600
through our analysis and research

640
00:30:29,600 --> 00:30:30,399
so

641
00:30:30,399 --> 00:30:31,360
we

642
00:30:31,360 --> 00:30:32,720
suggest

643
00:30:32,720 --> 00:30:33,520
to

644
00:30:33,520 --> 00:30:37,120
research those points carefully

645
00:30:37,120 --> 00:30:41,600
debug strings even names past name

646
00:30:41,600 --> 00:30:43,360
encryption keys

647
00:30:43,360 --> 00:30:45,360
export functions

648
00:30:45,360 --> 00:30:47,919
and load process of

649
00:30:47,919 --> 00:30:51,559
additional modules

650
00:30:54,799 --> 00:30:56,240
finally

651
00:30:56,240 --> 00:31:00,480
let us summarize our presentation

652
00:31:00,480 --> 00:31:03,279
we shared detailed analysis of the manga

653
00:31:03,279 --> 00:31:07,039
family malwarets especially team manga

654
00:31:07,039 --> 00:31:08,880
albanitas

655
00:31:08,880 --> 00:31:11,360
and as manager

656
00:31:11,360 --> 00:31:12,640
first

657
00:31:12,640 --> 00:31:14,720
the manga family has three common

658
00:31:14,720 --> 00:31:15,840
elements

659
00:31:15,840 --> 00:31:19,760
serap hemlo dll and client

660
00:31:19,760 --> 00:31:21,679
next

661
00:31:21,679 --> 00:31:23,279
there are some characteristic

662
00:31:23,279 --> 00:31:25,919
implementations such as admin

663
00:31:25,919 --> 00:31:28,720
privileges checks

664
00:31:28,720 --> 00:31:30,840
export function name

665
00:31:30,840 --> 00:31:34,799
entry command id calculation algorithm

666
00:31:34,799 --> 00:31:37,440
and so on

667
00:31:37,440 --> 00:31:38,799
and

668
00:31:38,799 --> 00:31:42,240
characteristic meta information exists

669
00:31:42,240 --> 00:31:44,480
through the family

670
00:31:44,480 --> 00:31:48,559
future compilation time around 2025

671
00:31:48,559 --> 00:31:51,519
containing western in pdb path

672
00:31:51,519 --> 00:31:54,159
etc

673
00:31:54,559 --> 00:31:55,840
also

674
00:31:55,840 --> 00:31:58,799
we shared our research result about team

675
00:31:58,799 --> 00:32:01,279
anger family and attribution and

676
00:32:01,279 --> 00:32:04,000
relationship

677
00:32:04,000 --> 00:32:07,279
we introduced the association between t

678
00:32:07,279 --> 00:32:11,039
manga family from bbs rat to male oil

679
00:32:11,039 --> 00:32:14,080
and dns core

680
00:32:14,080 --> 00:32:15,200
also

681
00:32:15,200 --> 00:32:18,640
we clarified that china-related apt

682
00:32:18,640 --> 00:32:22,320
groups might use team anger family

683
00:32:22,320 --> 00:32:26,159
and share team manga family like

684
00:32:26,159 --> 00:32:30,159
royal ipf recognizer

685
00:32:30,159 --> 00:32:33,200
or charbette

686
00:32:33,760 --> 00:32:35,919
the mango family showed

687
00:32:35,919 --> 00:32:40,480
us the relationship between epd groups

688
00:32:40,480 --> 00:32:43,279
new versions or new variants

689
00:32:43,279 --> 00:32:46,480
are being observed

690
00:32:48,000 --> 00:32:48,880
so

691
00:32:48,880 --> 00:32:51,200
we get that tea manga family

692
00:32:51,200 --> 00:32:56,200
are developing at this moment

693
00:32:56,320 --> 00:33:00,960
and it will be widely used in the future

694
00:33:01,279 --> 00:33:03,840
that's all for our presentation

695
00:33:03,840 --> 00:33:07,959
thank you very much for listening

696
00:33:08,740 --> 00:33:11,840
[Music]

697
00:33:11,840 --> 00:33:13,918
you

