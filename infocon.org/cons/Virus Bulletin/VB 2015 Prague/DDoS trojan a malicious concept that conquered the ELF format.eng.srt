1
00:00:09,980 --> 00:00:15,780
so good morning now the session

2
00:00:15,780 --> 00:00:19,380
continues here in green room and i will

3
00:00:19,380 --> 00:00:22,830
give you Patrick and I and Jeremy Jose

4
00:00:22,830 --> 00:00:25,410
she from avast software with the

5
00:00:25,410 --> 00:00:27,720
presentation of de dos Trojan and

6
00:00:27,720 --> 00:00:30,779
malicious concept that conquered the olf

7
00:00:30,779 --> 00:00:35,190
or forma yeah oh thank you we would like

8
00:00:35,190 --> 00:00:37,320
to show you that so d dos attacks offer

9
00:00:37,320 --> 00:00:40,290
also involve the case when and the

10
00:00:40,290 --> 00:00:43,010
executables have the elf file format and

11
00:00:43,010 --> 00:00:46,020
the outline is as follows at first we

12
00:00:46,020 --> 00:00:49,230
would like to describe our view of alpha

13
00:00:49,230 --> 00:00:52,620
over threat landscape and the role of

14
00:00:52,620 --> 00:00:56,010
the strong Giants Trojans in it then

15
00:00:56,010 --> 00:00:59,670
then we show some milestones in a threat

16
00:00:59,670 --> 00:01:02,670
evolution we described also common

17
00:01:02,670 --> 00:01:06,030
characteristics of this mother pieces

18
00:01:06,030 --> 00:01:09,450
and how autostart feature was

19
00:01:09,450 --> 00:01:11,760
implemented in samples found in the wild

20
00:01:11,760 --> 00:01:16,020
we won't avoid infection chains and

21
00:01:16,020 --> 00:01:21,659
methods of intrusion and ddos attacks

22
00:01:21,659 --> 00:01:25,049
those are not just bought the larger

23
00:01:25,049 --> 00:01:27,479
infrastructure behind them and we've

24
00:01:27,479 --> 00:01:30,750
managed to collect various operation

25
00:01:30,750 --> 00:01:34,640
tools like Bob builders and CNC panels

26
00:01:34,640 --> 00:01:38,159
vulnerability scanners source codes so

27
00:01:38,159 --> 00:01:41,159
it seems that cybercriminals haven't

28
00:01:41,159 --> 00:01:45,619
tried much to keep them hidden private

29
00:01:45,619 --> 00:01:49,619
then we describe the lost trojans like

30
00:01:49,619 --> 00:01:53,189
Al cannot mr. black and other what notes

31
00:01:53,189 --> 00:01:55,890
and we conclude with stargates and a

32
00:01:55,890 --> 00:02:00,689
summary for you to have a better insight

33
00:02:00,689 --> 00:02:04,560
in a threat landscape just by looks of

34
00:02:04,560 --> 00:02:06,540
it we prepared the visualization using

35
00:02:06,540 --> 00:02:09,598
GFI and post to force Atlas to graph

36
00:02:09,598 --> 00:02:13,280
layout algorithm we took twelve thousand

37
00:02:13,280 --> 00:02:16,450
elf malicious l files as of September

38
00:02:16,450 --> 00:02:21,080
2015 and we clustered them so the nodes

39
00:02:21,080 --> 00:02:23,920
represented particular Marvel families

40
00:02:23,920 --> 00:02:28,819
clustered by the common signature by the

41
00:02:28,819 --> 00:02:32,560
signature sharing common root name and

42
00:02:32,560 --> 00:02:35,270
the sizes of these notes correlates to

43
00:02:35,270 --> 00:02:37,790
the number of unique hashes with that

44
00:02:37,790 --> 00:02:40,900
signature edges are present if notes are

45
00:02:40,900 --> 00:02:47,060
notes signature and we then colored the

46
00:02:47,060 --> 00:02:49,160
notes in six categories like viruses

47
00:02:49,160 --> 00:02:52,880
exploits general-purpose Trojans ledos

48
00:02:52,880 --> 00:02:56,540
Trojans and so on actually we don't want

49
00:02:56,540 --> 00:02:59,330
to have our day to be contaminated so we

50
00:02:59,330 --> 00:03:02,900
excluded truncated files and other other

51
00:03:02,900 --> 00:03:06,470
files of no or very little interest like

52
00:03:06,470 --> 00:03:08,660
potentially elf components of

53
00:03:08,660 --> 00:03:11,510
potentially unwanted ap case so it looks

54
00:03:11,510 --> 00:03:15,019
like this and in the top those tiny

55
00:03:15,019 --> 00:03:17,930
stars are perhaps the most sophisticated

56
00:03:17,930 --> 00:03:20,030
and most interesting those are

57
00:03:20,030 --> 00:03:22,060
general-purpose Trojans that also called

58
00:03:22,060 --> 00:03:25,730
attention of IT media like Darlow sore

59
00:03:25,730 --> 00:03:28,910
or Barnett's or some commercials fiver

60
00:03:28,910 --> 00:03:33,530
apts hand of teeth and a new newborn

61
00:03:33,530 --> 00:03:37,060
stars this year linux moves linux linux

62
00:03:37,060 --> 00:03:41,859
mumble heart by great papers by set and

63
00:03:41,859 --> 00:03:46,790
silent x if watch but the conquest is

64
00:03:46,790 --> 00:03:51,620
coming in purple and we can see in the

65
00:03:51,620 --> 00:03:56,079
lower part the big stars representing

66
00:03:56,079 --> 00:04:00,739
legion d destroyed jeans and what are

67
00:04:00,739 --> 00:04:04,340
reasons behind that the star is giant it

68
00:04:04,340 --> 00:04:05,959
could be that the name is too generic

69
00:04:05,959 --> 00:04:09,049
like it's a flutter or it's a troll it's

70
00:04:09,049 --> 00:04:13,549
agent or it's a threat that is here for

71
00:04:13,549 --> 00:04:16,519
some time like tsunami bots those

72
00:04:16,519 --> 00:04:19,548
accumulated in time or and that's the

73
00:04:19,548 --> 00:04:21,680
case of these ledos trojans are coming

74
00:04:21,680 --> 00:04:24,460
from bob builders

75
00:04:25,670 --> 00:04:28,940
so some highlights in the evolution of

76
00:04:28,940 --> 00:04:31,730
threat first documented d dos attack

77
00:04:31,730 --> 00:04:34,400
happened in two thousand and we wondered

78
00:04:34,400 --> 00:04:39,470
why what are reasons behind what why was

79
00:04:39,470 --> 00:04:41,990
the time appropriate and we found a

80
00:04:41,990 --> 00:04:44,420
research paper that said that the

81
00:04:44,420 --> 00:04:45,860
internet took over the half of global

82
00:04:45,860 --> 00:04:48,620
communication in 1999 so these could

83
00:04:48,620 --> 00:04:52,400
might be connected somehow fundamental

84
00:04:52,400 --> 00:04:56,600
reference for us a paper in vb 2011 a

85
00:04:56,600 --> 00:04:58,730
survey of contemporary Chinese dido

86
00:04:58,730 --> 00:05:01,520
smaller what we miss in the title now is

87
00:05:01,520 --> 00:05:05,930
the word windows what was said in the in

88
00:05:05,930 --> 00:05:08,030
the paper like nature of attack

89
00:05:08,030 --> 00:05:10,760
procedures and nature of victims remain

90
00:05:10,760 --> 00:05:13,820
true needless to say that d dos families

91
00:05:13,820 --> 00:05:17,000
did we mention in sequel also have

92
00:05:17,000 --> 00:05:20,510
Windows variants little did we know when

93
00:05:20,510 --> 00:05:22,880
first blood builder for linux flooding

94
00:05:22,880 --> 00:05:25,310
boats arrived at our back end in

95
00:05:25,310 --> 00:05:29,300
november 2013 but thinks that he did get

96
00:05:29,300 --> 00:05:31,730
more clear when a few independent

97
00:05:31,730 --> 00:05:34,460
security researchers started to report

98
00:05:34,460 --> 00:05:37,910
incidents on their blog posts all these

99
00:05:37,910 --> 00:05:40,040
were connected with with the family win

100
00:05:40,040 --> 00:05:44,420
dubbed or is adapt awk not the latter

101
00:05:44,420 --> 00:05:47,030
one was more sophisticated variant that

102
00:05:47,030 --> 00:05:52,130
contains strings bill and gates and then

103
00:05:52,130 --> 00:05:56,710
more reports come dr.web on mr. black

104
00:05:56,710 --> 00:05:59,240
kaspersky on graph kids abusing

105
00:05:59,240 --> 00:06:02,150
shell-shocked interesting milestone in

106
00:06:02,150 --> 00:06:06,050
december 2014 virustotal edit file

107
00:06:06,050 --> 00:06:07,640
detail tab with parsed of

108
00:06:07,640 --> 00:06:10,730
characteristics and in their blog dos

109
00:06:10,730 --> 00:06:12,710
the service acknowledged increased

110
00:06:12,710 --> 00:06:18,020
importance of alpha over awareness a

111
00:06:18,020 --> 00:06:20,390
good catch by mother must die in

112
00:06:20,390 --> 00:06:23,780
September 2014 about sardinas family

113
00:06:23,780 --> 00:06:26,750
that we described in details a few

114
00:06:26,750 --> 00:06:31,880
months later and China's had appeared on

115
00:06:31,880 --> 00:06:35,900
the scene the same month Brian Krebs

116
00:06:35,900 --> 00:06:37,740
pointed out

117
00:06:37,740 --> 00:06:41,430
that lizard stressor is a real danger

118
00:06:41,430 --> 00:06:46,380
for IOT devices and then a few few

119
00:06:46,380 --> 00:06:48,560
references that also refer to our work

120
00:06:48,560 --> 00:06:53,970
we passed one from kaspersky they show

121
00:06:53,970 --> 00:06:56,220
some numbers and we were glad because

122
00:06:56,220 --> 00:07:00,930
those numbers confirmed our own partial

123
00:07:00,930 --> 00:07:05,550
findings so let's let's talk a little

124
00:07:05,550 --> 00:07:08,340
bit a little bit about about common

125
00:07:08,340 --> 00:07:10,440
health characteristics because elf

126
00:07:10,440 --> 00:07:14,009
format is for Linux something like PE

127
00:07:14,009 --> 00:07:16,740
format is for the windows and for us

128
00:07:16,740 --> 00:07:18,509
they are like several interesting

129
00:07:18,509 --> 00:07:22,139
information in the header one of them is

130
00:07:22,139 --> 00:07:24,000
the type of the header it can be either

131
00:07:24,000 --> 00:07:26,009
type type of the file it can be either

132
00:07:26,009 --> 00:07:29,789
executable file or shared object sharp

133
00:07:29,789 --> 00:07:33,030
object is the equivalent of dynamic link

134
00:07:33,030 --> 00:07:36,300
library in Windows another parameter

135
00:07:36,300 --> 00:07:38,370
which we are always interested is the

136
00:07:38,370 --> 00:07:42,150
machine type usually start with graphics

137
00:07:42,150 --> 00:07:45,360
en underscore and then it follows the

138
00:07:45,360 --> 00:07:47,669
type of architecture or instruction set

139
00:07:47,669 --> 00:07:51,150
which the binary is compiled for so we

140
00:07:51,150 --> 00:07:52,440
can find like many different

141
00:07:52,440 --> 00:07:54,330
architectures for many different systems

142
00:07:54,330 --> 00:07:57,690
from service some some like in embedded

143
00:07:57,690 --> 00:08:00,150
machines routers and so on and among

144
00:08:00,150 --> 00:08:02,669
these architectures we have like Intel

145
00:08:02,669 --> 00:08:06,690
32-bit 64-bit ARM apes super h PowerPC

146
00:08:06,690 --> 00:08:11,639
spark motor 0628 k and so on then later

147
00:08:11,639 --> 00:08:13,409
in the header we can see the segments

148
00:08:13,409 --> 00:08:16,169
and each segment contains one or more

149
00:08:16,169 --> 00:08:19,469
headers and these headers sections and

150
00:08:19,469 --> 00:08:22,409
these sections are usually like

151
00:08:22,409 --> 00:08:24,990
specifically named and had some specific

152
00:08:24,990 --> 00:08:27,449
usually specific purpose there can be

153
00:08:27,449 --> 00:08:29,219
many different types or many different

154
00:08:29,219 --> 00:08:32,039
names but for us the most important ones

155
00:08:32,039 --> 00:08:34,229
are the symbol tables and string type

156
00:08:34,229 --> 00:08:37,049
string tables which contains which

157
00:08:37,049 --> 00:08:39,299
contain names on imported and exported

158
00:08:39,299 --> 00:08:41,429
symbols so when we do the reverse

159
00:08:41,429 --> 00:08:44,159
engineering is quite or it's much easier

160
00:08:44,159 --> 00:08:46,920
if these symbols are not stripped and if

161
00:08:46,920 --> 00:08:48,870
they remain there so we can see the

162
00:08:48,870 --> 00:08:50,560
names of the procedures name

163
00:08:50,560 --> 00:08:52,990
of some of these variables there is also

164
00:08:52,990 --> 00:08:54,880
section aero data which is also

165
00:08:54,880 --> 00:08:56,800
interesting because there are some

166
00:08:56,800 --> 00:08:58,960
character strings which are used by the

167
00:08:58,960 --> 00:09:01,180
program so not symbol name just just the

168
00:09:01,180 --> 00:09:04,500
strings which are which are inside a

169
00:09:04,500 --> 00:09:08,529
little bit about like generic static

170
00:09:08,529 --> 00:09:12,339
properties of the Trojans so they are

171
00:09:12,339 --> 00:09:14,230
you like Trojan eyes flooding tools and

172
00:09:14,230 --> 00:09:17,230
usually some parts of codes are shared

173
00:09:17,230 --> 00:09:19,210
between different model families because

174
00:09:19,210 --> 00:09:23,740
a lot of these lot of these map pieces

175
00:09:23,740 --> 00:09:26,920
of malware have their source code shared

176
00:09:26,920 --> 00:09:32,560
on some some forums on some source code

177
00:09:32,560 --> 00:09:34,660
sharing websites and so on so the

178
00:09:34,660 --> 00:09:37,300
cybercriminals in spirit or get

179
00:09:37,300 --> 00:09:40,420
inspiration from one another the back

180
00:09:40,420 --> 00:09:42,220
information is often not straight so

181
00:09:42,220 --> 00:09:44,050
what I mentioned before the reverse

182
00:09:44,050 --> 00:09:47,320
engineering is mostly I wouldn't say

183
00:09:47,320 --> 00:09:50,020
easy but it's quite straightforward the

184
00:09:50,020 --> 00:09:51,910
supportive methods are usually like

185
00:09:51,910 --> 00:09:54,279
volume vol metric attacks like UDP flat

186
00:09:54,279 --> 00:09:57,460
TCP syn flood ICMP dns some most

187
00:09:57,460 --> 00:10:00,310
advanced methods also include DNS

188
00:10:00,310 --> 00:10:02,980
amplification attack our future which

189
00:10:02,980 --> 00:10:04,839
which we often notice is the clink

190
00:10:04,839 --> 00:10:07,480
competing resources so basically when

191
00:10:07,480 --> 00:10:09,220
the machine is infected by the flooding

192
00:10:09,220 --> 00:10:11,680
tool it might be infected even before

193
00:10:11,680 --> 00:10:14,170
with some other flutter so the newly

194
00:10:14,170 --> 00:10:16,360
installed malware kills the old malware

195
00:10:16,360 --> 00:10:19,060
so it doesn't use any of the resources

196
00:10:19,060 --> 00:10:21,670
it doesn't use any CPU cycles and a

197
00:10:21,670 --> 00:10:25,360
network bandwidth a little bit about to

198
00:10:25,360 --> 00:10:27,400
do the form it's usually where it's in

199
00:10:27,400 --> 00:10:29,290
many times in plain form so there's like

200
00:10:29,290 --> 00:10:31,270
no association as we know from windows

201
00:10:31,270 --> 00:10:33,940
malware but the only kind of way of

202
00:10:33,940 --> 00:10:36,280
obfuscation or pecking is packing with

203
00:10:36,280 --> 00:10:40,990
upx tool sometimes we notice that these

204
00:10:40,990 --> 00:10:43,480
upx headers are somehow modified so

205
00:10:43,480 --> 00:10:46,570
modified magic values or check sums do

206
00:10:46,570 --> 00:10:50,410
not match so the official upx tool

207
00:10:50,410 --> 00:10:52,450
doesn't always work but it doesn't mean

208
00:10:52,450 --> 00:10:53,830
anything for the malware it's still

209
00:10:53,830 --> 00:10:57,310
around it still does its job well but it

210
00:10:57,310 --> 00:10:59,890
cannot be untag by the official tool and

211
00:10:59,890 --> 00:11:01,990
it needs to be somehow modified to get

212
00:11:01,990 --> 00:11:04,390
into these files

213
00:11:04,390 --> 00:11:07,580
the difference between tool and Trojans

214
00:11:07,580 --> 00:11:10,280
in the persistence that the Trojans have

215
00:11:10,280 --> 00:11:12,890
added some persistence and we notice

216
00:11:12,890 --> 00:11:15,920
there if you like few methods of getting

217
00:11:15,920 --> 00:11:18,260
persistence in Linux machines either

218
00:11:18,260 --> 00:11:22,550
installing scripts to some path like /

219
00:11:22,550 --> 00:11:28,430
ET t / init d or RC and dot d which is

220
00:11:28,430 --> 00:11:31,550
the run level indicator or it can be by

221
00:11:31,550 --> 00:11:34,460
a modification of chron file again in

222
00:11:34,460 --> 00:11:39,710
ettv TC path so how do cybercriminals

223
00:11:39,710 --> 00:11:42,740
work so in the beginning they have the

224
00:11:42,740 --> 00:11:45,230
Builder folder for the mother so they

225
00:11:45,230 --> 00:11:47,870
just run this builder built mother they

226
00:11:47,870 --> 00:11:50,120
need to upload it somewhere it's usually

227
00:11:50,120 --> 00:11:53,690
run on compromised machines on which is

228
00:11:53,690 --> 00:11:56,420
installed one tool which is called HTTP

229
00:11:56,420 --> 00:11:59,570
file server will go to call it HFS it

230
00:11:59,570 --> 00:12:03,290
looks like in in the figure here in the

231
00:12:03,290 --> 00:12:05,660
right part of this slide they uploaded

232
00:12:05,660 --> 00:12:07,250
the buffer and then they need to

233
00:12:07,250 --> 00:12:09,140
distribute it somewhere so they run the

234
00:12:09,140 --> 00:12:12,500
port port scanners on various IP address

235
00:12:12,500 --> 00:12:14,930
ranges and depending on open pore to

236
00:12:14,930 --> 00:12:18,500
take an even either an attack or exploit

237
00:12:18,500 --> 00:12:20,210
some vulnerabilities there have been

238
00:12:20,210 --> 00:12:21,650
many examples of elasticsearch

239
00:12:21,650 --> 00:12:23,500
vulnerabilities shell-shocked

240
00:12:23,500 --> 00:12:25,220
vulnerabilities and windows server

241
00:12:25,220 --> 00:12:27,800
surveys apache struts lunar abilities or

242
00:12:27,800 --> 00:12:33,320
in case of port 22 for ssh they brute

243
00:12:33,320 --> 00:12:35,960
force names and passwords and many many

244
00:12:35,960 --> 00:12:38,600
devices like routers are run with

245
00:12:38,600 --> 00:12:41,930
default passwords so it's it sometimes

246
00:12:41,930 --> 00:12:44,030
quite easy and it doesn't need too many

247
00:12:44,030 --> 00:12:48,050
checks to get into the device before I

248
00:12:48,050 --> 00:12:51,890
mentioned the the HFS listings but they

249
00:12:51,890 --> 00:12:53,650
are not only the malware pieces or

250
00:12:53,650 --> 00:12:56,270
action other we have found there a lot

251
00:12:56,270 --> 00:12:58,970
of tools lot of data files among them

252
00:12:58,970 --> 00:13:01,850
for example list of target IP addresses

253
00:13:01,850 --> 00:13:04,640
yes you can see some screenshots here in

254
00:13:04,640 --> 00:13:07,100
the left there are their IP address

255
00:13:07,100 --> 00:13:09,200
ranges which are tried in the middle

256
00:13:09,200 --> 00:13:11,030
screen shot you can see that some of

257
00:13:11,030 --> 00:13:14,360
these IP addresses were scanned for port

258
00:13:14,360 --> 00:13:17,450
22 which is opened and in the right spot

259
00:13:17,450 --> 00:13:18,830
out of the slide you can see some

260
00:13:18,830 --> 00:13:20,720
default passwords which worked right or

261
00:13:20,720 --> 00:13:23,630
which were found in this file this is

262
00:13:23,630 --> 00:13:26,930
how the their site their operation tools

263
00:13:26,930 --> 00:13:28,790
look like these are examples of

264
00:13:28,790 --> 00:13:30,470
bodybuilders they can be even simple

265
00:13:30,470 --> 00:13:32,540
like in the left part of the screen shot

266
00:13:32,540 --> 00:13:35,300
where you can find where you can build

267
00:13:35,300 --> 00:13:38,300
like different versions for linux 32-bit

268
00:13:38,300 --> 00:13:41,780
64-bit windows freebsd and so on on the

269
00:13:41,780 --> 00:13:43,520
left part of the panel you can build

270
00:13:43,520 --> 00:13:46,550
even control panels tied to specific MAC

271
00:13:46,550 --> 00:13:49,370
address and so on and some builders are

272
00:13:49,370 --> 00:13:51,230
quite simple like on the right part that

273
00:13:51,230 --> 00:13:54,020
they contain sometimes even just the box

274
00:13:54,020 --> 00:13:57,650
for IP address and port this is example

275
00:13:57,650 --> 00:13:59,840
of some cnc panels this one is

276
00:13:59,840 --> 00:14:01,430
completely in Chinese because most of

277
00:14:01,430 --> 00:14:04,220
these attackers come from China so this

278
00:14:04,220 --> 00:14:07,580
is the example of panel full in Chinese

279
00:14:07,580 --> 00:14:09,950
Chinese this is another example of the

280
00:14:09,950 --> 00:14:12,050
panel this time luckily for us in

281
00:14:12,050 --> 00:14:15,410
English here in this case in the upper

282
00:14:15,410 --> 00:14:17,420
part we can see that this botnet has

283
00:14:17,420 --> 00:14:20,870
size of wall and it runs from the name

284
00:14:20,870 --> 00:14:22,430
of the operating system it runs

285
00:14:22,430 --> 00:14:26,960
something on beeps sometimes we even

286
00:14:26,960 --> 00:14:29,480
found these the binaries for the HFS

287
00:14:29,480 --> 00:14:32,870
itself like shared or host it on this

288
00:14:32,870 --> 00:14:37,370
HFF 10 hrs panels and this HFS listing

289
00:14:37,370 --> 00:14:39,530
contain one important or interesting

290
00:14:39,530 --> 00:14:42,410
thing thankful for us and it is the

291
00:14:42,410 --> 00:14:45,290
rightmost goal which contains or which

292
00:14:45,290 --> 00:14:47,300
is the number of downloads how many

293
00:14:47,300 --> 00:14:49,190
times the files download it so it can

294
00:14:49,190 --> 00:14:51,380
help us to estimate the size of the

295
00:14:51,380 --> 00:14:53,240
botnet so sometimes we can see they're

296
00:14:53,240 --> 00:14:54,980
like hundreds or thousands so we can see

297
00:14:54,980 --> 00:14:57,430
that the thing is like bigger or smaller

298
00:14:57,430 --> 00:15:00,740
another examples of some tools these are

299
00:15:00,740 --> 00:15:02,810
these are vulnerability scanners and

300
00:15:02,810 --> 00:15:07,000
exploit the right one is some tool for

301
00:15:07,000 --> 00:15:10,280
Microsoft server exploit it's probably

302
00:15:10,280 --> 00:15:12,920
some third-party tool the left the left

303
00:15:12,920 --> 00:15:17,300
one is struts app is vulnerability

304
00:15:17,300 --> 00:15:20,300
scanner for apache struts from china sea

305
00:15:20,300 --> 00:15:22,460
group or they were using it full in

306
00:15:22,460 --> 00:15:26,570
chinese another another tools which we

307
00:15:26,570 --> 00:15:28,690
found if we found many many versions

308
00:15:28,690 --> 00:15:31,160
this is for example SSH

309
00:15:31,160 --> 00:15:34,040
for sir so there's the file their dairy

310
00:15:34,040 --> 00:15:36,589
dairy executive file and you give him

311
00:15:36,589 --> 00:15:39,589
giving file with IP addresses and it

312
00:15:39,589 --> 00:15:42,769
tries to scan these IP addresses for ssh

313
00:15:42,769 --> 00:15:47,149
and then it tries some names and

314
00:15:47,149 --> 00:15:50,389
passwords from the files from the data

315
00:15:50,389 --> 00:15:53,449
files any found you can notice the line

316
00:15:53,449 --> 00:15:56,959
in the bottom if this to suck succeeds

317
00:15:56,959 --> 00:15:59,120
it produces the flowing output they are

318
00:15:59,120 --> 00:16:00,649
the brackets in the middle is the IP

319
00:16:00,649 --> 00:16:03,170
address then something in Chinese and

320
00:16:03,170 --> 00:16:06,740
then there is the name / password the

321
00:16:06,740 --> 00:16:09,050
output of this tool is input to another

322
00:16:09,050 --> 00:16:12,079
tool which we called ssh uploader we

323
00:16:12,079 --> 00:16:15,319
found it as exe file but it was fightin

324
00:16:15,319 --> 00:16:18,199
script so with some some little bit

325
00:16:18,199 --> 00:16:20,300
effort it's possible to decompile it

326
00:16:20,300 --> 00:16:23,269
even to it spuyten source code and what

327
00:16:23,269 --> 00:16:26,480
it does is that it takes the output from

328
00:16:26,480 --> 00:16:30,319
the previous tool and for each line it

329
00:16:30,319 --> 00:16:33,139
parses out the IP address it connects to

330
00:16:33,139 --> 00:16:36,250
the machine because it already knows the

331
00:16:36,250 --> 00:16:39,889
name and password and it runs few

332
00:16:39,889 --> 00:16:41,300
commands and these commands are

333
00:16:41,300 --> 00:16:44,060
specified in the command dot txt file

334
00:16:44,060 --> 00:16:47,630
it's in the right part in DD the upper

335
00:16:47,630 --> 00:16:50,060
one the screenshot and in this case it's

336
00:16:50,060 --> 00:16:52,310
quite simple it runs three commands

337
00:16:52,310 --> 00:16:56,569
third first it one is w get then there

338
00:16:56,569 --> 00:17:00,980
is the path to HFS storage / name of the

339
00:17:00,980 --> 00:17:02,930
file which is download it then it

340
00:17:02,930 --> 00:17:05,150
modifies the attributes of this file

341
00:17:05,150 --> 00:17:08,869
then it executes it then it disconnects

342
00:17:08,869 --> 00:17:10,669
from the device and goes for another one

343
00:17:10,669 --> 00:17:15,650
it can run forever these are these are

344
00:17:15,650 --> 00:17:18,589
examples of port scanners they use some

345
00:17:18,589 --> 00:17:20,359
of them are again fully Chinese like the

346
00:17:20,359 --> 00:17:22,609
scan port the upper one and the bottom

347
00:17:22,609 --> 00:17:25,189
one win egg drop again looks like it's

348
00:17:25,189 --> 00:17:28,010
like TCP port scanner from some

349
00:17:28,010 --> 00:17:32,000
third-party group now let's stop little

350
00:17:32,000 --> 00:17:34,010
bit about some of the molar families so

351
00:17:34,010 --> 00:17:37,250
the most prolific one is called alcohol

352
00:17:37,250 --> 00:17:40,640
and it's available for several different

353
00:17:40,640 --> 00:17:43,070
architectures we found binaries for

354
00:17:43,070 --> 00:17:44,630
Linux 32-bit six

355
00:17:44,630 --> 00:17:47,060
forbid the same for windows in for

356
00:17:47,060 --> 00:17:50,390
freebsd it a simple common grammar which

357
00:17:50,390 --> 00:17:53,510
is just for tasks one is to start task

358
00:17:53,510 --> 00:17:56,330
stop cast right fake configuration from

359
00:17:56,330 --> 00:17:59,630
status when you look when you look at

360
00:17:59,630 --> 00:18:02,150
these in in for example in wireshark

361
00:18:02,150 --> 00:18:05,060
they are just simple one simple bites

362
00:18:05,060 --> 00:18:09,260
telling like 01 02 03 04 specifying the

363
00:18:09,260 --> 00:18:11,360
task the builders are usually very

364
00:18:11,360 --> 00:18:13,460
simple as you can see the below some

365
00:18:13,460 --> 00:18:15,980
time just IP address or port sometimes

366
00:18:15,980 --> 00:18:19,850
just port when we get these binaries we

367
00:18:19,850 --> 00:18:21,890
are usually interested in CNC server

368
00:18:21,890 --> 00:18:24,440
address of C&C server and it's usually

369
00:18:24,440 --> 00:18:26,930
hard coded in the binary and when you

370
00:18:26,930 --> 00:18:28,790
really look to the end we always search

371
00:18:28,790 --> 00:18:31,750
for the short to short strings which had

372
00:18:31,750 --> 00:18:34,850
numbers and sometimes between them are a

373
00:18:34,850 --> 00:18:38,060
minus sign / or cologne then you look at

374
00:18:38,060 --> 00:18:40,880
this small small computation below it

375
00:18:40,880 --> 00:18:43,010
takes the first character subtract swad

376
00:18:43,010 --> 00:18:45,680
take second character XY and so on so

377
00:18:45,680 --> 00:18:48,680
from this very simple encoding we can

378
00:18:48,680 --> 00:18:51,830
see the result and know what is the

379
00:18:51,830 --> 00:18:54,500
command and control server maybe we can

380
00:18:54,500 --> 00:18:56,270
connect to it listen to it and

381
00:18:56,270 --> 00:19:00,590
understand what targets it attacks again

382
00:19:00,590 --> 00:19:05,000
like commanding control panels are

383
00:19:05,000 --> 00:19:07,730
usually very similar in the upper part

384
00:19:07,730 --> 00:19:10,970
is the list of of bots which are

385
00:19:10,970 --> 00:19:12,800
connected to the botnet in the bottom

386
00:19:12,800 --> 00:19:14,540
part you can specify the target IP

387
00:19:14,540 --> 00:19:17,000
address the port which it should attack

388
00:19:17,000 --> 00:19:19,460
number of threads length of the attack

389
00:19:19,460 --> 00:19:22,430
and also some specification like which

390
00:19:22,430 --> 00:19:24,710
kind of attack likes in flat UDP flat

391
00:19:24,710 --> 00:19:27,620
length of the payload and so on this is

392
00:19:27,620 --> 00:19:31,040
another example for for control panel

393
00:19:31,040 --> 00:19:33,560
for the same family this time you can

394
00:19:33,560 --> 00:19:37,550
see that's it let 11 machine is in the

395
00:19:37,550 --> 00:19:43,130
botnet running windows XP let's continue

396
00:19:43,130 --> 00:19:46,340
with families mr. black is a little

397
00:19:46,340 --> 00:19:49,630
stool with source code available online

398
00:19:49,630 --> 00:19:55,040
we have seen a new extensions of this

399
00:19:55,040 --> 00:19:56,690
project that

400
00:19:56,690 --> 00:19:58,670
contained also features like auto start

401
00:19:58,670 --> 00:20:01,700
or the usage of encryption the family is

402
00:20:01,700 --> 00:20:03,710
easily recognized by the presence of

403
00:20:03,710 --> 00:20:06,380
character strings like version X hacker

404
00:20:06,380 --> 00:20:09,340
deal with details the number of

405
00:20:09,340 --> 00:20:13,460
procedures for attacks and the number of

406
00:20:13,460 --> 00:20:15,820
platforms that are supported is quite

407
00:20:15,820 --> 00:20:19,850
robust and we have seen a control panel

408
00:20:19,850 --> 00:20:25,430
named sword Linux previously graph get

409
00:20:25,430 --> 00:20:28,670
family also known as lizards stress

410
00:20:28,670 --> 00:20:31,460
o'toole source code leaked in January

411
00:20:31,460 --> 00:20:34,790
2015 and it contained both the server

412
00:20:34,790 --> 00:20:38,120
and the client side intrusion is done

413
00:20:38,120 --> 00:20:40,460
usually by brute forcing down at login

414
00:20:40,460 --> 00:20:45,230
and abusing social corner abilities this

415
00:20:45,230 --> 00:20:49,850
boat listens to these commands that

416
00:20:49,850 --> 00:20:53,360
serve for attacks and we can say that

417
00:20:53,360 --> 00:20:57,020
graph get is public enemy number one for

418
00:20:57,020 --> 00:21:00,050
embedded devices because there is the

419
00:21:00,050 --> 00:21:03,320
widest support for architectures and

420
00:21:03,320 --> 00:21:05,900
we've seen variants also for exotic ones

421
00:21:05,900 --> 00:21:11,410
like a super h or powerpc or motorola

422
00:21:12,490 --> 00:21:16,370
6809 threat interesting 130 does its

423
00:21:16,370 --> 00:21:19,130
danger for mostly danger for linux

424
00:21:19,130 --> 00:21:22,010
servers because it attempts to include

425
00:21:22,010 --> 00:21:24,830
via ssh brute force inc and the core of

426
00:21:24,830 --> 00:21:26,540
this threat was in the installation

427
00:21:26,540 --> 00:21:28,730
script which collects information about

428
00:21:28,730 --> 00:21:31,880
victims system and indicate in case when

429
00:21:31,880 --> 00:21:35,000
server-side does not recognize kernel

430
00:21:35,000 --> 00:21:37,640
version it sends an uploader that

431
00:21:37,640 --> 00:21:40,040
collects colonel headers and the purpose

432
00:21:40,040 --> 00:21:42,830
of these actions is that define the

433
00:21:42,830 --> 00:21:47,300
final binary is that is a Trojan context

434
00:21:47,300 --> 00:21:50,360
also a loadable kernel module a rootkit

435
00:21:50,360 --> 00:21:53,240
host purpose is to hide indicators of

436
00:21:53,240 --> 00:21:57,110
compromise and this rootkit is based on

437
00:21:57,110 --> 00:22:00,530
an open source project called suitors

438
00:22:00,530 --> 00:22:04,400
ooh that was also available and besides

439
00:22:04,400 --> 00:22:06,350
already mentioned autostart features in

440
00:22:06,350 --> 00:22:09,159
the beginning this one also possess

441
00:22:09,159 --> 00:22:13,599
one when this multi-threaded program

442
00:22:13,599 --> 00:22:16,539
repeatedly installs itself in multiple

443
00:22:16,539 --> 00:22:18,909
copies under random name into the bill

444
00:22:18,909 --> 00:22:21,639
directory and execute itself so it's

445
00:22:21,639 --> 00:22:24,369
quite hard to terminate it by our kill

446
00:22:24,369 --> 00:22:28,139
command the name comes from the usage of

447
00:22:28,139 --> 00:22:32,259
encryption decryption and it is if it's

448
00:22:32,259 --> 00:22:34,690
done for communication and also for the

449
00:22:34,690 --> 00:22:36,580
configuration file the purpose of this

450
00:22:36,580 --> 00:22:39,759
file is to list all rivals that need to

451
00:22:39,759 --> 00:22:41,559
be eliminated from the rug from the

452
00:22:41,559 --> 00:22:43,690
victims system and it could be based on

453
00:22:43,690 --> 00:22:45,789
various categories like the hash of the

454
00:22:45,789 --> 00:22:48,879
file the file name or the process that

455
00:22:48,879 --> 00:22:52,570
is connecting to a certain IP and this

456
00:22:52,570 --> 00:22:56,229
is an extensive list of file names that

457
00:22:56,229 --> 00:22:58,289
are not friends took sorry those and

458
00:22:58,289 --> 00:23:04,090
most of them are the competing deals

459
00:23:04,090 --> 00:23:09,669
Trojans we were mentioning so this is a

460
00:23:09,669 --> 00:23:13,149
screenshot from an experiment we ran and

461
00:23:13,149 --> 00:23:14,830
this is a Windows graphic user interface

462
00:23:14,830 --> 00:23:18,789
of CNC panel we run two BOTS one on

463
00:23:18,789 --> 00:23:21,309
classic clinics on Intel Architecture

464
00:23:21,309 --> 00:23:26,259
and one on chemo emulating arm and we

465
00:23:26,259 --> 00:23:29,429
found out that they both spoke the same

466
00:23:29,429 --> 00:23:34,149
network protocol so and this is the

467
00:23:34,149 --> 00:23:38,409
result of the experiment China's at

468
00:23:38,409 --> 00:23:41,109
another project that is available that

469
00:23:41,109 --> 00:23:43,599
was available on github and the name D

470
00:23:43,599 --> 00:23:46,899
does client so you see there's no need

471
00:23:46,899 --> 00:23:51,070
to reverse much in this case it's

472
00:23:51,070 --> 00:23:54,220
similar volumetric attacks and support

473
00:23:54,220 --> 00:23:58,649
for platforms some upx compression

474
00:23:58,649 --> 00:24:03,419
involved and they also have some some

475
00:24:03,419 --> 00:24:06,369
panels with graphic user interface these

476
00:24:06,369 --> 00:24:09,009
runs and windows and one of these is

477
00:24:09,009 --> 00:24:11,919
just the web web based interface for

478
00:24:11,919 --> 00:24:16,479
controlling botnet so we haven't

479
00:24:16,479 --> 00:24:19,720
listened we didn't listen to every CNC

480
00:24:19,720 --> 00:24:21,879
of every family we mentioned but from

481
00:24:21,879 --> 00:24:22,870
those we did

482
00:24:22,870 --> 00:24:25,270
we learned that the targets are mostly

483
00:24:25,270 --> 00:24:27,720
small or medium-sized businesses like

484
00:24:27,720 --> 00:24:31,410
online gaming sites casinos ecommerce or

485
00:24:31,410 --> 00:24:36,430
forums and police profitability depends

486
00:24:36,430 --> 00:24:38,020
on the ability of staying online and

487
00:24:38,020 --> 00:24:42,850
mostly not hosted on major content

488
00:24:42,850 --> 00:24:44,920
delivery networks but solely those was

489
00:24:44,920 --> 00:24:48,100
an exception it was confident enough to

490
00:24:48,100 --> 00:24:50,140
attack the infrastructure of large

491
00:24:50,140 --> 00:24:52,440
providers like Google cloud or

492
00:24:52,440 --> 00:24:54,970
CloudFlare amazing cloud akamai

493
00:24:54,970 --> 00:24:58,210
technologies and for the previous case

494
00:24:58,210 --> 00:25:00,250
the effect of leaders was directly

495
00:25:00,250 --> 00:25:02,110
observed because we've collected the IP

496
00:25:02,110 --> 00:25:05,950
list of ips of targets and after some

497
00:25:05,950 --> 00:25:08,200
time we checked those IPS and service

498
00:25:08,200 --> 00:25:12,910
was up and running so to conclude with

499
00:25:12,910 --> 00:25:16,270
some points from what we've seen ledos

500
00:25:16,270 --> 00:25:18,580
Trojans could be considered a threat

501
00:25:18,580 --> 00:25:20,950
number one for servers and embedded

502
00:25:20,950 --> 00:25:25,480
systems running Linux the a variety of

503
00:25:25,480 --> 00:25:28,120
projects available on code sharing sites

504
00:25:28,120 --> 00:25:31,420
and so we could expect more project that

505
00:25:31,420 --> 00:25:35,880
would wrap these or mix mix with these

506
00:25:35,880 --> 00:25:39,460
autostart is desired and often or in

507
00:25:39,460 --> 00:25:43,450
some cases advanced feature attack

508
00:25:43,450 --> 00:25:47,160
metals are roughly roughly the same and

509
00:25:47,160 --> 00:25:52,090
for the time being we say that there are

510
00:25:52,090 --> 00:25:53,890
only little attempts to cover the

511
00:25:53,890 --> 00:25:56,800
functionality at least by stripping of

512
00:25:56,800 --> 00:26:01,030
debugging symbols or by using classic or

513
00:26:01,030 --> 00:26:05,380
modified upx we confirm that there's

514
00:26:05,380 --> 00:26:09,429
increased detection ratio rates by AV

515
00:26:09,429 --> 00:26:12,900
solutions but distributors of mother are

516
00:26:12,900 --> 00:26:15,910
careless about this fact they don't

517
00:26:15,910 --> 00:26:18,820
don't switch they don't use polymorphism

518
00:26:18,820 --> 00:26:24,130
at the moment and what we said about

519
00:26:24,130 --> 00:26:31,090
targets so we would like to thank of

520
00:26:31,090 --> 00:26:33,940
some people and Twitter entities that

521
00:26:33,940 --> 00:26:36,240
are listed here

522
00:26:36,240 --> 00:26:39,940
we've seen a ban on a list so he'll ban

523
00:26:39,940 --> 00:26:46,360
and recently a few days ago a group of

524
00:26:46,360 --> 00:26:50,410
Japanese and German scientists notified

525
00:26:50,410 --> 00:26:52,350
that about about their cool research

526
00:26:52,350 --> 00:26:55,780
published in may this year they've built

527
00:26:55,780 --> 00:27:00,250
a honeypot based or able to communicate

528
00:27:00,250 --> 00:27:03,010
with IOT devices and they communicated

529
00:27:03,010 --> 00:27:07,360
with really exotic devices like heat

530
00:27:07,360 --> 00:27:10,510
pumps and all of those infected and in a

531
00:27:10,510 --> 00:27:14,080
month they've collected about 150 50

532
00:27:14,080 --> 00:27:16,780
samples with no surprise wizard

533
00:27:16,780 --> 00:27:19,090
versatile was the majority of those but

534
00:27:19,090 --> 00:27:22,090
there were some moves and also boats

535
00:27:22,090 --> 00:27:24,550
that were undocumented and mostly

536
00:27:24,550 --> 00:27:27,850
undetected at the time so if you're

537
00:27:27,850 --> 00:27:31,420
interested in embedded Mulder you we

538
00:27:31,420 --> 00:27:36,100
really recommend this research and I

539
00:27:36,100 --> 00:27:39,760
guess that's all from our side if you

540
00:27:39,760 --> 00:27:42,280
have any questions well I think that

541
00:27:42,280 --> 00:27:44,140
because we started a little bit like

542
00:27:44,140 --> 00:27:46,300
there is no space for question but I

543
00:27:46,300 --> 00:27:48,490
believe that the guys will be available

544
00:27:48,490 --> 00:27:50,590
through the whole conference so if you

545
00:27:50,590 --> 00:27:52,450
have any question to them pebble sorry

546
00:27:52,450 --> 00:27:54,100
we do have five minutes because we

547
00:27:54,100 --> 00:27:55,960
started five minutes late and we will

548
00:27:55,960 --> 00:27:58,330
give you the whole half an hour okay

549
00:27:58,330 --> 00:28:02,400
it's okay 33 sorry three minutes free

550
00:28:02,400 --> 00:28:05,080
they take back my water there are some

551
00:28:05,080 --> 00:28:09,659
questions I sit down so I stepped on

552
00:28:10,860 --> 00:28:14,020
just wait for the michael you hello

553
00:28:14,020 --> 00:28:16,210
uranium la famille chica great great

554
00:28:16,210 --> 00:28:18,429
work thank you so you mentioned that

555
00:28:18,429 --> 00:28:21,730
right now the moderators don't do any

556
00:28:21,730 --> 00:28:26,980
kind of detection evasion so they do

557
00:28:26,980 --> 00:28:28,809
would you think that that would be very

558
00:28:28,809 --> 00:28:30,400
likely because that's probably is the

559
00:28:30,400 --> 00:28:33,150
next stage in evolution

560
00:28:34,490 --> 00:28:38,270
so so the malvern it depends on which

561
00:28:38,270 --> 00:28:40,790
machines it's in it is installed because

562
00:28:40,790 --> 00:28:43,010
if it is installed for example on some

563
00:28:43,010 --> 00:28:45,350
more routers they don't need to anything

564
00:28:45,350 --> 00:28:47,660
like because on routers there is like no

565
00:28:47,660 --> 00:28:49,850
AV solution and nothing like that so

566
00:28:49,850 --> 00:28:52,190
they probably keep it as it is but

567
00:28:52,190 --> 00:28:53,450
they're like some families which are

568
00:28:53,450 --> 00:28:57,610
more like targeting the Linux servers or

569
00:28:57,610 --> 00:28:59,570
there might be some changes in the

570
00:28:59,570 --> 00:29:01,910
future but I don't think for the

571
00:29:01,910 --> 00:29:03,950
embedded devices they will they will do

572
00:29:03,950 --> 00:29:08,120
much change in the future another

573
00:29:08,120 --> 00:29:13,270
question you in the back

574
00:29:20,210 --> 00:29:24,179
nice talk thank you could you clarify a

575
00:29:24,179 --> 00:29:26,160
little bit more the autostart feature

576
00:29:26,160 --> 00:29:28,380
you're just you describe give a more a

577
00:29:28,380 --> 00:29:31,049
few more details valid like for auto

578
00:29:31,049 --> 00:29:33,270
stock is like the persistent so when do

579
00:29:33,270 --> 00:29:37,169
when the machine is rebooted the malware

580
00:29:37,169 --> 00:29:39,330
starts again and we found that they are

581
00:29:39,330 --> 00:29:41,760
you like like two men or three main

582
00:29:41,760 --> 00:29:44,970
types they either put some script and it

583
00:29:44,970 --> 00:29:47,760
is great just small text file which

584
00:29:47,760 --> 00:29:50,880
points or which contains the path to the

585
00:29:50,880 --> 00:29:53,760
file with parties usually installed so

586
00:29:53,760 --> 00:29:55,350
it's one option it was option one an

587
00:29:55,350 --> 00:29:57,120
option three because they're like

588
00:29:57,120 --> 00:30:00,330
different paths depending on the linux

589
00:30:00,330 --> 00:30:03,690
distribution it runs it's like one case

590
00:30:03,690 --> 00:30:06,720
and other case is modifying her own

591
00:30:06,720 --> 00:30:09,500
files or on file the file which contains

592
00:30:09,500 --> 00:30:13,110
several its txt file and on each file

593
00:30:13,110 --> 00:30:16,470
each line there is the like name or path

594
00:30:16,470 --> 00:30:18,809
to due process and interval in which it

595
00:30:18,809 --> 00:30:21,539
should be started again so that these

596
00:30:21,539 --> 00:30:24,600
are too many times which we noticed in

597
00:30:24,600 --> 00:30:29,640
mother okay so thank you very much for

598
00:30:29,640 --> 00:30:33,049
your presentation

