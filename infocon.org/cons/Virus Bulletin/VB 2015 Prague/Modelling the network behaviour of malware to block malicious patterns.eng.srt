1
00:00:05,509 --> 00:00:09,420
and momentarily we'll be starting our

2
00:00:09,420 --> 00:00:12,179
next presentation so please take your

3
00:00:12,179 --> 00:00:17,220
seats and welcome to introduce Sebastian

4
00:00:17,220 --> 00:00:20,699
Sebastian Garcia who's a university

5
00:00:20,699 --> 00:00:23,970
student and one of part of the next

6
00:00:23,970 --> 00:00:26,760
generation of security personnel

7
00:00:26,760 --> 00:00:27,869
professionals

8
00:00:27,869 --> 00:00:30,630
unlike next-gen firewall and next-gen

9
00:00:30,630 --> 00:00:33,690
everything else thank you very much

10
00:00:33,690 --> 00:00:36,570
that's too much maybe ok so welcome

11
00:00:36,570 --> 00:00:39,239
everyone how are you thank you very much

12
00:00:39,239 --> 00:00:40,020
for being here

13
00:00:40,020 --> 00:00:43,200
I'm Sebastian Garcia I'm a researcher in

14
00:00:43,200 --> 00:00:45,210
Czech Technical University here in

15
00:00:45,210 --> 00:00:47,969
Prague so it's very nice to hear and I

16
00:00:47,969 --> 00:00:49,980
don't have to move a lot it's very very

17
00:00:49,980 --> 00:00:54,930
nice and I'm going to talk about how we

18
00:00:54,930 --> 00:00:57,449
are modeling the network behavior of

19
00:00:57,449 --> 00:01:00,239
malware using behavioral patterns and

20
00:01:00,239 --> 00:01:02,250
this is a research that started a long

21
00:01:02,250 --> 00:01:03,840
time ago and we are doing it in the

22
00:01:03,840 --> 00:01:07,350
university and especially we are dealing

23
00:01:07,350 --> 00:01:10,020
with the network here right so when you

24
00:01:10,020 --> 00:01:12,659
work with malware stuff botnet stuff and

25
00:01:12,659 --> 00:01:14,880
you are trying to detect behavior it's

26
00:01:14,880 --> 00:01:16,290
completely different if you are doing it

27
00:01:16,290 --> 00:01:18,150
in a network if you are doing it inside

28
00:01:18,150 --> 00:01:19,560
the house or inside the vinery

29
00:01:19,560 --> 00:01:21,450
right so we are dealing with network

30
00:01:21,450 --> 00:01:23,729
security here which who in the audience

31
00:01:23,729 --> 00:01:26,040
is working with network detection at

32
00:01:26,040 --> 00:01:28,650
different levels and not in binary some

33
00:01:28,650 --> 00:01:30,750
of the stuff they are there someone

34
00:01:30,750 --> 00:01:32,729
there they are here ok thank you very

35
00:01:32,729 --> 00:01:35,820
much so please feel free to join and say

36
00:01:35,820 --> 00:01:39,979
that's wrong or something like that so

37
00:01:39,979 --> 00:01:42,630
actually when we are working with

38
00:01:42,630 --> 00:01:45,360
network solutions there is a lot of

39
00:01:45,360 --> 00:01:46,950
research but when you have an issue and

40
00:01:46,950 --> 00:01:48,299
you have a problem and you go to the

41
00:01:48,299 --> 00:01:50,250
network and you want to fix it this is

42
00:01:50,250 --> 00:01:51,930
what we have now this is the best we

43
00:01:51,930 --> 00:01:54,540
have now right so we have some

44
00:01:54,540 --> 00:01:57,210
indicators of compromise there and this

45
00:01:57,210 --> 00:02:01,229
is domains URLs IP addresses and you got

46
00:02:01,229 --> 00:02:02,939
this and you don't know the widely it's

47
00:02:02,939 --> 00:02:04,979
blog lease on feeds and say yeah yeah I

48
00:02:04,979 --> 00:02:06,270
should all know this put it in the

49
00:02:06,270 --> 00:02:08,818
firewall and if not you are running

50
00:02:08,818 --> 00:02:10,619
something that has some fingerprints in

51
00:02:10,619 --> 00:02:13,349
there I say ok payloads right I can run

52
00:02:13,349 --> 00:02:13,740
snow

53
00:02:13,740 --> 00:02:15,420
or turbo or something bro actually it's

54
00:02:15,420 --> 00:02:17,220
not with fingerprints it's with a very

55
00:02:17,220 --> 00:02:20,580
nice language for detection but this is

56
00:02:20,580 --> 00:02:22,080
what you have and if you are getting

57
00:02:22,080 --> 00:02:24,120
really complex you're going to say hey I

58
00:02:24,120 --> 00:02:28,260
have anomaly detection here right so who

59
00:02:28,260 --> 00:02:29,910
is running some anomaly detection

60
00:02:29,910 --> 00:02:32,370
technique at some point in Edward you

61
00:02:32,370 --> 00:02:33,960
are this is very nice and there and

62
00:02:33,960 --> 00:02:36,360
there someone anime detection so the

63
00:02:36,360 --> 00:02:37,710
people is over here so machine learning

64
00:02:37,710 --> 00:02:39,990
artificial intelligence and one of the

65
00:02:39,990 --> 00:02:42,570
most famous techniques is anomaly

66
00:02:42,570 --> 00:02:45,240
detection and I have to say that this is

67
00:02:45,240 --> 00:02:47,550
the best we have but unfortunately this

68
00:02:47,550 --> 00:02:49,680
is not enough and if you're working this

69
00:02:49,680 --> 00:02:51,600
you know that at some point this is not

70
00:02:51,600 --> 00:02:53,850
working right so we have some issues in

71
00:02:53,850 --> 00:02:57,540
here and they shoes are that for example

72
00:02:57,540 --> 00:02:59,250
which is the lifetime of these

73
00:02:59,250 --> 00:03:01,830
indicators of compromise how long should

74
00:03:01,830 --> 00:03:05,130
you use the domain to be blog how long

75
00:03:05,130 --> 00:03:07,890
should you look an IP address how long

76
00:03:07,890 --> 00:03:10,260
some URL pattern is going to work or not

77
00:03:10,260 --> 00:03:13,500
and these lifetimes it's very difficult

78
00:03:13,500 --> 00:03:16,200
right I don't wanna go deep here but

79
00:03:16,200 --> 00:03:18,900
there are some analyses and say hey yeah

80
00:03:18,900 --> 00:03:21,150
I'm putting this in the list for one

81
00:03:21,150 --> 00:03:24,030
small one month sorry fifteen days one

82
00:03:24,030 --> 00:03:27,000
day you never know forever and then you

83
00:03:27,000 --> 00:03:29,700
have the verification like okay yeah we

84
00:03:29,700 --> 00:03:31,200
have this domain here we have a host

85
00:03:31,200 --> 00:03:32,820
name and who is verifying that this is

86
00:03:32,820 --> 00:03:35,610
malicious well fortunately people is

87
00:03:35,610 --> 00:03:38,490
verifying it right unfortunately people

88
00:03:38,490 --> 00:03:40,800
is verifying it so if you go to for

89
00:03:40,800 --> 00:03:43,010
example virus tota and you search for

90
00:03:43,010 --> 00:03:46,010
www.google.com/mapmaker

91
00:03:55,140 --> 00:03:57,570
because verification is very difficult

92
00:03:57,570 --> 00:04:00,510
you know Google is really an address

93
00:04:00,510 --> 00:04:02,610
that everyone is accessing so Margulis

94
00:04:02,610 --> 00:04:04,620
accessing we are accessing but if you

95
00:04:04,620 --> 00:04:06,480
are trying to automate this verification

96
00:04:06,480 --> 00:04:09,570
is crucial so most of this stuff is very

97
00:04:09,570 --> 00:04:11,910
difficult to verify and that's why you

98
00:04:11,910 --> 00:04:14,030
have this errors in there right

99
00:04:14,030 --> 00:04:16,709
another issue is the huge amount in

100
00:04:16,709 --> 00:04:18,870
malware can generate thousands of IP

101
00:04:18,870 --> 00:04:20,940
addresses thousands of URLs thousands of

102
00:04:20,940 --> 00:04:23,700
domains and at some point you cannot

103
00:04:23,700 --> 00:04:26,680
block them all you cannot put in every

104
00:04:26,680 --> 00:04:29,210
vice-like several thousand rules for

105
00:04:29,210 --> 00:04:31,280
blood everything so you go to patterns

106
00:04:31,280 --> 00:04:33,020
you go to fingerprints you go to anomaly

107
00:04:33,020 --> 00:04:35,210
detection and this becomes an issue more

108
00:04:35,210 --> 00:04:38,210
and more also more of a lot of these

109
00:04:38,210 --> 00:04:40,820
solutions are static so they are not

110
00:04:40,820 --> 00:04:43,130
evolving in time so should have updated

111
00:04:43,130 --> 00:04:45,200
every time again and again and they are

112
00:04:45,200 --> 00:04:48,500
stopped working after some times and in

113
00:04:48,500 --> 00:04:50,090
the case of anomaly detection I'm not

114
00:04:50,090 --> 00:04:51,440
sure your experience but in my

115
00:04:51,440 --> 00:04:54,020
experience it's very hard to make it

116
00:04:54,020 --> 00:04:58,010
work very hard it's working the context

117
00:04:58,010 --> 00:05:00,140
should be very small and you should do a

118
00:05:00,140 --> 00:05:02,330
lot of work in there at some point you

119
00:05:02,330 --> 00:05:04,790
have something but very important is

120
00:05:04,790 --> 00:05:06,380
that you say that you are detecting

121
00:05:06,380 --> 00:05:08,600
anomalies and not something malicious

122
00:05:08,600 --> 00:05:11,030
because an anomaly is not by default

123
00:05:11,030 --> 00:05:12,770
something malicious and I know Alice an

124
00:05:12,770 --> 00:05:14,870
anomaly so you should have people that

125
00:05:14,870 --> 00:05:16,820
are checking if those anomalies are

126
00:05:16,820 --> 00:05:19,880
actually malware or threats or not so

127
00:05:19,880 --> 00:05:23,180
this is not easy job and actually we

128
00:05:23,180 --> 00:05:24,710
think that we can do this better we

129
00:05:24,710 --> 00:05:27,140
shoot this better and that's why we are

130
00:05:27,140 --> 00:05:30,070
going to talk how we can work with

131
00:05:30,070 --> 00:05:33,560
behavioral models in the network using

132
00:05:33,560 --> 00:05:35,630
machine learning to detect botnets and

133
00:05:35,630 --> 00:05:38,420
malware and this attacks so we think

134
00:05:38,420 --> 00:05:40,670
that machine learning it's actually

135
00:05:40,670 --> 00:05:43,010
something that it's very helpful and

136
00:05:43,010 --> 00:05:45,290
it's going to be more helpful if we can

137
00:05:45,290 --> 00:05:47,540
do it properly but we should keep

138
00:05:47,540 --> 00:05:49,760
working on this right so what I'm going

139
00:05:49,760 --> 00:05:53,330
to present you is the stratosphere IPS

140
00:05:53,330 --> 00:05:55,760
prochaine this is the project oh sorry

141
00:05:55,760 --> 00:05:58,850
we are having in the universities our

142
00:05:58,850 --> 00:06:00,680
main project in security a malware

143
00:06:00,680 --> 00:06:04,730
detection and we have four main ideas in

144
00:06:04,730 --> 00:06:07,040
here so the first one is free software

145
00:06:07,040 --> 00:06:09,890
it's free software and why is that it's

146
00:06:09,890 --> 00:06:13,460
because we need this software to be

147
00:06:13,460 --> 00:06:16,370
verifiable others we need these machine

148
00:06:16,370 --> 00:06:18,500
learning and these behavioral patterns

149
00:06:18,500 --> 00:06:20,780
to be checked to be implemented to be

150
00:06:20,780 --> 00:06:23,630
test to have errors to solve the errors

151
00:06:23,630 --> 00:06:25,310
we need the people to see what's going

152
00:06:25,310 --> 00:06:29,060
on and also other order of the main

153
00:06:29,060 --> 00:06:31,280
ideas of the project it is to focus in

154
00:06:31,280 --> 00:06:34,580
NGOs and sit in society organizations so

155
00:06:34,580 --> 00:06:38,960
I some years ago the citizen lab group

156
00:06:38,960 --> 00:06:40,430
had a report

157
00:06:40,430 --> 00:06:42,860
targeted threats and they say something

158
00:06:42,860 --> 00:06:45,639
very very nice they say that usually

159
00:06:45,639 --> 00:06:49,430
NGOs and civil society organizations are

160
00:06:49,430 --> 00:06:51,410
attacked very very hard

161
00:06:51,410 --> 00:06:55,810
they are tagged with very very important

162
00:06:55,810 --> 00:06:59,360
malware from very important actors but

163
00:06:59,360 --> 00:07:01,220
they don't have the money they cannot

164
00:07:01,220 --> 00:07:04,220
afford buying very nice solutions like

165
00:07:04,220 --> 00:07:06,710
I'm sure most of you can sell in

166
00:07:06,710 --> 00:07:08,240
antivirus companies they cannot afford

167
00:07:08,240 --> 00:07:11,350
it right so they have there a lot of

168
00:07:11,350 --> 00:07:13,370
organizations that they have very

169
00:07:13,370 --> 00:07:15,919
important problems and they cannot solve

170
00:07:15,919 --> 00:07:19,190
them if you know Claudia where nearly is

171
00:07:19,190 --> 00:07:22,760
going to lead talk tomorrow I think

172
00:07:22,760 --> 00:07:26,060
about helping the helpless and I highly

173
00:07:26,060 --> 00:07:27,770
recommend you go there because he's

174
00:07:27,770 --> 00:07:29,150
going to talk a lot about this and I

175
00:07:29,150 --> 00:07:31,539
think Claudia because this is part of

176
00:07:31,539 --> 00:07:34,190
what we are trying to do here we try to

177
00:07:34,190 --> 00:07:38,630
focus in helping NGOs and CSOs and for

178
00:07:38,630 --> 00:07:40,639
that it means that we should take

179
00:07:40,639 --> 00:07:43,400
privacy into account very seriously and

180
00:07:43,400 --> 00:07:45,139
that's why the free software is also

181
00:07:45,139 --> 00:07:47,900
here because we need to be very trustful

182
00:07:47,900 --> 00:07:53,030
ok the other part is the verification so

183
00:07:53,030 --> 00:07:54,860
since we're a University and we are

184
00:07:54,860 --> 00:07:57,320
doing this research we want it to be

185
00:07:57,320 --> 00:08:00,110
verified and this is hard you know it

186
00:08:00,110 --> 00:08:01,970
right if I'm asking you okay you have

187
00:08:01,970 --> 00:08:04,010
some products some really nice product

188
00:08:04,010 --> 00:08:07,669
and do you know how good it is and this

189
00:08:07,669 --> 00:08:10,729
is her question you know yeah it's good

190
00:08:10,729 --> 00:08:13,760
but how good how you compare it how is

191
00:08:13,760 --> 00:08:16,159
this changed in time so verification is

192
00:08:16,159 --> 00:08:18,169
very important for us and we are going

193
00:08:18,169 --> 00:08:20,659
to talk more about later but in the

194
00:08:20,659 --> 00:08:22,669
stratosphere IPS project these are the

195
00:08:22,669 --> 00:08:25,760
four main ideas that are driving us to

196
00:08:25,760 --> 00:08:30,320
create it so technically speaking which

197
00:08:30,320 --> 00:08:32,510
are the pillars in here and I want to be

198
00:08:32,510 --> 00:08:34,880
very brief I'm not going to go too much

199
00:08:34,880 --> 00:08:37,099
into details we don't talk it later but

200
00:08:37,099 --> 00:08:40,070
we start saying less is more this is one

201
00:08:40,070 --> 00:08:44,450
of our main goals with when we are

202
00:08:44,450 --> 00:08:46,640
dealing with machine learning less small

203
00:08:46,640 --> 00:08:49,520
and then we are going to talk about how

204
00:08:49,520 --> 00:08:52,420
we came to the idea of this association

205
00:08:52,420 --> 00:08:54,519
disassociate the models in the network

206
00:08:54,519 --> 00:08:57,089
and finally the third pillar is the

207
00:08:57,089 --> 00:09:01,660
verification so this means that when we

208
00:09:01,660 --> 00:09:04,560
analyze the behavior of the connections

209
00:09:04,560 --> 00:09:08,230
we are not focusing on what your host is

210
00:09:08,230 --> 00:09:09,730
doing we don't care about what's

211
00:09:09,730 --> 00:09:11,709
happening on your network we are

212
00:09:11,709 --> 00:09:15,130
focusing in one and only one connection

213
00:09:15,130 --> 00:09:18,250
at a time and this is giving us a small

214
00:09:18,250 --> 00:09:22,870
amount of data that it's such it's good

215
00:09:22,870 --> 00:09:24,699
data but it's small enough that we can

216
00:09:24,699 --> 00:09:26,560
deal with this with machine learning

217
00:09:26,560 --> 00:09:29,709
algorithms and then we can go back so we

218
00:09:29,709 --> 00:09:32,350
are going to work first with less amount

219
00:09:32,350 --> 00:09:35,050
of information we don't want to run an

220
00:09:35,050 --> 00:09:37,089
anomaly detection in the network per

221
00:09:37,089 --> 00:09:40,320
cell and another main idea here is the

222
00:09:40,320 --> 00:09:44,130
disassociation this means that we build

223
00:09:44,130 --> 00:09:49,649
the behavior of the network the

224
00:09:49,649 --> 00:09:52,690
representation and we are separating it

225
00:09:52,690 --> 00:09:56,139
from how we detect this behavior so

226
00:09:56,139 --> 00:09:58,060
first we are going to work and do some

227
00:09:58,060 --> 00:10:00,610
research on how can we represent this

228
00:10:00,610 --> 00:10:02,230
behavior I don't care about detection

229
00:10:02,230 --> 00:10:04,630
yet so I'm not thinking about any fancy

230
00:10:04,630 --> 00:10:07,089
algorithm yet and now that I can

231
00:10:07,089 --> 00:10:09,430
represent the behavior I'm looking for I

232
00:10:09,430 --> 00:10:11,890
will stop and we will start trying

233
00:10:11,890 --> 00:10:13,420
different detection methods on these

234
00:10:13,420 --> 00:10:15,279
usually when the people is researching

235
00:10:15,279 --> 00:10:18,010
there I can deduce my hands but they are

236
00:10:18,010 --> 00:10:20,470
doing this all together right there they

237
00:10:20,470 --> 00:10:22,779
are putting all the detection methods

238
00:10:22,779 --> 00:10:24,190
and all the representations on the

239
00:10:24,190 --> 00:10:26,019
packets and the floats all together they

240
00:10:26,019 --> 00:10:27,970
run an algorithm and it's maybe working

241
00:10:27,970 --> 00:10:31,810
but this is very hard to scale so we are

242
00:10:31,810 --> 00:10:33,430
going to disassociate it and I'm going

243
00:10:33,430 --> 00:10:35,890
to tell you more and finally this is

244
00:10:35,890 --> 00:10:37,569
that for verification

245
00:10:37,569 --> 00:10:40,930
we need real and label normal and

246
00:10:40,930 --> 00:10:44,740
malware data okay without the real and

247
00:10:44,740 --> 00:10:47,319
good datasets if you were in the keynote

248
00:10:47,319 --> 00:10:50,260
yes the speaker was talking about how

249
00:10:50,260 --> 00:10:52,389
they were creating a very large and

250
00:10:52,389 --> 00:10:55,569
important data set of cyber ware or

251
00:10:55,569 --> 00:10:59,949
malware and Viner ease ok that's what we

252
00:10:59,949 --> 00:11:01,540
are looking for not winery's we are

253
00:11:01,540 --> 00:11:03,279
doing it in a network but we want to

254
00:11:03,279 --> 00:11:07,509
a very nice verification with real data

255
00:11:07,509 --> 00:11:12,430
so going to les is small what less is

256
00:11:12,430 --> 00:11:15,850
more this means like when you are

257
00:11:15,850 --> 00:11:18,100
connecting to some service in the

258
00:11:18,100 --> 00:11:20,769
network like Gmail or you're listening

259
00:11:20,769 --> 00:11:23,529
to music or you're chatting when you are

260
00:11:23,529 --> 00:11:25,870
doing that your behavior is usually the

261
00:11:25,870 --> 00:11:28,720
same right you're human beings so we are

262
00:11:28,720 --> 00:11:31,749
behavioral by nature and when you are

263
00:11:31,749 --> 00:11:33,759
using it when you are trying to access a

264
00:11:33,759 --> 00:11:36,459
website you have patterns in there you

265
00:11:36,459 --> 00:11:38,050
are changing a lot but you are not

266
00:11:38,050 --> 00:11:40,870
random so you are doing it in a very

267
00:11:40,870 --> 00:11:43,990
very similar way and the malware in some

268
00:11:43,990 --> 00:11:47,800
senses is not different to that so what

269
00:11:47,800 --> 00:11:49,899
we are doing is that we are grouping all

270
00:11:49,899 --> 00:11:53,019
the flows we first get the packets then

271
00:11:53,019 --> 00:11:54,670
get the flows and we are grouping or the

272
00:11:54,670 --> 00:11:57,249
flows that are going to some specific

273
00:11:57,249 --> 00:12:01,029
service like for example port 80 in the

274
00:12:01,029 --> 00:12:04,180
IP address of Google or some port for

275
00:12:04,180 --> 00:12:06,370
the sage or email or whatever you are

276
00:12:06,370 --> 00:12:08,529
connecting so we are only taking these

277
00:12:08,529 --> 00:12:11,410
flows all together and say okay these

278
00:12:11,410 --> 00:12:12,939
are your flows when you connect to

279
00:12:12,939 --> 00:12:14,709
Google and actually don't care if you

280
00:12:14,709 --> 00:12:16,899
are connecting today and then in five

281
00:12:16,899 --> 00:12:19,180
days on in one hour or whenever we are

282
00:12:19,180 --> 00:12:20,889
connecting when you are connecting again

283
00:12:20,889 --> 00:12:22,809
I will get your flow and will put them

284
00:12:22,809 --> 00:12:26,439
all together right and then we have the

285
00:12:26,439 --> 00:12:28,720
disconnection that is composed of

286
00:12:28,720 --> 00:12:32,410
several flows now shows a behavior this

287
00:12:32,410 --> 00:12:35,050
connection if we wait in time it's

288
00:12:35,050 --> 00:12:37,449
starting to show in a behavior and that

289
00:12:37,449 --> 00:12:40,300
means that when you are

290
00:12:40,300 --> 00:12:43,029
for example browsing Google or using

291
00:12:43,029 --> 00:12:45,730
Gmail maybe you don't notice but you are

292
00:12:45,730 --> 00:12:48,459
going from one state of your behavior to

293
00:12:48,459 --> 00:12:50,500
another like sending email not animal

294
00:12:50,500 --> 00:12:53,230
chatting no chatting sending a file not

295
00:12:53,230 --> 00:12:55,300
cinephile doing nothing and be the

296
00:12:55,300 --> 00:12:57,850
little playing music download the video

297
00:12:57,850 --> 00:13:01,029
download the video so we can recognize

298
00:13:01,029 --> 00:13:05,319
these states and we want to be able to

299
00:13:05,319 --> 00:13:07,029
work with these states in the

300
00:13:07,029 --> 00:13:09,819
connections so each flow inside the

301
00:13:09,819 --> 00:13:13,120
connection it's getting its own State

302
00:13:13,120 --> 00:13:16,520
okay and we model

303
00:13:16,520 --> 00:13:18,860
we model this estate based on these four

304
00:13:18,860 --> 00:13:23,570
features and a mask sometimes like why

305
00:13:23,570 --> 00:13:25,010
these four features that you can use

306
00:13:25,010 --> 00:13:27,110
like several dozens of features yeah we

307
00:13:27,110 --> 00:13:29,540
can use hundreds of features but after a

308
00:13:29,540 --> 00:13:31,940
lot of research and working with very

309
00:13:31,940 --> 00:13:33,860
complex model we find out that a very

310
00:13:33,860 --> 00:13:36,470
simple model with this four feature is

311
00:13:36,470 --> 00:13:39,500
the best we can do because we can

312
00:13:39,500 --> 00:13:43,640
understand it so we are taking the size

313
00:13:43,640 --> 00:13:45,230
of the flower look at the features are

314
00:13:45,230 --> 00:13:48,110
very simple right size duration the

315
00:13:48,110 --> 00:13:49,940
periodicity this is not easy I'm not

316
00:13:49,940 --> 00:13:51,620
going to talk here about the details but

317
00:13:51,620 --> 00:13:55,460
this is quite of quite a computation in

318
00:13:55,460 --> 00:13:57,520
there and then we have the time between

319
00:13:57,520 --> 00:14:01,280
the consecutive flows okay so for

320
00:14:01,280 --> 00:14:03,890
features what are we doing with these

321
00:14:03,890 --> 00:14:06,680
four features okay so every time I got a

322
00:14:06,680 --> 00:14:09,440
flow in the network I'm saying hey how

323
00:14:09,440 --> 00:14:13,070
is your size it is small or is its

324
00:14:13,070 --> 00:14:15,170
medium or its large you can see that

325
00:14:15,170 --> 00:14:17,000
there are okay it under under these

326
00:14:17,000 --> 00:14:18,470
there are some numbers but I want to

327
00:14:18,470 --> 00:14:21,470
show you like the the big picture here

328
00:14:21,470 --> 00:14:23,960
the flow is a small or is large or the

329
00:14:23,960 --> 00:14:27,110
duration is short or is medium and the

330
00:14:27,110 --> 00:14:29,230
periodicity is strong or actually is

331
00:14:29,230 --> 00:14:33,350
strongly non periodic and now we can

332
00:14:33,350 --> 00:14:35,600
assign to one of these states in letter

333
00:14:35,600 --> 00:14:38,450
and say hey so if this flow is not

334
00:14:38,450 --> 00:14:41,060
periodic and it's small and the range of

335
00:14:41,060 --> 00:14:43,430
Ababa I will give you the letter J or

336
00:14:43,430 --> 00:14:46,790
age and we start assigning letters to

337
00:14:46,790 --> 00:14:49,670
each flow in the connection and finally

338
00:14:49,670 --> 00:14:51,890
you can see that we are using some

339
00:14:51,890 --> 00:14:55,400
Seibel Z here to put a threshold between

340
00:14:55,400 --> 00:14:57,440
flows because if you have a periodicity

341
00:14:57,440 --> 00:14:59,960
of five minutes it's not the same as a

342
00:14:59,960 --> 00:15:02,360
periodicity of one day or one week right

343
00:15:02,360 --> 00:15:04,190
so we want to detect that and we are

344
00:15:04,190 --> 00:15:07,220
saying hey between flows less than five

345
00:15:07,220 --> 00:15:10,460
seconds between flows oh no no we have a

346
00:15:10,460 --> 00:15:12,980
time out of one hours oh so you should

347
00:15:12,980 --> 00:15:15,950
put a zero here so let me show you what

348
00:15:15,950 --> 00:15:19,690
we are doing with these letters in here

349
00:15:23,470 --> 00:15:28,250
so I will show you first using part of

350
00:15:28,250 --> 00:15:29,160
our stratosphere

351
00:15:29,160 --> 00:15:31,730
[Music]

352
00:15:31,730 --> 00:15:35,510
project I will show you that we have a

353
00:15:35,510 --> 00:15:37,400
lot of data sets here that we are

354
00:15:37,400 --> 00:15:39,529
analyzing all the time and this is a

355
00:15:39,529 --> 00:15:42,470
normal connection so here you can see a

356
00:15:42,470 --> 00:15:44,839
lot of connections in there these are

357
00:15:44,839 --> 00:15:47,690
the type of connections that are going

358
00:15:47,690 --> 00:15:50,360
from one IP to another IP and then I'll

359
00:15:50,360 --> 00:15:53,089
go into some port right I just stopped

360
00:15:53,089 --> 00:15:55,610
it so one line here is one connection

361
00:15:55,610 --> 00:16:00,080
this IP to this IP this port and TCP can

362
00:16:00,080 --> 00:16:03,200
you see it there from the back yeah okay

363
00:16:03,200 --> 00:16:07,339
so and each flow in this connection got

364
00:16:07,339 --> 00:16:09,050
a letter and there you can see the

365
00:16:09,050 --> 00:16:11,210
letter right so look at here like we

366
00:16:11,210 --> 00:16:15,140
have a web page and we have some flow

367
00:16:15,140 --> 00:16:17,960
that is getting a zero zero point so if

368
00:16:17,960 --> 00:16:20,810
you see a point point means very fast so

369
00:16:20,810 --> 00:16:22,970
the flows are here coming very fast but

370
00:16:22,970 --> 00:16:24,920
these are not periodic because if you

371
00:16:24,920 --> 00:16:26,900
look at the periodicity in the in the

372
00:16:26,900 --> 00:16:31,670
chart the periodicity is only from a two

373
00:16:31,670 --> 00:16:35,990
I write a two I more than I it's not

374
00:16:35,990 --> 00:16:39,140
periodic anymore so I can look at it and

375
00:16:39,140 --> 00:16:42,170
say hey I'm a human being I can say this

376
00:16:42,170 --> 00:16:43,910
is not periodic but here we have some

377
00:16:43,910 --> 00:16:46,130
periodicity very fast periodicity and

378
00:16:46,130 --> 00:16:48,320
then he lose the periodicity then we

379
00:16:48,320 --> 00:16:49,910
have something like five minutes and

380
00:16:49,910 --> 00:16:52,130
then again even if you look at it you

381
00:16:52,130 --> 00:16:53,660
can see a pattern look at this

382
00:16:53,660 --> 00:16:57,160
it's like zerah zerah III zero plus zero

383
00:16:57,160 --> 00:17:01,520
zero zero Y zero plus zero zero zero

384
00:17:01,520 --> 00:17:04,429
zero zero zero plus zero zero zero

385
00:17:04,429 --> 00:17:07,790
I so you can see that there is some

386
00:17:07,790 --> 00:17:10,640
behavior in here and naturally this is a

387
00:17:10,640 --> 00:17:13,280
normal capture remember and this is a

388
00:17:13,280 --> 00:17:16,130
webpage that is showing some information

389
00:17:16,130 --> 00:17:17,869
that it's been reloaded every five

390
00:17:17,869 --> 00:17:19,819
minutes so there's there is some Java

391
00:17:19,819 --> 00:17:22,490
scripting here and it's reloading but

392
00:17:22,490 --> 00:17:24,770
even if it's reloading it's not periodic

393
00:17:24,770 --> 00:17:27,079
completely right and then here for

394
00:17:27,079 --> 00:17:29,150
example you have a normal webpage like

395
00:17:29,150 --> 00:17:31,400
nothing fancy so it just access a web

396
00:17:31,400 --> 00:17:33,860
page so you can see like I don't know 10

397
00:17:33,860 --> 00:17:36,440
flows no periodicity here very fast

398
00:17:36,440 --> 00:17:38,810
because it's downloading the images is

399
00:17:38,810 --> 00:17:40,190
the loading some JavaScript

400
00:17:40,190 --> 00:17:42,170
that's it and then here you have for

401
00:17:42,170 --> 00:17:45,380
example some ssl connections right also

402
00:17:45,380 --> 00:17:48,740
no periodic very short as you can see I

403
00:17:48,740 --> 00:17:50,690
don't care about the payload so I don't

404
00:17:50,690 --> 00:17:51,920
care if it's encrypted it's not

405
00:17:51,920 --> 00:17:54,290
encrypted is it sell its TLS or

406
00:17:54,290 --> 00:17:56,420
something if you are behaving you are

407
00:17:56,420 --> 00:17:58,790
doing it all over and over again right

408
00:17:58,790 --> 00:18:02,810
so let me show you now some sound for

409
00:18:02,810 --> 00:18:06,170
example I will show you this muf botnet

410
00:18:06,170 --> 00:18:09,500
so this Mirek botnet sorry

411
00:18:09,500 --> 00:18:15,680
MuRF botnet is doing more stuff actually

412
00:18:15,680 --> 00:18:17,690
I didn't tell you but I'm speeding up

413
00:18:17,690 --> 00:18:19,010
the flows right

414
00:18:19,010 --> 00:18:21,020
this actually is like a four or five day

415
00:18:21,020 --> 00:18:23,210
capture so I'm speeding up the flows and

416
00:18:23,210 --> 00:18:25,580
you can see what's going on so you can

417
00:18:25,580 --> 00:18:28,670
see some connections in here Ready's UDP

418
00:18:28,670 --> 00:18:31,760
I don't care DNS bah bah bah some ipv6

419
00:18:31,760 --> 00:18:34,790
arp and then we have here some tcp

420
00:18:34,790 --> 00:18:37,670
connections to port 80 and if you look

421
00:18:37,670 --> 00:18:39,620
at the connections you will say hey this

422
00:18:39,620 --> 00:18:42,560
is very periodic III an actually the

423
00:18:42,560 --> 00:18:45,650
timing is less than five minutes so this

424
00:18:45,650 --> 00:18:47,990
is a very periodic behavior and if you

425
00:18:47,990 --> 00:18:49,880
look at the traffic within it's a

426
00:18:49,880 --> 00:18:51,950
command and control so here we can

427
00:18:51,950 --> 00:18:53,990
capture the behavior of a command and

428
00:18:53,990 --> 00:18:56,480
control but it's doing something in new

429
00:18:56,480 --> 00:18:59,120
F botnet also you can see that there are

430
00:18:59,120 --> 00:19:00,770
other connections but they are not

431
00:19:00,770 --> 00:19:04,160
periodic that means that me ref is using

432
00:19:04,160 --> 00:19:06,470
several types of connections some are

433
00:19:06,470 --> 00:19:08,270
for command control but some are not

434
00:19:08,270 --> 00:19:10,640
some are for example to the load stuff

435
00:19:10,640 --> 00:19:14,630
to get some images or just to send

436
00:19:14,630 --> 00:19:15,590
information

437
00:19:15,590 --> 00:19:17,690
so not everything coming from this

438
00:19:17,690 --> 00:19:20,450
button is having the same behavior so we

439
00:19:20,450 --> 00:19:22,400
are focusing in these and we are saying

440
00:19:22,400 --> 00:19:24,740
hey I can build the model to detect that

441
00:19:24,740 --> 00:19:26,360
and this is completely different from

442
00:19:26,360 --> 00:19:28,820
from the normal traffic I only show you

443
00:19:28,820 --> 00:19:31,070
one right but we have several and the

444
00:19:31,070 --> 00:19:32,600
normal behavior is completely different

445
00:19:32,600 --> 00:19:35,330
so if you as a human being looking at

446
00:19:35,330 --> 00:19:38,060
these can make the distinction so an

447
00:19:38,060 --> 00:19:41,570
algorithm it it has a good opportunity

448
00:19:41,570 --> 00:19:44,090
to do this right to do that so I'm going

449
00:19:44,090 --> 00:19:46,550
to show you another one for example the

450
00:19:46,550 --> 00:19:52,190
here the botnet there so it's another

451
00:19:52,190 --> 00:19:53,660
connection and you can

452
00:19:53,660 --> 00:19:55,880
see here that there are also periodicity

453
00:19:55,880 --> 00:19:59,300
but is - an hour or something and then

454
00:19:59,300 --> 00:20:00,350
look at this there is a lossless

455
00:20:00,350 --> 00:20:02,870
periodicity some zeros the burden is not

456
00:20:02,870 --> 00:20:05,150
periodic anymore and now we have another

457
00:20:05,150 --> 00:20:07,490
connections that are completely not

458
00:20:07,490 --> 00:20:09,320
periodic but you can see that there is a

459
00:20:09,320 --> 00:20:11,600
pattern in here right I look at this a

460
00:20:11,600 --> 00:20:13,070
new connection new command and control

461
00:20:13,070 --> 00:20:15,380
because they all one it's not responding

462
00:20:15,380 --> 00:20:18,290
anymore so we have a new sending of

463
00:20:18,290 --> 00:20:20,360
information in there and also look at

464
00:20:20,360 --> 00:20:23,480
these each zero it's ten minutes each

465
00:20:23,480 --> 00:20:26,960
zero is an hour so we have here like

466
00:20:26,960 --> 00:20:29,540
seven or eight hours between flows right

467
00:20:29,540 --> 00:20:34,070
so this is part of the behaviors that we

468
00:20:34,070 --> 00:20:36,170
are looking for when we are analyzing

469
00:20:36,170 --> 00:20:39,320
the traffic so when we have the behavior

470
00:20:39,320 --> 00:20:42,590
what we are doing okay so why we like

471
00:20:42,590 --> 00:20:44,780
behaviors and we are saying that malware

472
00:20:44,780 --> 00:20:47,060
generates the same behavior over and

473
00:20:47,060 --> 00:20:48,680
over again this is something that we

474
00:20:48,680 --> 00:20:51,560
just saw also changing the behavioral

475
00:20:51,560 --> 00:20:53,930
patterns for the malware is very costly

476
00:20:53,930 --> 00:20:56,600
because if you stop being periodic you

477
00:20:56,600 --> 00:20:58,760
cannot communicate with all your BOTS at

478
00:20:58,760 --> 00:21:01,970
the same time and you cannot send

479
00:21:01,970 --> 00:21:03,980
comments at the same time so at some

480
00:21:03,980 --> 00:21:06,020
point you are losing some of your power

481
00:21:06,020 --> 00:21:08,570
if you are not so periodic anymore you

482
00:21:08,570 --> 00:21:10,160
cannot update so easy it's not

483
00:21:10,160 --> 00:21:12,410
impossible to change it but it's costly

484
00:21:12,410 --> 00:21:15,200
very costly right and then the behaviors

485
00:21:15,200 --> 00:21:17,600
do not expire so easily

486
00:21:17,600 --> 00:21:19,640
because you are you need this behavior

487
00:21:19,640 --> 00:21:21,020
is part of what you are doing as a

488
00:21:21,020 --> 00:21:24,380
botnet and then the infections go and

489
00:21:24,380 --> 00:21:26,750
notice it for several hours usually when

490
00:21:26,750 --> 00:21:28,430
some of these infected so we have time

491
00:21:28,430 --> 00:21:30,650
for these if you need five minutes hey

492
00:21:30,650 --> 00:21:32,630
five minutes you can get them one hour

493
00:21:32,630 --> 00:21:36,710
it's okay right you don't get someone

494
00:21:36,710 --> 00:21:39,710
like trying to detect the malware in the

495
00:21:39,710 --> 00:21:41,540
network in the first minute usually if

496
00:21:41,540 --> 00:21:43,100
then instead will have to go there and

497
00:21:43,100 --> 00:21:44,690
clean the computer it can take several

498
00:21:44,690 --> 00:21:48,430
hours and then we collect normal and

499
00:21:48,430 --> 00:21:51,440
infected from my wor behavior so this is

500
00:21:51,440 --> 00:21:54,830
what we are using behaviors so after we

501
00:21:54,830 --> 00:21:56,480
got these we are going to apply some

502
00:21:56,480 --> 00:21:59,300
detection models so we have several now

503
00:21:59,300 --> 00:22:01,160
we are running to and tomorrow in

504
00:22:01,160 --> 00:22:03,980
develop em and the first one is we are

505
00:22:03,980 --> 00:22:06,410
going to interpret this as a mark of

506
00:22:06,410 --> 00:22:09,740
change of the transitions so our first

507
00:22:09,740 --> 00:22:12,440
detection model separated from the model

508
00:22:12,440 --> 00:22:14,510
of the letters that is the network model

509
00:22:14,510 --> 00:22:16,880
our detection model is looking at the

510
00:22:16,880 --> 00:22:19,490
letters and saying hey I want to see how

511
00:22:19,490 --> 00:22:21,110
you are going from one state to the

512
00:22:21,110 --> 00:22:23,510
other and I'm going to build from these

513
00:22:23,510 --> 00:22:26,570
a matrix of how you are going from a 2

514
00:22:26,570 --> 00:22:30,200
comma comma to a I will come this I will

515
00:22:30,200 --> 00:22:32,330
have the probabilities here and I will

516
00:22:32,330 --> 00:22:33,830
be the bulk mark oh sorry

517
00:22:33,830 --> 00:22:36,230
build a Markov chain we say hey this is

518
00:22:36,230 --> 00:22:39,050
the model of behavior of how you are

519
00:22:39,050 --> 00:22:41,480
changing from one state to the other and

520
00:22:41,480 --> 00:22:44,480
once you have that what we are doing is

521
00:22:44,480 --> 00:22:46,460
that we are training these Markov models

522
00:22:46,460 --> 00:22:49,970
in known behaviors so we are verifying

523
00:22:49,970 --> 00:22:52,040
that hand this is what and this is my

524
00:22:52,040 --> 00:22:53,510
work this is normal this is more normal

525
00:22:53,510 --> 00:22:55,940
we have traffic from the University from

526
00:22:55,940 --> 00:22:58,790
companies and we are spending time on

527
00:22:58,790 --> 00:23:01,610
these but once we have the behavior we

528
00:23:01,610 --> 00:23:04,280
can compare two unknown behavior and

529
00:23:04,280 --> 00:23:05,990
they take the stuff that we don't know

530
00:23:05,990 --> 00:23:08,630
we can say hey this I have no idea what

531
00:23:08,630 --> 00:23:10,820
it is but if I compare to the model of

532
00:23:10,820 --> 00:23:15,470
models I have I can get the model that

533
00:23:15,470 --> 00:23:17,870
is having the same behavior and this is

534
00:23:17,870 --> 00:23:21,980
good because the models can generalize I

535
00:23:21,980 --> 00:23:24,320
don't have to detect exactly the same

536
00:23:24,320 --> 00:23:27,050
pattern I just need to detect a similar

537
00:23:27,050 --> 00:23:29,390
behavior so I can say okay it's not

538
00:23:29,390 --> 00:23:30,680
exactly the same what you are doing

539
00:23:30,680 --> 00:23:33,050
because the timing is changing the

540
00:23:33,050 --> 00:23:35,000
periodicity is changing but you are

541
00:23:35,000 --> 00:23:37,340
behaving in such a way that this is not

542
00:23:37,340 --> 00:23:39,890
normal and matches a malicious behavior

543
00:23:39,890 --> 00:23:44,080
right so we compute the winner model and

544
00:23:44,080 --> 00:23:47,390
at the end we want to know hey is this

545
00:23:47,390 --> 00:23:50,600
working or not like how are your results

546
00:23:50,600 --> 00:23:52,460
going like that you have some results

547
00:23:52,460 --> 00:23:55,340
well actually we have results but if you

548
00:23:55,340 --> 00:23:58,670
try if you ever try to verify how some

549
00:23:58,670 --> 00:24:00,980
software is working in detection you

550
00:24:00,980 --> 00:24:02,750
know that this is a very difficult

551
00:24:02,750 --> 00:24:04,880
question it's like asking an antivirus

552
00:24:04,880 --> 00:24:08,180
how good it is go how good we're good

553
00:24:08,180 --> 00:24:12,260
when right so it depends a lot how

554
00:24:12,260 --> 00:24:14,030
you're verifying your software the

555
00:24:14,030 --> 00:24:16,370
research that you have actually it

556
00:24:16,370 --> 00:24:17,920
depends on the data set

557
00:24:17,920 --> 00:24:20,050
show you datasets that the detection is

558
00:24:20,050 --> 00:24:22,660
perfect but that's not real right so we

559
00:24:22,660 --> 00:24:24,400
are plugging it in the network and we

560
00:24:24,400 --> 00:24:25,870
are detecting more stuff and then we

561
00:24:25,870 --> 00:24:28,150
have errors and then we are improving so

562
00:24:28,150 --> 00:24:29,890
it's very difficult to say how good it

563
00:24:29,890 --> 00:24:32,800
is any software for for ourself our

564
00:24:32,800 --> 00:24:34,720
software is working very good right and

565
00:24:34,720 --> 00:24:37,270
that's why we want to verify and show

566
00:24:37,270 --> 00:24:39,190
the results publicly that's why

567
00:24:39,190 --> 00:24:40,780
everything is free software and even the

568
00:24:40,780 --> 00:24:42,070
data said you can download all the

569
00:24:42,070 --> 00:24:44,770
malware from the webpage so we have this

570
00:24:44,770 --> 00:24:47,380
large public label and real data set

571
00:24:47,380 --> 00:24:49,660
with normal malicious and hatred

572
00:24:49,660 --> 00:24:52,240
behaviors and what does he breed means

573
00:24:52,240 --> 00:24:54,640
and this is very interesting because if

574
00:24:54,640 --> 00:24:57,580
I give you a malware traffic and you can

575
00:24:57,580 --> 00:24:59,650
detect it and then I give you a normal

576
00:24:59,650 --> 00:25:02,680
traffic and you are not detecting it the

577
00:25:02,680 --> 00:25:05,830
detection rate is perfect your your F

578
00:25:05,830 --> 00:25:08,800
and a false positive rate is amazing

579
00:25:08,800 --> 00:25:10,870
but what we are doing is that we have

580
00:25:10,870 --> 00:25:12,880
normal computers with real people and

581
00:25:12,880 --> 00:25:14,980
then we're infecting them with something

582
00:25:14,980 --> 00:25:17,350
that we know then we continue doing the

583
00:25:17,350 --> 00:25:19,870
normal traffic for several days

584
00:25:19,870 --> 00:25:21,670
I don't know Facebook Gmail whatever you

585
00:25:21,670 --> 00:25:23,380
are doing and then we are clean the

586
00:25:23,380 --> 00:25:25,060
computer and we continue having the

587
00:25:25,060 --> 00:25:27,160
normal traffic for some days so we have

588
00:25:27,160 --> 00:25:30,190
one week to only normal two days that

589
00:25:30,190 --> 00:25:32,560
our mix and two days that are clean

590
00:25:32,560 --> 00:25:35,560
again so I want the software to say this

591
00:25:35,560 --> 00:25:38,560
IP address is clean now hey now it's

592
00:25:38,560 --> 00:25:40,840
something infected in here and now it's

593
00:25:40,840 --> 00:25:42,910
clean again so we are trying to make

594
00:25:42,910 --> 00:25:44,770
this evolution right we are not trying

595
00:25:44,770 --> 00:25:47,070
to say it's infected and that's it and

596
00:25:47,070 --> 00:25:49,390
finally we are comparing different

597
00:25:49,390 --> 00:25:52,090
approaches which is actually crucial for

598
00:25:52,090 --> 00:25:54,970
predicting the performance so we are

599
00:25:54,970 --> 00:25:57,370
going to stop in here I will say that

600
00:25:57,370 --> 00:25:59,050
the network behavioral patterns work

601
00:25:59,050 --> 00:26:01,240
really well for us and I think that is

602
00:26:01,240 --> 00:26:03,840
something that you should consider

603
00:26:03,840 --> 00:26:06,030
researching if you are not doing it yet

604
00:26:06,030 --> 00:26:08,740
because it's different approach of

605
00:26:08,740 --> 00:26:11,170
machine learning it's taking some

606
00:26:11,170 --> 00:26:13,540
behavior that you know create a machine

607
00:26:13,540 --> 00:26:15,610
learning from that and then detect it

608
00:26:15,610 --> 00:26:17,260
right it's different from a normal

609
00:26:17,260 --> 00:26:20,410
detection so thank you very much that's

610
00:26:20,410 --> 00:26:22,480
my contact information

611
00:26:22,480 --> 00:26:25,150
I don't know if we have some questions

612
00:26:25,150 --> 00:26:27,760
or something we have some time for some

613
00:26:27,760 --> 00:26:32,950
questions there any questions if not

614
00:26:32,950 --> 00:26:33,910
I've got one

615
00:26:33,910 --> 00:26:37,660
it was squeak sorry buddy yes yeah um so

616
00:26:37,660 --> 00:26:43,080
you're taking a look at known bad

617
00:26:43,080 --> 00:26:46,540
behaviors like my botnets and you're

618
00:26:46,540 --> 00:26:50,110
able to identify patterns but in order

619
00:26:50,110 --> 00:26:52,450
to avoid false positives you're going to

620
00:26:52,450 --> 00:26:54,760
have to compare that to a huge variety

621
00:26:54,760 --> 00:26:56,200
of software

622
00:26:56,200 --> 00:26:58,620
have you found similarities between

623
00:26:58,620 --> 00:27:03,480
botnet patterns and enterprise security

624
00:27:03,480 --> 00:27:07,950
control such as pushing patches or well

625
00:27:07,950 --> 00:27:09,760
yeah I understand

626
00:27:09,760 --> 00:27:12,340
so some behavioral patterns have

627
00:27:12,340 --> 00:27:15,280
similarities like for example if for

628
00:27:15,280 --> 00:27:17,470
example antivirus is there updating and

629
00:27:17,470 --> 00:27:19,480
from time to time that updating

630
00:27:19,480 --> 00:27:21,910
mechanism is looking like very periodic

631
00:27:21,910 --> 00:27:26,140
very small right and at first this looks

632
00:27:26,140 --> 00:27:27,669
the same but there's a lot of

633
00:27:27,669 --> 00:27:30,190
differences not only in the flows but

634
00:27:30,190 --> 00:27:32,290
how you are doing it like how it's your

635
00:27:32,290 --> 00:27:34,390
periodicity working and more importantly

636
00:27:34,390 --> 00:27:36,730
which other connections are coming from

637
00:27:36,730 --> 00:27:38,590
your computer so I didn't talk about

638
00:27:38,590 --> 00:27:40,840
that here but well when we are comparing

639
00:27:40,840 --> 00:27:43,090
and saying okay you have the traffic in

640
00:27:43,090 --> 00:27:45,549
here is this malicious or not we are

641
00:27:45,549 --> 00:27:47,950
taking all these connections and we are

642
00:27:47,950 --> 00:27:50,049
seeing like I show you the traffic like

643
00:27:50,049 --> 00:27:51,820
okay here you are doing something but

644
00:27:51,820 --> 00:27:54,220
then you are doing something very very

645
00:27:54,220 --> 00:27:56,440
strange in DNS for example and you are

646
00:27:56,440 --> 00:27:58,150
matching two or three or four or five

647
00:27:58,150 --> 00:28:00,220
different models so that is when you say

648
00:28:00,220 --> 00:28:02,110
okay this is malicious to this degree

649
00:28:02,110 --> 00:28:04,330
confidence trust models right so you

650
00:28:04,330 --> 00:28:06,220
have some some verification is there

651
00:28:06,220 --> 00:28:08,200
it's not that you say okay you are

652
00:28:08,200 --> 00:28:09,580
periodic and that's it because there is

653
00:28:09,580 --> 00:28:11,410
a lot of normal software that it's

654
00:28:11,410 --> 00:28:13,510
periodic right and actually it's funny

655
00:28:13,510 --> 00:28:16,179
but botnets usually are not so periodic

656
00:28:16,179 --> 00:28:19,840
they are having periodicity only when

657
00:28:19,840 --> 00:28:21,400
they are evil when they are doing

658
00:28:21,400 --> 00:28:23,200
nothing when the command and control is

659
00:28:23,200 --> 00:28:25,299
just waiting but when they receive an

660
00:28:25,299 --> 00:28:27,640
order they are acting they are doing

661
00:28:27,640 --> 00:28:29,230
something they are attacking and they

662
00:28:29,230 --> 00:28:30,880
don't need to be periodic anymore right

663
00:28:30,880 --> 00:28:34,510
I think we probably have time for one

664
00:28:34,510 --> 00:28:36,960
more question

665
00:28:38,960 --> 00:28:41,309
they are they told me to point the

666
00:28:41,309 --> 00:28:48,210
people side oh thank you for your

667
00:28:48,210 --> 00:28:48,809
question

668
00:28:48,809 --> 00:28:53,129
Nana thank you have you considered like

669
00:28:53,129 --> 00:28:54,960
protocols where like you'd be getting

670
00:28:54,960 --> 00:28:58,049
tunnel or TCP and all that you know how

671
00:28:58,049 --> 00:28:59,999
are you conferring those cases

672
00:28:59,999 --> 00:29:02,999
sorry UDP proton when you have when you

673
00:29:02,999 --> 00:29:05,610
have tunneling protocols yes yes yes

674
00:29:05,610 --> 00:29:07,830
well we have some a lot of different

675
00:29:07,830 --> 00:29:10,679
cases that very difficult to match for

676
00:29:10,679 --> 00:29:13,460
example 20 needs one and also you have

677
00:29:13,460 --> 00:29:16,409
for example under not if you have a lot

678
00:29:16,409 --> 00:29:18,570
of computers under not and also if you

679
00:29:18,570 --> 00:29:20,669
think about DNS is the same problem

680
00:29:20,669 --> 00:29:22,679
because you should if you are connecting

681
00:29:22,679 --> 00:29:25,559
to some web page is your connection but

682
00:29:25,559 --> 00:29:28,289
DNS is share so if you are doing

683
00:29:28,289 --> 00:29:29,279
something normal

684
00:29:29,279 --> 00:29:31,859
you are generating DNS packets but the

685
00:29:31,859 --> 00:29:34,109
malware is also generating the NS

686
00:29:34,109 --> 00:29:35,879
packets so they are getting mix and

687
00:29:35,879 --> 00:29:38,070
actually it's very difficult to separate

688
00:29:38,070 --> 00:29:40,409
that's why I was saying that we are

689
00:29:40,409 --> 00:29:43,649
looking at the group of behaviors and

690
00:29:43,649 --> 00:29:46,320
how we can decide if your in fact or not

691
00:29:46,320 --> 00:29:49,169
based on that so if some tunneling is

692
00:29:49,169 --> 00:29:50,970
matching in model but there is no more

693
00:29:50,970 --> 00:29:53,399
indication say it so you're really not

694
00:29:53,399 --> 00:29:55,710
infected for example at all right or

695
00:29:55,710 --> 00:29:58,830
stuff like that so tour is very at some

696
00:29:58,830 --> 00:30:01,739
point for example tor you have an HTTP

697
00:30:01,739 --> 00:30:03,570
connection time thank you very much

698
00:30:03,570 --> 00:30:06,570
an HTTP connection that it's downloading

699
00:30:06,570 --> 00:30:08,489
part of the stuffing tour so you can

700
00:30:08,489 --> 00:30:10,739
detect that and say okay now this is tor

701
00:30:10,739 --> 00:30:13,859
behavior right but it's actually very

702
00:30:13,859 --> 00:30:15,690
hard to do that yeah it's true

703
00:30:15,690 --> 00:30:18,859
so I'd like to thank Sebastian very much

704
00:30:18,859 --> 00:30:20,519
information and some really cool

705
00:30:20,519 --> 00:30:22,190
research

706
00:30:22,190 --> 00:30:27,249
[Applause]

