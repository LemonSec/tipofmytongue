1
00:00:08,900 --> 00:00:11,969
so we're you all welcome to everyone I

2
00:00:11,969 --> 00:00:13,920
hope you enjoy your lunch and refresh

3
00:00:13,920 --> 00:00:15,599
yourselves a bit so we have the energy

4
00:00:15,599 --> 00:00:19,140
to follow this session and thanks for

5
00:00:19,140 --> 00:00:21,930
joining this session is going to be

6
00:00:21,930 --> 00:00:24,449
mostly about the domain which is kind of

7
00:00:24,449 --> 00:00:27,300
new for our industry it's the domain of

8
00:00:27,300 --> 00:00:29,189
IOT and home routers hacking and

9
00:00:29,189 --> 00:00:31,679
infecting them but before we actually

10
00:00:31,679 --> 00:00:33,180
get there we could because there's the

11
00:00:33,180 --> 00:00:35,460
two following talks the first case we

12
00:00:35,460 --> 00:00:36,780
have here is an interesting piece of

13
00:00:36,780 --> 00:00:39,050
research by these researchers on

14
00:00:39,050 --> 00:00:43,530
targeted attacks industry espionage high

15
00:00:43,530 --> 00:00:45,809
profile targets and this kind of stuff

16
00:00:45,809 --> 00:00:48,690
so this is kind of hot news for ages

17
00:00:48,690 --> 00:00:51,090
already I could say so without any

18
00:00:51,090 --> 00:00:53,520
further ado please welcome Anton sherry

19
00:00:53,520 --> 00:00:56,190
panel and Robert Lepofsky own operation

20
00:00:56,190 --> 00:01:03,449
hotel Express everyone so last year we

21
00:01:03,449 --> 00:01:05,339
were on this stage well not this stage

22
00:01:05,339 --> 00:01:08,159
but the one in Seattle talking about an

23
00:01:08,159 --> 00:01:10,380
apt called black energy that's the one

24
00:01:10,380 --> 00:01:12,960
that you might remember received quite a

25
00:01:12,960 --> 00:01:14,520
lot of public attention under the name

26
00:01:14,520 --> 00:01:17,280
sandworm well today we'll talk about

27
00:01:17,280 --> 00:01:19,229
another malware family used for cyber

28
00:01:19,229 --> 00:01:20,450
espionage

29
00:01:20,450 --> 00:01:23,400
now we've have quite a lot of

30
00:01:23,400 --> 00:01:24,900
interesting content so I don't want to

31
00:01:24,900 --> 00:01:26,340
bore you with the boring introduction so

32
00:01:26,340 --> 00:01:28,130
let's get right to it

33
00:01:28,130 --> 00:01:30,420
bowtie express what the hell does that

34
00:01:30,420 --> 00:01:35,400
mean well Bo Tao is the first part

35
00:01:35,400 --> 00:01:36,720
potala comes from the name of the

36
00:01:36,720 --> 00:01:39,060
malware Express comes from one of the

37
00:01:39,060 --> 00:01:40,650
spreading campaigns which I'll talk

38
00:01:40,650 --> 00:01:42,360
about in just a second the malware

39
00:01:42,360 --> 00:01:45,030
itself is not new in fact it has been

40
00:01:45,030 --> 00:01:49,170
around since at least 2011 yet it hasn't

41
00:01:49,170 --> 00:01:52,200
received much much public attention

42
00:01:52,200 --> 00:01:57,030
until now here are the parts of the code

43
00:01:57,030 --> 00:02:01,890
which contain the PDB file paths which

44
00:02:01,890 --> 00:02:04,860
contain the strings Hotel or sapota are

45
00:02:04,860 --> 00:02:07,789
also note 69 so if you ever read about

46
00:02:07,789 --> 00:02:11,819
or encounter malware with these names

47
00:02:11,819 --> 00:02:14,769
then we're talking about the same thing

48
00:02:14,769 --> 00:02:17,659
the country is mostly targeted or the

49
00:02:17,659 --> 00:02:19,849
highest number of victims were mostly in

50
00:02:19,849 --> 00:02:21,920
Ukraine just like black energy which we

51
00:02:21,920 --> 00:02:24,620
already talked about and also Russia

52
00:02:24,620 --> 00:02:29,209
Belarus and Georgia so let's start

53
00:02:29,209 --> 00:02:31,970
talking about the individual time line

54
00:02:31,970 --> 00:02:35,659
of the attacks when we were monitoring

55
00:02:35,659 --> 00:02:38,870
and tracking tracking all the different

56
00:02:38,870 --> 00:02:42,290
samples we were able to follow the

57
00:02:42,290 --> 00:02:44,510
evolution of the malware the version

58
00:02:44,510 --> 00:02:46,280
number of the malware is pretty pretty

59
00:02:46,280 --> 00:02:50,299
clearly labeled within the sample also

60
00:02:50,299 --> 00:02:53,569
the samples contain a unique campaign

61
00:02:53,569 --> 00:02:56,510
identifier which also enables us to

62
00:02:56,510 --> 00:02:58,790
track the individual targeted campaigns

63
00:02:58,790 --> 00:03:00,920
and all the samples were basically

64
00:03:00,920 --> 00:03:04,849
tailored for particular victims now most

65
00:03:04,849 --> 00:03:07,069
of these campaign IDs are just a bunch

66
00:03:07,069 --> 00:03:08,629
of letters which we were not able to

67
00:03:08,629 --> 00:03:10,760
decipher although some of them probably

68
00:03:10,760 --> 00:03:14,209
have some significance according to who

69
00:03:14,209 --> 00:03:16,819
the target was now as you can see

70
00:03:16,819 --> 00:03:19,160
there's quite a lot of them in this in

71
00:03:19,160 --> 00:03:21,290
these time line most probably there are

72
00:03:21,290 --> 00:03:23,150
also some of them which we which we

73
00:03:23,150 --> 00:03:25,579
haven't haven't seen which were out

74
00:03:25,579 --> 00:03:29,660
there but we put together this timeline

75
00:03:29,660 --> 00:03:31,400
of the most interesting most notable

76
00:03:31,400 --> 00:03:35,180
events so let's talk about those and

77
00:03:35,180 --> 00:03:37,250
focus focus on them so as I mentioned

78
00:03:37,250 --> 00:03:39,260
the malware has been around since at

79
00:03:39,260 --> 00:03:41,900
least 2011 and the first appearance

80
00:03:41,900 --> 00:03:49,639
where we spotted it was in May 2011 that

81
00:03:49,639 --> 00:03:51,379
time it was a mass printing campaign it

82
00:03:51,379 --> 00:03:54,169
wasn't it wasn't particularly limited

83
00:03:54,169 --> 00:03:57,409
targeting the malware contained an

84
00:03:57,409 --> 00:04:00,349
encrypted string Global portal and since

85
00:04:00,349 --> 00:04:02,659
the detection name and the spreading

86
00:04:02,659 --> 00:04:06,169
mechanism for this was a pretty pretty

87
00:04:06,169 --> 00:04:08,810
typical one nothing nothing too

88
00:04:08,810 --> 00:04:10,760
innovative for this one so it was

89
00:04:10,760 --> 00:04:15,199
basically executables which used an icon

90
00:04:15,199 --> 00:04:18,079
of Microsoft Word document of course

91
00:04:18,079 --> 00:04:22,219
when somebody clicks on a document which

92
00:04:22,219 --> 00:04:24,349
is or a file which is masquerading as a

93
00:04:24,349 --> 00:04:26,450
Word document they're also expecting to

94
00:04:26,450 --> 00:04:30,110
see see word document opening up and for

95
00:04:30,110 --> 00:04:33,860
that reason to cover its tracks to

96
00:04:33,860 --> 00:04:35,750
appear more innocuous the malware

97
00:04:35,750 --> 00:04:38,840
contained an embedded decoy document

98
00:04:38,840 --> 00:04:40,490
within or at least most of the samples

99
00:04:40,490 --> 00:04:44,030
which we encountered did in this case it

100
00:04:44,030 --> 00:04:47,600
was just know the text itself didn't

101
00:04:47,600 --> 00:04:51,950
have any any real significance then also

102
00:04:51,950 --> 00:04:57,040
in 2011 we spotted a campaign in Armenia

103
00:04:57,040 --> 00:04:59,450
dropped a decoy document which was

104
00:04:59,450 --> 00:05:01,280
legible it was an arm in the Armenian

105
00:05:01,280 --> 00:05:02,390
language what's it what's interesting

106
00:05:02,390 --> 00:05:04,880
about this one is that the use decoy is

107
00:05:04,880 --> 00:05:07,790
a legitimate document belonging to the

108
00:05:07,790 --> 00:05:10,550
Ministry of Labor and Social Affairs in

109
00:05:10,550 --> 00:05:12,260
Armenia unfortunately we don't know any

110
00:05:12,260 --> 00:05:15,680
any other information about this case

111
00:05:15,680 --> 00:05:19,910
apart from this then in 2011 we saw we

112
00:05:19,910 --> 00:05:23,080
saw series of campaigns related to

113
00:05:23,080 --> 00:05:26,240
triple m for those of you that that

114
00:05:26,240 --> 00:05:27,760
don't know what Triple M is it's

115
00:05:27,760 --> 00:05:32,180
financial pyramid one of the most famous

116
00:05:32,180 --> 00:05:34,850
or infamous Ponzi schemes of all time

117
00:05:34,850 --> 00:05:37,580
very popular in Russia in Ukraine I was

118
00:05:37,580 --> 00:05:39,970
created by this guy Sergei Mavrodi

119
00:05:39,970 --> 00:05:42,110
the one talked too much about it if

120
00:05:42,110 --> 00:05:43,250
you're interested you can read all about

121
00:05:43,250 --> 00:05:48,260
it on Wikipedia and the campaign's which

122
00:05:48,260 --> 00:05:50,780
were related to this well the first file

123
00:05:50,780 --> 00:05:53,360
which we spotted it wasn't obvious at

124
00:05:53,360 --> 00:05:56,150
first sight the campaign ID contained

125
00:05:56,150 --> 00:05:59,650
the string double 0 km so doesn't really

126
00:05:59,650 --> 00:06:03,080
translate to Triple M but the dick the

127
00:06:03,080 --> 00:06:05,060
text in the decoy document was quite

128
00:06:05,060 --> 00:06:06,530
interesting it said hello my name is

129
00:06:06,530 --> 00:06:09,200
Eugene something my cell phone number I

130
00:06:09,200 --> 00:06:10,850
am doing business in the construction

131
00:06:10,850 --> 00:06:13,160
industry and want I want to invest about

132
00:06:13,160 --> 00:06:15,530
500 thousand rubles and I wanna invest

133
00:06:15,530 --> 00:06:17,330
with the highest yield hoping that you

134
00:06:17,330 --> 00:06:19,700
will help me so this file was probably

135
00:06:19,700 --> 00:06:24,770
addressed to an operator or members of

136
00:06:24,770 --> 00:06:30,320
this pyramid scheme by someone another

137
00:06:30,320 --> 00:06:33,530
file which appeared just just not long

138
00:06:33,530 --> 00:06:36,890
ago not not not long later this time it

139
00:06:36,890 --> 00:06:39,500
contain a campaign ID triple ml

140
00:06:39,500 --> 00:06:43,190
so the connection became more clear the

141
00:06:43,190 --> 00:06:46,190
file name was payment report for this

142
00:06:46,190 --> 00:06:49,400
lady here and the text in the decoy

143
00:06:49,400 --> 00:06:52,250
document I don't know anyone can can

144
00:06:52,250 --> 00:06:54,530
decipher what that says we'll probably

145
00:06:54,530 --> 00:06:57,200
knock is it's apparently just a bunch of

146
00:06:57,200 --> 00:06:59,650
random see really characterize

147
00:06:59,650 --> 00:07:02,690
appearing as if the document was was

148
00:07:02,690 --> 00:07:05,090
corrupted even though it wasn't and as

149
00:07:05,090 --> 00:07:07,130
you'll see later documents such as this

150
00:07:07,130 --> 00:07:09,170
one appeared to be some sort of a

151
00:07:09,170 --> 00:07:14,180
trademark used by this group then we

152
00:07:14,180 --> 00:07:16,669
spotted something interesting on in June

153
00:07:16,669 --> 00:07:19,760
2012 the author of the Ponzi scheme

154
00:07:19,760 --> 00:07:22,550
sergey mavrodi posted a blog where he's

155
00:07:22,550 --> 00:07:25,010
warned where he said that somebody is

156
00:07:25,010 --> 00:07:26,450
trying to impersonate him and sending

157
00:07:26,450 --> 00:07:30,890
out spam messages to members of triple-m

158
00:07:30,890 --> 00:07:34,360
and spreading malware through through

159
00:07:34,360 --> 00:07:37,280
dropbox and that's precisely what we saw

160
00:07:37,280 --> 00:07:41,210
at that time file called Ankita private

161
00:07:41,210 --> 00:07:44,890
law meaning questionnaire and rules

162
00:07:44,890 --> 00:07:47,210
spreading through dropbox campaign ID

163
00:07:47,210 --> 00:07:55,040
and triple-n then in october 2013 we saw

164
00:07:55,040 --> 00:07:58,790
a campaign in georgia the file name was

165
00:07:58,790 --> 00:08:01,610
wedding invitation and it was actually a

166
00:08:01,610 --> 00:08:03,140
wedding invitation we detected it in

167
00:08:03,140 --> 00:08:07,100
georgia as i said the text says that

168
00:08:07,100 --> 00:08:09,050
they're inviting you to celebrate their

169
00:08:09,050 --> 00:08:11,720
marriage in restaurant europe the

170
00:08:11,720 --> 00:08:13,580
interesting thing about this is that it

171
00:08:13,580 --> 00:08:19,190
was written in english then at the end

172
00:08:19,190 --> 00:08:23,650
of 2013 we started noticing a shift from

173
00:08:23,650 --> 00:08:26,919
russia and other former Soviet countries

174
00:08:26,919 --> 00:08:31,640
towards Ukraine at the end of 2013 we we

175
00:08:31,640 --> 00:08:35,260
detected quite a large number of samples

176
00:08:35,260 --> 00:08:37,669
which were debug versions of the malware

177
00:08:37,669 --> 00:08:40,159
so they contained lots of debugging

178
00:08:40,159 --> 00:08:42,409
information within them the interesting

179
00:08:42,409 --> 00:08:44,630
thing in one of these is that they

180
00:08:44,630 --> 00:08:46,790
contain the campaign ID called cream and

181
00:08:46,790 --> 00:08:49,940
it was also detected in the Crimea

182
00:08:49,940 --> 00:08:53,390
region as this

183
00:08:53,390 --> 00:08:55,100
these debugging samples were actually

184
00:08:55,100 --> 00:08:57,070
actually mass spreading so they weren't

185
00:08:57,070 --> 00:08:59,630
they weren't detected they were detected

186
00:08:59,630 --> 00:09:05,780
at lots of computers such testing of new

187
00:09:05,780 --> 00:09:07,910
versions of malware appears to be a

188
00:09:07,910 --> 00:09:10,280
pretty common technique used by used by

189
00:09:10,280 --> 00:09:14,180
apt operators before they actually use

190
00:09:14,180 --> 00:09:16,520
the malware in actual actual targeted

191
00:09:16,520 --> 00:09:20,770
campaigns those targeted campaigns

192
00:09:20,770 --> 00:09:24,800
followed a few months later the spraying

193
00:09:24,800 --> 00:09:25,820
mechanism this time was different

194
00:09:25,820 --> 00:09:28,930
however it was not just not just

195
00:09:28,930 --> 00:09:32,180
executables posing as Word documents

196
00:09:32,180 --> 00:09:33,860
instead they used again the pretty

197
00:09:33,860 --> 00:09:38,300
typical scenario so claiming to be some

198
00:09:38,300 --> 00:09:39,860
sort of tracking information for this

199
00:09:39,860 --> 00:09:43,660
purpose they registered landing pages

200
00:09:43,660 --> 00:09:46,340
such as this one for example M&T Express

201
00:09:46,340 --> 00:09:50,600
I put a fake postal website and if

202
00:09:50,600 --> 00:09:53,780
somebody wanted to well somebody was led

203
00:09:53,780 --> 00:09:56,300
to download the malware however it was

204
00:09:56,300 --> 00:09:57,830
not possible for anyone to simply

205
00:09:57,830 --> 00:09:59,510
download it but they needed to enter a

206
00:09:59,510 --> 00:10:01,910
specific specific tracking number

207
00:10:01,910 --> 00:10:03,860
into this form before before they were

208
00:10:03,860 --> 00:10:07,400
served the malware this MIT Express

209
00:10:07,400 --> 00:10:11,600
website was pretty obviously inspired by

210
00:10:11,600 --> 00:10:14,240
a legitimate site called Pony Express

211
00:10:14,240 --> 00:10:19,310
and that's a pretty typical spreading

212
00:10:19,310 --> 00:10:21,920
mechanism however in most cases what

213
00:10:21,920 --> 00:10:24,440
malware authors or malware operators do

214
00:10:24,440 --> 00:10:26,870
is that they send out spear phishing

215
00:10:26,870 --> 00:10:30,530
emails with links towards such landing

216
00:10:30,530 --> 00:10:33,440
pages the hotel operators however they

217
00:10:33,440 --> 00:10:36,290
use a different approach and they they

218
00:10:36,290 --> 00:10:39,110
send out SMS messages to their to their

219
00:10:39,110 --> 00:10:41,270
potential victims this is an indicator

220
00:10:41,270 --> 00:10:43,850
of really high targeting because they

221
00:10:43,850 --> 00:10:46,970
they had to know the full name well they

222
00:10:46,970 --> 00:10:48,710
didn't but they did but they not knew

223
00:10:48,710 --> 00:10:50,510
the full name and included in the text

224
00:10:50,510 --> 00:10:53,570
of the SMS and then you had to know the

225
00:10:53,570 --> 00:10:55,460
telephone number of their victim and

226
00:10:55,460 --> 00:11:00,050
they also tailored each each sample for

227
00:11:00,050 --> 00:11:01,580
that particular victim sent them a

228
00:11:01,580 --> 00:11:03,800
unique tracking code which through which

229
00:11:03,800 --> 00:11:06,470
they were able to download that malware

230
00:11:06,470 --> 00:11:11,730
then also very the same scenario this

231
00:11:11,730 --> 00:11:14,330
time the site was called world air post

232
00:11:14,330 --> 00:11:16,530
looking like this this is the fake one

233
00:11:16,530 --> 00:11:22,459
inspired by a website by Singapore post

234
00:11:22,700 --> 00:11:27,420
then also from attacking Ukrainian

235
00:11:27,420 --> 00:11:30,330
victims we spotted a couple of very

236
00:11:30,330 --> 00:11:32,190
interesting attacks against high-profile

237
00:11:32,190 --> 00:11:35,220
targets these targets were among the

238
00:11:35,220 --> 00:11:36,810
Ukrainian government's and military

239
00:11:36,810 --> 00:11:39,140
entities and also one of the largest

240
00:11:39,140 --> 00:11:42,750
ukrainian news agencies the sprechen

241
00:11:42,750 --> 00:11:45,390
spreading mechanism was as in back in

242
00:11:45,390 --> 00:11:47,760
back in the old days of bottles so using

243
00:11:47,760 --> 00:11:51,210
executables with word icons and just

244
00:11:51,210 --> 00:11:53,970
similarly to what the black energy

245
00:11:53,970 --> 00:11:56,730
operators did they used pretty

246
00:11:56,730 --> 00:11:59,910
interesting file names to strike the

247
00:11:59,910 --> 00:12:03,060
curiosity of the recipient and increase

248
00:12:03,060 --> 00:12:04,320
the likelihood that it they would open

249
00:12:04,320 --> 00:12:07,590
the attachment for example a table of

250
00:12:07,590 --> 00:12:09,630
prisoners of Ukrainian armed forces on

251
00:12:09,630 --> 00:12:12,660
the 5th of March or another one says a

252
00:12:12,660 --> 00:12:15,900
list of capture during the ato ato being

253
00:12:15,900 --> 00:12:20,190
the anti-terrorist operation in the east

254
00:12:20,190 --> 00:12:23,690
of in the east of Ukraine in the crisis

255
00:12:23,690 --> 00:12:27,180
and again as I mentioned some somewhat

256
00:12:27,180 --> 00:12:30,350
of a trademark by this group the

257
00:12:30,350 --> 00:12:32,460
documents appeared corrupted as you can

258
00:12:32,460 --> 00:12:41,670
see in these couple of examples then

259
00:12:41,670 --> 00:12:43,980
during our research we found out

260
00:12:43,980 --> 00:12:46,680
something particularly interesting this

261
00:12:46,680 --> 00:12:50,400
was one detection of Patal it was

262
00:12:50,400 --> 00:12:54,330
detected under file name like this the

263
00:12:54,330 --> 00:12:56,460
interesting part was that this file was

264
00:12:56,460 --> 00:13:01,400
created on the system by TrueCrypt XE

265
00:13:01,400 --> 00:13:04,200
now one possible explanation for this of

266
00:13:04,200 --> 00:13:06,900
course was that you know as malware

267
00:13:06,900 --> 00:13:11,160
usually tries to copy itself on the on

268
00:13:11,160 --> 00:13:14,220
the system using innocuous innocent

269
00:13:14,220 --> 00:13:16,530
looking filenames so that was one one

270
00:13:16,530 --> 00:13:17,850
possible summation however we

271
00:13:17,850 --> 00:13:19,980
investigated further as it

272
00:13:19,980 --> 00:13:22,380
did catch our attention we found out

273
00:13:22,380 --> 00:13:24,690
that this true crooked eggsy was created

274
00:13:24,690 --> 00:13:27,530
by an installer TrueCrypt set up and

275
00:13:27,530 --> 00:13:31,590
this installer was downloaded from a

276
00:13:31,590 --> 00:13:34,730
website called TrueCrypt russia dot room

277
00:13:34,730 --> 00:13:39,420
so looking at TrueCrypt russia we see a

278
00:13:39,420 --> 00:13:44,430
website which appears legit you're able

279
00:13:44,430 --> 00:13:50,010
to download localized russian translated

280
00:13:50,010 --> 00:13:54,090
version of TrueCrypt it works and in the

281
00:13:54,090 --> 00:13:57,320
largest number of cases it will be clean

282
00:13:57,320 --> 00:14:01,080
however in the largest amount of cases

283
00:14:01,080 --> 00:14:03,000
in most cases doesn't mean always so

284
00:14:03,000 --> 00:14:04,440
when we looked at our telemetry of

285
00:14:04,440 --> 00:14:07,020
downloads from this particular domain we

286
00:14:07,020 --> 00:14:10,980
saw different different binaries being

287
00:14:10,980 --> 00:14:13,620
downloaded from from this website as you

288
00:14:13,620 --> 00:14:16,290
can see in this table some of them were

289
00:14:16,290 --> 00:14:17,760
clean and there were a couple of

290
00:14:17,760 --> 00:14:20,790
different variants of of slightly

291
00:14:20,790 --> 00:14:25,890
modified modified TrueCrypt in his atlas

292
00:14:25,890 --> 00:14:27,680
part in the technical he will explain

293
00:14:27,680 --> 00:14:29,990
how the TrueCrypt

294
00:14:29,990 --> 00:14:32,940
software was trojan iced to include a

295
00:14:32,940 --> 00:14:36,390
back door now of course there are

296
00:14:36,390 --> 00:14:38,370
several possible explanations for this

297
00:14:38,370 --> 00:14:40,830
one is that it was it was a website

298
00:14:40,830 --> 00:14:45,330
operated by the attackers and they were

299
00:14:45,330 --> 00:14:47,580
doing it for quite quite quite a while

300
00:14:47,580 --> 00:14:49,680
another explanation is that is that it

301
00:14:49,680 --> 00:14:51,630
was merely compromised by the attackers

302
00:14:51,630 --> 00:14:53,880
and it was a legitimate website well if

303
00:14:53,880 --> 00:14:55,980
we weigh in all these all these points

304
00:14:55,980 --> 00:14:58,230
so it was not only serving trojan a

305
00:14:58,230 --> 00:15:00,660
script it was also acting as a command

306
00:15:00,660 --> 00:15:05,250
control server for the backdoor and the

307
00:15:05,250 --> 00:15:06,690
connection to potala is even stronger

308
00:15:06,690 --> 00:15:08,670
not only did the back door within

309
00:15:08,670 --> 00:15:11,610
TrueCrypt download portal but it was

310
00:15:11,610 --> 00:15:13,590
also the website was also serving portal

311
00:15:13,590 --> 00:15:16,440
itself and was doing this for for quite

312
00:15:16,440 --> 00:15:18,960
a while it was doing it very stealthily

313
00:15:18,960 --> 00:15:21,540
it was selectively picking the victims

314
00:15:21,540 --> 00:15:26,220
to who the back door would be served and

315
00:15:26,220 --> 00:15:30,480
another interesting finding was that on

316
00:15:30,480 --> 00:15:33,670
the website you're able to click to a u2

317
00:15:33,670 --> 00:15:35,800
video that's basically an instruction

318
00:15:35,800 --> 00:15:38,340
video on how to how to use the popular

319
00:15:38,340 --> 00:15:41,920
encryption software so when we watch the

320
00:15:41,920 --> 00:15:44,200
video we noticed something something

321
00:15:44,200 --> 00:15:46,570
interesting in the browser the author of

322
00:15:46,570 --> 00:15:50,260
the video had a had a bookmark to FL

323
00:15:50,260 --> 00:15:52,680
one of the largest to russian freelancer

324
00:15:52,680 --> 00:15:57,070
job posting websites and it contained

325
00:15:57,070 --> 00:16:01,210
it contained text which has need to

326
00:16:01,210 --> 00:16:04,120
record v it was cut off but look we were

327
00:16:04,120 --> 00:16:08,770
lucky enough to find that posting that

328
00:16:08,770 --> 00:16:11,290
job offer there were actually two of

329
00:16:11,290 --> 00:16:15,520
them and they basically contained the

330
00:16:15,520 --> 00:16:17,230
instructions on how to create the video

331
00:16:17,230 --> 00:16:19,180
and they included a link to TrueCrypt

332
00:16:19,180 --> 00:16:23,110
71a which is a legitimate domain for

333
00:16:23,110 --> 00:16:27,310
TrueCrypt however this posting was there

334
00:16:27,310 --> 00:16:31,590
since 2013 and it was modified in march

335
00:16:31,590 --> 00:16:35,440
2015 so almost two years later and we

336
00:16:35,440 --> 00:16:37,780
were also able to find out the original

337
00:16:37,780 --> 00:16:42,070
version of of the posting and guess

338
00:16:42,070 --> 00:16:46,420
which address guess which address that

339
00:16:46,420 --> 00:16:50,320
pointed to true curb - ah true so the

340
00:16:50,320 --> 00:16:51,580
open question of course remains why

341
00:16:51,580 --> 00:16:53,890
would somebody go two years later trying

342
00:16:53,890 --> 00:16:56,440
to cover their tracks and change change

343
00:16:56,440 --> 00:17:01,030
that address so moving on to the

344
00:17:01,030 --> 00:17:03,940
technical part of the presentation first

345
00:17:03,940 --> 00:17:06,730
a couple of detection statistics so as I

346
00:17:06,730 --> 00:17:08,619
said the malware has been around for it

347
00:17:08,619 --> 00:17:10,420
for about five years

348
00:17:10,420 --> 00:17:12,730
the reason why we started looking at was

349
00:17:12,730 --> 00:17:15,400
the increase in the amounts of

350
00:17:15,400 --> 00:17:18,970
detections in this in this diagram you

351
00:17:18,970 --> 00:17:21,460
can see only the actual victims the

352
00:17:21,460 --> 00:17:22,630
number of victims of the targeted

353
00:17:22,630 --> 00:17:25,270
campaign so we excluded the debugging

354
00:17:25,270 --> 00:17:27,339
version in 2013 and the mass spreading

355
00:17:27,339 --> 00:17:32,800
campaigns in 2011 and the reason for for

356
00:17:32,800 --> 00:17:36,100
this increase in 2014 was the

357
00:17:36,100 --> 00:17:37,990
introduction of a new spreading

358
00:17:37,990 --> 00:17:40,360
mechanism so to summarize it the

359
00:17:40,360 --> 00:17:41,440
different kinds of spreading Maxon

360
00:17:41,440 --> 00:17:43,710
mechanisms which we have observed

361
00:17:43,710 --> 00:17:46,830
throughout our research was

362
00:17:46,830 --> 00:17:51,810
the masquerading executables as as Word

363
00:17:51,810 --> 00:17:53,670
documents we also saw Excel documents

364
00:17:53,670 --> 00:17:56,940
and PDFs spread through a variety of

365
00:17:56,940 --> 00:18:02,600
ways also some some as you can see here

366
00:18:02,600 --> 00:18:05,880
also a very interesting us be spreading

367
00:18:05,880 --> 00:18:09,060
mechanism so it didn't use the the old

368
00:18:09,060 --> 00:18:11,760
autorun.inf trick but it instead use

369
00:18:11,760 --> 00:18:15,870
something quite clever if there were any

370
00:18:15,870 --> 00:18:18,210
files in the root directory of the USB

371
00:18:18,210 --> 00:18:20,520
Drive it will mark them as hidden it

372
00:18:20,520 --> 00:18:23,510
would copy copy itself to that drive

373
00:18:23,510 --> 00:18:27,090
using an icon off of a remote removable

374
00:18:27,090 --> 00:18:30,930
drive and the file name would be would

375
00:18:30,930 --> 00:18:34,500
be set according to the label of that

376
00:18:34,500 --> 00:18:37,410
USB Drive so when some some victim

377
00:18:37,410 --> 00:18:39,930
opened this they were very easily fooled

378
00:18:39,930 --> 00:18:41,520
into you know clicking this thinking

379
00:18:41,520 --> 00:18:43,440
that they would they would open that USB

380
00:18:43,440 --> 00:18:45,240
Drive while they were running the

381
00:18:45,240 --> 00:18:46,380
malware and of course there was the

382
00:18:46,380 --> 00:18:50,670
Trojan script and possibly other methods

383
00:18:50,670 --> 00:18:54,750
which we have not seen and now it's on

384
00:18:54,750 --> 00:18:58,950
toaster the mower consists of two

385
00:18:58,950 --> 00:19:01,740
components the dropper and the drop/add

386
00:19:01,740 --> 00:19:06,240
dll the dropper creates java file and

387
00:19:06,240 --> 00:19:12,000
executed by run the DVD to it writes it

388
00:19:12,000 --> 00:19:15,840
to standard rigid a key but interesting

389
00:19:15,840 --> 00:19:18,120
part here that before dropping it

390
00:19:18,120 --> 00:19:23,700
changed some expert function of this do

391
00:19:23,700 --> 00:19:28,290
also on every different computer it the

392
00:19:28,290 --> 00:19:31,860
java file will be unique we think it it

393
00:19:31,860 --> 00:19:36,270
is some kind of bypass of all potential

394
00:19:36,270 --> 00:19:39,050
protection or something like that

395
00:19:39,050 --> 00:19:43,920
so when executed it injects itself into

396
00:19:43,920 --> 00:19:48,900
two types of processes one instance is

397
00:19:48,900 --> 00:19:53,820
to be injected processes that use

398
00:19:53,820 --> 00:19:56,630
internet connection and this iNSYS is

399
00:19:56,630 --> 00:19:59,970
responsible for communication with

400
00:19:59,970 --> 00:20:03,300
si si - si NCE senator and another

401
00:20:03,300 --> 00:20:06,330
instance is injected to explorer.exe and

402
00:20:06,330 --> 00:20:09,510
this instant is responsible for reigning

403
00:20:09,510 --> 00:20:13,200
pagans and these two instances the talk

404
00:20:13,200 --> 00:20:19,580
each other with each other via pipe and

405
00:20:20,600 --> 00:20:24,300
CNC communication it use strong crypto

406
00:20:24,300 --> 00:20:30,420
and here is an example of decrypted data

407
00:20:30,420 --> 00:20:35,400
it sends to C&C server ID campaign a

408
00:20:35,400 --> 00:20:37,820
year version of a protection system

409
00:20:37,820 --> 00:20:41,370
version of mobile computer name process

410
00:20:41,370 --> 00:20:44,910
name and so on and it encrypts this data

411
00:20:44,910 --> 00:20:54,090
and it encapsulated into protocol that

412
00:20:54,090 --> 00:20:58,110
looks like XML RPC here is an example

413
00:20:58,110 --> 00:21:04,800
and in this example you can see there is

414
00:21:04,800 --> 00:21:09,210
two static parts that that we observed

415
00:21:09,210 --> 00:21:13,530
during our mentoring winter tasks this

416
00:21:13,530 --> 00:21:18,090
oral part is always the same and method

417
00:21:18,090 --> 00:21:21,150
called method name and followed constant

418
00:21:21,150 --> 00:21:24,270
is always this is same in path all

419
00:21:24,270 --> 00:21:32,360
traffic so here is examples of possible

420
00:21:32,360 --> 00:21:36,450
commands it doesn't have so many

421
00:21:36,450 --> 00:21:40,140
commands so it's just down order it can

422
00:21:40,140 --> 00:21:46,380
go out plugin or executable so and here

423
00:21:46,380 --> 00:21:50,850
is example of plugins that we observe

424
00:21:50,850 --> 00:21:54,720
doing or monitoring it is possible that

425
00:21:54,720 --> 00:21:59,400
this list is not full it's possible that

426
00:21:59,400 --> 00:22:04,440
we missed something but it it is what we

427
00:22:04,440 --> 00:22:09,150
saw so plugins are not stored on the

428
00:22:09,150 --> 00:22:13,420
disk and there is two types of plugins

429
00:22:13,420 --> 00:22:16,360
I plugin it means that it collects some

430
00:22:16,360 --> 00:22:19,750
information and it returns collected

431
00:22:19,750 --> 00:22:24,760
data to core model and full plugin it

432
00:22:24,760 --> 00:22:30,570
means that it rules continuously and it

433
00:22:30,570 --> 00:22:35,010
communicates with since this error by

434
00:22:35,010 --> 00:22:41,580
himself it means that it might contain

435
00:22:41,580 --> 00:22:46,080
different since easier than core model

436
00:22:46,080 --> 00:22:51,280
so and by looking on this list you can

437
00:22:51,280 --> 00:22:55,990
see that it is the functionality is

438
00:22:55,990 --> 00:22:59,050
pretty much what you expect from this

439
00:22:59,050 --> 00:23:02,200
kind of backdoor so first plugin it

440
00:23:02,200 --> 00:23:04,620
collects browsing history of various

441
00:23:04,620 --> 00:23:09,960
browsers second plugin it has a name but

442
00:23:09,960 --> 00:23:12,130
functionality is different it correct

443
00:23:12,130 --> 00:23:17,520
information about system password still

444
00:23:17,520 --> 00:23:21,040
collects in from password from for

445
00:23:21,040 --> 00:23:26,110
following applications keyword injected

446
00:23:26,110 --> 00:23:29,740
softer following process name and

447
00:23:29,740 --> 00:23:35,610
collects his drugs and his example of

448
00:23:35,610 --> 00:23:42,160
code for screen dot geo Y&T spigen grabs

449
00:23:42,160 --> 00:23:45,670
can you sort of desktop so as you can

450
00:23:45,670 --> 00:23:49,690
see it just makes screenshot it converts

451
00:23:49,690 --> 00:23:56,700
binary data to base64 and it returns

452
00:23:56,700 --> 00:24:03,390
result or core component file path 0

453
00:24:03,390 --> 00:24:06,910
this wagon just collect information

454
00:24:06,910 --> 00:24:10,240
about files but it doesn't steal files

455
00:24:10,240 --> 00:24:16,360
is itself and this plugin it actually

456
00:24:16,360 --> 00:24:23,459
shows files so it

457
00:24:23,490 --> 00:24:30,720
used for data exfiltration so let's talk

458
00:24:30,720 --> 00:24:34,320
about faith this year it is completely

459
00:24:34,320 --> 00:24:37,590
different mother so it is not a tower it

460
00:24:37,590 --> 00:24:40,340
is TrueCrypt

461
00:24:40,340 --> 00:24:43,440
it looks like - clipped it works like

462
00:24:43,440 --> 00:24:45,660
through clipped but it has some

463
00:24:45,660 --> 00:24:53,820
additional feature so event user Mouse

464
00:24:53,820 --> 00:24:59,160
his encrypted Drive it activates some

465
00:24:59,160 --> 00:25:07,350
backdoor functionality and when this

466
00:25:07,350 --> 00:25:09,720
bubble is activated it connects to C&C

467
00:25:09,720 --> 00:25:15,330
server and it gets some of these

468
00:25:15,330 --> 00:25:19,320
commands so it is as we can see it's

469
00:25:19,320 --> 00:25:22,429
fully future espionage style it can

470
00:25:22,429 --> 00:25:26,970
collect data collect files on encrypted

471
00:25:26,970 --> 00:25:30,179
drive it can still file it can still

472
00:25:30,179 --> 00:25:35,150
password it can download and execute

473
00:25:36,200 --> 00:25:42,090
file so and this backdoor functionality

474
00:25:42,090 --> 00:25:47,550
it is something that which is toughy

475
00:25:47,550 --> 00:25:51,020
so this book backdoor functionality is

476
00:25:51,020 --> 00:25:55,050
activated only when certain criteria is

477
00:25:55,050 --> 00:26:00,470
met and diskette arrays victims

478
00:26:00,470 --> 00:26:02,970
encrypted drive should contain more than

479
00:26:02,970 --> 00:26:05,490
10 files and this drive should not

480
00:26:05,490 --> 00:26:10,070
mounted more than 4 times so they are

481
00:26:10,070 --> 00:26:14,160
long jump to clipped users so and this

482
00:26:14,160 --> 00:26:17,880
is probably the reason why this model

483
00:26:17,880 --> 00:26:23,400
has been undetected for a walk he has

484
00:26:23,400 --> 00:26:29,010
compassion with other malware was here

485
00:26:29,010 --> 00:26:33,260
we presented black energy most

486
00:26:33,260 --> 00:26:38,600
targeted country was also Ukraine but

487
00:26:38,600 --> 00:26:41,390
tell us something interesting we found

488
00:26:41,390 --> 00:26:44,720
out that in patter plugin tourism type

489
00:26:44,720 --> 00:26:49,190
up and this diaper is in code that

490
00:26:49,190 --> 00:26:54,049
collects information about proxy ensign

491
00:26:54,049 --> 00:26:57,610
tape type of we found in the top court

492
00:26:57,610 --> 00:27:02,840
so we checked and this type is unique

493
00:27:02,840 --> 00:27:06,940
we checked a lot of modified files and

494
00:27:06,940 --> 00:27:11,960
we found out that this type exists as

495
00:27:11,960 --> 00:27:18,110
you can see in only in two models in the

496
00:27:18,110 --> 00:27:23,299
top and pata and the reason why i

497
00:27:23,299 --> 00:27:24,590
showing you this

498
00:27:24,590 --> 00:27:27,290
that we think that there is some code

499
00:27:27,290 --> 00:27:33,010
reuse between Zoar top and pata

500
00:27:34,210 --> 00:27:41,630
what is sore top the top is try and then

501
00:27:41,630 --> 00:27:45,140
well known its presence off we are spam

502
00:27:45,140 --> 00:27:50,590
and it also use RSA for encryption but

503
00:27:50,590 --> 00:27:55,940
the thing is that it's different so we

504
00:27:55,940 --> 00:27:58,160
cannot say that it was caught by some

505
00:27:58,160 --> 00:28:01,330
groom but we have seen some code reuse

506
00:28:01,330 --> 00:28:04,990
and this botnet is notorious for

507
00:28:04,990 --> 00:28:10,549
spreading messages masquerading terms of

508
00:28:10,549 --> 00:28:15,020
as parcel deliveries for example as this

509
00:28:15,020 --> 00:28:21,290
one and if you click on that button get

510
00:28:21,290 --> 00:28:26,330
possible list it you will get a fire and

511
00:28:26,330 --> 00:28:31,299
here's also similarity in naming scheme

512
00:28:31,299 --> 00:28:37,460
we observed following file names for Pat

513
00:28:37,460 --> 00:28:39,890
ow and our table and interesting Park

514
00:28:39,890 --> 00:28:43,040
Hill not when you are trying to download

515
00:28:43,040 --> 00:28:46,820
something several will rename TCG could

516
00:28:46,820 --> 00:28:51,950
based on Gil Gil Gil location of victim

517
00:28:51,950 --> 00:28:54,679
so if you are downloading file from

518
00:28:54,679 --> 00:28:58,179
London you will get file voicemail

519
00:28:58,179 --> 00:29:08,990
wandah so a bit okay so to sum it all up

520
00:29:08,990 --> 00:29:12,259
I think that was very interesting piece

521
00:29:12,259 --> 00:29:15,919
of malware malware family that has gone

522
00:29:15,919 --> 00:29:17,600
on a list for for quite a number of

523
00:29:17,600 --> 00:29:20,690
years the operation themselves were

524
00:29:20,690 --> 00:29:22,100
quite interesting the technical aspects

525
00:29:22,100 --> 00:29:24,980
were also quite interesting I guess it

526
00:29:24,980 --> 00:29:27,200
begs the obvious question who's behind

527
00:29:27,200 --> 00:29:30,169
it we don't really do speculation about

528
00:29:30,169 --> 00:29:34,179
attribution who is trying to spy on

529
00:29:34,179 --> 00:29:37,759
members of a pyramid scheme and at the

530
00:29:37,759 --> 00:29:40,309
same time spying against Ukrainian

531
00:29:40,309 --> 00:29:42,799
high-value government targets and spying

532
00:29:42,799 --> 00:29:45,919
on people who are encrypting files on

533
00:29:45,919 --> 00:29:48,740
their computer the only only things

534
00:29:48,740 --> 00:29:51,440
which have a we have observed some clues

535
00:29:51,440 --> 00:29:53,330
is that the malware authors were

536
00:29:53,330 --> 00:29:54,309
probably

537
00:29:54,309 --> 00:29:57,710
russian-speaking and that's pretty much

538
00:29:57,710 --> 00:29:59,360
it if you're if you're interested in

539
00:29:59,360 --> 00:30:00,830
this topic we release the white paper

540
00:30:00,830 --> 00:30:02,269
about it where you can read more details

541
00:30:02,269 --> 00:30:05,149
and not sure if we have time for

542
00:30:05,149 --> 00:30:08,539
questions if not then we'll be available

543
00:30:08,539 --> 00:30:10,940
I think we should good with one question

544
00:30:10,940 --> 00:30:17,110
or two anyone

545
00:30:28,220 --> 00:30:32,120
what is the current state of detection

546
00:30:32,120 --> 00:30:37,789
of this malware by the well anti-malware

547
00:30:37,789 --> 00:30:42,140
protesser that are out there they

548
00:30:42,140 --> 00:30:47,270
detected I mean the others it's it's is

549
00:30:47,270 --> 00:30:50,270
detected by other other AV vendors as

550
00:30:50,270 --> 00:30:56,780
well yeah but it hasn't received that

551
00:30:56,780 --> 00:31:06,549
much that much attention yet there's one

552
00:31:24,330 --> 00:31:30,210
I think they use integer to API and they

553
00:31:30,210 --> 00:31:33,920
also collect data from registry

554
00:31:33,920 --> 00:31:37,590
okay so I think our time ran up so let's

555
00:31:37,590 --> 00:31:40,909
thank the guys for the great research

556
00:31:42,740 --> 00:31:45,810
I'm sure there will be around for some

557
00:31:45,810 --> 00:31:47,990
more questions

