1
00:00:00,000 --> 00:00:04,019
are you ready yes okay welcome everyone

2
00:00:04,019 --> 00:00:11,360
to the last session and very well so

3
00:00:11,360 --> 00:00:13,559
sorry for the late start due to the

4
00:00:13,559 --> 00:00:15,960
other room being delayed but we shall

5
00:00:15,960 --> 00:00:19,890
now hear from yaniv and run from check

6
00:00:19,890 --> 00:00:24,289
point about the unbearable lightness of

7
00:00:24,289 --> 00:00:30,590
Appling apg beating so yes yet another

8
00:00:30,590 --> 00:00:34,920
presentation regarding apts I guess

9
00:00:34,920 --> 00:00:37,140
we're going to go like this until we

10
00:00:37,140 --> 00:00:40,739
bend the use of this dreadful term but

11
00:00:40,739 --> 00:00:42,690
for now we are also going to put the

12
00:00:42,690 --> 00:00:45,570
context of our work in the overall

13
00:00:45,570 --> 00:00:50,969
context of what apts are first just

14
00:00:50,969 --> 00:00:54,570
briefly both he and yves and myself are

15
00:00:54,570 --> 00:00:57,449
part of a relatively new organization at

16
00:00:57,449 --> 00:00:59,250
the checkpoint checkpoint spread

17
00:00:59,250 --> 00:01:01,770
intelligence and research area we are

18
00:01:01,770 --> 00:01:04,409
the research arm of checkpoints R&D

19
00:01:04,409 --> 00:01:06,689
we've been around for almost three years

20
00:01:06,689 --> 00:01:09,030
now we're still growing in quantity at

21
00:01:09,030 --> 00:01:12,090
least hopefully also in a quality we do

22
00:01:12,090 --> 00:01:14,850
our best but anyway regarding the

23
00:01:14,850 --> 00:01:21,570
specific campaign that we analyzed

24
00:01:21,570 --> 00:01:25,680
earlier this year and yes we want to put

25
00:01:25,680 --> 00:01:28,320
it in the context of apt well what is

26
00:01:28,320 --> 00:01:33,000
apt apt as we all know is the kind of

27
00:01:33,000 --> 00:01:36,180
the concatenation of these strange terms

28
00:01:36,180 --> 00:01:38,670
by the way if you want a an exhaustive

29
00:01:38,670 --> 00:01:42,119
list of definitions for apt you wouldn't

30
00:01:42,119 --> 00:01:44,700
find it in our paper but you would find

31
00:01:44,700 --> 00:01:47,280
it in the paper behind this morning's

32
00:01:47,280 --> 00:01:51,060
excellent lecture about testing for apts

33
00:01:51,060 --> 00:01:56,430
yeah so what a PP is there are they are

34
00:01:56,430 --> 00:01:58,290
about advance and persistence and

35
00:01:58,290 --> 00:02:01,860
threats let's start with the persistence

36
00:02:01,860 --> 00:02:04,890
party in most cases people were the

37
00:02:04,890 --> 00:02:06,780
different notions of persistence that

38
00:02:06,780 --> 00:02:08,818
people are using in many cases it's

39
00:02:08,818 --> 00:02:10,139
about the length

40
00:02:10,139 --> 00:02:12,260
of the campaign campaigns the last four

41
00:02:12,260 --> 00:02:16,200
months probably years in other cases

42
00:02:16,200 --> 00:02:18,150
people look more the kind of the

43
00:02:18,150 --> 00:02:20,880
persistent of the attackers in kind of

44
00:02:20,880 --> 00:02:23,459
breaching the specific the Precision's

45
00:02:23,459 --> 00:02:25,319
of the attackers in bridging the

46
00:02:25,319 --> 00:02:28,950
specific targets that they chose with

47
00:02:28,950 --> 00:02:31,770
threats really we often look actually at

48
00:02:31,770 --> 00:02:34,560
the targets at what kind of what is it

49
00:02:34,560 --> 00:02:36,239
that we are looking at what are the

50
00:02:36,239 --> 00:02:40,140
motives behind the campaign and in most

51
00:02:40,140 --> 00:02:43,320
cases we're dealing with all sorts of

52
00:02:43,320 --> 00:02:46,800
can not strictly financial motivation

53
00:02:46,800 --> 00:02:48,870
there's usually some sort of a political

54
00:02:48,870 --> 00:02:51,930
geopolitical aspects some sort of maybe

55
00:02:51,930 --> 00:02:58,140
state-level espionage and so on advance

56
00:02:58,140 --> 00:03:01,170
is really a it's a relative term and

57
00:03:01,170 --> 00:03:04,170
really the focus of this talk is a kind

58
00:03:04,170 --> 00:03:06,450
of the wide spectrum of how advanced or

59
00:03:06,450 --> 00:03:09,900
technically sophisticated you need to be

60
00:03:09,900 --> 00:03:14,209
in order to kind of stage a targeted

61
00:03:14,209 --> 00:03:17,610
targeted attack and apt like attack but

62
00:03:17,610 --> 00:03:21,060
before going into this let's take a

63
00:03:21,060 --> 00:03:23,910
quick look at some some sophistic sore

64
00:03:23,910 --> 00:03:27,299
some information and we are actually

65
00:03:27,299 --> 00:03:30,660
we're using the apt know that Kieran

66
00:03:30,660 --> 00:03:33,900
bangla having a on github so we're just

67
00:03:33,900 --> 00:03:36,239
using those knows those collection of

68
00:03:36,239 --> 00:03:40,170
reports that are are somewhat related to

69
00:03:40,170 --> 00:03:43,079
apts and the numbers are growing the

70
00:03:43,079 --> 00:03:45,030
numbers are growing along the years for

71
00:03:45,030 --> 00:03:47,220
and I'm not going to discuss any of the

72
00:03:47,220 --> 00:03:50,220
year specific campaigns of course at

73
00:03:50,220 --> 00:03:52,470
this point but the numbers are growing

74
00:03:52,470 --> 00:03:57,299
along the years and for different

75
00:03:57,299 --> 00:04:01,019
reasons maybe it's like people are

76
00:04:01,019 --> 00:04:04,170
reporting more apts but I think that

77
00:04:04,170 --> 00:04:06,750
they are actually far more such

78
00:04:06,750 --> 00:04:08,730
campaigns these days and they used to be

79
00:04:08,730 --> 00:04:12,109
here I think also because more more

80
00:04:12,109 --> 00:04:14,040
organizations are going into this

81
00:04:14,040 --> 00:04:15,780
business like just like we're going to

82
00:04:15,780 --> 00:04:20,820
see soon so what's common in most cases

83
00:04:20,820 --> 00:04:23,230
to a pt's it's really about who's

84
00:04:23,230 --> 00:04:26,140
behind the campaign and in most cases

85
00:04:26,140 --> 00:04:30,690
were dealing with this attribution game

86
00:04:30,690 --> 00:04:34,030
it's been discussed all over the place

87
00:04:34,030 --> 00:04:36,430
it's it's hard to attribute but still

88
00:04:36,430 --> 00:04:44,460
just without the kind of endorsing sorry

89
00:04:47,010 --> 00:04:49,960
okay here it comes without necessarily

90
00:04:49,960 --> 00:04:52,060
endorsing the attribution of those

91
00:04:52,060 --> 00:04:54,640
specific campaigns listed in the apt

92
00:04:54,640 --> 00:04:58,390
notes just looking at the 2015 campaigns

93
00:04:58,390 --> 00:05:01,300
over there this is what you'd find as

94
00:05:01,300 --> 00:05:03,370
the let's say at least the probable

95
00:05:03,370 --> 00:05:07,180
actors behind the 80 or so campaigns

96
00:05:07,180 --> 00:05:12,970
listed so till till now for 2015 not

97
00:05:12,970 --> 00:05:16,450
surprisingly you'd find China leading

98
00:05:16,450 --> 00:05:19,990
the place with Russia also hear a strong

99
00:05:19,990 --> 00:05:23,350
presence just the previous lecture gave

100
00:05:23,350 --> 00:05:26,610
us some background around the French

101
00:05:26,610 --> 00:05:30,880
presence on this pie chart and so and so

102
00:05:30,880 --> 00:05:36,040
on we know that in many cases people

103
00:05:36,040 --> 00:05:40,600
tend to to do that it's not about but

104
00:05:40,600 --> 00:05:43,710
there's it's it's not just the default

105
00:05:43,710 --> 00:05:48,040
it's and it's not just and I guess

106
00:05:48,040 --> 00:05:50,260
there's a good reason why Obama is more

107
00:05:50,260 --> 00:05:52,180
concerned with Chinese state level

108
00:05:52,180 --> 00:05:56,680
espionage then with many other probable

109
00:05:56,680 --> 00:05:59,620
actors around these kind of threats so

110
00:05:59,620 --> 00:06:01,960
in any case we are talking about the big

111
00:06:01,960 --> 00:06:05,170
powers and and in many cases just like

112
00:06:05,170 --> 00:06:08,520
also in the previous presentation sorry

113
00:06:08,520 --> 00:06:12,940
in in many cases we can actually

114
00:06:12,940 --> 00:06:15,490
attribute the campaign specifically to

115
00:06:15,490 --> 00:06:19,210
the strong well-known intelligence

116
00:06:19,210 --> 00:06:22,300
organizations that these nations are

117
00:06:22,300 --> 00:06:24,430
operating the operating them for many

118
00:06:24,430 --> 00:06:28,950
years with a lot of resources and cyber

119
00:06:28,950 --> 00:06:31,840
campaigns are natural kind of extensions

120
00:06:31,840 --> 00:06:35,340
to the list of activities that

121
00:06:35,340 --> 00:06:38,550
these organizations are involved in at

122
00:06:38,550 --> 00:06:42,419
this point gave a bit of a context and I

123
00:06:42,419 --> 00:06:44,310
like to hand it over to your Nev to talk

124
00:06:44,310 --> 00:06:47,310
about the specifics of the campaigns

125
00:06:47,310 --> 00:06:49,910
that we've analyzed earlier this year

126
00:06:49,910 --> 00:06:54,030
thanks Ron can you hear me is this on

127
00:06:54,030 --> 00:06:57,570
yeah yeah so thanks Ron and we're going

128
00:06:57,570 --> 00:06:59,370
to discuss today campaign it with

129
00:06:59,370 --> 00:07:01,470
research during the past year it's

130
00:07:01,470 --> 00:07:05,220
called volatile zero and what is it what

131
00:07:05,220 --> 00:07:07,500
is volatile zero so it's a targeted

132
00:07:07,500 --> 00:07:09,990
campaign and it's been acting for almost

133
00:07:09,990 --> 00:07:13,260
three years and some word late 2012

134
00:07:13,260 --> 00:07:16,440
until terminated almost exactly after

135
00:07:16,440 --> 00:07:18,330
we've published our report somewhere in

136
00:07:18,330 --> 00:07:20,700
March 2015 we've actually just a few

137
00:07:20,700 --> 00:07:22,080
days after this report was published

138
00:07:22,080 --> 00:07:24,660
we've seen kill commands being sent from

139
00:07:24,660 --> 00:07:27,690
the C&C servers to the bots and this

140
00:07:27,690 --> 00:07:29,760
like eliminated all evidence of this

141
00:07:29,760 --> 00:07:31,410
campaign we haven't been able to track

142
00:07:31,410 --> 00:07:36,090
it sense sorry so volatile cedar is kind

143
00:07:36,090 --> 00:07:38,850
of an interesting name and why did you

144
00:07:38,850 --> 00:07:41,070
even choose this name I mean it's kind

145
00:07:41,070 --> 00:07:43,080
of strange well there's a perfectly good

146
00:07:43,080 --> 00:07:45,350
reason for that and the reason is that

147
00:07:45,350 --> 00:07:47,539
volatile is just another word for

148
00:07:47,539 --> 00:07:50,400
explosive right and explosive just

149
00:07:50,400 --> 00:07:52,560
happens to be an obfuscated string we've

150
00:07:52,560 --> 00:07:54,750
actually found inside each one of the

151
00:07:54,750 --> 00:07:57,539
binaries of the main implant in

152
00:07:57,539 --> 00:07:59,910
throughout all this campaign so this was

153
00:07:59,910 --> 00:08:02,400
given by the by the attackers we just

154
00:08:02,400 --> 00:08:05,099
used it and cedar is actually a name of

155
00:08:05,099 --> 00:08:07,650
a tree right which just so happens to be

156
00:08:07,650 --> 00:08:10,250
right in the middle of the Lebanese flag

157
00:08:10,250 --> 00:08:14,360
well Lebanon yes we've actually you know

158
00:08:14,360 --> 00:08:17,430
most of the times we are kinda shy of

159
00:08:17,430 --> 00:08:20,760
attribution as I'm sure you all are but

160
00:08:20,760 --> 00:08:23,940
in this case we were actually so sure so

161
00:08:23,940 --> 00:08:26,340
so definite about this attribution that

162
00:08:26,340 --> 00:08:27,900
we actually decided to put this in our

163
00:08:27,900 --> 00:08:30,270
publication and we attributed this

164
00:08:30,270 --> 00:08:33,089
campaign to Lebanon however internally

165
00:08:33,089 --> 00:08:36,240
we had an even better attribution of the

166
00:08:36,240 --> 00:08:39,059
exact organization with in Lebanon

167
00:08:39,059 --> 00:08:41,429
responsible for this campaign however

168
00:08:41,429 --> 00:08:44,880
this was kind of a how can I say it and

169
00:08:44,880 --> 00:08:46,590
educated guess you know we didn't feel

170
00:08:46,590 --> 00:08:48,390
comfortable enough to share this in our

171
00:08:48,390 --> 00:08:51,960
report but luckily for us about two

172
00:08:51,960 --> 00:08:53,510
months ago the Israeli government

173
00:08:53,510 --> 00:08:56,010
published this this guy there is the

174
00:08:56,010 --> 00:08:58,410
israeli minister of defense and he

175
00:08:58,410 --> 00:09:01,260
confirmed that Israel was indeed one of

176
00:09:01,260 --> 00:09:03,630
the targets of this campaign and it was

177
00:09:03,630 --> 00:09:07,890
his Bala behind this campaign now some

178
00:09:07,890 --> 00:09:09,360
of you might be familiar with the term

179
00:09:09,360 --> 00:09:11,610
with the organization his balance some

180
00:09:11,610 --> 00:09:13,140
of you might not and for those of you

181
00:09:13,140 --> 00:09:15,930
are not let me just tell you that in a

182
00:09:15,930 --> 00:09:21,090
few words so Hezbollah is the transition

183
00:09:21,090 --> 00:09:24,180
from arabic of a party of God and they

184
00:09:24,180 --> 00:09:26,400
are an Islamic political and militant

185
00:09:26,400 --> 00:09:28,290
group and actually their political

186
00:09:28,290 --> 00:09:30,630
branch is a part of the Lebanese

187
00:09:30,630 --> 00:09:33,570
government itself now they are heavily

188
00:09:33,570 --> 00:09:36,360
founded by Iran and most importantly

189
00:09:36,360 --> 00:09:40,310
their official flag contains an ak-47

190
00:09:40,310 --> 00:09:43,500
understand what you want from that so

191
00:09:43,500 --> 00:09:47,250
that is Hizballah I know I was serious I

192
00:09:47,250 --> 00:09:49,680
mean Hizballah apt is it even possible

193
00:09:49,680 --> 00:09:51,840
that our organization like his beloved

194
00:09:51,840 --> 00:09:54,710
obviously limited budget and not so

195
00:09:54,710 --> 00:09:57,990
advanced technical skills can he even

196
00:09:57,990 --> 00:10:01,490
sustain an apt campaign for three years

197
00:10:01,490 --> 00:10:04,320
remaining completely undetected I mean

198
00:10:04,320 --> 00:10:06,030
that's a question that we asked

199
00:10:06,030 --> 00:10:07,650
ourselves can we call this campaign an

200
00:10:07,650 --> 00:10:11,250
apt and I think the best way to to

201
00:10:11,250 --> 00:10:13,440
answer that question is to try and see

202
00:10:13,440 --> 00:10:14,910
if the features of this campaign

203
00:10:14,910 --> 00:10:16,920
actually stands up to the definition of

204
00:10:16,920 --> 00:10:19,830
the apt that one just gave you a few

205
00:10:19,830 --> 00:10:21,990
minutes ago so let's start with

206
00:10:21,990 --> 00:10:23,760
persistent so what's this campaign

207
00:10:23,760 --> 00:10:26,010
persistent we've actually been able to

208
00:10:26,010 --> 00:10:28,980
find five different versions of this of

209
00:10:28,980 --> 00:10:30,960
the main implant in this the main binary

210
00:10:30,960 --> 00:10:33,870
of this campaign and these are the

211
00:10:33,870 --> 00:10:35,970
versions and what you see here in this

212
00:10:35,970 --> 00:10:38,460
timeline is new samples that we've

213
00:10:38,460 --> 00:10:40,830
detected along the years so as you can

214
00:10:40,830 --> 00:10:42,840
see somewhere around november two

215
00:10:42,840 --> 00:10:44,730
thousand twelve if we found a few new

216
00:10:44,730 --> 00:10:47,520
samples and then suddenly in march 2013

217
00:10:47,520 --> 00:10:50,010
that's it no more new samples of version

218
00:10:50,010 --> 00:10:52,010
number one that what happened in march

219
00:10:52,010 --> 00:10:55,260
2013 so we checked that out and it turns

220
00:10:55,260 --> 00:10:56,889
out that the first

221
00:10:56,889 --> 00:11:00,790
action was appeared in marriage 2013 so

222
00:11:00,790 --> 00:11:03,009
the first IV detection appeared and

223
00:11:03,009 --> 00:11:04,839
that's a this sample disappeared and

224
00:11:04,839 --> 00:11:06,790
what do you know just a few days maybe a

225
00:11:06,790 --> 00:11:08,709
week later we started seeing version

226
00:11:08,709 --> 00:11:10,869
number two right and then the whole

227
00:11:10,869 --> 00:11:12,999
thing repeats itself another avd tection

228
00:11:12,999 --> 00:11:15,040
and other versions another AV detection

229
00:11:15,040 --> 00:11:16,809
and another version so these guys

230
00:11:16,809 --> 00:11:18,309
actually adapted themselves they

231
00:11:18,309 --> 00:11:23,139
monitored what AV think of them or how

232
00:11:23,139 --> 00:11:26,019
do they classify them and they they

233
00:11:26,019 --> 00:11:28,329
published versions accordingly right so

234
00:11:28,329 --> 00:11:30,609
that means I guess that they are

235
00:11:30,609 --> 00:11:31,779
persistent I mean if this is not

236
00:11:31,779 --> 00:11:33,429
persistent for three years than what is

237
00:11:33,429 --> 00:11:35,769
persistent so they are persistent right

238
00:11:35,769 --> 00:11:39,129
but are they do the pose a threat do

239
00:11:39,129 --> 00:11:40,749
they do they answer the definition of

240
00:11:40,749 --> 00:11:44,109
threat so as Ron said before threat is

241
00:11:44,109 --> 00:11:46,239
all about targets so let's look at the

242
00:11:46,239 --> 00:11:48,399
targets the targets of this campaign

243
00:11:48,399 --> 00:11:50,829
were very carefully chosen I mean look

244
00:11:50,829 --> 00:11:52,899
at this pie chart here representing all

245
00:11:52,899 --> 00:11:54,999
the business sectors being attacked it's

246
00:11:54,999 --> 00:11:57,249
hosting services its civil services

247
00:11:57,249 --> 00:11:59,439
education services and even within this

248
00:11:59,439 --> 00:12:01,600
we know for a fact that the targets were

249
00:12:01,600 --> 00:12:03,669
really really carefully picked those

250
00:12:03,669 --> 00:12:06,239
guys knew who they were attacking and

251
00:12:06,239 --> 00:12:09,459
another thing is take a look at the gear

252
00:12:09,459 --> 00:12:12,699
locations of these targets right if we

253
00:12:12,699 --> 00:12:14,470
look at that we can see that around

254
00:12:14,470 --> 00:12:16,179
ninety five percent of the targets

255
00:12:16,179 --> 00:12:18,790
attack either Israel Saudi Arabia or

256
00:12:18,790 --> 00:12:21,279
Lebanon itself which completely aligns

257
00:12:21,279 --> 00:12:25,029
with with the agenda of Hezbollah so

258
00:12:25,029 --> 00:12:27,699
this is very very narrow geopolitical

259
00:12:27,699 --> 00:12:31,029
area right now what about what what this

260
00:12:31,029 --> 00:12:33,449
guy these guys did when they actually

261
00:12:33,449 --> 00:12:36,429
got into the target so that's another

262
00:12:36,429 --> 00:12:38,110
interesting question what they did is

263
00:12:38,110 --> 00:12:40,089
actually collect information we have

264
00:12:40,089 --> 00:12:42,220
hundreds and hundreds of megabytes of

265
00:12:42,220 --> 00:12:44,259
key logging data clip or data and stuff

266
00:12:44,259 --> 00:12:46,389
like that those guys set there for three

267
00:12:46,389 --> 00:12:48,399
years just collecting credentials

268
00:12:48,399 --> 00:12:50,110
collecting files collecting information

269
00:12:50,110 --> 00:12:53,350
they were absolutely not after financial

270
00:12:53,350 --> 00:12:55,869
gain they were after information so

271
00:12:55,869 --> 00:12:57,369
these three points actually I think

272
00:12:57,369 --> 00:12:59,439
stands very well to the definition of a

273
00:12:59,439 --> 00:13:02,230
track so they are persistent and they

274
00:13:02,230 --> 00:13:05,410
are a trip however are they advanced

275
00:13:05,410 --> 00:13:07,899
well that's a pretty good question

276
00:13:07,899 --> 00:13:10,179
because what is advanced and vest of one

277
00:13:10,179 --> 00:13:10,720
guy

278
00:13:10,720 --> 00:13:12,939
the basic of another how can we even

279
00:13:12,939 --> 00:13:15,490
define it and you know whenever I hear

280
00:13:15,490 --> 00:13:16,810
the terms you know as am al Ghul

281
00:13:16,810 --> 00:13:18,279
researcher when I Hitler terms like

282
00:13:18,279 --> 00:13:20,920
advanced apt and Hizballah a certain

283
00:13:20,920 --> 00:13:22,540
picture comes to mind that looks

284
00:13:22,540 --> 00:13:27,730
something well like this and come on

285
00:13:27,730 --> 00:13:29,470
admit it we all think the same I mean I

286
00:13:29,470 --> 00:13:31,750
mean how can we even compare hizballah

287
00:13:31,750 --> 00:13:34,569
to NSA or to the Chinese or to the

288
00:13:34,569 --> 00:13:36,160
Russian is it even possible to make this

289
00:13:36,160 --> 00:13:39,250
compression and how can we do it so we

290
00:13:39,250 --> 00:13:41,529
thought about this a bit and we decided

291
00:13:41,529 --> 00:13:45,430
the best way to do that is to try and to

292
00:13:45,430 --> 00:13:48,279
compare the different features of the of

293
00:13:48,279 --> 00:13:50,379
volatile sealer to the features of other

294
00:13:50,379 --> 00:13:53,740
apts that we all know and love right so

295
00:13:53,740 --> 00:13:55,660
in order to do that we propose a

296
00:13:55,660 --> 00:13:57,910
challenge challenge of David against

297
00:13:57,910 --> 00:13:59,709
Goliath of the huge against the small

298
00:13:59,709 --> 00:14:02,800
and in the blue corner representing all

299
00:14:02,800 --> 00:14:04,959
nation-state multi-billion dollar

300
00:14:04,959 --> 00:14:06,899
intelligence agencies organizations

301
00:14:06,899 --> 00:14:11,110
please welcome kit be Alexander and in

302
00:14:11,110 --> 00:14:12,639
the red corner representing the

303
00:14:12,639 --> 00:14:15,430
Hizbollah cyber security forces please

304
00:14:15,430 --> 00:14:17,529
welcome Hassan Nasrallah head of

305
00:14:17,529 --> 00:14:21,309
Hezbollah and let the fight begin round

306
00:14:21,309 --> 00:14:24,819
one attack vector so for a tech vector

307
00:14:24,819 --> 00:14:27,189
we actually chose Stuxnet and we all

308
00:14:27,189 --> 00:14:28,990
knows like that right at least most of

309
00:14:28,990 --> 00:14:31,269
us knows Stuxnet and what happened stuck

310
00:14:31,269 --> 00:14:32,649
said what was their attack vector they

311
00:14:32,649 --> 00:14:34,689
actually delivered USB drives to the

312
00:14:34,689 --> 00:14:36,519
actual site with a super secured site

313
00:14:36,519 --> 00:14:38,139
that actually involves human life's

314
00:14:38,139 --> 00:14:41,079
crazy and those USB drives actually

315
00:14:41,079 --> 00:14:43,509
contained and president unprecedented

316
00:14:43,509 --> 00:14:46,149
number of 40 days that's never never

317
00:14:46,149 --> 00:14:48,790
seen before and I think no sense also

318
00:14:48,790 --> 00:14:51,459
and on top of that they also had the

319
00:14:51,459 --> 00:14:53,230
sibling vulnerability which was one of

320
00:14:53,230 --> 00:14:55,689
the I think coolest vulnerability is

321
00:14:55,689 --> 00:14:57,519
most advanced abilities at a time and

322
00:14:57,519 --> 00:15:00,790
maybe it still is and then for computers

323
00:15:00,790 --> 00:15:02,740
that didn't connect USB drives they

324
00:15:02,740 --> 00:15:04,750
actually made lateral movement the

325
00:15:04,750 --> 00:15:07,089
appeal to PLP see those guys really

326
00:15:07,089 --> 00:15:09,100
wanted to get to those targets and well

327
00:15:09,100 --> 00:15:11,769
allegedly they did so that's very

328
00:15:11,769 --> 00:15:13,990
effective right now what happened in

329
00:15:13,990 --> 00:15:16,389
volatile zero so in most cases they knew

330
00:15:16,389 --> 00:15:18,370
their target and the target was a server

331
00:15:18,370 --> 00:15:21,730
however this server was a bit hard to

332
00:15:21,730 --> 00:15:24,250
to exploit or together the target into

333
00:15:24,250 --> 00:15:26,889
so what those guys did is just scan the

334
00:15:26,889 --> 00:15:28,690
network range around this server for a

335
00:15:28,690 --> 00:15:32,320
lot a lot of time and waited for until

336
00:15:32,320 --> 00:15:35,350
until sometime they could find some kind

337
00:15:35,350 --> 00:15:37,990
of unpatched IAS installation then they

338
00:15:37,990 --> 00:15:40,149
could easily exploit that they inserted

339
00:15:40,149 --> 00:15:42,130
the web show and a keylogger into that I

340
00:15:42,130 --> 00:15:43,990
just waited for an administrator or

341
00:15:43,990 --> 00:15:45,880
something like that to log on and then

342
00:15:45,880 --> 00:15:47,680
he used his credentials hopefully and

343
00:15:47,680 --> 00:15:49,870
logged into somewhere and then they just

344
00:15:49,870 --> 00:15:51,579
made lateral movement moved over there

345
00:15:51,579 --> 00:15:54,010
and repeat this process until they got

346
00:15:54,010 --> 00:15:56,920
to their server right so this is pretty

347
00:15:56,920 --> 00:15:58,930
easy and it's pretty effective and

348
00:15:58,930 --> 00:16:02,529
that's all they did round number two

349
00:16:02,529 --> 00:16:06,490
persistence so for persistence we took

350
00:16:06,490 --> 00:16:09,910
the example of equation which is really

351
00:16:09,910 --> 00:16:12,459
a great research and a great apt and

352
00:16:12,459 --> 00:16:15,279
what they did is to insert implant codes

353
00:16:15,279 --> 00:16:18,760
inside hard drive team words I mean come

354
00:16:18,760 --> 00:16:21,880
on that's crazy those guys supported 12

355
00:16:21,880 --> 00:16:24,370
different versions of hard drives that

356
00:16:24,370 --> 00:16:27,790
is completely I don't know I'm amazed by

357
00:16:27,790 --> 00:16:30,160
that to think about how much effort was

358
00:16:30,160 --> 00:16:32,230
spent into this and they could actually

359
00:16:32,230 --> 00:16:33,850
you know possibly in fact boot sectors

360
00:16:33,850 --> 00:16:36,240
and stuff like that very very impressive

361
00:16:36,240 --> 00:16:38,260
what did volatility to do for

362
00:16:38,260 --> 00:16:40,000
persistence well they just installed

363
00:16:40,000 --> 00:16:42,610
himself as a new service right and what

364
00:16:42,610 --> 00:16:44,260
happens if the service gets stopped or

365
00:16:44,260 --> 00:16:46,839
removed well remember the web shell from

366
00:16:46,839 --> 00:16:49,000
the fork just went into the system and

367
00:16:49,000 --> 00:16:51,430
started the game and here you got you go

368
00:16:51,430 --> 00:16:54,370
his ballast I'll persistence and it was

369
00:16:54,370 --> 00:16:56,949
really well now round number three

370
00:16:56,949 --> 00:16:59,410
command and control so and

371
00:16:59,410 --> 00:17:02,709
control we took plug X right and we can

372
00:17:02,709 --> 00:17:05,859
see that the the C&C servers defined in

373
00:17:05,859 --> 00:17:07,660
the in the configuration section of the

374
00:17:07,660 --> 00:17:09,549
binaries we're actually defined as Kosta

375
00:17:09,549 --> 00:17:12,640
as a legit host it was if I'm remember

376
00:17:12,640 --> 00:17:14,829
correctly like adobe com or update adobe

377
00:17:14,829 --> 00:17:18,069
com and what they did is also insert

378
00:17:18,069 --> 00:17:20,439
their own DNS server configuration into

379
00:17:20,439 --> 00:17:23,140
the client right and this DNS server was

380
00:17:23,140 --> 00:17:25,660
again legit and then they hijacked this

381
00:17:25,660 --> 00:17:27,760
specific dns and redirected all the

382
00:17:27,760 --> 00:17:29,790
traffic to the cnc server so if you're

383
00:17:29,790 --> 00:17:32,110
making a forensic investigation of the

384
00:17:32,110 --> 00:17:34,570
client you see all like what seems

385
00:17:34,570 --> 00:17:36,669
legit traffic going on while in fact

386
00:17:36,669 --> 00:17:39,519
it's going to the CNC that's really nice

387
00:17:39,519 --> 00:17:42,340
it really nice technical thing what did

388
00:17:42,340 --> 00:17:44,980
volatile 0 do well first of all they use

389
00:17:44,980 --> 00:17:47,590
a very advanced DGA algorithm that looks

390
00:17:47,590 --> 00:17:50,320
something like this and what it does is

391
00:17:50,320 --> 00:17:54,279
just choose one of these domains at a

392
00:17:54,279 --> 00:17:56,080
time actually they chose the fifth one

393
00:17:56,080 --> 00:17:58,210
as a default it made it super easy to

394
00:17:58,210 --> 00:18:00,519
sink hole and so that tells us that

395
00:18:00,519 --> 00:18:01,840
these guys obviously obviously know what

396
00:18:01,840 --> 00:18:05,080
bubble sort is and it what this was

397
00:18:05,080 --> 00:18:07,870
there DGA algorithm and then for the

398
00:18:07,870 --> 00:18:10,090
frame of itself they used hijack sites

399
00:18:10,090 --> 00:18:14,620
or cheap VPS s2 in order to to configure

400
00:18:14,620 --> 00:18:17,529
to make their own infrastructure it

401
00:18:17,529 --> 00:18:19,360
looks something like this it was pretty

402
00:18:19,360 --> 00:18:21,039
impressive I mean look at it the C&C

403
00:18:21,039 --> 00:18:23,289
server static ones dynamic ones other

404
00:18:23,289 --> 00:18:26,679
servers really cool and I actually went

405
00:18:26,679 --> 00:18:30,490
into this VPS site and try to find out

406
00:18:30,490 --> 00:18:32,889
how much does it cost to come up with

407
00:18:32,889 --> 00:18:34,840
this kind of framework and it turns out

408
00:18:34,840 --> 00:18:40,120
it cost something around 750,000 pounds

409
00:18:40,120 --> 00:18:42,580
which is impressive only this is

410
00:18:42,580 --> 00:18:45,129
lebanese pounds and it's the equal of

411
00:18:45,129 --> 00:18:48,519
around five hundred dollars well that's

412
00:18:48,519 --> 00:18:52,419
not including any discount so that's

413
00:18:52,419 --> 00:18:55,509
valid i 0 and now what about stilt so

414
00:18:55,509 --> 00:18:57,519
for stealth we took the example of

415
00:18:57,519 --> 00:19:00,669
Reagan Reagan region it actually used a

416
00:19:00,669 --> 00:19:03,970
very nice six-stage architecture and

417
00:19:03,970 --> 00:19:06,250
accused both userland and Carolyn

418
00:19:06,250 --> 00:19:08,710
modules and those modules were actually

419
00:19:08,710 --> 00:19:10,720
stored inside custom virtual file

420
00:19:10,720 --> 00:19:13,929
systems again super impressive this was

421
00:19:13,929 --> 00:19:15,759
research by semantic we took that from

422
00:19:15,759 --> 00:19:17,830
there look at that architecture I mean

423
00:19:17,830 --> 00:19:19,029
it's really really impressive you must

424
00:19:19,029 --> 00:19:22,509
you must admit right now what invalid is

425
00:19:22,509 --> 00:19:24,549
in order for stealth that's a good one

426
00:19:24,549 --> 00:19:27,700
they actually created a new tread to

427
00:19:27,700 --> 00:19:30,669
monitor process CPU activity and once

428
00:19:30,669 --> 00:19:32,440
this got above some kind of predefined

429
00:19:32,440 --> 00:19:34,990
threshold they just restarted the

430
00:19:34,990 --> 00:19:37,960
process and nobody will ever notice this

431
00:19:37,960 --> 00:19:41,500
right it might sound funny but nobody

432
00:19:41,500 --> 00:19:43,149
actually noticed this for three years so

433
00:19:43,149 --> 00:19:45,490
it actually worked right how easy is

434
00:19:45,490 --> 00:19:48,240
that up around five in

435
00:19:48,240 --> 00:19:50,830
for an encryption we chose the equation

436
00:19:50,830 --> 00:19:54,039
again and an equation they actually used

437
00:19:54,039 --> 00:19:56,799
a es rc5 and that's the actual first

438
00:19:56,799 --> 00:19:59,559
time that anybody have used RC six in a

439
00:19:59,559 --> 00:20:01,360
bower really impressive and not only

440
00:20:01,360 --> 00:20:04,240
that they've used RC six RC six but

441
00:20:04,240 --> 00:20:06,070
they've used the custom implementation

442
00:20:06,070 --> 00:20:08,440
of RC six that actually made it more

443
00:20:08,440 --> 00:20:12,190
perform a better performance and that's

444
00:20:12,190 --> 00:20:16,029
really a game very impressive and what

445
00:20:16,029 --> 00:20:18,330
did volatile zero do for encryption

446
00:20:18,330 --> 00:20:21,850
awesome so instead of writing let's say

447
00:20:21,850 --> 00:20:24,039
google com they decided to write a

448
00:20:24,039 --> 00:20:27,129
little know something like that and you

449
00:20:27,129 --> 00:20:29,379
know that might be a bit too easy

450
00:20:29,379 --> 00:20:31,029
because people can spot that it's just a

451
00:20:31,029 --> 00:20:33,309
reverse thing so let's use basics you

452
00:20:33,309 --> 00:20:36,580
found this and now you know it might

453
00:20:36,580 --> 00:20:38,710
look like a basics before so let's

454
00:20:38,710 --> 00:20:41,649
reverse this swing again and here we go

455
00:20:41,649 --> 00:20:43,539
his by last I'll encryption algorithm

456
00:20:43,539 --> 00:20:46,750
and undetected for two years nobody in

457
00:20:46,750 --> 00:20:48,820
this room including me have been able to

458
00:20:48,820 --> 00:20:51,429
detect this for three years so let's

459
00:20:51,429 --> 00:20:53,799
conclude everything here first of all

460
00:20:53,799 --> 00:20:56,679
advanced is a very subjective term right

461
00:20:56,679 --> 00:20:59,740
and I think that it's fair to say that

462
00:20:59,740 --> 00:21:03,070
sometimes dedication is far more

463
00:21:03,070 --> 00:21:05,049
important than resources if you're

464
00:21:05,049 --> 00:21:07,299
dedicated enough then you can create

465
00:21:07,299 --> 00:21:09,490
your own apt campaign at home okay

466
00:21:09,490 --> 00:21:11,710
dedication is the key word here in my

467
00:21:11,710 --> 00:21:14,620
opinion list and last but not least 80

468
00:21:14,620 --> 00:21:18,279
keys are surely no longer the sole

469
00:21:18,279 --> 00:21:20,379
domain of multi-billion dollar

470
00:21:20,379 --> 00:21:23,740
organizations and I handed over to Rome

471
00:21:23,740 --> 00:21:27,159
to conclude some oh yeah being a

472
00:21:27,159 --> 00:21:29,169
cryptanalyst in training i find the

473
00:21:29,169 --> 00:21:32,429
encryption part really fascinating

474
00:21:32,429 --> 00:21:36,039
anyway the full details of velocity

475
00:21:36,039 --> 00:21:38,950
there are either in a shorter version in

476
00:21:38,950 --> 00:21:42,340
the proceedings or as a fully as a fully

477
00:21:42,340 --> 00:21:44,710
detailed report with all of the IOC's

478
00:21:44,710 --> 00:21:49,029
and stuff in checkpoints research blog

479
00:21:49,029 --> 00:21:51,309
and of course you can approach any of us

480
00:21:51,309 --> 00:21:54,070
with any questions or issues around it

481
00:21:54,070 --> 00:21:59,019
now the campaign is has its kind of

482
00:21:59,019 --> 00:22:01,520
characteristics and since we are

483
00:22:01,520 --> 00:22:04,860
we've recently analyzed or still working

484
00:22:04,860 --> 00:22:08,790
on analyzing two similar campaigns to

485
00:22:08,790 --> 00:22:11,610
some degree but we were slow to publish

486
00:22:11,610 --> 00:22:13,350
so we've not yet published our own

487
00:22:13,350 --> 00:22:16,790
reports on days we decided nevertheless

488
00:22:16,790 --> 00:22:21,090
to add actually earlier this week we

489
00:22:21,090 --> 00:22:22,950
decided to add a couple of slides about

490
00:22:22,950 --> 00:22:24,510
these two additional components

491
00:22:24,510 --> 00:22:27,900
basically using the existing published

492
00:22:27,900 --> 00:22:31,260
information about them so the first one

493
00:22:31,260 --> 00:22:34,940
is a rocket kit in two and this is a

494
00:22:34,940 --> 00:22:38,790
relatively recent publication by our

495
00:22:38,790 --> 00:22:42,840
colleagues in clear sky and trend worth

496
00:22:42,840 --> 00:22:46,890
reading this report so i'll be using a

497
00:22:46,890 --> 00:22:49,260
few quotes out of this report to relate

498
00:22:49,260 --> 00:22:55,020
it to the kind of kind of way to

499
00:22:55,020 --> 00:22:57,960
characterize an apt campaign or you're

500
00:22:57,960 --> 00:23:01,920
not so typical ATP campaign so first of

501
00:23:01,920 --> 00:23:04,800
all the threats all the targets once

502
00:23:04,800 --> 00:23:08,010
again clearly politically motivated this

503
00:23:08,010 --> 00:23:14,150
kind of of focus on on political targets

504
00:23:14,150 --> 00:23:17,820
related to paly to policy to diplomacy

505
00:23:17,820 --> 00:23:23,610
as a relatively a long list of examples

506
00:23:23,610 --> 00:23:27,480
in their papers in the paper including

507
00:23:27,480 --> 00:23:30,870
by the way expatriated Iranians however

508
00:23:30,870 --> 00:23:34,620
they still say shia of attributing

509
00:23:34,620 --> 00:23:36,540
rocket kit in directly to any specific

510
00:23:36,540 --> 00:23:40,500
actor we are still debating internally

511
00:23:40,500 --> 00:23:42,510
how bold we are going to be when we get

512
00:23:42,510 --> 00:23:45,990
to publish our own version of of these

513
00:23:45,990 --> 00:23:50,220
analysis as for persistence they are

514
00:23:50,220 --> 00:23:52,530
usually i mean they're examples mostly

515
00:23:52,530 --> 00:23:56,400
about the persistence in in making sure

516
00:23:56,400 --> 00:23:58,290
that if you have a target on your list

517
00:23:58,290 --> 00:24:01,200
you will get to the target you will keep

518
00:24:01,200 --> 00:24:03,450
on attacking the same target again and

519
00:24:03,450 --> 00:24:06,680
again until it is breached until you get

520
00:24:06,680 --> 00:24:09,450
to the point where it's a infected than

521
00:24:09,450 --> 00:24:10,150
you

522
00:24:10,150 --> 00:24:14,360
exploited well as for advanced you would

523
00:24:14,360 --> 00:24:16,340
see the similar note that we have for

524
00:24:16,340 --> 00:24:20,030
volatile cedar and in once again these

525
00:24:20,030 --> 00:24:24,260
are quotes out of their report and this

526
00:24:24,260 --> 00:24:27,080
part we certainly share simple tools

527
00:24:27,080 --> 00:24:29,870
lack of professionalism not so much into

528
00:24:29,870 --> 00:24:31,910
Quality Assurance not technically

529
00:24:31,910 --> 00:24:34,280
technically sophisticated with deficits

530
00:24:34,280 --> 00:24:36,740
and mistakes not bugs that can be

531
00:24:36,740 --> 00:24:39,590
mistaken for features anything of the

532
00:24:39,590 --> 00:24:42,890
like so this is yet another campaign

533
00:24:42,890 --> 00:24:45,920
that both we believe in terms of who's

534
00:24:45,920 --> 00:24:48,410
behind it as well as in the way it soca

535
00:24:48,410 --> 00:24:51,110
strated and and certainly technically a

536
00:24:51,110 --> 00:24:55,820
managed can be in the same kind of in

537
00:24:55,820 --> 00:24:58,940
the same family of campaign of not so

538
00:24:58,940 --> 00:25:02,200
typical apt is the last one final two

539
00:25:02,200 --> 00:25:10,010
slides is MWI MW is as an apt tool now

540
00:25:10,010 --> 00:25:12,410
if you're familiar with MW I it was

541
00:25:12,410 --> 00:25:17,050
first described in an interesting fire

542
00:25:17,050 --> 00:25:20,840
paper earlier this year they brought it

543
00:25:20,840 --> 00:25:24,560
to light it's it's an microsoft word

544
00:25:24,560 --> 00:25:28,430
intruder that's a full name and it's for

545
00:25:28,430 --> 00:25:30,560
me it's just yet another exploit kit

546
00:25:30,560 --> 00:25:33,800
it's an exploitive but apparently and

547
00:25:33,800 --> 00:25:38,320
the fire guy put it as part of the

548
00:25:38,320 --> 00:25:42,860
report the this tool is advertised as an

549
00:25:42,860 --> 00:25:45,080
apt tool to be used in targeted

550
00:25:45,080 --> 00:25:47,750
campaigns and as usual marketing works

551
00:25:47,750 --> 00:25:50,540
and as you'll see in a minute some guys

552
00:25:50,540 --> 00:25:56,060
did kind of use it they did leverage it

553
00:25:56,060 --> 00:25:59,720
for a very targeted campaign we had an

554
00:25:59,720 --> 00:26:02,540
initial technical analysis of samples

555
00:26:02,540 --> 00:26:05,270
out of these campaigns published earlier

556
00:26:05,270 --> 00:26:10,040
this year and just recently Gabor gave a

557
00:26:10,040 --> 00:26:12,020
very good

558
00:26:12,020 --> 00:26:15,920
description of the tool of the MWI tool

559
00:26:15,920 --> 00:26:21,410
and a few campaigns based on that one

560
00:26:21,410 --> 00:26:23,940
the next slide is my final slide

561
00:26:23,940 --> 00:26:26,580
actually and that's a list of targets

562
00:26:26,580 --> 00:26:30,030
that we've seen in a very in just one of

563
00:26:30,030 --> 00:26:33,210
the campaigns that we were able to to

564
00:26:33,210 --> 00:26:36,690
monitor let's say monitor closely when

565
00:26:36,690 --> 00:26:39,060
you get to take a closer look at all of

566
00:26:39,060 --> 00:26:44,400
the targets being attempted by the

567
00:26:44,400 --> 00:26:46,710
orchestrators no not necessarily all of

568
00:26:46,710 --> 00:26:49,650
these targets were breached so these are

569
00:26:49,650 --> 00:26:51,960
the type of targets that the specific

570
00:26:51,960 --> 00:26:54,960
MWI campaign that our next publication

571
00:26:54,960 --> 00:26:58,380
is going to focus on and there's a very

572
00:26:58,380 --> 00:27:00,750
clear orientation political kind of

573
00:27:00,750 --> 00:27:03,110
government orientation that's not yet a

574
00:27:03,110 --> 00:27:07,530
typical exploited campaign that we used

575
00:27:07,530 --> 00:27:11,430
to and we do I assume that we're going

576
00:27:11,430 --> 00:27:14,220
to be seeing more of these types of

577
00:27:14,220 --> 00:27:16,530
campaigns more of these types of factors

578
00:27:16,530 --> 00:27:19,710
and as you've said Hezbollah is to some

579
00:27:19,710 --> 00:27:23,220
degree backed both financially and

580
00:27:23,220 --> 00:27:28,010
technically by Iran so there's a set of

581
00:27:28,010 --> 00:27:31,920
bodies or organizations and similar one

582
00:27:31,920 --> 00:27:34,350
we believe in other areas of the world

583
00:27:34,350 --> 00:27:38,760
that are going to be Oh castrating

584
00:27:38,760 --> 00:27:41,580
focused campaigns but with very basic

585
00:27:41,580 --> 00:27:45,450
tools thank you for your attention

586
00:27:45,450 --> 00:27:52,099
[Applause]

