1
00:00:06,049 --> 00:00:10,679
okay please take your seats and we are

2
00:00:10,679 --> 00:00:13,740
going to continue with our next session

3
00:00:13,740 --> 00:00:20,310
in the Red Room anonymity is king I

4
00:00:20,310 --> 00:00:23,279
think we are going to dive into the deep

5
00:00:23,279 --> 00:00:25,320
web or something like that i always like

6
00:00:25,320 --> 00:00:29,279
to do that myself anyway so let's see

7
00:00:29,279 --> 00:00:32,520
what Michael John Marcus and Anthony to

8
00:00:32,520 --> 00:00:35,730
mail her a ho is he going to say to you

9
00:00:35,730 --> 00:00:40,710
go ahead please hello ah can you hear me

10
00:00:40,710 --> 00:00:44,719
clearly right so being anonymous

11
00:00:44,719 --> 00:00:47,340
everyone wants to be anonymous at some

12
00:00:47,340 --> 00:00:50,399
point in our lives it is a state where

13
00:00:50,399 --> 00:00:52,289
one can do anything without fear and

14
00:00:52,289 --> 00:00:55,500
doubt a good playwright Oscar Wilde once

15
00:00:55,500 --> 00:00:58,800
said a man its Liz himself when he talks

16
00:00:58,800 --> 00:01:01,410
in his own person but give him a mass

17
00:01:01,410 --> 00:01:04,199
and he will tell you the truth in the

18
00:01:04,199 --> 00:01:07,140
context of cyber crime being anonymous

19
00:01:07,140 --> 00:01:09,090
means being untraceable and that's what

20
00:01:09,090 --> 00:01:11,790
every cybercriminals type for just

21
00:01:11,790 --> 00:01:14,040
imagine what cyber criminals can do when

22
00:01:14,040 --> 00:01:16,259
they know they're protected so good

23
00:01:16,259 --> 00:01:18,500
morning so this presentation is called

24
00:01:18,500 --> 00:01:23,159
anonymity sking so my name is michael

25
00:01:23,159 --> 00:01:25,259
john marcos and with me is my colleague

26
00:01:25,259 --> 00:01:28,290
anthony dome el guerrero over both

27
00:01:28,290 --> 00:01:30,479
threat research engineers from trend

28
00:01:30,479 --> 00:01:33,060
micro and today we're going to talk

29
00:01:33,060 --> 00:01:36,210
about how cybercriminals criminals are

30
00:01:36,210 --> 00:01:38,549
starting to rely on Deep Web to evade

31
00:01:38,549 --> 00:01:42,750
attribution so first let's define what

32
00:01:42,750 --> 00:01:45,479
is deep so deep web is a part of the

33
00:01:45,479 --> 00:01:48,210
internet that is inaccessible to

34
00:01:48,210 --> 00:01:50,159
conventional search engines so this is

35
00:01:50,159 --> 00:01:52,710
the part of the web that is an index and

36
00:01:52,710 --> 00:01:55,140
uses a special kind of technology to be

37
00:01:55,140 --> 00:01:57,960
able to connect its network so what is

38
00:01:57,960 --> 00:02:01,170
this stuff all about surfers I will

39
00:02:01,170 --> 00:02:03,630
discuss what are the reasons on the ship

40
00:02:03,630 --> 00:02:06,049
of cyber criminals to the Deep Web

41
00:02:06,049 --> 00:02:10,258
second is how the cyber criminals use

42
00:02:10,258 --> 00:02:12,560
different deep web technologies

43
00:02:12,560 --> 00:02:16,670
in the cyberking operations number three

44
00:02:16,670 --> 00:02:18,950
is what can we do to investigate a

45
00:02:18,950 --> 00:02:21,560
security professionals so we'll share

46
00:02:21,560 --> 00:02:23,650
some artifacts that we can get from

47
00:02:23,650 --> 00:02:26,650
compromised machines and finally our

48
00:02:26,650 --> 00:02:30,830
conclusion and prediction on how

49
00:02:30,830 --> 00:02:33,550
cybercriminals paces deep in the future

50
00:02:33,550 --> 00:02:38,269
so let's start so how it all began so it

51
00:02:38,269 --> 00:02:42,130
began in this picture so this is a

52
00:02:42,130 --> 00:02:44,810
typical botnet structure so this is a

53
00:02:44,810 --> 00:02:47,569
star topology so in this structure at

54
00:02:47,569 --> 00:02:49,819
the exit central node that acts as a

55
00:02:49,819 --> 00:02:51,799
command and control server of all the

56
00:02:51,799 --> 00:02:55,370
infected machines so in here so given

57
00:02:55,370 --> 00:02:57,739
this set up once we reverse the malware

58
00:02:57,739 --> 00:03:02,630
and we identify the CNC URL we are there

59
00:03:02,630 --> 00:03:05,090
we can have an action to take it down so

60
00:03:05,090 --> 00:03:08,989
given this the whole botnet operation is

61
00:03:08,989 --> 00:03:12,380
disrupted so another example of a botnet

62
00:03:12,380 --> 00:03:14,900
apology is the multi server soham paint

63
00:03:14,900 --> 00:03:17,440
the previous slides there two or more

64
00:03:17,440 --> 00:03:20,450
CNC servers that serve as a fail-safe

65
00:03:20,450 --> 00:03:23,690
servers in case the meaning since the

66
00:03:23,690 --> 00:03:26,630
server has been identified but then

67
00:03:26,630 --> 00:03:28,549
again once you have identified all the

68
00:03:28,549 --> 00:03:32,120
CNC servers it can be taken down as well

69
00:03:32,120 --> 00:03:34,760
so there are other known topologies like

70
00:03:34,760 --> 00:03:37,579
peer-to-peer and hierarchical but this

71
00:03:37,579 --> 00:03:38,900
can be countered by the following

72
00:03:38,900 --> 00:03:41,720
techniques so number one is the usual as

73
00:03:41,720 --> 00:03:44,600
the sink holding the no means or the

74
00:03:44,600 --> 00:03:46,970
malicious domains another is by cleaning

75
00:03:46,970 --> 00:03:50,180
up the compromise sites by the acts as a

76
00:03:50,180 --> 00:03:52,730
C&C server number three is by blocking

77
00:03:52,730 --> 00:03:56,180
the malicious urls by the AV vendors or

78
00:03:56,180 --> 00:03:58,609
the internet service providers number

79
00:03:58,609 --> 00:04:01,280
four is by disconnecting the botnet work

80
00:04:01,280 --> 00:04:04,299
from that enormous systems so given the

81
00:04:04,299 --> 00:04:08,060
risk of using the topologies that I've

82
00:04:08,060 --> 00:04:10,310
discussed over the past couple of years

83
00:04:10,310 --> 00:04:12,950
there's been a several takedowns

84
00:04:12,950 --> 00:04:15,200
happening around the globe so here's

85
00:04:15,200 --> 00:04:17,930
some of the examples so number one is

86
00:04:17,930 --> 00:04:19,789
the takedown of the Trojan which

87
00:04:19,789 --> 00:04:25,010
happened to 2013 another takedown hab is

88
00:04:25,010 --> 00:04:26,220
nothing that not see that

89
00:04:26,220 --> 00:04:27,450
but net so this is somewhat decide

90
00:04:27,450 --> 00:04:30,210
version of botnet of I are modified

91
00:04:30,210 --> 00:04:33,390
version of juice and one of the most

92
00:04:33,390 --> 00:04:35,400
recently big dance is the takedown of

93
00:04:35,400 --> 00:04:40,350
the clip Paula around somewhere so given

94
00:04:40,350 --> 00:04:43,140
the list of takedowns cybercriminals

95
00:04:43,140 --> 00:04:45,780
began their research on how to achieve

96
00:04:45,780 --> 00:04:48,750
true anonymity pervade attribution and

97
00:04:48,750 --> 00:04:51,660
this is what they found technologies

98
00:04:51,660 --> 00:04:53,870
that can potentially make them invisible

99
00:04:53,870 --> 00:04:56,600
so what are the factors that affect

100
00:04:56,600 --> 00:05:01,410
cyber criminals to shift to the deep web

101
00:05:01,410 --> 00:05:05,180
technology so number one Deep Web is

102
00:05:05,180 --> 00:05:08,850
encrypted so they are technically they

103
00:05:08,850 --> 00:05:12,420
are in layer encryption so this is one

104
00:05:12,420 --> 00:05:15,590
example so this is an onion routing

105
00:05:15,590 --> 00:05:20,220
encryption so with this deep encrypts

106
00:05:20,220 --> 00:05:23,100
all of its data into multiple layers

107
00:05:23,100 --> 00:05:26,010
with only the encryption key and the IP

108
00:05:26,010 --> 00:05:28,560
address known at each shop so given this

109
00:05:28,560 --> 00:05:35,160
the malicious traffic and legitimate

110
00:05:35,160 --> 00:05:37,380
traffic is difficult to distinguish as

111
00:05:37,380 --> 00:05:40,260
well as tracing the original source and

112
00:05:40,260 --> 00:05:44,540
the final destination so another

113
00:05:44,540 --> 00:05:47,400
advantage is that Deep Web offers

114
00:05:47,400 --> 00:05:50,160
deception so it's possible for a user or

115
00:05:50,160 --> 00:05:52,229
a cybercriminal to create an infinite

116
00:05:52,229 --> 00:05:55,590
number of domains provided it can be

117
00:05:55,590 --> 00:06:00,710
supported by you can be supported by the

118
00:06:00,710 --> 00:06:03,540
by the server payload or the bandwidth

119
00:06:03,540 --> 00:06:06,990
so given this in a security perspective

120
00:06:06,990 --> 00:06:09,960
it creates an illusion for the

121
00:06:09,960 --> 00:06:11,640
cybercriminal in appearing as a larger

122
00:06:11,640 --> 00:06:13,979
botnet break when in fact is just using

123
00:06:13,979 --> 00:06:18,229
2 or 3 C&C servers for the operations

124
00:06:18,229 --> 00:06:20,790
all right also presents additional work

125
00:06:20,790 --> 00:06:23,750
for us in the EV industry because in

126
00:06:23,750 --> 00:06:27,470
blocking this malicious urls so n a

127
00:06:27,470 --> 00:06:29,790
third advantage that we found is that

128
00:06:29,790 --> 00:06:32,130
Deep Web offers Sicilians in high

129
00:06:32,130 --> 00:06:36,180
availability so deep web domains can be

130
00:06:36,180 --> 00:06:38,070
generated in the system and it's

131
00:06:38,070 --> 00:06:41,400
reusable so unlike the usual domain

132
00:06:41,400 --> 00:06:45,090
names deep web domains and unregulated

133
00:06:45,090 --> 00:06:48,780
and cyber criminals have the Liberty to

134
00:06:48,780 --> 00:06:51,990
control them so setting up failsafe

135
00:06:51,990 --> 00:06:55,259
servers in case of power outages such as

136
00:06:55,259 --> 00:06:57,930
this one and migrating CNC servers from

137
00:06:57,930 --> 00:06:59,699
one location to another can be easily

138
00:06:59,699 --> 00:07:02,759
done through with Deep Web so now that

139
00:07:02,759 --> 00:07:06,479
we know the advantages so I'll turn you

140
00:07:06,479 --> 00:07:09,120
over to angio to discuss further the

141
00:07:09,120 --> 00:07:11,759
different deep web technologies and how

142
00:07:11,759 --> 00:07:15,539
cybercriminals use them alright so thank

143
00:07:15,539 --> 00:07:17,970
you Michael so first I'm can I discuss

144
00:07:17,970 --> 00:07:20,250
you the different deeper technologies

145
00:07:20,250 --> 00:07:22,440
all I know that most of you are familiar

146
00:07:22,440 --> 00:07:23,910
with this so this was just beer

147
00:07:23,910 --> 00:07:27,330
refresher and after it technology i'm

148
00:07:27,330 --> 00:07:29,220
gonna give an example of a modern that

149
00:07:29,220 --> 00:07:31,949
uses that dip technology so first we'll

150
00:07:31,949 --> 00:07:37,630
be a bar so or The Onion Router so

151
00:07:37,630 --> 00:07:42,220
sorry King before using a ballroom it

152
00:07:42,220 --> 00:07:44,710
must need it must be first installed in

153
00:07:44,710 --> 00:07:46,690
the system the tor browser that our

154
00:07:46,690 --> 00:07:49,960
client then to anonymously contact a

155
00:07:49,960 --> 00:07:52,470
remote server it will first need to

156
00:07:52,470 --> 00:07:55,510
contact the directory server will wear

157
00:07:55,510 --> 00:07:57,400
it will obtain the list of available

158
00:07:57,400 --> 00:07:59,950
tour nodes so this store nodes is where

159
00:07:59,950 --> 00:08:03,250
the tour client will relay the data and

160
00:08:03,250 --> 00:08:07,300
a niche hub the data is decrypted with

161
00:08:07,300 --> 00:08:09,220
different keys just like peeling the

162
00:08:09,220 --> 00:08:12,640
layers of an onion so from the last node

163
00:08:12,640 --> 00:08:15,280
the data will be unencrypted with the

164
00:08:15,280 --> 00:08:19,030
qatari encryption so also we all know

165
00:08:19,030 --> 00:08:21,360
that tour offers hidden services or

166
00:08:21,360 --> 00:08:24,520
anonymous web servers so for a hidden

167
00:08:24,520 --> 00:08:27,280
servers hidden service to be registered

168
00:08:27,280 --> 00:08:30,130
to the tour database it will first need

169
00:08:30,130 --> 00:08:33,070
to select randomly to select three

170
00:08:33,070 --> 00:08:35,110
introductory points from the available

171
00:08:35,110 --> 00:08:39,220
power nodes then send this info together

172
00:08:39,220 --> 00:08:41,320
with his public key the public key will

173
00:08:41,320 --> 00:08:44,290
be used for its onion URL so it's a

174
00:08:44,290 --> 00:08:47,440
distributed hash table the tour client

175
00:08:47,440 --> 00:08:50,890
or the user given that he he knows the

176
00:08:50,890 --> 00:08:53,380
public key of the hidden service he will

177
00:08:53,380 --> 00:08:57,340
then look up the pop are the public key

178
00:08:57,340 --> 00:08:59,830
and get the introductory points

179
00:08:59,830 --> 00:09:03,190
so before contacting the hidden service

180
00:09:03,190 --> 00:09:05,230
the Torak the tour client will first

181
00:09:05,230 --> 00:09:08,380
select a randomly select a rendezvous

182
00:09:08,380 --> 00:09:10,750
point and sent to the hidden service

183
00:09:10,750 --> 00:09:13,180
through one of the introductory points

184
00:09:13,180 --> 00:09:16,000
the a one-time secret which is the

185
00:09:16,000 --> 00:09:17,950
cookie in the diagram and the run double

186
00:09:17,950 --> 00:09:19,920
point so once the hidden service

187
00:09:19,920 --> 00:09:22,810
receives that info the hidden service

188
00:09:22,810 --> 00:09:25,180
will then send the one-time secret to

189
00:09:25,180 --> 00:09:27,520
the rentable point and then the

190
00:09:27,520 --> 00:09:29,110
rendezvous point will authenticate this

191
00:09:29,110 --> 00:09:31,480
one time secret once it is authenticated

192
00:09:31,480 --> 00:09:33,400
the tour client and the hidden service

193
00:09:33,400 --> 00:09:35,740
can anonymously communicate with each

194
00:09:35,740 --> 00:09:40,090
other so in january of last year we

195
00:09:40,090 --> 00:09:42,610
encountered a new version of Zeus which

196
00:09:42,610 --> 00:09:46,510
is skins so during static analysis of

197
00:09:46,510 --> 00:09:49,180
Keane's we have found that there are two

198
00:09:49,180 --> 00:09:51,130
other executables and bread

199
00:09:51,130 --> 00:09:54,520
so the other two is the at 64 bit

200
00:09:54,520 --> 00:09:57,070
version and the other one is it story

201
00:09:57,070 --> 00:10:00,940
executable so during the installation

202
00:10:00,940 --> 00:10:04,060
and execution of genes it will first

203
00:10:04,060 --> 00:10:07,300
inject itself to explore that XA so

204
00:10:07,300 --> 00:10:10,270
after the injection it will download its

205
00:10:10,270 --> 00:10:12,610
config file from a from a C&C server

206
00:10:12,610 --> 00:10:15,940
located in the Tor network then it will

207
00:10:15,940 --> 00:10:17,830
launch the power executable which is

208
00:10:17,830 --> 00:10:21,730
just embedded in it using a using a

209
00:10:21,730 --> 00:10:23,940
method called process Halloween to

210
00:10:23,940 --> 00:10:27,690
svchost at XA so based on the parameters

211
00:10:27,690 --> 00:10:30,730
during the execution of svchost you can

212
00:10:30,730 --> 00:10:33,490
see that it cleans wants to launch a tor

213
00:10:33,490 --> 00:10:36,730
hidden service so the hidden service

214
00:10:36,730 --> 00:10:38,920
dear parameter just specifies where the

215
00:10:38,920 --> 00:10:40,270
torque configuration files will be

216
00:10:40,270 --> 00:10:42,730
dropped then the hidden service port

217
00:10:42,730 --> 00:10:45,730
contains the virtual port which are 1080

218
00:10:45,730 --> 00:10:49,540
and 5900 in this example which are the

219
00:10:49,540 --> 00:10:51,700
virtual parts will be the ports that the

220
00:10:51,700 --> 00:10:53,620
users connecting to the heat and service

221
00:10:53,620 --> 00:10:56,020
think they are connecting to but in n

222
00:10:56,020 --> 00:10:58,090
reality the communications are

223
00:10:58,090 --> 00:11:00,100
redirected to the redirection parts

224
00:11:00,100 --> 00:11:05,490
which are 233 18 and 26 824 so Torvill

225
00:11:05,490 --> 00:11:07,930
it will drop the configuration file to

226
00:11:07,930 --> 00:11:11,320
the to the system now the kick now keen

227
00:11:11,320 --> 00:11:13,420
scan please send to the resurrection

228
00:11:13,420 --> 00:11:17,260
port so this behavior can now open the

229
00:11:17,260 --> 00:11:19,120
system to further attacks like butter

230
00:11:19,120 --> 00:11:22,450
but like butter connections so before we

231
00:11:22,450 --> 00:11:26,080
proceed to the next deep web technology

232
00:11:26,080 --> 00:11:28,900
lets just take note that tour requires

233
00:11:28,900 --> 00:11:32,710
it requires the installation of the tor

234
00:11:32,710 --> 00:11:34,990
browser the tour client so proceedings

235
00:11:34,990 --> 00:11:38,380
with tour to web tour to web allows the

236
00:11:38,380 --> 00:11:40,720
users to access a tor hidden service

237
00:11:40,720 --> 00:11:44,370
without installing the tor browser so

238
00:11:44,370 --> 00:11:47,980
just to to you start web so in this

239
00:11:47,980 --> 00:11:50,380
example we have the onion URL with the

240
00:11:50,380 --> 00:11:53,950
onion TLD and just uh we will just

241
00:11:53,950 --> 00:11:55,690
replace the data onion with following

242
00:11:55,690 --> 00:11:58,450
samples which are 32 web org or entity

243
00:11:58,450 --> 00:12:00,880
oh so on and so forth so this story to

244
00:12:00,880 --> 00:12:03,459
web gateways are many and there

245
00:12:03,459 --> 00:12:06,369
are maintained by volunteering

246
00:12:06,369 --> 00:12:08,679
organizations and individuals so an

247
00:12:08,679 --> 00:12:11,740
example of a malware that uses stored

248
00:12:11,740 --> 00:12:15,730
web is CTB locker or cpb so CTB

249
00:12:15,730 --> 00:12:20,199
stands for curve or the elliptic curve

250
00:12:20,199 --> 00:12:22,059
defeat alderman encryption algorithm

251
00:12:22,059 --> 00:12:24,749
since ctp diaper is around somewhere and

252
00:12:24,749 --> 00:12:30,189
next T is stands for poor or since it

253
00:12:30,189 --> 00:12:33,490
uses for an orator to web with acid C&C

254
00:12:33,490 --> 00:12:37,119
server and its famous site then B stands

255
00:12:37,119 --> 00:12:38,679
for Bitcoin since it is the preferred

256
00:12:38,679 --> 00:12:42,309
mode of payment for the ransom so one

257
00:12:42,309 --> 00:12:45,129
CTB locker is installed and executed in

258
00:12:45,129 --> 00:12:49,230
the system it will inject yourself to

259
00:12:49,230 --> 00:12:52,720
exploit at Exane SVC of that XA and then

260
00:12:52,720 --> 00:12:54,639
it will proceed with its file encryption

261
00:12:54,639 --> 00:12:57,429
routine so after encrypting the targeted

262
00:12:57,429 --> 00:13:00,429
files it will send the encryption key

263
00:13:00,429 --> 00:13:03,459
that it used to the CNC server who sent

264
00:13:03,459 --> 00:13:07,029
in power via the tour to web network so

265
00:13:07,029 --> 00:13:10,779
then it will display the ransom note the

266
00:13:10,779 --> 00:13:13,329
ransom note will display info like the

267
00:13:13,329 --> 00:13:15,699
public key which is the like the

268
00:13:15,699 --> 00:13:17,889
identifier of the victim the Bitcoin

269
00:13:17,889 --> 00:13:21,129
address where the deer and some can be

270
00:13:21,129 --> 00:13:23,170
sent to and the payment site where you

271
00:13:23,170 --> 00:13:27,490
can make the transaction so once the

272
00:13:27,490 --> 00:13:31,660
user visits the payment side he will be

273
00:13:31,660 --> 00:13:33,369
displayed with this page so it will

274
00:13:33,369 --> 00:13:36,160
require him or her to enter the public

275
00:13:36,160 --> 00:13:38,709
key which is in the ransom note then

276
00:13:38,709 --> 00:13:41,259
once it is entered he will be redirected

277
00:13:41,259 --> 00:13:44,019
to the actual payment side where it just

278
00:13:44,019 --> 00:13:45,490
contains more information on how to

279
00:13:45,490 --> 00:13:50,040
acquire bitcoins and how to how to

280
00:13:50,040 --> 00:13:52,569
finish the transaction so at the bottom

281
00:13:52,569 --> 00:13:55,240
of the page you will just see that it

282
00:13:55,240 --> 00:13:57,399
offers also free decryption service just

283
00:13:57,399 --> 00:13:59,699
to prove that it can really decrypt the

284
00:13:59,699 --> 00:14:03,999
you're equipped add files so sometimes

285
00:14:03,999 --> 00:14:07,329
port web gateway administrators BLAP

286
00:14:07,329 --> 00:14:10,360
access to this malicious urls so CTB

287
00:14:10,360 --> 00:14:13,350
Locker has a counter a tap for this uh

288
00:14:13,350 --> 00:14:17,170
that in the next slide you can see that

289
00:14:17,170 --> 00:14:20,290
has a law it as a list of other tort web

290
00:14:20,290 --> 00:14:24,100
gateways that it can use so what are the

291
00:14:24,100 --> 00:14:26,649
advantages of using tor tulip so first

292
00:14:26,649 --> 00:14:28,389
advantage is it doesn't require the

293
00:14:28,389 --> 00:14:30,550
installation of the tor browser so

294
00:14:30,550 --> 00:14:33,279
security policies like flatten the

295
00:14:33,279 --> 00:14:35,139
installation of tour will be bypassed

296
00:14:35,139 --> 00:14:38,260
and the inbound and outbound network

297
00:14:38,260 --> 00:14:41,070
traffic to and from the tour to mp3 is

298
00:14:41,070 --> 00:14:45,880
as is normal so I PS rules will not be

299
00:14:45,880 --> 00:14:47,740
able to detect for a malicious slower

300
00:14:47,740 --> 00:14:50,350
traffic and of course there are multiple

301
00:14:50,350 --> 00:14:53,260
tort or gateways available so while we

302
00:14:53,260 --> 00:14:56,740
can just use a snake n okay so

303
00:14:56,740 --> 00:15:01,510
proceeding to I to pee so I to P is work

304
00:15:01,510 --> 00:15:04,480
similarly like poor but it is somehow

305
00:15:04,480 --> 00:15:08,620
more complex so if a if let's say a

306
00:15:08,620 --> 00:15:12,250
client and a web server another thing I

307
00:15:12,250 --> 00:15:14,920
PP requires the communications within

308
00:15:14,920 --> 00:15:17,199
the IP IP network so if let's say a

309
00:15:17,199 --> 00:15:18,699
client in the web server wants to join

310
00:15:18,699 --> 00:15:20,589
the IP IP network they must also install

311
00:15:20,589 --> 00:15:23,649
first the ITP router and then once

312
00:15:23,649 --> 00:15:26,529
installed the routers will select

313
00:15:26,529 --> 00:15:31,050
randomly from the network database a

314
00:15:31,589 --> 00:15:34,149
some other routers which they will use

315
00:15:34,149 --> 00:15:37,390
those tunnels so let's say the client

316
00:15:37,390 --> 00:15:40,180
the client wants to send an HTTP request

317
00:15:40,180 --> 00:15:42,990
to the web server the client router will

318
00:15:42,990 --> 00:15:46,899
bundle the HTTP request with other

319
00:15:46,899 --> 00:15:49,720
messages so this will be like the globes

320
00:15:49,720 --> 00:15:52,540
of a garlic that's why I TPS called

321
00:15:52,540 --> 00:15:55,120
garlic routing I supposed to The Onion

322
00:15:55,120 --> 00:15:57,820
Routing so and then it will send it to

323
00:15:57,820 --> 00:16:00,459
the server router via those tunnels and

324
00:16:00,459 --> 00:16:04,630
take note that along the way the data is

325
00:16:04,630 --> 00:16:07,329
also decrypted and then the server

326
00:16:07,329 --> 00:16:10,000
router will do will just separate the

327
00:16:10,000 --> 00:16:12,550
bundles of the other globes of the

328
00:16:12,550 --> 00:16:14,410
garlic message and send them to their

329
00:16:14,410 --> 00:16:18,550
actual destinations so the an example of

330
00:16:18,550 --> 00:16:20,740
the malware that uses ITP is diarrhea

331
00:16:20,740 --> 00:16:24,959
just as a discussed earlier so since

332
00:16:24,959 --> 00:16:28,449
since the Zeus takedown by Ray came up

333
00:16:28,449 --> 00:16:29,790
to the spotlight as

334
00:16:29,790 --> 00:16:33,510
the new online banking Trojan so it also

335
00:16:33,510 --> 00:16:36,600
performs web injects to steal online

336
00:16:36,600 --> 00:16:39,620
banking credentials by injecting

337
00:16:39,620 --> 00:16:41,910
malicious scripts to the following web

338
00:16:41,910 --> 00:16:45,600
browsers which is firefox chrome IE so

339
00:16:45,600 --> 00:16:48,510
it's other capabilities is it can send

340
00:16:48,510 --> 00:16:51,710
the net status of the system send some

341
00:16:51,710 --> 00:16:55,110
general system information the end

342
00:16:55,110 --> 00:16:57,570
download other modules like the itt

343
00:16:57,570 --> 00:17:00,210
module and the VNC module which can also

344
00:17:00,210 --> 00:17:03,210
open up the system for other butler

345
00:17:03,210 --> 00:17:05,430
connections it can also download this

346
00:17:05,430 --> 00:17:08,339
configuration file and send a browser

347
00:17:08,339 --> 00:17:11,810
snapshot so this capabilities happen I

348
00:17:11,810 --> 00:17:14,700
like the sending end up uploading and

349
00:17:14,700 --> 00:17:17,220
the downloading of the files will happen

350
00:17:17,220 --> 00:17:19,829
by the ITP as shown in the screenshot

351
00:17:19,829 --> 00:17:23,579
but since the threat actors are aware of

352
00:17:23,579 --> 00:17:26,760
the complexity of use of IPP they have a

353
00:17:26,760 --> 00:17:29,000
fail-safe or a back-up plan so they also

354
00:17:29,000 --> 00:17:32,550
use dorman generation algorithm okay so

355
00:17:32,550 --> 00:17:35,940
for the more use cases of Deep Web

356
00:17:35,940 --> 00:17:37,800
malware I'm gonna turn you over again to

357
00:17:37,800 --> 00:17:42,660
Michael right thank you ok so I'll

358
00:17:42,660 --> 00:17:45,200
discuss the use cases that we found for

359
00:17:45,200 --> 00:17:49,170
Deep Web by cybercriminals to help their

360
00:17:49,170 --> 00:17:52,410
cyber crime operation so number one they

361
00:17:52,410 --> 00:17:54,420
use Deep Web as a ransom air support for

362
00:17:54,420 --> 00:17:57,540
time so an example of a Mallory that

363
00:17:57,540 --> 00:17:59,220
uses this is script volt so it's acting

364
00:17:59,220 --> 00:18:02,910
program somewhere so sorrento made the

365
00:18:02,910 --> 00:18:05,310
targets russia and its neighboring

366
00:18:05,310 --> 00:18:09,030
countries so this malware communicates

367
00:18:09,030 --> 00:18:12,090
with its victim via a Support Portal

368
00:18:12,090 --> 00:18:15,860
hosted in it or or an onion domain so

369
00:18:15,860 --> 00:18:20,100
after the encryption of user files this

370
00:18:20,100 --> 00:18:25,560
malware drops a ransom note and as shown

371
00:18:25,560 --> 00:18:29,150
here so it's written in Russian so

372
00:18:29,150 --> 00:18:32,970
included in the in the ransom note is

373
00:18:32,970 --> 00:18:36,030
the support portal URL and the key file

374
00:18:36,030 --> 00:18:38,670
so the key file is also generated once

375
00:18:38,670 --> 00:18:41,320
the malware is executed in this

376
00:18:41,320 --> 00:18:44,710
them so it also includes instruction on

377
00:18:44,710 --> 00:18:47,559
how to access or get to the support port

378
00:18:47,559 --> 00:18:52,120
and so on this one it said that it

379
00:18:52,120 --> 00:18:55,299
requires the user to get at our tour web

380
00:18:55,299 --> 00:18:57,429
browser to be able to connect to the

381
00:18:57,429 --> 00:18:59,500
support portal URL so once inside the

382
00:18:59,500 --> 00:19:03,490
support portal you are in the the mild

383
00:19:03,490 --> 00:19:06,490
we will request the victim to upload the

384
00:19:06,490 --> 00:19:10,389
key file so so this will give the victim

385
00:19:10,389 --> 00:19:13,509
an account to the support portal so once

386
00:19:13,509 --> 00:19:16,120
inside the so as you can see the support

387
00:19:16,120 --> 00:19:20,379
portal URL is in here so went inside the

388
00:19:20,379 --> 00:19:22,389
cybercriminals will entertain the victim

389
00:19:22,389 --> 00:19:25,240
via chat support so as you can see it is

390
00:19:25,240 --> 00:19:27,909
it is considered as one of the advanced

391
00:19:27,909 --> 00:19:31,690
or we can see on this picture that they

392
00:19:31,690 --> 00:19:34,110
are a large enter face because they have

393
00:19:34,110 --> 00:19:38,649
a working chat support so very uncommon

394
00:19:38,649 --> 00:19:41,620
so next is as command and control server

395
00:19:41,620 --> 00:19:43,509
so this is a one of the common uses of

396
00:19:43,509 --> 00:19:47,259
Deep Web by cybercriminals so in this

397
00:19:47,259 --> 00:19:50,200
particular example this is a slam post

398
00:19:50,200 --> 00:19:52,659
lamp OS and Android back door malware so

399
00:19:52,659 --> 00:19:55,620
this malware is a true genus or a

400
00:19:55,620 --> 00:19:58,600
modified version of our bot so for those

401
00:19:58,600 --> 00:20:01,600
of you who don't know our bot so orbit

402
00:20:01,600 --> 00:20:04,659
is a created for an application created

403
00:20:04,659 --> 00:20:06,279
for android phones to be able to connect

404
00:20:06,279 --> 00:20:10,149
to the Tor network so decompiling the

405
00:20:10,149 --> 00:20:14,940
APK file of slambaux we can see that

406
00:20:14,940 --> 00:20:18,970
some of its capabilities so the backdoor

407
00:20:18,970 --> 00:20:21,070
comment works like this so the

408
00:20:21,070 --> 00:20:22,629
cybercriminal will text the infected

409
00:20:22,629 --> 00:20:25,029
phone for for the bakken recommends a

410
00:20:25,029 --> 00:20:27,519
trigger so one of the common

411
00:20:27,519 --> 00:20:30,009
capabilities is the interception and

412
00:20:30,009 --> 00:20:33,159
monitoring of the text messages the

413
00:20:33,159 --> 00:20:35,080
sending of the infected phone's location

414
00:20:35,080 --> 00:20:40,090
in the sending of system info so looking

415
00:20:40,090 --> 00:20:41,980
at the network related script so we can

416
00:20:41,980 --> 00:20:45,759
see that once the phone is infected it

417
00:20:45,759 --> 00:20:49,029
will send the the stolen formations show

418
00:20:49,029 --> 00:20:52,269
near to the to this website so this is

419
00:20:52,269 --> 00:20:52,580
the

420
00:20:52,580 --> 00:20:57,169
part where the malware perform a

421
00:20:57,169 --> 00:20:59,840
fallback communication to the threat

422
00:20:59,840 --> 00:21:03,559
actor so another use case that we fun is

423
00:21:03,559 --> 00:21:09,649
hosting server for malware so we've seen

424
00:21:09,649 --> 00:21:13,070
a malware family named janitor so just

425
00:21:13,070 --> 00:21:16,490
in the first quarter of 2015 so this is

426
00:21:16,490 --> 00:21:19,159
a downloadable way so it arrives in the

427
00:21:19,159 --> 00:21:22,299
system by a spamming so once it's

428
00:21:22,299 --> 00:21:25,970
executed it tries to download vortrag

429
00:21:25,970 --> 00:21:30,320
you buy a toy to mu l so as discussed by

430
00:21:30,320 --> 00:21:32,960
anthony awhile ago but web urls are

431
00:21:32,960 --> 00:21:35,090
regulated by the differ by a different

432
00:21:35,090 --> 00:21:39,799
entity so the blocking of the URLs is I

433
00:21:39,799 --> 00:21:43,610
so that's why the the threat actors up

434
00:21:43,610 --> 00:21:47,360
to use multiple portable else as backup

435
00:21:47,360 --> 00:21:49,700
so given the use case and the

436
00:21:49,700 --> 00:21:52,190
implementation of cyber criminals so

437
00:21:52,190 --> 00:21:53,840
what can we do to investigate so when

438
00:21:53,840 --> 00:21:56,389
responding to a case and we see that

439
00:21:56,389 --> 00:21:59,600
there is suspicious deep web activity so

440
00:21:59,600 --> 00:22:02,899
good places to look into or the first

441
00:22:02,899 --> 00:22:04,250
priority to look into would be the

442
00:22:04,250 --> 00:22:07,669
following so number one is the command

443
00:22:07,669 --> 00:22:10,220
line arguments log so next is the

444
00:22:10,220 --> 00:22:13,250
install files and folder third is the

445
00:22:13,250 --> 00:22:15,080
prefetch files and for it is the network

446
00:22:15,080 --> 00:22:17,990
traffic so for my delayed argument so

447
00:22:17,990 --> 00:22:20,659
line arguments can give you an idea how

448
00:22:20,659 --> 00:22:23,840
the malware use deep in the system so

449
00:22:23,840 --> 00:22:26,860
for this one this is taken from

450
00:22:26,860 --> 00:22:30,380
compromised machine that is infected by

451
00:22:30,380 --> 00:22:33,980
C but the Kings version so as you can

452
00:22:33,980 --> 00:22:38,840
see we can flag three things here so

453
00:22:38,840 --> 00:22:41,539
number one base and the argument hidden

454
00:22:41,539 --> 00:22:43,789
service dear hidden service port you can

455
00:22:43,789 --> 00:22:47,470
identify this that this is a tour

456
00:22:47,470 --> 00:22:50,389
setting up a hidden service number two

457
00:22:50,389 --> 00:22:54,260
we can identify that as data executable

458
00:22:54,260 --> 00:22:58,760
was a name to SVC us that XA and recited

459
00:22:58,760 --> 00:23:03,610
in the in the system folder

460
00:23:03,820 --> 00:23:07,840
third after the hidden service do we can

461
00:23:07,840 --> 00:23:11,020
see the file path so this so this can be

462
00:23:11,020 --> 00:23:12,910
a file part of interest to be further

463
00:23:12,910 --> 00:23:20,820
analyzed okay so Allah I sorry sorry

464
00:23:20,820 --> 00:23:24,760
sorry so next is the installed files and

465
00:23:24,760 --> 00:23:29,770
folder so poor and I to P is usually

466
00:23:29,770 --> 00:23:32,230
downloaded or bundled with bite by the

467
00:23:32,230 --> 00:23:36,790
malware so it for it to work it need to

468
00:23:36,790 --> 00:23:39,250
recite in the system so first we need to

469
00:23:39,250 --> 00:23:43,450
identify which location it resides and

470
00:23:43,450 --> 00:23:47,020
then once we identify that we can get

471
00:23:47,020 --> 00:23:50,050
several information like by checking the

472
00:23:50,050 --> 00:23:52,090
timestamps you can get an idea when was

473
00:23:52,090 --> 00:23:54,550
it installed when was it last use and

474
00:23:54,550 --> 00:23:58,090
other information like if generated deep

475
00:23:58,090 --> 00:24:01,330
web domain was if there is a deep domain

476
00:24:01,330 --> 00:24:05,260
generated in the system so this is one

477
00:24:05,260 --> 00:24:07,720
example so in the state file we can see

478
00:24:07,720 --> 00:24:12,460
the version and when was / last used by

479
00:24:12,460 --> 00:24:16,390
the system so now that we know the that

480
00:24:16,390 --> 00:24:20,410
the third executable from from the

481
00:24:20,410 --> 00:24:23,620
command line argument log is SVC OS so

482
00:24:23,620 --> 00:24:26,230
we try to parse the prefetch file of SVC

483
00:24:26,230 --> 00:24:30,790
OS so parsing the prefetch file of SB

484
00:24:30,790 --> 00:24:32,950
cos we can see that there are several

485
00:24:32,950 --> 00:24:34,420
information that we can get from this

486
00:24:34,420 --> 00:24:37,720
number one is a the libraries that were

487
00:24:37,720 --> 00:24:39,490
loaded by the process of that are

488
00:24:39,490 --> 00:24:43,000
executable number two when how how many

489
00:24:43,000 --> 00:24:44,980
times we passed ran in the system and

490
00:24:44,980 --> 00:24:47,770
number three is the timestamps again so

491
00:24:47,770 --> 00:24:50,950
the installation and when was it last

492
00:24:50,950 --> 00:24:54,780
use so cross-referencing the x terms of

493
00:24:54,780 --> 00:24:58,210
the install files and folder of deep web

494
00:24:58,210 --> 00:25:01,120
related files plus the disparate friends

495
00:25:01,120 --> 00:25:04,810
can give you a an idea or can add

496
00:25:04,810 --> 00:25:06,730
credibility if you're making an incident

497
00:25:06,730 --> 00:25:09,760
response report so last is a network

498
00:25:09,760 --> 00:25:11,860
traffic plugs so for a network traffic

499
00:25:11,860 --> 00:25:13,070
blogs

500
00:25:13,070 --> 00:25:18,470
just have to look to it too because I 2p

501
00:25:18,470 --> 00:25:22,039
entire have unique network patterns so

502
00:25:22,039 --> 00:25:27,820
we have to look for that patterns using

503
00:25:27,820 --> 00:25:32,840
search tools hey so so what do you think

504
00:25:32,840 --> 00:25:36,009
will be the next step of cybercriminals

505
00:25:36,009 --> 00:25:39,350
so we think that cybercriminals will

506
00:25:39,350 --> 00:25:42,889
continue to you sleep babe so given the

507
00:25:42,889 --> 00:25:45,110
advantages it presents of the plea

508
00:25:45,110 --> 00:25:46,879
discuss awhile ago to still be

509
00:25:46,879 --> 00:25:48,500
considered as one of the effective ways

510
00:25:48,500 --> 00:25:51,559
to evade attribution so I shown in the

511
00:25:51,559 --> 00:25:54,169
next slide so over the past couple of

512
00:25:54,169 --> 00:25:55,879
years there's been a steady is in the

513
00:25:55,879 --> 00:25:58,909
number of mild waves using a big bang

514
00:25:58,909 --> 00:26:02,149
technology so interestingly the moment

515
00:26:02,149 --> 00:26:04,070
we submit the paper in this conference

516
00:26:04,070 --> 00:26:07,629
up to today six new around somewheres

517
00:26:07,629 --> 00:26:10,940
are using the deep web technology so

518
00:26:10,940 --> 00:26:16,570
where are we heading so given the this

519
00:26:16,570 --> 00:26:19,129
increase in the number of malware

520
00:26:19,129 --> 00:26:21,679
families using Deep Web so we believe

521
00:26:21,679 --> 00:26:24,379
that we're we're heading to the early

522
00:26:24,379 --> 00:26:26,389
majority phase of the innovation

523
00:26:26,389 --> 00:26:27,740
adoption cycle of the deep web

524
00:26:27,740 --> 00:26:31,269
technology so given this our point is

525
00:26:31,269 --> 00:26:33,830
more cyber criminals will be attracted

526
00:26:33,830 --> 00:26:36,590
to Deep Web in the coming years so what

527
00:26:36,590 --> 00:26:40,789
do we need to do so we need to be one

528
00:26:40,789 --> 00:26:43,340
step ahead again cyber criminals so

529
00:26:43,340 --> 00:26:45,320
planning and testing attack scenarios

530
00:26:45,320 --> 00:26:49,220
involving deep malware will help us

531
00:26:49,220 --> 00:26:55,399
understand how how they do things so we

532
00:26:55,399 --> 00:26:58,669
also predict that down the arrival

533
00:26:58,669 --> 00:27:01,429
vectors of the Tauri executable rie to

534
00:27:01,429 --> 00:27:05,289
be acceptable is only embedded and

535
00:27:05,289 --> 00:27:08,149
download that so we believe that soon

536
00:27:08,149 --> 00:27:13,580
after it will be fine less so so the

537
00:27:13,580 --> 00:27:17,210
power of anonymity can always give cyber

538
00:27:17,210 --> 00:27:19,580
criminals and upper hand so it's up to

539
00:27:19,580 --> 00:27:23,179
us whether we profitably upon it so that

540
00:27:23,179 --> 00:27:27,490
concludes our presentation so thank you

541
00:27:31,390 --> 00:27:35,659
nice presentation we have time for one

542
00:27:35,659 --> 00:27:43,250
or two questions I think so any

543
00:27:43,250 --> 00:27:47,059
questions thank you total crepe paper

544
00:27:47,059 --> 00:27:51,320
say sorry bit love so the question is

545
00:27:51,320 --> 00:27:54,590
that the for corporate there's no use

546
00:27:54,590 --> 00:27:57,440
for Deep Web what will the malabar do if

547
00:27:57,440 --> 00:28:00,770
I have blocked access to onion an ITP

548
00:28:00,770 --> 00:28:03,620
will it still encrypt files and will it

549
00:28:03,620 --> 00:28:05,029
mean that there's no way to recover

550
00:28:05,029 --> 00:28:13,370
those files well if the yeah of course

551
00:28:13,370 --> 00:28:15,950
if you will black access to these sorts

552
00:28:15,950 --> 00:28:18,320
of web and sore yeah I think it will be

553
00:28:18,320 --> 00:28:21,559
really effective countermeasure but

554
00:28:21,559 --> 00:28:23,510
we're not sure if if there will be

555
00:28:23,510 --> 00:28:26,149
ensured they exploit for for that kind

556
00:28:26,149 --> 00:28:34,240
of countermeasure thank you so any other

557
00:28:34,240 --> 00:28:38,110
question in the back I think

558
00:28:47,010 --> 00:28:51,840
no questions anymore okay let's think

559
00:28:51,840 --> 00:28:54,830
together Michael and Anthony

560
00:28:54,830 --> 00:28:59,089
[Applause]

