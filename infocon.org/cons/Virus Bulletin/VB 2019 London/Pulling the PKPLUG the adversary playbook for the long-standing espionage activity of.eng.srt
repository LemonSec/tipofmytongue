1
00:00:00,030 --> 00:00:01,589
good afternoon everyone and thank you

2
00:00:01,589 --> 00:00:04,230
for attending this session it's a bit of

3
00:00:04,230 --> 00:00:05,910
a mouthful of a title but hopefully over

4
00:00:05,910 --> 00:00:06,960
the next few slides you'll get a better

5
00:00:06,960 --> 00:00:08,340
idea of what I'm actually going to talk

6
00:00:08,340 --> 00:00:09,870
about and hopefully this will be

7
00:00:09,870 --> 00:00:12,059
interesting for you and so it's a

8
00:00:12,059 --> 00:00:13,880
pleasure to be back here after 12 years

9
00:00:13,880 --> 00:00:16,590
it sounds like a very long time and I've

10
00:00:16,590 --> 00:00:18,090
been wracking my brains to figure out

11
00:00:18,090 --> 00:00:19,710
what I've been doing for those 12 years

12
00:00:19,710 --> 00:00:21,359
and where I've been and who I've seen

13
00:00:21,359 --> 00:00:23,039
and everything else but yeah it's been

14
00:00:23,039 --> 00:00:26,220
12 years and just to set the record

15
00:00:26,220 --> 00:00:27,869
straight Virus Bulletin hasn't been

16
00:00:27,869 --> 00:00:30,390
rejecting me for like 12 years since I

17
00:00:30,390 --> 00:00:33,570
presented in in Vienna 2007 but I've

18
00:00:33,570 --> 00:00:35,280
just not been able to attend for various

19
00:00:35,280 --> 00:00:37,860
reasons so it's great to be back great

20
00:00:37,860 --> 00:00:39,329
to see the v.b conference still going

21
00:00:39,329 --> 00:00:42,390
strong and also that this now some cyber

22
00:00:42,390 --> 00:00:45,030
threat intelligence you know programs

23
00:00:45,030 --> 00:00:46,350
coming in as well the last few years

24
00:00:46,350 --> 00:00:47,430
which has been great and there's been

25
00:00:47,430 --> 00:00:50,539
some great talks the last couple of days

26
00:00:50,539 --> 00:00:53,610
so thanks for having me and allowing me

27
00:00:53,610 --> 00:00:55,949
to contribute to speak today I believe

28
00:00:55,949 --> 00:00:57,960
this is also the first time unit 42 and

29
00:00:57,960 --> 00:00:59,670
panel two networks are spoken here and

30
00:00:59,670 --> 00:01:02,219
hopefully this won't be the last and

31
00:01:02,219 --> 00:01:04,319
yeah just to crack on - my name is Alex

32
00:01:04,319 --> 00:01:05,369
inch live I'm a threat intelligence

33
00:01:05,369 --> 00:01:07,619
analyst at unit 42 which is part of Palo

34
00:01:07,619 --> 00:01:10,020
Alto Networks prior to that I was at

35
00:01:10,020 --> 00:01:12,510
Intel and McAfee in the US and McAfee

36
00:01:12,510 --> 00:01:14,010
labs in the UK doing a mixture of

37
00:01:14,010 --> 00:01:16,140
Windows Maori research and Android

38
00:01:16,140 --> 00:01:20,040
malware research as well and given it's

39
00:01:20,040 --> 00:01:21,090
the last day of the conference

40
00:01:21,090 --> 00:01:23,159
we've just had lunch I thought I'd kick

41
00:01:23,159 --> 00:01:25,590
us off with a bit of humor you know just

42
00:01:25,590 --> 00:01:28,829
get in the right mood especially as many

43
00:01:28,829 --> 00:01:30,930
of you might not know who power ODS and

44
00:01:30,930 --> 00:01:34,020
it works is and if I can get my clicker

45
00:01:34,020 --> 00:01:39,299
to work that would be great there we go

46
00:01:39,299 --> 00:01:40,650
we're also learning a lot about Google

47
00:01:40,650 --> 00:01:42,420
slides here and how it operates with

48
00:01:42,420 --> 00:01:44,579
this technology and so I found this on

49
00:01:44,579 --> 00:01:47,009
Twitter a bit of fun and but it might

50
00:01:47,009 --> 00:01:48,479
give you an idea of who power networks

51
00:01:48,479 --> 00:01:50,790
is I'll let you read it for a minute

52
00:01:50,790 --> 00:01:52,229
because time is precious and then we'll

53
00:01:52,229 --> 00:01:56,340
move on so apparently all the cool kids

54
00:01:56,340 --> 00:01:58,110
have Palo Alto Networks I don't know

55
00:01:58,110 --> 00:02:00,630
about that but this guy clearly loves

56
00:02:00,630 --> 00:02:02,610
defense-in-depth with these firewalls so

57
00:02:02,610 --> 00:02:04,469
if you get through to the internal

58
00:02:04,469 --> 00:02:06,110
network you're doing a pretty good job I

59
00:02:06,110 --> 00:02:08,038
don't know where it came from on Twitter

60
00:02:08,038 --> 00:02:10,649
but I'm sure you can you can find it so

61
00:02:10,649 --> 00:02:12,330
the other thing is I get asked a lot

62
00:02:12,330 --> 00:02:14,230
what where does the name unit 42

63
00:02:14,230 --> 00:02:16,870
come come from if you've ever at the

64
00:02:16,870 --> 00:02:19,420
book or watch the movie Douglas Adams

65
00:02:19,420 --> 00:02:21,519
Hitchhiker's Guide to the galaxy the

66
00:02:21,519 --> 00:02:22,959
meaning of life the universe and

67
00:02:22,959 --> 00:02:25,060
everything is 42 so we shamelessly stole

68
00:02:25,060 --> 00:02:27,459
it and we use that as part of our name

69
00:02:27,459 --> 00:02:29,379
but I think mainly it's because our

70
00:02:29,379 --> 00:02:31,030
executive staff we're just getting fed

71
00:02:31,030 --> 00:02:32,680
up of saying Palo Alto Networks threat

72
00:02:32,680 --> 00:02:34,599
intelligence team every time in a

73
00:02:34,599 --> 00:02:36,370
sentence they wanted to talk about us so

74
00:02:36,370 --> 00:02:40,090
there you go okay so the agenda today

75
00:02:40,090 --> 00:02:42,280
I'm gonna talk about pique plug which is

76
00:02:42,280 --> 00:02:43,870
the moniker or the name we've given to a

77
00:02:43,870 --> 00:02:45,519
set of activity we've been checking for

78
00:02:45,519 --> 00:02:48,910
a few years and I'll go over you know

79
00:02:48,910 --> 00:02:50,170
the history all that bit of an overview

80
00:02:50,170 --> 00:02:51,790
I'm gonna dive into one piece of malware

81
00:02:51,790 --> 00:02:54,040
in particular that we discovered a while

82
00:02:54,040 --> 00:02:55,450
back called hem box which is Android

83
00:02:55,450 --> 00:02:58,930
related and I'm also going to talk about

84
00:02:58,930 --> 00:03:00,609
some more recent activity so this is

85
00:03:00,609 --> 00:03:02,099
stuff that we've been watching for now

86
00:03:02,099 --> 00:03:04,750
well every penny initially three years

87
00:03:04,750 --> 00:03:06,760
it expanded about six years worth of

88
00:03:06,760 --> 00:03:09,190
activity but this stuff that's happened

89
00:03:09,190 --> 00:03:10,420
in the last few months I'm gonna share

90
00:03:10,420 --> 00:03:12,129
some of that with you as well and then

91
00:03:12,129 --> 00:03:14,200
finally time permitting I'm gonna talk

92
00:03:14,200 --> 00:03:15,760
about a bit about adversary' playbooks

93
00:03:15,760 --> 00:03:18,010
and how we're sharing some of our threat

94
00:03:18,010 --> 00:03:19,450
Intel not just the indicators are

95
00:03:19,450 --> 00:03:21,099
compromised but also the TTP's the

96
00:03:21,099 --> 00:03:23,200
behaviors of these adversaries as well

97
00:03:23,200 --> 00:03:25,030
and you may have heard about some of

98
00:03:25,030 --> 00:03:28,030
that stuff in the last you know day or

99
00:03:28,030 --> 00:03:31,090
so so the overview of PK plug is that

100
00:03:31,090 --> 00:03:32,739
it's a espionage motivator so they've

101
00:03:32,739 --> 00:03:34,569
got lots of tools around backdoors

102
00:03:34,569 --> 00:03:37,510
remote shells spyware for Android and

103
00:03:37,510 --> 00:03:39,310
various other things that they use to

104
00:03:39,310 --> 00:03:41,260
get a foothold into a network track

105
00:03:41,260 --> 00:03:43,239
people spy on people steal information

106
00:03:43,239 --> 00:03:46,959
the usual kind of espionage stuff and at

107
00:03:46,959 --> 00:03:48,849
the moment we say group or groups we

108
00:03:48,849 --> 00:03:50,919
don't have enough visibility to know

109
00:03:50,919 --> 00:03:53,470
exactly if it's one group or multiple

110
00:03:53,470 --> 00:03:54,849
groups using the same tools with

111
00:03:54,849 --> 00:03:57,669
different tasking from experience of

112
00:03:57,669 --> 00:03:59,379
looking at some Chinese groups in the

113
00:03:59,379 --> 00:04:01,690
past it can be very convoluted confusing

114
00:04:01,690 --> 00:04:03,129
pretty complex to try and figure out

115
00:04:03,129 --> 00:04:06,340
exactly where the where the delineation

116
00:04:06,340 --> 00:04:09,040
is between the different groups and so

117
00:04:09,040 --> 00:04:11,530
right now that's where we are we've been

118
00:04:11,530 --> 00:04:12,669
tracking them for about three years and

119
00:04:12,669 --> 00:04:14,260
that will become more clear as we look

120
00:04:14,260 --> 00:04:16,180
at the next couple of slides but they've

121
00:04:16,180 --> 00:04:17,769
been active at least as far as we can

122
00:04:17,769 --> 00:04:21,070
tell for a good six years or more using

123
00:04:21,070 --> 00:04:22,240
a combination of publicly available

124
00:04:22,240 --> 00:04:24,280
malware so things like poison ivy and

125
00:04:24,280 --> 00:04:25,990
plug X which do the rounds especially

126
00:04:25,990 --> 00:04:27,940
with Chinese adversaries

127
00:04:27,940 --> 00:04:30,100
but we've also also seen 9,000 to be

128
00:04:30,100 --> 00:04:32,230
used the hem box and Farseer stuff that

129
00:04:32,230 --> 00:04:33,880
we discovered we've never seen before

130
00:04:33,880 --> 00:04:36,070
we've never seen any other groups using

131
00:04:36,070 --> 00:04:40,090
it so it's custom-built in terms of

132
00:04:40,090 --> 00:04:41,800
targeting there's been a lot of talk

133
00:04:41,800 --> 00:04:43,990
over the last few days about a chapter

134
00:04:43,990 --> 00:04:47,710
slide actually works about the kind of

135
00:04:47,710 --> 00:04:49,810
scent Southeast Asia and Central Asia

136
00:04:49,810 --> 00:04:52,240
region and how that's a bit of a hotbed

137
00:04:52,240 --> 00:04:54,250
at the moment and so the targeting that

138
00:04:54,250 --> 00:04:55,960
we see with higher confidence of things

139
00:04:55,960 --> 00:04:58,180
like outer mongolia or the independent

140
00:04:58,180 --> 00:05:01,300
mongolia and the shins and region of

141
00:05:01,300 --> 00:05:03,790
china the northwest region of china

142
00:05:03,790 --> 00:05:06,700
which is an autonomous region near there

143
00:05:06,700 --> 00:05:08,140
we've got Tibet as well which is a lower

144
00:05:08,140 --> 00:05:09,610
confidence for us just in terms of

145
00:05:09,610 --> 00:05:12,430
visibility of what we're seeing my anmar

146
00:05:12,430 --> 00:05:14,680
in Taiwan are high confidence and then

147
00:05:14,680 --> 00:05:17,110
Vietnam and Indonesia are lower

148
00:05:17,110 --> 00:05:20,770
confidence at the moment so if we look

149
00:05:20,770 --> 00:05:23,440
at the the history and information there

150
00:05:23,440 --> 00:05:25,870
countries like Taiwan and Mongolia have

151
00:05:25,870 --> 00:05:28,900
a long-standing history of you know

152
00:05:28,900 --> 00:05:31,090
economics but also kind of independence

153
00:05:31,090 --> 00:05:33,910
and violence between each other and so

154
00:05:33,910 --> 00:05:36,610
there's a lot of interesting ties there

155
00:05:36,610 --> 00:05:38,560
with Taiwan we see these things like the

156
00:05:38,560 --> 00:05:41,170
cross-strait relations being tested and

157
00:05:41,170 --> 00:05:43,230
if you've seen the news recently the US

158
00:05:43,230 --> 00:05:45,490
or other Taiwan have bought about two

159
00:05:45,490 --> 00:05:47,080
billion dollars worth of military

160
00:05:47,080 --> 00:05:49,000
equipment from the US which should be

161
00:05:49,000 --> 00:05:50,430
delivered in the next year or two and

162
00:05:50,430 --> 00:05:54,030
China is pretty unhappy about this and

163
00:05:54,030 --> 00:05:57,010
we see lots of information in the news

164
00:05:57,010 --> 00:06:00,010
about the South China Sea and disputes

165
00:06:00,010 --> 00:06:02,110
there so there are numerous countries

166
00:06:02,110 --> 00:06:03,760
that are claiming ownership over various

167
00:06:03,760 --> 00:06:06,820
parts of that part of the sea and things

168
00:06:06,820 --> 00:06:08,380
like fishing rights are up for grabs but

169
00:06:08,380 --> 00:06:11,140
also there's yet unproven oil and gas

170
00:06:11,140 --> 00:06:12,880
reserves there so it's quite a heated

171
00:06:12,880 --> 00:06:15,370
topic and you often often get you know

172
00:06:15,370 --> 00:06:17,260
for foreign militaries coming through

173
00:06:17,260 --> 00:06:18,610
that area as well just to try and keep

174
00:06:18,610 --> 00:06:20,650
the peace and that probably doesn't help

175
00:06:20,650 --> 00:06:24,520
um so most if not all of these countries

176
00:06:24,520 --> 00:06:26,230
and regions that I'm talking about today

177
00:06:26,230 --> 00:06:28,000
are part of the Bri or the belt road

178
00:06:28,000 --> 00:06:29,380
initiative I'm not gonna go into any

179
00:06:29,380 --> 00:06:31,300
detail about this but I believe there

180
00:06:31,300 --> 00:06:32,980
was a talk yesterday from Deloitte I

181
00:06:32,980 --> 00:06:35,169
missed it because I was on a panel but I

182
00:06:35,169 --> 00:06:37,390
think the talk was largely about the Bri

183
00:06:37,390 --> 00:06:38,190
and how the

184
00:06:38,190 --> 00:06:41,070
targeting of some of these Chinese

185
00:06:41,070 --> 00:06:42,450
adversary's maps to some of that

186
00:06:42,450 --> 00:06:45,720
activity but certainly you know the

187
00:06:45,720 --> 00:06:46,950
countries I've talked about and the

188
00:06:46,950 --> 00:06:49,350
regions like Qin Zhang and Mongolia are

189
00:06:49,350 --> 00:06:51,780
critical parts of the Bri for China so

190
00:06:51,780 --> 00:06:53,160
it kind of makes sense that they are

191
00:06:53,160 --> 00:06:55,830
targeted and we've also got three of

192
00:06:55,830 --> 00:06:58,140
those countries that I've mentioned are

193
00:06:58,140 --> 00:07:02,160
part of the Asian Association which is a

194
00:07:02,160 --> 00:07:04,470
group of about I think ten countries at

195
00:07:04,470 --> 00:07:06,090
the moment in Asia that do

196
00:07:06,090 --> 00:07:08,340
intergovernmental you know communication

197
00:07:08,340 --> 00:07:10,200
sharing and other stuff so again a

198
00:07:10,200 --> 00:07:12,660
viable target for China given they're

199
00:07:12,660 --> 00:07:17,220
not members so in terms of the history

200
00:07:17,220 --> 00:07:20,490
one of the first publications we saw and

201
00:07:20,490 --> 00:07:21,810
this this timeline which is going to

202
00:07:21,810 --> 00:07:24,930
build out over time is a chronological

203
00:07:24,930 --> 00:07:27,570
order of the publishing of the research

204
00:07:27,570 --> 00:07:29,430
so it's not when the attacks happened

205
00:07:29,430 --> 00:07:32,040
it's not when them how where was being

206
00:07:32,040 --> 00:07:33,060
researched and the attacks were

207
00:07:33,060 --> 00:07:36,180
happening November 2013 in this case

208
00:07:36,180 --> 00:07:40,170
relate to the date of the publication so

209
00:07:40,170 --> 00:07:41,430
one of the first we saw was blue coke

210
00:07:41,430 --> 00:07:44,640
labs publishing on plug X malware

211
00:07:44,640 --> 00:07:47,280
targeting Mongolia specifically with a

212
00:07:47,280 --> 00:07:49,260
Mongolian healthcare law for a new

213
00:07:49,260 --> 00:07:51,030
facility that was being built in the

214
00:07:51,030 --> 00:07:54,770
capital and they used the usual kind of

215
00:07:54,770 --> 00:07:56,940
components we see with some Chinese

216
00:07:56,940 --> 00:07:59,220
adversaries which is a DLL side loaded

217
00:07:59,220 --> 00:08:01,940
kind of WinRAR or archive package

218
00:08:01,940 --> 00:08:04,980
containing the the benign file that's

219
00:08:04,980 --> 00:08:06,570
going to be used to load the malicious

220
00:08:06,570 --> 00:08:06,930
DLL

221
00:08:06,930 --> 00:08:10,290
and all the other components as well and

222
00:08:10,290 --> 00:08:12,780
the next publication we saw was our bure

223
00:08:12,780 --> 00:08:15,780
networks in April 2016 published about

224
00:08:15,780 --> 00:08:18,419
poison ivy malware that was primarily

225
00:08:18,419 --> 00:08:20,970
hitting my and Mark and the lures there

226
00:08:20,970 --> 00:08:22,680
were mostly impatiens related to that

227
00:08:22,680 --> 00:08:24,720
association of intergovernmental

228
00:08:24,720 --> 00:08:30,570
relations July 2016 was the first

229
00:08:30,570 --> 00:08:32,880
activity tweets we saw and that we

230
00:08:32,880 --> 00:08:35,610
published on the unit 42 and published

231
00:08:35,610 --> 00:08:38,280
about a 9002 trojan that was being seen

232
00:08:38,280 --> 00:08:40,919
delivered by Google Drive all through

233
00:08:40,919 --> 00:08:43,339
google drivers as the sharing mechanism

234
00:08:43,339 --> 00:08:45,780
and it was targeting my and Mar and

235
00:08:45,780 --> 00:08:48,120
specifically we saw some activists some

236
00:08:48,120 --> 00:08:49,440
known activists from that country being

237
00:08:49,440 --> 00:08:50,819
targeted

238
00:08:50,819 --> 00:08:52,769
and the lure in this case was relations

239
00:08:52,769 --> 00:08:54,209
between Taiwan and China the

240
00:08:54,209 --> 00:08:56,910
cross-strait relations so this was the

241
00:08:56,910 --> 00:08:58,529
first time that we saw the activity and

242
00:08:58,529 --> 00:09:00,629
that's why I say we've actively been

243
00:09:00,629 --> 00:09:02,339
tracking it for three years since since

244
00:09:02,339 --> 00:09:04,680
2016 but through the work that we've

245
00:09:04,680 --> 00:09:07,649
done hunting for more samples pivoting

246
00:09:07,649 --> 00:09:09,720
on infrastructure and looking back at

247
00:09:09,720 --> 00:09:12,209
finding these previous publications

248
00:09:12,209 --> 00:09:13,620
we've been able to say the group's

249
00:09:13,620 --> 00:09:17,220
active for about six years so in March

250
00:09:17,220 --> 00:09:20,310
2017 we saw some Japanese researchers

251
00:09:20,310 --> 00:09:22,350
publish a report initially in Japanese

252
00:09:22,350 --> 00:09:24,990
it was translated to English that was

253
00:09:24,990 --> 00:09:27,029
based on information from the VK RL

254
00:09:27,029 --> 00:09:29,160
which is a Hong kong-based cybersecurity

255
00:09:29,160 --> 00:09:33,629
company and they named that campaign the

256
00:09:33,629 --> 00:09:36,149
tongue twister happy which is free

257
00:09:36,149 --> 00:09:38,970
hosting a PT powersploit poison ivy

258
00:09:38,970 --> 00:09:40,949
that's what that's what it stands for

259
00:09:40,949 --> 00:09:44,939
and and that was as you can guess poison

260
00:09:44,939 --> 00:09:46,290
ivy malware being delivered to various

261
00:09:46,290 --> 00:09:49,439
victims they saw Chinese targeting with

262
00:09:49,439 --> 00:09:51,269
Chinese language in the in the lure and

263
00:09:51,269 --> 00:09:54,240
also among Mongolian victims as well in

264
00:09:54,240 --> 00:09:56,819
a second campaign and essentially the

265
00:09:56,819 --> 00:09:58,680
phishing email had a link to Japan

266
00:09:58,680 --> 00:10:00,870
Geocities website where VBS would be

267
00:10:00,870 --> 00:10:01,620
executed

268
00:10:01,620 --> 00:10:03,480
eventually PowerShell would would step

269
00:10:03,480 --> 00:10:06,269
in and run other code to deploy payload

270
00:10:06,269 --> 00:10:10,230
on to the victim system in analyzing

271
00:10:10,230 --> 00:10:11,459
that PowerShell code that was on the

272
00:10:11,459 --> 00:10:13,439
Geocities website it turned out to be a

273
00:10:13,439 --> 00:10:15,959
version of power sploit which is a post

274
00:10:15,959 --> 00:10:17,970
exploitation framework available on

275
00:10:17,970 --> 00:10:20,730
github in that's commonly use my pen

276
00:10:20,730 --> 00:10:23,040
testers but in this case was used by the

277
00:10:23,040 --> 00:10:28,110
actors as well in March 2018 we

278
00:10:28,110 --> 00:10:29,399
published on hen box I'm not going to go

279
00:10:29,399 --> 00:10:30,870
into any detail because I cover that in

280
00:10:30,870 --> 00:10:32,399
a minute but that's the Android malware

281
00:10:32,399 --> 00:10:35,730
and then in February 2009 teen the most

282
00:10:35,730 --> 00:10:37,379
recent publication we've done was about

283
00:10:37,379 --> 00:10:39,029
this other windows-based malware we've

284
00:10:39,029 --> 00:10:42,480
seen that we called Farseer pretty

285
00:10:42,480 --> 00:10:44,279
similar to poison ivy in plug x in that

286
00:10:44,279 --> 00:10:47,370
it uses DL outside loading to run it's a

287
00:10:47,370 --> 00:10:49,259
remote shell and all the all the good

288
00:10:49,259 --> 00:10:51,329
stuff you get from

289
00:10:51,329 --> 00:10:53,069
poison ivy and plug X but it is

290
00:10:53,069 --> 00:10:57,720
different and the lure for the Farseer

291
00:10:57,720 --> 00:11:00,269
attacks we saw some decoy documents

292
00:11:00,269 --> 00:11:02,459
about my NMR and we've seen telemetry

293
00:11:02,459 --> 00:11:03,630
from Mong

294
00:11:03,630 --> 00:11:05,850
in host so you know the targeting is in

295
00:11:05,850 --> 00:11:10,019
the same region as well so as as I said

296
00:11:10,019 --> 00:11:12,509
when we found our piece of what were our

297
00:11:12,509 --> 00:11:14,910
discovery in 2016 we start to you know

298
00:11:14,910 --> 00:11:16,290
pivot out and try and find any out

299
00:11:16,290 --> 00:11:18,120
related infrastructure we found the

300
00:11:18,120 --> 00:11:19,709
previous publications by those two

301
00:11:19,709 --> 00:11:22,459
companies we eventually found a non-void

302
00:11:22,459 --> 00:11:24,810
file which we then discovered was hem

303
00:11:24,810 --> 00:11:26,730
box malware and and you know the process

304
00:11:26,730 --> 00:11:29,880
the cyclic process continues so one of

305
00:11:29,880 --> 00:11:31,589
the tools we use quite often is multigo

306
00:11:31,589 --> 00:11:33,690
and it allows us to pull in data from

307
00:11:33,690 --> 00:11:35,490
lots of sources and have a visualization

308
00:11:35,490 --> 00:11:37,529
like this where you can start to really

309
00:11:37,529 --> 00:11:39,540
see how the different parts map together

310
00:11:39,540 --> 00:11:42,240
files IP addresses hashes domain names

311
00:11:42,240 --> 00:11:45,050
all that kind of stuff

312
00:11:45,050 --> 00:11:47,639
again what I said earlier about Chinese

313
00:11:47,639 --> 00:11:49,050
actors trying to track them it often

314
00:11:49,050 --> 00:11:50,699
ends up with like messy multi goes like

315
00:11:50,699 --> 00:11:53,339
this but but for the most part it's this

316
00:11:53,339 --> 00:11:55,980
groups not so bad so this is where we're

317
00:11:55,980 --> 00:11:57,449
gonna focus now these green dots which

318
00:11:57,449 --> 00:11:59,040
are there like the hen box or they sorry

319
00:11:59,040 --> 00:12:02,940
the Android icons for this particular

320
00:12:02,940 --> 00:12:07,380
piece of malware we saw there was a

321
00:12:07,380 --> 00:12:08,910
custom piece of malware we'd never seen

322
00:12:08,910 --> 00:12:10,500
before it includes lots of tools like

323
00:12:10,500 --> 00:12:13,100
super user capabilities to get access

324
00:12:13,100 --> 00:12:16,290
elevated access to the device contains

325
00:12:16,290 --> 00:12:18,269
busybox which is a cut-down version of

326
00:12:18,269 --> 00:12:20,370
linux like shells and components to give

327
00:12:20,370 --> 00:12:22,139
you kind of sysadmin tools on the

328
00:12:22,139 --> 00:12:24,990
android device and contain some anti

329
00:12:24,990 --> 00:12:28,310
emulation anti analysis techniques and

330
00:12:28,310 --> 00:12:30,630
you know from the from the original

331
00:12:30,630 --> 00:12:31,949
samples we found we've been able to

332
00:12:31,949 --> 00:12:33,959
expand our search and we found now over

333
00:12:33,959 --> 00:12:36,149
400 samples that date back as far as

334
00:12:36,149 --> 00:12:39,720
2015 but also we're seeing them even

335
00:12:39,720 --> 00:12:43,230
this week in terms of where was that

336
00:12:43,230 --> 00:12:44,310
well I'll talk about their delivery in a

337
00:12:44,310 --> 00:12:46,290
minute but we're seeing you know plenty

338
00:12:46,290 --> 00:12:48,209
of samples primarily seems to be

339
00:12:48,209 --> 00:12:50,519
targeting the weaker population which is

340
00:12:50,519 --> 00:12:54,120
a majority ethnic population in the

341
00:12:54,120 --> 00:12:56,759
shinjang region in the North West of

342
00:12:56,759 --> 00:12:59,459
China and and as per the map that you

343
00:12:59,459 --> 00:13:00,630
just saw there's lots of infrastructure

344
00:13:00,630 --> 00:13:02,639
ties with previous attacks with a focus

345
00:13:02,639 --> 00:13:08,490
on on politics in in that region okay so

346
00:13:08,490 --> 00:13:11,040
in terms of where the name came from if

347
00:13:11,040 --> 00:13:12,300
you know anything about Android files

348
00:13:12,300 --> 00:13:14,100
and apks there must be a package name

349
00:13:14,100 --> 00:13:16,310
and there can only be one package name

350
00:13:16,310 --> 00:13:18,500
on the device at once with the same name

351
00:13:18,500 --> 00:13:20,630
so you can't have say two Facebook apps

352
00:13:20,630 --> 00:13:23,090
on the same device in this particular

353
00:13:23,090 --> 00:13:24,770
case most of the apps we saw the cool

354
00:13:24,770 --> 00:13:26,420
Condor Android hem box that was the

355
00:13:26,420 --> 00:13:28,430
package name and the digital certificate

356
00:13:28,430 --> 00:13:30,590
or developer signature or whatever you

357
00:13:30,590 --> 00:13:32,540
want to call it the signer and typically

358
00:13:32,540 --> 00:13:35,230
look like this that second bullet point

359
00:13:35,230 --> 00:13:38,810
we have seen variations of the two we've

360
00:13:38,810 --> 00:13:40,279
even seen some samples that use the

361
00:13:40,279 --> 00:13:44,000
Android developer oh sorry the Android

362
00:13:44,000 --> 00:13:46,339
debug signature which is a bit of a mess

363
00:13:46,339 --> 00:13:48,380
because lots of malware uses that and

364
00:13:48,380 --> 00:13:51,140
but predominately it looks like this it

365
00:13:51,140 --> 00:13:53,480
masquerades is a variety of legit apps

366
00:13:53,480 --> 00:13:55,460
so you think see things like those icons

367
00:13:55,460 --> 00:13:57,230
like backup and settings being used as

368
00:13:57,230 --> 00:13:59,420
the app names just to try and make it

369
00:13:59,420 --> 00:14:01,660
look like it's it's a benign application

370
00:14:01,660 --> 00:14:05,360
and there's lots of reference to what I

371
00:14:05,360 --> 00:14:07,610
now know to be a Chinese consumer

372
00:14:07,610 --> 00:14:09,310
electronics manufacturer called Xiaomi

373
00:14:09,310 --> 00:14:11,660
rather embarrassingly when I did this

374
00:14:11,660 --> 00:14:12,830
research I'd never heard of this company

375
00:14:12,830 --> 00:14:14,720
before but it turns out they have a lot

376
00:14:14,720 --> 00:14:18,260
of stuff and they're a big company so

377
00:14:18,260 --> 00:14:20,210
Xiaomi and also references to me--you

378
00:14:20,210 --> 00:14:21,830
which is there that kind of Android

379
00:14:21,830 --> 00:14:23,750
version they have a fork of of Android

380
00:14:23,750 --> 00:14:25,490
called me you and if you look at the

381
00:14:25,490 --> 00:14:27,140
code here this is during the

382
00:14:27,140 --> 00:14:28,760
installation of the app in the execution

383
00:14:28,760 --> 00:14:29,870
where it's trying to determine whether

384
00:14:29,870 --> 00:14:31,850
it's on an emulator device and doing

385
00:14:31,850 --> 00:14:35,030
other you know background checks it also

386
00:14:35,030 --> 00:14:37,790
checks for whether whether it's running

387
00:14:37,790 --> 00:14:39,080
on a Xiaomi device or whether it's

388
00:14:39,080 --> 00:14:41,990
running on that me--you firmware it

389
00:14:41,990 --> 00:14:43,820
looks like it's conditional so if it's

390
00:14:43,820 --> 00:14:45,140
on that device you probably would have

391
00:14:45,140 --> 00:14:47,450
continued to infect but actually there's

392
00:14:47,450 --> 00:14:48,710
quite buggy code there and it's been

393
00:14:48,710 --> 00:14:50,470
there for a while where it always return

394
00:14:50,470 --> 00:14:53,300
true in which case it runs on emulators

395
00:14:53,300 --> 00:14:55,670
it runs on samsung devices and all that

396
00:14:55,670 --> 00:15:00,410
all that kind of stuff and so in terms

397
00:15:00,410 --> 00:15:02,900
of de delivery as I mentioned we've seen

398
00:15:02,900 --> 00:15:05,000
like 400 on samples of this the vast

399
00:15:05,000 --> 00:15:06,560
majority we've managed to get through

400
00:15:06,560 --> 00:15:08,740
various means of crawling the internet

401
00:15:08,740 --> 00:15:11,660
gathering samples from VT through the

402
00:15:11,660 --> 00:15:13,570
cyber threat Alliance and other sharing

403
00:15:13,570 --> 00:15:17,600
but there was one particular app that we

404
00:15:17,600 --> 00:15:19,520
saw downloaded in May 2016 which is

405
00:15:19,520 --> 00:15:21,890
pretty interesting so this was someone

406
00:15:21,890 --> 00:15:24,170
behind one of our firewalls I believe it

407
00:15:24,170 --> 00:15:24,980
may have actually been in like a

408
00:15:24,980 --> 00:15:26,520
university network

409
00:15:26,520 --> 00:15:28,080
but behind one of our firewalls they

410
00:15:28,080 --> 00:15:30,149
downloaded an app from a website called

411
00:15:30,149 --> 00:15:32,760
we got apps net so that gives you some

412
00:15:32,760 --> 00:15:36,209
indication of what who that app store is

413
00:15:36,209 --> 00:15:38,100
gigi is trying to serve and they were

414
00:15:38,100 --> 00:15:40,320
trying to download app ID number 40 and

415
00:15:40,320 --> 00:15:42,300
at the time that app was this is the App

416
00:15:42,300 --> 00:15:44,160
Store here at the time that app was

417
00:15:44,160 --> 00:15:47,580
Droid VPN and although the app was

418
00:15:47,580 --> 00:15:49,440
called Droid VPN the package name was

419
00:15:49,440 --> 00:15:50,970
hen bucks and we were detecting it as

420
00:15:50,970 --> 00:15:55,200
malware so the we grap store at the time

421
00:15:55,200 --> 00:15:57,240
was a Windows 32 box it had a very

422
00:15:57,240 --> 00:15:59,370
outdated version of Apache and my gut

423
00:15:59,370 --> 00:16:01,649
feeling is and the Box were compromised

424
00:16:01,649 --> 00:16:05,690
and the actors implanted the hem box app

425
00:16:05,690 --> 00:16:08,339
overriding the the droid VPN app so if

426
00:16:08,339 --> 00:16:10,350
you download android VPN you'd get ten

427
00:16:10,350 --> 00:16:13,080
box malware in this case in a few other

428
00:16:13,080 --> 00:16:15,029
cases that benign application was

429
00:16:15,029 --> 00:16:17,040
actually embedded inside the hen box app

430
00:16:17,040 --> 00:16:18,990
and during installation it would try and

431
00:16:18,990 --> 00:16:20,730
start the install of that benign app as

432
00:16:20,730 --> 00:16:23,130
well so and eventually you may have

433
00:16:23,130 --> 00:16:24,209
actually got the app you were looking

434
00:16:24,209 --> 00:16:25,860
for but on the way you would have been

435
00:16:25,860 --> 00:16:29,880
compromised as well so that droid bb-8

436
00:16:29,880 --> 00:16:32,040
droid VPN app on that app store looks

437
00:16:32,040 --> 00:16:33,720
like this and it's available on Google

438
00:16:33,720 --> 00:16:35,760
Play so it's a completely legit app but

439
00:16:35,760 --> 00:16:37,589
for a period of time it was it was

440
00:16:37,589 --> 00:16:42,000
compromised on that App Store emcee

441
00:16:42,000 --> 00:16:43,200
using a heat map which is quite a

442
00:16:43,200 --> 00:16:44,730
traditional method for trying to look at

443
00:16:44,730 --> 00:16:46,140
some data and try and understand some

444
00:16:46,140 --> 00:16:48,029
patterns and I've got the package names

445
00:16:48,029 --> 00:16:49,950
for the apps that we've seen on the Left

446
00:16:49,950 --> 00:16:52,709
column and I've got the app names across

447
00:16:52,709 --> 00:16:55,760
that top row it might not be completely

448
00:16:55,760 --> 00:16:58,290
visible to you but you can start to see

449
00:16:58,290 --> 00:17:00,480
some trends so as I mentioned Condor and

450
00:17:00,480 --> 00:17:02,220
Gloria gem box was certainly the most

451
00:17:02,220 --> 00:17:04,980
prevalent package name and the most

452
00:17:04,980 --> 00:17:07,260
prevalent app name in this case was

453
00:17:07,260 --> 00:17:10,589
backup in Chinese but there are some

454
00:17:10,589 --> 00:17:11,849
other you know clustering of more

455
00:17:11,849 --> 00:17:13,949
popular samples and combinations of app

456
00:17:13,949 --> 00:17:16,050
names and package names being used that

457
00:17:16,050 --> 00:17:17,609
include things like synchronization

458
00:17:17,609 --> 00:17:20,069
service backup backup service and all

459
00:17:20,069 --> 00:17:24,510
these things that would basically tell

460
00:17:24,510 --> 00:17:25,890
the victim that it's a benign app and

461
00:17:25,890 --> 00:17:27,000
not that not too worried about it

462
00:17:27,000 --> 00:17:29,490
and we've seen some other app names

463
00:17:29,490 --> 00:17:33,540
which target the Weger language in the

464
00:17:33,540 --> 00:17:35,400
weaker population again and we've also

465
00:17:35,400 --> 00:17:37,320
seen an app that was called jihadi

466
00:17:37,320 --> 00:17:39,670
Nasheed's which I think are Islamic

467
00:17:39,670 --> 00:17:42,760
songs and poems we've seen apps like who

468
00:17:42,760 --> 00:17:45,940
are neurotic acts and a few others which

469
00:17:45,940 --> 00:17:48,970
seem to be focused on the weekers and

470
00:17:48,970 --> 00:17:51,700
that kind of wider shinjang region and

471
00:17:51,700 --> 00:17:53,890
when I grab some text of a legitimate

472
00:17:53,890 --> 00:17:56,290
app store for that optic acts a p-- it

473
00:17:56,290 --> 00:17:58,240
translates to you know this happy

474
00:17:58,240 --> 00:17:59,890
especially designed for domestic

475
00:17:59,890 --> 00:18:01,300
minority people to download and install

476
00:18:01,300 --> 00:18:04,480
so it's the perfect kind of target - you

477
00:18:04,480 --> 00:18:07,630
know import or have some malware make it

478
00:18:07,630 --> 00:18:09,010
seem as if it's the same kind of app as

479
00:18:09,010 --> 00:18:11,100
that one and then try and get people

480
00:18:11,100 --> 00:18:16,000
infected so in terms of the the app

481
00:18:16,000 --> 00:18:18,220
structure they're pretty convoluted apps

482
00:18:18,220 --> 00:18:19,660
I mean most of the malware I see on

483
00:18:19,660 --> 00:18:21,940
Android are typically an apk file which

484
00:18:21,940 --> 00:18:24,460
is a zip file basically containing a Dex

485
00:18:24,460 --> 00:18:26,650
file which is the mandatory you know

486
00:18:26,650 --> 00:18:28,300
code file and a few config files in that

487
00:18:28,300 --> 00:18:29,230
and that's about it really

488
00:18:29,230 --> 00:18:31,420
and in this particular case we see

489
00:18:31,420 --> 00:18:34,360
numerous health libraries that are there

490
00:18:34,360 --> 00:18:37,000
for encryption decryption for tracking

491
00:18:37,000 --> 00:18:38,380
location I think they had the Baidu

492
00:18:38,380 --> 00:18:41,460
tracking code in there in an elf library

493
00:18:41,460 --> 00:18:43,840
there's a config file and the zip file

494
00:18:43,840 --> 00:18:45,730
over there on the right that contains

495
00:18:45,730 --> 00:18:48,040
yet another Dex and elf those both are

496
00:18:48,040 --> 00:18:50,440
loaded dynamically at runtime and the

497
00:18:50,440 --> 00:18:52,330
Dex file is actually the that second Dex

498
00:18:52,330 --> 00:18:53,500
file is the bit that does a lot of the

499
00:18:53,500 --> 00:18:56,650
espionage tracking work so it's pretty

500
00:18:56,650 --> 00:18:58,600
convoluted a lot of the components are X

501
00:18:58,600 --> 00:19:00,550
or encoded or what else you for

502
00:19:00,550 --> 00:19:03,160
encrypted with some compression so in

503
00:19:03,160 --> 00:19:05,590
many cases you know the static kind of

504
00:19:05,590 --> 00:19:07,750
signatures and AV detection isn't isn't

505
00:19:07,750 --> 00:19:10,990
enough to get inside these and an

506
00:19:10,990 --> 00:19:12,910
optional component on the left-hand side

507
00:19:12,910 --> 00:19:14,620
there is that there may be these decoy

508
00:19:14,620 --> 00:19:17,680
apps also embedded within the apk so I

509
00:19:17,680 --> 00:19:19,720
talked about droid VPN but we've seen

510
00:19:19,720 --> 00:19:22,600
the Weger language translation app being

511
00:19:22,600 --> 00:19:24,400
carried inside another apk for a

512
00:19:24,400 --> 00:19:26,530
different campaign we've seen the a Mac

513
00:19:26,530 --> 00:19:29,260
agency app which is a an app reporting

514
00:19:29,260 --> 00:19:33,910
on Isis news and another one is is llama

515
00:19:33,910 --> 00:19:36,250
huazi which is related to the turkistan

516
00:19:36,250 --> 00:19:38,800
islamic party old tip and it was their

517
00:19:38,800 --> 00:19:40,570
media player of some sort again probably

518
00:19:40,570 --> 00:19:42,910
news related but we've seen those benign

519
00:19:42,910 --> 00:19:44,740
apps those legitimate apps embedded with

520
00:19:44,740 --> 00:19:49,450
inside various hem box components so if

521
00:19:49,450 --> 00:19:50,800
you're getting the idea about that that

522
00:19:50,800 --> 00:19:52,810
the tracking I was talking about before

523
00:19:52,810 --> 00:19:53,200
and

524
00:19:53,200 --> 00:19:55,450
the locations of the targeting this

525
00:19:55,450 --> 00:19:57,130
region you know borders many other

526
00:19:57,130 --> 00:19:58,299
countries and it's quite a hotbed of

527
00:19:58,299 --> 00:20:01,510
political interests it's part of the Bri

528
00:20:01,510 --> 00:20:04,720
and there's been lots of kind of news in

529
00:20:04,720 --> 00:20:06,309
the last few years especially and

530
00:20:06,309 --> 00:20:07,659
especially in the last few months

531
00:20:07,659 --> 00:20:09,820
actually around lots of people being

532
00:20:09,820 --> 00:20:13,029
detained their tracking of these weaker

533
00:20:13,029 --> 00:20:16,240
population and various other things

534
00:20:16,240 --> 00:20:18,519
related to the Bri so I won't go into

535
00:20:18,519 --> 00:20:19,990
any more detail but you can kind of see

536
00:20:19,990 --> 00:20:24,639
that the targeting there so in terms of

537
00:20:24,639 --> 00:20:27,070
the trigger and when you install a piece

538
00:20:27,070 --> 00:20:28,870
of malware on your Android device as you

539
00:20:28,870 --> 00:20:30,880
do you can launch it you know by pushing

540
00:20:30,880 --> 00:20:32,769
the app button and it will run but you

541
00:20:32,769 --> 00:20:34,419
can also have these external triggers so

542
00:20:34,419 --> 00:20:36,130
if the device reboots and the app is

543
00:20:36,130 --> 00:20:36,519
hooked

544
00:20:36,519 --> 00:20:38,649
there like an it like a in intent like

545
00:20:38,649 --> 00:20:41,049
this to to be known when the boot when

546
00:20:41,049 --> 00:20:43,210
the device boot completes it will

547
00:20:43,210 --> 00:20:44,529
execute the malware so it's a bit like a

548
00:20:44,529 --> 00:20:47,679
registry run key for Windows and there

549
00:20:47,679 --> 00:20:48,940
was an interesting intent in here about

550
00:20:48,940 --> 00:20:51,490
Xiaomi again and again had no clue

551
00:20:51,490 --> 00:20:54,010
really who Xiao it was until I did this

552
00:20:54,010 --> 00:20:55,480
research when I started I think they

553
00:20:55,480 --> 00:20:57,039
were the sixth largest smartphone

554
00:20:57,039 --> 00:20:58,809
company in the world then the fifth now

555
00:20:58,809 --> 00:21:01,059
they're the fourth number-one in China

556
00:21:01,059 --> 00:21:03,760
and India and I think in India at least

557
00:21:03,760 --> 00:21:05,830
they overtook Samsung as a smartphone

558
00:21:05,830 --> 00:21:07,529
smartphone provider

559
00:21:07,529 --> 00:21:10,389
they've also got a shedload of IOT

560
00:21:10,389 --> 00:21:13,049
devices so things like IOT rice cookers

561
00:21:13,049 --> 00:21:16,120
washing machines robotic hoover's

562
00:21:16,120 --> 00:21:18,490
they've got scooters and all this other

563
00:21:18,490 --> 00:21:19,179
kind of stuff

564
00:21:19,179 --> 00:21:20,919
and all these devices are internet

565
00:21:20,919 --> 00:21:23,049
connected which is great and they

566
00:21:23,049 --> 00:21:24,789
communicate through various devices and

567
00:21:24,789 --> 00:21:27,549
their me home app if you have that so if

568
00:21:27,549 --> 00:21:29,740
you have a device which needs to send an

569
00:21:29,740 --> 00:21:31,269
alert to your phone it will ping the

570
00:21:31,269 --> 00:21:32,440
cloud it will come down to your phone

571
00:21:32,440 --> 00:21:34,419
and the app will tell you that something

572
00:21:34,419 --> 00:21:37,240
has happened as you as you know so in

573
00:21:37,240 --> 00:21:39,130
this case the hen box malware is relying

574
00:21:39,130 --> 00:21:40,779
on those kind of events as well to

575
00:21:40,779 --> 00:21:44,889
trigger the malware in terms of

576
00:21:44,889 --> 00:21:46,809
objective is it's all the usual suspects

577
00:21:46,809 --> 00:21:49,029
really for a kind of espionage or

578
00:21:49,029 --> 00:21:51,340
spyware Android apps so registering SMS

579
00:21:51,340 --> 00:21:53,019
handlers for processing incoming SMS

580
00:21:53,019 --> 00:21:55,059
messages monitoring the device

581
00:21:55,059 --> 00:21:57,220
monitoring outgoing phone calls and at

582
00:21:57,220 --> 00:21:59,049
least up until recently it was only

583
00:21:59,049 --> 00:22:02,350
focused on Chinese numbers +86 tracking

584
00:22:02,350 --> 00:22:05,039
location and reading from various apps

585
00:22:05,039 --> 00:22:07,059
so this sample that was in

586
00:22:07,059 --> 00:22:09,820
very early 2018 covered 13 different

587
00:22:09,820 --> 00:22:12,009
apps that they were trying to find if

588
00:22:12,009 --> 00:22:14,289
they were installed and extract contacts

589
00:22:14,289 --> 00:22:17,590
and message details from in many cases

590
00:22:17,590 --> 00:22:19,480
it's just it's as easy as getting horde

591
00:22:19,480 --> 00:22:21,460
of the SQLite database on the device

592
00:22:21,460 --> 00:22:23,259
opening it up running some database

593
00:22:23,259 --> 00:22:25,690
queries and gathering that data and

594
00:22:25,690 --> 00:22:27,220
about four months prior to this version

595
00:22:27,220 --> 00:22:28,870
they only had two apps that they were

596
00:22:28,870 --> 00:22:29,830
tracking there's quite an aggressive

597
00:22:29,830 --> 00:22:31,779
development schedule in four months to

598
00:22:31,779 --> 00:22:36,070
add like in another another 11 apps so

599
00:22:36,070 --> 00:22:37,539
in terms of the recent campaigns back to

600
00:22:37,539 --> 00:22:39,279
the map again we've we found a new you

601
00:22:39,279 --> 00:22:41,740
know piece of infrastructure and related

602
00:22:41,740 --> 00:22:42,970
samples so we're going to dig into that

603
00:22:42,970 --> 00:22:47,379
in a minute so we saw this originally

604
00:22:47,379 --> 00:22:49,029
from a tweet and if you don't follow if

605
00:22:49,029 --> 00:22:50,200
you're not on Twitter it's a pretty good

606
00:22:50,200 --> 00:22:51,759
threat Intel source at the moment and

607
00:22:51,759 --> 00:22:53,499
people are posting hashes and domain

608
00:22:53,499 --> 00:22:55,419
names all over the place so it's good

609
00:22:55,419 --> 00:22:58,779
it's a good feed in this case we saw an

610
00:22:58,779 --> 00:23:01,259
lnk file various executables

611
00:23:01,259 --> 00:23:03,399
including in the monke earlier one there

612
00:23:03,399 --> 00:23:06,759
and a C - Apple - Netcom with a few

613
00:23:06,759 --> 00:23:07,929
pictures there so definitely like a

614
00:23:07,929 --> 00:23:10,179
Vietnam looking or Vietnamese looking

615
00:23:10,179 --> 00:23:12,999
decoy doc what seems to be Pakistan and

616
00:23:12,999 --> 00:23:16,899
also Mongolia as well so when we looked

617
00:23:16,899 --> 00:23:18,610
in our in our dataset we had a couple of

618
00:23:18,610 --> 00:23:21,639
samples plug X samples related to August

619
00:23:21,639 --> 00:23:24,549
2019 looking at some behavior like the

620
00:23:24,549 --> 00:23:28,509
file activity around HTTP DLL and HTTP

621
00:23:28,509 --> 00:23:32,619
dot we found a few more samples as well

622
00:23:32,619 --> 00:23:34,240
but dating back to about June I think

623
00:23:34,240 --> 00:23:36,249
this year and we also uncovered a couple

624
00:23:36,249 --> 00:23:38,200
of IPs that were being communicated to

625
00:23:38,200 --> 00:23:41,169
directly from this malware rather than

626
00:23:41,169 --> 00:23:45,460
the Apple - Netcom domain and we

627
00:23:45,460 --> 00:23:48,009
certainly saw that at the the Mongolian

628
00:23:48,009 --> 00:23:50,559
targeting so it's already been mentioned

629
00:23:50,559 --> 00:23:52,179
several times at least in the talks that

630
00:23:52,179 --> 00:23:53,919
I've seen this week that Google is your

631
00:23:53,919 --> 00:23:55,809
friend and quite often just simply

632
00:23:55,809 --> 00:23:57,399
googling stuff will give you the answers

633
00:23:57,399 --> 00:23:59,980
you need in this case there was a github

634
00:23:59,980 --> 00:24:01,840
repository where someone had posted a

635
00:24:01,840 --> 00:24:03,850
write-up including tons of either

636
00:24:03,850 --> 00:24:06,029
screenshots and other stuff about

637
00:24:06,029 --> 00:24:08,619
unknown Chinese apt it was called

638
00:24:08,619 --> 00:24:12,759
stranger strange real Intel and in this

639
00:24:12,759 --> 00:24:13,960
case they talked about the same kind of

640
00:24:13,960 --> 00:24:15,580
files or same file names that provide

641
00:24:15,580 --> 00:24:17,950
some hashes I've heard there's something

642
00:24:17,950 --> 00:24:21,220
like 36 ESET people here this at this

643
00:24:21,220 --> 00:24:24,250
conference which is insane but you know

644
00:24:24,250 --> 00:24:25,809
digging a bit deeper into this file we

645
00:24:25,809 --> 00:24:27,970
found that one of the files being used

646
00:24:27,970 --> 00:24:29,830
to sideload this malware was a was a

647
00:24:29,830 --> 00:24:32,740
benign signed ESET binary so if you

648
00:24:32,740 --> 00:24:34,149
haven't seen this then you know here's

649
00:24:34,149 --> 00:24:37,629
the hash and we can talk about it so

650
00:24:37,629 --> 00:24:38,950
that was loading the malware we've seen

651
00:24:38,950 --> 00:24:40,809
possible Pakistan targeting based on the

652
00:24:40,809 --> 00:24:42,519
decoy documents there the special branch

653
00:24:42,519 --> 00:24:45,519
syntax e and these decoy documents like

654
00:24:45,519 --> 00:24:48,369
4050 page very heavy policy government

655
00:24:48,369 --> 00:24:49,659
documents that are embedded in the

656
00:24:49,659 --> 00:24:51,850
malware that have thrown up as a as a

657
00:24:51,850 --> 00:24:54,100
decoy to to believe that is the right

658
00:24:54,100 --> 00:24:56,200
thing you're looking at and the lnk file

659
00:24:56,200 --> 00:24:57,399
we've seen looks like the part of

660
00:24:57,399 --> 00:25:01,149
vietnam targeting and it's a shortcut

661
00:25:01,149 --> 00:25:02,440
file but in this case hasn't been

662
00:25:02,440 --> 00:25:08,529
appended HTA and VBS code as well back

663
00:25:08,529 --> 00:25:10,509
in july some people from the US I think

664
00:25:10,509 --> 00:25:12,700
the assistant to the president were

665
00:25:12,700 --> 00:25:14,830
there to talk we're in Mongolia actually

666
00:25:14,830 --> 00:25:18,580
to talk about economic trade and also

667
00:25:18,580 --> 00:25:20,679
the security concept stuff so that

668
00:25:20,679 --> 00:25:22,330
definitely ties in with a lot of the

669
00:25:22,330 --> 00:25:25,179
that first file in that malware in

670
00:25:25,179 --> 00:25:27,639
targeting and so if you've ever looked

671
00:25:27,639 --> 00:25:29,679
to L&K files they're incredible and

672
00:25:29,679 --> 00:25:31,690
there's so much data inside them like

673
00:25:31,690 --> 00:25:33,909
MAC addresses of the computer that

674
00:25:33,909 --> 00:25:35,830
created the lnk file there's host names

675
00:25:35,830 --> 00:25:38,109
as various other things and in this case

676
00:25:38,109 --> 00:25:41,109
above that red box is the original lnk

677
00:25:41,109 --> 00:25:42,609
file and then you've got this appended

678
00:25:42,609 --> 00:25:46,269
HT a hypertext application code with VBS

679
00:25:46,269 --> 00:25:48,669
code and then you know very interesting

680
00:25:48,669 --> 00:25:51,700
looking for d5a or MZ header for the for

681
00:25:51,700 --> 00:25:54,279
the payload which is going to be run if

682
00:25:54,279 --> 00:25:55,629
you look at the properties of the file

683
00:25:55,629 --> 00:25:57,639
you can see a very interesting

684
00:25:57,639 --> 00:25:59,320
command-line argument there that's

685
00:25:59,320 --> 00:26:00,549
basically looping around trying to

686
00:26:00,549 --> 00:26:04,690
execute that HTA and the VBS and you've

687
00:26:04,690 --> 00:26:07,269
also got the host name there so you can

688
00:26:07,269 --> 00:26:08,769
write yarra signatures and do loads of

689
00:26:08,769 --> 00:26:10,840
other retro hunting and with this kind

690
00:26:10,840 --> 00:26:13,149
of information for us we've got a whole

691
00:26:13,149 --> 00:26:14,649
bunch of alien kay files and we can we

692
00:26:14,649 --> 00:26:17,109
can do some DB queries on them but we've

693
00:26:17,109 --> 00:26:19,299
seen these two other files coming from

694
00:26:19,299 --> 00:26:21,850
the same host name that host name there

695
00:26:21,850 --> 00:26:24,220
and they were related to the UN Security

696
00:26:24,220 --> 00:26:26,500
Council and also some other Mayan mark

697
00:26:26,500 --> 00:26:29,700
related targeting

698
00:26:29,830 --> 00:26:31,000
if you look at some of the code in there

699
00:26:31,000 --> 00:26:32,409
there are patterns like starting a

700
00:26:32,409 --> 00:26:34,539
window ir and you know these for loop

701
00:26:34,539 --> 00:26:35,590
these nested for-loops

702
00:26:35,590 --> 00:26:37,630
so if we start looking at that and just

703
00:26:37,630 --> 00:26:39,880
say show me all the filenames where this

704
00:26:39,880 --> 00:26:41,289
activity is happening we've seen a ton

705
00:26:41,289 --> 00:26:43,450
of other lnk files mostly with vietnam

706
00:26:43,450 --> 00:26:45,880
targeting so that low confidence vietnam

707
00:26:45,880 --> 00:26:47,980
targeting is starting to come up in our

708
00:26:47,980 --> 00:26:50,710
view and if we actually look at host

709
00:26:50,710 --> 00:26:54,250
names using that same a command we can

710
00:26:54,250 --> 00:26:55,840
then see you know there's four well

711
00:26:55,840 --> 00:26:58,000
three other new windows host names

712
00:26:58,000 --> 00:27:00,159
creating Ln case with that same dodging

713
00:27:00,159 --> 00:27:02,830
command-line and the host names are very

714
00:27:02,830 --> 00:27:04,570
similar notations which looks like a

715
00:27:04,570 --> 00:27:07,240
default Windows install so here we're

716
00:27:07,240 --> 00:27:08,889
just trying to unravel this and pivot

717
00:27:08,889 --> 00:27:10,539
out more and find more samples but it's

718
00:27:10,539 --> 00:27:14,049
incredibly interesting stuff so I think

719
00:27:14,049 --> 00:27:15,820
I have a couple minutes left I just want

720
00:27:15,820 --> 00:27:17,350
to quickly go into adversary' playbooks

721
00:27:17,350 --> 00:27:18,789
and how he's try and share a lot of this

722
00:27:18,789 --> 00:27:20,230
information with the community so

723
00:27:20,230 --> 00:27:22,779
actually I think last night the the PK

724
00:27:22,779 --> 00:27:25,690
plug adversary' play but went live so

725
00:27:25,690 --> 00:27:27,460
it's a Styx 2.0 package with all the

726
00:27:27,460 --> 00:27:29,679
indicators for all those six or seven

727
00:27:29,679 --> 00:27:31,320
campaigns that I've talked about

728
00:27:31,320 --> 00:27:33,820
hundreds of domains and IPS so you know

729
00:27:33,820 --> 00:27:36,340
don't grab it it's on github and will

730
00:27:36,340 --> 00:27:39,460
show you the link in a sec when every

731
00:27:39,460 --> 00:27:41,289
time publish a blog in unit 42 which I'm

732
00:27:41,289 --> 00:27:43,380
publish an Associated playbook which is

733
00:27:43,380 --> 00:27:46,240
describing an actor if we already have

734
00:27:46,240 --> 00:27:47,529
the playbook that we just add another

735
00:27:47,529 --> 00:27:49,809
play in or another campaign into that

736
00:27:49,809 --> 00:27:51,909
playbook and recently we published a

737
00:27:51,909 --> 00:27:54,190
blog with a with it with eleven new play

738
00:27:54,190 --> 00:27:55,840
books and then we published one last

739
00:27:55,840 --> 00:27:57,610
night so if you recognize any of the

740
00:27:57,610 --> 00:27:58,779
actor names here and you want to go and

741
00:27:58,779 --> 00:28:00,760
have a poke around and get hub then

742
00:28:00,760 --> 00:28:04,779
please do so this is how it roughly

743
00:28:04,779 --> 00:28:06,399
works we use the attack lifecycle the

744
00:28:06,399 --> 00:28:08,019
cyber kill chain is a framework to

745
00:28:08,019 --> 00:28:10,350
describe how this stuff plays out across

746
00:28:10,350 --> 00:28:13,210
different phases we use miter attack to

747
00:28:13,210 --> 00:28:17,500
describe the TTP's of the actor and we

748
00:28:17,500 --> 00:28:19,539
use sticks 2.0 the Jason version with

749
00:28:19,539 --> 00:28:21,070
lots of other features to wrap the whole

750
00:28:21,070 --> 00:28:23,139
thing up so looking at it another way

751
00:28:23,139 --> 00:28:25,059
you can say you've got one adversary at

752
00:28:25,059 --> 00:28:27,159
the top there every adversary has one or

753
00:28:27,159 --> 00:28:29,799
more campaigns or plays or attack

754
00:28:29,799 --> 00:28:32,320
lifecycle instances there's lots of what

755
00:28:32,320 --> 00:28:33,909
tactics that they have and there's lots

756
00:28:33,909 --> 00:28:36,039
of indicators and the way that this maps

757
00:28:36,039 --> 00:28:38,139
to adversity playbooks is you've got the

758
00:28:38,139 --> 00:28:39,850
playbook at the top so you have one per

759
00:28:39,850 --> 00:28:40,509
actor

760
00:28:40,509 --> 00:28:42,669
multiple plays one or more play per

761
00:28:42,669 --> 00:28:44,950
actor we're using attack to describe the

762
00:28:44,950 --> 00:28:47,019
TTP's and then you know all the usual

763
00:28:47,019 --> 00:28:49,299
stuff hashes and IPs and other stuff in

764
00:28:49,299 --> 00:28:50,950
there as well and the whole lot wrapped

765
00:28:50,950 --> 00:28:53,019
up in sticks so if you consume threat

766
00:28:53,019 --> 00:28:54,369
intelligence today you can go and grab

767
00:28:54,369 --> 00:28:56,440
these and just pull them in and take all

768
00:28:56,440 --> 00:29:00,359
the the data we're giving you and if you

769
00:29:00,359 --> 00:29:02,730
if you don't then you can start doing it

770
00:29:02,730 --> 00:29:05,139
so there's the the link for the PlayBook

771
00:29:05,139 --> 00:29:06,999
viewer just because humans aren't very

772
00:29:06,999 --> 00:29:09,879
good at parsing JSON and sticks we

773
00:29:09,879 --> 00:29:11,230
created a viewer here so you can go and

774
00:29:11,230 --> 00:29:12,850
click around look at the different

775
00:29:12,850 --> 00:29:15,039
actors look at the campaign's drill down

776
00:29:15,039 --> 00:29:17,200
into the into the different TTP's as per

777
00:29:17,200 --> 00:29:19,659
mightor and then look at the indicators

778
00:29:19,659 --> 00:29:23,730
as well so I'm being told that's time

779
00:29:23,730 --> 00:29:27,320
and that is actually thank you

780
00:29:27,320 --> 00:29:32,070
[Music]

781
00:29:32,070 --> 00:29:34,369
[Applause]

