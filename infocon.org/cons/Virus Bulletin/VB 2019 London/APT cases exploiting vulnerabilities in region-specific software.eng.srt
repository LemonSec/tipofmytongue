1
00:00:00,030 --> 00:00:04,589
welcome back to the red-room basically

2
00:00:04,589 --> 00:00:07,680
ii talk in this room of the day we're

3
00:00:07,680 --> 00:00:09,990
going to continue our theme with very

4
00:00:09,990 --> 00:00:11,910
specialized very targeted or very

5
00:00:11,910 --> 00:00:15,379
national apts and the next talk will

6
00:00:15,379 --> 00:00:19,949
will be it's how you titled apt cases

7
00:00:19,949 --> 00:00:21,779
exploiting vulnerabilities in region

8
00:00:21,779 --> 00:00:23,850
specific software and and in this case

9
00:00:23,850 --> 00:00:26,430
the region seems to be mainly japan we

10
00:00:26,430 --> 00:00:29,880
have four authors here we have jose

11
00:00:29,880 --> 00:00:36,480
Toman tomonaga tomonaga Tamaki tani we

12
00:00:36,480 --> 00:00:40,100
have here oh she's sir I do

13
00:00:40,100 --> 00:00:43,079
so Aida sorry about this

14
00:00:43,079 --> 00:00:47,280
and what we're oh hush takahashi gosh

15
00:00:47,280 --> 00:00:49,079
and I just spent three weeks in Japan

16
00:00:49,079 --> 00:00:50,660
can you believe that

17
00:00:50,660 --> 00:00:53,129
but the speakers today are going to be

18
00:00:53,129 --> 00:00:57,930
show season and Tomoaki SN and they're

19
00:00:57,930 --> 00:01:00,149
going to be talking about their

20
00:01:00,149 --> 00:01:02,430
experiences with with apts in Japan

21
00:01:02,430 --> 00:01:04,390
welcome on stage

22
00:01:04,390 --> 00:01:06,050
[Applause]

23
00:01:06,050 --> 00:01:08,280
[Music]

24
00:01:08,280 --> 00:01:11,430
[Applause]

25
00:01:11,430 --> 00:01:14,140
okay thank you very much for the

26
00:01:14,140 --> 00:01:16,840
introduction and I'm tamaki Thani from

27
00:01:16,840 --> 00:01:19,540
JP SAR and our presentation today it's

28
00:01:19,540 --> 00:01:25,090
about a PD case case study in Japan okay

29
00:01:25,090 --> 00:01:27,160
let me introduce about ourselves

30
00:01:27,160 --> 00:01:32,170
Suzy and I came from JP Thor and our

31
00:01:32,170 --> 00:01:35,140
responsibility or D F IR and malware

32
00:01:35,140 --> 00:01:38,140
analysis we have posted our researches

33
00:01:38,140 --> 00:01:41,440
and some tools for DF IR and malware RS

34
00:01:41,440 --> 00:01:44,530
is on our blog and github so please

35
00:01:44,530 --> 00:01:45,899
check it out

36
00:01:45,899 --> 00:01:49,960
ok let's move on to the main topic of

37
00:01:49,960 --> 00:01:53,140
today's topic apt case case is

38
00:01:53,140 --> 00:01:55,180
exploiting vulnerabilities in region

39
00:01:55,180 --> 00:01:58,720
specific software as you know a B

40
00:01:58,720 --> 00:02:01,539
attacks often liberate software

41
00:02:01,539 --> 00:02:04,420
vulnerabilities to infect victims with

42
00:02:04,420 --> 00:02:07,750
malware software is as that is often

43
00:02:07,750 --> 00:02:10,630
targeted includes Microsoft Office or

44
00:02:10,630 --> 00:02:13,600
Internet Explorer or I'll be flash

45
00:02:13,600 --> 00:02:16,239
players which is commonly used than

46
00:02:16,239 --> 00:02:19,390
anywhere on the other hand in some APD

47
00:02:19,390 --> 00:02:21,880
case campaigns attackers are care

48
00:02:21,880 --> 00:02:24,220
attacks carries are carried out by

49
00:02:24,220 --> 00:02:27,580
exploiting vulnerabilities in a region

50
00:02:27,580 --> 00:02:30,430
specific software furthermore the

51
00:02:30,430 --> 00:02:32,739
government age is he frequently use such

52
00:02:32,739 --> 00:02:35,860
local software and this tends to be

53
00:02:35,860 --> 00:02:38,860
targeted these attack cases are real

54
00:02:38,860 --> 00:02:41,260
rarely discussed in international

55
00:02:41,260 --> 00:02:44,260
conference as the issue is exclusive to

56
00:02:44,260 --> 00:02:46,750
a certain country however it is

57
00:02:46,750 --> 00:02:49,480
important to understand the detail of

58
00:02:49,480 --> 00:02:52,030
such attack cases in determining

59
00:02:52,030 --> 00:02:56,590
countermeasures ok in Japan there are

60
00:02:56,590 --> 00:02:59,500
many cases where where attacks were

61
00:02:59,500 --> 00:03:00,790
carried out by exploiting

62
00:03:00,790 --> 00:03:03,160
vulnerabilities in software that is only

63
00:03:03,160 --> 00:03:06,430
used in Japan also the malware used in

64
00:03:06,430 --> 00:03:11,190
the attacks was unique to Japan

65
00:03:11,730 --> 00:03:15,730
ok so the goal of this presentation is

66
00:03:15,730 --> 00:03:19,319
to share attack examples where

67
00:03:19,319 --> 00:03:25,140
region-specific software is leverage ok

68
00:03:25,140 --> 00:03:27,900
here is a topic for today's presentation

69
00:03:27,900 --> 00:03:30,750
we'll talk about poor APD cases leverage

70
00:03:30,750 --> 00:03:33,260
region specific software vulnerabilities

71
00:03:33,260 --> 00:03:36,209
first two cases a little bit old cases

72
00:03:36,209 --> 00:03:39,450
and the later two cases is a recent

73
00:03:39,450 --> 00:03:40,049
cases

74
00:03:40,049 --> 00:03:42,629
so finally we will show charge state

75
00:03:42,629 --> 00:03:46,680
characteristic GDP for the ABT campaigns

76
00:03:46,680 --> 00:03:50,730
targeting japan okay let's move on to

77
00:03:50,730 --> 00:03:53,760
the first case sans rose about the

78
00:03:53,760 --> 00:03:56,819
beauty may be and everyone don't know

79
00:03:56,819 --> 00:03:58,319
what is sensible so i'd like to explain

80
00:03:58,319 --> 00:04:00,569
a little bit about science row satchel

81
00:04:00,569 --> 00:04:03,750
is a spreadsheet application similar to

82
00:04:03,750 --> 00:04:06,629
Microsoft X Excel now you can find a

83
00:04:06,629 --> 00:04:08,790
screenshot of the stands row on the

84
00:04:08,790 --> 00:04:11,640
right part of the slide and you can find

85
00:04:11,640 --> 00:04:13,290
it it's very very similar to Microsoft

86
00:04:13,290 --> 00:04:15,810
Excel and it's not a copy it's just a

87
00:04:15,810 --> 00:04:20,910
Japanese Microsoft Excel so yeah so this

88
00:04:20,910 --> 00:04:23,190
application was widely used in Japan

89
00:04:23,190 --> 00:04:25,889
especially in Japanese government agency

90
00:04:25,889 --> 00:04:29,970
and educational sector sector and the

91
00:04:29,970 --> 00:04:33,030
ABT attacker used has reveled a zero-day

92
00:04:33,030 --> 00:04:36,090
exploit in december 2013 and that

93
00:04:36,090 --> 00:04:38,669
vulnerability was disclosed in january

94
00:04:38,669 --> 00:04:39,960
2014

95
00:04:39,960 --> 00:04:43,590
this exploit was used with plug x a very

96
00:04:43,590 --> 00:04:47,280
very famous commercial malware and we

97
00:04:47,280 --> 00:04:49,169
were not and this time we were not able

98
00:04:49,169 --> 00:04:54,180
to determine which campaign it was okay

99
00:04:54,180 --> 00:04:59,070
the detail about this bond ability this

100
00:04:59,070 --> 00:05:00,840
spells ability allows executing

101
00:05:00,840 --> 00:05:03,419
arbitrary code after the user opened

102
00:05:03,419 --> 00:05:06,720
sasro document file of vulnerability

103
00:05:06,720 --> 00:05:10,950
originated in its lack of lack of data

104
00:05:10,950 --> 00:05:13,740
size validation and allows of writings

105
00:05:13,740 --> 00:05:16,470
return address of the stack frame and as

106
00:05:16,470 --> 00:05:19,949
a result our b3 code can be executed on

107
00:05:19,949 --> 00:05:22,430
the stack frame very very typical

108
00:05:22,430 --> 00:05:26,280
vulnerability this ball pin t was used

109
00:05:26,280 --> 00:05:28,650
in the case of an abd attack targeting

110
00:05:28,650 --> 00:05:31,320
japanese government agencies in this

111
00:05:31,320 --> 00:05:32,050
case

112
00:05:32,050 --> 00:05:34,629
the attacker sends a decoy sasro

113
00:05:34,629 --> 00:05:37,750
document with the zero they far do they

114
00:05:37,750 --> 00:05:42,520
exploit via spear phishing email the

115
00:05:42,520 --> 00:05:44,710
arbitrary code executed by the zoo they

116
00:05:44,710 --> 00:05:47,979
exploit was very simple windows circled

117
00:05:47,979 --> 00:05:50,979
with eggs or decode routing this show

118
00:05:50,979 --> 00:05:52,870
called simply decode the encoded data

119
00:05:52,870 --> 00:05:57,099
embedded and sastra document and encoded

120
00:05:57,099 --> 00:05:58,810
data on the central document was it

121
00:05:58,810 --> 00:06:01,419
projects and it was executed after user

122
00:06:01,419 --> 00:06:04,990
opens the decoy file without yeah using

123
00:06:04,990 --> 00:06:07,300
with you so you is opening with a

124
00:06:07,300 --> 00:06:11,560
central application the multiple plug X

125
00:06:11,560 --> 00:06:14,680
used in this case a communicate to the

126
00:06:14,680 --> 00:06:17,560
specific c2 server at the hard core is

127
00:06:17,560 --> 00:06:19,630
c2 server and an interesting point here

128
00:06:19,630 --> 00:06:23,949
is that several plug examples were

129
00:06:23,949 --> 00:06:26,469
connecting to the same server and but

130
00:06:26,469 --> 00:06:28,750
the exploit used to is acute the malware

131
00:06:28,750 --> 00:06:33,879
were different some of these exploit had

132
00:06:33,879 --> 00:06:36,520
used as zero-day exploit such a sensor

133
00:06:36,520 --> 00:06:39,099
escape which i mentioned now and it's

134
00:06:39,099 --> 00:06:42,090
our case i will show in the next case

135
00:06:42,090 --> 00:06:46,060
this this fact indicates that this actor

136
00:06:46,060 --> 00:06:48,400
was very very interested in japanese

137
00:06:48,400 --> 00:06:51,430
product and had a good skills to

138
00:06:51,430 --> 00:06:54,219
research and developing zero-day

139
00:06:54,219 --> 00:06:58,810
exploits ok let's go on to the second

140
00:06:58,810 --> 00:07:01,860
case targeting each star or maybe

141
00:07:01,860 --> 00:07:04,300
everyone doesn't know each star also i

142
00:07:04,300 --> 00:07:05,349
would like to explain a little bit about

143
00:07:05,349 --> 00:07:05,949
it

144
00:07:05,949 --> 00:07:08,860
and each taro is a japanese word

145
00:07:08,860 --> 00:07:12,009
processor similar to microsoft word and

146
00:07:12,009 --> 00:07:13,990
again it's not a copy product it's just

147
00:07:13,990 --> 00:07:17,800
a japanese microsoft word and it has

148
00:07:17,800 --> 00:07:21,039
been widely used in japanese government

149
00:07:21,039 --> 00:07:25,259
as well as a general user in in japan

150
00:07:25,259 --> 00:07:30,190
and unfortunately there was there were

151
00:07:30,190 --> 00:07:32,259
many many vulnerabilities leveraged as

152
00:07:32,259 --> 00:07:34,690
each star of zero day exploit in a PD

153
00:07:34,690 --> 00:07:40,659
campaign since 2010 and today I would

154
00:07:40,659 --> 00:07:44,880
like to show the case CVE 2014 7 to 4

155
00:07:44,880 --> 00:07:48,180
seven this probability had been used in

156
00:07:48,180 --> 00:07:51,540
November 2014 as zero day exploit by

157
00:07:51,540 --> 00:07:54,810
several apt camp campaigns and attacking

158
00:07:54,810 --> 00:07:57,450
campaigns using this vulnerability were

159
00:07:57,450 --> 00:08:03,540
blue termite and apt 17 okay this bound

160
00:08:03,540 --> 00:08:05,850
ability allows executing arbitrary code

161
00:08:05,850 --> 00:08:08,970
the same logic as the previous case I

162
00:08:08,970 --> 00:08:12,000
showed in the SAS row and it was used in

163
00:08:12,000 --> 00:08:14,010
the case of the APD attack targeting

164
00:08:14,010 --> 00:08:16,410
Japanese government agencies and

165
00:08:16,410 --> 00:08:20,370
Japanese enterprises submitted a method

166
00:08:20,370 --> 00:08:23,970
to deliver the exploit was spear

167
00:08:23,970 --> 00:08:26,370
phishing email and they had same as the

168
00:08:26,370 --> 00:08:29,130
same as I pray this show and the show

169
00:08:29,130 --> 00:08:32,340
called embedded in and it's not a

170
00:08:32,340 --> 00:08:36,409
qualifier was almost same as Santos case

171
00:08:36,409 --> 00:08:39,450
and a different point here it's that

172
00:08:39,450 --> 00:08:41,000
there were several types of malware

173
00:08:41,000 --> 00:08:44,850
embedded with this exploit one is MTB

174
00:08:44,850 --> 00:08:48,290
and one is plug X and one is a GT ID

175
00:08:48,290 --> 00:08:50,400
from here I would like to show the

176
00:08:50,400 --> 00:08:53,790
overview of the three mouths are these

177
00:08:53,790 --> 00:08:56,760
malware's okay

178
00:08:56,760 --> 00:09:00,870
MVP emily is a notorious malware used in

179
00:09:00,870 --> 00:09:03,330
a campaign blew termite and the

180
00:09:03,330 --> 00:09:05,400
infection was the infected the

181
00:09:05,400 --> 00:09:09,240
organization was over 100 organization

182
00:09:09,240 --> 00:09:12,420
in Japan a very huge impact that it made

183
00:09:12,420 --> 00:09:15,300
and this malware is managed with a

184
00:09:15,300 --> 00:09:17,460
version number by the attacker and you

185
00:09:17,460 --> 00:09:19,170
can find the number in the binary and

186
00:09:19,170 --> 00:09:23,430
two versions t 17 and T 20 we were

187
00:09:23,430 --> 00:09:26,040
mostly used in this campaign both our

188
00:09:26,040 --> 00:09:29,520
HDD bought with basic functions and t20

189
00:09:29,520 --> 00:09:32,790
was highly sophisticated and we believe

190
00:09:32,790 --> 00:09:35,640
T 70 is used for the initial infection

191
00:09:35,640 --> 00:09:38,550
and t20 is used for the second stage

192
00:09:38,550 --> 00:09:41,970
infection in some cases the targeted

193
00:09:41,970 --> 00:09:44,490
organizations proxy server address was

194
00:09:44,490 --> 00:09:49,640
hard-coded to the T 20s malware okay and

195
00:09:49,640 --> 00:09:51,990
blue to end in the blue tournament

196
00:09:51,990 --> 00:09:54,360
campaign several types of web server all

197
00:09:54,360 --> 00:09:57,820
installed in the C 2 server and used as

198
00:09:57,820 --> 00:10:00,220
kurz infrastructures such as this nation

199
00:10:00,220 --> 00:10:05,830
cost of MDB here is a website ample we

200
00:10:05,830 --> 00:10:10,780
found on the c2 server and another one

201
00:10:10,780 --> 00:10:13,900
and the most of the web shells were we

202
00:10:13,900 --> 00:10:16,990
observed when Anna was an open source

203
00:10:16,990 --> 00:10:19,630
tool and the zebra were located in Japan

204
00:10:19,630 --> 00:10:21,940
and they were compromised by the

205
00:10:21,940 --> 00:10:25,330
attacker in the campaign we believe they

206
00:10:25,330 --> 00:10:27,790
they use this server as a tier 1 c2

207
00:10:27,790 --> 00:10:30,160
server and there was another we believe

208
00:10:30,160 --> 00:10:34,930
another city to server tier 2 okay and

209
00:10:34,930 --> 00:10:37,990
the next malware the next malware is a

210
00:10:37,990 --> 00:10:41,860
CT ID and this malware was embedded with

211
00:10:41,860 --> 00:10:46,210
its own exploit and SETI T is a simple

212
00:10:46,210 --> 00:10:50,110
part communicate via HTTP this malware

213
00:10:50,110 --> 00:10:52,600
was used to attack Japanese enterprise

214
00:10:52,600 --> 00:10:56,470
and a pt-17 campaign the unique point of

215
00:10:56,470 --> 00:11:00,060
this malware is that have a unique HTTP

216
00:11:00,060 --> 00:11:04,450
HTTP header named ATT ID the belly of

217
00:11:04,450 --> 00:11:08,920
the HTTP a tid header was random or used

218
00:11:08,920 --> 00:11:12,370
for identify the victim this malware was

219
00:11:12,370 --> 00:11:15,070
used for the initial infection in a

220
00:11:15,070 --> 00:11:19,960
pt-17 campaign okay here is the

221
00:11:19,960 --> 00:11:22,420
attacking timeline of each Taro's zero

222
00:11:22,420 --> 00:11:25,660
day exploit the first malware plug X and

223
00:11:25,660 --> 00:11:28,900
MTV where as exploit was used on

224
00:11:28,900 --> 00:11:32,200
November 3rd 2014 in the blue termit

225
00:11:32,200 --> 00:11:35,110
campaign only after a very only after a

226
00:11:35,110 --> 00:11:38,200
very very short term later the apt 17

227
00:11:38,200 --> 00:11:41,350
campaign use the same zero they exploit

228
00:11:41,350 --> 00:11:44,920
with a GT Aidid it indicates that the

229
00:11:44,920 --> 00:11:47,110
exploit has shared with several campaign

230
00:11:47,110 --> 00:11:50,710
and possibly the actor behind this this

231
00:11:50,710 --> 00:11:53,410
cases were these cases were on a closed

232
00:11:53,410 --> 00:11:56,830
position we believe finally the product

233
00:11:56,830 --> 00:11:59,110
developer of each star announced the

234
00:11:59,110 --> 00:12:01,330
vulnerability and release the pets on

235
00:12:01,330 --> 00:12:03,360
November 14th

236
00:12:03,360 --> 00:12:06,580
ok from here I would like to switch to

237
00:12:06,580 --> 00:12:09,610
su SE and he will show the recent cases

238
00:12:09,610 --> 00:12:16,570
the power of the ABT circus is sky she

239
00:12:16,570 --> 00:12:21,430
cried appears by Nova Scotia cranberries

240
00:12:21,430 --> 00:12:23,140
evolved as a software asset management

241
00:12:23,140 --> 00:12:26,620
software sky she is a software that

242
00:12:26,620 --> 00:12:29,890
record rock overuse our prescient and is

243
00:12:29,890 --> 00:12:34,899
using many over the show in Japan this

244
00:12:34,899 --> 00:12:37,810
durable durability has been used spirit

245
00:12:37,810 --> 00:12:44,230
Maria infection from 2016 and 2019 other

246
00:12:44,230 --> 00:12:47,079
campaign using this minority called

247
00:12:47,079 --> 00:12:52,990
bronze Batra or tick this software has a

248
00:12:52,990 --> 00:12:56,800
remote code execution panoply sky she

249
00:12:56,800 --> 00:12:59,649
cry intelligently is controlled by the

250
00:12:59,649 --> 00:13:03,730
admin server the pot use for the

251
00:13:03,730 --> 00:13:10,079
correction is 5 to 3:05 UDP attack

252
00:13:10,079 --> 00:13:14,529
remote remotely control sketchy client

253
00:13:14,529 --> 00:13:18,100
agent by sending specified specifically

254
00:13:18,100 --> 00:13:21,880
crafted packet to this port however

255
00:13:21,880 --> 00:13:25,329
there's no important to the host

256
00:13:25,329 --> 00:13:28,779
instance of firewall because it is not

257
00:13:28,779 --> 00:13:33,490
accessible from Internet so how is the

258
00:13:33,490 --> 00:13:38,860
vulnerability related in this attack in

259
00:13:38,860 --> 00:13:42,760
Japan some mobile 500 has a global IP

260
00:13:42,760 --> 00:13:49,060
addresses such mobile 500 use the entry

261
00:13:49,060 --> 00:13:53,170
point of the Maria into a host mental

262
00:13:53,170 --> 00:13:55,180
barrier infected the device is connected

263
00:13:55,180 --> 00:13:58,449
to the corporate network the Mario in

264
00:13:58,449 --> 00:14:02,050
the infection also spread to the

265
00:14:02,050 --> 00:14:08,040
networks this graph shows the trend

266
00:14:08,040 --> 00:14:11,050
scaling activity which starting in the

267
00:14:11,050 --> 00:14:14,050
dis one ability this is a nurse's

268
00:14:14,050 --> 00:14:17,220
through trauma which is joining the tour

269
00:14:17,220 --> 00:14:19,290
monitoring system that JP Sato

270
00:14:19,290 --> 00:14:23,399
operations we wrote a blog article about

271
00:14:23,399 --> 00:14:27,529
this vulnerability in favorite 2019 and

272
00:14:27,529 --> 00:14:33,079
since then the talk activity had stopped

273
00:14:33,079 --> 00:14:36,439
this collectivity has two different

274
00:14:36,439 --> 00:14:39,029
characteristic from other scan

275
00:14:39,029 --> 00:14:47,069
activities first this activity is only

276
00:14:47,069 --> 00:14:49,529
observed on the sense of Preston in

277
00:14:49,529 --> 00:14:53,310
Japan including that attacker is

278
00:14:53,310 --> 00:14:57,979
targeting IP address or KT to Java

279
00:14:58,009 --> 00:15:02,639
second the remote export attacker latest

280
00:15:02,639 --> 00:15:06,629
from wrong time but three there are only

281
00:15:06,629 --> 00:15:14,879
three addresses attack group runs

282
00:15:14,879 --> 00:15:17,910
battery voltage disparity to spread

283
00:15:17,910 --> 00:15:25,110
multi Marya infection the first is VAR e

284
00:15:25,110 --> 00:15:29,040
what is the downloader this Maria has a

285
00:15:29,040 --> 00:15:33,149
function to execute partial common Marie

286
00:15:33,149 --> 00:15:36,329
receive the script the character hosting

287
00:15:36,329 --> 00:15:42,139
environment information second is

288
00:15:42,139 --> 00:15:45,600
shmurda Roda this dollar died only

289
00:15:45,600 --> 00:15:47,850
download and there is a queue to be

290
00:15:47,850 --> 00:15:48,439
fired

291
00:15:48,439 --> 00:15:52,199
when this Maria is executed it toward

292
00:15:52,199 --> 00:15:58,128
page 64 encoded rat called exact same M

293
00:15:59,959 --> 00:16:03,959
so there is no trod the order to return

294
00:16:03,959 --> 00:16:07,139
in Java 6 JavaScript and

295
00:16:07,139 --> 00:16:11,339
no juice this Maria is much beautiful

296
00:16:11,339 --> 00:16:13,949
Maria which operation in any environment

297
00:16:13,949 --> 00:16:20,069
as long as Rogers is installed Linux Mac

298
00:16:20,069 --> 00:16:25,919
OS and Windows this Maria is the node

299
00:16:25,919 --> 00:16:29,639
dot exe on the host because node.js is

300
00:16:29,639 --> 00:16:36,709
not installed on Windows the

301
00:16:36,709 --> 00:16:39,839
infrastructure used for this attack has

302
00:16:39,839 --> 00:16:43,470
four futures after destroyed we will

303
00:16:43,470 --> 00:16:48,720
introduce some features the city father

304
00:16:48,720 --> 00:16:52,919
is written in PHP if you compare of

305
00:16:52,919 --> 00:16:55,739
Mario States called there are some

306
00:16:55,739 --> 00:17:03,079
similar calls compromised the website

307
00:17:03,079 --> 00:17:07,380
uses cheetah servers the websites are

308
00:17:07,380 --> 00:17:11,699
embedded with index or the dot PHP which

309
00:17:11,699 --> 00:17:14,909
called the access log of those who visit

310
00:17:14,909 --> 00:17:18,299
the website it seems that attacker

311
00:17:18,299 --> 00:17:20,819
contact watering for attack using

312
00:17:20,819 --> 00:17:28,159
disorder this is an example the log file

313
00:17:28,159 --> 00:17:31,760
IP address and the user is it a record

314
00:17:31,760 --> 00:17:39,990
in this world so final cases the Trend

315
00:17:39,990 --> 00:17:42,000
Micro barrios pasta corporate relations

316
00:17:42,000 --> 00:17:46,230
board ability various foster cooperation

317
00:17:46,230 --> 00:17:49,830
is Trend Micro's cooperate and parse

318
00:17:49,830 --> 00:17:53,399
software's order in Japan this durable

319
00:17:53,399 --> 00:17:56,490
derivative was using in April of this

320
00:17:56,490 --> 00:18:01,710
year we don't know if this attack was

321
00:18:01,710 --> 00:18:04,770
conducted as part of the campaign

322
00:18:04,770 --> 00:18:11,040
the witch campaign it was this banner it

323
00:18:11,040 --> 00:18:13,680
is a directory traversal Parvati in

324
00:18:13,680 --> 00:18:17,760
Paris pasta admissible attack infected

325
00:18:17,760 --> 00:18:20,670
host of is Marriott by some means and

326
00:18:20,670 --> 00:18:23,580
after they exploit this vulnerability to

327
00:18:23,580 --> 00:18:28,620
escalate the privileges after the

328
00:18:28,620 --> 00:18:31,950
excavation the Turk able to take over

329
00:18:31,950 --> 00:18:34,860
the active directory to conduct or

330
00:18:34,860 --> 00:18:41,970
attract moment if various postal Mustafa

331
00:18:41,970 --> 00:18:45,360
is compromised dear the fire is

332
00:18:45,360 --> 00:18:49,620
distributed to crayons this dealer set

333
00:18:49,620 --> 00:18:55,650
up RDP correction this is an example of

334
00:18:55,650 --> 00:19:00,750
RDP set of common it's executed their

335
00:19:00,750 --> 00:19:05,220
command to change registry the phosphor

336
00:19:05,220 --> 00:19:09,300
enable RDP connection from remote remote

337
00:19:09,300 --> 00:19:15,960
host after that attack the infected host

338
00:19:15,960 --> 00:19:20,340
with Mario other type of debauch help

339
00:19:20,340 --> 00:19:24,900
the area downloaded and executed partial

340
00:19:24,900 --> 00:19:30,440
Mario partial Maria is called posted

341
00:19:30,440 --> 00:19:34,260
this Maria is saved as XML file in

342
00:19:34,260 --> 00:19:40,200
system straighten posture is best secure

343
00:19:40,200 --> 00:19:45,330
and called and included in XML file this

344
00:19:45,330 --> 00:19:51,020
extra XML file is executed from msbuild

345
00:19:51,950 --> 00:19:56,430
post it is a possibility remote access

346
00:19:56,430 --> 00:20:01,020
to it is a very own github and anyone

347
00:20:01,020 --> 00:20:03,830
can use it

348
00:20:07,100 --> 00:20:10,100
well the future of the district is that

349
00:20:10,100 --> 00:20:13,789
the server is Microsoft Oh

350
00:20:13,789 --> 00:20:17,630
Arthur and the Google Code this means

351
00:20:17,630 --> 00:20:20,840
that my Mario Mario trophy is a header

352
00:20:20,840 --> 00:20:26,320
on Microsoft on current topics

353
00:20:28,090 --> 00:20:31,509
so after this side we will introduce

354
00:20:31,509 --> 00:20:37,240
TTP's of apathy campaign targeting Japan

355
00:20:37,630 --> 00:20:40,549
there have been many a pity campaign

356
00:20:40,549 --> 00:20:44,299
targeting Japan among them we introduced

357
00:20:44,299 --> 00:20:49,330
a characteristic TTP's of apt 17

358
00:20:49,330 --> 00:20:55,759
ultimate and burns what role first both

359
00:20:55,759 --> 00:21:00,649
apt 17 apt 70 is known for its party

360
00:21:00,649 --> 00:21:03,620
over TD pieces such as domain name

361
00:21:03,620 --> 00:21:11,450
hijacking suppression attacks this is an

362
00:21:11,450 --> 00:21:13,159
example of the supply chain attack

363
00:21:13,159 --> 00:21:17,659
observed in Japan where IP tables was

364
00:21:17,659 --> 00:21:21,080
compromised IP table of the software

365
00:21:21,080 --> 00:21:23,990
update server was mated to redirect the

366
00:21:23,990 --> 00:21:30,230
user to a fake update server this is an

367
00:21:30,230 --> 00:21:34,789
example the IP service common in this

368
00:21:34,789 --> 00:21:40,070
type of attack the update file in cell

369
00:21:40,070 --> 00:21:43,460
phones the server is not compromised at

370
00:21:43,460 --> 00:21:46,909
all it is difficult to recognize that

371
00:21:46,909 --> 00:21:54,049
the server is compromised next do I name

372
00:21:54,049 --> 00:21:58,309
hijacking apt 17 compromised NS record

373
00:21:58,309 --> 00:22:01,639
all first so that the DNS query is

374
00:22:01,639 --> 00:22:04,070
redirected to effect dear asawa

375
00:22:04,070 --> 00:22:08,669
a virtual user are redirected to

376
00:22:08,669 --> 00:22:16,109
fake web server so iptables was also

377
00:22:16,109 --> 00:22:18,559
used in this attack

378
00:22:18,559 --> 00:22:23,100
if the historical is atado all the DNS

379
00:22:23,100 --> 00:22:25,799
query will be redirect to a fake DNS

380
00:22:25,799 --> 00:22:31,320
server so at me of the dish net website

381
00:22:31,320 --> 00:22:34,700
abuse noticed a change

382
00:22:34,700 --> 00:22:37,350
therefore Parker configure the DNS

383
00:22:37,350 --> 00:22:41,759
service so that query for specific sub

384
00:22:41,759 --> 00:22:44,009
domain will be redirected to a fake wave

385
00:22:44,009 --> 00:22:49,139
server where although relieve our handle

386
00:22:49,139 --> 00:22:52,519
as normal

387
00:22:53,690 --> 00:22:57,749
next is ultimate ultimate campaign used

388
00:22:57,749 --> 00:23:03,359
by us TTP's for a tournament there are

389
00:23:03,359 --> 00:23:05,549
the examples are at a moment

390
00:23:05,549 --> 00:23:11,489
Tarek's user user intimate campaign fake

391
00:23:11,489 --> 00:23:17,730
develop art is outstanding future the

392
00:23:17,730 --> 00:23:20,249
report protocol is used to automatically

393
00:23:20,249 --> 00:23:22,070
provide approach if emerged

394
00:23:22,070 --> 00:23:25,759
configuration to host on the network

395
00:23:25,759 --> 00:23:29,369
the official script of the report is

396
00:23:29,369 --> 00:23:32,759
automatically of time the host from

397
00:23:32,759 --> 00:23:35,129
which the configuration script is

398
00:23:35,129 --> 00:23:38,629
obtained the camp is specified by the

399
00:23:38,629 --> 00:23:43,350
DHCP server if no sava is specified the

400
00:23:43,350 --> 00:23:49,189
current will access domain WD

401
00:23:53,529 --> 00:23:56,479
the attacker abilities this future and

402
00:23:56,479 --> 00:23:59,629
the conductor talked to disguise itself

403
00:23:59,629 --> 00:24:04,159
as fixed their part even is an

404
00:24:04,159 --> 00:24:06,799
environment where the reporter is not

405
00:24:06,799 --> 00:24:10,700
used at a cacao obtained configuration

406
00:24:10,700 --> 00:24:12,519
script based on the brothers

407
00:24:12,519 --> 00:24:17,989
configuration fake developed parts of a

408
00:24:17,989 --> 00:24:21,399
fake replied to values a host pretending

409
00:24:21,399 --> 00:24:29,359
proxy use proxy server after that the

410
00:24:29,359 --> 00:24:32,029
crowd to view access effect up fats have

411
00:24:32,029 --> 00:24:35,200
as a proxy very accessing the web server

412
00:24:35,200 --> 00:24:38,659
Victor Potts Ave is site much as I am

413
00:24:38,659 --> 00:24:41,239
into web contents to redirect the user

414
00:24:41,239 --> 00:24:44,169
to other web server and the conductor

415
00:24:44,169 --> 00:24:48,799
divided drive-by down the rabbit a lot

416
00:24:48,799 --> 00:24:51,158
attack

417
00:24:51,549 --> 00:24:56,389
this attack was already obtained in 2014

418
00:24:56,389 --> 00:24:59,779
but it has been since the few security

419
00:24:59,779 --> 00:25:05,629
programs recently so lost bronze patrol

420
00:25:05,629 --> 00:25:08,149
every attack I use the Windows command

421
00:25:08,149 --> 00:25:11,959
for lateral movement don't betray is the

422
00:25:11,959 --> 00:25:15,070
same users of falling windows covered

423
00:25:15,070 --> 00:25:18,559
beside windows covered taka also use

424
00:25:18,559 --> 00:25:25,459
mimic cut and wing area this is an

425
00:25:25,459 --> 00:25:28,129
example the rotor movement step executed

426
00:25:28,129 --> 00:25:31,450
command by ticks attacker the

427
00:25:31,450 --> 00:25:34,690
investigation start with for my command

428
00:25:34,690 --> 00:25:37,700
they use me because to create a court

429
00:25:37,700 --> 00:25:38,559
etiquette

430
00:25:38,559 --> 00:25:42,259
eternal recon use of income and after

431
00:25:42,259 --> 00:25:43,320
that you

432
00:25:43,320 --> 00:25:49,400
the net command to map our remote host

433
00:25:49,400 --> 00:25:52,800
the execute the file to remote host of

434
00:25:52,800 --> 00:25:56,760
is copy and eighty command and the final

435
00:25:56,760 --> 00:26:02,880
data files okay thank you should say for

436
00:26:02,880 --> 00:26:07,920
introducing two cases and TTP's that TTP

437
00:26:07,920 --> 00:26:10,920
is targeting in Japan okay from here I

438
00:26:10,920 --> 00:26:12,810
would like to wrap up today's talk as a

439
00:26:12,810 --> 00:26:15,930
takeaway first we have demonstrated that

440
00:26:15,930 --> 00:26:18,000
bound booties or region specific

441
00:26:18,000 --> 00:26:20,340
software are often targeted at by

442
00:26:20,340 --> 00:26:23,700
attackers and thus need to be properly

443
00:26:23,700 --> 00:26:27,420
addressed second we also introduced new

444
00:26:27,420 --> 00:26:30,840
TTP's observed in the recent attacks and

445
00:26:30,840 --> 00:26:33,630
explains the need for countermeasure

446
00:26:33,630 --> 00:26:38,220
against them finally we provided insight

447
00:26:38,220 --> 00:26:41,730
in intelligence analysis and apt

448
00:26:41,730 --> 00:26:44,580
handling by grasping TTP's in different

449
00:26:44,580 --> 00:26:48,300
campaigns okay we appreciate again

450
00:26:48,300 --> 00:26:51,060
giving us an opportunity to speak at

451
00:26:51,060 --> 00:26:55,950
bars bloated and I'm very glad very

452
00:26:55,950 --> 00:26:59,250
happy to so many people's come attending

453
00:26:59,250 --> 00:27:03,500
our talks and thank you for attention

