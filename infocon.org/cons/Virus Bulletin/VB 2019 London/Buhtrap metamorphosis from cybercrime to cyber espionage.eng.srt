1
00:00:00,329 --> 00:00:02,760
let's welcome and turn Terrapin alpha

2
00:00:02,760 --> 00:00:05,580
and Yanni and buta who will talk us

3
00:00:05,580 --> 00:00:08,429
about the boot trap metamorphosis going

4
00:00:08,429 --> 00:00:10,880
from cybercrime to ciphers business

5
00:00:10,880 --> 00:00:14,820
welcome guys thank you all right

6
00:00:14,820 --> 00:00:17,789
hi everyone thank you for being here so

7
00:00:17,789 --> 00:00:20,100
we drop into morph is this so it's

8
00:00:20,100 --> 00:00:21,840
criminal Dhruv that has transitioned

9
00:00:21,840 --> 00:00:25,439
from trying to make money to make an

10
00:00:25,439 --> 00:00:27,750
espionage right so before we dive in I'm

11
00:00:27,750 --> 00:00:29,340
enjoying the time and together with my

12
00:00:29,340 --> 00:00:31,439
colleague and i'm cherylin off we will

13
00:00:31,439 --> 00:00:34,770
go through this metamorphosis right so

14
00:00:34,770 --> 00:00:37,380
in the audience who is aware of the

15
00:00:37,380 --> 00:00:39,870
bootstrap group interactions by

16
00:00:39,870 --> 00:00:40,790
shoreland

17
00:00:40,790 --> 00:00:44,100
mat-su oh yeah he said yes all right

18
00:00:44,100 --> 00:00:46,680
excellent so let me walk you through a

19
00:00:46,680 --> 00:00:49,140
bit of a timeline of how this research

20
00:00:49,140 --> 00:00:51,570
started and how we discovered this true

21
00:00:51,570 --> 00:00:53,910
using a zero-day in against their target

22
00:00:53,910 --> 00:00:55,890
so this whole research started in 2014

23
00:00:55,890 --> 00:00:57,899
when we started seeing some very

24
00:00:57,899 --> 00:01:00,030
interesting packages so we were seeing

25
00:01:00,030 --> 00:01:02,550
an Ensis back down loader that would

26
00:01:02,550 --> 00:01:04,830
install on a system a lot of different

27
00:01:04,830 --> 00:01:06,659
tool so they were legitimate ones but

28
00:01:06,659 --> 00:01:09,060
there were also tools to fingerprinting

29
00:01:09,060 --> 00:01:10,439
machine trying to find what's on the

30
00:01:10,439 --> 00:01:12,750
machine trying to avoid sand boxes

31
00:01:12,750 --> 00:01:15,780
trying to avoid a VD tection as well but

32
00:01:15,780 --> 00:01:17,070
there were two tools that were really

33
00:01:17,070 --> 00:01:19,950
key in this attack so the first one was

34
00:01:19,950 --> 00:01:21,990
the root rot backdoor so kind of their

35
00:01:21,990 --> 00:01:24,630
custom backdoor that consisted of a key

36
00:01:24,630 --> 00:01:26,159
logger so they would be able to know

37
00:01:26,159 --> 00:01:28,140
what the user was typing on a

38
00:01:28,140 --> 00:01:30,509
compromised machine but also it was

39
00:01:30,509 --> 00:01:32,159
monitoring smart cards that were

40
00:01:32,159 --> 00:01:34,380
inserted on the system so these smart

41
00:01:34,380 --> 00:01:35,970
cards might be used by different users

42
00:01:35,970 --> 00:01:38,549
to make let's say financial transactions

43
00:01:38,549 --> 00:01:40,799
so they were monitoring for these type

44
00:01:40,799 --> 00:01:43,079
of events but they were also installing

45
00:01:43,079 --> 00:01:47,159
on the system a remote access tool which

46
00:01:47,159 --> 00:01:48,720
means that they could access remotely

47
00:01:48,720 --> 00:01:51,600
the computer or the system and control

48
00:01:51,600 --> 00:01:55,020
it so we were tracking these guys and

49
00:01:55,020 --> 00:01:56,790
they were very active targeting a lot of

50
00:01:56,790 --> 00:02:00,780
different people mostly in Russia one

51
00:02:00,780 --> 00:02:03,509
thing that really helped us on this is

52
00:02:03,509 --> 00:02:05,520
they were using a lot of code signing

53
00:02:05,520 --> 00:02:07,380
certificate like this one

54
00:02:07,380 --> 00:02:09,770
so by used by tracking these

55
00:02:09,770 --> 00:02:12,390
certificates we were able to actually

56
00:02:12,390 --> 00:02:13,340
see a lot of

57
00:02:13,340 --> 00:02:15,290
activities and they were using quite a

58
00:02:15,290 --> 00:02:17,270
lot of them so at the time we didn't

59
00:02:17,270 --> 00:02:19,069
know exactly who they were after so we

60
00:02:19,069 --> 00:02:21,110
knew they were mostly targeting people

61
00:02:21,110 --> 00:02:24,140
in Russia but we started considering

62
00:02:24,140 --> 00:02:25,970
what they might be after so this is a

63
00:02:25,970 --> 00:02:28,010
type of decoy documents that these guys

64
00:02:28,010 --> 00:02:30,890
were using so basically they would send

65
00:02:30,890 --> 00:02:32,720
spear phishing email and if the people

66
00:02:32,720 --> 00:02:34,790
would double click on the attachment it

67
00:02:34,790 --> 00:02:37,010
will install all of their tools plus

68
00:02:37,010 --> 00:02:40,819
show this decoy document to try to make

69
00:02:40,819 --> 00:02:41,720
sure that the people will not be

70
00:02:41,720 --> 00:02:43,760
suspicious by opening it so this one is

71
00:02:43,760 --> 00:02:47,239
an invoice this one is a contract so to

72
00:02:47,239 --> 00:02:49,130
the communications contract and this is

73
00:02:49,130 --> 00:02:51,560
a type of documents that accounting

74
00:02:51,560 --> 00:02:54,080
department might receive and the domains

75
00:02:54,080 --> 00:02:55,910
that these guys were using for command

76
00:02:55,910 --> 00:02:57,799
and control servers were actually

77
00:02:57,799 --> 00:03:00,080
mimicking a lot of resources that

78
00:03:00,080 --> 00:03:02,510
accountant might be accessing so we're

79
00:03:02,510 --> 00:03:04,130
talking about forums where they couldn't

80
00:03:04,130 --> 00:03:06,440
download templates or templates of

81
00:03:06,440 --> 00:03:09,470
contracts and based on all of this and

82
00:03:09,470 --> 00:03:12,019
the or telemetry we assess that they

83
00:03:12,019 --> 00:03:14,330
were mostly interested in accounting

84
00:03:14,330 --> 00:03:16,730
departments in businesses in Russia

85
00:03:16,730 --> 00:03:18,500
trying probably to make fortune and

86
00:03:18,500 --> 00:03:20,780
transfer so this is when we coined the

87
00:03:20,780 --> 00:03:23,209
name bootstrap so we actually published

88
00:03:23,209 --> 00:03:25,579
a blog post in 2015

89
00:03:25,579 --> 00:03:27,980
operation bootstrap so why boot wrap

90
00:03:27,980 --> 00:03:31,819
well in Russian accountant is Buchalter

91
00:03:31,819 --> 00:03:35,569
right Anton yes so this is why we came

92
00:03:35,569 --> 00:03:37,160
up with bootstrap - the trap for

93
00:03:37,160 --> 00:03:38,390
accountants and thinking this name

94
00:03:38,390 --> 00:03:40,340
actually stayed and this is how this

95
00:03:40,340 --> 00:03:43,489
group is referred to as of today so

96
00:03:43,489 --> 00:03:46,220
throughout or monitoring we find these

97
00:03:46,220 --> 00:03:48,290
guys were very active and one thing that

98
00:03:48,290 --> 00:03:50,510
stood out well the fact that they seem

99
00:03:50,510 --> 00:03:51,829
to have a lot of ties with criminal

100
00:03:51,829 --> 00:03:54,230
underground so they were using Microsoft

101
00:03:54,230 --> 00:03:56,180
Word and shooter so some of you might

102
00:03:56,180 --> 00:03:58,670
remember this this framework so it's

103
00:03:58,670 --> 00:04:01,870
basically a a word document that is

104
00:04:01,870 --> 00:04:03,380
trying to explore different

105
00:04:03,380 --> 00:04:06,470
vulnerabilities in Microsoft Word so

106
00:04:06,470 --> 00:04:09,739
they will be able to install our malware

107
00:04:09,739 --> 00:04:12,290
if the the user was using one of the

108
00:04:12,290 --> 00:04:13,579
Microsoft Word version that were

109
00:04:13,579 --> 00:04:15,350
vulnerable to these attacks and these

110
00:04:15,350 --> 00:04:17,358
guys have been using this framework a

111
00:04:17,358 --> 00:04:20,060
long time ago so it became public but

112
00:04:20,060 --> 00:04:21,738
these guys were having access to it

113
00:04:21,738 --> 00:04:24,140
really early on the other tools that

114
00:04:24,140 --> 00:04:25,849
they were using to try to compromise

115
00:04:25,849 --> 00:04:26,419
their

116
00:04:26,419 --> 00:04:29,360
their target is notorious exploited so

117
00:04:29,360 --> 00:04:32,629
this kid was very was was used only to

118
00:04:32,629 --> 00:04:34,639
deliver a couple of different payloads

119
00:04:34,639 --> 00:04:36,800
one of them was boot trap the other one

120
00:04:36,800 --> 00:04:38,599
was core Co which was also banking

121
00:04:38,599 --> 00:04:41,750
Trojan targeting businesses in Russia so

122
00:04:41,750 --> 00:04:44,979
this shows that they had ties to the the

123
00:04:44,979 --> 00:04:48,319
the operator of this little skit the

124
00:04:48,319 --> 00:04:49,699
last thing I want to bring to your

125
00:04:49,699 --> 00:04:51,169
attention is the fact that these guys

126
00:04:51,169 --> 00:04:52,969
were using a lot of different Act tools

127
00:04:52,969 --> 00:04:56,030
but also the multiple local privilege

128
00:04:56,030 --> 00:04:57,770
escalations so we're not talking about

129
00:04:57,770 --> 00:04:59,960
zero-day we're talking mostly about one

130
00:04:59,960 --> 00:05:02,539
day so we would see Microsoft match some

131
00:05:02,539 --> 00:05:04,580
of these vulnerabilities and a couple of

132
00:05:04,580 --> 00:05:06,560
months later we would see this guy using

133
00:05:06,560 --> 00:05:08,150
it what's interesting about it is that

134
00:05:08,150 --> 00:05:10,029
we assigned that they were actually

135
00:05:10,029 --> 00:05:14,360
using a third-party developer to code

136
00:05:14,360 --> 00:05:16,039
these because we had very distinctive

137
00:05:16,039 --> 00:05:19,969
PDB paths so here you see mini gdb this

138
00:05:19,969 --> 00:05:22,310
is actually a modified version of mini

139
00:05:22,310 --> 00:05:24,259
cats mainly cats is a very powerful tool

140
00:05:24,259 --> 00:05:27,590
to try to extract passwords on the

141
00:05:27,590 --> 00:05:30,169
system and you can see here a name so

142
00:05:30,169 --> 00:05:32,539
volodymyr and this name showed up in

143
00:05:32,539 --> 00:05:34,430
multiple tools that these guys were

144
00:05:34,430 --> 00:05:37,819
using mostly to try to elevate privilege

145
00:05:37,819 --> 00:05:41,330
or to use these mini cats things so we

146
00:05:41,330 --> 00:05:43,879
also saw as I said local privilege

147
00:05:43,879 --> 00:05:46,069
exploit so this one in the PDB path it's

148
00:05:46,069 --> 00:05:48,199
easier to identify its it says that the

149
00:05:48,199 --> 00:05:52,550
CV 2015 25:46 and again you have this

150
00:05:52,550 --> 00:05:55,370
valor denier name that shows up and this

151
00:05:55,370 --> 00:05:57,259
will be important especially in the

152
00:05:57,259 --> 00:05:58,520
entrance part because this is something

153
00:05:58,520 --> 00:06:00,889
we saw in the attack that was using a

154
00:06:00,889 --> 00:06:04,909
zero-day tied to this to this troop so

155
00:06:04,909 --> 00:06:06,650
this guy had multiple different tools

156
00:06:06,650 --> 00:06:08,599
and other one was a plugin so it was

157
00:06:08,599 --> 00:06:11,120
abusing HTTPS everywhere everywhere from

158
00:06:11,120 --> 00:06:13,639
Electronic Frontier Foundation's or e FF

159
00:06:13,639 --> 00:06:16,039
and this program is meant to redirect

160
00:06:16,039 --> 00:06:19,009
users to the HTTPS version of a website

161
00:06:19,009 --> 00:06:20,689
if it's available and these guys were

162
00:06:20,689 --> 00:06:23,120
using this plug-in or abusing it to try

163
00:06:23,120 --> 00:06:25,300
to redirect users to malicious website

164
00:06:25,300 --> 00:06:29,089
so if we go back to the timeline so up

165
00:06:29,089 --> 00:06:31,189
to this up to the fall 2015 they were

166
00:06:31,189 --> 00:06:33,469
mostly interested in in businesses but

167
00:06:33,469 --> 00:06:36,620
then we saw shift so we saw spear

168
00:06:36,620 --> 00:06:39,110
phishing email like this one that was

169
00:06:39,110 --> 00:06:39,910
meant

170
00:06:39,910 --> 00:06:43,270
be that was directed towards executive

171
00:06:43,270 --> 00:06:45,970
in financial institutions so if the the

172
00:06:45,970 --> 00:06:47,530
user would click and open up the

173
00:06:47,530 --> 00:06:49,450
attachment not only would it try to

174
00:06:49,450 --> 00:06:51,580
install the bootstrap backdoor but it

175
00:06:51,580 --> 00:06:53,800
will also show the color document like

176
00:06:53,800 --> 00:06:55,870
this one so I'm not sure if he can read

177
00:06:55,870 --> 00:06:57,850
Russian but this is basically saying and

178
00:06:57,850 --> 00:06:59,980
it's an invitation to some kind of

179
00:06:59,980 --> 00:07:02,350
seminar to executive in financial

180
00:07:02,350 --> 00:07:04,030
institutions so that we were seeing a

181
00:07:04,030 --> 00:07:06,160
lot of documents such as this one so

182
00:07:06,160 --> 00:07:08,950
this one is mimicking an advert in an

183
00:07:08,950 --> 00:07:11,680
advisory from the fencer so fin cert is

184
00:07:11,680 --> 00:07:13,900
assert that the Russian authorities are

185
00:07:13,900 --> 00:07:16,570
created to try to protect financial

186
00:07:16,570 --> 00:07:17,980
institutions in Russia

187
00:07:17,980 --> 00:07:21,580
against against cybercrime so these guys

188
00:07:21,580 --> 00:07:23,890
were targeting these banks and using

189
00:07:23,890 --> 00:07:26,830
these these advisory to legitimate their

190
00:07:26,830 --> 00:07:30,700
actions so we didn't know at that time

191
00:07:30,700 --> 00:07:32,710
how successful they were so we were

192
00:07:32,710 --> 00:07:35,280
seeing a constant string of attacks

193
00:07:35,280 --> 00:07:37,960
against financial institutions but in

194
00:07:37,960 --> 00:07:40,510
2016 group I we published reports saying

195
00:07:40,510 --> 00:07:41,650
that these guys went fight very

196
00:07:41,650 --> 00:07:44,860
successful so they were able to steal 25

197
00:07:44,860 --> 00:07:47,470
million from 13 different banks in

198
00:07:47,470 --> 00:07:50,320
Russia over six months period this is a

199
00:07:50,320 --> 00:07:52,510
lot of money in a short career meaning

200
00:07:52,510 --> 00:07:54,730
that these guys were really very capable

201
00:07:54,730 --> 00:07:58,830
very sophisticated so one thing that was

202
00:07:58,830 --> 00:08:01,720
somewhat odd to us is that we were

203
00:08:01,720 --> 00:08:03,790
trying we're still tracking them and

204
00:08:03,790 --> 00:08:06,280
once again we witness shift in their

205
00:08:06,280 --> 00:08:08,830
target so towards the end of 2015 so a

206
00:08:08,830 --> 00:08:10,960
few months after they started targeting

207
00:08:10,960 --> 00:08:13,330
financial institution we started seeing

208
00:08:13,330 --> 00:08:16,960
them target governmental institution so

209
00:08:16,960 --> 00:08:18,910
this is a document the decoy document

210
00:08:18,910 --> 00:08:21,580
that they were using and this this dekai

211
00:08:21,580 --> 00:08:23,560
document of course you would be

212
00:08:23,560 --> 00:08:25,300
installing the decoy document but the

213
00:08:25,300 --> 00:08:27,490
overall package would be installing the

214
00:08:27,490 --> 00:08:29,410
bootstrap backdoor and was showing this

215
00:08:29,410 --> 00:08:31,600
document so this is basically a document

216
00:08:31,600 --> 00:08:34,539
which states that how to process people

217
00:08:34,539 --> 00:08:36,610
that do not have permanent residency or

218
00:08:36,610 --> 00:08:38,440
a valid passport which is not something

219
00:08:38,440 --> 00:08:41,169
that businesses or or financial

220
00:08:41,169 --> 00:08:44,980
institutions will be required to hear

221
00:08:44,980 --> 00:08:47,170
about and be very different things about

222
00:08:47,170 --> 00:08:49,000
this one as well is that all the decoy

223
00:08:49,000 --> 00:08:50,500
documents we've seen before were in

224
00:08:50,500 --> 00:08:52,420
Russian whereas this one if

225
00:08:52,420 --> 00:08:54,760
you'll notice is actually Ukrainian so

226
00:08:54,760 --> 00:08:57,670
they were trying to target these these

227
00:08:57,670 --> 00:08:59,500
governmental institutions were seeing it

228
00:08:59,500 --> 00:09:01,360
on our telemetry different decoy

229
00:09:01,360 --> 00:09:03,520
documents this one is asking for

230
00:09:03,520 --> 00:09:06,130
information on a specific passport

231
00:09:06,130 --> 00:09:07,630
holder and we're seeing this type of

232
00:09:07,630 --> 00:09:08,890
thing which which seemed very odd

233
00:09:08,890 --> 00:09:11,290
because they were mostly interested in

234
00:09:11,290 --> 00:09:13,390
financial games before an hour saying

235
00:09:13,390 --> 00:09:15,220
some end of espionage

236
00:09:15,220 --> 00:09:18,010
so another decoy documents I want to

237
00:09:18,010 --> 00:09:20,980
bring your attention on as this one the

238
00:09:20,980 --> 00:09:22,330
content is not very interesting it's

239
00:09:22,330 --> 00:09:25,390
just saying people to send email address

240
00:09:25,390 --> 00:09:28,600
contact information to to the to the

241
00:09:28,600 --> 00:09:30,400
sender of the email and it was then

242
00:09:30,400 --> 00:09:31,660
saying that they had a legitimate

243
00:09:31,660 --> 00:09:34,660
website so this one so the vmsu database

244
00:09:34,660 --> 00:09:36,850
of course this is malicious website it's

245
00:09:36,850 --> 00:09:38,860
not the real one but it's mimicking one

246
00:09:38,860 --> 00:09:40,660
governmental organization they were

247
00:09:40,660 --> 00:09:43,630
after and this the cult document was

248
00:09:43,630 --> 00:09:46,810
seen only a few months after they were

249
00:09:46,810 --> 00:09:49,420
after a financial institution and I

250
00:09:49,420 --> 00:09:50,950
don't know if you remember this decoy

251
00:09:50,950 --> 00:09:52,840
documents I showed you a few minutes

252
00:09:52,840 --> 00:09:55,540
earlier so this is the one inviting

253
00:09:55,540 --> 00:09:58,390
financial institution executive due to

254
00:09:58,390 --> 00:10:00,070
some seminar and you can see there's

255
00:10:00,070 --> 00:10:03,720
also a domain name there and we we

256
00:10:03,720 --> 00:10:06,370
compared the Whois information from from

257
00:10:06,370 --> 00:10:07,900
both the one that was targeting

258
00:10:07,900 --> 00:10:09,940
governmental organization and financial

259
00:10:09,940 --> 00:10:11,800
institution and said that did the US

260
00:10:11,800 --> 00:10:13,900
information were almost the same you can

261
00:10:13,900 --> 00:10:15,940
see here the district names on is the

262
00:10:15,940 --> 00:10:18,760
same the address also the email so I

263
00:10:18,760 --> 00:10:21,190
will not go through all of them but

264
00:10:21,190 --> 00:10:23,410
basically all information that was there

265
00:10:23,410 --> 00:10:26,260
was identical plus they were created

266
00:10:26,260 --> 00:10:29,650
about a month apart so this led us to

267
00:10:29,650 --> 00:10:31,720
strongly believe that these are the same

268
00:10:31,720 --> 00:10:33,070
guys were operating

269
00:10:33,070 --> 00:10:34,930
we campaigns against financial

270
00:10:34,930 --> 00:10:36,730
institutions and businesses and we're

271
00:10:36,730 --> 00:10:39,280
not transitioning to governmental

272
00:10:39,280 --> 00:10:43,000
organization now we were seeing this we

273
00:10:43,000 --> 00:10:44,770
were sitting on this because we didn't

274
00:10:44,770 --> 00:10:46,960
really know what was happening and then

275
00:10:46,960 --> 00:10:50,590
plot twist 2016 February we saw that

276
00:10:50,590 --> 00:10:53,680
this this this post on some underground

277
00:10:53,680 --> 00:10:55,510
forum so this one comes from exploit

278
00:10:55,510 --> 00:10:57,550
that I n so some of you might know this

279
00:10:57,550 --> 00:10:59,280
cyber crime criminal on the ground

280
00:10:59,280 --> 00:11:02,210
and in there what it says is that

281
00:11:02,210 --> 00:11:04,650
throughout all their campaigns these

282
00:11:04,650 --> 00:11:07,230
guys were able to make a lot of money so

283
00:11:07,230 --> 00:11:09,210
two top guys of the organization of the

284
00:11:09,210 --> 00:11:10,620
group were able to make a lot of money

285
00:11:10,620 --> 00:11:13,560
but this guy says that is a software

286
00:11:13,560 --> 00:11:15,180
developer and that it was basically

287
00:11:15,180 --> 00:11:17,060
making very poor money

288
00:11:17,060 --> 00:11:19,470
disgruntled employee basically and he

289
00:11:19,470 --> 00:11:21,300
decided to release the source code of

290
00:11:21,300 --> 00:11:23,640
all the tools that boot wrap was using

291
00:11:23,640 --> 00:11:26,280
so now everyone access to this tool and

292
00:11:26,280 --> 00:11:28,650
could then reuse it so of course for us

293
00:11:28,650 --> 00:11:31,410
as researcher this is very difficult at

294
00:11:31,410 --> 00:11:33,000
that to keep track of who's using what

295
00:11:33,000 --> 00:11:36,150
and who was the original organization or

296
00:11:36,150 --> 00:11:38,550
the original perpetrator of all these

297
00:11:38,550 --> 00:11:40,170
attacks so we're not sure if this is

298
00:11:40,170 --> 00:11:42,930
true or not but this definitely made our

299
00:11:42,930 --> 00:11:45,900
job a bit harder so we're still seeing

300
00:11:45,900 --> 00:11:48,270
in our telemetry turns against

301
00:11:48,270 --> 00:11:51,090
governmental organization but we we were

302
00:11:51,090 --> 00:11:52,650
seeing as well a lot of people were

303
00:11:52,650 --> 00:11:54,840
using the source code available and we

304
00:11:54,840 --> 00:11:56,940
published this year earlier this summer

305
00:11:56,940 --> 00:11:59,130
a campaign that was distributing the

306
00:11:59,130 --> 00:12:01,140
blue trail back door through marketizing

307
00:12:01,140 --> 00:12:03,360
so they were using Yandex direct which

308
00:12:03,360 --> 00:12:05,070
is a major advertising platform

309
00:12:05,070 --> 00:12:07,140
trying to direct people to download this

310
00:12:07,140 --> 00:12:08,550
bootstrap backdoor but they were not

311
00:12:08,550 --> 00:12:13,080
only using they were not only trying to

312
00:12:13,080 --> 00:12:14,460
install this backdoor they were also

313
00:12:14,460 --> 00:12:16,800
trying to put ransomware on the system

314
00:12:16,800 --> 00:12:18,810
so we're not sure whether the ties were

315
00:12:18,810 --> 00:12:21,780
to the original author but we could see

316
00:12:21,780 --> 00:12:24,390
a lot of activity so we sat on the

317
00:12:24,390 --> 00:12:26,280
governmental organization targeting from

318
00:12:26,280 --> 00:12:28,260
this group for a long time until we

319
00:12:28,260 --> 00:12:30,089
found something really interesting that

320
00:12:30,089 --> 00:12:40,350
Anton will talk about I was not looking

321
00:12:40,350 --> 00:12:43,430
for a book trap I was looking for

322
00:12:43,430 --> 00:12:50,970
exploits and I found one as all good

323
00:12:50,970 --> 00:12:55,280
discovers it happened on Friday evening

324
00:12:55,280 --> 00:12:56,640
[Music]

325
00:12:56,640 --> 00:13:00,370
analyzed the file and few days after I

326
00:13:00,370 --> 00:13:03,610
reported it to Microsoft Microsoft they

327
00:13:03,610 --> 00:13:06,370
did really great job they patched it

328
00:13:06,370 --> 00:13:11,260
next during night next page Tuesday so

329
00:13:11,260 --> 00:13:15,450
they released the page on why so what

330
00:13:15,450 --> 00:13:17,560
vulnerability were talking about we're

331
00:13:17,560 --> 00:13:21,040
talking about privilege escalation

332
00:13:21,040 --> 00:13:25,540
vulnerabilities it was invented in 32

333
00:13:25,540 --> 00:13:31,150
key component specifically it was not no

334
00:13:31,150 --> 00:13:37,900
point of reference in in Canal related

335
00:13:37,900 --> 00:13:40,930
to pop-up mini object

336
00:13:40,930 --> 00:13:45,130
let's analyze how it worked so they

337
00:13:45,130 --> 00:13:48,280
exploited creates two windows and for

338
00:13:48,280 --> 00:13:51,610
first window it creates pop-up menu and

339
00:13:51,610 --> 00:13:54,310
of course it's just example of popup

340
00:13:54,310 --> 00:13:59,370
menu in Expo Expo Expo it doesn't

341
00:13:59,370 --> 00:14:05,380
display this pop opinion so exploit mask

342
00:14:05,380 --> 00:14:09,790
edge moment when the initial menu is

343
00:14:09,790 --> 00:14:14,680
created but submenu only is about to

344
00:14:14,680 --> 00:14:19,020
created to do that it see tabs hooks and

345
00:14:19,020 --> 00:14:23,620
when Sesame in such state it sends

346
00:14:23,620 --> 00:14:30,730
cancel menu and now in here now if we

347
00:14:30,730 --> 00:14:34,060
check the camera mode we see that it is

348
00:14:34,060 --> 00:14:37,030
not take pop-up menu structure it

349
00:14:37,030 --> 00:14:42,390
doesn't contain no point and is no point

350
00:14:42,390 --> 00:14:48,030
it's you used by colonel Misha walls

351
00:14:48,030 --> 00:14:52,690
tackle to use no point of reference for

352
00:14:52,690 --> 00:14:56,400
that they need me to walk allocate

353
00:14:56,400 --> 00:15:01,000
memory at no page and by using this

354
00:15:01,000 --> 00:15:05,280
function they are able to change one bit

355
00:15:05,280 --> 00:15:09,070
in colonel so what did they

356
00:15:09,070 --> 00:15:12,850
the change they want to change this

357
00:15:12,850 --> 00:15:17,290
server side window brought beat in tag

358
00:15:17,290 --> 00:15:22,690
in the structure of second window when

359
00:15:22,690 --> 00:15:26,199
this bit is not set the function of

360
00:15:26,199 --> 00:15:29,199
window could be executed in user mode

361
00:15:29,199 --> 00:15:32,589
when this bit is said it will be

362
00:15:32,589 --> 00:15:35,350
executed in camera mode so vanity is

363
00:15:35,350 --> 00:15:38,880
executed in current mode they can use

364
00:15:38,880 --> 00:15:42,250
commercial code obtain season privilege

365
00:15:42,250 --> 00:15:48,370
so that's how this exploit worked the

366
00:15:48,370 --> 00:15:52,720
important question you must ask why mock

367
00:15:52,720 --> 00:15:54,610
trapping hits the other day because it's

368
00:15:54,610 --> 00:15:56,949
a standard user mode malware it works

369
00:15:56,949 --> 00:16:00,850
well even without the other day and the

370
00:16:00,850 --> 00:16:05,230
main reason why attacker used is your

371
00:16:05,230 --> 00:16:08,560
day it's a tool that we call and you

372
00:16:08,560 --> 00:16:14,069
note and not his name of our product and

373
00:16:14,069 --> 00:16:20,850
NT noted is their name of this pool so

374
00:16:20,850 --> 00:16:23,410
the main purpose of this tool is to

375
00:16:23,410 --> 00:16:26,949
tamper with a protection of our product

376
00:16:26,949 --> 00:16:32,550
they want to disable some very important

377
00:16:32,550 --> 00:16:35,290
settings like cloud protection memory

378
00:16:35,290 --> 00:16:40,510
scanner and they also made attempt to

379
00:16:40,510 --> 00:16:43,990
add if this felt or exclusion list and

380
00:16:43,990 --> 00:16:47,319
it's important to note here that this

381
00:16:47,319 --> 00:16:51,670
tool is designed to work only against

382
00:16:51,670 --> 00:16:54,550
some older version of not that was

383
00:16:54,550 --> 00:17:00,189
released seven years ago so let's wrap

384
00:17:00,189 --> 00:17:03,670
it up it was exploit that word only

385
00:17:03,670 --> 00:17:06,270
against in the 732 this because

386
00:17:06,270 --> 00:17:09,849
Microsoft back ported the page from

387
00:17:09,849 --> 00:17:11,890
newer version of Windows and it's not

388
00:17:11,890 --> 00:17:17,530
possible to allocate new page in 64-bit

389
00:17:17,530 --> 00:17:21,630
version of Windows and we saw

390
00:17:21,630 --> 00:17:25,290
one target in our telemetry and I think

391
00:17:25,290 --> 00:17:29,300
it's amazing that we are able to protect

392
00:17:29,300 --> 00:17:34,080
customer even if it even if the customer

393
00:17:34,080 --> 00:17:38,370
use outdated version of Windows and all

394
00:17:38,370 --> 00:17:43,140
the version of our product and who is

395
00:17:43,140 --> 00:17:45,540
behind this exploit we think it's solid

396
00:17:45,540 --> 00:17:50,000
email because the pdb path contains

397
00:17:50,000 --> 00:17:58,620
quality mail string so that's thank you

398
00:17:58,620 --> 00:18:01,470
so yeah you've seen the PDP path same

399
00:18:01,470 --> 00:18:02,970
Baldomir that we've seen before

400
00:18:02,970 --> 00:18:05,100
one thing that is interesting to note as

401
00:18:05,100 --> 00:18:07,410
well is that the tool that were trying

402
00:18:07,410 --> 00:18:09,630
that was trying to bypass our antivirus

403
00:18:09,630 --> 00:18:11,610
we've seen it before so the developer

404
00:18:11,610 --> 00:18:14,250
themselves called it auntie nod and this

405
00:18:14,250 --> 00:18:16,260
is one tool that we've seen them used

406
00:18:16,260 --> 00:18:19,020
throughout their campaigns in 2014-2015

407
00:18:19,020 --> 00:18:22,380
and and so on so before talking about

408
00:18:22,380 --> 00:18:24,090
the zero the attack itself

409
00:18:24,090 --> 00:18:27,420
let's take a step back and so as I was

410
00:18:27,420 --> 00:18:29,190
saying earlier we were trying to track

411
00:18:29,190 --> 00:18:31,560
all the campaigns from from this group

412
00:18:31,560 --> 00:18:33,840
and we're seeing that they were still

413
00:18:33,840 --> 00:18:35,640
targeting governmental organization but

414
00:18:35,640 --> 00:18:38,130
they were kind of updating their tools

415
00:18:38,130 --> 00:18:41,730
so in 2019 we saw this document so it's

416
00:18:41,730 --> 00:18:43,230
not really important it's some kind of

417
00:18:43,230 --> 00:18:45,900
contract still written in Ukrainian and

418
00:18:45,900 --> 00:18:48,930
they were installing the mutrah backdoor

419
00:18:48,930 --> 00:18:50,430
through it but one thing that is

420
00:18:50,430 --> 00:18:52,110
interesting to note is that they started

421
00:18:52,110 --> 00:18:53,790
to introduce new tools as they were

422
00:18:53,790 --> 00:18:55,710
progressing in their campaigns one of

423
00:18:55,710 --> 00:18:57,780
them was a grub tour so what what is

424
00:18:57,780 --> 00:18:59,490
used for it was actually trying to

425
00:18:59,490 --> 00:19:01,260
collect passwords that were stored on

426
00:19:01,260 --> 00:19:03,660
the victims computer so they were trying

427
00:19:03,660 --> 00:19:05,460
to are this password from email clients

428
00:19:05,460 --> 00:19:08,400
or browsers and then trying to

429
00:19:08,400 --> 00:19:10,170
accelerate it so they had two different

430
00:19:10,170 --> 00:19:11,760
means for this so they would either just

431
00:19:11,760 --> 00:19:13,770
post it so it was a very simple tool

432
00:19:13,770 --> 00:19:16,020
just trying to Arvest them and then send

433
00:19:16,020 --> 00:19:19,020
it off to a C&C server here you can see

434
00:19:19,020 --> 00:19:21,420
the version that is sending post

435
00:19:21,420 --> 00:19:23,220
requests you have the domain name here

436
00:19:23,220 --> 00:19:25,530
so secure to limited net I just want to

437
00:19:25,530 --> 00:19:27,320
point out that these guys used to love

438
00:19:27,320 --> 00:19:31,290
secure telemetry Microsoft ran on all of

439
00:19:31,290 --> 00:19:32,790
their domain names our

440
00:19:32,790 --> 00:19:35,430
of these words and the other meet in the

441
00:19:35,430 --> 00:19:37,290
minute the other method that these guys

442
00:19:37,290 --> 00:19:40,920
were using was actually email so here

443
00:19:40,920 --> 00:19:44,460
you can see a partial partial script

444
00:19:44,460 --> 00:19:46,620
being built that will then send to an

445
00:19:46,620 --> 00:19:48,900
email address the content of the

446
00:19:48,900 --> 00:19:51,540
passwords was able to gather on the

447
00:19:51,540 --> 00:19:53,910
system so now going back to the zero-day

448
00:19:53,910 --> 00:19:55,680
case we had so the zero day was

449
00:19:55,680 --> 00:19:57,920
delivered through an insist packed

450
00:19:57,920 --> 00:19:59,820
downloader so this is something that

451
00:19:59,820 --> 00:20:02,550
we've seen quite a bit from this troop

452
00:20:02,550 --> 00:20:04,320
so as Anton said was trying to elevate

453
00:20:04,320 --> 00:20:07,020
privileges for trying to visible AV but

454
00:20:07,020 --> 00:20:08,340
one of the tool that these guys were

455
00:20:08,340 --> 00:20:10,620
using was a log tool so what they were

456
00:20:10,620 --> 00:20:14,420
trying to see is what exclusions were

457
00:20:14,420 --> 00:20:17,460
set up on the machine probably to see

458
00:20:17,460 --> 00:20:19,320
whether the attack was successful we're

459
00:20:19,320 --> 00:20:21,360
not too sure why they were using it but

460
00:20:21,360 --> 00:20:23,520
this tool will come back and we'll make

461
00:20:23,520 --> 00:20:26,430
another tie to the original troop so if

462
00:20:26,430 --> 00:20:28,500
we look at all the links between this

463
00:20:28,500 --> 00:20:30,150
attack and would rub group so we have

464
00:20:30,150 --> 00:20:31,860
this census package that they've been

465
00:20:31,860 --> 00:20:33,510
using throughout all these years right

466
00:20:33,510 --> 00:20:35,760
we also have network I you see overlap

467
00:20:35,760 --> 00:20:37,980
between the different campaigns then we

468
00:20:37,980 --> 00:20:39,930
have a crypto overlap so this one is

469
00:20:39,930 --> 00:20:41,790
interesting because it goes a long way

470
00:20:41,790 --> 00:20:44,100
back so this is a screenshot of the

471
00:20:44,100 --> 00:20:46,020
large tools that I've just talked about

472
00:20:46,020 --> 00:20:48,000
so the one that is listing the extrusion

473
00:20:48,000 --> 00:20:50,430
on the settings of the inter virus and

474
00:20:50,430 --> 00:20:52,500
you can see here a key which is in fact

475
00:20:52,500 --> 00:20:55,020
an rc4 key and it's also used in the

476
00:20:55,020 --> 00:20:56,460
grab of tool so it's a screenshot from

477
00:20:56,460 --> 00:20:58,950
the grabber but what is very interesting

478
00:20:58,950 --> 00:21:01,740
about this key is that it has been used

479
00:21:01,740 --> 00:21:04,140
forever like for years they've been

480
00:21:04,140 --> 00:21:06,480
using this key to encrypt communication

481
00:21:06,480 --> 00:21:09,540
of the backdoor so even in 2014 2015 we

482
00:21:09,540 --> 00:21:11,190
were seeing this key in their

483
00:21:11,190 --> 00:21:13,140
interaction malware then there are some

484
00:21:13,140 --> 00:21:15,240
modules overlap so while looking for

485
00:21:15,240 --> 00:21:17,520
additional malware on the machine we saw

486
00:21:17,520 --> 00:21:18,720
that they were trying to install the

487
00:21:18,720 --> 00:21:20,880
grabber module as well so we know that

488
00:21:20,880 --> 00:21:23,160
this system was clearly of interest to

489
00:21:23,160 --> 00:21:24,650
this group so this governmental

490
00:21:24,650 --> 00:21:27,510
organization then the victimology so as

491
00:21:27,510 --> 00:21:29,940
we saw they were transitioning from one

492
00:21:29,940 --> 00:21:31,830
type of victim to the other so they

493
00:21:31,830 --> 00:21:34,650
started with businesses in Russia then

494
00:21:34,650 --> 00:21:36,210
we've seen them going after financial

495
00:21:36,210 --> 00:21:38,070
institutions in Russia and that was

496
00:21:38,070 --> 00:21:40,260
backed up by external Isis as well and

497
00:21:40,260 --> 00:21:42,810
then before the source code leak we've

498
00:21:42,810 --> 00:21:44,580
seen them transition to this

499
00:21:44,580 --> 00:21:45,410
governmental or

500
00:21:45,410 --> 00:21:46,940
halation so we can see that this is

501
00:21:46,940 --> 00:21:51,050
consistent with their targeting then the

502
00:21:51,050 --> 00:21:53,450
usage of cosign certificate opt-in till

503
00:21:53,450 --> 00:21:55,310
now they are still using them and we are

504
00:21:55,310 --> 00:21:57,530
able to link through cosign certificate

505
00:21:57,530 --> 00:22:00,140
the tools that were signed using the the

506
00:22:00,140 --> 00:22:02,300
same the same certificate and it were

507
00:22:02,300 --> 00:22:05,360
used for different purposes as well so

508
00:22:05,360 --> 00:22:08,660
to wrap up you know that the campaign is

509
00:22:08,660 --> 00:22:10,790
selective we have new tools that are

510
00:22:10,790 --> 00:22:12,590
introduced we've seen them use

511
00:22:12,590 --> 00:22:15,740
meterpreter for example we've seen them

512
00:22:15,740 --> 00:22:17,900
use dns tunneling as well but there's

513
00:22:17,900 --> 00:22:20,840
always a constant in all these campaigns

514
00:22:20,840 --> 00:22:22,760
where we can easily tie it back to the

515
00:22:22,760 --> 00:22:25,490
original the original perpetrators we've

516
00:22:25,490 --> 00:22:27,830
seen also new targets we've seen a

517
00:22:27,830 --> 00:22:30,230
campaign against the governmental

518
00:22:30,230 --> 00:22:32,510
institution in Central Asia that was

519
00:22:32,510 --> 00:22:36,020
trying to install that was probably

520
00:22:36,020 --> 00:22:37,730
trying to install some backdoors this is

521
00:22:37,730 --> 00:22:39,770
the color document as you can see it's

522
00:22:39,770 --> 00:22:42,560
the Islamic Republic of Afghanistan so

523
00:22:42,560 --> 00:22:44,900
we're not sure exactly who was targeted

524
00:22:44,900 --> 00:22:47,360
but Central Asia is definitely a region

525
00:22:47,360 --> 00:22:49,850
of focus for this guy so we can assume

526
00:22:49,850 --> 00:22:53,930
that they will likely increase their

527
00:22:53,930 --> 00:22:55,760
targeting in the future and we'll of

528
00:22:55,760 --> 00:22:57,500
course keep track of them so the

529
00:22:57,500 --> 00:22:59,210
question I get quite a bit is is it

530
00:22:59,210 --> 00:23:00,500
really which are they are you able to

531
00:23:00,500 --> 00:23:02,660
tie it all these years to same people

532
00:23:02,660 --> 00:23:04,970
that were targeting businesses and

533
00:23:04,970 --> 00:23:06,740
financial institutions so of course

534
00:23:06,740 --> 00:23:08,660
Anton and I cannot be hundred percent

535
00:23:08,660 --> 00:23:13,100
sure but there are so many similarities

536
00:23:13,100 --> 00:23:15,680
between all of these campaigns that we

537
00:23:15,680 --> 00:23:18,050
are highly confident that some of these

538
00:23:18,050 --> 00:23:19,610
guys or at least one of them are

539
00:23:19,610 --> 00:23:21,320
actually transitioning and using the

540
00:23:21,320 --> 00:23:22,550
same tools and using the same

541
00:23:22,550 --> 00:23:24,590
methodologies that we use against

542
00:23:24,590 --> 00:23:25,880
businesses and against financial

543
00:23:25,880 --> 00:23:29,300
institutions to not to not target the

544
00:23:29,300 --> 00:23:32,030
governmental organization and it brings

545
00:23:32,030 --> 00:23:34,100
up an interesting question so we've seen

546
00:23:34,100 --> 00:23:36,770
in the past some criminal groups

547
00:23:36,770 --> 00:23:38,990
targeting or at least trying to extort

548
00:23:38,990 --> 00:23:40,880
rate sensitive data some of you might

549
00:23:40,880 --> 00:23:43,490
remember it is GAMEOVER Zeus botnet that

550
00:23:43,490 --> 00:23:45,590
we're trying to find keywords and

551
00:23:45,590 --> 00:23:47,600
compromise system to try so exfiltrate

552
00:23:47,600 --> 00:23:50,330
data and now we have this other case so

553
00:23:50,330 --> 00:23:52,190
it will be interesting to continue to

554
00:23:52,190 --> 00:23:53,750
monitor these and see whether we can

555
00:23:53,750 --> 00:23:54,620
find other insta

556
00:23:54,620 --> 00:23:56,750
of such group transitioning or

557
00:23:56,750 --> 00:23:59,390
metamorphosing into a different type

558
00:23:59,390 --> 00:24:01,700
targets so with it thank you very much

559
00:24:01,700 --> 00:24:04,270
for attention

