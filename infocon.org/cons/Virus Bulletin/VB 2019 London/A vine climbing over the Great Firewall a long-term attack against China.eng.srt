1
00:00:00,030 --> 00:00:04,140
so welcome everybody to the Red Room of

2
00:00:04,140 --> 00:00:07,200
the first session in this room for VB

3
00:00:07,200 --> 00:00:11,010
2019 I hope you enjoyed the the keynote

4
00:00:11,010 --> 00:00:13,320
I think I was very interesting and I

5
00:00:13,320 --> 00:00:15,420
felt that the keynote was about

6
00:00:15,420 --> 00:00:19,289
defending basically defending a nation

7
00:00:19,289 --> 00:00:21,449
and I think the next two talks that

8
00:00:21,449 --> 00:00:23,039
we're gonna have here in this room as

9
00:00:23,039 --> 00:00:25,470
you guys all can come in and settle down

10
00:00:25,470 --> 00:00:28,050
the next two talks we have in this room

11
00:00:28,050 --> 00:00:31,320
are also about attacks against a very

12
00:00:31,320 --> 00:00:35,489
limited geography the first talk is

13
00:00:35,489 --> 00:00:38,399
going to be it's actually written by

14
00:00:38,399 --> 00:00:40,350
line gu who's a former colleague of mine

15
00:00:40,350 --> 00:00:45,960
and Bowen Penn both from Chien's in the

16
00:00:45,960 --> 00:00:47,489
talk we're gonna have afterwards they're

17
00:00:47,489 --> 00:00:49,829
going to be from from the Japanese cert

18
00:00:49,829 --> 00:00:54,360
and with that if everybody's settled

19
00:00:54,360 --> 00:00:56,160
down and there are still seats in the

20
00:00:56,160 --> 00:00:57,960
front here let's see I'm talking to you

21
00:00:57,960 --> 00:00:59,120
chuck

22
00:00:59,120 --> 00:01:01,430
[Laughter]

23
00:01:01,430 --> 00:01:04,110
but with that I'd like to welcome to the

24
00:01:04,110 --> 00:01:07,590
stage Bowen pan from Chi Anson and he's

25
00:01:07,590 --> 00:01:08,450
going to talk about

26
00:01:08,450 --> 00:01:11,790
ABG's targeting China please welcome

27
00:01:11,790 --> 00:01:14,860
[Music]

28
00:01:14,860 --> 00:01:20,600
okay thank you so morning everyone so my

29
00:01:20,600 --> 00:01:24,259
name is Bolin pan and I my colleague

30
00:01:24,259 --> 00:01:27,140
Leah my colleague liane is thought for

31
00:01:27,140 --> 00:01:31,820
some reason it's not come here and this

32
00:01:31,820 --> 00:01:35,210
is our first time to come to the

33
00:01:35,210 --> 00:01:37,549
attendee to the Vivek conference and

34
00:01:37,549 --> 00:01:42,799
also my first time to come to London so

35
00:01:42,799 --> 00:01:46,880
today I appreciate to stand here to talk

36
00:01:46,880 --> 00:01:50,690
about an apt group which named poison by

37
00:01:50,690 --> 00:01:57,229
and we D closed by our team for the last

38
00:01:57,229 --> 00:01:59,500
year

39
00:02:00,670 --> 00:02:04,759
so first is a very short introduction of

40
00:02:04,759 --> 00:02:09,258
our team our team name is red trip so we

41
00:02:09,258 --> 00:02:13,660
came from a Chinese security vendor and

42
00:02:13,660 --> 00:02:17,299
name-changing and we are focused on the

43
00:02:17,299 --> 00:02:20,209
threat intelligence and apt tracing and

44
00:02:20,209 --> 00:02:24,560
we uncovered undiscovered uncovered

45
00:02:24,560 --> 00:02:27,769
several apt groups before like the old

46
00:02:27,769 --> 00:02:31,130
ocean Lotus and which also named by some

47
00:02:31,130 --> 00:02:37,549
security vendor the apt 32 so so you may

48
00:02:37,549 --> 00:02:40,609
if you are interested in apt tracing or

49
00:02:40,609 --> 00:02:43,130
threat intelligence you may follow the

50
00:02:43,130 --> 00:02:48,980
Twitter account we will publish the

51
00:02:48,980 --> 00:02:52,400
newest reports or some intelligence

52
00:02:52,400 --> 00:02:59,359
things on our Twitter accounts so this

53
00:02:59,359 --> 00:03:03,049
is today's agenda is very in general and

54
00:03:03,049 --> 00:03:07,069
come come on gender here and first I'd

55
00:03:07,069 --> 00:03:10,700
like to talk about the some main points

56
00:03:10,700 --> 00:03:15,650
of the apt groups poison line and then

57
00:03:15,650 --> 00:03:18,250
I'll talk about some the the

58
00:03:18,250 --> 00:03:21,970
capabilities the resources and the GDP

59
00:03:21,970 --> 00:03:24,920
related to this group and this group and

60
00:03:24,920 --> 00:03:27,000
also the in

61
00:03:27,000 --> 00:03:31,220
of all the campaigns and when we

62
00:03:31,220 --> 00:03:35,730
investigate with these apt threats and

63
00:03:35,730 --> 00:03:39,060
or abt groups finally you you may

64
00:03:39,060 --> 00:03:42,600
interested in some attribution pronouns

65
00:03:42,600 --> 00:03:51,450
and attribution results so this apt

66
00:03:51,450 --> 00:03:55,890
group is real real known we named it

67
00:03:55,890 --> 00:03:59,160
poisoned by and we also get a eternal

68
00:03:59,160 --> 00:04:05,180
name like to the apt - I see - 0 1 and

69
00:04:05,180 --> 00:04:09,600
if you familiar with us the if you

70
00:04:09,600 --> 00:04:13,470
familiar with the ocean Lotus which also

71
00:04:13,470 --> 00:04:17,070
in has an internal code internal

72
00:04:17,070 --> 00:04:21,988
de-index like apt - 3-0 so from the

73
00:04:21,988 --> 00:04:26,720
index you you may you may notice that we

74
00:04:26,720 --> 00:04:29,820
discovered we discovered this apt group

75
00:04:29,820 --> 00:04:34,050
just after the we found the ocean Lotus

76
00:04:34,050 --> 00:04:42,320
in 2015 so so some some ice so we also

77
00:04:42,320 --> 00:04:45,510
notice that some foreign researchers may

78
00:04:45,510 --> 00:04:48,210
confuse with the name with the name with

79
00:04:48,210 --> 00:04:51,450
the internal code with the internal name

80
00:04:51,450 --> 00:04:59,370
because it's it's just like the name the

81
00:04:59,370 --> 00:05:04,290
apt named bill it's just like the apt

82
00:05:04,290 --> 00:05:09,690
named the Phi ice convention we were

83
00:05:09,690 --> 00:05:14,790
just passing I see in the middle so so

84
00:05:14,790 --> 00:05:17,850
if you are doing the ABT's actor groups

85
00:05:17,850 --> 00:05:21,180
mapping you may you you shouldn't ignore

86
00:05:21,180 --> 00:05:29,580
it and so it's really a no apt group

87
00:05:29,580 --> 00:05:32,520
because most of its activities is tacky

88
00:05:32,520 --> 00:05:36,479
to China especially on the mainland it's

89
00:05:36,479 --> 00:05:39,990
what is the image intent is its major

90
00:05:39,990 --> 00:05:40,850
interest

91
00:05:40,850 --> 00:05:45,290
is the cyber espionage and the

92
00:05:45,290 --> 00:05:49,010
intelligence collection so so so of

93
00:05:49,010 --> 00:05:51,860
course there are most targets are the

94
00:05:51,860 --> 00:05:56,290
military's and the pollak politicians or

95
00:05:56,290 --> 00:06:01,790
just the SEC the sectors like related to

96
00:06:01,790 --> 00:06:06,680
this so we list some main targets here

97
00:06:06,680 --> 00:06:10,220
like the the government agency the

98
00:06:10,220 --> 00:06:13,910
militaries the the researchers and also

99
00:06:13,910 --> 00:06:22,280
the more times agency as well so so you

100
00:06:22,280 --> 00:06:25,190
may interested in how we discover this

101
00:06:25,190 --> 00:06:32,570
this APD group at the first in 2015 we

102
00:06:32,570 --> 00:06:37,460
discovered an and new Mayo a sample and

103
00:06:37,460 --> 00:06:41,300
very special ones and due to the our

104
00:06:41,300 --> 00:06:45,080
internal mail we're hunting policies and

105
00:06:45,080 --> 00:06:50,600
this this this malware named this this

106
00:06:50,600 --> 00:06:56,300
malware is discussed like in document

107
00:06:56,300 --> 00:07:00,350
file but it is a Xcode is it is really

108
00:07:00,350 --> 00:07:06,170
really acute profile but in in the name

109
00:07:06,170 --> 00:07:11,210
in the name of the fire it has it have

110
00:07:11,210 --> 00:07:15,140
long tails of space characters in the

111
00:07:15,140 --> 00:07:19,580
tail of the file name so so if the

112
00:07:19,580 --> 00:07:24,380
victim retreat received this file and in

113
00:07:24,380 --> 00:07:30,920
may wreck it may ignore the ignore the

114
00:07:30,920 --> 00:07:34,280
real real fire extension and just like

115
00:07:34,280 --> 00:07:37,520
adjusting it's a document so don't a

116
00:07:37,520 --> 00:07:41,390
male they may click it and go trigger

117
00:07:41,390 --> 00:07:46,330
the malicious code running so at least

118
00:07:46,330 --> 00:07:50,510
at least the timeline here after we get

119
00:07:50,510 --> 00:07:52,770
this sample we do some analyze

120
00:07:52,770 --> 00:07:57,979
and we extend some evidence based on the

121
00:07:57,979 --> 00:08:01,229
intelligence data so we find it's a long

122
00:08:01,229 --> 00:08:04,979
time is long term activities beginnings

123
00:08:04,979 --> 00:08:11,639
that we believe that 2007 so from 2007

124
00:08:11,639 --> 00:08:16,319
and to this year is 11 years to long

125
00:08:16,319 --> 00:08:20,280
term so we leaved

126
00:08:20,280 --> 00:08:23,699
the timeline of I think he's some some

127
00:08:23,699 --> 00:08:27,360
some my strong stage here so the first

128
00:08:27,360 --> 00:08:31,349
the first the first Miller sample we did

129
00:08:31,349 --> 00:08:36,510
we found is Eastern the December of 2007

130
00:08:36,510 --> 00:08:39,839
a bass sound it's the files compiling

131
00:08:39,839 --> 00:08:45,990
time step and the which which they are

132
00:08:45,990 --> 00:08:48,950
used this malware to targeted and big

133
00:08:48,950 --> 00:08:55,410
shipping company in China and they first

134
00:08:55,410 --> 00:08:58,860
used this payload we detection sometimes

135
00:08:58,860 --> 00:09:02,790
detection name is the poison ivy why

136
00:09:02,790 --> 00:09:06,570
rate if you are familiar with with the

137
00:09:06,570 --> 00:09:10,230
MOA analyze or malware samples you may

138
00:09:10,230 --> 00:09:14,070
know this you may heard of this rate in

139
00:09:14,070 --> 00:09:18,750
named Ivy why rate it's a very famous

140
00:09:18,750 --> 00:09:24,690
commercial and and public rate in the

141
00:09:24,690 --> 00:09:30,000
world so then the the group may use some

142
00:09:30,000 --> 00:09:35,010
very special every day you some evade

143
00:09:35,010 --> 00:09:39,810
evade detection technologies and we will

144
00:09:39,810 --> 00:09:43,579
also discuss this in the in later slides

145
00:09:43,579 --> 00:09:49,890
and after the end of the 2012 they

146
00:09:49,890 --> 00:09:53,610
started to use an open-source rate named

147
00:09:53,610 --> 00:10:00,510
the eggshell and for this apt group the

148
00:10:00,510 --> 00:10:02,430
spear phishing attack is the most

149
00:10:02,430 --> 00:10:05,759
frequently way they they use to to

150
00:10:05,759 --> 00:10:08,939
establish the food holder but we also

151
00:10:08,939 --> 00:10:14,119
find some watering hole attack in 2013

152
00:10:14,119 --> 00:10:19,410
to target it to some governments and

153
00:10:19,410 --> 00:10:24,259
military and compromised the the website

154
00:10:24,259 --> 00:10:30,569
and later in truth in 20 2014 we

155
00:10:30,569 --> 00:10:33,029
discovered that the group had used the

156
00:10:33,029 --> 00:10:37,169
zero day and zero day for for the during

157
00:10:37,169 --> 00:10:39,239
the attack and later

158
00:10:39,239 --> 00:10:42,749
one year later they they customized the

159
00:10:42,749 --> 00:10:46,290
cust might develop an andhraite rules -

160
00:10:46,290 --> 00:10:51,089
- using the the cloud storage api's - to

161
00:10:51,089 --> 00:10:56,309
do the data exfiltration so this is the

162
00:10:56,309 --> 00:11:00,929
first and the only one they they built

163
00:11:00,929 --> 00:11:06,329
they built by themselves so finally the

164
00:11:06,329 --> 00:11:11,189
in 2018 we published the the the apt

165
00:11:11,189 --> 00:11:20,850
report poison vying for for us is really

166
00:11:20,850 --> 00:11:25,739
noticed sophisticate apt group they they

167
00:11:25,739 --> 00:11:29,819
just used several raid tools like the

168
00:11:29,819 --> 00:11:33,329
eye poison ivy ydg eggshell and the only

169
00:11:33,329 --> 00:11:39,179
one we only want or customized Ratos

170
00:11:39,179 --> 00:11:44,309
and they use some several document

171
00:11:44,309 --> 00:11:50,029
exploit and and for the infrastructure

172
00:11:50,029 --> 00:11:53,329
infrastructure they used they prefer to

173
00:11:53,329 --> 00:11:57,859
trove some cheaper and cheaper

174
00:11:57,859 --> 00:12:01,019
infrastructure so we do to these we

175
00:12:01,019 --> 00:12:05,239
believe that the the poison vine maybe

176
00:12:05,239 --> 00:12:09,149
there are limited resources or or funds

177
00:12:09,149 --> 00:12:14,720
and maybe an a very small team behind

178
00:12:17,979 --> 00:12:21,349
firstly our introduction introduction

179
00:12:21,349 --> 00:12:24,349
you should have used the poison ivy why

180
00:12:24,349 --> 00:12:28,689
right stay there used so the as I said

181
00:12:28,689 --> 00:12:32,059
before the the poison ivy was very

182
00:12:32,059 --> 00:12:38,769
famous and and and it's a commercial and

183
00:12:38,769 --> 00:12:42,799
public used rate you know in the world

184
00:12:42,799 --> 00:12:48,799
and each the left image on the slides is

185
00:12:48,799 --> 00:12:52,339
a configuration a menu of this rate

186
00:12:52,339 --> 00:12:55,099
rules and you can configure both the

187
00:12:55,099 --> 00:12:58,489
mutex name and some type different types

188
00:12:58,489 --> 00:13:04,789
of show code to to generate and the very

189
00:13:04,789 --> 00:13:07,339
special thing is the is the encryption

190
00:13:07,339 --> 00:13:11,259
encryption a curing algorithm and the

191
00:13:11,259 --> 00:13:15,049
encryption to the streams in in the rate

192
00:13:15,049 --> 00:13:19,299
is it using use two round of the

193
00:13:19,299 --> 00:13:25,699
exclusive or exclusive or operator so

194
00:13:25,699 --> 00:13:29,869
it's very not very common in the in the

195
00:13:29,869 --> 00:13:35,470
rapist so so although they use these

196
00:13:35,470 --> 00:13:39,829
public ones but that we found a very

197
00:13:39,829 --> 00:13:42,829
interesting thing is because of the IV a

198
00:13:42,829 --> 00:13:46,879
rate is not up update upgraded for

199
00:13:46,879 --> 00:13:50,539
several us for many years so the the

200
00:13:50,539 --> 00:13:54,259
poison vine group used these patches

201
00:13:54,259 --> 00:13:58,489
some code in the rate to adapt to adopt

202
00:13:58,489 --> 00:14:01,279
the rate runs on the higher version of

203
00:14:01,279 --> 00:14:06,919
the of the windows so next is the the

204
00:14:06,919 --> 00:14:11,559
eggshell the 3x show is the open source

205
00:14:11,559 --> 00:14:14,449
rate rules you can find it and download

206
00:14:14,449 --> 00:14:19,699
it and github and but the adversary do

207
00:14:19,699 --> 00:14:23,239
some car mised here customize here they

208
00:14:23,239 --> 00:14:27,229
add some special control command into

209
00:14:27,229 --> 00:14:28,230
the

210
00:14:28,230 --> 00:14:31,050
into the source code and compile it to

211
00:14:31,050 --> 00:14:34,620
fit some capabilities they they they

212
00:14:34,620 --> 00:14:39,290
were they used to for example here they

213
00:14:39,290 --> 00:14:42,540
you may see they're here they add a

214
00:14:42,540 --> 00:14:45,810
command name ie pest to retrieve and

215
00:14:45,810 --> 00:14:49,830
still stolen the credential files from

216
00:14:49,830 --> 00:14:57,720
the the I browser and then it's the only

217
00:14:57,720 --> 00:15:01,500
one customized to they developed totally

218
00:15:01,500 --> 00:15:06,120
so we named the can box rate because the

219
00:15:06,120 --> 00:15:09,600
rate used the the cloud storage service

220
00:15:09,600 --> 00:15:14,520
in in China which named the camp box so

221
00:15:14,520 --> 00:15:18,360
the this can box cloud is not very

222
00:15:18,360 --> 00:15:21,570
popular nowadays but it's popular in

223
00:15:21,570 --> 00:15:25,920
several years ago so they use the the

224
00:15:25,920 --> 00:15:29,180
data storage API to do the data

225
00:15:29,180 --> 00:15:34,200
exfiltration and and and another

226
00:15:34,200 --> 00:15:36,840
interesting in the rates they developed

227
00:15:36,840 --> 00:15:41,310
big is that they hard-coded several

228
00:15:41,310 --> 00:15:44,780
keywords to filtering the the exact

229
00:15:44,780 --> 00:15:49,050
exactly affected the sensitive documents

230
00:15:49,050 --> 00:15:54,120
on the victim PC it's of course the key

231
00:15:54,120 --> 00:15:56,850
word the filtering keyword to is to

232
00:15:56,850 --> 00:16:00,900
filtering the the file name if including

233
00:16:00,900 --> 00:16:04,800
some special special keyword like the

234
00:16:04,800 --> 00:16:09,270
military like the war like the army in

235
00:16:09,270 --> 00:16:20,190
Chinese in Chinese so so - based on

236
00:16:20,190 --> 00:16:23,670
these keywords we are obviously

237
00:16:23,670 --> 00:16:28,770
understand the the intent of the and of

238
00:16:28,770 --> 00:16:35,930
the poison line and in 2018 we found

239
00:16:35,930 --> 00:16:39,150
something different they are used on

240
00:16:39,150 --> 00:16:42,120
PowerShell script or posture or

241
00:16:42,120 --> 00:16:46,589
are the script language to to to load

242
00:16:46,589 --> 00:16:47,519
the shellcode

243
00:16:47,519 --> 00:16:52,379
the next stage shellcode and to to do

244
00:16:52,379 --> 00:16:56,069
the drive-by download and to execute a

245
00:16:56,069 --> 00:16:58,980
final paper final payload and the final

246
00:16:58,980 --> 00:17:01,499
play payload we discovered is also the

247
00:17:01,499 --> 00:17:05,839
IV y rate so they the core of the the

248
00:17:05,839 --> 00:17:08,939
technology they're used is not changed

249
00:17:08,939 --> 00:17:12,679
too much so we we we also find some

250
00:17:12,679 --> 00:17:17,369
several male formed XML fire and on the

251
00:17:17,369 --> 00:17:22,409
open tag directly directory server which

252
00:17:22,409 --> 00:17:26,779
which the the which the XML file has to

253
00:17:26,779 --> 00:17:31,649
SOP SOA P elements and the second ones

254
00:17:31,649 --> 00:17:36,270
has an enclosed attribute enclosed a

255
00:17:36,270 --> 00:17:39,210
location property which will trigger

256
00:17:39,210 --> 00:17:43,980
these these CVE vulnerabilities so

257
00:17:43,980 --> 00:17:47,850
although we didn't we don't find a catch

258
00:17:47,850 --> 00:17:52,110
the exactly the exploit document file in

259
00:17:52,110 --> 00:17:54,419
the in the in fact during the

260
00:17:54,419 --> 00:17:57,899
investigate but we found this malformed

261
00:17:57,899 --> 00:18:01,409
that we can know that stay using they

262
00:18:01,409 --> 00:18:04,159
are using this document this

263
00:18:04,159 --> 00:18:11,390
availability in the attacks and then and

264
00:18:11,390 --> 00:18:15,870
then we found and we and then we found

265
00:18:15,870 --> 00:18:18,090
today they're using the zero days

266
00:18:18,090 --> 00:18:20,690
therefore especially for the document

267
00:18:20,690 --> 00:18:27,299
exploit in 2014 why we why we notice

268
00:18:27,299 --> 00:18:32,250
this this is a theory so because the so

269
00:18:32,250 --> 00:18:35,220
firstly these fellow vulnerability is to

270
00:18:35,220 --> 00:18:38,010
bypass the patches of the severe form

271
00:18:38,010 --> 00:18:41,779
and for use which is used by another

272
00:18:41,779 --> 00:18:46,950
famous apt group but the I think they

273
00:18:46,950 --> 00:18:51,120
they may be the anniversaries some guys

274
00:18:51,120 --> 00:18:52,620
in the

275
00:18:52,620 --> 00:18:56,400
in the poll in the other verse in the

276
00:18:56,400 --> 00:18:59,550
poison vine that they will analyze these

277
00:18:59,550 --> 00:19:03,600
patches and find some more exploits here

278
00:19:03,600 --> 00:19:07,470
and the Microsoft the first that is

279
00:19:07,470 --> 00:19:13,010
closed and public patches for these

280
00:19:13,010 --> 00:19:19,530
these vulnerabilities October 2 2014 but

281
00:19:19,530 --> 00:19:23,820
we found the earliest one the exploit

282
00:19:23,820 --> 00:19:26,370
document they are used for attacking the

283
00:19:26,370 --> 00:19:30,300
the victim is based on the the time the

284
00:19:30,300 --> 00:19:34,050
creation time step of the exploit

285
00:19:34,050 --> 00:19:37,500
document is one month before is on a

286
00:19:37,500 --> 00:19:45,150
certain September 2014 so so and also we

287
00:19:45,150 --> 00:19:48,870
found several exploit document is made

288
00:19:48,870 --> 00:19:53,220
it on that date but different time so we

289
00:19:53,220 --> 00:19:56,820
believe that this time stripe this time

290
00:19:56,820 --> 00:19:59,580
step may not an infect one

291
00:19:59,580 --> 00:20:02,670
so we be that this is a third a status

292
00:20:02,670 --> 00:20:08,250
when they are using it and this is the

293
00:20:08,250 --> 00:20:10,890
some infrastructure they are using the

294
00:20:10,890 --> 00:20:14,429
the adversary' prefer to purchase the

295
00:20:14,429 --> 00:20:17,070
dynamic domains because they are more

296
00:20:17,070 --> 00:20:19,920
cheaper and that it's easy to to repine

297
00:20:19,920 --> 00:20:23,160
the DNS records and the domain name and

298
00:20:23,160 --> 00:20:25,710
they they chose like to disguise

299
00:20:25,710 --> 00:20:30,080
disguised with the populated legitimate

300
00:20:30,080 --> 00:20:36,450
website in China like the some emails

301
00:20:36,450 --> 00:20:39,570
service provider or some antivirus

302
00:20:39,570 --> 00:20:47,250
company we also show some very some

303
00:20:47,250 --> 00:20:50,790
specialty vtdp here and the GDP is

304
00:20:50,790 --> 00:20:54,390
really simple for this group so so the

305
00:20:54,390 --> 00:20:58,440
they would recognize recognized targets

306
00:20:58,440 --> 00:21:01,140
and focus on some important conference

307
00:21:01,140 --> 00:21:05,070
in China for example the right image

308
00:21:05,070 --> 00:21:07,049
there it's about

309
00:21:07,049 --> 00:21:10,429
in Chinese Asia panic annual meeting in

310
00:21:10,429 --> 00:21:13,950
2013 they they're using these kind of

311
00:21:13,950 --> 00:21:16,710
subject and content of of a special

312
00:21:16,710 --> 00:21:19,619
phishing email and made it like more

313
00:21:19,619 --> 00:21:22,909
similar like a sent by a the official

314
00:21:22,909 --> 00:21:26,909
and and also they are using different

315
00:21:26,909 --> 00:21:32,220
types of payload here in of the of the

316
00:21:32,220 --> 00:21:36,049
initial access and to get got the

317
00:21:36,049 --> 00:21:39,179
established for total like the achieved

318
00:21:39,179 --> 00:21:43,080
PE and self extra fire and also the

319
00:21:43,080 --> 00:21:45,659
disguised like a document file or folder

320
00:21:45,659 --> 00:21:50,389
fire and which use some some other

321
00:21:50,389 --> 00:21:54,359
techniques to to confuse the victim like

322
00:21:54,359 --> 00:21:56,609
the the right to the right to left

323
00:21:56,609 --> 00:22:02,999
overrides techniques and and they may do

324
00:22:02,999 --> 00:22:06,600
some space carrot a long tail space

325
00:22:06,600 --> 00:22:12,899
character padding here and then the the

326
00:22:12,899 --> 00:22:16,820
collection and if exfiltration and

327
00:22:16,820 --> 00:22:20,940
they're hard coded in some filtering

328
00:22:20,940 --> 00:22:23,489
keywords in the payload directly and

329
00:22:23,489 --> 00:22:26,190
also their focus on the document the

330
00:22:26,190 --> 00:22:28,940
sensitive document on the victims pc

331
00:22:28,940 --> 00:22:32,460
especially for the microsoft some office

332
00:22:32,460 --> 00:22:36,809
document and also you have red highlight

333
00:22:36,809 --> 00:22:42,269
this like a WPS office it's it's a

334
00:22:42,269 --> 00:22:46,830
really wide wide using in the chinese

335
00:22:46,830 --> 00:22:55,919
cover government and then is the until I

336
00:22:55,919 --> 00:22:58,859
will introduction introduce some special

337
00:22:58,859 --> 00:23:03,809
defense a defense evasion techniques for

338
00:23:03,809 --> 00:23:06,539
example there they are store the API

339
00:23:06,539 --> 00:23:09,869
name and in reserved be reserved order

340
00:23:09,869 --> 00:23:16,039
and to dynamic cause it's to to to

341
00:23:16,039 --> 00:23:20,580
reverse it to the normal normal and

342
00:23:20,580 --> 00:23:26,700
and also they departed and very positive

343
00:23:26,700 --> 00:23:29,429
parameter to an especially API name to

344
00:23:29,429 --> 00:23:34,470
get a kind react so so if if if you pass

345
00:23:34,470 --> 00:23:37,610
the zero windows handle through this API

346
00:23:37,610 --> 00:23:41,159
parameter as a parameter they they will

347
00:23:41,159 --> 00:23:45,330
fail to execute on the real system under

348
00:23:45,330 --> 00:23:49,980
real Windows system but it will pass for

349
00:23:49,980 --> 00:23:53,549
the antivirus health heuristic detection

350
00:23:53,549 --> 00:23:56,880
a detection logic so they use these

351
00:23:56,880 --> 00:24:00,740
techniques to detect the antivirus and

352
00:24:00,740 --> 00:24:06,630
avoid to do detection so this is at

353
00:24:06,630 --> 00:24:12,059
least some list of the the attck IDs

354
00:24:12,059 --> 00:24:19,039
here so this will only a several of them

355
00:24:19,039 --> 00:24:26,010
using and next is the impact I'd like to

356
00:24:26,010 --> 00:24:28,340
introduce some impact during the

357
00:24:28,340 --> 00:24:31,889
investigation they are using the cloud

358
00:24:31,889 --> 00:24:37,049
storage because the several years ago

359
00:24:37,049 --> 00:24:40,139
the during are based on the competition

360
00:24:40,139 --> 00:24:43,440
of the of some intern internet companies

361
00:24:43,440 --> 00:24:46,740
between the competitions in China

362
00:24:46,740 --> 00:24:50,549
they the many of the the international

363
00:24:50,549 --> 00:24:53,389
internet company in China may provide

364
00:24:53,389 --> 00:24:57,360
their their own cloud service or their

365
00:24:57,360 --> 00:25:02,429
own cloud storage and also they provide

366
00:25:02,429 --> 00:25:08,460
the service free and and and provide a

367
00:25:08,460 --> 00:25:11,990
large storage space or even unlimited

368
00:25:11,990 --> 00:25:16,320
space so so the adversary chose these

369
00:25:16,320 --> 00:25:19,260
kind of ways to to do the data

370
00:25:19,260 --> 00:25:22,200
exfiltration and to storage the the sea

371
00:25:22,200 --> 00:25:26,429
filtration traded data and it is very

372
00:25:26,429 --> 00:25:30,380
cheaper and even they they they just use

373
00:25:30,380 --> 00:25:33,029
provide an email address or and phone

374
00:25:33,029 --> 00:25:34,800
number to register account

375
00:25:34,800 --> 00:25:41,100
and they can't use it so so so but the

376
00:25:41,100 --> 00:25:44,550
problem is using these ways that they

377
00:25:44,550 --> 00:25:48,480
must be hard-coded the token in in the

378
00:25:48,480 --> 00:25:51,960
cloud or in in the payload so we during

379
00:25:51,960 --> 00:25:54,750
the investigated during analyze we can

380
00:25:54,750 --> 00:25:57,570
retrieve this token and we can retrieve

381
00:25:57,570 --> 00:26:00,150
all the data on the storage as well but

382
00:26:00,150 --> 00:26:03,470
and also they made a mistake and using a

383
00:26:03,470 --> 00:26:07,200
symmetric encryption algorithm to

384
00:26:07,200 --> 00:26:10,500
encrypt the data so we we can use the

385
00:26:10,500 --> 00:26:13,260
reverse way to to decrypt the data so we

386
00:26:13,260 --> 00:26:17,100
we know that the actor what exactly the

387
00:26:17,100 --> 00:26:20,640
actor is exfiltrated and the final is

388
00:26:20,640 --> 00:26:22,950
the because the time and limit so the

389
00:26:22,950 --> 00:26:27,690
final final thing is the is the

390
00:26:27,690 --> 00:26:30,570
attribution so for some reason I don't

391
00:26:30,570 --> 00:26:33,570
talk about so the real attribute of this

392
00:26:33,570 --> 00:26:38,850
group here so but I'd like to discuss

393
00:26:38,850 --> 00:26:42,390
some some ways of the the how we do the

394
00:26:42,390 --> 00:26:46,770
the attribution problem so for example

395
00:26:46,770 --> 00:26:49,560
the we pick up the languages the special

396
00:26:49,560 --> 00:26:51,870
language establish special character

397
00:26:51,870 --> 00:26:55,650
encodings in the payload and which which

398
00:26:55,650 --> 00:26:59,820
will help us to profiling the the which

399
00:26:59,820 --> 00:27:03,480
region maybe they come from and also the

400
00:27:03,480 --> 00:27:05,720
some who who is a restoration

401
00:27:05,720 --> 00:27:11,880
information and some some other ways so

402
00:27:11,880 --> 00:27:15,420
but we are carefully to to analyze based

403
00:27:15,420 --> 00:27:18,060
on these evidence because they can faked

404
00:27:18,060 --> 00:27:19,230
a can be faked

405
00:27:19,230 --> 00:27:23,220
well well disguise will we need to know

406
00:27:23,220 --> 00:27:26,310
that we need to analyze this is a

407
00:27:26,310 --> 00:27:32,130
mistake or just false flag and the next

408
00:27:32,130 --> 00:27:35,370
interesting thing is that we found also

409
00:27:35,370 --> 00:27:37,710
find the set up from the same region

410
00:27:37,710 --> 00:27:42,960
here named the blue mushroom and it has

411
00:27:42,960 --> 00:27:46,530
a different TDP between this group so we

412
00:27:46,530 --> 00:27:47,340
separated

413
00:27:47,340 --> 00:27:50,880
and these this group we also disclosed

414
00:27:50,880 --> 00:27:53,460
learnt last year so you may find the

415
00:27:53,460 --> 00:27:59,840
report on or blogs or trait accounts so

416
00:27:59,840 --> 00:28:03,150
okay so finally is the conclusion that's

417
00:28:03,150 --> 00:28:05,790
the one thing I'd like to say is that

418
00:28:05,790 --> 00:28:10,590
the apt actors not always very advanced

419
00:28:10,590 --> 00:28:14,700
always always that modificated and the

420
00:28:14,700 --> 00:28:18,120
poison vine is introduced is to prove it

421
00:28:18,120 --> 00:28:22,800
and it's the apt group poison vine find

422
00:28:22,800 --> 00:28:27,390
its way to to improve this attack to

423
00:28:27,390 --> 00:28:31,790
improve its efficient and to get some

424
00:28:31,790 --> 00:28:37,250
very thin crease to get their goals so

425
00:28:37,250 --> 00:28:41,720
the top is finished

