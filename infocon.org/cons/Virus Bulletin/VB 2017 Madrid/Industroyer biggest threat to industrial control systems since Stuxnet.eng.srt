1
00:00:00,089 --> 00:00:04,640
welcome to the people who have joined us

2
00:00:04,640 --> 00:00:09,059
we have Anton sharp enough and Robert

3
00:00:09,059 --> 00:00:12,980
dubrovsky from ESET talking about

4
00:00:12,980 --> 00:00:20,279
destroyer Goodman I'd like to begin by

5
00:00:20,279 --> 00:00:22,050
saying that it's a great honor and

6
00:00:22,050 --> 00:00:23,910
privilege to be standing on the stage of

7
00:00:23,910 --> 00:00:26,970
piracy Bolton conference again I think

8
00:00:26,970 --> 00:00:29,099
it's the fifth time for Anton's seventh

9
00:00:29,099 --> 00:00:31,830
time for me and if I go back and think

10
00:00:31,830 --> 00:00:34,469
about all the topics which we presented

11
00:00:34,469 --> 00:00:39,149
each and every year the topic was more

12
00:00:39,149 --> 00:00:41,309
sophisticated attack was more

13
00:00:41,309 --> 00:00:43,020
sophisticated than the previous year so

14
00:00:43,020 --> 00:00:45,149
I'm already kind of kind of dreading

15
00:00:45,149 --> 00:00:46,980
what is gonna be the next big thing that

16
00:00:46,980 --> 00:00:51,270
we're gonna submit for VB 2018 but today

17
00:00:51,270 --> 00:00:53,309
we're talking about in destroyer it's

18
00:00:53,309 --> 00:00:56,850
also privileged something which we

19
00:00:56,850 --> 00:00:58,350
usually take for granted but the lights

20
00:00:58,350 --> 00:01:00,510
around here the projector is working

21
00:01:00,510 --> 00:01:02,550
which is great because in destroy a

22
00:01:02,550 --> 00:01:04,769
piece of malware which can cause a

23
00:01:04,769 --> 00:01:06,330
blackout in fact it already caused a

24
00:01:06,330 --> 00:01:09,420
blackout in Ukraine last December so

25
00:01:09,420 --> 00:01:13,650
it's a piece of malware to do something

26
00:01:13,650 --> 00:01:17,119
like this but it's the first malware

27
00:01:17,119 --> 00:01:19,939
specifically designed to cause a

28
00:01:19,939 --> 00:01:22,350
blackout to attack power grids

29
00:01:22,350 --> 00:01:24,930
automatically and for that reason we

30
00:01:24,930 --> 00:01:26,250
consider it to be the biggest threat

31
00:01:26,250 --> 00:01:28,409
against industrial control systems since

32
00:01:28,409 --> 00:01:32,490
Stuxnet let's put this malware into the

33
00:01:32,490 --> 00:01:35,130
context of the other previously known

34
00:01:35,130 --> 00:01:37,439
malware families which were used against

35
00:01:37,439 --> 00:01:40,950
ICS attacks and this is how such an

36
00:01:40,950 --> 00:01:43,079
attack typically unfolds so you have an

37
00:01:43,079 --> 00:01:44,729
industrial site which can be anything

38
00:01:44,729 --> 00:01:48,689
from a uranium enrichment plant through

39
00:01:48,689 --> 00:01:50,670
an automobile factory and manufacturing

40
00:01:50,670 --> 00:01:54,960
plan anything it's got its specific

41
00:01:54,960 --> 00:01:59,460
tailored ICS hardware and these devices

42
00:01:59,460 --> 00:02:02,159
they're typically controlled and

43
00:02:02,159 --> 00:02:04,409
monitored through workstations typically

44
00:02:04,409 --> 00:02:08,190
running Windows and with human operators

45
00:02:08,190 --> 00:02:09,810
sitting behind them and that was the

46
00:02:09,810 --> 00:02:12,750
point of iteration in all the previously

47
00:02:12,750 --> 00:02:13,319
known

48
00:02:13,319 --> 00:02:16,859
our cases that's where the attacker got

49
00:02:16,859 --> 00:02:19,560
in and through that they got access to

50
00:02:19,560 --> 00:02:22,969
the rest of the ICS environment now the

51
00:02:22,969 --> 00:02:25,680
individual families they differ in the

52
00:02:25,680 --> 00:02:27,439
methods and their capability to

53
00:02:27,439 --> 00:02:34,139
interfering with the ICS process within

54
00:02:34,139 --> 00:02:36,299
destroyer it was as I said specifically

55
00:02:36,299 --> 00:02:38,790
designed to attack power grids so it was

56
00:02:38,790 --> 00:02:43,849
a electricity distribution substation or

57
00:02:43,849 --> 00:02:47,459
distribution resort rands mission in the

58
00:02:47,459 --> 00:02:50,219
last case which was which was targeted

59
00:02:50,219 --> 00:02:52,290
so the commands which were being sent

60
00:02:52,290 --> 00:02:55,260
from the malware to these devices were

61
00:02:55,260 --> 00:02:57,750
tied to a timer which was built into the

62
00:02:57,750 --> 00:02:59,340
malware that would activate it's

63
00:02:59,340 --> 00:03:02,280
malicious payloads open circuit breakers

64
00:03:02,280 --> 00:03:05,189
stop the flow of electricity so that's

65
00:03:05,189 --> 00:03:07,669
the high-level overview of the threat

66
00:03:07,669 --> 00:03:11,189
now with this capability in destroyer

67
00:03:11,189 --> 00:03:13,709
joined this elite club of only three

68
00:03:13,709 --> 00:03:16,620
previously known malware families which

69
00:03:16,620 --> 00:03:19,439
were which were you know which were to

70
00:03:19,439 --> 00:03:21,030
our knowledge to the knowledge of the

71
00:03:21,030 --> 00:03:24,720
industry used in ICS attacks so Stuxnet

72
00:03:24,720 --> 00:03:27,239
of course needs no introduction right it

73
00:03:27,239 --> 00:03:30,959
was able to reprogram PLC's to change

74
00:03:30,959 --> 00:03:33,439
the rotation speed of centrifuges

75
00:03:33,439 --> 00:03:37,009
Havoc's the malware also known as

76
00:03:37,009 --> 00:03:40,199
dragonfly or the operation energetic

77
00:03:40,199 --> 00:03:43,650
bear mostly active around 2014 used to

78
00:03:43,650 --> 00:03:46,859
target several industrial sites it's

79
00:03:46,859 --> 00:03:48,720
interesting that this malware was also

80
00:03:48,720 --> 00:03:51,329
abusing the opcd a protocol something

81
00:03:51,329 --> 00:03:54,540
which industry is also abusing but

82
00:03:54,540 --> 00:03:56,370
unlike in destroyer Havoc's was only

83
00:03:56,370 --> 00:03:58,829
using it for espionage in the in a

84
00:03:58,829 --> 00:04:01,739
reconnaissance phase of an attack it

85
00:04:01,739 --> 00:04:04,019
didn't actually interfere with

86
00:04:04,019 --> 00:04:05,729
industrial hardware as far as we know

87
00:04:05,729 --> 00:04:08,459
now Symantec recently published research

88
00:04:08,459 --> 00:04:12,389
about new dragonfly campaigns so I

89
00:04:12,389 --> 00:04:14,189
recommend you read that as well it's

90
00:04:14,189 --> 00:04:15,449
probably not the last we heard from this

91
00:04:15,449 --> 00:04:19,259
group now black energy is a little bit

92
00:04:19,259 --> 00:04:21,510
different from all these three other

93
00:04:21,510 --> 00:04:23,599
malware families and that it wasn't

94
00:04:23,599 --> 00:04:26,159
designed it wasn't specifically created

95
00:04:26,159 --> 00:04:26,850
to a

96
00:04:26,850 --> 00:04:29,820
I see environments instead it's a more

97
00:04:29,820 --> 00:04:33,120
general-purpose cyber weapon we've been

98
00:04:33,120 --> 00:04:36,210
monitoring this this malware for quite a

99
00:04:36,210 --> 00:04:40,080
while now and we've already talked about

100
00:04:40,080 --> 00:04:43,800
it at VB twice so I won't get into too

101
00:04:43,800 --> 00:04:46,380
much details we monitored the evolution

102
00:04:46,380 --> 00:04:50,160
of the threat and we watched all the

103
00:04:50,160 --> 00:04:52,200
campaign's unfolding they were mostly

104
00:04:52,200 --> 00:04:54,050
being spread through spearfishing

105
00:04:54,050 --> 00:04:57,060
campaigns we even discovered a zero-day

106
00:04:57,060 --> 00:04:59,460
in PowerPoint that it was using at one

107
00:04:59,460 --> 00:05:03,030
time and over all those years there were

108
00:05:03,030 --> 00:05:06,630
many many interesting targets many

109
00:05:06,630 --> 00:05:07,830
interesting campaigns against many

110
00:05:07,830 --> 00:05:09,840
interesting targets which were often

111
00:05:09,840 --> 00:05:11,310
high-value targets so there was

112
00:05:11,310 --> 00:05:13,590
government news media critical

113
00:05:13,590 --> 00:05:15,660
infrastructure transportation and so on

114
00:05:15,660 --> 00:05:17,910
but what's relevant to our topic today

115
00:05:17,910 --> 00:05:20,130
of course is what happened on December

116
00:05:20,130 --> 00:05:23,160
23rd of 2015 which was the culmination

117
00:05:23,160 --> 00:05:26,220
of the attack that used black energy

118
00:05:26,220 --> 00:05:29,280
against the Ukrainian power grid it was

119
00:05:29,280 --> 00:05:31,410
the first time in history where malware

120
00:05:31,410 --> 00:05:36,800
was used and aided a blackout

121
00:05:36,800 --> 00:05:39,540
now as I already said black energies

122
00:05:39,540 --> 00:05:41,670
have been different so from the other

123
00:05:41,670 --> 00:05:44,280
ones its general purpose it's a modular

124
00:05:44,280 --> 00:05:46,680
piece of malware you can see some

125
00:05:46,680 --> 00:05:50,750
examples of plugins or modules which we

126
00:05:50,750 --> 00:05:53,790
which we detected and analyzed so there

127
00:05:53,790 --> 00:05:56,550
are reconnaissance modules and things

128
00:05:56,550 --> 00:05:59,280
like that it doesn't have the direct

129
00:05:59,280 --> 00:06:01,550
control the ability to directly control

130
00:06:01,550 --> 00:06:04,710
the ICS so what they did was they only

131
00:06:04,710 --> 00:06:07,320
used black energy as a vessel of gaining

132
00:06:07,320 --> 00:06:11,790
access to the interim to the network of

133
00:06:11,790 --> 00:06:13,940
the oboe and there goes the the

134
00:06:13,940 --> 00:06:16,200
electricity distribution substations in

135
00:06:16,200 --> 00:06:20,330
Ukraine and then they use legitimately

136
00:06:20,330 --> 00:06:22,860
installed illusionary use remote access

137
00:06:22,860 --> 00:06:25,980
software called radmann and then remote

138
00:06:25,980 --> 00:06:28,290
connected remotely and then manually had

139
00:06:28,290 --> 00:06:31,710
to click on buttons and open open

140
00:06:31,710 --> 00:06:34,290
circuit breakers so in case you didn't

141
00:06:34,290 --> 00:06:37,050
see this video this is a video taken by

142
00:06:37,050 --> 00:06:39,990
one of the operators sitting behind that

143
00:06:39,990 --> 00:06:40,610
work stage

144
00:06:40,610 --> 00:06:45,229
at that afternoon tried to document look

145
00:06:45,229 --> 00:06:47,090
somebody's remotely accessing my system

146
00:06:47,090 --> 00:06:49,490
opening circuit breakers the mouse is

147
00:06:49,490 --> 00:06:51,050
moving and it's not me touching the

148
00:06:51,050 --> 00:07:01,909
mouse or the keyboard so that's the

149
00:07:01,909 --> 00:07:04,370
actual SCADA software used to control

150
00:07:04,370 --> 00:07:12,110
the substation okay let's move on to the

151
00:07:12,110 --> 00:07:14,680
main topic of today in the sin destroyer

152
00:07:14,680 --> 00:07:19,550
on December 17th to south 2016 notice

153
00:07:19,550 --> 00:07:21,800
that's almost exactly one year after the

154
00:07:21,800 --> 00:07:23,360
previous blackout so we were shocked

155
00:07:23,360 --> 00:07:25,400
with a sense of deja boo' because there

156
00:07:25,400 --> 00:07:29,930
was another one shortly after we got our

157
00:07:29,930 --> 00:07:32,779
hands on samples which quickly became

158
00:07:32,779 --> 00:07:34,969
the main suspect those were the industry

159
00:07:34,969 --> 00:07:37,250
of samples we analyzed them we provided

160
00:07:37,250 --> 00:07:42,259
our analysis back over to Ukraine

161
00:07:42,259 --> 00:07:45,529
sometime after but we were not able to

162
00:07:45,529 --> 00:07:48,979
go public with these findings until June

163
00:07:48,979 --> 00:07:50,690
in order to not to interfere with

164
00:07:50,690 --> 00:07:56,360
ongoing investigations so I've already

165
00:07:56,360 --> 00:07:58,370
shown you what in destroyer is capable

166
00:07:58,370 --> 00:08:00,949
of doing and what it did but we could

167
00:08:00,949 --> 00:08:02,779
take a look at under the under the hood

168
00:08:02,779 --> 00:08:05,979
how exactly it goes about doing that so

169
00:08:05,979 --> 00:08:09,289
the control for the execution of the

170
00:08:09,289 --> 00:08:11,750
malware begins with a main backdoor it's

171
00:08:11,750 --> 00:08:13,639
not particularly interesting it's the

172
00:08:13,639 --> 00:08:16,610
kind of malware all of all of us analyze

173
00:08:16,610 --> 00:08:21,259
hundreds or thousands every day these

174
00:08:21,259 --> 00:08:23,169
are the commands that it supports

175
00:08:23,169 --> 00:08:25,909
perhaps the interesting one is the last

176
00:08:25,909 --> 00:08:28,310
one in order to install itself to to

177
00:08:28,310 --> 00:08:32,078
maintain to get persistence replaces the

178
00:08:32,078 --> 00:08:35,328
image path registry value of a specified

179
00:08:35,328 --> 00:08:39,019
service and puts it to a copy or a more

180
00:08:39,019 --> 00:08:41,929
obfuscated version of itself that it

181
00:08:41,929 --> 00:08:44,990
drops on to the system so the main

182
00:08:44,990 --> 00:08:46,810
backdoor it also executes a couple of

183
00:08:46,810 --> 00:08:49,670
other modules so you can think of all

184
00:08:49,670 --> 00:08:52,040
these all these components as let's call

185
00:08:52,040 --> 00:08:53,390
them supportive or

186
00:08:53,390 --> 00:08:57,170
modules only a couple of them are worth

187
00:08:57,170 --> 00:08:57,890
mentioning

188
00:08:57,890 --> 00:08:59,480
for example there's an additional back

189
00:08:59,480 --> 00:09:04,190
door the purpose of which is is a backup

190
00:09:04,190 --> 00:09:05,720
mechanism so in case something happens

191
00:09:05,720 --> 00:09:07,910
to the main back door they want to make

192
00:09:07,910 --> 00:09:10,250
sure that they're they stay in if in

193
00:09:10,250 --> 00:09:11,750
case the first one gets detected or

194
00:09:11,750 --> 00:09:14,780
disabled and masquerades as a it's

195
00:09:14,780 --> 00:09:17,150
basically a trojan eyes version of the

196
00:09:17,150 --> 00:09:19,280
Windows notepad application and it's a

197
00:09:19,280 --> 00:09:20,870
fully functional version of Windows

198
00:09:20,870 --> 00:09:23,180
notepad which it's able to replace in

199
00:09:23,180 --> 00:09:25,280
the system since it's running with admin

200
00:09:25,280 --> 00:09:29,570
rights a couple of other modules there's

201
00:09:29,570 --> 00:09:32,060
a port scanner which they chose to

202
00:09:32,060 --> 00:09:35,050
implement by themselves instead of

203
00:09:35,050 --> 00:09:38,540
instead of using the readily available

204
00:09:38,540 --> 00:09:41,240
nmap for example there's a denial of

205
00:09:41,240 --> 00:09:43,610
service tool which is interesting but

206
00:09:43,610 --> 00:09:45,170
I'll get to that in in a later slide

207
00:09:45,170 --> 00:09:46,700
because that actually directly

208
00:09:46,700 --> 00:09:51,290
interferes with the i NC ICS operation

209
00:09:51,290 --> 00:09:55,340
now here's a bit of detail which was

210
00:09:55,340 --> 00:09:58,850
pretty unpublished so with the attackers

211
00:09:58,850 --> 00:10:02,770
they got their hands on on this software

212
00:10:02,770 --> 00:10:05,750
that's used in Ukraine it's an in-house

213
00:10:05,750 --> 00:10:09,530
custom built piece of software used at

214
00:10:09,530 --> 00:10:13,250
substations for collecting collecting

215
00:10:13,250 --> 00:10:16,040
logs of habit has maps of the

216
00:10:16,040 --> 00:10:17,450
environments and stuff like that you can

217
00:10:17,450 --> 00:10:19,490
see some screenshots of this software

218
00:10:19,490 --> 00:10:23,390
over here and they reverse engineer this

219
00:10:23,390 --> 00:10:26,510
software was previously not known to

220
00:10:26,510 --> 00:10:27,950
them that's something like this existed

221
00:10:27,950 --> 00:10:30,710
and they found out that it's using a

222
00:10:30,710 --> 00:10:32,960
database to store all this information

223
00:10:32,960 --> 00:10:35,990
and the credentials to that ms SQL

224
00:10:35,990 --> 00:10:37,790
database were hard-coded within the

225
00:10:37,790 --> 00:10:40,880
binary so okay that's that's that's a

226
00:10:40,880 --> 00:10:42,710
weakness that the attackers could abuse

227
00:10:42,710 --> 00:10:47,600
and they did so they chose to execute

228
00:10:47,600 --> 00:10:52,010
some of their shell commands during the

229
00:10:52,010 --> 00:10:53,930
first reconnaissance phase of the attack

230
00:10:53,930 --> 00:10:56,690
through this database through a

231
00:10:56,690 --> 00:10:57,830
functionality called

232
00:10:57,830 --> 00:11:00,590
XP CMD shell which they first had to

233
00:11:00,590 --> 00:11:03,770
enable and then they were able to run

234
00:11:03,770 --> 00:11:07,010
arbitrary shell commands on the on B

235
00:11:07,010 --> 00:11:11,360
in the context of the database now this

236
00:11:11,360 --> 00:11:14,810
brings obvious advantages of stealth so

237
00:11:14,810 --> 00:11:18,410
it's less suspicious that these commands

238
00:11:18,410 --> 00:11:21,160
are being being executed and also since

239
00:11:21,160 --> 00:11:23,630
they stored some of the malicious

240
00:11:23,630 --> 00:11:26,780
binaries within the database itself they

241
00:11:26,780 --> 00:11:29,180
were also able to use it as a mechanism

242
00:11:29,180 --> 00:11:34,160
of evading a VD tection but now we're

243
00:11:34,160 --> 00:11:35,270
getting to the really interesting part

244
00:11:35,270 --> 00:11:39,140
which is so the main one of the one of

245
00:11:39,140 --> 00:11:42,260
the payloads the payload modules of

246
00:11:42,260 --> 00:11:44,480
Industry are launched by a launcher

247
00:11:44,480 --> 00:11:47,690
component not before talk about the

248
00:11:47,690 --> 00:11:50,120
payloads we let's categorize them so

249
00:11:50,120 --> 00:11:53,060
there were three distinct types of ways

250
00:11:53,060 --> 00:11:56,240
that industry is able to interfere with

251
00:11:56,240 --> 00:11:58,580
the operating with the operations of a

252
00:11:58,580 --> 00:12:02,840
electricity distribution substation one

253
00:12:02,840 --> 00:12:04,460
of them the first and the most important

254
00:12:04,460 --> 00:12:08,660
one is directly controlling opening

255
00:12:08,660 --> 00:12:12,650
circuit breakers through by directly

256
00:12:12,650 --> 00:12:15,500
talking to these to these devices now

257
00:12:15,500 --> 00:12:16,850
you may be asking so what are these

258
00:12:16,850 --> 00:12:19,010
devices I keep on talking about all the

259
00:12:19,010 --> 00:12:21,710
time so here are two examples from two

260
00:12:21,710 --> 00:12:26,050
different vendors which are used

261
00:12:26,050 --> 00:12:28,790
typically typically in Europe Siemens

262
00:12:28,790 --> 00:12:32,140
and ABB so these are without going to

263
00:12:32,140 --> 00:12:35,600
electrical engineering 101 these are

264
00:12:35,600 --> 00:12:37,250
so-called intelligent electronic devices

265
00:12:37,250 --> 00:12:40,820
typically protection relays the purpose

266
00:12:40,820 --> 00:12:44,330
their purpose is to balance the power

267
00:12:44,330 --> 00:12:46,190
grid to protect the environment from

268
00:12:46,190 --> 00:12:50,300
power surges and so on now these devices

269
00:12:50,300 --> 00:12:52,100
they're as I mentioned in the

270
00:12:52,100 --> 00:12:54,230
introduction they're controlled and

271
00:12:54,230 --> 00:12:55,820
operated by humans sitting behind

272
00:12:55,820 --> 00:13:01,040
Windows workstations and they do so they

273
00:13:01,040 --> 00:13:03,380
configure them through specialized SCADA

274
00:13:03,380 --> 00:13:06,650
software - examples for you are shown

275
00:13:06,650 --> 00:13:08,570
over here and remember this software

276
00:13:08,570 --> 00:13:10,070
because it's going to be important

277
00:13:10,070 --> 00:13:13,480
towards the end of our presentation

278
00:13:16,100 --> 00:13:18,110
and the communication between those

279
00:13:18,110 --> 00:13:20,300
controlling workstations and the devices

280
00:13:20,300 --> 00:13:20,930
themselves

281
00:13:20,930 --> 00:13:23,690
it happens through one of several there

282
00:13:23,690 --> 00:13:26,300
are several possible i industrial

283
00:13:26,300 --> 00:13:27,800
communication protocols that can be used

284
00:13:27,800 --> 00:13:29,690
some of them are regionally specific

285
00:13:29,690 --> 00:13:32,720
some of them operate through serial

286
00:13:32,720 --> 00:13:35,029
connections some of them over TCP is not

287
00:13:35,029 --> 00:13:37,310
really that important but the overall

288
00:13:37,310 --> 00:13:42,069
idea is the same to control control

289
00:13:42,069 --> 00:13:46,579
these same commands to these devices now

290
00:13:46,579 --> 00:13:48,709
what's important to note is that in

291
00:13:48,709 --> 00:13:52,190
destroyer abuses these protocols its

292
00:13:52,190 --> 00:13:53,779
able to speak for which on tone-on-tone

293
00:13:53,779 --> 00:13:57,620
will describe in more detail but it's no

294
00:13:57,620 --> 00:14:00,410
it doesn't involve any any exploits it

295
00:14:00,410 --> 00:14:01,670
doesn't involve any software

296
00:14:01,670 --> 00:14:04,759
vulnerabilities per se it's abusing the

297
00:14:04,759 --> 00:14:06,319
protocols in the way that they were

298
00:14:06,319 --> 00:14:08,240
designed to be used but they were

299
00:14:08,240 --> 00:14:10,940
designed decades ago without security in

300
00:14:10,940 --> 00:14:14,839
mind particularly so now I had the

301
00:14:14,839 --> 00:14:16,250
microphone over to Anton who will guide

302
00:14:16,250 --> 00:14:19,870
you through the analysis of the payload

303
00:14:19,870 --> 00:14:26,660
so that was me so Robert mentions the

304
00:14:26,660 --> 00:14:29,829
exact timing of industro attack that's

305
00:14:29,829 --> 00:14:34,880
job of the launcher company and the

306
00:14:34,880 --> 00:14:37,819
launch of samples we analyzed what the

307
00:14:37,819 --> 00:14:42,579
launch the payload models on December 17

308
00:14:42,579 --> 00:14:45,589
shortly before power outage so it has

309
00:14:45,589 --> 00:14:51,709
had coded time and we identified models

310
00:14:51,709 --> 00:14:54,759
capable of control device it through for

311
00:14:54,759 --> 00:14:58,040
communication protocols IC 101

312
00:14:58,040 --> 00:15:05,209
I see one of 61 850 and OPC a lot of

313
00:15:05,209 --> 00:15:08,060
them deals with their own configuration

314
00:15:08,060 --> 00:15:14,060
files first 101

315
00:15:14,060 --> 00:15:17,000
it requires configuration file here is

316
00:15:17,000 --> 00:15:19,639
an example of such configuration it

317
00:15:19,639 --> 00:15:23,529
communicates over serial connection so

318
00:15:23,529 --> 00:15:26,660
attacker should define models in

319
00:15:26,660 --> 00:15:28,939
configuration and first thing it does it

320
00:15:28,939 --> 00:15:29,420
gives

321
00:15:29,420 --> 00:15:32,860
the legitimate process on workstation

322
00:15:32,860 --> 00:15:35,360
responsible for control the device in

323
00:15:35,360 --> 00:15:38,870
takes over the device operates on

324
00:15:38,870 --> 00:15:42,740
something that called Iowa information

325
00:15:42,740 --> 00:15:45,740
observed object others think about above

326
00:15:45,740 --> 00:15:50,450
them as Network part or registers there

327
00:15:50,450 --> 00:15:54,050
are several types of Phyo a and but

328
00:15:54,050 --> 00:15:56,540
payload is interesting only input

329
00:15:56,540 --> 00:15:59,240
specific ones that can accept commands

330
00:15:59,240 --> 00:16:06,280
it goes over range of iOS defined in

331
00:16:06,280 --> 00:16:11,110
this range of I avoid the it defined in

332
00:16:11,110 --> 00:16:14,510
configuration and it sends commands

333
00:16:14,510 --> 00:16:18,410
sequence at first off then on and then

334
00:16:18,410 --> 00:16:26,180
off again they idea behind 101 104

335
00:16:26,180 --> 00:16:29,660
payload is very similar to 101 in that

336
00:16:29,660 --> 00:16:32,600
sense that it sends on or off commands

337
00:16:32,600 --> 00:16:36,290
that the devices but the few difference

338
00:16:36,290 --> 00:16:42,110
it works over tcp/ip instead of qualm it

339
00:16:42,110 --> 00:16:44,660
has many more configuration options as

340
00:16:44,660 --> 00:16:47,240
you can see here it's possible to

341
00:16:47,240 --> 00:16:52,070
specify multiple spatial entries with

342
00:16:52,070 --> 00:16:56,270
different IP addresses and it will

343
00:16:56,270 --> 00:17:00,140
connect to them in parallel that two or

344
00:17:00,140 --> 00:17:03,290
three modes of operation here is in

345
00:17:03,290 --> 00:17:10,839
configuration you can define mode

346
00:17:10,930 --> 00:17:13,790
possible modes are arranged shift and

347
00:17:13,790 --> 00:17:18,170
sequence but for one one and one of our

348
00:17:18,170 --> 00:17:20,359
attackers they don't know the types of

349
00:17:20,359 --> 00:17:25,280
highways that available so they have to

350
00:17:25,280 --> 00:17:28,460
do some kind of brute force to find out

351
00:17:28,460 --> 00:17:31,430
which will accept these commands and

352
00:17:31,430 --> 00:17:34,040
arrange this shift is used to discover

353
00:17:34,040 --> 00:17:38,420
iOS and sequence is used when once they

354
00:17:38,420 --> 00:17:42,110
are known we would construct this

355
00:17:42,110 --> 00:17:43,200
bracket

356
00:17:43,200 --> 00:17:44,909
kids on the flight thankfully to

357
00:17:44,909 --> 00:17:47,580
Versailles we can detect them and as you

358
00:17:47,580 --> 00:17:50,760
can see here this is an example of

359
00:17:50,760 --> 00:17:54,620
single command type Iowa on number 10

360
00:17:54,620 --> 00:17:58,350
the payload can write towards the

361
00:17:58,350 --> 00:18:01,440
console so attackers can can see the

362
00:18:01,440 --> 00:18:02,580
all-time what's going on

363
00:18:02,580 --> 00:18:07,080
also this it supports console not not

364
00:18:07,080 --> 00:18:09,659
only console football but also logging

365
00:18:09,659 --> 00:18:11,760
this is example demonstrate capability

366
00:18:11,760 --> 00:18:14,070
of the pay award it tries to switch

367
00:18:14,070 --> 00:18:16,919
circuit breakers to on or off in

368
00:18:16,919 --> 00:18:20,480
infinite loop and the exact project

369
00:18:20,480 --> 00:18:24,269
depends on configuration as on or off

370
00:18:24,269 --> 00:18:27,120
continuously or flip flipping back and

371
00:18:27,120 --> 00:18:34,019
forth between iterations 61 850 is a bit

372
00:18:34,019 --> 00:18:37,860
different and bit more advanced like 104

373
00:18:37,860 --> 00:18:43,700
it appraised on tcp/ip but thing is that

374
00:18:43,700 --> 00:18:47,519
it functions even if IP others is not

375
00:18:47,519 --> 00:18:50,039
defined in configuration it it has out

376
00:18:50,039 --> 00:18:52,080
the discovery features so it can

377
00:18:52,080 --> 00:18:56,039
discover these devices in the network it

378
00:18:56,039 --> 00:18:58,230
does not appear 8 on Iowa but it

379
00:18:58,230 --> 00:19:01,350
operates on named elements it looks for

380
00:19:01,350 --> 00:19:07,679
these hard-coded names and they

381
00:19:07,679 --> 00:19:10,049
correspond to circuit breakers and

382
00:19:10,049 --> 00:19:15,139
switches so it's different approach but

383
00:19:15,139 --> 00:19:18,630
same purpose to open our closed circuit

384
00:19:18,630 --> 00:19:23,250
breakers the last payload is a step

385
00:19:23,250 --> 00:19:24,779
above the rest

386
00:19:24,779 --> 00:19:28,440
it's not more advanced but it appears on

387
00:19:28,440 --> 00:19:30,870
a higher software abstraction well

388
00:19:30,870 --> 00:19:35,010
technically OPC that access can be built

389
00:19:35,010 --> 00:19:40,019
on top of 101 104 or 61 850 or even

390
00:19:40,019 --> 00:19:43,830
Modbus it uses distributed come to

391
00:19:43,830 --> 00:19:47,970
discover all running OPC servers in the

392
00:19:47,970 --> 00:19:53,100
network obtains named items and it's

393
00:19:53,100 --> 00:19:56,059
yours for this

394
00:19:56,690 --> 00:20:01,380
specific tags then it writes bad what we

395
00:20:01,380 --> 00:20:05,100
won tour items with these tags but what

396
00:20:05,100 --> 00:20:11,220
does it mean let's use this a pool by IB

397
00:20:11,220 --> 00:20:16,650
be to map the tag to actual command

398
00:20:16,650 --> 00:20:22,020
meaning as you can see here CTO open off

399
00:20:22,020 --> 00:20:25,410
is a breaking open execute command so

400
00:20:25,410 --> 00:20:28,740
again same purpose opening circuit

401
00:20:28,740 --> 00:20:33,960
breakers analyzing in the strip bingo

402
00:20:33,960 --> 00:20:37,500
the bellows is a piece of cake for skill

403
00:20:37,500 --> 00:20:39,420
the reverse engineer because they are

404
00:20:39,420 --> 00:20:47,040
not office gated or know any anti

405
00:20:47,040 --> 00:20:49,290
reversing mechanism put in place but

406
00:20:49,290 --> 00:20:52,620
they only think that can and will flow

407
00:20:52,620 --> 00:20:55,110
down your research is annoying cone

408
00:20:55,110 --> 00:20:58,620
staff so to help analyze any future

409
00:20:58,620 --> 00:21:02,850
mower that would use OPC da we released

410
00:21:02,850 --> 00:21:05,490
this either Python script and it's

411
00:21:05,490 --> 00:21:07,830
available you can check it so what it

412
00:21:07,830 --> 00:21:12,290
does here is a screenshot from Ida Pro

413
00:21:12,290 --> 00:21:16,560
here how it looks before the script and

414
00:21:16,560 --> 00:21:22,140
here how it looks after ok so I think

415
00:21:22,140 --> 00:21:23,760
all the reverse engineers in the room

416
00:21:23,760 --> 00:21:27,020
can agree that this is much much better

417
00:21:27,020 --> 00:21:32,190
so yeah so for different payloads doing

418
00:21:32,190 --> 00:21:34,350
more or less the same thing it appears

419
00:21:34,350 --> 00:21:36,810
that the authors of the malware they

420
00:21:36,810 --> 00:21:38,910
really wanted to make sure that they get

421
00:21:38,910 --> 00:21:41,480
those circuit breakers open

422
00:21:41,480 --> 00:21:45,150
so obviously what is the impact so the

423
00:21:45,150 --> 00:21:47,310
energizing a substation is is pretty

424
00:21:47,310 --> 00:21:51,150
obvious and it actually happened we can

425
00:21:51,150 --> 00:21:52,650
also speculate that perhaps they wanted

426
00:21:52,650 --> 00:21:55,530
to do something more because they could

427
00:21:55,530 --> 00:21:57,420
have used a lot much less sophisticated

428
00:21:57,420 --> 00:21:59,130
piece of malware just to cause a

429
00:21:59,130 --> 00:22:04,260
blackout as we witness in 2015 if you

430
00:22:04,260 --> 00:22:06,180
remember the aurora test or our

431
00:22:06,180 --> 00:22:09,220
generator test from back in 2007

432
00:22:09,220 --> 00:22:11,890
it demonstrated how out of sync opening

433
00:22:11,890 --> 00:22:13,270
and closing a circuit breakers could

434
00:22:13,270 --> 00:22:15,549
lead to actual physical destruction of

435
00:22:15,549 --> 00:22:20,140
an equipment so if you didn't didn't see

436
00:22:20,140 --> 00:22:22,110
that or I recommend going to youtube

437
00:22:22,110 --> 00:22:27,130
searching for that video of diesel

438
00:22:27,130 --> 00:22:29,230
generator blowing up itself it's pretty

439
00:22:29,230 --> 00:22:34,150
pretty interesting okay so that was the

440
00:22:34,150 --> 00:22:36,970
first and most important type of payload

441
00:22:36,970 --> 00:22:38,919
functionality but there were the second

442
00:22:38,919 --> 00:22:41,230
type of functionality which directly

443
00:22:41,230 --> 00:22:43,419
effects the ICS environment is a denial

444
00:22:43,419 --> 00:22:46,000
denial of service attack caused by that

445
00:22:46,000 --> 00:22:49,870
do s module that I've shown earlier and

446
00:22:49,870 --> 00:22:52,480
its purpose is rendering protection

447
00:22:52,480 --> 00:22:55,419
relays irresponsive it does so by

448
00:22:55,419 --> 00:22:58,419
exploiting this vulnerability in Siemens

449
00:22:58,419 --> 00:23:00,760
C protect devices so it's specific to

450
00:23:00,760 --> 00:23:03,520
this one vendor that vulnerability is

451
00:23:03,520 --> 00:23:06,730
described in this ics-cert advisory and

452
00:23:06,730 --> 00:23:09,190
the way it works is that the module

453
00:23:09,190 --> 00:23:12,789
sends specifically crafted UDP packets

454
00:23:12,789 --> 00:23:16,870
to port 50,000 so knocking these devices

455
00:23:16,870 --> 00:23:19,419
out serves to amplify the effect the

456
00:23:19,419 --> 00:23:21,580
impact of the payload which Anton talked

457
00:23:21,580 --> 00:23:24,340
about now Siemens did patch this

458
00:23:24,340 --> 00:23:26,260
vulnerability and a firmware update but

459
00:23:26,260 --> 00:23:28,659
you can probably imagine how often these

460
00:23:28,659 --> 00:23:33,880
devices actually get updated and the

461
00:23:33,880 --> 00:23:36,549
third and final type of payload

462
00:23:36,549 --> 00:23:39,039
functionality discovered in in destroyer

463
00:23:39,039 --> 00:23:43,150
is the data wiper module and its purpose

464
00:23:43,150 --> 00:23:46,240
is to make recovery after the attack a

465
00:23:46,240 --> 00:23:48,400
lot more difficult it goes not after the

466
00:23:48,400 --> 00:23:51,510
devices the ICC's intelligent electronic

467
00:23:51,510 --> 00:23:54,850
IDs intelligent electronic devices but

468
00:23:54,850 --> 00:23:57,669
after the workstations used to configure

469
00:23:57,669 --> 00:24:00,669
them it's launched by the launcher

470
00:24:00,669 --> 00:24:03,159
components again depending on the

471
00:24:03,159 --> 00:24:04,840
particular sample either one or two

472
00:24:04,840 --> 00:24:08,140
hours after the payload modules were

473
00:24:08,140 --> 00:24:13,179
executed and it goes after files with

474
00:24:13,179 --> 00:24:15,820
these extensions now we've remembered

475
00:24:15,820 --> 00:24:18,070
O's 2 examples of SCADA software that I

476
00:24:18,070 --> 00:24:20,770
showed you earlier is going against

477
00:24:20,770 --> 00:24:22,870
current is going after configuring

478
00:24:22,870 --> 00:24:26,260
files of these these kinds of

479
00:24:26,260 --> 00:24:31,390
applications so it will clear over right

480
00:24:31,390 --> 00:24:34,900
wipe out the conflicts of SCADA software

481
00:24:34,900 --> 00:24:36,880
furthermore it will render the Machine

482
00:24:36,880 --> 00:24:39,280
unbootable by corrupting its registry

483
00:24:39,280 --> 00:24:41,559
and finally it will crash crash it by

484
00:24:41,559 --> 00:24:43,780
killing all including system processes

485
00:24:43,780 --> 00:24:47,050
so what's going on from the perspective

486
00:24:47,050 --> 00:24:49,809
of an operator working at a substation

487
00:24:49,809 --> 00:24:53,290
so you have your protection your your

488
00:24:53,290 --> 00:24:55,450
circuit breakers continuously being

489
00:24:55,450 --> 00:24:58,990
reopened the substation the substation

490
00:24:58,990 --> 00:25:02,350
is being de-energized your protection

491
00:25:02,350 --> 00:25:04,660
relays are not responding and if you go

492
00:25:04,660 --> 00:25:06,429
and sit down try to fix the problem you

493
00:25:06,429 --> 00:25:09,929
find that your SCADA software is gone so

494
00:25:09,929 --> 00:25:12,580
not the best scenario for for someone

495
00:25:12,580 --> 00:25:13,809
like that and it's also another

496
00:25:13,809 --> 00:25:15,400
demonstration of the importance of

497
00:25:15,400 --> 00:25:19,210
backups offline backups so let's finish

498
00:25:19,210 --> 00:25:21,730
off with a couple of takeaways as you've

499
00:25:21,730 --> 00:25:24,340
seen as we've shown in distress

500
00:25:24,340 --> 00:25:27,520
capabilities are rather versatile it was

501
00:25:27,520 --> 00:25:30,690
the cause of the last Ukrainian blackout

502
00:25:30,690 --> 00:25:33,850
but it's also really configurable and

503
00:25:33,850 --> 00:25:36,160
can really easily be repurposed to

504
00:25:36,160 --> 00:25:39,010
attack power grids and it's not just

505
00:25:39,010 --> 00:25:40,809
limited to the Ukraine in other words

506
00:25:40,809 --> 00:25:43,090
this attack could happen anywhere in the

507
00:25:43,090 --> 00:25:46,990
world it's a scalable and dangerous

508
00:25:46,990 --> 00:25:49,750
threat against ICS as we've said the

509
00:25:49,750 --> 00:25:52,690
biggest since Stuxnet but the gist of

510
00:25:52,690 --> 00:25:54,910
the threat is not just in the malware

511
00:25:54,910 --> 00:25:58,050
itself but skill set and dedication of

512
00:25:58,050 --> 00:26:02,710
the malware operator it's about it's not

513
00:26:02,710 --> 00:26:04,120
just about coding the malware but it's

514
00:26:04,120 --> 00:26:06,280
in their ability which they demonstrated

515
00:26:06,280 --> 00:26:08,980
in Ukraine to become familiar with the

516
00:26:08,980 --> 00:26:11,230
architecture of the industrial site that

517
00:26:11,230 --> 00:26:13,510
they want to target so what devices

518
00:26:13,510 --> 00:26:15,490
there are what commands to send to these

519
00:26:15,490 --> 00:26:17,830
devices and what will happen is as a

520
00:26:17,830 --> 00:26:19,809
result because this is not the typical

521
00:26:19,809 --> 00:26:23,110
scenario that typical malware writers

522
00:26:23,110 --> 00:26:29,710
are used to and finally the blackouts

523
00:26:29,710 --> 00:26:33,940
which which occurred last December it

524
00:26:33,940 --> 00:26:36,640
hit one it was a transmission

525
00:26:36,640 --> 00:26:38,890
facility unlike in 2015 where they had

526
00:26:38,890 --> 00:26:41,470
electricity distribution facilities but

527
00:26:41,470 --> 00:26:43,680
it was one electricity transmission

528
00:26:43,680 --> 00:26:47,830
facility in the north of Kiev so the

529
00:26:47,830 --> 00:26:50,470
scale of the impact was was pretty large

530
00:26:50,470 --> 00:26:53,770
this transmission facility produces more

531
00:26:53,770 --> 00:26:58,120
power output than then all of the all of

532
00:26:58,120 --> 00:27:03,370
the distribution and there go companies

533
00:27:03,370 --> 00:27:06,160
in the 2015 attack combined but the

534
00:27:06,160 --> 00:27:09,640
duration of the attack wasn't it didn't

535
00:27:09,640 --> 00:27:11,680
take that long the power of the lights

536
00:27:11,680 --> 00:27:14,200
worked out for that long which is kudos

537
00:27:14,200 --> 00:27:15,430
to the Ukrainians that they were they

538
00:27:15,430 --> 00:27:17,920
were able to recover so quickly it

539
00:27:17,920 --> 00:27:20,920
lasted about one hour but the point I'm

540
00:27:20,920 --> 00:27:23,010
trying to make is that if you have a

541
00:27:23,010 --> 00:27:27,100
piece of malware a cyber weapon with

542
00:27:27,100 --> 00:27:30,030
capabilities as we've demonstrated a

543
00:27:30,030 --> 00:27:32,950
blackout of one hour around midnight is

544
00:27:32,950 --> 00:27:34,570
probably not the worst you can do right

545
00:27:34,570 --> 00:27:38,050
so it begs the question what happened

546
00:27:38,050 --> 00:27:40,990
why was that either they were not a

547
00:27:40,990 --> 00:27:42,700
hundred percent successful in their

548
00:27:42,700 --> 00:27:46,050
attack or another hypothesis which is

549
00:27:46,050 --> 00:27:49,240
what we believe is that it was not just

550
00:27:49,240 --> 00:27:51,190
a demonstration of their abilities but

551
00:27:51,190 --> 00:27:53,290
also a test they could be planning

552
00:27:53,290 --> 00:27:55,450
something more so let's keep our eyes

553
00:27:55,450 --> 00:27:59,970
open and thank you for your attention

