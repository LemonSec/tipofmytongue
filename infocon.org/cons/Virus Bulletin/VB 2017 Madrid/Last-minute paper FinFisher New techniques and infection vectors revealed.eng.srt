1
00:00:00,560 --> 00:00:04,740
thank you so hello everyone let's have

2
00:00:04,740 --> 00:00:07,020
show of hands who are not familiar with

3
00:00:07,020 --> 00:00:11,190
finfisher okay as expected most of you

4
00:00:11,190 --> 00:00:13,650
are but here's a trivia question for you

5
00:00:13,650 --> 00:00:19,470
who is the company behind in Fisher yeah

6
00:00:19,470 --> 00:00:20,990
you see now it's not so straightforward

7
00:00:20,990 --> 00:00:23,250
when it will write three Fisher into

8
00:00:23,250 --> 00:00:24,960
Google you can find website official

9
00:00:24,960 --> 00:00:27,859
calm and there is some company finfisher

10
00:00:27,859 --> 00:00:31,980
gmbh in germany but then there is

11
00:00:31,980 --> 00:00:34,620
another company called gamma group there

12
00:00:34,620 --> 00:00:36,870
are something like their owners or there

13
00:00:36,870 --> 00:00:39,660
are in some another relationship so yeah

14
00:00:39,660 --> 00:00:42,390
the company behind finfisher whatever it

15
00:00:42,390 --> 00:00:45,180
is their sells their products as law

16
00:00:45,180 --> 00:00:47,700
enforcement tools to governments and

17
00:00:47,700 --> 00:00:51,120
their agencies in other words it's a

18
00:00:51,120 --> 00:00:54,989
spyware let's take a look what we

19
00:00:54,989 --> 00:00:57,809
already know about this in famous spy

20
00:00:57,809 --> 00:01:01,699
ver first attribution was in 2012

21
00:01:01,699 --> 00:01:04,049
security researchers attributed the

22
00:01:04,049 --> 00:01:06,600
sample to the company behind finfisher

23
00:01:06,600 --> 00:01:09,030
in the same year there was a huge affair

24
00:01:09,030 --> 00:01:11,630
about abusing these tools against

25
00:01:11,630 --> 00:01:14,700
political dissidents journalists and

26
00:01:14,700 --> 00:01:21,180
other people like this then in 2014 the

27
00:01:21,180 --> 00:01:23,790
company was hacked and the data leaved

28
00:01:23,790 --> 00:01:26,220
public you can find raw data on

29
00:01:26,220 --> 00:01:31,680
WikiLeaks for example data includes cut

30
00:01:31,680 --> 00:01:35,820
their customers price list and also the

31
00:01:35,820 --> 00:01:41,070
binary the spider itself even when the

32
00:01:41,070 --> 00:01:45,090
hog was in 2014 the samples are actually

33
00:01:45,090 --> 00:01:48,659
from 2010 those samples are analyzed by

34
00:01:48,659 --> 00:01:50,640
many security researchers because you

35
00:01:50,640 --> 00:01:52,649
know it was big hype the company was

36
00:01:52,649 --> 00:01:54,600
hacked beneficial so let's analyze the

37
00:01:54,600 --> 00:01:56,909
samples yeah those are analyzed but

38
00:01:56,909 --> 00:01:59,430
there are old ones there is nothing

39
00:01:59,430 --> 00:02:03,180
special there no food station just all

40
00:02:03,180 --> 00:02:08,758
samples yeah so then finisher from time

41
00:02:08,758 --> 00:02:10,500
to time attracts attention of security

42
00:02:10,500 --> 00:02:12,860
researcher where an

43
00:02:12,860 --> 00:02:15,650
they discovered that it exploits um all

44
00:02:15,650 --> 00:02:19,000
the exploits for example the last one

45
00:02:19,000 --> 00:02:21,020
against Microsoft wart

46
00:02:21,020 --> 00:02:23,740
it was abused against people in Russia

47
00:02:23,740 --> 00:02:25,910
common distribution method to spread

48
00:02:25,910 --> 00:02:28,700
cream Fisher's in in the past was via

49
00:02:28,700 --> 00:02:32,030
spear phishing emails with for example

50
00:02:32,030 --> 00:02:37,030
malicious documents or infected links

51
00:02:37,030 --> 00:02:39,650
finfisher attract our attention when

52
00:02:39,650 --> 00:02:42,440
they abused recent geo day at first

53
00:02:42,440 --> 00:02:45,590
honestly i was surprised that all unlike

54
00:02:45,590 --> 00:02:50,240
finfisher is it still active we wanted

55
00:02:50,240 --> 00:02:52,970
to know more what's inside the binary

56
00:02:52,970 --> 00:02:55,370
whether there are not some improvements

57
00:02:55,370 --> 00:02:58,760
or what we can find there and we wasn't

58
00:02:58,760 --> 00:03:02,050
able to find any detailed analysis of

59
00:03:02,050 --> 00:03:05,770
finfisher numerous samples only this

60
00:03:05,770 --> 00:03:08,870
analysis of these samples of the old

61
00:03:08,870 --> 00:03:12,590
ones every time some researcher reports

62
00:03:12,590 --> 00:03:14,150
about fifa sure they don't go into

63
00:03:14,150 --> 00:03:18,170
technical details so we looked deeper

64
00:03:18,170 --> 00:03:20,600
and we found that finnish sample

65
00:03:20,600 --> 00:03:23,510
numerous samples are heavily obfuscated

66
00:03:23,510 --> 00:03:27,350
and it makes sense when you sell to

67
00:03:27,350 --> 00:03:29,630
governments you need to put extra effort

68
00:03:29,630 --> 00:03:34,190
then are in hiding in avoiding antivirus

69
00:03:34,190 --> 00:03:37,459
product obfuscation to prevent being

70
00:03:37,459 --> 00:03:42,650
analyzed by security researchers oh yeah

71
00:03:42,650 --> 00:03:44,870
and so they've got pretty good

72
00:03:44,870 --> 00:03:47,810
protections and we have spent a lot of

73
00:03:47,810 --> 00:03:50,120
time of beating them especially this one

74
00:03:50,120 --> 00:03:52,370
custom virtual machine and we were

75
00:03:52,370 --> 00:03:54,820
successful we Delphis katy the sample

76
00:03:54,820 --> 00:03:57,620
when you open the sample in ida pro you

77
00:03:57,620 --> 00:03:59,150
will find that every instruction is

78
00:03:59,150 --> 00:04:02,090
followed by two conditional jumps which

79
00:04:02,090 --> 00:04:05,450
acts together as one unconditional jump

80
00:04:05,450 --> 00:04:08,420
while this trick is not new we've seen

81
00:04:08,420 --> 00:04:09,890
that in the past in common must

82
00:04:09,890 --> 00:04:13,130
spreading malware but the common cyber

83
00:04:13,130 --> 00:04:15,500
criminals use this trick only once or

84
00:04:15,500 --> 00:04:17,988
twice in the binary but finfisher

85
00:04:17,988 --> 00:04:20,690
spyware is obfuscated like this for the

86
00:04:20,690 --> 00:04:24,229
whole binary no problem you can overcome

87
00:04:24,229 --> 00:04:26,450
this by patching to conditional

88
00:04:26,450 --> 00:04:30,020
into one unconditional and after few

89
00:04:30,020 --> 00:04:31,730
more improvements you will get graph

90
00:04:31,730 --> 00:04:34,970
like this this is a virtual machine with

91
00:04:34,970 --> 00:04:38,750
byte code inside the binary so it is not

92
00:04:38,750 --> 00:04:44,300
Packer it is built on machine and those

93
00:04:44,300 --> 00:04:46,390
virtual machines are known from

94
00:04:46,390 --> 00:04:48,830
anti-pirate protections they are

95
00:04:48,830 --> 00:04:51,530
considered as best protection mechanism

96
00:04:51,530 --> 00:04:54,620
we know for example VM protect or code

97
00:04:54,620 --> 00:04:58,400
we're polish there from Oren's yeah it's

98
00:04:58,400 --> 00:05:01,640
very well designed and implemented it's

99
00:05:01,640 --> 00:05:05,480
got 34 vm handlers so they are still

100
00:05:05,480 --> 00:05:08,600
improving it because four years ago they

101
00:05:08,600 --> 00:05:14,240
had only 10 vm handlers you can overcome

102
00:05:14,240 --> 00:05:16,310
this protection by writing your own by

103
00:05:16,310 --> 00:05:18,560
analyzing this interpreter and writing

104
00:05:18,560 --> 00:05:21,350
your own interpreter and then parse

105
00:05:21,350 --> 00:05:23,960
bytecode we did it we fully they will

106
00:05:23,960 --> 00:05:27,550
polarize the sample and we have found

107
00:05:27,550 --> 00:05:30,290
the first configuration in the picture

108
00:05:30,290 --> 00:05:33,350
frequency sell the code of the

109
00:05:33,350 --> 00:05:36,980
virtualization so they are checking for

110
00:05:36,980 --> 00:05:40,040
image times then the last bit of image

111
00:05:40,040 --> 00:05:43,010
times them whether it is set or not if

112
00:05:43,010 --> 00:05:46,130
it is said they are trying to detect

113
00:05:46,130 --> 00:05:50,180
virtual environment like VMware or vr-12

114
00:05:50,180 --> 00:05:54,410
box and if detected execution exists

115
00:05:54,410 --> 00:05:59,000
exits if the last bit of image timestamp

116
00:05:59,000 --> 00:06:02,630
is not set it is compatible with virtual

117
00:06:02,630 --> 00:06:07,580
environment in one sample we have also

118
00:06:07,580 --> 00:06:09,890
found one ant emulation trick the

119
00:06:09,890 --> 00:06:11,540
intention of ant emulation is not to

120
00:06:11,540 --> 00:06:13,490
make it harder for others engineers or

121
00:06:13,490 --> 00:06:16,370
malva researchers but to avoid evade

122
00:06:16,370 --> 00:06:18,950
antivirus products in specific their

123
00:06:18,950 --> 00:06:23,270
scanners and emulators while reverse

124
00:06:23,270 --> 00:06:25,400
engineering of the finisher sample was

125
00:06:25,400 --> 00:06:28,220
very interesting it was a hard topic

126
00:06:28,220 --> 00:06:30,790
good challenge

127
00:06:33,390 --> 00:06:36,840
I can continue no problem it still

128
00:06:36,840 --> 00:06:38,820
wasn't the most interesting thing about

129
00:06:38,820 --> 00:06:43,890
recent finfisher campaigns so the most

130
00:06:43,890 --> 00:06:46,170
interesting thing about recent future

131
00:06:46,170 --> 00:06:48,920
campaigns was a new distribution method

132
00:06:48,920 --> 00:06:51,810
while we were reverse-engineering the

133
00:06:51,810 --> 00:06:53,880
sample we looked at other prevalence of

134
00:06:53,880 --> 00:06:55,890
finfisher samples and we have found

135
00:06:55,890 --> 00:06:59,700
something what had icon we all see name

136
00:06:59,700 --> 00:07:01,860
we all see and after execution it really

137
00:07:01,860 --> 00:07:05,430
Iran's VLC installer but actually it was

138
00:07:05,430 --> 00:07:08,670
VLC player organized with finisher after

139
00:07:08,670 --> 00:07:12,140
execution it drops to the same place

140
00:07:12,140 --> 00:07:14,970
original binary digitally signed we all

141
00:07:14,970 --> 00:07:17,490
see and execute it while on the same

142
00:07:17,490 --> 00:07:20,310
time in finfisher spy ver is installed

143
00:07:20,310 --> 00:07:24,330
on the computer well did something

144
00:07:24,330 --> 00:07:26,990
unusual so let's take a look at another

145
00:07:26,990 --> 00:07:30,600
samples and other evidence we have found

146
00:07:30,600 --> 00:07:33,810
more than 12 applications Trojan IV

147
00:07:33,810 --> 00:07:38,550
finisher so far a lot of them had trojan

148
00:07:38,550 --> 00:07:40,860
eyes many versions many versions with

149
00:07:40,860 --> 00:07:43,920
local language settings 32-bit

150
00:07:43,920 --> 00:07:48,950
application and also 64-bit application

151
00:07:48,950 --> 00:07:52,110
but hold on as I mentioned at the

152
00:07:52,110 --> 00:07:54,750
beginning common distribution method for

153
00:07:54,750 --> 00:07:57,180
finisher in the past was spear phishing

154
00:07:57,180 --> 00:08:00,150
emails how do he'll do spread trojan

155
00:08:00,150 --> 00:08:04,530
eyes applications I mean it could work

156
00:08:04,530 --> 00:08:08,370
for it could work for common cyber

157
00:08:08,370 --> 00:08:10,620
criminals for mass spreading malware of

158
00:08:10,620 --> 00:08:13,830
course but I don't think that it could

159
00:08:13,830 --> 00:08:18,330
work work for targeted attack so hide

160
00:08:18,330 --> 00:08:21,840
how they spread this we have found that

161
00:08:21,840 --> 00:08:24,720
the only website were or URL domain

162
00:08:24,720 --> 00:08:26,580
where the Trojan has application layer

163
00:08:26,580 --> 00:08:31,020
is this one this domain followed by md5

164
00:08:31,020 --> 00:08:35,580
hash okay now it starts to make more

165
00:08:35,580 --> 00:08:40,799
sense but still I guess that victims or

166
00:08:40,799 --> 00:08:44,760
targets doesn't write this this URL into

167
00:08:44,760 --> 00:08:46,329
the URL bar into

168
00:08:46,329 --> 00:08:49,329
browser manually you know so how they

169
00:08:49,329 --> 00:08:52,809
encountered this domain and we have

170
00:08:52,809 --> 00:08:56,889
found that they visited official VLC

171
00:08:56,889 --> 00:08:59,860
website for example and when clicking on

172
00:08:59,860 --> 00:09:03,119
download button they were sent to

173
00:09:03,119 --> 00:09:07,360
website very strong eyes finisher so yes

174
00:09:07,360 --> 00:09:12,639
they were redirected someone in the

175
00:09:12,639 --> 00:09:14,649
middle and the target for example here

176
00:09:14,649 --> 00:09:16,149
the server someone in the middle

177
00:09:16,149 --> 00:09:18,309
modified the response from the server

178
00:09:18,309 --> 00:09:23,470
with this code and redirected target to

179
00:09:23,470 --> 00:09:25,980
server where words trojan eyes

180
00:09:25,980 --> 00:09:30,189
application with finisher by the way we

181
00:09:30,189 --> 00:09:33,519
didn't see HTTP redirection from from

182
00:09:33,519 --> 00:09:38,499
SSL encrypted communication when so many

183
00:09:38,499 --> 00:09:41,230
of our customers are redirected for such

184
00:09:41,230 --> 00:09:44,139
a long time it starts to be very strange

185
00:09:44,139 --> 00:09:48,069
the question is from which point the

186
00:09:48,069 --> 00:09:54,009
attacker redirected the targets it could

187
00:09:54,009 --> 00:09:56,829
be on Wi-Fi level we don't know whether

188
00:09:56,829 --> 00:09:59,949
our customers were on desktop PC or

189
00:09:59,949 --> 00:10:01,959
laptop but let's imagine they had laptop

190
00:10:01,959 --> 00:10:04,269
so there were on Wi-Fi it could be

191
00:10:04,269 --> 00:10:06,850
somebody the attacker could hacked their

192
00:10:06,850 --> 00:10:09,389
Wi-Fi yes

193
00:10:09,389 --> 00:10:12,519
it could be on the viral inside the

194
00:10:12,519 --> 00:10:15,429
building or of course on the wire in

195
00:10:15,429 --> 00:10:19,839
front of the building let's take a look

196
00:10:19,839 --> 00:10:22,389
Buddha where the Aten the targets were

197
00:10:22,389 --> 00:10:32,739
sitting while there were redirected in

198
00:10:32,739 --> 00:10:34,779
the picture we can see the map and not

199
00:10:34,779 --> 00:10:37,029
are not the real one but the purpose is

200
00:10:37,029 --> 00:10:38,980
just to show you the distances between

201
00:10:38,980 --> 00:10:43,629
the cities were targets were located

202
00:10:43,629 --> 00:10:45,939
when they were redirected the distance

203
00:10:45,939 --> 00:10:50,499
from City a to city D is 1000 plus

204
00:10:50,499 --> 00:10:54,850
kilometers so shall the attacker operate

205
00:10:54,850 --> 00:10:57,610
on Wi-Fi level or on the wire in front

206
00:10:57,610 --> 00:10:58,930
of the building

207
00:10:58,930 --> 00:11:02,380
it would be very hard to target so many

208
00:11:02,380 --> 00:11:06,190
victims for such a long time on such a

209
00:11:06,190 --> 00:11:08,649
big distances so I don't see this debt

210
00:11:08,649 --> 00:11:10,410
as an option

211
00:11:10,410 --> 00:11:15,420
it could be infected router of course

212
00:11:15,420 --> 00:11:21,339
but yes so the most probable attacking

213
00:11:21,339 --> 00:11:24,670
scenario when attacker decides to infect

214
00:11:24,670 --> 00:11:27,760
the router would be following attacker

215
00:11:27,760 --> 00:11:30,760
in fact infects router then he replaces

216
00:11:30,760 --> 00:11:35,890
primary DNS server to his own in DHCP

217
00:11:35,890 --> 00:11:38,860
server configuration so when the target

218
00:11:38,860 --> 00:11:42,010
is going to visit website the attacker

219
00:11:42,010 --> 00:11:44,740
would change the IP address and there

220
00:11:44,740 --> 00:11:47,910
could be either phishing website or

221
00:11:47,910 --> 00:11:51,339
transparent proxy but let me show you

222
00:11:51,339 --> 00:11:53,920
redirect once again to redirect the

223
00:11:53,920 --> 00:11:56,200
Trojans application it was done with

224
00:11:56,200 --> 00:12:00,010
this code so it wasn't the case we have

225
00:12:00,010 --> 00:12:02,430
seen that the target is on the real

226
00:12:02,430 --> 00:12:05,440
official VLC website but he was

227
00:12:05,440 --> 00:12:09,850
redirected with this code so these are

228
00:12:09,850 --> 00:12:11,770
attacking scenario doesn't fit

229
00:12:11,770 --> 00:12:16,630
we've infected router there are other

230
00:12:16,630 --> 00:12:17,310
options

231
00:12:17,310 --> 00:12:20,709
it could be more far away for example

232
00:12:20,709 --> 00:12:23,220
the software vendors could be hacked

233
00:12:23,220 --> 00:12:27,010
we've seen in the past that there are

234
00:12:27,010 --> 00:12:30,100
few examples that companies software

235
00:12:30,100 --> 00:12:32,500
vendors were were hacked and the malware

236
00:12:32,500 --> 00:12:34,750
was deployed to target through hacked

237
00:12:34,750 --> 00:12:37,360
company but do you remember the slide

238
00:12:37,360 --> 00:12:39,430
where I showed you trojan as

239
00:12:39,430 --> 00:12:42,339
applications there are a lot of them so

240
00:12:42,339 --> 00:12:44,890
it is highly unlikely that so many

241
00:12:44,890 --> 00:12:47,380
software vendors would be hacked for

242
00:12:47,380 --> 00:12:49,839
such a long time and they would spread

243
00:12:49,839 --> 00:12:53,410
finfisher spider I don't see this as an

244
00:12:53,410 --> 00:12:57,430
option of course there could be some

245
00:12:57,430 --> 00:13:00,670
three-letter agency on the wire outside

246
00:13:00,670 --> 00:13:05,950
of the country yeah but you know

247
00:13:05,950 --> 00:13:08,050
attacking another country with

248
00:13:08,050 --> 00:13:11,740
commercial salts fiber finish on the

249
00:13:11,740 --> 00:13:12,790
spyware is deep

250
00:13:12,790 --> 00:13:16,360
by a lot of antivirus vendors so it

251
00:13:16,360 --> 00:13:19,570
wouldn't be effective method how to

252
00:13:19,570 --> 00:13:21,580
attack another country so when we put so

253
00:13:21,580 --> 00:13:26,260
much effort into hijacking the wire you

254
00:13:26,260 --> 00:13:28,510
wouldn't probably use finfisher spider

255
00:13:28,510 --> 00:13:32,490
and there there is one option left

256
00:13:32,490 --> 00:13:37,480
Internet service provider but hold on

257
00:13:37,480 --> 00:13:40,900
internet service provider I mean it was

258
00:13:40,900 --> 00:13:44,740
never observed in the past that Internet

259
00:13:44,740 --> 00:13:47,290
service provider infects targets or

260
00:13:47,290 --> 00:13:49,960
malware is deployed through Internet

261
00:13:49,960 --> 00:13:55,630
service provider even if we realize what

262
00:13:55,630 --> 00:13:56,530
it would mean

263
00:13:56,530 --> 00:13:59,350
it still looks as the most probable

264
00:13:59,350 --> 00:14:05,110
option right now but is P then let's try

265
00:14:05,110 --> 00:14:09,970
to find some another evidence yeah there

266
00:14:09,970 --> 00:14:11,770
are some similar similarities between

267
00:14:11,770 --> 00:14:14,370
the targets they are all under the same

268
00:14:14,370 --> 00:14:17,580
internet service provider the issued one

269
00:14:17,580 --> 00:14:21,460
ISP has approximately 90% of the market

270
00:14:21,460 --> 00:14:27,490
in the country well let's take a look at

271
00:14:27,490 --> 00:14:31,270
the leak on the WikiLeaks and we found

272
00:14:31,270 --> 00:14:34,840
that there is a product called fin fly

273
00:14:34,840 --> 00:14:39,580
ISP according to their documentation fin

274
00:14:39,580 --> 00:14:42,730
fly ISP is a strategic country right as

275
00:14:42,730 --> 00:14:45,190
well as a tactical solution that can be

276
00:14:45,190 --> 00:14:53,430
integrated into ISPs access then ISP

277
00:14:53,430 --> 00:14:57,660
really let's try find another evidence

278
00:14:57,660 --> 00:15:02,080
and we have found we focused on that ice

279
00:15:02,080 --> 00:15:05,440
beam and we have found that there got

280
00:15:05,440 --> 00:15:10,690
some censorship in the country but but

281
00:15:10,690 --> 00:15:14,050
first let's keep this for for a second

282
00:15:14,050 --> 00:15:16,150
and first I would like to explain what

283
00:15:16,150 --> 00:15:18,700
redirect actually is so it is a

284
00:15:18,700 --> 00:15:21,010
legitimate functionality provided by

285
00:15:21,010 --> 00:15:26,500
browsers when user visits URL and

286
00:15:26,500 --> 00:15:28,930
the URL is not available server consent

287
00:15:28,930 --> 00:15:34,060
redirect to user and browsers handles

288
00:15:34,060 --> 00:15:37,570
this redirect and they redirect

289
00:15:37,570 --> 00:15:40,900
automatically user to new website there

290
00:15:40,900 --> 00:15:42,820
are a lot of redirects which could be

291
00:15:42,820 --> 00:15:44,980
used for example HTTP or script

292
00:15:44,980 --> 00:15:48,610
resurrects just let's take a look at the

293
00:15:48,610 --> 00:15:50,410
random examples for example script

294
00:15:50,410 --> 00:15:53,920
redirect following codes could be used

295
00:15:53,920 --> 00:15:58,570
to redirect customer or user for example

296
00:15:58,570 --> 00:16:00,640
this JavaScript code is just a random

297
00:16:00,640 --> 00:16:05,500
example of code or this HTML code can be

298
00:16:05,500 --> 00:16:10,080
used to redirect user

299
00:16:10,080 --> 00:16:13,960
there are HTTP redirects a lot of them

300
00:16:13,960 --> 00:16:16,870
but in attack I am describing we know

301
00:16:16,870 --> 00:16:21,480
that they used HTTP 307 redirect so

302
00:16:21,480 --> 00:16:23,920
let's take a look only into this

303
00:16:23,920 --> 00:16:27,940
redirect this is another example just a

304
00:16:27,940 --> 00:16:32,010
random example of HTTP 307 redirect

305
00:16:32,010 --> 00:16:36,370
there is header temporary with HTTP 307

306
00:16:36,370 --> 00:16:39,880
temporary redirect something location

307
00:16:39,880 --> 00:16:42,340
followed by URL which browser visits

308
00:16:42,340 --> 00:16:45,910
then connection keep alive and something

309
00:16:45,910 --> 00:16:48,030
something something it's not important

310
00:16:48,030 --> 00:16:54,030
this is just another random redirect

311
00:16:54,030 --> 00:16:57,630
header HTTP 307 temporary redirect

312
00:16:57,630 --> 00:17:01,780
something location URL and something

313
00:17:01,780 --> 00:17:03,460
something something it's not important

314
00:17:03,460 --> 00:17:05,800
this is another one just random example

315
00:17:05,800 --> 00:17:10,060
of redirect how it could look like you

316
00:17:10,060 --> 00:17:13,000
got even if you choose HTTP 307

317
00:17:13,000 --> 00:17:15,220
redirects you've got unlimited of

318
00:17:15,220 --> 00:17:17,200
options what form

319
00:17:17,200 --> 00:17:22,630
could it have it's up to you as I

320
00:17:22,630 --> 00:17:24,849
mentioned Internet service provider in

321
00:17:24,849 --> 00:17:28,569
the country is filtering the Internet

322
00:17:28,569 --> 00:17:31,120
there are some censorship there when you

323
00:17:31,120 --> 00:17:33,420
are there customer you can choose that

324
00:17:33,420 --> 00:17:36,790
you can choose parental control as the

325
00:17:36,790 --> 00:17:37,940
voluntary

326
00:17:37,940 --> 00:17:40,879
voluntary yes so when you is it

327
00:17:40,879 --> 00:17:43,279
forbidden website insert Internet

328
00:17:43,279 --> 00:17:45,919
service provider redirects you to a new

329
00:17:45,919 --> 00:17:48,289
website which announces something like

330
00:17:48,289 --> 00:17:50,419
you are not allowed to visit that

331
00:17:50,419 --> 00:17:54,230
website this censorship is done by

332
00:17:54,230 --> 00:17:56,539
Internet service provider and they used

333
00:17:56,539 --> 00:18:02,059
this code for this let's take a look

334
00:18:02,059 --> 00:18:06,200
once again what redirect was used for

335
00:18:06,200 --> 00:18:08,059
redirect targets to trojan eyes

336
00:18:08,059 --> 00:18:13,100
applications it was this code yes it is

337
00:18:13,100 --> 00:18:18,559
the very same Internet service provider

338
00:18:18,559 --> 00:18:20,750
or their customers in the country have

339
00:18:20,750 --> 00:18:22,820
even not everyone there at least

340
00:18:22,820 --> 00:18:27,350
somebody has a limit on the internet so

341
00:18:27,350 --> 00:18:29,960
once their customer reaches the limit of

342
00:18:29,960 --> 00:18:32,509
the internet he is redirected to website

343
00:18:32,509 --> 00:18:34,940
which announces something like you don't

344
00:18:34,940 --> 00:18:37,340
have data limit you are out of the limit

345
00:18:37,340 --> 00:18:39,590
so you are not allowed to visit a

346
00:18:39,590 --> 00:18:43,669
website or surf internet anymore this

347
00:18:43,669 --> 00:18:45,679
redirect is done by Internet service

348
00:18:45,679 --> 00:18:48,909
provider and they they used this code

349
00:18:48,909 --> 00:18:52,250
let me show you once again the code used

350
00:18:52,250 --> 00:18:54,379
for redirects to trojan eyes

351
00:18:54,379 --> 00:19:01,600
applications yeah it is the same

352
00:19:01,600 --> 00:19:04,039
according to leak the documentation this

353
00:19:04,039 --> 00:19:07,700
product has a mode which detects PE

354
00:19:07,700 --> 00:19:11,750
files on the fly and once detected they

355
00:19:11,750 --> 00:19:14,899
can trojan eyes P files with finfisher

356
00:19:14,899 --> 00:19:18,980
or any other malware when we've seen so

357
00:19:18,980 --> 00:19:21,350
many trojan ass applications various

358
00:19:21,350 --> 00:19:26,029
versions redirects from such as uncommon

359
00:19:26,029 --> 00:19:28,549
websites like this we believe this

360
00:19:28,549 --> 00:19:31,490
product was used they detected that

361
00:19:31,490 --> 00:19:33,679
target is going to download trojan eyes

362
00:19:33,679 --> 00:19:36,230
application or download application they

363
00:19:36,230 --> 00:19:39,230
trojan eyes dit on the fly saved it for

364
00:19:39,230 --> 00:19:42,909
later usage and firewall redirect

365
00:19:42,909 --> 00:19:45,940
redirected targets to trojan eyes

366
00:19:45,940 --> 00:19:48,940
application

367
00:19:49,550 --> 00:19:53,670
but maybe the operators the attackers

368
00:19:53,670 --> 00:19:57,600
are highly skilled and they wanted to

369
00:19:57,600 --> 00:20:00,660
fake evidence especially the last one

370
00:20:00,660 --> 00:20:02,910
even if it doesn't make sense but maybe

371
00:20:02,910 --> 00:20:05,450
they wanted to fake evidence just maybe

372
00:20:05,450 --> 00:20:08,460
let's take a look at their skills

373
00:20:08,460 --> 00:20:11,820
so almost all Trojan has applications

374
00:20:11,820 --> 00:20:13,590
were sitting on this domain followed by

375
00:20:13,590 --> 00:20:16,650
md5 hash and they were targeting

376
00:20:16,650 --> 00:20:20,760
citizens or targets in one country so of

377
00:20:20,760 --> 00:20:23,670
course they could put filter to this

378
00:20:23,670 --> 00:20:27,030
domain so they would filter it so it

379
00:20:27,030 --> 00:20:29,420
won't be accessible from the whole world

380
00:20:29,420 --> 00:20:32,520
but when you had link you could download

381
00:20:32,520 --> 00:20:34,860
the Trojan Eyes application from the

382
00:20:34,860 --> 00:20:37,860
whole world they put they didn't put any

383
00:20:37,860 --> 00:20:41,520
filter they could do it much harder like

384
00:20:41,520 --> 00:20:43,380
we've seen that in other equity

385
00:20:43,380 --> 00:20:45,840
campaigns like Tula for exact for

386
00:20:45,840 --> 00:20:48,780
example they could delete the link

387
00:20:48,780 --> 00:20:52,590
immediately after target is infected but

388
00:20:52,590 --> 00:20:54,720
they didn't they didn't put any effort

389
00:20:54,720 --> 00:21:02,310
into hiding evidence I would say it was

390
00:21:02,310 --> 00:21:05,070
a pretty long campaign without noticing

391
00:21:05,070 --> 00:21:08,790
from security researchers so what are

392
00:21:08,790 --> 00:21:11,450
the benefits when you decide to deploy

393
00:21:11,450 --> 00:21:14,700
malware through I spin it is more

394
00:21:14,700 --> 00:21:17,580
effective in compared with spear

395
00:21:17,580 --> 00:21:19,470
phishing emails targets could be

396
00:21:19,470 --> 00:21:23,580
suspicious but when you wait until your

397
00:21:23,580 --> 00:21:26,610
target is going to download application

398
00:21:26,610 --> 00:21:29,900
people download it and run it

399
00:21:29,900 --> 00:21:33,090
yeah when targets are less suspicious it

400
00:21:33,090 --> 00:21:38,040
is the whole operation is stealthier so

401
00:21:38,040 --> 00:21:39,510
the probability of revealing the

402
00:21:39,510 --> 00:21:43,080
campaign is decreasing and probably from

403
00:21:43,080 --> 00:21:44,490
long term point of view it is also

404
00:21:44,490 --> 00:21:49,020
cheaper than zero day exploits in

405
00:21:49,020 --> 00:21:51,720
another country we've observed there is

406
00:21:51,720 --> 00:21:56,280
trojan eyes or they redirect targets to

407
00:21:56,280 --> 00:22:00,900
trojan eyes TrueCrypt and there was also

408
00:22:00,900 --> 00:22:02,600
classic finishers five

409
00:22:02,600 --> 00:22:04,909
not the Trojan iced one with the name

410
00:22:04,909 --> 00:22:10,759
trimmer dot agzam so according to showed

411
00:22:10,759 --> 00:22:13,250
evidence we see the only valid

412
00:22:13,250 --> 00:22:14,179
explanation

413
00:22:14,179 --> 00:22:17,539
the spiral spider was deployed through

414
00:22:17,539 --> 00:22:20,149
Internet service provider what is all

415
00:22:20,149 --> 00:22:22,880
what this all means we should not trust

416
00:22:22,880 --> 00:22:25,130
data from Internet service provider

417
00:22:25,130 --> 00:22:29,330
anymore so we must check digital

418
00:22:29,330 --> 00:22:31,700
certificates of downloaded applications

419
00:22:31,700 --> 00:22:34,190
every time or at least hashes if not

420
00:22:34,190 --> 00:22:37,820
available we should visit as much as

421
00:22:37,820 --> 00:22:40,909
possible HTTPS versions of websites of

422
00:22:40,909 --> 00:22:42,740
course for this there is a very good

423
00:22:42,740 --> 00:22:48,200
plug in HTTPS Everywhere and the best

424
00:22:48,200 --> 00:22:50,929
what we can do is use encrypted VPN

425
00:22:50,929 --> 00:22:55,159
I mean encrypted trusted VPN outside the

426
00:22:55,159 --> 00:22:58,759
country thank you very much for your

427
00:22:58,759 --> 00:23:01,320
time attention

428
00:23:01,320 --> 00:23:01,490
[Applause]

429
00:23:01,490 --> 00:23:03,859
[Music]

