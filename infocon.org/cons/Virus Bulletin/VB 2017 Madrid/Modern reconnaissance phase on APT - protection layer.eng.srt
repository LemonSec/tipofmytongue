1
00:00:00,539 --> 00:00:06,420
yeah it's okay so first we're gonna

2
00:00:06,420 --> 00:00:07,859
speak pretty quickly because we have

3
00:00:07,859 --> 00:00:10,440
more than 60 slide for 30 minutes so I

4
00:00:10,440 --> 00:00:12,120
I'm not gonna spend too much time about

5
00:00:12,120 --> 00:00:14,099
presentation my name is Paul I will

6
00:00:14,099 --> 00:00:15,990
speak in frog leash today I would do my

7
00:00:15,990 --> 00:00:21,000
best to be listed and my name is born I

8
00:00:21,000 --> 00:00:23,699
don't work with Paul tell us and I'm

9
00:00:23,699 --> 00:00:25,170
forced either talk in Hawaii and got

10
00:00:25,170 --> 00:00:26,460
this picture and Paul got a hold of it

11
00:00:26,460 --> 00:00:28,109
and since then he's called me the cyber

12
00:00:28,109 --> 00:00:30,840
cowboy so hopefully I won't stick that's

13
00:00:30,840 --> 00:00:33,270
that's what he calls me now so we're

14
00:00:33,270 --> 00:00:34,800
gonna talk about really quickly as Paul

15
00:00:34,800 --> 00:00:35,940
mentioned we've got quite a lot of

16
00:00:35,940 --> 00:00:36,989
slides a lot of content to go through

17
00:00:36,989 --> 00:00:39,000
good talk about infection vectors

18
00:00:39,000 --> 00:00:40,410
associated with reconnaissance

19
00:00:40,410 --> 00:00:43,050
activities for apt attacks to apt in the

20
00:00:43,050 --> 00:00:44,840
style of advanced persistent threats a

21
00:00:44,840 --> 00:00:47,550
small attack vector and small attack

22
00:00:47,550 --> 00:00:49,559
surface we could 5q still used to go

23
00:00:49,559 --> 00:00:50,940
through Paul's gonna go through 3 and

24
00:00:50,940 --> 00:00:52,500
I'm gonna go through two I'm gonna talk

25
00:00:52,500 --> 00:00:53,760
with some mitigations that people can

26
00:00:53,760 --> 00:00:55,170
employ and use and then obviously

27
00:00:55,170 --> 00:00:58,469
conclusion at the end or wrap it up so

28
00:00:58,469 --> 00:00:59,280
what we talk about when we

29
00:00:59,280 --> 00:01:01,649
reconnaissance evolution again quickly

30
00:01:01,649 --> 00:01:03,210
where's presentation well we wanted to

31
00:01:03,210 --> 00:01:05,188
go over what type of threats we'd seen

32
00:01:05,188 --> 00:01:07,110
happen what type of actual evolutions of

33
00:01:07,110 --> 00:01:08,159
reconnaissance activity

34
00:01:08,159 --> 00:01:11,040
we'd observe within towers we have lots

35
00:01:11,040 --> 00:01:12,210
and lots of theaters I'm sure most

36
00:01:12,210 --> 00:01:14,549
companies here do a few issues before we

37
00:01:14,549 --> 00:01:16,110
see from an apt actors point of view

38
00:01:16,110 --> 00:01:17,759
soundbox systems make it really

39
00:01:17,759 --> 00:01:19,650
difficult excuse me for them to actually

40
00:01:19,650 --> 00:01:21,450
implant and get fruitful within an

41
00:01:21,450 --> 00:01:23,310
infrastructure soundbox allows a user to

42
00:01:23,310 --> 00:01:24,689
run let's see what's going on behavior

43
00:01:24,689 --> 00:01:26,820
analysis et cetera automatic analysis

44
00:01:26,820 --> 00:01:28,320
and malicious document stops a lot of us

45
00:01:28,320 --> 00:01:30,390
if your email icky away what's really

46
00:01:30,390 --> 00:01:32,579
valuable with apt code is it's generally

47
00:01:32,579 --> 00:01:35,009
very complex normally not always

48
00:01:35,009 --> 00:01:37,200
normally it will use a zero day so

49
00:01:37,200 --> 00:01:39,060
that's obviously the idea of being an

50
00:01:39,060 --> 00:01:41,340
all new vulnerability what we're looking

51
00:01:41,340 --> 00:01:42,810
at here is basically how the infection

52
00:01:42,810 --> 00:01:45,030
factor has changed and avoid actually

53
00:01:45,030 --> 00:01:46,920
leaking out there exploits and dropping

54
00:01:46,920 --> 00:01:48,810
or zero days on intentionally so we're

55
00:01:48,810 --> 00:01:50,159
gonna talk about that and how their

56
00:01:50,159 --> 00:01:53,850
malware becomes more more difficult yeah

57
00:01:53,850 --> 00:01:56,490
so first case study to to destroy this

58
00:01:56,490 --> 00:01:59,189
fact is something we work on the

59
00:01:59,189 --> 00:02:01,950
beginning of the year on office document

60
00:02:01,950 --> 00:02:02,549
named

61
00:02:02,549 --> 00:02:05,280
NATO secretary meeting that duck and we

62
00:02:05,280 --> 00:02:07,649
name it mudfish matryoshka doll and

63
00:02:07,649 --> 00:02:10,970
basically it's office document as you

64
00:02:10,970 --> 00:02:12,950
you did a lot of office documents that

65
00:02:12,950 --> 00:02:16,390
include a flash object inside of it and

66
00:02:16,390 --> 00:02:19,100
the purpose of this flash object was to

67
00:02:19,100 --> 00:02:22,280
send information to Assisi and they use

68
00:02:22,280 --> 00:02:24,830
a legitimate flash API to get

69
00:02:24,830 --> 00:02:26,780
information in the system and it looks

70
00:02:26,780 --> 00:02:30,080
like get requests but it's naturally get

71
00:02:30,080 --> 00:02:31,940
requests of this API they don't do

72
00:02:31,940 --> 00:02:33,650
anything and something really

73
00:02:33,650 --> 00:02:36,320
interesting in this information is

74
00:02:36,320 --> 00:02:38,240
typically you you have the flash version

75
00:02:38,240 --> 00:02:40,040
okay it could be interesting but you

76
00:02:40,040 --> 00:02:43,370
have if the flash is executed inside of

77
00:02:43,370 --> 00:02:45,590
activity subject so basically if you

78
00:02:45,590 --> 00:02:47,690
extract the flash and analyze the flash

79
00:02:47,690 --> 00:02:50,540
the data sent to the CCO while not the

80
00:02:50,540 --> 00:02:53,060
good one activity is not mentioned in

81
00:02:53,060 --> 00:02:55,520
this specific context so to have this

82
00:02:55,520 --> 00:02:57,680
flag at activist you really need to

83
00:02:57,680 --> 00:03:00,800
analyze the flesh inside of activity

84
00:03:00,800 --> 00:03:03,500
object or world in this case and he sent

85
00:03:03,500 --> 00:03:07,040
a request to my or PC laptop and a slash

86
00:03:07,040 --> 00:03:09,950
NATO URL it's much the file name of the

87
00:03:09,950 --> 00:03:13,010
document in this case and the purpose

88
00:03:13,010 --> 00:03:15,470
was to done notice tag on flash object

89
00:03:15,470 --> 00:03:18,290
flash files that would be loaded in

90
00:03:18,290 --> 00:03:21,790
memory and executed but the thing is if

91
00:03:21,790 --> 00:03:24,620
the sent that time this request is not

92
00:03:24,620 --> 00:03:26,870
the good one you won't receive anything

93
00:03:26,870 --> 00:03:29,090
so it's if it doesn't matter expectation

94
00:03:29,090 --> 00:03:30,019
from the attackers

95
00:03:30,019 --> 00:03:32,209
you won't receive the second stage if

96
00:03:32,209 --> 00:03:34,370
it's not the version of Flash they are

97
00:03:34,370 --> 00:03:37,400
expected you won't receive the second

98
00:03:37,400 --> 00:03:37,910
stage

99
00:03:37,910 --> 00:03:41,120
so from analyst point of view it's it's

100
00:03:41,120 --> 00:03:42,709
complicated because you don't really

101
00:03:42,709 --> 00:03:44,330
know what attacker is looking for which

102
00:03:44,330 --> 00:03:46,549
kind of version specifically Exeter

103
00:03:46,549 --> 00:03:50,360
extract so and once everything was

104
00:03:50,360 --> 00:03:53,420
correct you received the flash second

105
00:03:53,420 --> 00:03:55,760
flash that probably contain an exploit

106
00:03:55,760 --> 00:03:57,590
or something like that in this case we

107
00:03:57,590 --> 00:04:00,230
were not able to get it and something

108
00:04:00,230 --> 00:04:03,290
we're interesting is our data from Cisco

109
00:04:03,290 --> 00:04:05,030
umbrella or Open DNS

110
00:04:05,030 --> 00:04:07,880
it's the pic at the end is when we

111
00:04:07,880 --> 00:04:10,250
started to publish article a lot of

112
00:04:10,250 --> 00:04:12,590
researchers try to play with the CC so

113
00:04:12,590 --> 00:04:15,140
we have a lot of pickup activities and

114
00:04:15,140 --> 00:04:17,870
it was at the end of December so during

115
00:04:17,870 --> 00:04:20,418
her New York period so that's why we

116
00:04:20,418 --> 00:04:22,460
don't have a lot of thing and researcher

117
00:04:22,460 --> 00:04:23,810
come back from

118
00:04:23,810 --> 00:04:27,050
holiday and starting to work on it yeah

119
00:04:27,050 --> 00:04:29,919
we have holiday - a second case study

120
00:04:29,919 --> 00:04:35,419
named Deneb bozo sadhana bozo seems to

121
00:04:35,419 --> 00:04:37,550
be on bazaar assistance at Embassy of

122
00:04:37,550 --> 00:04:40,760
Lebanon but she only have one contact

123
00:04:40,760 --> 00:04:42,680
one connection on LinkedIn so I think

124
00:04:42,680 --> 00:04:46,010
it's fake LinkedIn account same thing

125
00:04:46,010 --> 00:04:49,010
doc office document system it was with

126
00:04:49,010 --> 00:04:55,220
macro and micro contain in fact to

127
00:04:55,220 --> 00:04:58,220
generate a JavaScript file and it

128
00:04:58,220 --> 00:05:00,919
executives JavaScript file with an

129
00:05:00,919 --> 00:05:03,680
argument so the argument was in fact an

130
00:05:03,680 --> 00:05:05,840
encryption key used by the JavaScript to

131
00:05:05,840 --> 00:05:08,600
decrypt next stage the thing is if you

132
00:05:08,600 --> 00:05:11,030
only find this JavaScript on virus data

133
00:05:11,030 --> 00:05:12,950
for example you don't have the password

134
00:05:12,950 --> 00:05:15,919
and you cannot analyze it because you

135
00:05:15,919 --> 00:05:18,200
cannot decrypt data in the ring with the

136
00:05:18,200 --> 00:05:19,580
queuing and it's not too trivial

137
00:05:19,580 --> 00:05:21,889
password key is a big one

138
00:05:21,889 --> 00:05:24,169
so you can try to Britt was it but it

139
00:05:24,169 --> 00:05:27,470
will take a lot of time and yeah it's

140
00:05:27,470 --> 00:05:28,000
basically

141
00:05:28,000 --> 00:05:32,390
fc4 function in the JavaScript the use

142
00:05:32,390 --> 00:05:36,740
of argument and decrypt the final stage

143
00:05:36,740 --> 00:05:39,680
on this reconnaissance phase and the

144
00:05:39,680 --> 00:05:41,300
purpose was to get information on the

145
00:05:41,300 --> 00:05:42,950
mission it was to get Network

146
00:05:42,950 --> 00:05:46,370
information process domain configuration

147
00:05:46,370 --> 00:05:49,940
this kind of thing it was sent to a

148
00:05:49,940 --> 00:05:53,720
compromised WordPress website in Belgium

149
00:05:53,720 --> 00:05:58,190
I think and same thing if the data were

150
00:05:58,190 --> 00:06:00,530
correct and match his expectation of the

151
00:06:00,530 --> 00:06:02,660
attackers pillowed was downloaded on the

152
00:06:02,660 --> 00:06:05,030
machine appiy file in this case and if

153
00:06:05,030 --> 00:06:07,280
it doesn't match know below nothing and

154
00:06:07,280 --> 00:06:10,700
your investigation is finished another

155
00:06:10,700 --> 00:06:14,030
case same things macro document in XL

156
00:06:14,030 --> 00:06:16,310
system simply to change a little bit and

157
00:06:16,310 --> 00:06:21,080
in this case I talked create process

158
00:06:21,080 --> 00:06:22,880
they use scheduled tasks it's something

159
00:06:22,880 --> 00:06:25,310
very common today - to execute stuff

160
00:06:25,310 --> 00:06:27,860
maybe to bypass and send back so stuff

161
00:06:27,860 --> 00:06:31,220
like that connect to a CC and same thing

162
00:06:31,220 --> 00:06:33,349
to get information on the machine sends

163
00:06:33,349 --> 00:06:35,599
this information and the attacker is

164
00:06:35,599 --> 00:06:36,710
able to decide

165
00:06:36,710 --> 00:06:40,070
if yes I sent a fighter pilot Ison zero

166
00:06:40,070 --> 00:06:43,130
day I sent a rat I send whatever and if

167
00:06:43,130 --> 00:06:46,960
it doesn't match you not have anything

168
00:06:46,960 --> 00:06:51,080
we start focusing in South Korea earlier

169
00:06:51,080 --> 00:06:53,270
this year we started putting real focus

170
00:06:53,270 --> 00:06:54,710
on Southeast Asia because we seen a lot

171
00:06:54,710 --> 00:06:57,020
of strange activity gone there I don't

172
00:06:57,020 --> 00:06:58,190
know of anybody in the room can speak

173
00:06:58,190 --> 00:07:01,130
Korean there could be one or two what we

174
00:07:01,130 --> 00:07:02,990
basically have here is a what we

175
00:07:02,990 --> 00:07:04,700
translated as a North Korean New Year

176
00:07:04,700 --> 00:07:06,590
analysis and it was a document sent

177
00:07:06,590 --> 00:07:09,140
around January time and in terms of when

178
00:07:09,140 --> 00:07:11,420
the new year was coming along Hangul

179
00:07:11,420 --> 00:07:13,610
word processor and quite from the

180
00:07:13,610 --> 00:07:14,960
analyze if you knew her analyze one you

181
00:07:14,960 --> 00:07:16,370
should get one and plowboy world it's

182
00:07:16,370 --> 00:07:17,690
it's goof on all I'll talk you through a

183
00:07:17,690 --> 00:07:19,820
bit quickly so what we got here was a

184
00:07:19,820 --> 00:07:21,950
document with it was allowed to be from

185
00:07:21,950 --> 00:07:23,630
the Korean Ministry of unification so

186
00:07:23,630 --> 00:07:25,730
this was sent to specific target seeking

187
00:07:25,730 --> 00:07:27,470
and spearfishing style attack water

188
00:07:27,470 --> 00:07:30,620
contained was 200 le objects now you'll

189
00:07:30,620 --> 00:07:32,600
see I don't think this works but you can

190
00:07:32,600 --> 00:07:33,800
just see them there what do you see you

191
00:07:33,800 --> 00:07:36,320
see a couple of Benno a leap in 0:03

192
00:07:36,320 --> 00:07:38,090
Benzies here for oily so that's actually

193
00:07:38,090 --> 00:07:40,700
where the the fun was in this so what if

194
00:07:40,700 --> 00:07:42,350
they did drop two executors when we ran

195
00:07:42,350 --> 00:07:44,900
it in the sandbox initially so two and

196
00:07:44,900 --> 00:07:47,180
three not really anything complicated

197
00:07:47,180 --> 00:07:48,650
there in terms of naming convention they

198
00:07:48,650 --> 00:07:50,480
were actually the CM five which is

199
00:07:50,480 --> 00:07:52,490
always a bit weird when that happens but

200
00:07:52,490 --> 00:07:54,080
the oil you both dropped the same object

201
00:07:54,080 --> 00:07:56,990
what we got first was a decoy document

202
00:07:56,990 --> 00:07:59,450
as we always get what this was a boyd

203
00:07:59,450 --> 00:08:02,560
was to do with speeches cairo during

204
00:08:02,560 --> 00:08:05,120
2016-2017 in korea so it's on North

205
00:08:05,120 --> 00:08:08,120
Korea we believe what we get here is

206
00:08:08,120 --> 00:08:10,640
again another collection on information

207
00:08:10,640 --> 00:08:12,620
and reconnaissance styles to weather

208
00:08:12,620 --> 00:08:14,260
looking for computer name username

209
00:08:14,260 --> 00:08:16,550
execution path of war it was round from

210
00:08:16,550 --> 00:08:17,690
suit for example if you drone on the

211
00:08:17,690 --> 00:08:19,520
sound box chances are it's gonna be in

212
00:08:19,520 --> 00:08:21,140
somewhere like C temp

213
00:08:21,140 --> 00:08:23,300
something like that C desktop maybe it's

214
00:08:23,300 --> 00:08:25,190
probably gonna be in a non-standard

215
00:08:25,190 --> 00:08:26,870
execution path for where you live from

216
00:08:26,870 --> 00:08:28,790
an excel or sorry from a an email

217
00:08:28,790 --> 00:08:32,150
document sent the BIOS model the key and

218
00:08:32,150 --> 00:08:33,890
very specific data was being looked for

219
00:08:33,890 --> 00:08:34,760
by this attacker

220
00:08:34,760 --> 00:08:36,650
purpose here as we said through the last

221
00:08:36,650 --> 00:08:38,150
three was to actually determine if we

222
00:08:38,150 --> 00:08:39,740
were going to attack this person oh well

223
00:08:39,740 --> 00:08:42,500
no wait no polymer the attacker just the

224
00:08:42,500 --> 00:08:44,750
clear that up so this is what happened

225
00:08:44,750 --> 00:08:47,240
when you obviously run it and try to get

226
00:08:47,240 --> 00:08:48,590
an idea of what was gonna on this B Cup

227
00:08:48,590 --> 00:08:49,370
is available

228
00:08:49,370 --> 00:08:51,950
so we have our own but this was one we

229
00:08:51,950 --> 00:08:53,240
find it open source that other people

230
00:08:53,240 --> 00:08:55,070
can look up you see the information pass

231
00:08:55,070 --> 00:08:56,410
through is a target idea at the start

232
00:08:56,410 --> 00:08:58,910
right here you know thought works very

233
00:08:58,910 --> 00:09:03,260
well sorry followed by a username so for

234
00:09:03,260 --> 00:09:05,300
this instance tequila boom-boom username

235
00:09:05,300 --> 00:09:07,120
path that was around from for example

236
00:09:07,120 --> 00:09:09,680
BIOS information etcetera sooo this went

237
00:09:09,680 --> 00:09:13,670
off to another compromised website pasta

238
00:09:13,670 --> 00:09:15,140
theater back to the attacker the tiger

239
00:09:15,140 --> 00:09:16,490
will determine and what they were gonna

240
00:09:16,490 --> 00:09:19,070
do and in this instance once the dealer

241
00:09:19,070 --> 00:09:20,450
was collected and they determined if

242
00:09:20,450 --> 00:09:21,529
they were gonna run it

243
00:09:21,529 --> 00:09:23,420
they got issued with a payload so the

244
00:09:23,420 --> 00:09:25,310
payload miss instance was a dot jpg file

245
00:09:25,310 --> 00:09:26,960
know what these guys have done is

246
00:09:26,960 --> 00:09:28,610
they've hacked the Korean government

247
00:09:28,610 --> 00:09:32,210
legal services website so KJ l Sork are

248
00:09:32,210 --> 00:09:34,339
as a legitimate website anyone in the

249
00:09:34,339 --> 00:09:35,990
room comprised that chances are you will

250
00:09:35,990 --> 00:09:37,610
not get malware don't quote me but

251
00:09:37,610 --> 00:09:39,860
chances are you won't they breach this

252
00:09:39,860 --> 00:09:40,970
site obviously to make it a lot more

253
00:09:40,970 --> 00:09:42,500
difficult for analysts trying to look at

254
00:09:42,500 --> 00:09:44,779
what information is being passed if I'm

255
00:09:44,779 --> 00:09:46,490
Alice here is looking at Korean

256
00:09:46,490 --> 00:09:48,500
information and they see a request this

257
00:09:48,500 --> 00:09:50,930
website may see a JPEG that's probably

258
00:09:50,930 --> 00:09:52,400
pretty normal traffic so unless they're

259
00:09:52,400 --> 00:09:53,800
doing the packet inspection or

260
00:09:53,800 --> 00:09:56,120
application layer type inspection will

261
00:09:56,120 --> 00:09:57,560
not see exactly what's gonna be and not

262
00:09:57,560 --> 00:09:59,660
so dot JPEG might seem normal

263
00:09:59,660 --> 00:10:01,610
if everything was good and well and the

264
00:10:01,610 --> 00:10:02,720
attacker decided they wanted to

265
00:10:02,720 --> 00:10:05,120
compromise you your target ID which if

266
00:10:05,120 --> 00:10:07,160
we go back in from here was actually

267
00:10:07,160 --> 00:10:09,110
generated on the fly on the server so

268
00:10:09,110 --> 00:10:10,910
you couldn't just brush this server this

269
00:10:10,910 --> 00:10:12,890
was very specifically set up to only

270
00:10:12,890 --> 00:10:15,290
serve when it was purposely meant to and

271
00:10:15,290 --> 00:10:16,940
you got served with blah blah blah

272
00:10:16,940 --> 00:10:19,310
underscore put dot JPEG and the target

273
00:10:19,310 --> 00:10:21,589
IP as we mentioned this is the mappa

274
00:10:21,589 --> 00:10:24,080
looked like one strange old liar was

275
00:10:24,080 --> 00:10:27,020
three hot compromised sites in Korea but

276
00:10:27,020 --> 00:10:28,820
then one in Holland we don't really know

277
00:10:28,820 --> 00:10:30,770
why that is Netherlands seems about a

278
00:10:30,770 --> 00:10:31,970
strange place to go if you're trying to

279
00:10:31,970 --> 00:10:34,910
infiltrate people in Korea but perhaps

280
00:10:34,910 --> 00:10:36,740
they were doing work with that company

281
00:10:36,740 --> 00:10:38,029
and they were trying to leverage it that

282
00:10:38,029 --> 00:10:39,170
way we're not really a hundred percent

283
00:10:39,170 --> 00:10:41,390
sure that's essentially a map offer from

284
00:10:41,390 --> 00:10:43,520
a sample set point of view again started

285
00:10:43,520 --> 00:10:45,440
from a document Hangul Word documents I

286
00:10:45,440 --> 00:10:50,180
mentioned next one Rock rot and soo is a

287
00:10:50,180 --> 00:10:52,070
new route we identified earlier in the

288
00:10:52,070 --> 00:10:53,779
year we call it rock rot because it was

289
00:10:53,779 --> 00:10:56,120
part of Republic of Korea South Korean

290
00:10:56,120 --> 00:11:00,260
focused rot begin spear phishing email

291
00:11:00,260 --> 00:11:03,080
are really really common with all

292
00:11:03,080 --> 00:11:05,600
type of attacks what we got here was

293
00:11:05,600 --> 00:11:08,060
again another compromised Korean website

294
00:11:08,060 --> 00:11:10,130
this time the create renewable forum

295
00:11:10,130 --> 00:11:10,910
again

296
00:11:10,910 --> 00:11:12,770
truly legitimate what they've done is

297
00:11:12,770 --> 00:11:14,360
they compromised the email web server of

298
00:11:14,360 --> 00:11:17,900
Yonsei JCAR which is a university in

299
00:11:17,900 --> 00:11:20,180
Korea they compromised it now obviously

300
00:11:20,180 --> 00:11:22,130
abuse the email so this was legitimately

301
00:11:22,130 --> 00:11:24,290
sent from that it wasn't spoof so dkm

302
00:11:24,290 --> 00:11:25,730
SPF nothing like that would have stopped

303
00:11:25,730 --> 00:11:27,890
it it was a legitimate email everything

304
00:11:27,890 --> 00:11:30,590
looked right on it the content again no

305
00:11:30,590 --> 00:11:32,390
one in the room can probably read Korean

306
00:11:32,390 --> 00:11:34,850
from memory this basically was something

307
00:11:34,850 --> 00:11:36,290
along the lines of please find attached

308
00:11:36,290 --> 00:11:38,540
the required feedback document please

309
00:11:38,540 --> 00:11:40,610
fill it out and we'll pay you money so

310
00:11:40,610 --> 00:11:41,690
they're trying to get the user to fill

311
00:11:41,690 --> 00:11:43,040
out their document and obviously gonna

312
00:11:43,040 --> 00:11:44,630
reward them which a lot of people might

313
00:11:44,630 --> 00:11:46,790
fall for Hangul word document the game's

314
00:11:46,790 --> 00:11:49,490
really quite common in South Korea if no

315
00:11:49,490 --> 00:11:50,900
one in the room knew that data is Hangul

316
00:11:50,900 --> 00:11:53,000
essentially their Microsoft Office so

317
00:11:53,000 --> 00:11:55,750
extremely popular in Southeast Asia

318
00:11:55,750 --> 00:11:57,920
second when we go to get game for the

319
00:11:57,920 --> 00:12:00,530
same attack was um can tell you it was

320
00:12:00,530 --> 00:12:02,360
from to obviously for some specific

321
00:12:02,360 --> 00:12:04,310
reason it was an attacker trying to work

322
00:12:04,310 --> 00:12:06,110
on empathy this time what they were

323
00:12:06,110 --> 00:12:09,140
saying here is this document on the

324
00:12:09,140 --> 00:12:12,260
right was from someone who claimed to be

325
00:12:12,260 --> 00:12:14,360
a North Korean defector and they were

326
00:12:14,360 --> 00:12:16,040
looking for some help and assistance and

327
00:12:16,040 --> 00:12:17,810
their family had been killed and

328
00:12:17,810 --> 00:12:19,820
obviously nothing very nice so alpha

329
00:12:19,820 --> 00:12:21,440
thei was at the in here although on the

330
00:12:21,440 --> 00:12:22,970
left was the server as imagined that

331
00:12:22,970 --> 00:12:24,260
they wanted some feedback and they would

332
00:12:24,260 --> 00:12:27,170
be rewarded with financial games so what

333
00:12:27,170 --> 00:12:28,850
do we actually get on so as I mentioned

334
00:12:28,850 --> 00:12:31,370
Hangul is really cool to look up EPS is

335
00:12:31,370 --> 00:12:33,050
generative it's used you do get

336
00:12:33,050 --> 00:12:34,940
JavaScript embedded in nearly every time

337
00:12:34,940 --> 00:12:36,260
but if you see that don't be too

338
00:12:36,260 --> 00:12:37,850
concerned it's generally Northlands

339
00:12:37,850 --> 00:12:39,830
generally meta theater particularly if

340
00:12:39,830 --> 00:12:42,170
it's obviously very small it's big it

341
00:12:42,170 --> 00:12:43,730
might be some interest in fact

342
00:12:43,730 --> 00:12:45,620
unguarded does not support the macro

343
00:12:45,620 --> 00:12:47,540
said natively support JavaScript so if

344
00:12:47,540 --> 00:12:50,840
you want to write code inside of this of

345
00:12:50,840 --> 00:12:52,940
this like application you must use

346
00:12:52,940 --> 00:12:54,410
JavaScript that's why there is a

347
00:12:54,410 --> 00:12:56,960
JavaScript here and then again something

348
00:12:56,960 --> 00:12:58,130
that you maybe look for when you're

349
00:12:58,130 --> 00:12:59,510
analyzing malware's compression or

350
00:12:59,510 --> 00:13:00,890
office occasion techniques so this uses

351
00:13:00,890 --> 00:13:03,380
ad lib but that's by default so again

352
00:13:03,380 --> 00:13:04,370
don't be too concerned if you're

353
00:13:04,370 --> 00:13:05,720
analyzing high angle and you sees ad lib

354
00:13:05,720 --> 00:13:08,150
compression it's perfectly normal and

355
00:13:08,150 --> 00:13:11,090
yes we gained EPS as with the last one

356
00:13:11,090 --> 00:13:14,600
very small as you can see what Alexi was

357
00:13:14,600 --> 00:13:16,940
fool delight was the exploit that was

358
00:13:16,940 --> 00:13:19,420
being used notice it was from 2013

359
00:13:19,420 --> 00:13:21,709
wasn't a brand new exploit wasn't a zero

360
00:13:21,709 --> 00:13:23,600
they need it wasn't required obviously a

361
00:13:23,600 --> 00:13:26,540
bit work to do what I needed to do they

362
00:13:26,540 --> 00:13:28,519
use a very non-traditional knob slab so

363
00:13:28,519 --> 00:13:30,680
not stairs generally a 0 X 90 which is a

364
00:13:30,680 --> 00:13:32,959
new operation to operation I you don't

365
00:13:32,959 --> 00:13:34,160
do anything you wit for your next

366
00:13:34,160 --> 00:13:36,529
instruction here they use a 0 X 0 for

367
00:13:36,529 --> 00:13:38,240
Vienna might throw off an analyst if

368
00:13:38,240 --> 00:13:39,350
you're looking up but generally if you

369
00:13:39,350 --> 00:13:40,850
see a block of code like that you can

370
00:13:40,850 --> 00:13:42,829
make a certain assumption about what's

371
00:13:42,829 --> 00:13:45,290
going on shellcode actually started down

372
00:13:45,290 --> 00:13:47,750
here we're a real traditional knob sly

373
00:13:47,750 --> 00:13:50,120
started and kicked in at that II yet

374
00:13:50,120 --> 00:13:51,889
million mark what it did is try to

375
00:13:51,889 --> 00:13:54,199
download multiple JPEGs again if you

376
00:13:54,199 --> 00:13:55,819
look at the last case study we discussed

377
00:13:55,819 --> 00:13:58,310
in Southeast Asia using JPEG files also

378
00:13:58,310 --> 00:14:01,009
obviously not really JPEGs they were PD

379
00:14:01,009 --> 00:14:04,370
files so what this was really

380
00:14:04,370 --> 00:14:06,290
frustrating to look at so I don't know

381
00:14:06,290 --> 00:14:07,670
what everybody's sound box technologies

382
00:14:07,670 --> 00:14:09,139
lots of sound boxes different operating

383
00:14:09,139 --> 00:14:11,389
systems I generally always start with

384
00:14:11,389 --> 00:14:13,370
Windows XP just as the first nor the

385
00:14:13,370 --> 00:14:16,459
Trident 7 and 10 whatever else I need to

386
00:14:16,459 --> 00:14:18,889
do if you run as an XP or Windows Server

387
00:14:18,889 --> 00:14:21,800
2003 it did an infant sleep so it didn't

388
00:14:21,800 --> 00:14:23,300
do anything just kept rolling kept

389
00:14:23,300 --> 00:14:24,680
rolling kept roll and didn't do anything

390
00:14:24,680 --> 00:14:26,630
so you obviously if you run on the sound

391
00:14:26,630 --> 00:14:28,550
box you generally give it an instance of

392
00:14:28,550 --> 00:14:30,139
where you'll run for 10 minutes 30

393
00:14:30,139 --> 00:14:31,790
minutes whatever if you did that here

394
00:14:31,790 --> 00:14:32,810
you didn't get anything so look

395
00:14:32,810 --> 00:14:36,110
particularly benign more of a analysis

396
00:14:36,110 --> 00:14:37,430
sooo this was quite interesting this

397
00:14:37,430 --> 00:14:38,660
first thing we've observed something

398
00:14:38,660 --> 00:14:39,889
like this generally when you have

399
00:14:39,889 --> 00:14:41,899
analysts or sorry when you've got mob

400
00:14:41,899 --> 00:14:43,579
were looking for analyst turtles it will

401
00:14:43,579 --> 00:14:44,480
be something like

402
00:14:44,480 --> 00:14:48,079
vm to do sexy or oli dbg thought

403
00:14:48,079 --> 00:14:50,029
actually allude for specific file paths

404
00:14:50,029 --> 00:14:52,939
or file names this actually to sort of I

405
00:14:52,939 --> 00:14:54,560
don't even know what the right way to

406
00:14:54,560 --> 00:14:56,990
describe this is but it took patterns

407
00:14:56,990 --> 00:14:58,519
that match that zoom for example

408
00:14:58,519 --> 00:15:01,639
Wireshark with IR Esha so even if you'd

409
00:15:01,639 --> 00:15:03,319
maybe rename which some people do if

410
00:15:03,319 --> 00:15:05,360
you'd left any instances of Wireshark in

411
00:15:05,360 --> 00:15:06,680
there that would have been able to find

412
00:15:06,680 --> 00:15:09,170
it potentially based on that it can seem

413
00:15:09,170 --> 00:15:11,329
for things like process Explorer seeing

414
00:15:11,329 --> 00:15:13,040
for things like five on red mullet

415
00:15:13,040 --> 00:15:15,380
cetera so I came just a very different

416
00:15:15,380 --> 00:15:19,399
on the analysis technique more yes it is

417
00:15:19,399 --> 00:15:20,480
beginning to get in the way we were

418
00:15:20,480 --> 00:15:21,560
looking at this it started doing all

419
00:15:21,560 --> 00:15:23,059
these weird requests to try and watch

420
00:15:23,059 --> 00:15:26,059
some Japanese Japanese Japanese anime

421
00:15:26,059 --> 00:15:26,440
called

422
00:15:26,440 --> 00:15:29,170
in time no idea what it was this

423
00:15:29,170 --> 00:15:30,910
specific episode 3 of these attackers

424
00:15:30,910 --> 00:15:32,800
really liked it they tried to wash it

425
00:15:32,800 --> 00:15:34,690
all time the community around us in the

426
00:15:34,690 --> 00:15:35,860
sound box and you seen that type of

427
00:15:35,860 --> 00:15:37,449
traffic you might assume it's benign it

428
00:15:37,449 --> 00:15:39,339
might not look got it they also went a

429
00:15:39,339 --> 00:15:40,600
couple further and they started using

430
00:15:40,600 --> 00:15:43,750
Amazon this is a legitimate Amazon URL

431
00:15:43,750 --> 00:15:45,850
normal-ish is totally benign it's over a

432
00:15:45,850 --> 00:15:48,100
world war two pc IAM yeah it wasn't

433
00:15:48,100 --> 00:15:50,680
world war two again yeah man of war pc

434
00:15:50,680 --> 00:15:52,569
him nothing wrong with it at all and

435
00:15:52,569 --> 00:15:53,920
then the hulu.com

436
00:15:53,920 --> 00:15:55,149
was obviously what we're showing you

437
00:15:55,149 --> 00:15:56,949
above were try to watch the model me so

438
00:15:56,949 --> 00:15:59,290
i can things that you maybe would see in

439
00:15:59,290 --> 00:16:00,790
a sandbox and wouldn't particularly

440
00:16:00,790 --> 00:16:02,439
associate with being benign or sorry

441
00:16:02,439 --> 00:16:04,120
with being malicious these were benign

442
00:16:04,120 --> 00:16:05,800
so if you had a drilled into those the

443
00:16:05,800 --> 00:16:07,089
trump ever from it you would have got

444
00:16:07,089 --> 00:16:08,110
into workers that would have been behind

445
00:16:08,110 --> 00:16:11,050
information and then there CNCC

446
00:16:11,050 --> 00:16:13,629
infrastructure and this was where rock

447
00:16:13,629 --> 00:16:15,670
rot really got pretty cool it started

448
00:16:15,670 --> 00:16:17,800
changing up away traditionally cnc as

449
00:16:17,800 --> 00:16:19,269
you looked at the last 40's that is

450
00:16:19,269 --> 00:16:21,399
normally done by compromised websites or

451
00:16:21,399 --> 00:16:23,589
put a precaution it dere was homeward

452
00:16:23,589 --> 00:16:25,180
earlier that's generally what it's done

453
00:16:25,180 --> 00:16:27,339
by these guys used three different

454
00:16:27,339 --> 00:16:29,949
methods of cnc as we use twitter first

455
00:16:29,949 --> 00:16:32,620
so they were quite leas either use

456
00:16:32,620 --> 00:16:34,660
hard-coded api children's which meant we

457
00:16:34,660 --> 00:16:36,490
were able to get them as we put like

458
00:16:36,490 --> 00:16:39,430
seven hard-coded api tokens we were able

459
00:16:39,430 --> 00:16:41,019
to work with twitter directly actually

460
00:16:41,019 --> 00:16:42,670
shut this down which was pretty sweet

461
00:16:42,670 --> 00:16:44,290
unfortunately twitter wouldn't give us

462
00:16:44,290 --> 00:16:46,300
the usernames so we gonna look at the

463
00:16:46,300 --> 00:16:47,680
content that may be determine if it was

464
00:16:47,680 --> 00:16:48,910
cnc instructions this arrow

465
00:16:48,910 --> 00:16:50,290
unfortunately couldn't give it up for

466
00:16:50,290 --> 00:16:52,420
privacy but that's cool a shop dine so

467
00:16:52,420 --> 00:16:53,769
it restricted their ability to be able

468
00:16:53,769 --> 00:16:55,959
to do update tweet and search functions

469
00:16:55,959 --> 00:16:57,279
that they could have been using for c2

470
00:16:57,279 --> 00:17:01,870
coms file exfiltration normally quite

471
00:17:01,870 --> 00:17:03,819
difficult to do however these guys you

472
00:17:03,819 --> 00:17:06,039
see on tax cloud storage platform use

473
00:17:06,039 --> 00:17:08,289
the to actual trade sites very few

474
00:17:08,289 --> 00:17:09,909
companies probably blog sites like yahoo

475
00:17:09,909 --> 00:17:11,559
x dropbox etc it depends on your

476
00:17:11,559 --> 00:17:13,419
security posture so i was an easier way

477
00:17:13,419 --> 00:17:15,039
for them to get ID a quien API

478
00:17:15,039 --> 00:17:17,109
functionality hard coded tokens HTTP

479
00:17:17,109 --> 00:17:18,640
traffic inspection wouldn't really got

480
00:17:18,640 --> 00:17:20,980
any work so i'm rushing because i think

481
00:17:20,980 --> 00:17:22,929
we're maybe knowing tight on time and

482
00:17:22,929 --> 00:17:26,349
more file exfiltration again https hard

483
00:17:26,349 --> 00:17:28,150
coded tokens so these guys have a real

484
00:17:28,150 --> 00:17:30,820
flair of using legitimate services on

485
00:17:30,820 --> 00:17:32,710
abusing them and abusing them for

486
00:17:32,710 --> 00:17:34,480
obviously there all right multiple file

487
00:17:34,480 --> 00:17:37,210
- filtration platforms on a CTS

488
00:17:37,210 --> 00:17:39,670
communication platform via Twitter

489
00:17:39,670 --> 00:17:42,580
and when you've got file actual tuition

490
00:17:42,580 --> 00:17:44,380
and you've got a fruit hold on the box

491
00:17:44,380 --> 00:17:46,060
why not try and complete the circle and

492
00:17:46,060 --> 00:17:47,770
get screen capture and key logon

493
00:17:47,770 --> 00:17:49,690
capability so they also implemented this

494
00:17:49,690 --> 00:17:52,720
this is a very complex rap that did

495
00:17:52,720 --> 00:17:53,920
pretty much everything you would

496
00:17:53,920 --> 00:17:56,110
particularly want to do with any type of

497
00:17:56,110 --> 00:17:58,750
sort of attacker compromise again code

498
00:17:58,750 --> 00:18:00,280
for that which I don't need to go into

499
00:18:00,280 --> 00:18:01,900
ensuring the ones that interested in the

500
00:18:01,900 --> 00:18:05,650
code so what's the summary of that users

501
00:18:05,650 --> 00:18:07,780
users users users users users users all

502
00:18:07,780 --> 00:18:10,840
of us in the room we are the weak target

503
00:18:10,840 --> 00:18:12,520
and every single case study that we went

504
00:18:12,520 --> 00:18:14,260
through today the end user who was

505
00:18:14,260 --> 00:18:14,860
attacked

506
00:18:14,860 --> 00:18:17,530
it wasn't anything super ly complicated

507
00:18:17,530 --> 00:18:19,330
they didn't have to compromise Wireless

508
00:18:19,330 --> 00:18:21,220
and break in their network and do the

509
00:18:21,220 --> 00:18:22,660
pivoting a lateral movement different

510
00:18:22,660 --> 00:18:24,400
piece of infrastructure most of these

511
00:18:24,400 --> 00:18:27,670
were sent a single email one single you

512
00:18:27,670 --> 00:18:28,840
milk would stand obviously could have

513
00:18:28,840 --> 00:18:30,690
given up the whole keys to the kingdom

514
00:18:30,690 --> 00:18:33,130
spearfishing obviously that single email

515
00:18:33,130 --> 00:18:35,230
I talked about absolutely favorite

516
00:18:35,230 --> 00:18:36,880
method of these five key studies we've

517
00:18:36,880 --> 00:18:38,650
discussed obviously some different

518
00:18:38,650 --> 00:18:40,150
actors have different methodologies but

519
00:18:40,150 --> 00:18:41,890
spearfishing for this type of campaign

520
00:18:41,890 --> 00:18:45,700
is small campaigns arise less suspicion

521
00:18:45,700 --> 00:18:47,830
I mean as I say across from call five

522
00:18:47,830 --> 00:18:49,240
campaigns there's probably less than

523
00:18:49,240 --> 00:18:51,670
Tanny meals less than 20 meals there's

524
00:18:51,670 --> 00:18:53,110
very very little food print here for you

525
00:18:53,110 --> 00:18:54,520
to be able to attack that a few more

526
00:18:54,520 --> 00:18:57,100
looking for innovation attempts to like

527
00:18:57,100 --> 00:18:58,960
using things like Twitter or using

528
00:18:58,960 --> 00:19:01,240
things like alternative knobs LEDs using

529
00:19:01,240 --> 00:19:03,010
things like Hangul Word documents for eh

530
00:19:03,010 --> 00:19:04,660
PS since the ad lib that people maybe

531
00:19:04,660 --> 00:19:06,700
aren't really familiar with that's why

532
00:19:06,700 --> 00:19:07,810
they keep their experts and the

533
00:19:07,810 --> 00:19:09,580
capabilities private the whole point of

534
00:19:09,580 --> 00:19:11,260
this was to try and ensure that they

535
00:19:11,260 --> 00:19:12,640
weren't dropping their exploit when they

536
00:19:12,640 --> 00:19:14,230
didn't need to because if they do that

537
00:19:14,230 --> 00:19:16,720
and the user has av AV gets a copy of

538
00:19:16,720 --> 00:19:17,980
what's going on maybe there's an point

539
00:19:17,980 --> 00:19:19,300
protects and gets a copy of what's going

540
00:19:19,300 --> 00:19:21,100
on it's not worth the risk they need to

541
00:19:21,100 --> 00:19:22,690
ensure that who they're attacking they

542
00:19:22,690 --> 00:19:24,910
can actually attack target not set

543
00:19:24,910 --> 00:19:26,800
information so what I just went to work

544
00:19:26,800 --> 00:19:28,240
make sure you don't waste your exploits

545
00:19:28,240 --> 00:19:30,250
because they're either expensive or very

546
00:19:30,250 --> 00:19:35,710
difficult to get yeah a mitigation I

547
00:19:35,710 --> 00:19:38,680
won't give you magic trick and it's not

548
00:19:38,680 --> 00:19:41,350
rocket science it's probably think you

549
00:19:41,350 --> 00:19:44,800
know and of course disable macron more

550
00:19:44,800 --> 00:19:47,410
morris every case macro and involved if

551
00:19:47,410 --> 00:19:49,750
it's not as related all over never bt

552
00:19:49,750 --> 00:19:50,870
its macro

553
00:19:50,870 --> 00:19:52,610
you have new feature on last version of

554
00:19:52,610 --> 00:19:55,460
office that previous user to to to

555
00:19:55,460 --> 00:19:59,330
execute macro to enable macro and yeah

556
00:19:59,330 --> 00:20:00,680
you can make some restrictions on

557
00:20:00,680 --> 00:20:03,350
portion of course you have some trick to

558
00:20:03,350 --> 00:20:05,360
bypass this restriction one-liner stuff

559
00:20:05,360 --> 00:20:06,950
except the rabbit it's better than

560
00:20:06,950 --> 00:20:09,050
nothing

561
00:20:09,050 --> 00:20:12,200
you can simply disable JavaScript and W

562
00:20:12,200 --> 00:20:15,530
script it works pretty well after if

563
00:20:15,530 --> 00:20:17,809
your organization developed everything

564
00:20:17,809 --> 00:20:20,780
in JavaScript first you are in bad

565
00:20:20,780 --> 00:20:23,750
organization and secondly you will have

566
00:20:23,750 --> 00:20:25,640
some some issue to to blacklist it but

567
00:20:25,640 --> 00:20:28,010
simply by putting a register key you can

568
00:20:28,010 --> 00:20:31,130
disable JavaScript W script keep your

569
00:20:31,130 --> 00:20:32,840
software up to date some nothing really

570
00:20:32,840 --> 00:20:35,720
new in this case configure AppLocker

571
00:20:35,720 --> 00:20:38,059
correctly same thing it's not something

572
00:20:38,059 --> 00:20:40,370
really new but we saw a lot of people

573
00:20:40,370 --> 00:20:42,410
with bad the blocker configuration or

574
00:20:42,410 --> 00:20:43,850
better you can use device guard on

575
00:20:43,850 --> 00:20:47,210
Windows 10 or virtual base security it's

576
00:20:47,210 --> 00:20:50,120
really efficient for from a lot of

577
00:20:50,120 --> 00:20:52,940
almost every case we will present on

578
00:20:52,940 --> 00:20:55,850
this presentation and something that a

579
00:20:55,850 --> 00:20:57,350
lot of people don't really do it's

580
00:20:57,350 --> 00:20:59,450
perform monitoring of its fruity

581
00:20:59,450 --> 00:21:01,580
execution on Windows system you can have

582
00:21:01,580 --> 00:21:05,150
monitoring of this thing and attackers

583
00:21:05,150 --> 00:21:07,929
use more and more script language

584
00:21:07,929 --> 00:21:10,790
natively available on Windows system it

585
00:21:10,790 --> 00:21:13,340
can be portion it can be the Brio script

586
00:21:13,340 --> 00:21:14,780
it can be javascript it can be

587
00:21:14,780 --> 00:21:17,630
everything it's here it works it's

588
00:21:17,630 --> 00:21:20,420
brought it and it's not correctly maneet

589
00:21:20,420 --> 00:21:27,350
almost most of the time we transform not

590
00:21:27,350 --> 00:21:31,850
up apt actors put more and more effort

591
00:21:31,850 --> 00:21:33,860
into protecting their code as we've sort

592
00:21:33,860 --> 00:21:35,150
of talked about multiple times through

593
00:21:35,150 --> 00:21:37,190
this talk i think what's really

594
00:21:37,190 --> 00:21:39,020
important to note here is it doesn't

595
00:21:39,020 --> 00:21:40,700
matter if it's an apt or a normal thread

596
00:21:40,700 --> 00:21:42,140
it doesn't need to be a zero that

597
00:21:42,140 --> 00:21:43,400
doesn't need to be a brand new

598
00:21:43,400 --> 00:21:45,230
vulnerability I mean the the last case

599
00:21:45,230 --> 00:21:46,550
study went to whether use a

600
00:21:46,550 --> 00:21:48,740
vulnerability it was not almost 4 years

601
00:21:48,740 --> 00:21:51,830
old it's not new things patching as Paul

602
00:21:51,830 --> 00:21:53,240
mentioned therefore medications is

603
00:21:53,240 --> 00:21:55,250
really important yes we get the argument

604
00:21:55,250 --> 00:21:56,929
if I hadn't a pasta with no God magic

605
00:21:56,929 --> 00:21:58,340
but equally if you didn't patch you

606
00:21:58,340 --> 00:21:59,990
don't want to cry so you've got a really

607
00:21:59,990 --> 00:22:02,030
sort of tapping point there it's about

608
00:22:02,030 --> 00:22:03,590
security posture of organisation

609
00:22:03,590 --> 00:22:05,570
you do that but it shows the evolution

610
00:22:05,570 --> 00:22:07,010
what these guys are doing they're not

611
00:22:07,010 --> 00:22:08,539
making sure they don't just randomly

612
00:22:08,539 --> 00:22:11,390
spam email anymore they target very

613
00:22:11,390 --> 00:22:13,250
specifically they make sure they don't

614
00:22:13,250 --> 00:22:14,900
drop their payload unless they knew they

615
00:22:14,900 --> 00:22:17,059
can execute on that machine so that is

616
00:22:17,059 --> 00:22:18,500
either getting remote code execution

617
00:22:18,500 --> 00:22:20,450
drop on a real administration tool

618
00:22:20,450 --> 00:22:22,880
running more see two combs whatever it

619
00:22:22,880 --> 00:22:25,370
is they want to do how do we think it's

620
00:22:25,370 --> 00:22:27,799
going to change and more control the

621
00:22:27,799 --> 00:22:29,659
targets relevance command and control is

622
00:22:29,659 --> 00:22:31,100
used for reconnaissance alive for only a

623
00:22:31,100 --> 00:22:33,080
few hours a few days it's going to be

624
00:22:33,080 --> 00:22:34,460
really difficult to start catching some

625
00:22:34,460 --> 00:22:36,049
of these payloads some of the case

626
00:22:36,049 --> 00:22:38,360
studies we went to work it took us quite

627
00:22:38,360 --> 00:22:39,830
a while to get some of the payloads

628
00:22:39,830 --> 00:22:42,200
because they were very much up vandyne

629
00:22:42,200 --> 00:22:44,390
so it wasn't the case of oh we've

630
00:22:44,390 --> 00:22:45,799
compromised the website it's wrong

631
00:22:45,799 --> 00:22:47,659
WordPress we've dropped this PE on it

632
00:22:47,659 --> 00:22:49,820
it's gonna be here for the next 300 days

633
00:22:49,820 --> 00:22:51,919
because no one updates WordPress it was

634
00:22:51,919 --> 00:22:54,320
more so we're on a specific script we've

635
00:22:54,320 --> 00:22:55,909
served you a payload it's available for

636
00:22:55,909 --> 00:22:57,799
5 minutes get it done if you don't get

637
00:22:57,799 --> 00:22:59,779
it you don't get a simple as that so it

638
00:22:59,779 --> 00:23:01,850
can be really hard to get zero days in

639
00:23:01,850 --> 00:23:02,720
advanced remote administration

640
00:23:02,720 --> 00:23:04,580
frameworks are expensive

641
00:23:04,580 --> 00:23:07,250
they are zero days on the darknet on

642
00:23:07,250 --> 00:23:09,230
exploit underground wherever you want to

643
00:23:09,230 --> 00:23:11,270
go they're not cheap so they need to

644
00:23:11,270 --> 00:23:12,620
make sure that whenever they do buy

645
00:23:12,620 --> 00:23:12,890
these

646
00:23:12,890 --> 00:23:14,720
it's really difficult for us and

647
00:23:14,720 --> 00:23:16,789
everybody in the room to be able to not

648
00:23:16,789 --> 00:23:18,500
analyze use to be able to not catch them

649
00:23:18,500 --> 00:23:19,640
and they start trying to introduce

650
00:23:19,640 --> 00:23:21,440
things like memory only files type

651
00:23:21,440 --> 00:23:22,760
malware that we see more and more

652
00:23:22,760 --> 00:23:25,250
nowadays difficulties for us as

653
00:23:25,250 --> 00:23:27,470
researchers if you don't get the last

654
00:23:27,470 --> 00:23:30,770
stage you're pretty stuck it makes it

655
00:23:30,770 --> 00:23:33,260
really difficult you can get a tack

656
00:23:33,260 --> 00:23:35,480
factor you can get infection vector you

657
00:23:35,480 --> 00:23:36,890
can determine where it's coming from how

658
00:23:36,890 --> 00:23:38,570
it's getting there you know who it's

659
00:23:38,570 --> 00:23:40,159
maybe attacking you knew a vertical it's

660
00:23:40,159 --> 00:23:41,360
attacking you know what infrastructure

661
00:23:41,360 --> 00:23:42,799
it's attacking when you build all that

662
00:23:42,799 --> 00:23:45,200
up you start to build a case of okay we

663
00:23:45,200 --> 00:23:46,850
knew what's gonna happen next well if

664
00:23:46,850 --> 00:23:47,899
you don't get that final payload you

665
00:23:47,899 --> 00:23:49,159
don't know what it's all in the it off

666
00:23:49,159 --> 00:23:51,500
I could have compromised your server and

667
00:23:51,500 --> 00:23:53,419
if you don't get my final payload you do

668
00:23:53,419 --> 00:23:54,740
know what I'm gonna do and that's either

669
00:23:54,740 --> 00:23:56,840
because it's memory resin or like I said

670
00:23:56,840 --> 00:23:58,640
the attacker has been so careful to

671
00:23:58,640 --> 00:24:00,710
actually bring their information in

672
00:24:00,710 --> 00:24:02,390
terms of payloads up and down so quickly

673
00:24:02,390 --> 00:24:04,100
that we don't have time to get it as an

674
00:24:04,100 --> 00:24:05,870
analyst so it's gonna be forever

675
00:24:05,870 --> 00:24:09,080
complicated and complete scripting

676
00:24:09,080 --> 00:24:11,600
languages are really really trendy they

677
00:24:11,600 --> 00:24:13,669
really are all really focused and

678
00:24:13,669 --> 00:24:15,230
targeted attacks nowadays will leverage

679
00:24:15,230 --> 00:24:17,320
partial JavaScript

680
00:24:17,320 --> 00:24:19,820
VBS anything that they can get to

681
00:24:19,820 --> 00:24:21,440
Parcells a big one with Dominica's they

682
00:24:21,440 --> 00:24:23,210
can obviously do new execute bypass and

683
00:24:23,210 --> 00:24:25,670
can run it without any real issue as

684
00:24:25,670 --> 00:24:27,320
Paul says these are all really easy to

685
00:24:27,320 --> 00:24:29,150
monitor in fact if you don't need

686
00:24:29,150 --> 00:24:32,270
partial JavaScript batch VBS et cetera

687
00:24:32,270 --> 00:24:35,750
in your organization file a sushi them

688
00:24:35,750 --> 00:24:37,670
with new pod and then they don't go when

689
00:24:37,670 --> 00:24:38,810
they open this new pod yes it might

690
00:24:38,810 --> 00:24:40,550
freak the user out initially but they're

691
00:24:40,550 --> 00:24:42,800
very quickly get to know thank you that

692
00:24:42,800 --> 00:24:44,300
that's something badass abend they go

693
00:24:44,300 --> 00:24:46,850
off as a communicator need oven better

694
00:24:46,850 --> 00:24:48,650
than Windows Tiger doesn't need to drop

695
00:24:48,650 --> 00:24:49,760
an infrastructure doesn't need to

696
00:24:49,760 --> 00:24:51,560
install anything can relieve region

697
00:24:51,560 --> 00:24:53,630
utilize or use whatever way you want put

698
00:24:53,630 --> 00:24:55,150
all the infrastructures are formed

699
00:24:55,150 --> 00:24:57,650
office accused is included huh it is I

700
00:24:57,650 --> 00:24:59,510
mean there are so many different methods

701
00:24:59,510 --> 00:25:01,850
of office kidding JavaScript hard shell

702
00:25:01,850 --> 00:25:04,460
I mean the traditional powershell one is

703
00:25:04,460 --> 00:25:05,810
obviously splendid using pluses

704
00:25:05,810 --> 00:25:07,670
concatenate it and using operas

705
00:25:07,670 --> 00:25:09,860
lowercase etc some self really easy to

706
00:25:09,860 --> 00:25:11,120
spoil other stuff like some of the

707
00:25:11,120 --> 00:25:12,650
JavaScript stuff it can be really quite

708
00:25:12,650 --> 00:25:14,960
complicated and some of the Java beer

709
00:25:14,960 --> 00:25:16,160
stuff when you've got classes and

710
00:25:16,160 --> 00:25:18,020
classes in classes in classes you know

711
00:25:18,020 --> 00:25:19,130
what you get rhino's if you manually

712
00:25:19,130 --> 00:25:20,510
analyzing you through it not takes a

713
00:25:20,510 --> 00:25:24,890
long time monitoring is mandatory it is

714
00:25:24,890 --> 00:25:27,380
just monitor better I'm gonna stop you

715
00:25:27,380 --> 00:25:28,850
getting everything but if you monitor

716
00:25:28,850 --> 00:25:31,310
execution as Paul mentioned we monitor

717
00:25:31,310 --> 00:25:32,420
what these are running when they're

718
00:25:32,420 --> 00:25:33,380
running high they're running what

719
00:25:33,380 --> 00:25:35,150
context they run you stand a much better

720
00:25:35,150 --> 00:25:36,890
chance of actually catching us and being

721
00:25:36,890 --> 00:25:40,820
able to defeat it if the story was

722
00:25:40,820 --> 00:25:42,260
already compromised in the past

723
00:25:42,260 --> 00:25:44,060
identification becomes easier so that

724
00:25:44,060 --> 00:25:46,340
sort of touches on what WAN and cost and

725
00:25:46,340 --> 00:25:47,470
we're coming over there there you'll get

726
00:25:47,470 --> 00:25:49,880
attackers that will leverage already

727
00:25:49,880 --> 00:25:51,410
compromised infrastructure because they

728
00:25:51,410 --> 00:25:52,880
knew how it was being compromised and

729
00:25:52,880 --> 00:25:54,380
they knew how they get leverage so I

730
00:25:54,380 --> 00:25:56,660
think we'll continue to see that and in

731
00:25:56,660 --> 00:25:58,340
terms of what they knew they probably

732
00:25:58,340 --> 00:25:59,510
know more than you about your eternal

733
00:25:59,510 --> 00:26:01,040
infrastructure particularly they want to

734
00:26:01,040 --> 00:26:02,930
do lateral movement they'll take their

735
00:26:02,930 --> 00:26:05,020
time they'll do low and slow tights type

736
00:26:05,020 --> 00:26:08,840
excuse me luhan's low style paying a tax

737
00:26:08,840 --> 00:26:10,460
or infrastructure to determine how it's

738
00:26:10,460 --> 00:26:12,320
built up what services you've got what

739
00:26:12,320 --> 00:26:13,730
they can exploit on what they can take

740
00:26:13,730 --> 00:26:14,300
apart

741
00:26:14,300 --> 00:26:15,950
yeah I guarantee you they will typically

742
00:26:15,950 --> 00:26:19,910
Isis somewhere where the guys look at

743
00:26:19,910 --> 00:26:21,680
sales name as a mission and he was

744
00:26:21,680 --> 00:26:23,540
looking for mission starting bar four

745
00:26:23,540 --> 00:26:26,480
liters followed by four numbers so in

746
00:26:26,480 --> 00:26:28,130
this case a guy perfectly knows

747
00:26:28,130 --> 00:26:30,500
the hostname of the target and if it

748
00:26:30,500 --> 00:26:33,350
doesn't match exactly it do nothing so

749
00:26:33,350 --> 00:26:34,820
it's it's something that becoming more

750
00:26:34,820 --> 00:26:39,170
and more common and not sauce that was a

751
00:26:39,170 --> 00:26:40,850
bit quicker than I thought

752
00:26:40,850 --> 00:26:42,620
premiere ribbon or as we talked very

753
00:26:42,620 --> 00:26:44,690
fast what's trimming with a lot of light

754
00:26:44,690 --> 00:26:46,790
so yeah and if anybody has any questions

755
00:26:46,790 --> 00:26:48,820
please feel free

756
00:26:48,820 --> 00:26:51,820
yeah

