1
00:00:05,810 --> 00:00:08,400
okay thank you ladies and gentlemen the

2
00:00:08,400 --> 00:00:09,929
second of this morning sessions talked

3
00:00:09,929 --> 00:00:11,490
is from Fabio a Cellini from kaspersky

4
00:00:11,490 --> 00:00:13,740
lab who's good taught to us about the

5
00:00:13,740 --> 00:00:16,379
abuse of proxy configuration files in

6
00:00:16,379 --> 00:00:20,189
banking our so over to you Fabio thank

7
00:00:20,189 --> 00:00:23,970
you very much good morning guys thank

8
00:00:23,970 --> 00:00:25,560
you for this opportunity to show you

9
00:00:25,560 --> 00:00:27,869
what's going on in the sunny and

10
00:00:27,869 --> 00:00:30,929
beautiful Brazil it's a pleasure to stay

11
00:00:30,929 --> 00:00:35,010
here again to show you some things that

12
00:00:35,010 --> 00:00:37,829
happens on that beautiful country and I

13
00:00:37,829 --> 00:00:41,520
hope you enjoy my research with my

14
00:00:41,520 --> 00:00:45,170
colleague Andre minuten do it to some

15
00:00:45,170 --> 00:00:49,710
best part shoes he wasn't able to stay

16
00:00:49,710 --> 00:00:52,469
here to present with me but he helped me

17
00:00:52,469 --> 00:00:54,570
a lot to produce this research and to

18
00:00:54,570 --> 00:00:57,690
show you the name of my presentation is

19
00:00:57,690 --> 00:01:02,120
the pack the problem I'll to config and

20
00:01:02,120 --> 00:01:04,739
of course this is that this is not the

21
00:01:04,739 --> 00:01:07,710
name of the the feature the the real

22
00:01:07,710 --> 00:01:10,439
name of the feature is proxy auto config

23
00:01:10,439 --> 00:01:13,890
but this is a huge problem in Brazil

24
00:01:13,890 --> 00:01:17,430
right now these days so we changed the

25
00:01:17,430 --> 00:01:20,520
name we changed the name to problem auto

26
00:01:20,520 --> 00:01:24,570
config exactly because it's a huge huge

27
00:01:24,570 --> 00:01:28,080
problem in Brazil a lot of users facing

28
00:01:28,080 --> 00:01:32,430
this problem and facing infection using

29
00:01:32,430 --> 00:01:35,939
this specific specific technique of

30
00:01:35,939 --> 00:01:38,610
attack so I want to share with you

31
00:01:38,610 --> 00:01:42,329
what's going on and what the reactions

32
00:01:42,329 --> 00:01:46,259
of the bad guys in Brazil regarding this

33
00:01:46,259 --> 00:01:52,619
subject okay well what is a pack a proxy

34
00:01:52,619 --> 00:01:57,390
auto config it's a file or URL that the

35
00:01:57,390 --> 00:02:00,479
finest all the browsers can choose a

36
00:02:00,479 --> 00:02:03,869
proxy server basically it's it it's a

37
00:02:03,869 --> 00:02:05,490
feature that exists in all modern

38
00:02:05,490 --> 00:02:09,509
browsers since Netscape tru dot 0

39
00:02:09,509 --> 00:02:14,500
96 it's old and exists in all modern

40
00:02:14,500 --> 00:02:18,310
browsers google chrome actually are you

41
00:02:18,310 --> 00:02:21,460
uses the same configurations from

42
00:02:21,460 --> 00:02:26,320
internet explorer so the bad guys don't

43
00:02:26,320 --> 00:02:29,560
need to to target google chrome it's all

44
00:02:29,560 --> 00:02:32,110
about internet explorer and if the user

45
00:02:32,110 --> 00:02:36,430
are have google chrome install it's not

46
00:02:36,430 --> 00:02:40,090
a problem it's not a problem because

47
00:02:40,090 --> 00:02:41,470
google chrome I using the same

48
00:02:41,470 --> 00:02:44,460
configuration of internet explorer and

49
00:02:44,460 --> 00:02:47,770
it's basically configured in the browser

50
00:02:47,770 --> 00:02:52,380
settings you can put a simple URL

51
00:02:52,380 --> 00:02:58,570
pointing to a pack file or you can put

52
00:02:58,570 --> 00:03:02,500
the path to a file hosted locally that's

53
00:03:02,500 --> 00:03:06,160
all the devices are really simple

54
00:03:06,160 --> 00:03:08,830
scripted made in JavaScript really

55
00:03:08,830 --> 00:03:11,320
simple and this is the basic structure

56
00:03:11,320 --> 00:03:15,459
of the of the file it have a function

57
00:03:15,459 --> 00:03:18,790
called fine proxy for a URL and the

58
00:03:18,790 --> 00:03:21,850
return will be the proxy server if not

59
00:03:21,850 --> 00:03:25,690
if not there is a function called direct

60
00:03:25,690 --> 00:03:28,780
that will direct the access without

61
00:03:28,780 --> 00:03:31,000
without use the proxy server that's it

62
00:03:31,000 --> 00:03:34,720
that's simple that simple but it's

63
00:03:34,720 --> 00:03:38,350
effective to use an attack in in attack

64
00:03:38,350 --> 00:03:41,940
that's what they are doing in Brazil how

65
00:03:41,940 --> 00:03:44,790
well basically drive-by download attacks

66
00:03:44,790 --> 00:03:49,510
using black hole or using Java applets

67
00:03:49,510 --> 00:03:53,440
or even using small charging files and

68
00:03:53,440 --> 00:03:56,500
all the file need to do all the treasure

69
00:03:56,500 --> 00:03:59,739
need to do is to do a small change in

70
00:03:59,739 --> 00:04:02,739
infected system change the auto config

71
00:04:02,739 --> 00:04:06,190
you are L key and Windows registry for

72
00:04:06,190 --> 00:04:08,800
internet explorer and for Chrome for

73
00:04:08,800 --> 00:04:12,010
consequence and or do a small change in

74
00:04:12,010 --> 00:04:16,140
the press cas file gets used by Firefox

75
00:04:16,140 --> 00:04:20,680
inserting a path to the pack file

76
00:04:20,680 --> 00:04:24,759
or insert the URL pointing to the park

77
00:04:24,759 --> 00:04:28,350
file that's it these are the three

78
00:04:28,350 --> 00:04:32,979
windows registry keys use it but the

79
00:04:32,979 --> 00:04:35,320
treasure need to do the first one

80
00:04:35,320 --> 00:04:38,860
pointing to pack file in our website the

81
00:04:38,860 --> 00:04:42,490
second one pointing to file hosted

82
00:04:42,490 --> 00:04:45,789
locally on user's machine and the 31

83
00:04:45,789 --> 00:04:47,710
this is the third one is really

84
00:04:47,710 --> 00:04:49,930
interesting because it's a variation not

85
00:04:49,930 --> 00:04:52,509
all trajan bankers are using it it

86
00:04:52,509 --> 00:04:55,330
changed the proxy of your internet

87
00:04:55,330 --> 00:04:59,500
connection it tried to guess the name of

88
00:04:59,500 --> 00:05:02,169
your internet connection and change the

89
00:05:02,169 --> 00:05:04,479
proxy of the the name of this internet

90
00:05:04,479 --> 00:05:07,330
connection it's a variation not all all

91
00:05:07,330 --> 00:05:10,750
types of markers are changing it but it

92
00:05:10,750 --> 00:05:16,990
exists its attack that happens great as

93
00:05:16,990 --> 00:05:19,120
a result when the effective user try to

94
00:05:19,120 --> 00:05:21,580
access a banking page for example it

95
00:05:21,580 --> 00:05:24,000
will be redirected to a phishing page

96
00:05:24,000 --> 00:05:27,810
like this one you can see the in the

97
00:05:27,810 --> 00:05:33,909
Settings box of Firefox the the proxy

98
00:05:33,909 --> 00:05:36,880
the malicious backfire configure in this

99
00:05:36,880 --> 00:05:41,430
case it's a dot Jes file that's simple

100
00:05:41,430 --> 00:05:46,360
that's it this is a legitimate feature

101
00:05:46,360 --> 00:05:49,210
but with a big malicious potentials

102
00:05:49,210 --> 00:05:53,590
really big and it's simple silent and

103
00:05:53,590 --> 00:05:58,090
very effective to do infant in fact

104
00:05:58,090 --> 00:06:00,759
computer users computers and redirect to

105
00:06:00,759 --> 00:06:03,820
phishing pages that's it it happens in

106
00:06:03,820 --> 00:06:08,560
brazil since 2008 2009 and it's chill

107
00:06:08,560 --> 00:06:12,310
very use it until today and to today and

108
00:06:12,310 --> 00:06:16,740
it's not only in Brazil 2012 we found

109
00:06:16,740 --> 00:06:19,750
Russian Russian banker called copper

110
00:06:19,750 --> 00:06:23,080
that it's it's using this feature as

111
00:06:23,080 --> 00:06:27,340
well and it's a bit different from the

112
00:06:27,340 --> 00:06:30,940
Brazilian version because it use auto

113
00:06:30,940 --> 00:06:33,830
signing digital certifications

114
00:06:33,830 --> 00:06:36,830
to redirect the user to SSL phishing

115
00:06:36,830 --> 00:06:40,670
page but that's it it's simple but it's

116
00:06:40,670 --> 00:06:43,730
really really effective and sixty

117
00:06:43,730 --> 00:06:46,670
percent of resilient Roger bankers are

118
00:06:46,670 --> 00:06:50,090
using this technique nowadays it shows

119
00:06:50,090 --> 00:06:55,910
how it is effective and as we know parks

120
00:06:55,910 --> 00:07:00,230
and wpa DS this is some feature used by

121
00:07:00,230 --> 00:07:03,680
some our for example flame the flame our

122
00:07:03,680 --> 00:07:09,740
use it wpg impact files to to distribute

123
00:07:09,740 --> 00:07:12,520
the infection among nap inside a network

124
00:07:12,520 --> 00:07:19,130
as we know the WPA G feature are using

125
00:07:19,130 --> 00:07:25,040
the the net views service and this

126
00:07:25,040 --> 00:07:27,340
service is vulnerable to spoofing

127
00:07:27,340 --> 00:07:32,870
basically it's it and the flame our uses

128
00:07:32,870 --> 00:07:37,490
this technique will w WP AG in a park

129
00:07:37,490 --> 00:07:42,050
file to do a man the middle attack in

130
00:07:42,050 --> 00:07:46,010
inside a network as we know to affect

131
00:07:46,010 --> 00:07:48,980
the windows update service so it's

132
00:07:48,980 --> 00:07:51,680
effective it's a simple features that

133
00:07:51,680 --> 00:07:54,920
exists is on on on windows today but

134
00:07:54,920 --> 00:07:59,980
it's a simple effective and this feature

135
00:07:59,980 --> 00:08:06,700
are now used by traction bankers okay so

136
00:08:06,700 --> 00:08:12,260
what what was our first first approach

137
00:08:12,260 --> 00:08:15,500
to solve this problem well let's block

138
00:08:15,500 --> 00:08:18,950
the URL this this was our first reaction

139
00:08:18,950 --> 00:08:23,260
to try to solve the problem but this

140
00:08:23,260 --> 00:08:27,620
wasn't it a very good approach because

141
00:08:27,620 --> 00:08:31,910
as a response we started to to saw some

142
00:08:31,910 --> 00:08:35,150
some trojans using Randall URLs in each

143
00:08:35,150 --> 00:08:38,360
reboot the Trojan changing the URL

144
00:08:38,360 --> 00:08:41,090
inside the proxy configuration the

145
00:08:41,090 --> 00:08:44,420
browser this was their answer the answer

146
00:08:44,420 --> 00:08:46,180
of the bad guys

147
00:08:46,180 --> 00:08:49,690
and some trojans also started to use

148
00:08:49,690 --> 00:08:52,570
shortening URL service such as the beat

149
00:08:52,570 --> 00:08:59,320
Li and of course using this shorting

150
00:08:59,320 --> 00:09:02,230
short URL service the bad guy could

151
00:09:02,230 --> 00:09:04,410
control and could collect statistics

152
00:09:04,410 --> 00:09:09,399
such this one this is a short short

153
00:09:09,399 --> 00:09:12,640
short URL controlled by the bad guys in

154
00:09:12,640 --> 00:09:17,589
10 days it was a succeed more than 1

155
00:09:17,589 --> 00:09:20,170
million times in 10 days could you

156
00:09:20,170 --> 00:09:22,890
imagine how many machines was infected

157
00:09:22,890 --> 00:09:30,550
using the shortened URL so we realize it

158
00:09:30,550 --> 00:09:33,940
this wasn't a very good solution to the

159
00:09:33,940 --> 00:09:39,520
problem blocking URLs so we decided ok

160
00:09:39,520 --> 00:09:43,060
let's let's add signature detection to

161
00:09:43,060 --> 00:09:45,220
Jesus small files because the fire is

162
00:09:45,220 --> 00:09:47,589
really small sometimes it's the less

163
00:09:47,589 --> 00:09:50,700
than 1 kilobyte really really small and

164
00:09:50,700 --> 00:09:55,240
that's exactly the final result the user

165
00:09:55,240 --> 00:09:59,620
can have his bank account stolen using a

166
00:09:59,620 --> 00:10:02,920
really small file 1 kilobyte file hosted

167
00:10:02,920 --> 00:10:05,709
locally but configured as a proxy script

168
00:10:05,709 --> 00:10:08,650
in the browser and the user will be will

169
00:10:08,650 --> 00:10:11,080
have hit his bank account stolen so we

170
00:10:11,080 --> 00:10:15,220
decided to ok let's let's detect all

171
00:10:15,220 --> 00:10:18,400
these small files using this verdict

172
00:10:18,400 --> 00:10:24,250
Trojan banker jas banker and in some

173
00:10:24,250 --> 00:10:28,079
days we detected a lot of files very

174
00:10:28,079 --> 00:10:34,930
very many files this was the zactly

175
00:10:34,930 --> 00:10:38,110
point when our cat and mouse game with

176
00:10:38,110 --> 00:10:41,529
Brazilian bad guy started because they

177
00:10:41,529 --> 00:10:43,839
realize it we started to detect these

178
00:10:43,839 --> 00:10:47,890
files and the answer of the bad guys as

179
00:10:47,890 --> 00:10:51,450
always when they want to bypass

180
00:10:51,450 --> 00:10:54,670
signature detection what's their

181
00:10:54,670 --> 00:10:56,920
reaction obfuscation

182
00:10:56,920 --> 00:10:59,560
they use application to bypass

183
00:10:59,560 --> 00:11:02,740
signatures of course and it was exactly

184
00:11:02,740 --> 00:11:06,250
their reaction they created some tools

185
00:11:06,250 --> 00:11:11,769
and this was the the malicious backfires

186
00:11:11,769 --> 00:11:14,370
in the beginning in the very beginning a

187
00:11:14,370 --> 00:11:17,769
plain text you can see the name of the

188
00:11:17,769 --> 00:11:23,170
banks the proxy server and that's it in

189
00:11:23,170 --> 00:11:24,790
the very beginning the fight was in

190
00:11:24,790 --> 00:11:27,910
plain text but when AV companies decided

191
00:11:27,910 --> 00:11:33,070
to to add signature detection the bad

192
00:11:33,070 --> 00:11:35,560
guy started to create a tools like this

193
00:11:35,560 --> 00:11:39,850
one and this tool was created by

194
00:11:39,850 --> 00:11:41,740
Brazilian bad guys with only one

195
00:11:41,740 --> 00:11:45,699
proposed to obfuscate the JavaScript

196
00:11:45,699 --> 00:11:49,300
code in the beginning the two US cell

197
00:11:49,300 --> 00:11:52,449
among bad guys costing two thousand

198
00:11:52,449 --> 00:11:56,220
dollars the viewer very expensive

199
00:11:56,220 --> 00:11:59,889
promising that your malicious back file

200
00:11:59,889 --> 00:12:02,620
will be fully undetectable by all

201
00:12:02,620 --> 00:12:07,360
antivirus and in fact it was the rally

202
00:12:07,360 --> 00:12:10,870
nobody detected the obfuscating scripts

203
00:12:10,870 --> 00:12:16,350
nobody so we started to to see some

204
00:12:16,350 --> 00:12:22,149
really ugly scripts obfuscated such this

205
00:12:22,149 --> 00:12:28,019
one really bad and really ugly scripts

206
00:12:28,019 --> 00:12:33,180
obfuscated it like this one very ugly

207
00:12:33,180 --> 00:12:36,279
you have some minutes to do buscate

208
00:12:36,279 --> 00:12:38,380
description to to realize what's going

209
00:12:38,380 --> 00:12:41,850
on what's the URL targeted by the script

210
00:12:41,850 --> 00:12:48,970
or this one using shore and here was

211
00:12:48,970 --> 00:12:53,399
easy to find the short key equals five

212
00:12:53,399 --> 00:12:56,470
of course this is the same approach from

213
00:12:56,470 --> 00:12:59,490
the guys or the bad guys working with

214
00:12:59,490 --> 00:13:02,709
exploit kids it's the same but they

215
00:13:02,709 --> 00:13:05,680
started to do it with the malicious pack

216
00:13:05,680 --> 00:13:08,250
scripts

217
00:13:08,750 --> 00:13:14,910
so we do your job to detect this kind of

218
00:13:14,910 --> 00:13:17,129
files the bad guy started to send some

219
00:13:17,129 --> 00:13:22,470
message to us directly to us or in some

220
00:13:22,470 --> 00:13:25,290
cases they started to use some social

221
00:13:25,290 --> 00:13:28,949
engineering to tweak the user especially

222
00:13:28,949 --> 00:13:31,620
the user that have the small file in his

223
00:13:31,620 --> 00:13:34,199
machine they started to put some message

224
00:13:34,199 --> 00:13:38,430
like this one that shows that that says

225
00:13:38,430 --> 00:13:41,600
don't modify this file copyright Google

226
00:13:41,600 --> 00:13:44,959
of course it's it's fake totally fake

227
00:13:44,959 --> 00:13:48,000
but it's a social engineering trick to

228
00:13:48,000 --> 00:13:51,870
to trick the user of course and some bad

229
00:13:51,870 --> 00:13:54,449
guys they started to send direct

230
00:13:54,449 --> 00:13:58,649
messages to us like this one I'm sorry

231
00:13:58,649 --> 00:14:02,519
it has some bad words but I'll read it

232
00:14:02,519 --> 00:14:04,529
cause it's in Portuguese in the head of

233
00:14:04,529 --> 00:14:08,399
the file that says why are these motherf

234
00:14:08,399 --> 00:14:12,319
is nicking my sniffing my pack files

235
00:14:12,319 --> 00:14:16,829
come on let me work freely I need to

236
00:14:16,829 --> 00:14:21,089
feed my family bunch of motherf go easy

237
00:14:21,089 --> 00:14:24,630
on me that was the message of the bad

238
00:14:24,630 --> 00:14:27,269
guy because we started to detect these

239
00:14:27,269 --> 00:14:31,259
scripts and he was so upset he was so

240
00:14:31,259 --> 00:14:33,810
angry because we started to detect these

241
00:14:33,810 --> 00:14:39,720
files and another one with message that

242
00:14:39,720 --> 00:14:42,269
says don't try to erase or modify this

243
00:14:42,269 --> 00:14:45,449
file don't try to leave report take down

244
00:14:45,449 --> 00:14:48,449
or publish on Twitter the deny sins of

245
00:14:48,449 --> 00:14:50,790
the hell will redirect everything again

246
00:14:50,790 --> 00:14:53,130
and everybody will be happy in the end

247
00:14:53,130 --> 00:14:57,180
and he sent some greetings to some bad

248
00:14:57,180 --> 00:15:01,410
guys putting their names like Japanese

249
00:15:01,410 --> 00:15:06,660
how nothing cal Conor Anna's and a lot

250
00:15:06,660 --> 00:15:08,939
of bad guys they started to send

251
00:15:08,939 --> 00:15:12,540
messages because they know this is a

252
00:15:12,540 --> 00:15:16,170
very effective way to affect users to

253
00:15:16,170 --> 00:15:19,079
steal their money and so they started to

254
00:15:19,079 --> 00:15:20,779
send these messages

255
00:15:20,779 --> 00:15:24,239
and it was very interesting because a

256
00:15:24,239 --> 00:15:26,399
bad guy approached me on Twitter and

257
00:15:26,399 --> 00:15:30,299
sent me this message that says sup

258
00:15:30,299 --> 00:15:34,319
bastard look me here go easy on me stop

259
00:15:34,319 --> 00:15:38,160
taking down my farming let it be the

260
00:15:38,160 --> 00:15:40,889
name of the user internet banker this

261
00:15:40,889 --> 00:15:45,029
was a direct message to me asking

262
00:15:45,029 --> 00:15:49,379
friendly hey come on let me work let me

263
00:15:49,379 --> 00:15:52,769
do my job let me steal bank accounts let

264
00:15:52,769 --> 00:15:56,639
me infect users in fact this was the

265
00:15:56,639 --> 00:16:01,709
friendly request because sometimes they

266
00:16:01,709 --> 00:16:05,549
don't ask friendly and if they don't ask

267
00:16:05,549 --> 00:16:09,119
friendly they sent you their tracks and

268
00:16:09,119 --> 00:16:11,610
that was exactly what they did with a

269
00:16:11,610 --> 00:16:15,449
friend of mine they sent these death

270
00:16:15,449 --> 00:16:19,110
threat to a friend of mine it's a

271
00:16:19,110 --> 00:16:21,269
message full of bad words I would not

272
00:16:21,269 --> 00:16:24,059
translate it but they said basically the

273
00:16:24,059 --> 00:16:27,809
message says in Portuguese asking the

274
00:16:27,809 --> 00:16:32,009
guy to stop reporting the pack files and

275
00:16:32,009 --> 00:16:35,040
the fishing domains related if not they

276
00:16:35,040 --> 00:16:40,769
oq him and the bad the worst here is the

277
00:16:40,769 --> 00:16:43,730
massive the message for our following

278
00:16:43,730 --> 00:16:47,519
his personal data his address the name

279
00:16:47,519 --> 00:16:51,470
of his wife the number of his telephone

280
00:16:51,470 --> 00:16:54,419
this is a friend of mine a very active

281
00:16:54,419 --> 00:16:58,769
fishing reporter and he was so scary

282
00:16:58,769 --> 00:17:01,579
could you imagine receive a death threat

283
00:17:01,579 --> 00:17:06,388
do your job fighting cybercrime that's

284
00:17:06,388 --> 00:17:11,220
possible and it happens in Brazil this

285
00:17:11,220 --> 00:17:14,429
friend of mine he is ok to today he's ok

286
00:17:14,429 --> 00:17:17,760
but he's too afraid and he is reporting

287
00:17:17,760 --> 00:17:21,959
less he reported a lot of fishing

288
00:17:21,959 --> 00:17:25,109
domains and pack malicious backfires and

289
00:17:25,109 --> 00:17:29,700
he skated the code and started to report

290
00:17:29,700 --> 00:17:33,299
to fish tank netcraft and other fishing

291
00:17:33,299 --> 00:17:34,200
domain

292
00:17:34,200 --> 00:17:37,529
fishing blocking services and he's too

293
00:17:37,529 --> 00:17:40,019
scared and this is what happens in

294
00:17:40,019 --> 00:17:42,960
Brazil if that guys are if they ask you

295
00:17:42,960 --> 00:17:46,169
friendly if you do not cooperate they

296
00:17:46,169 --> 00:17:48,860
can send you this kind of message

297
00:17:48,860 --> 00:17:53,460
unfortunately maybe it's a it's a sign

298
00:17:53,460 --> 00:17:57,289
oh we are doing the correct thing okay

299
00:17:57,289 --> 00:18:00,269
well for Brazilian bad guys the pack

300
00:18:00,269 --> 00:18:03,809
files is the new host because they can

301
00:18:03,809 --> 00:18:06,240
do a lot of things with these small

302
00:18:06,240 --> 00:18:09,120
scripts they can do a lot of changes

303
00:18:09,120 --> 00:18:13,409
with a merchant multipurpose ends for

304
00:18:13,409 --> 00:18:17,519
example if you took a this script and

305
00:18:17,519 --> 00:18:20,070
they'll be skate you can realize what

306
00:18:20,070 --> 00:18:23,610
the bad guy are planning well they are

307
00:18:23,610 --> 00:18:26,700
targeting Brazilian banks this is there

308
00:18:26,700 --> 00:18:29,279
their main propose to redirect the user

309
00:18:29,279 --> 00:18:31,980
to phishing pages of more than 40

310
00:18:31,980 --> 00:18:35,309
Brazilian banks not only banks but page

311
00:18:35,309 --> 00:18:38,760
of credit card systems they are also

312
00:18:38,760 --> 00:18:40,799
asking for credentials from webmail

313
00:18:40,799 --> 00:18:44,580
service such as outlook hotmail group

314
00:18:44,580 --> 00:18:49,139
gmail payment websites such as PayPal

315
00:18:49,139 --> 00:18:51,360
and Patty saguru that is very popular in

316
00:18:51,360 --> 00:18:56,279
Brazil much more than people they are

317
00:18:56,279 --> 00:18:58,440
with these scripts they are also

318
00:18:58,440 --> 00:19:00,659
redirecting the user that tried to

319
00:19:00,659 --> 00:19:03,090
access a popular web page in Brazil to

320
00:19:03,090 --> 00:19:06,389
landing pages full of advertisement of

321
00:19:06,389 --> 00:19:09,090
course they I they are looking for to

322
00:19:09,090 --> 00:19:11,990
generate traffic and gain some money

323
00:19:11,990 --> 00:19:16,549
some scriptures as well decided to

324
00:19:16,549 --> 00:19:21,029
redirect the user to fake web fake web

325
00:19:21,029 --> 00:19:25,070
or web pages of mtgox com that is the

326
00:19:25,070 --> 00:19:30,269
most known Bitcoin market use it by the

327
00:19:30,269 --> 00:19:33,360
guys that want to sell or buy bitcoins

328
00:19:33,360 --> 00:19:37,799
and they are also targeting website from

329
00:19:37,799 --> 00:19:39,990
the Brazilian government especially that

330
00:19:39,990 --> 00:19:42,179
websites that request some Logan you

331
00:19:42,179 --> 00:19:44,580
know have some personal information of

332
00:19:44,580 --> 00:19:46,770
all the citizens they

333
00:19:46,770 --> 00:19:50,070
started to do it and with these scripts

334
00:19:50,070 --> 00:19:52,710
they are also able to block the access

335
00:19:52,710 --> 00:19:56,130
to websites and the servers use it by AV

336
00:19:56,130 --> 00:19:58,980
companies to distribute the updates I'll

337
00:19:58,980 --> 00:20:03,380
show you now yeah this is the script

338
00:20:03,380 --> 00:20:06,300
used by the bad guys to redirect the

339
00:20:06,300 --> 00:20:09,150
infected user to phishing pages of banks

340
00:20:09,150 --> 00:20:11,970
and to block the web pages and the

341
00:20:11,970 --> 00:20:15,720
servers that distribute the updates from

342
00:20:15,720 --> 00:20:18,660
there V companies you can see here in

343
00:20:18,660 --> 00:20:22,410
the head of the the file the name of the

344
00:20:22,410 --> 00:20:26,360
banks and in the middle the name of the

345
00:20:26,360 --> 00:20:30,000
AV companies and the direct result in

346
00:20:30,000 --> 00:20:32,640
infected machine is this if the user try

347
00:20:32,640 --> 00:20:35,250
to access the web page it's a fake

348
00:20:35,250 --> 00:20:39,380
message that says service unavailable

349
00:20:39,380 --> 00:20:43,050
temporarily try again later of course

350
00:20:43,050 --> 00:20:45,540
it's fake it was blocked it was

351
00:20:45,540 --> 00:20:49,550
resurrected by the malicious pack file

352
00:20:49,550 --> 00:20:53,310
this is a pack file targeting a website

353
00:20:53,310 --> 00:20:55,320
from the Brazilian govern of course they

354
00:20:55,320 --> 00:20:58,860
want credentials and they do mass

355
00:20:58,860 --> 00:21:01,560
infections of a lot of users and maybe

356
00:21:01,560 --> 00:21:04,020
these these are these of these machines

357
00:21:04,020 --> 00:21:06,720
belongs to the buffer so they want these

358
00:21:06,720 --> 00:21:10,830
credentials here redirecting to the mt

359
00:21:10,830 --> 00:21:13,610
gox cambiar that in fact do not exist

360
00:21:13,610 --> 00:21:19,580
but they redirect to steal credentials

361
00:21:19,700 --> 00:21:24,240
and this this one is so funny for some

362
00:21:24,240 --> 00:21:26,730
web sites especially security community

363
00:21:26,730 --> 00:21:29,760
that provides free malware removal

364
00:21:29,760 --> 00:21:33,630
advice for users final users if the user

365
00:21:33,630 --> 00:21:36,420
try to access some websites virustotal

366
00:21:36,420 --> 00:21:40,380
fish tank treat expert and linear

367
00:21:40,380 --> 00:21:42,630
defense evil it's at security community

368
00:21:42,630 --> 00:21:45,780
in Brazil the user will see a fake bsod

369
00:21:45,780 --> 00:21:48,990
the fake blue screen of death in the

370
00:21:48,990 --> 00:21:51,210
browser

371
00:21:51,210 --> 00:21:53,340
yeah that says a problem has been

372
00:21:53,340 --> 00:21:56,490
detected and Linda faceva daughter has

373
00:21:56,490 --> 00:21:58,649
been shut down to prevent damage of

374
00:21:58,649 --> 00:22:01,289
course this is totally fake it's a trick

375
00:22:01,289 --> 00:22:04,830
to avoid the user to access to not

376
00:22:04,830 --> 00:22:09,809
access the website asking for help or to

377
00:22:09,809 --> 00:22:14,549
access the Devi the website of the

378
00:22:14,549 --> 00:22:19,890
antivirus yeah that's it well as I told

379
00:22:19,890 --> 00:22:23,490
in the beginning this was this is Q is a

380
00:22:23,490 --> 00:22:27,240
huge problem in Brazil and unfortunately

381
00:22:27,240 --> 00:22:29,149
a lot of security products are not

382
00:22:29,149 --> 00:22:31,200
suited they are not detecting these

383
00:22:31,200 --> 00:22:36,270
scripts and so was what what were our

384
00:22:36,270 --> 00:22:39,149
final approach in kaspersky we decided

385
00:22:39,149 --> 00:22:41,820
to create a really good risk detection

386
00:22:41,820 --> 00:22:45,570
to all these scripts and this risk

387
00:22:45,570 --> 00:22:47,970
detection its base it on our JavaScript

388
00:22:47,970 --> 00:22:51,570
emulator and this simulator it can

389
00:22:51,570 --> 00:22:55,230
emulate and call the function find proxy

390
00:22:55,230 --> 00:23:00,149
for URL and no matter what kind of

391
00:23:00,149 --> 00:23:04,320
obfuscation the file the pac-5 are using

392
00:23:04,320 --> 00:23:06,960
we are still able to detect with a

393
00:23:06,960 --> 00:23:09,559
really really good or risk detection

394
00:23:09,559 --> 00:23:12,510
that's how we are detecting right now

395
00:23:12,510 --> 00:23:14,850
and unfortunately I saw a lot of

396
00:23:14,850 --> 00:23:16,950
security products and chilled not

397
00:23:16,950 --> 00:23:20,309
detecting an hour I urge all the guys

398
00:23:20,309 --> 00:23:23,610
here to start detect these files I know

399
00:23:23,610 --> 00:23:27,600
if they are small sometimes some

400
00:23:27,600 --> 00:23:30,390
companies have fear to not produce some

401
00:23:30,390 --> 00:23:32,820
false positives because we know there

402
00:23:32,820 --> 00:23:35,970
are some legit made pack files using

403
00:23:35,970 --> 00:23:39,210
side universe or on-site companies to

404
00:23:39,210 --> 00:23:41,730
control the traffic to redirect the

405
00:23:41,730 --> 00:23:43,740
traffic it's a really useful tool for

406
00:23:43,740 --> 00:23:48,240
network administrators really useful and

407
00:23:48,240 --> 00:23:51,510
some companies I thought I talked with

408
00:23:51,510 --> 00:23:53,700
some guys we don't know it can produce

409
00:23:53,700 --> 00:23:57,240
some false positive it's true but with a

410
00:23:57,240 --> 00:23:58,980
really good oras protection you can

411
00:23:58,980 --> 00:24:02,190
detect these files and I urge you to do

412
00:24:02,190 --> 00:24:05,010
it because it's a huge problem in Brazil

413
00:24:05,010 --> 00:24:10,020
and of course the the the final way we

414
00:24:10,020 --> 00:24:12,270
will be a phishing page you can detect

415
00:24:12,270 --> 00:24:14,820
the phishing page of course but as the

416
00:24:14,820 --> 00:24:16,410
bad guy brazilian bad guys they are

417
00:24:16,410 --> 00:24:20,310
working so hard to bypass detection into

418
00:24:20,310 --> 00:24:22,830
his to money and in fact days to a lot

419
00:24:22,830 --> 00:24:26,820
of money in Brazil that are more than 42

420
00:24:26,820 --> 00:24:30,750
million users of internet banking it's a

421
00:24:30,750 --> 00:24:36,420
lot of people and in 2012 the Brazilian

422
00:24:36,420 --> 00:24:39,210
Federation of banks they reported a huge

423
00:24:39,210 --> 00:24:43,200
loss lots of money do with these attacks

424
00:24:43,200 --> 00:24:46,920
of trajan bankers so i use you guys to

425
00:24:46,920 --> 00:24:49,260
detect these scripts if you need help or

426
00:24:49,260 --> 00:24:52,650
you need samples please ping me that's

427
00:24:52,650 --> 00:24:57,570
it i'm publishing a full paper with a

428
00:24:57,570 --> 00:25:00,780
lot of more details that securely scom

429
00:25:00,780 --> 00:25:03,530
maybe it's already publishing right now

430
00:25:03,530 --> 00:25:07,050
this is my colleague andre and i want to

431
00:25:07,050 --> 00:25:09,570
say thank you and if you have questions

432
00:25:09,570 --> 00:25:13,010
I believe we have time

433
00:25:17,760 --> 00:25:19,720
okay so we have a question on the

434
00:25:19,720 --> 00:25:20,620
right-hand side there in the middle

435
00:25:20,620 --> 00:25:25,600
please be kind talk slowly cuz you know

436
00:25:25,600 --> 00:25:29,549
I'm not a very good English speaker

437
00:25:32,580 --> 00:25:35,850
thank you that was a great presentation

438
00:25:35,850 --> 00:25:40,440
right here hey I was not clear from your

439
00:25:40,440 --> 00:25:43,900
presentation on the vector of attack and

440
00:25:43,900 --> 00:25:47,650
update trojan or a drive-by that would

441
00:25:47,650 --> 00:25:50,590
lead to the pack or proxy installation

442
00:25:50,590 --> 00:25:53,260
could you explain that yeah for sure in

443
00:25:53,260 --> 00:25:58,330
fact both to change the proxy in the

444
00:25:58,330 --> 00:26:01,120
browser bad guys can do it with a small

445
00:26:01,120 --> 00:26:04,870
Trojan really small ten kilobyte 12

446
00:26:04,870 --> 00:26:09,549
kilobyte or in some some drive-by

447
00:26:09,549 --> 00:26:12,669
download attacks using black hole or

448
00:26:12,669 --> 00:26:16,029
using a malicious Java applets all the

449
00:26:16,029 --> 00:26:19,480
update will do is to is to change the

450
00:26:19,480 --> 00:26:23,549
proxy in the browser changing this that

451
00:26:23,549 --> 00:26:27,340
changing that Windows registry key so

452
00:26:27,340 --> 00:26:29,950
it's really simple the treasure don't

453
00:26:29,950 --> 00:26:31,960
need it to stay active in the machine

454
00:26:31,960 --> 00:26:34,299
all the treasure need to do is to change

455
00:26:34,299 --> 00:26:38,169
this small windows registry and that's

456
00:26:38,169 --> 00:26:41,950
it the the browser will be configured

457
00:26:41,950 --> 00:26:46,020
with the malicious malicious script and

458
00:26:46,020 --> 00:26:48,549
the connections we started to be

459
00:26:48,549 --> 00:26:50,789
redirected so they use both approach

460
00:26:50,789 --> 00:26:53,710
small trajan files and drive-by download

461
00:26:53,710 --> 00:26:55,779
attacks drive-by download using black

462
00:26:55,779 --> 00:27:02,860
hole or malicious Java applets okay we

463
00:27:02,860 --> 00:27:06,059
have another question of the front

464
00:27:08,180 --> 00:27:10,770
thank you great presentation thank you

465
00:27:10,770 --> 00:27:13,050
something that probably is obvious but

466
00:27:13,050 --> 00:27:17,250
are they any and clean up Oh skated are

467
00:27:17,250 --> 00:27:22,650
auto config files I never seen any yeah

468
00:27:22,650 --> 00:27:24,300
this is interesting i'm publishing more

469
00:27:24,300 --> 00:27:27,270
details that securely is today most

470
00:27:27,270 --> 00:27:29,370
infected countries in the world with

471
00:27:29,370 --> 00:27:32,090
this technique first Brazil of course

472
00:27:32,090 --> 00:27:36,240
second Russia why Russia because the bad

473
00:27:36,240 --> 00:27:38,910
guys behind the Trojan copper they

474
00:27:38,910 --> 00:27:42,570
decided to use this technique as well so

475
00:27:42,570 --> 00:27:44,490
maybe it's something that do not exist

476
00:27:44,490 --> 00:27:47,610
in your country you are very lucky but

477
00:27:47,610 --> 00:27:49,560
maybe in the future you will need to

478
00:27:49,560 --> 00:27:52,650
face this problem because we know that

479
00:27:52,650 --> 00:27:55,320
guys are sharing information we know

480
00:27:55,320 --> 00:27:56,670
Brazilian bad guys are sharing

481
00:27:56,670 --> 00:28:00,240
information with Russian bad guys they

482
00:28:00,240 --> 00:28:02,880
are buying a black hole from the Russian

483
00:28:02,880 --> 00:28:05,580
bad guys and the Brazilian bad guys are

484
00:28:05,580 --> 00:28:07,440
selling this technique of the malicious

485
00:28:07,440 --> 00:28:11,040
back to the Russians so they are sharing

486
00:28:11,040 --> 00:28:14,520
information and maybe in the future you

487
00:28:14,520 --> 00:28:17,610
will see this technique explore it or

488
00:28:17,610 --> 00:28:19,200
use it in charge of bankers in your

489
00:28:19,200 --> 00:28:21,990
country if you guys need some samples to

490
00:28:21,990 --> 00:28:24,450
take a look I have a lot of samples I

491
00:28:24,450 --> 00:28:27,450
can share with you and you can take a

492
00:28:27,450 --> 00:28:29,880
look we have a lot of obfuscating

493
00:28:29,880 --> 00:28:33,660
samples and small plain text samples

494
00:28:33,660 --> 00:28:36,870
because all the bad guys here are

495
00:28:36,870 --> 00:28:40,260
obfuscating their scripts to avoid

496
00:28:40,260 --> 00:28:42,090
detection okay I think we have time for

497
00:28:42,090 --> 00:28:43,740
one more question so i could see nick's

498
00:28:43,740 --> 00:28:48,990
hand up there thank you for a really

499
00:28:48,990 --> 00:28:50,640
good presentation really interesting

500
00:28:50,640 --> 00:28:52,890
thank you hopefully a very quick

501
00:28:52,890 --> 00:28:58,080
question the reconfiguration that points

502
00:28:58,080 --> 00:29:01,320
to where the bad pack file is can either

503
00:29:01,320 --> 00:29:06,530
be a local file or a URL exactly what

504
00:29:06,530 --> 00:29:09,540
approximately is the proportion like

505
00:29:09,540 --> 00:29:12,280
most of them using URLs or

506
00:29:12,280 --> 00:29:15,880
50 50 or most of the attacks they are

507
00:29:15,880 --> 00:29:18,790
using they configure the URL most of the

508
00:29:18,790 --> 00:29:23,470
attacks I'd say thirty percent of the

509
00:29:23,470 --> 00:29:26,530
attacks are using the small files hosted

510
00:29:26,530 --> 00:29:30,570
in the hard drive users hard drive

511
00:29:30,570 --> 00:29:33,720
because if the fire is detected or

512
00:29:33,720 --> 00:29:37,450
deleted the proxy will not work so

513
00:29:37,450 --> 00:29:41,020
sometimes the bad guys they prefer to

514
00:29:41,020 --> 00:29:43,990
use the URL put the URL inside the

515
00:29:43,990 --> 00:29:45,520
configuration of the browser and that's

516
00:29:45,520 --> 00:29:49,870
it it's a small in silent change the

517
00:29:49,870 --> 00:29:53,500
user will not be aware of it the user

518
00:29:53,500 --> 00:29:57,130
will navigate easily there is no a clear

519
00:29:57,130 --> 00:29:59,670
sign out that the browser was changed

520
00:29:59,670 --> 00:30:02,470
but when the user will access for

521
00:30:02,470 --> 00:30:05,560
example the web page of the bank he will

522
00:30:05,560 --> 00:30:09,850
be redirected so the bad guys are using

523
00:30:09,850 --> 00:30:11,680
they prefer the URL in the browser

524
00:30:11,680 --> 00:30:14,910
instead of the file

