1
00:00:00,500 --> 00:00:02,669
all right we're going to get started so

2
00:00:02,669 --> 00:00:05,130
could you please sit down take a seat

3
00:00:05,130 --> 00:00:09,330
thank you this next presentation is

4
00:00:09,330 --> 00:00:11,400
going to be very interesting I'd like to

5
00:00:11,400 --> 00:00:15,269
introduce Peter Canali County I'm sorry

6
00:00:15,269 --> 00:00:18,119
alright miss Noble and Martin York oh

7
00:00:18,119 --> 00:00:20,010
and they're from ESET they're going to

8
00:00:20,010 --> 00:00:21,900
be talking about a malicious OSX

9
00:00:21,900 --> 00:00:24,480
cocktail served from a tainted bottle

10
00:00:24,480 --> 00:00:28,170
take it away guys one server infected

11
00:00:28,170 --> 00:00:30,990
twice in last few months in both cases

12
00:00:30,990 --> 00:00:33,450
those in both cases delivering very new

13
00:00:33,450 --> 00:00:36,870
Mac smaller pieces we have analysis we

14
00:00:36,870 --> 00:00:39,510
have numbers and we suggest a method how

15
00:00:39,510 --> 00:00:41,690
to detect indicators of compromised on

16
00:00:41,690 --> 00:00:44,700
Mac systems hello everybody my name is

17
00:00:44,700 --> 00:00:46,620
Peter this is marketing we are from ESET

18
00:00:46,620 --> 00:00:49,980
Czech Republic and we are so glad to be

19
00:00:49,980 --> 00:00:52,739
here at this event the outline of our

20
00:00:52,739 --> 00:00:55,020
talk is as follows we start with the

21
00:00:55,020 --> 00:00:57,530
story of itself a compromised website

22
00:00:57,530 --> 00:01:00,030
transmission application BitTorrent

23
00:01:00,030 --> 00:01:03,899
client and then we follow with analysis

24
00:01:03,899 --> 00:01:06,540
of a distributed or second order and we

25
00:01:06,540 --> 00:01:09,180
conclude with an experimental part how

26
00:01:09,180 --> 00:01:12,090
to use volatility framework in context

27
00:01:12,090 --> 00:01:14,490
of malware analysis for Mac profiles

28
00:01:14,490 --> 00:01:17,549
thanks to Robert Simmons earlier this

29
00:01:17,549 --> 00:01:19,580
morning from Fred connect he did it for

30
00:01:19,580 --> 00:01:23,400
four windows profiles so we follow him

31
00:01:23,400 --> 00:01:27,450
for next now okay the story itself may

32
00:01:27,450 --> 00:01:31,020
come over it is not that abundant as its

33
00:01:31,020 --> 00:01:33,240
Windows counterpart however there exists

34
00:01:33,240 --> 00:01:35,460
some Marvel family this is a timeline

35
00:01:35,460 --> 00:01:38,659
for last five five years with most

36
00:01:38,659 --> 00:01:41,460
proper backdoors and wrecks mostly

37
00:01:41,460 --> 00:01:44,909
connected with apts and we see the very

38
00:01:44,909 --> 00:01:48,240
very new fresh blue bubbles that was

39
00:01:48,240 --> 00:01:50,700
like part of the malicious or sixth

40
00:01:50,700 --> 00:01:52,740
cocktail combined with official

41
00:01:52,740 --> 00:01:56,310
transmission clients this year let's

42
00:01:56,310 --> 00:01:59,360
focus on down line of attack attacks

43
00:01:59,360 --> 00:02:03,960
everything started on in March when a

44
00:02:03,960 --> 00:02:07,770
ranger that was first good during summer

45
00:02:07,770 --> 00:02:10,800
was discovered on transmission

46
00:02:10,800 --> 00:02:14,129
application at the very interview too

47
00:02:14,129 --> 00:02:17,650
the next day it was removed so response

48
00:02:17,650 --> 00:02:19,750
was very instant but let's say that this

49
00:02:19,750 --> 00:02:23,579
was a bad surprise for OS X users then

50
00:02:23,579 --> 00:02:27,909
some time pass pass on and the first

51
00:02:27,909 --> 00:02:29,650
kidnapped download service discovered

52
00:02:29,650 --> 00:02:32,439
however this was a silent no IT security

53
00:02:32,439 --> 00:02:35,650
headlines because it was not it was work

54
00:02:35,650 --> 00:02:38,560
in progress basically but it delivered

55
00:02:38,560 --> 00:02:40,569
the first kidnapped backdoor which was

56
00:02:40,569 --> 00:02:44,170
the second stage at in August and these

57
00:02:44,170 --> 00:02:47,139
made headlines already and the climax

58
00:02:47,139 --> 00:02:49,329
came at the end of August when the

59
00:02:49,329 --> 00:02:52,269
kidnap was detected the very new version

60
00:02:52,269 --> 00:02:55,030
of kidnap was detected in the official

61
00:02:55,030 --> 00:02:59,170
transmission application and also it was

62
00:02:59,170 --> 00:03:01,239
removed quite instantly however the

63
00:03:01,239 --> 00:03:05,829
reaction of crowds was very negative how

64
00:03:05,829 --> 00:03:06,760
was it

65
00:03:06,760 --> 00:03:10,000
so all major IT security magazines like

66
00:03:10,000 --> 00:03:12,459
reported about this that BitTorrent

67
00:03:12,459 --> 00:03:15,760
client was infected victimized again and

68
00:03:15,760 --> 00:03:19,030
again and again and again actually this

69
00:03:19,030 --> 00:03:20,709
last picture from the report of the

70
00:03:20,709 --> 00:03:24,129
Business Insider actually displayed how

71
00:03:24,129 --> 00:03:26,440
you felt about this incident we

72
00:03:26,440 --> 00:03:28,690
extracted just a few most liked

73
00:03:28,690 --> 00:03:31,540
retweeted and most uploaded reactions

74
00:03:31,540 --> 00:03:33,280
which which basically said that

75
00:03:33,280 --> 00:03:36,090
transmission application never again

76
00:03:36,090 --> 00:03:40,030
however was whether any positive facts

77
00:03:40,030 --> 00:03:42,669
about this incident transmission

78
00:03:42,669 --> 00:03:45,010
response from transmission beam the

79
00:03:45,010 --> 00:03:47,440
implemented removal of OS X key Ranger

80
00:03:47,440 --> 00:03:51,010
in the actual version of transmission

81
00:03:51,010 --> 00:03:53,470
client and after the second incident

82
00:03:53,470 --> 00:03:56,290
they moved to their download to the to

83
00:03:56,290 --> 00:03:59,579
the another repo then we get hub and

84
00:03:59,579 --> 00:04:02,229
also binary checks on split into

85
00:04:02,229 --> 00:04:03,280
different locations

86
00:04:03,280 --> 00:04:05,079
however what we what we have to say that

87
00:04:05,079 --> 00:04:07,479
investigation of these incidents are

88
00:04:07,479 --> 00:04:11,919
still ongoing therefore we won't answer

89
00:04:11,919 --> 00:04:14,859
perhaps the most interesting questions

90
00:04:14,859 --> 00:04:16,599
that we have but let us summarize the

91
00:04:16,599 --> 00:04:20,168
questions that may be of interest how

92
00:04:20,168 --> 00:04:21,668
many downloads had been infected

93
00:04:21,668 --> 00:04:24,460
transmission in both cases how long in

94
00:04:24,460 --> 00:04:26,770
ours was the model available for

95
00:04:26,770 --> 00:04:27,700
download

96
00:04:27,700 --> 00:04:29,320
how did the transmission team actually

97
00:04:29,320 --> 00:04:33,220
find out about these compromises and how

98
00:04:33,220 --> 00:04:35,020
many users the source version of

99
00:04:35,020 --> 00:04:38,640
transmission application has in total

100
00:04:38,640 --> 00:04:41,170
okay these we could speculate about

101
00:04:41,170 --> 00:04:43,330
these but these next five questions

102
00:04:43,330 --> 00:04:46,480
these next questions are kind of would

103
00:04:46,480 --> 00:04:49,060
be left open how did the attackers

104
00:04:49,060 --> 00:04:51,400
compromise the server which platform the

105
00:04:51,400 --> 00:04:54,940
attack venture it was a Linux server it

106
00:04:54,940 --> 00:04:57,330
could have been my code server as well

107
00:04:57,330 --> 00:05:02,370
could have it is possible that the

108
00:05:02,370 --> 00:05:04,630
attackers had access to the server all

109
00:05:04,630 --> 00:05:06,210
the time between the incident and

110
00:05:06,210 --> 00:05:08,560
finally transmission is volunteen by

111
00:05:08,560 --> 00:05:11,200
project how many contributors do do

112
00:05:11,200 --> 00:05:13,240
contribute to this and are there any

113
00:05:13,240 --> 00:05:15,520
roles connected with security within the

114
00:05:15,520 --> 00:05:16,890
team

115
00:05:16,890 --> 00:05:19,300
having said that already we haven't

116
00:05:19,300 --> 00:05:22,600
answered for all these questions however

117
00:05:22,600 --> 00:05:27,070
let's try to answer them partially and

118
00:05:27,070 --> 00:05:30,220
this should come in this this table in

119
00:05:30,220 --> 00:05:32,230
the first incident was reported by palo

120
00:05:32,230 --> 00:05:36,070
alto networks by from the records we

121
00:05:36,070 --> 00:05:40,320
know the number of the time of

122
00:05:40,320 --> 00:05:43,540
availability for 32 hours approximately

123
00:05:43,540 --> 00:05:47,890
at that time actually no heat with each

124
00:05:47,890 --> 00:05:50,740
set life light grid for various various

125
00:05:50,740 --> 00:05:55,030
reasons how actually did ESET learn

126
00:05:55,030 --> 00:05:58,020
about the incident in the second case

127
00:05:58,020 --> 00:06:01,150
thanks to one special heuristic

128
00:06:01,150 --> 00:06:04,810
detection that hits hit Lana infected

129
00:06:04,810 --> 00:06:07,270
victim on the very first day the same

130
00:06:07,270 --> 00:06:11,400
day where when the binary of sine hall

131
00:06:11,400 --> 00:06:15,040
but you know the time between between he

132
00:06:15,040 --> 00:06:17,710
said hit hit the victim and button the

133
00:06:17,710 --> 00:06:19,780
time when he said researchers realized

134
00:06:19,780 --> 00:06:22,360
there's a new model people outside was

135
00:06:22,360 --> 00:06:25,090
not immediate so they took about one day

136
00:06:25,090 --> 00:06:29,830
that we learn this fact and we contacted

137
00:06:29,830 --> 00:06:34,980
we we contacted it was like that that

138
00:06:34,980 --> 00:06:37,780
the time delay between the first is a

139
00:06:37,780 --> 00:06:39,730
researcher downloaded knowledge is

140
00:06:39,730 --> 00:06:41,530
bundled from the office or serve

141
00:06:41,530 --> 00:06:46,510
and the time where the weather merchants

142
00:06:46,510 --> 00:06:48,120
bundle was removed from the server

143
00:06:48,120 --> 00:06:50,740
though is or not it was less than 15

144
00:06:50,740 --> 00:06:54,100
minutes so response from the team from

145
00:06:54,100 --> 00:06:56,020
the transmission team was immediate and

146
00:06:56,020 --> 00:06:57,880
in this case we know also the number of

147
00:06:57,880 --> 00:07:01,120
downloads 255 p51 you could substitute

148
00:07:01,120 --> 00:07:03,190
that one because that was one our our

149
00:07:03,190 --> 00:07:08,200
Kuwaiti music and so there to say we

150
00:07:08,200 --> 00:07:10,060
dare to say we dare to estimate the

151
00:07:10,060 --> 00:07:12,010
number of downloads English we don't

152
00:07:12,010 --> 00:07:13,630
know about the everything it's less than

153
00:07:13,630 --> 00:07:15,820
1000 the number is higher because in

154
00:07:15,820 --> 00:07:19,260
this case models push as updated clients

155
00:07:19,260 --> 00:07:21,940
let's Martin continue with small

156
00:07:21,940 --> 00:07:29,590
technical details all right looking do

157
00:07:29,590 --> 00:07:35,230
give me I don't view myself okay ah it's

158
00:07:35,230 --> 00:07:37,810
working now I hear most of myself okay

159
00:07:37,810 --> 00:07:41,130
let's start with the first Muller the

160
00:07:41,130 --> 00:07:44,050
key key ranger the first script of

161
00:07:44,050 --> 00:07:47,950
ransomware on OS X and the first Muller

162
00:07:47,950 --> 00:07:52,290
we got during the transmission incident

163
00:07:52,290 --> 00:07:56,860
it installed itself into library folder

164
00:07:56,860 --> 00:07:59,800
it stay hidden for three days downloads

165
00:07:59,800 --> 00:08:03,669
from CMC server a master key ransom

166
00:08:03,669 --> 00:08:06,160
message encrypt some of your documents

167
00:08:06,160 --> 00:08:09,160
and give you a little ransom message

168
00:08:09,160 --> 00:08:11,710
just next to documents

169
00:08:11,710 --> 00:08:14,530
it doesn't change any background or

170
00:08:14,530 --> 00:08:16,780
anything as we are used to in Windows

171
00:08:16,780 --> 00:08:22,060
only the document for communication is

172
00:08:22,060 --> 00:08:25,510
used or network actually told to web

173
00:08:25,510 --> 00:08:30,010
proxy it creates some files on your

174
00:08:30,010 --> 00:08:33,339
computer three actually four if you see

175
00:08:33,339 --> 00:08:35,429
the four file it's too light

176
00:08:35,429 --> 00:08:39,539
everything's encrypted then you can cry

177
00:08:39,539 --> 00:08:42,929
okay let's talk about ransom message

178
00:08:42,929 --> 00:08:46,570
they wanted one bit going from users I

179
00:08:46,570 --> 00:08:49,360
think that's quite a lot ok interesting

180
00:08:49,360 --> 00:08:51,700
think about the voluntary looked at the

181
00:08:51,700 --> 00:08:53,090
bullet and

182
00:08:53,090 --> 00:08:56,360
no money no transaction they didn't earn

183
00:08:56,360 --> 00:09:00,350
anything which I really like his mother

184
00:09:00,350 --> 00:09:05,810
researcher about the language it's not

185
00:09:05,810 --> 00:09:09,440
very good some missing works bad grammar

186
00:09:09,440 --> 00:09:15,230
like we are upset only bitcoins

187
00:09:15,230 --> 00:09:18,500
it's like computer so probably not

188
00:09:18,500 --> 00:09:22,490
native English speakers it's all for

189
00:09:22,490 --> 00:09:27,130
Granger for now let's talk about net

190
00:09:27,130 --> 00:09:31,850
kidnap had three stages that we saw the

191
00:09:31,850 --> 00:09:34,520
first one is downloaded the Downloads

192
00:09:34,520 --> 00:09:37,430
the second stage the back door and then

193
00:09:37,430 --> 00:09:40,340
there is the third stage the

194
00:09:40,340 --> 00:09:44,180
Outd service that was for it for quite a

195
00:09:44,180 --> 00:09:47,540
long time and mystery for us but I will

196
00:09:47,540 --> 00:09:50,470
talk about it a little bit later today

197
00:09:50,470 --> 00:09:55,480
okay the downloader the no longer is

198
00:09:55,480 --> 00:09:59,420
just some file that looks have icon of

199
00:09:59,420 --> 00:10:02,720
JPEG jpg if you even have the extension

200
00:10:02,720 --> 00:10:07,060
of jpg actually not it has the expansion

201
00:10:07,060 --> 00:10:09,230
extension jpg

202
00:10:09,230 --> 00:10:13,670
empty space that means it's unknown

203
00:10:13,670 --> 00:10:17,840
extension and we are in OS X and if the

204
00:10:17,840 --> 00:10:20,810
extension is unknown and it's a

205
00:10:20,810 --> 00:10:24,380
executable the terminal will open the

206
00:10:24,380 --> 00:10:27,080
file when the family open the file he

207
00:10:27,080 --> 00:10:30,680
finds out its binary he executed it well

208
00:10:30,680 --> 00:10:34,370
then he then it deletes itself after did

209
00:10:34,370 --> 00:10:36,520
download the backdoor of course and

210
00:10:36,520 --> 00:10:42,440
exchange the downloader wait jpg a lot

211
00:10:42,440 --> 00:10:46,970
of pictures now that the pictures are

212
00:10:46,970 --> 00:10:50,300
pretty strange I have no idea what this

213
00:10:50,300 --> 00:10:50,980
means

214
00:10:50,980 --> 00:10:54,380
we have other picture well two years old

215
00:10:54,380 --> 00:10:59,860
about to window from Firefox okay and ah

216
00:10:59,860 --> 00:11:01,810
that's something we know that like that

217
00:11:01,810 --> 00:11:06,250
PDS that's actually underground piece of

218
00:11:06,250 --> 00:11:10,720
software we don't really know what the

219
00:11:10,720 --> 00:11:13,950
infection vector of down laundry is and

220
00:11:13,950 --> 00:11:17,530
we see this image so maybe it has

221
00:11:17,530 --> 00:11:19,090
something to do with underground forums

222
00:11:19,090 --> 00:11:21,720
aisle I don't know

223
00:11:21,720 --> 00:11:24,280
all right back door right away to

224
00:11:24,280 --> 00:11:26,380
download there it has nothing to do with

225
00:11:26,380 --> 00:11:28,570
the transmission incident we go to

226
00:11:28,570 --> 00:11:30,160
download the way before the transmission

227
00:11:30,160 --> 00:11:33,700
incident we after that we even go to

228
00:11:33,700 --> 00:11:36,400
backdoor and the newest type of egg back

229
00:11:36,400 --> 00:11:40,120
door we go is the one we we saw during

230
00:11:40,120 --> 00:11:43,290
the transmission incident the second one

231
00:11:43,290 --> 00:11:46,660
all right keep that what what the back

232
00:11:46,660 --> 00:11:50,620
door tries to do it does quite a lot to

233
00:11:50,620 --> 00:11:52,530
look like some Apple icon

234
00:11:52,530 --> 00:11:55,120
synchronization Dingman well it's

235
00:11:55,120 --> 00:11:59,200
actually even is good enough to hide

236
00:11:59,200 --> 00:12:02,980
itself from the PS command so it really

237
00:12:02,980 --> 00:12:10,030
looks like some proper application it is

238
00:12:10,030 --> 00:12:14,260
it tries to steal your keychain that

239
00:12:14,260 --> 00:12:16,780
means all your stored password on your

240
00:12:16,780 --> 00:12:19,750
back that's not very good for that to

241
00:12:19,750 --> 00:12:21,910
use proof of concept that is welcomed

242
00:12:21,910 --> 00:12:24,100
well known and you can find it on the

243
00:12:24,100 --> 00:12:28,060
Internet it also used toward what to

244
00:12:28,060 --> 00:12:31,530
communicate and in the newest version

245
00:12:31,530 --> 00:12:35,980
1.5 it you it have its own torque line

246
00:12:35,980 --> 00:12:38,260
so we can see there's still some

247
00:12:38,260 --> 00:12:43,750
improvement the back door has now ten

248
00:12:43,750 --> 00:12:46,150
commands it used to have nine the time

249
00:12:46,150 --> 00:12:49,300
is in the latest variant it does all the

250
00:12:49,300 --> 00:12:51,160
things you would expect from the back

251
00:12:51,160 --> 00:12:54,220
door like updates download execute

252
00:12:54,220 --> 00:12:56,140
commands all the things you ever

253
00:12:56,140 --> 00:12:58,630
backdoor have the interesting parts are

254
00:12:58,630 --> 00:13:01,270
the bottom ones

255
00:13:01,270 --> 00:13:05,590
there's request administration password

256
00:13:05,590 --> 00:13:10,600
the number eight going to be six number

257
00:13:10,600 --> 00:13:13,550
eight which writes for two processes

258
00:13:13,550 --> 00:13:15,529
within two seconds to be executed and

259
00:13:15,529 --> 00:13:18,589
then they will ask for password to ever

260
00:13:18,589 --> 00:13:21,850
like the privileges that's quite nice

261
00:13:21,850 --> 00:13:24,680
India latest version as I said come on

262
00:13:24,680 --> 00:13:28,250
number 10 they can change the CNC URL

263
00:13:28,250 --> 00:13:33,140
and come on London number 9 is the

264
00:13:33,140 --> 00:13:36,140
interesting one because it down on

265
00:13:36,140 --> 00:13:40,100
something main out the service we for a

266
00:13:40,100 --> 00:13:41,810
long time we really didn't know what is

267
00:13:41,810 --> 00:13:46,630
it well it's the stage three of course

268
00:13:46,630 --> 00:13:50,329
so we created this little script just to

269
00:13:50,329 --> 00:13:53,630
communicate with the C&C server and see

270
00:13:53,630 --> 00:13:56,899
what they say to us what they want to do

271
00:13:56,899 --> 00:13:59,570
what the backdoor wants to do actually

272
00:13:59,570 --> 00:14:02,000
all the time we'll do everything we got

273
00:14:02,000 --> 00:14:06,410
was okay okay we exist that weren't very

274
00:14:06,410 --> 00:14:09,740
helpful actually but after a long time

275
00:14:09,740 --> 00:14:13,160
we got something and it was comment

276
00:14:13,160 --> 00:14:16,880
number nine the algae service base64

277
00:14:16,880 --> 00:14:21,290
encoded file and what does it do it's

278
00:14:21,290 --> 00:14:24,640
another big door this time small on

279
00:14:24,640 --> 00:14:27,500
maybe us interesting one maybe more

280
00:14:27,500 --> 00:14:29,740
interesting one it just frequents

281
00:14:29,740 --> 00:14:34,370
read/write/execute something we

282
00:14:34,370 --> 00:14:39,350
something we want to do so maybe now is

283
00:14:39,350 --> 00:14:43,399
a time for question why they have really

284
00:14:43,399 --> 00:14:45,529
back door that does everything and

285
00:14:45,529 --> 00:14:48,260
suddenly they download another backdoor

286
00:14:48,260 --> 00:14:51,920
that does way to think of the same as

287
00:14:51,920 --> 00:14:56,180
the big tech door why word there's one

288
00:14:56,180 --> 00:14:59,060
idea because they change the protocol

289
00:14:59,060 --> 00:15:02,510
dairy digit ditched the tour and they

290
00:15:02,510 --> 00:15:03,380
started use it

291
00:15:03,380 --> 00:15:07,130
ipv4 and they started increasing their

292
00:15:07,130 --> 00:15:10,940
communication so my idea is they maybe

293
00:15:10,940 --> 00:15:13,610
it was really very easy to listen to

294
00:15:13,610 --> 00:15:16,579
their 77 maybe they wanted something

295
00:15:16,579 --> 00:15:20,320
better hard to say

296
00:15:20,320 --> 00:15:25,240
so again to my part there's one question

297
00:15:25,240 --> 00:15:27,519
probably all of you already have in your

298
00:15:27,519 --> 00:15:32,350
mind if the Q injure and kidnapped from

299
00:15:32,350 --> 00:15:35,889
the same outer well there are some

300
00:15:35,889 --> 00:15:39,730
similarities okay that's not similarity

301
00:15:39,730 --> 00:15:41,699
that's just a fact

302
00:15:41,699 --> 00:15:45,310
Keira injure didn't and any money kidnap

303
00:15:45,310 --> 00:15:48,220
didn't really do anything she'll keep

304
00:15:48,220 --> 00:15:51,970
teaching they never asked for it we were

305
00:15:51,970 --> 00:15:55,509
listening so we know that so I know this

306
00:15:55,509 --> 00:15:58,269
is a very good fact that I like to cite

307
00:15:58,269 --> 00:16:00,910
it okay

308
00:16:00,910 --> 00:16:03,880
both of them use the translation open

309
00:16:03,880 --> 00:16:06,100
source code and they reconcile the

310
00:16:06,100 --> 00:16:08,759
transmission code to create infected

311
00:16:08,759 --> 00:16:13,209
file that design when we looked at the

312
00:16:13,209 --> 00:16:17,620
dropper function take they look like the

313
00:16:17,620 --> 00:16:20,290
same like it was programmed by the same

314
00:16:20,290 --> 00:16:24,569
person both of them were signed by the

315
00:16:24,569 --> 00:16:30,699
legitimate signature so that's also

316
00:16:30,699 --> 00:16:35,279
saying and when you look at the URL it's

317
00:16:35,279 --> 00:16:39,029
the both of the applications use malware

318
00:16:39,029 --> 00:16:41,800
they are pretty similar in part they are

319
00:16:41,800 --> 00:16:46,420
exactly the same so are they from the

320
00:16:46,420 --> 00:16:54,790
same out there maybe but that's on

321
00:16:54,790 --> 00:16:58,180
YouTube what do you think so Peter okay

322
00:16:58,180 --> 00:17:01,089
we have some time and so conclude with

323
00:17:01,089 --> 00:17:02,920
an experimental part this one is not

324
00:17:02,920 --> 00:17:06,159
finished yet all we want to is the to

325
00:17:06,159 --> 00:17:08,980
leave an impression what's possible so

326
00:17:08,980 --> 00:17:11,020
what's the volatility framework shortly

327
00:17:11,020 --> 00:17:14,079
bf it's like a bunch of scripts pattern

328
00:17:14,079 --> 00:17:16,000
scripts that operate with memory dumps

329
00:17:16,000 --> 00:17:18,939
and each memory dump is associated with

330
00:17:18,939 --> 00:17:22,619
a profile that the SL knows how to

331
00:17:22,619 --> 00:17:25,449
impart kernel kernel structures and so

332
00:17:25,449 --> 00:17:30,010
on and there is a bunch of make pre

333
00:17:30,010 --> 00:17:31,809
build profiles available on official

334
00:17:31,809 --> 00:17:33,080
report

335
00:17:33,080 --> 00:17:35,610
but they are not this list is not

336
00:17:35,610 --> 00:17:38,670
complete and also ll make OS Sierra is

337
00:17:38,670 --> 00:17:40,940
missing it's not available yet

338
00:17:40,940 --> 00:17:44,490
so actually we had some troubles with

339
00:17:44,490 --> 00:17:47,070
Mac profiles because correct profile is

340
00:17:47,070 --> 00:17:49,920
of utmost importance if you if you don't

341
00:17:49,920 --> 00:17:51,420
have correct profile with your memory

342
00:17:51,420 --> 00:17:55,230
damped you would get the error strings

343
00:17:55,230 --> 00:17:57,330
like in vogue profile selected or not

344
00:17:57,330 --> 00:17:58,740
able address person I think nothing

345
00:17:58,740 --> 00:18:03,150
found so if you don't have a preview

346
00:18:03,150 --> 00:18:06,330
over the previous variant or previous

347
00:18:06,330 --> 00:18:07,830
profile you could create it on your own

348
00:18:07,830 --> 00:18:11,130
you should follow all the hints that are

349
00:18:11,130 --> 00:18:13,590
provided on the official DF bit by

350
00:18:13,590 --> 00:18:16,140
clicking pages so you should run this in

351
00:18:16,140 --> 00:18:19,740
appeal on on some some data this data a

352
00:18:19,740 --> 00:18:22,020
kernel debug it another strange thing

353
00:18:22,020 --> 00:18:24,390
than not every system update of Mac OS

354
00:18:24,390 --> 00:18:28,170
has available kernel debugger that's act

355
00:18:28,170 --> 00:18:31,050
but this this comment worked well

356
00:18:31,050 --> 00:18:33,390
actually we we downloaded one people

357
00:18:33,390 --> 00:18:34,710
profile and if you want to reproduce

358
00:18:34,710 --> 00:18:38,640
reproduce this profile during during

359
00:18:38,640 --> 00:18:41,130
this these comments and you have to do

360
00:18:41,130 --> 00:18:44,160
also another another comment but in this

361
00:18:44,160 --> 00:18:49,500
case the output differ so so we we sell

362
00:18:49,500 --> 00:18:52,590
to sell to get get profiles using this

363
00:18:52,590 --> 00:18:56,610
this receipt so that therefore we we

364
00:18:56,610 --> 00:18:59,280
focus only people profile so this was

365
00:18:59,280 --> 00:19:01,320
first obstacles then our test

366
00:19:01,320 --> 00:19:03,180
environments we have real hardware and

367
00:19:03,180 --> 00:19:06,420
to virtualizations namely the under and

368
00:19:06,420 --> 00:19:10,410
d box real hardware is fine it was Mac

369
00:19:10,410 --> 00:19:13,050
Mini 8 gigabytes of memory running l

370
00:19:13,050 --> 00:19:17,310
captain what was of great importance at

371
00:19:17,310 --> 00:19:19,110
this case was to achieve memory jump

372
00:19:19,110 --> 00:19:22,230
from the system we borrowed a tool

373
00:19:22,230 --> 00:19:23,790
called OS x DM from

374
00:19:23,790 --> 00:19:26,400
recall framer this another forensic

375
00:19:26,400 --> 00:19:29,600
analyst framework available online and

376
00:19:29,600 --> 00:19:31,860
actually this was a recent version from

377
00:19:31,860 --> 00:19:36,410
May 2016 the two steps first step is to

378
00:19:36,410 --> 00:19:39,300
load kernel extension and the second

379
00:19:39,300 --> 00:19:42,150
step is to actually dump the memory

380
00:19:42,150 --> 00:19:44,880
note that we you should explicitly state

381
00:19:44,880 --> 00:19:46,910
the format because otherwise

382
00:19:46,910 --> 00:19:48,740
the output would be an inner format that

383
00:19:48,740 --> 00:19:51,590
we as if not comfortable this and but

384
00:19:51,590 --> 00:19:53,930
what was this was like good news good

385
00:19:53,930 --> 00:19:55,790
news but the bad news was that this was

386
00:19:55,790 --> 00:19:58,130
like silence overhead because it's

387
00:19:58,130 --> 00:19:59,720
interactive real Hardware you should

388
00:19:59,720 --> 00:20:03,080
revert somehow clean it and this was not

389
00:20:03,080 --> 00:20:06,380
what we expected from our environment so

390
00:20:06,380 --> 00:20:08,480
that's what we focused on virtualization

391
00:20:08,480 --> 00:20:10,730
but we our computers are running Windows

392
00:20:10,730 --> 00:20:13,820
and installing Mac Mac OS was kind of

393
00:20:13,820 --> 00:20:17,000
kind of trouble definitely on VirtualBox

394
00:20:17,000 --> 00:20:20,270
because it is Virtual Assistants

395
00:20:20,270 --> 00:20:22,760
important installations of autistics

396
00:20:22,760 --> 00:20:25,490
were very unstable holder we succeeded

397
00:20:25,490 --> 00:20:28,280
with one case and it was neck job

398
00:20:28,280 --> 00:20:31,820
tonight running on VBox on on the

399
00:20:31,820 --> 00:20:36,890
windows computer at work memory dump was

400
00:20:36,890 --> 00:20:41,150
so very easy that was good news however

401
00:20:41,150 --> 00:20:43,880
we tried also being there at this time

402
00:20:43,880 --> 00:20:46,580
installation of OS X operating system

403
00:20:46,580 --> 00:20:49,460
was very smooth virtualization will fine

404
00:20:49,460 --> 00:20:52,700
system they were ok but however no no

405
00:20:52,700 --> 00:20:54,320
idea about transition applications our

406
00:20:54,320 --> 00:20:58,490
question here so we we can't reproduce

407
00:20:58,490 --> 00:21:03,500
our modern executions here and also in

408
00:21:03,500 --> 00:21:05,480
this case memory dumps very easy it is

409
00:21:05,480 --> 00:21:07,730
just the last demon file in the

410
00:21:07,730 --> 00:21:11,450
directory of virtual machine ok so we

411
00:21:11,450 --> 00:21:15,460
have one that environment and we have

412
00:21:15,460 --> 00:21:19,970
like we could apply Mac plugins this is

413
00:21:19,970 --> 00:21:22,400
just categories and various mcCluggage

414
00:21:22,400 --> 00:21:25,190
that are available to reach some system

415
00:21:25,190 --> 00:21:28,750
information from memory

416
00:21:29,200 --> 00:21:34,220
ok and now scheme this is what we like

417
00:21:34,220 --> 00:21:36,410
imagine how could this this thing work

418
00:21:36,410 --> 00:21:39,470
we do member drive is built in 2015 not

419
00:21:39,470 --> 00:21:42,890
in commonly presented he still called

420
00:21:42,890 --> 00:21:48,920
volatility but it was like like also

421
00:21:48,920 --> 00:21:51,710
written in the inner Titan and it was

422
00:21:51,710 --> 00:21:53,330
like working with volatility likes

423
00:21:53,330 --> 00:21:55,640
creating golden image that means fixing

424
00:21:55,640 --> 00:21:59,210
some clean state producing output then

425
00:21:59,210 --> 00:22:00,290
exec

426
00:22:00,290 --> 00:22:04,280
using executing some unknown unknown

427
00:22:04,280 --> 00:22:07,850
sample and then comparing outputs so it

428
00:22:07,850 --> 00:22:09,890
was very comfortable to work with in

429
00:22:09,890 --> 00:22:12,440
command line so we adapted this from his

430
00:22:12,440 --> 00:22:15,260
PE version because he his intentions

431
00:22:15,260 --> 00:22:19,520
were for Windows molar to OS X dmg dmg

432
00:22:19,520 --> 00:22:24,140
volumes and so so we collected this

433
00:22:24,140 --> 00:22:26,900
output from both states and now we could

434
00:22:26,900 --> 00:22:28,730
like doing some blacklisting

435
00:22:28,730 --> 00:22:30,640
whitelisting we could produce two

436
00:22:30,640 --> 00:22:34,130
outcomes the first one is to create

437
00:22:34,130 --> 00:22:37,280
another VF plug-in that would detect

438
00:22:37,280 --> 00:22:40,090
detect indicators of compromised on

439
00:22:40,090 --> 00:22:43,070
infected Mac systems and the second

440
00:22:43,070 --> 00:22:46,460
cleaning script and if this is not

441
00:22:46,460 --> 00:22:49,840
enough then we wanted to visualize these

442
00:22:49,840 --> 00:22:52,670
different outputs and for this purpose

443
00:22:52,670 --> 00:22:55,730
we use the volatility graphic user

444
00:22:55,730 --> 00:22:59,090
interface volatility of written by Kevin

445
00:22:59,090 --> 00:23:02,930
Breen this year 2016 and how does it

446
00:23:02,930 --> 00:23:06,740
look like this is it's like that

447
00:23:06,740 --> 00:23:09,710
interface this is initial page two

448
00:23:09,710 --> 00:23:12,650
sessions we have like infected or Tex

449
00:23:12,650 --> 00:23:15,680
transition out in August and in in March

450
00:23:15,680 --> 00:23:19,000
and a little quick let us click on the

451
00:23:19,000 --> 00:23:22,130
recent version that means in-depth one

452
00:23:22,130 --> 00:23:24,560
from August at the upper upper left part

453
00:23:24,560 --> 00:23:26,240
of the next webpage you would see

454
00:23:26,240 --> 00:23:28,910
session information which name did we

455
00:23:28,910 --> 00:23:31,370
choose path to memory file memory

456
00:23:31,370 --> 00:23:33,650
profile is selected automatically right

457
00:23:33,650 --> 00:23:37,580
it is set that way of your creation date

458
00:23:37,580 --> 00:23:41,390
and the last thing is it used its golden

459
00:23:41,390 --> 00:23:44,270
images in use that means you will see in

460
00:23:44,270 --> 00:23:45,920
the next slides there would be a special

461
00:23:45,920 --> 00:23:49,310
column column called beef and in that

462
00:23:49,310 --> 00:23:51,950
column you would have an information if

463
00:23:51,950 --> 00:23:54,080
this was present in the golden image or

464
00:23:54,080 --> 00:23:59,450
not so let's go out more web scroll us

465
00:23:59,450 --> 00:24:03,350
down the web page and we found text box

466
00:24:03,350 --> 00:24:07,100
called filter plugins if you filter

467
00:24:07,100 --> 00:24:08,900
plugins another it it would be like risk

468
00:24:08,900 --> 00:24:13,130
of list of plugins with output or

469
00:24:13,130 --> 00:24:15,380
I D like generated and on the on the

470
00:24:15,380 --> 00:24:18,080
right track it's like output of this

471
00:24:18,080 --> 00:24:20,270
time Nationals plug-in you could see

472
00:24:20,270 --> 00:24:23,360
like in ID with ID 5 there's volume

473
00:24:23,360 --> 00:24:25,580
called transmission and in the column

474
00:24:25,580 --> 00:24:28,910
give it is the information that this was

475
00:24:28,910 --> 00:24:32,740
not present in golden image state and

476
00:24:32,740 --> 00:24:36,020
how to filter plugins we even started

477
00:24:36,020 --> 00:24:39,080
two types processes you get just those

478
00:24:39,080 --> 00:24:42,230
those plugins related to two two

479
00:24:42,230 --> 00:24:45,110
processes and process memories you could

480
00:24:45,110 --> 00:24:47,900
read makes pH the Negev and so on so let

481
00:24:47,900 --> 00:24:49,550
us choose some standard one you could

482
00:24:49,550 --> 00:24:52,930
see the output actually license RTF is

483
00:24:52,930 --> 00:24:55,340
malicious one iCloud properties or

484
00:24:55,340 --> 00:24:58,040
client transmission is the BitTorrent

485
00:24:58,040 --> 00:25:00,740
client that explain one höllerer it is

486
00:25:00,740 --> 00:25:02,990
dropping the first two and the last

487
00:25:02,990 --> 00:25:05,510
three three processes is like system

488
00:25:05,510 --> 00:25:06,920
processes connected with mounting

489
00:25:06,920 --> 00:25:11,420
mounting a volume okay and another

490
00:25:11,420 --> 00:25:13,790
negative x view now you can see in your

491
00:25:13,790 --> 00:25:17,810
right upper start search search text box

492
00:25:17,810 --> 00:25:21,080
detects the box and if you start

493
00:25:21,080 --> 00:25:25,820
starting here rows are filtered based on

494
00:25:25,820 --> 00:25:27,860
the content in the window so if you

495
00:25:27,860 --> 00:25:30,770
start typing like new page then just

496
00:25:30,770 --> 00:25:34,580
processes that are created in a infected

497
00:25:34,580 --> 00:25:37,400
image are displayed only it is like six

498
00:25:37,400 --> 00:25:40,180
processes three of them are system one

499
00:25:40,180 --> 00:25:43,130
after getting more experience with with

500
00:25:43,130 --> 00:25:45,140
this this framework once you the

501
00:25:45,140 --> 00:25:47,540
advantage lightly like with black with

502
00:25:47,540 --> 00:25:51,140
information that is not important but

503
00:25:51,140 --> 00:25:53,120
those three other important transmission

504
00:25:53,120 --> 00:25:57,410
icon proteolysis doc RTF okay let's

505
00:25:57,410 --> 00:26:00,350
let's start typing plugins connected

506
00:26:00,350 --> 00:26:03,290
with networking and namely it you choose

507
00:26:03,290 --> 00:26:06,470
one called neck net stuff actually with

508
00:26:06,470 --> 00:26:08,150
one one row that is highlighted is

509
00:26:08,150 --> 00:26:10,870
obvious false positives and this is a

510
00:26:10,870 --> 00:26:14,330
obvious disadvantage of lot exported

511
00:26:14,330 --> 00:26:16,940
framework as a non-life - it's just

512
00:26:16,940 --> 00:26:20,320
seeking context in the in the memory so

513
00:26:20,320 --> 00:26:22,220
sometimes sometimes the time for

514
00:26:22,220 --> 00:26:25,610
politics Iraq and in these magnets that

515
00:26:25,610 --> 00:26:26,930
output we start

516
00:26:26,930 --> 00:26:28,850
the filter of course new pitch and now

517
00:26:28,850 --> 00:26:30,710
we see that transmission opens

518
00:26:30,710 --> 00:26:34,850
connections UDP and TCP and iCloud

519
00:26:34,850 --> 00:26:38,420
closet or store clients also established

520
00:26:38,420 --> 00:26:40,820
some some connections if you if you

521
00:26:40,820 --> 00:26:42,770
extract those remote IPs and put it in

522
00:26:42,770 --> 00:26:44,300
the web search you would find out that

523
00:26:44,300 --> 00:26:46,910
those are torn out so everything makes

524
00:26:46,910 --> 00:26:51,620
sense okay this is Amex PSL plugin it's

525
00:26:51,620 --> 00:26:56,570
like argument letter that are used with

526
00:26:56,570 --> 00:26:58,760
each each process I would like to point

527
00:26:58,760 --> 00:27:01,970
out only the last row because it was we

528
00:27:01,970 --> 00:27:04,810
blocked be blocked about dated at the

529
00:27:04,810 --> 00:27:08,800
model these guys itself like I got from

530
00:27:08,800 --> 00:27:12,140
the round from from some special

531
00:27:12,140 --> 00:27:14,060
location and this is like a proof house

532
00:27:14,060 --> 00:27:15,650
that it did this were a lot different

533
00:27:15,650 --> 00:27:21,860
framework sees that also and the final

534
00:27:21,860 --> 00:27:24,890
final thing next house necklace file

535
00:27:24,890 --> 00:27:27,650
plugin actually you have memory but you

536
00:27:27,650 --> 00:27:29,210
don't have our system but there are

537
00:27:29,210 --> 00:27:31,820
references to file in the internal

538
00:27:31,820 --> 00:27:34,340
memory and these are extracted actually

539
00:27:34,340 --> 00:27:37,280
the note that one page is 100 entries

540
00:27:37,280 --> 00:27:40,760
and it is like 146

541
00:27:40,760 --> 00:27:42,470
these pages so there are a lot of

542
00:27:42,470 --> 00:27:45,650
references but if you if you filter with

543
00:27:45,650 --> 00:27:50,090
the word new file ok the first row is

544
00:27:50,090 --> 00:27:52,460
the false positive it should be like

545
00:27:52,460 --> 00:27:56,030
light with it later but all the others

546
00:27:56,030 --> 00:27:58,760
new files where we are indicators of

547
00:27:58,760 --> 00:28:01,910
compromise and there is no pages but the

548
00:28:01,910 --> 00:28:03,530
rest works like the content of the

549
00:28:03,530 --> 00:28:05,540
volume itself the volume of transmission

550
00:28:05,540 --> 00:28:10,460
I guess this is this is the final final

551
00:28:10,460 --> 00:28:13,490
slide only intention is to leave an

552
00:28:13,490 --> 00:28:15,560
impression what it's possible we would

553
00:28:15,560 --> 00:28:18,500
like to acknowledge our our colleagues

554
00:28:18,500 --> 00:28:21,110
who did a great job like especially

555
00:28:21,110 --> 00:28:23,630
market chain letter a and Alexis

556
00:28:23,630 --> 00:28:26,150
daughter I don't cast and also middle

557
00:28:26,150 --> 00:28:31,130
you know again and others I guess we

558
00:28:31,130 --> 00:28:32,570
were very very glad to answer any

559
00:28:32,570 --> 00:28:35,600
questions any comments to this work and

560
00:28:35,600 --> 00:28:37,880
this is end of our yeah thank you very

561
00:28:37,880 --> 00:28:39,900
much unfortunately we are out of time

562
00:28:39,900 --> 00:28:42,630
so we don't have questions but if you

563
00:28:42,630 --> 00:28:44,550
can catch up with Peter and Martin out

564
00:28:44,550 --> 00:28:46,500
in the hall that would be great so would

565
00:28:46,500 --> 00:28:48,210
you please join with me in thanking them

566
00:28:48,210 --> 00:28:50,290
for a terrific presentation

567
00:28:50,290 --> 00:28:54,879
[Applause]

