1
00:00:00,530 --> 00:00:03,030
welcome back everybody and now we have

2
00:00:03,030 --> 00:00:05,430
another session this one with Excel

3
00:00:05,430 --> 00:00:10,980
Abril from Fortinet yeah good morning

4
00:00:10,980 --> 00:00:13,679
everybody thanks for joining me on this

5
00:00:13,679 --> 00:00:17,039
session on internet of toothbrush no I'm

6
00:00:17,039 --> 00:00:20,490
joking but we will be talking about this

7
00:00:20,490 --> 00:00:22,320
connected toothbrush

8
00:00:22,320 --> 00:00:26,460
I brought here reversing that also this

9
00:00:26,460 --> 00:00:29,039
is a sony smartwatch there we'll be

10
00:00:29,039 --> 00:00:31,650
talking about that one and then house

11
00:00:31,650 --> 00:00:32,098
alarm

12
00:00:32,098 --> 00:00:34,050
well that's bigger I couldn't bring that

13
00:00:34,050 --> 00:00:37,649
one but that's basically the content of

14
00:00:37,649 --> 00:00:42,989
the presentation so actually I'll spare

15
00:00:42,989 --> 00:00:47,370
you all the figures the statistics about

16
00:00:47,370 --> 00:00:49,800
how much IOT is growing I think you all

17
00:00:49,800 --> 00:00:53,030
know it is growing tremendously and

18
00:00:53,030 --> 00:00:56,129
that's one of the reasons if we want to

19
00:00:56,129 --> 00:00:59,039
improve their security well we have to

20
00:00:59,039 --> 00:01:00,539
understand and know how they're working

21
00:01:00,539 --> 00:01:03,660
and reverse-engineer them but reverse

22
00:01:03,660 --> 00:01:07,439
engineering the connected objects it's

23
00:01:07,439 --> 00:01:08,100
not easy

24
00:01:08,100 --> 00:01:10,770
so that's precisely what I'm gonna talk

25
00:01:10,770 --> 00:01:16,320
about this morning so imagine one

26
00:01:16,320 --> 00:01:19,049
morning your I don't know your favorite

27
00:01:19,049 --> 00:01:21,299
customer or your favorites and manager

28
00:01:21,299 --> 00:01:24,960
whoever gives you this smart watch at

29
00:01:24,960 --> 00:01:27,479
your office that's what happened to me I

30
00:01:27,479 --> 00:01:29,310
was overwhelmed of course and you get it

31
00:01:29,310 --> 00:01:32,159
to play with that's great but besides

32
00:01:32,159 --> 00:01:35,400
this the question is really how are you

33
00:01:35,400 --> 00:01:38,070
going to reverse it how are you going to

34
00:01:38,070 --> 00:01:41,159
do some work with it given the fact that

35
00:01:41,159 --> 00:01:44,220
I have no skills whatsoever on Smart

36
00:01:44,220 --> 00:01:48,360
Watch so well I could be asking you the

37
00:01:48,360 --> 00:01:50,700
question and perhaps if we have time for

38
00:01:50,700 --> 00:01:53,490
questions at the end you will have some

39
00:01:53,490 --> 00:01:55,829
some other ideas but what happened is I

40
00:01:55,829 --> 00:01:58,740
asked around me to my Calise and tell

41
00:01:58,740 --> 00:02:00,240
them well how what would you you be

42
00:02:00,240 --> 00:02:02,700
doing and basically I had five different

43
00:02:02,700 --> 00:02:05,100
answers five different types of answers

44
00:02:05,100 --> 00:02:09,060
more exactly so the first one was I

45
00:02:09,060 --> 00:02:12,180
browse the web for documentation first

46
00:02:12,180 --> 00:02:13,890
and indeed for this

47
00:02:13,890 --> 00:02:17,040
watch it is a good idea because Sony is

48
00:02:17,040 --> 00:02:20,160
releasing an SDK for their developers to

49
00:02:20,160 --> 00:02:23,190
implement some new smart applications

50
00:02:23,190 --> 00:02:24,530
that end on the watch

51
00:02:24,530 --> 00:02:27,690
so you find quite lots of information

52
00:02:27,690 --> 00:02:29,700
there you even find some kind of

53
00:02:29,700 --> 00:02:33,450
technical down information such as that

54
00:02:33,450 --> 00:02:34,860
it is running a real-time operating

55
00:02:34,860 --> 00:02:39,420
system which is known as micro cos2 so

56
00:02:39,420 --> 00:02:41,820
in case you were skilled on that

57
00:02:41,820 --> 00:02:44,100
operating system it's a good way to

58
00:02:44,100 --> 00:02:48,510
start there you can of course tear it

59
00:02:48,510 --> 00:02:52,620
down that's I didn't do that that one so

60
00:02:52,620 --> 00:02:55,019
those are this is another picture taken

61
00:02:55,019 --> 00:02:58,320
on the web of teardown of the the Smart

62
00:02:58,320 --> 00:03:01,890
Watch once it's torn down of course you

63
00:03:01,890 --> 00:03:05,160
can probe for test points JTAG things

64
00:03:05,160 --> 00:03:07,230
like those I myself had a look at the

65
00:03:07,230 --> 00:03:09,570
USB interface didn't give me anything

66
00:03:09,570 --> 00:03:12,959
interesting though if you have lots of

67
00:03:12,959 --> 00:03:15,630
equipments such as a nice microscope for

68
00:03:15,630 --> 00:03:17,940
an oscilloscope you can even dig in

69
00:03:17,940 --> 00:03:22,019
further I'm not a hardware engineer and

70
00:03:22,019 --> 00:03:24,470
I believe that in the audience of VB

71
00:03:24,470 --> 00:03:27,060
most people are like me or rather a

72
00:03:27,060 --> 00:03:30,600
software or low-level software so I

73
00:03:30,600 --> 00:03:33,299
didn't find that very easy to to work on

74
00:03:33,299 --> 00:03:39,900
this solution there third one kidnapped

75
00:03:39,900 --> 00:03:42,480
the developer get access to his RPC and

76
00:03:42,480 --> 00:03:45,890
grab the sources that's one answer I got

77
00:03:45,890 --> 00:03:49,110
obviously we won't be doing that but for

78
00:03:49,110 --> 00:03:51,540
sure some social engineering would

79
00:03:51,540 --> 00:03:55,410
indeed probably be very well we would

80
00:03:55,410 --> 00:03:56,820
probably get quite a lot of results

81
00:03:56,820 --> 00:03:59,459
there if we managed to get some

82
00:03:59,459 --> 00:04:00,750
information from the developers

83
00:04:00,750 --> 00:04:03,570
themselves but of course this is illegal

84
00:04:03,570 --> 00:04:07,860
so we won't be doing that another way is

85
00:04:07,860 --> 00:04:12,030
well not to actually be looking at

86
00:04:12,030 --> 00:04:14,850
really the device itself but all the

87
00:04:14,850 --> 00:04:18,350
network communications that it is doing

88
00:04:18,350 --> 00:04:21,570
so in the case of the SmartWatch there

89
00:04:21,570 --> 00:04:25,320
there's no Wi-Fi connection there is

90
00:04:25,320 --> 00:04:27,470
some Bluetooth

91
00:04:27,470 --> 00:04:30,150
so that's cool we can have a look at

92
00:04:30,150 --> 00:04:32,310
Bluetooth well except that Bluetooth is

93
00:04:32,310 --> 00:04:34,350
encrypted so that's a little bit more

94
00:04:34,350 --> 00:04:36,870
difficult but we can still work this to

95
00:04:36,870 --> 00:04:38,670
ground I don't know if you've heard of

96
00:04:38,670 --> 00:04:40,530
that but there's a tool called uber

97
00:04:40,530 --> 00:04:42,360
tooth it's a small device that you can

98
00:04:42,360 --> 00:04:44,580
plug in and with another program called

99
00:04:44,580 --> 00:04:46,920
crackling you can decrypt those

100
00:04:46,920 --> 00:04:51,710
encrypted packets and and work on that

101
00:04:51,710 --> 00:04:55,230
however that's my feeling you will get

102
00:04:55,230 --> 00:05:00,050
like dozens thousands of packets and

103
00:05:00,050 --> 00:05:03,060
it's really difficult to work out what's

104
00:05:03,060 --> 00:05:05,430
there meaning because you have no labels

105
00:05:05,430 --> 00:05:07,800
nothing to help you out so you basically

106
00:05:07,800 --> 00:05:09,990
say oh this one I don't like it this one

107
00:05:09,990 --> 00:05:11,670
oh maybe the two first bytes have a

108
00:05:11,670 --> 00:05:13,620
meaning or things like that and you you

109
00:05:13,620 --> 00:05:15,630
end up spending hours reading at that

110
00:05:15,630 --> 00:05:21,800
worklogs which is quite well a long task

111
00:05:22,250 --> 00:05:26,280
final solution in the case of the Smart

112
00:05:26,280 --> 00:05:28,290
Watch of course you can develop your own

113
00:05:28,290 --> 00:05:31,890
smart application possibly kind of a

114
00:05:31,890 --> 00:05:35,760
hacking application and that way you

115
00:05:35,760 --> 00:05:37,590
will be able to understand a little bit

116
00:05:37,590 --> 00:05:39,570
more how the Smart Watch is worse is

117
00:05:39,570 --> 00:05:41,850
working and thus reverse-engineer it

118
00:05:41,850 --> 00:05:49,350
right so all of those solutions they are

119
00:05:49,350 --> 00:05:51,930
all feasible and it depends also on your

120
00:05:51,930 --> 00:05:56,070
skills of course but I'd say you've

121
00:05:56,070 --> 00:05:58,470
globally good luck because you're gonna

122
00:05:58,470 --> 00:06:00,720
you're in for like months of reverse

123
00:06:00,720 --> 00:06:05,010
engineering of just a single outlet it's

124
00:06:05,010 --> 00:06:07,800
going to be long painful because you

125
00:06:07,800 --> 00:06:09,390
don't find that much information on the

126
00:06:09,390 --> 00:06:11,580
web there isn't that much community on

127
00:06:11,580 --> 00:06:15,120
the web to help you out and once you

128
00:06:15,120 --> 00:06:17,280
finish this when you've finished with a

129
00:06:17,280 --> 00:06:19,440
SmartWatch well what happens usually you

130
00:06:19,440 --> 00:06:21,690
have your other favorite manager or

131
00:06:21,690 --> 00:06:23,910
customer coming with this time another

132
00:06:23,910 --> 00:06:28,500
outlet another device this time in my

133
00:06:28,500 --> 00:06:31,919
case the toothbrush and well don't

134
00:06:31,919 --> 00:06:33,810
expect that your experience on the

135
00:06:33,810 --> 00:06:36,539
SmartWatch is going to help you for the

136
00:06:36,539 --> 00:06:39,180
toothbrush it's not ok they are very

137
00:06:39,180 --> 00:06:40,320
different to both of them

138
00:06:40,320 --> 00:06:42,810
hardware is different the architecture

139
00:06:42,810 --> 00:06:46,550
is different the protocols are different

140
00:06:46,550 --> 00:06:49,260
you have to start over from scratch so

141
00:06:49,260 --> 00:06:51,900
you're in again four months of reversing

142
00:06:51,900 --> 00:06:54,120
to to get anything from this toothbrush

143
00:06:54,120 --> 00:06:58,830
and if we multiply this by all the

144
00:06:58,830 --> 00:07:01,470
different kinds of smart objects that

145
00:07:01,470 --> 00:07:04,950
are in the world well means we're going

146
00:07:04,950 --> 00:07:07,020
to spend years doing some reverse

147
00:07:07,020 --> 00:07:09,030
engineering before we can do something

148
00:07:09,030 --> 00:07:11,730
positive for their security so this is

149
00:07:11,730 --> 00:07:17,130
clearly not acceptable so of course I

150
00:07:17,130 --> 00:07:19,740
have a partial solution that I wanted to

151
00:07:19,740 --> 00:07:24,360
talk to you here I believe that there's

152
00:07:24,360 --> 00:07:28,140
a way to work this around and to go a

153
00:07:28,140 --> 00:07:30,480
little bit faster and that way is to

154
00:07:30,480 --> 00:07:32,550
have a look at the mobile application

155
00:07:32,550 --> 00:07:36,560
that usually comes with those devices so

156
00:07:36,560 --> 00:07:39,210
for instance with the SmartWatch well

157
00:07:39,210 --> 00:07:42,320
you have a mobile application to send

158
00:07:42,320 --> 00:07:45,360
which smart application you want to put

159
00:07:45,360 --> 00:07:49,290
on the SmartWatch for the for the

160
00:07:49,290 --> 00:07:51,000
toothbrush you've got also a mobile

161
00:07:51,000 --> 00:07:53,610
application to make sure that you have

162
00:07:53,610 --> 00:07:54,990
correctly brushed your teeth this

163
00:07:54,990 --> 00:07:55,410
morning

164
00:07:55,410 --> 00:07:58,110
okay and plenty of other things there

165
00:07:58,110 --> 00:08:01,050
you've got a basketball there that is oh

166
00:08:01,050 --> 00:08:02,280
well you've got a mobile mobile

167
00:08:02,280 --> 00:08:04,710
application to tell you how well you've

168
00:08:04,710 --> 00:08:08,310
been scoring you've got sports

169
00:08:08,310 --> 00:08:10,140
wristbands it will tell you how well you

170
00:08:10,140 --> 00:08:12,240
perform well you've got dozens of mobile

171
00:08:12,240 --> 00:08:17,250
application and if you start and reverse

172
00:08:17,250 --> 00:08:20,520
those you will get some really valuable

173
00:08:20,520 --> 00:08:23,370
information and it's especially useful

174
00:08:23,370 --> 00:08:26,790
and handy to do for antivirus and notice

175
00:08:26,790 --> 00:08:29,430
because we're used to reversing things

176
00:08:29,430 --> 00:08:34,770
and software that way so I'll be giving

177
00:08:34,770 --> 00:08:36,719
for the rest of the talk well a few

178
00:08:36,719 --> 00:08:39,030
examples of how well this technique

179
00:08:39,030 --> 00:08:43,409
worked or not for given devices for so

180
00:08:43,409 --> 00:08:45,840
first the connected toothbrush then the

181
00:08:45,840 --> 00:08:50,880
SmartWatch and then the house alarm so

182
00:08:50,880 --> 00:08:53,400
first the connected toothbrush

183
00:08:53,400 --> 00:08:54,060
it's

184
00:08:54,060 --> 00:08:56,670
um this one I think it's commercialized

185
00:08:56,670 --> 00:08:59,430
in the US only as far as I know I'm not

186
00:08:59,430 --> 00:09:01,110
exactly sure it's commercialized by

187
00:09:01,110 --> 00:09:04,680
being technologies they also happen to

188
00:09:04,680 --> 00:09:08,480
be your dental insurance and so they

189
00:09:08,480 --> 00:09:12,900
sell the toothbrush or well the they

190
00:09:12,900 --> 00:09:14,100
send over their toothbrush to their

191
00:09:14,100 --> 00:09:17,160
customers along with the application to

192
00:09:17,160 --> 00:09:19,920
ensure that's well the customers are

193
00:09:19,920 --> 00:09:21,779
brushing correctly their teeth and to

194
00:09:21,779 --> 00:09:26,060
improve their brushing habits kind of I

195
00:09:26,450 --> 00:09:30,120
had to look at the iOS application and

196
00:09:30,120 --> 00:09:32,580
the first thing which is interesting to

197
00:09:32,580 --> 00:09:34,980
you to look into is SQL tables because

198
00:09:34,980 --> 00:09:37,950
with SQL tables you basically know what

199
00:09:37,950 --> 00:09:41,130
is what's the application is holding the

200
00:09:41,130 --> 00:09:44,400
the various information and possibly

201
00:09:44,400 --> 00:09:45,990
what's the toothbrush itself is

202
00:09:45,990 --> 00:09:49,260
interacting with so to search all the

203
00:09:49,260 --> 00:09:51,720
SQL tables the easy way to do that is to

204
00:09:51,720 --> 00:09:54,450
search for the primary keys so search

205
00:09:54,450 --> 00:09:57,230
with for primary key and then there's a

206
00:09:57,230 --> 00:10:00,060
function named mappings in each cases

207
00:10:00,060 --> 00:10:02,640
and you have a look at those and you get

208
00:10:02,640 --> 00:10:05,310
all the fields in the table of the SQL

209
00:10:05,310 --> 00:10:08,400
table so I did this and you can you know

210
00:10:08,400 --> 00:10:12,960
map plenty of databases there and see

211
00:10:12,960 --> 00:10:16,890
you all the information in there the

212
00:10:16,890 --> 00:10:19,470
other thing that you can do again this

213
00:10:19,470 --> 00:10:23,570
is an Ida Pro disassembly output is

214
00:10:23,570 --> 00:10:25,430
completely reconstruct the

215
00:10:25,430 --> 00:10:27,920
implementation design of the application

216
00:10:27,920 --> 00:10:33,030
so here for instance that they're not

217
00:10:33,030 --> 00:10:34,710
sure it's exactly readable from the back

218
00:10:34,710 --> 00:10:37,260
it's written user summary so it's the

219
00:10:37,260 --> 00:10:38,820
name of a class user summary

220
00:10:38,820 --> 00:10:41,640
and beneath there here you've got a list

221
00:10:41,640 --> 00:10:43,890
of methods the methods of the class and

222
00:10:43,890 --> 00:10:47,430
then here we've got a list of properties

223
00:10:47,430 --> 00:10:50,310
those correspond to the fields of the

224
00:10:50,310 --> 00:10:51,810
class so you've got the name of the

225
00:10:51,810 --> 00:10:53,279
class the methods what it's been doing

226
00:10:53,279 --> 00:10:55,920
the possible actions and also the data

227
00:10:55,920 --> 00:11:00,089
that it holds that the fields and with

228
00:11:00,089 --> 00:11:03,570
that you can like nearly close to do a

229
00:11:03,570 --> 00:11:07,080
UML diagram of the

230
00:11:07,080 --> 00:11:08,850
occasion and work out how it's working

231
00:11:08,850 --> 00:11:13,410
and what it's doing for instance in that

232
00:11:13,410 --> 00:11:15,900
case we can see that there's a class

233
00:11:15,900 --> 00:11:18,510
name Bluetooth bTW brush data blue

234
00:11:18,510 --> 00:11:21,000
toothbrush data we see there's an

235
00:11:21,000 --> 00:11:23,610
accelerometer and a gyroscope so we

236
00:11:23,610 --> 00:11:26,430
didn't even have to open it and you tear

237
00:11:26,430 --> 00:11:27,990
it down we already know a little bit

238
00:11:27,990 --> 00:11:30,210
what sensors are inside and by the way

239
00:11:30,210 --> 00:11:32,010
there's no public documentation of that

240
00:11:32,010 --> 00:11:34,170
so I couldn't find that on the web

241
00:11:34,170 --> 00:11:37,680
okay the other class which is

242
00:11:37,680 --> 00:11:40,620
interesting a BT firmware updater well

243
00:11:40,620 --> 00:11:43,260
we see here it's probably so small so I

244
00:11:43,260 --> 00:11:46,320
read it for you OTA service so

245
00:11:46,320 --> 00:11:48,420
over-the-air service which means that

246
00:11:48,420 --> 00:11:49,980
it's probably contacting an over-the-air

247
00:11:49,980 --> 00:11:52,890
service by bluetooth you upload a new

248
00:11:52,890 --> 00:11:58,440
firmware for the toothbrush loads of

249
00:11:58,440 --> 00:12:00,270
more information I won't be getting or

250
00:12:00,270 --> 00:12:05,070
through all of these then this time I

251
00:12:05,070 --> 00:12:08,450
shifted to the Android application I

252
00:12:08,450 --> 00:12:10,560
probably could have found the same in

253
00:12:10,560 --> 00:12:13,410
the iOS application but well a little

254
00:12:13,410 --> 00:12:15,360
bit more you're used to reversing

255
00:12:15,360 --> 00:12:18,570
Android and I found out well that the

256
00:12:18,570 --> 00:12:20,880
the toothbrush was using a Bluetooth

257
00:12:20,880 --> 00:12:22,890
low-energy so this I actually I already

258
00:12:22,890 --> 00:12:26,640
knew but basically if you want to send

259
00:12:26,640 --> 00:12:28,410
commands to the toothbrush what you have

260
00:12:28,410 --> 00:12:31,760
to do is to read or write a bluetooth

261
00:12:31,760 --> 00:12:35,460
characteristic and to know exactly which

262
00:12:35,460 --> 00:12:38,370
characteristic you have to address you

263
00:12:38,370 --> 00:12:41,280
can to know it's a dress which is a UUID

264
00:12:41,280 --> 00:12:45,000
and you find those identifiers in the

265
00:12:45,000 --> 00:12:47,910
code so first one there another one

266
00:12:47,910 --> 00:12:49,530
there and you've got all the rest in the

267
00:12:49,530 --> 00:12:51,590
code so this one for instance

268
00:12:51,590 --> 00:12:54,540
corresponds to the address for the

269
00:12:54,540 --> 00:12:57,090
kradin buzz so that's the special buzz

270
00:12:57,090 --> 00:13:00,600
for this toothbrush if you said if you

271
00:13:00,600 --> 00:13:03,030
enable it and you brush correctly all

272
00:13:03,030 --> 00:13:04,890
four parts of your mouth

273
00:13:04,890 --> 00:13:07,530
well it's triggers off the bus right the

274
00:13:07,530 --> 00:13:09,740
buzzer

275
00:13:12,760 --> 00:13:14,350
and there are some other characteristics

276
00:13:14,350 --> 00:13:16,960
such as controlling the motor speed or

277
00:13:16,960 --> 00:13:19,450
getting the battery level of things like

278
00:13:19,450 --> 00:13:21,010
that so this is what I'm going to

279
00:13:21,010 --> 00:13:23,529
demonstrate now is well we're done a

280
00:13:23,529 --> 00:13:27,970
remote control the toothbrush and we're

281
00:13:27,970 --> 00:13:31,860
gonna set the motor speed to different

282
00:13:31,860 --> 00:13:34,360
parts of levels so normally it's a

283
00:13:34,360 --> 00:13:38,700
percentage between 0 and 100 of course

284
00:13:38,700 --> 00:13:41,680
100 means full speed zero doesn't mean

285
00:13:41,680 --> 00:13:43,540
actually the matter is off but just that

286
00:13:43,540 --> 00:13:47,470
it's very very low speed and if we want

287
00:13:47,470 --> 00:13:50,290
to control this we have we can send

288
00:13:50,290 --> 00:13:52,630
directly the percentage to the Bluetooth

289
00:13:52,630 --> 00:13:54,970
characteristic we have to send a byte

290
00:13:54,970 --> 00:13:58,390
value and that byte value well the the

291
00:13:58,390 --> 00:14:00,850
formula to to convert between the

292
00:14:00,850 --> 00:14:02,770
percentage and the byte value well it's

293
00:14:02,770 --> 00:14:04,990
that one and you get that through

294
00:14:04,990 --> 00:14:09,610
reverse engineering so let me shift to

295
00:14:09,610 --> 00:14:12,100
the demonstration and let's hope that

296
00:14:12,100 --> 00:14:16,990
the the Bluetooth toothbrush does work

297
00:14:16,990 --> 00:14:22,330
correctly so there I am first of all I'm

298
00:14:22,330 --> 00:14:28,480
going to scan to scan the devices the

299
00:14:28,480 --> 00:14:30,640
Bluetooth Low Energy devices which are

300
00:14:30,640 --> 00:14:33,670
nearby my my laptop might find some

301
00:14:33,670 --> 00:14:36,599
other things by the way

302
00:14:42,060 --> 00:14:49,060
never choose long passwords oops I guess

303
00:14:49,060 --> 00:14:52,390
you saw it there okay being brush it's

304
00:14:52,390 --> 00:14:57,730
that one now

305
00:14:57,730 --> 00:15:04,240
we're gonna read the battery level 90

306
00:15:04,240 --> 00:15:08,080
3.4 percent so it's pretty well charged

307
00:15:08,080 --> 00:15:11,820
and now we're gonna change the motor

308
00:15:11,820 --> 00:15:16,300
intensity so that's the usage for that

309
00:15:16,300 --> 00:15:22,380
small program we're gonna set it to

310
00:15:22,380 --> 00:15:25,480
first the lowest intensity so you'll

311
00:15:25,480 --> 00:15:28,060
have to to listen carefully because it's

312
00:15:28,060 --> 00:15:29,800
vibrating it makes a little bit of noise

313
00:15:29,800 --> 00:15:34,589
and that's how you'll see the difference

314
00:15:35,670 --> 00:15:40,660
okay so very little noise but it will

315
00:15:40,660 --> 00:15:46,920
grow so now 50%

316
00:15:47,030 --> 00:15:49,089
you

317
00:15:55,030 --> 00:15:57,580
okay so you can even make music with

318
00:15:57,580 --> 00:16:00,210
that content

319
00:16:01,029 --> 00:16:03,670
I'll put it back here for instance yeah

320
00:16:03,670 --> 00:16:05,829
okay what so you see that anyway you get

321
00:16:05,829 --> 00:16:08,850
the idea you can control it that way and

322
00:16:08,850 --> 00:16:12,009
do you finish that we can have a look

323
00:16:12,009 --> 00:16:16,720
again at the battery level 91% so it's

324
00:16:16,720 --> 00:16:21,310
down by a couple of percent there so

325
00:16:21,310 --> 00:16:28,689
let's go back to the slides there it is

326
00:16:28,689 --> 00:16:30,579
so yeah by the way the the formula for

327
00:16:30,579 --> 00:16:32,860
the battery level again again was taken

328
00:16:32,860 --> 00:16:36,370
through a reverse engineering there now

329
00:16:36,370 --> 00:16:40,000
I'm sewer plenty in the oguns ask this

330
00:16:40,000 --> 00:16:41,819
question we have who cares about

331
00:16:41,819 --> 00:16:45,009
changing motor speed of the toothbrush

332
00:16:45,009 --> 00:16:48,490
well you're partially right it's it's

333
00:16:48,490 --> 00:16:50,560
quite useless one part of it is useless

334
00:16:50,560 --> 00:16:52,629
and the other the other is might be

335
00:16:52,629 --> 00:16:56,829
useful there's kind of a cheese scenario

336
00:16:56,829 --> 00:16:58,540
which is a denial of service and

337
00:16:58,540 --> 00:17:00,639
ransomware you can of course drain the

338
00:17:00,639 --> 00:17:02,949
batteries of of the toothbrush and then

339
00:17:02,949 --> 00:17:05,380
it's no longer usable and the case of

340
00:17:05,380 --> 00:17:07,000
this toothbrush it's not very expensive

341
00:17:07,000 --> 00:17:09,209
so it's not really very attractive

342
00:17:09,209 --> 00:17:13,869
because you're perhaps going to waste a

343
00:17:13,869 --> 00:17:16,270
few bucks but not that much but if you

344
00:17:16,270 --> 00:17:17,289
have something which is more expensive

345
00:17:17,289 --> 00:17:19,449
like I don't know there's SmartWatch for

346
00:17:19,449 --> 00:17:23,470
some other more high-tech the device

347
00:17:23,470 --> 00:17:27,579
well then a ransomware might be a

348
00:17:27,579 --> 00:17:29,950
scenario that attackers might want to

349
00:17:29,950 --> 00:17:32,860
contemplate right the other scenario

350
00:17:32,860 --> 00:17:34,360
which i think is really interesting

351
00:17:34,360 --> 00:17:38,500
there is propagating viruses and i think

352
00:17:38,500 --> 00:17:39,909
this one really works even with a

353
00:17:39,909 --> 00:17:43,000
toothbrush what happens is that imaging

354
00:17:43,000 --> 00:17:45,490
that for a reason in another you got

355
00:17:45,490 --> 00:17:47,289
your toothbrush inspected you know I

356
00:17:47,289 --> 00:17:51,059
know that might happen right and then

357
00:17:51,059 --> 00:17:54,280
well you go to a conference such as VB

358
00:17:54,280 --> 00:17:56,230
and in the morning you brush your teeth

359
00:17:56,230 --> 00:17:58,419
right and while you're brushing your

360
00:17:58,419 --> 00:18:01,030
teeth well you are propagating the virus

361
00:18:01,030 --> 00:18:03,970
to all the other attendees around there

362
00:18:03,970 --> 00:18:05,740
or at least all the other people in the

363
00:18:05,740 --> 00:18:09,070
in the hotel and so this is something

364
00:18:09,070 --> 00:18:11,649
which is possible and might happen in

365
00:18:11,649 --> 00:18:14,440
the close or near future there

366
00:18:14,440 --> 00:18:16,750
especially if we have more and more

367
00:18:16,750 --> 00:18:19,509
connected devices right if the

368
00:18:19,509 --> 00:18:22,330
toothbrush is able to propagate a virus

369
00:18:22,330 --> 00:18:23,889
to other toothbrush but it might be are

370
00:18:23,889 --> 00:18:26,409
also able to connect and to propagate to

371
00:18:26,409 --> 00:18:29,649
the network and in fact the network or

372
00:18:29,649 --> 00:18:32,320
things like that so it's really the

373
00:18:32,320 --> 00:18:35,200
reason why I believe it's important to

374
00:18:35,200 --> 00:18:38,350
secure even harness I owe t the

375
00:18:38,350 --> 00:18:40,539
toothbrushes is harness but it can do

376
00:18:40,539 --> 00:18:43,330
some things bad if it's infected it's

377
00:18:43,330 --> 00:18:47,320
exactly what happens if you recall Brian

378
00:18:47,320 --> 00:18:50,049
Krebs web sites who has attacked I think

379
00:18:50,049 --> 00:18:55,240
a week ago by an IOT botnet which where

380
00:18:55,240 --> 00:18:57,250
there were CCTV cameras which were

381
00:18:57,250 --> 00:19:01,149
infected by a virus me right

382
00:19:01,149 --> 00:19:03,490
well the attackers didn't care at all

383
00:19:03,490 --> 00:19:06,399
about the CCTV cameras right they just

384
00:19:06,399 --> 00:19:08,110
wanted to trigger a denial-of-service

385
00:19:08,110 --> 00:19:10,750
attack so it's the same thing maybe in

386
00:19:10,750 --> 00:19:12,039
the future well they're not going to

387
00:19:12,039 --> 00:19:14,590
attack cameras but toothbrushes right

388
00:19:14,590 --> 00:19:16,600
everybody has a toothbrush in the future

389
00:19:16,600 --> 00:19:20,459
we might all have connected toothbrush

390
00:19:21,450 --> 00:19:26,440
so the Smart Watch and the Smart Watch

391
00:19:26,440 --> 00:19:29,769
is completely different very different

392
00:19:29,769 --> 00:19:32,980
architecture actually you have to

393
00:19:32,980 --> 00:19:35,289
consider this only like a kind of a

394
00:19:35,289 --> 00:19:37,690
display of remote display for the

395
00:19:37,690 --> 00:19:39,700
smartphone so when you are actually

396
00:19:39,700 --> 00:19:41,649
installing an application on the Smart

397
00:19:41,649 --> 00:19:43,389
Watch well you're not really installing

398
00:19:43,389 --> 00:19:45,100
it on the Smart Watch you are installing

399
00:19:45,100 --> 00:19:46,389
it on the smartphone

400
00:19:46,389 --> 00:19:48,610
well the processing is done on your

401
00:19:48,610 --> 00:19:50,769
smartphone and then when there's

402
00:19:50,769 --> 00:19:53,470
something to display on this well it

403
00:19:53,470 --> 00:19:55,750
sends a Bluetooth message with a

404
00:19:55,750 --> 00:19:58,120
proprietary protocol which is known as

405
00:19:58,120 --> 00:20:01,389
Constanza and it displays on the

406
00:20:01,389 --> 00:20:05,200
SmartWatch so I had a look again at the

407
00:20:05,200 --> 00:20:07,149
the Android application for the

408
00:20:07,149 --> 00:20:11,379
SmartWatch and we we see for instance a

409
00:20:11,379 --> 00:20:12,610
special

410
00:20:12,610 --> 00:20:14,440
Constanza message there are plenty of

411
00:20:14,440 --> 00:20:16,090
different sorts and this one is

412
00:20:16,090 --> 00:20:17,169
particularly interesting

413
00:20:17,169 --> 00:20:19,750
it's called request force crash you know

414
00:20:19,750 --> 00:20:23,860
that's really an triggers we really want

415
00:20:23,860 --> 00:20:25,950
to to have a look at that with that one

416
00:20:25,950 --> 00:20:27,160
it's

417
00:20:27,160 --> 00:20:29,800
kind of amusing because the type is at

418
00:20:29,800 --> 00:20:31,750
the number of the beast and the magic

419
00:20:31,750 --> 00:20:35,310
there is Constanza in some kind of elite

420
00:20:35,310 --> 00:20:40,350
writing and if we have a little bit more

421
00:20:40,350 --> 00:20:43,900
look at the classes there we see it as

422
00:20:43,900 --> 00:20:47,050
inheriting from a another class which is

423
00:20:47,050 --> 00:20:49,530
called Constanza message and that one

424
00:20:49,530 --> 00:20:52,330
although all the packets all the

425
00:20:52,330 --> 00:20:55,750
messages are packed by a native library

426
00:20:55,750 --> 00:20:59,730
which is Lib protocol that's a so and so

427
00:20:59,730 --> 00:21:02,860
the packets get a header and then the

428
00:21:02,860 --> 00:21:05,440
rest of the packet depends on which type

429
00:21:05,440 --> 00:21:07,180
of message you were exactly sending

430
00:21:07,180 --> 00:21:10,330
there so that that's interesting reverse

431
00:21:10,330 --> 00:21:12,160
engineering because of course it once

432
00:21:12,160 --> 00:21:14,200
again it would have been very difficult

433
00:21:14,200 --> 00:21:16,870
to get to this result with the five

434
00:21:16,870 --> 00:21:19,810
previous techniques I had talked about

435
00:21:19,810 --> 00:21:24,370
earlier I thought okay who's sending

436
00:21:24,370 --> 00:21:26,440
that request for his crash message mean

437
00:21:26,440 --> 00:21:28,830
it seems really extraordinarily strange

438
00:21:28,830 --> 00:21:31,960
so I searched in the code and I found

439
00:21:31,960 --> 00:21:34,150
out that it was a special activity named

440
00:21:34,150 --> 00:21:37,690
startup activity actually it's a hidden

441
00:21:37,690 --> 00:21:40,420
activity despite the name and it has

442
00:21:40,420 --> 00:21:42,550
plenty of debug features there you can

443
00:21:42,550 --> 00:21:46,360
do a factory reset download firmware

444
00:21:46,360 --> 00:21:49,540
over the airforce crash show logs those

445
00:21:49,540 --> 00:21:52,150
are logs there that you can see you even

446
00:21:52,150 --> 00:21:55,500
have a debug console over telnet right

447
00:21:55,500 --> 00:21:58,630
so you can have telnet for it for your

448
00:21:58,630 --> 00:22:01,870
smart March that's cool so I'll show you

449
00:22:01,870 --> 00:22:05,500
a small video showing all this live this

450
00:22:05,500 --> 00:22:08,620
is a I couldn't do it directly the demo

451
00:22:08,620 --> 00:22:10,120
here you wouldn't have seen anything on

452
00:22:10,120 --> 00:22:12,659
the Smart Watch

453
00:22:20,730 --> 00:22:25,340
there it is so I am connecting using ADB

454
00:22:25,340 --> 00:22:27,870
to the smart phone the smart phone which

455
00:22:27,870 --> 00:22:29,250
is paired with a smart watch of course

456
00:22:29,250 --> 00:22:33,930
and I am showing up that hidden activity

457
00:22:33,930 --> 00:22:35,760
you'll see at after sir I'm not a very

458
00:22:35,760 --> 00:22:42,240
good filmmaker I'm sorry and there on

459
00:22:42,240 --> 00:22:44,850
the right hand side you see the the

460
00:22:44,850 --> 00:22:46,200
hidden activity and the Smart Watch

461
00:22:46,200 --> 00:22:48,930
there and all the features on the hidden

462
00:22:48,930 --> 00:22:51,450
activity well they actually do work so I

463
00:22:51,450 --> 00:22:53,310
sent a force crash and what do we see

464
00:22:53,310 --> 00:22:55,020
well we see that the Smart Watch indeed

465
00:22:55,020 --> 00:22:57,830
is rebooting

466
00:23:08,480 --> 00:23:13,090
there it goes we can try some other

467
00:23:13,090 --> 00:23:16,160
other entries so you can show the logs

468
00:23:16,160 --> 00:23:22,780
so strange shot up that one we can also

469
00:23:22,780 --> 00:23:26,420
try and download a new firmware and yeah

470
00:23:26,420 --> 00:23:30,020
ok it's downloading the farmer and then

471
00:23:30,020 --> 00:23:31,850
after that I'll stop the video here but

472
00:23:31,850 --> 00:23:34,370
after that it's again reboots the

473
00:23:34,370 --> 00:23:38,120
SmartWatch and there you are with the

474
00:23:38,120 --> 00:23:40,370
new firmware which is loaded so again

475
00:23:40,370 --> 00:23:42,860
that was really useful without having to

476
00:23:42,860 --> 00:23:44,930
open the the SmartWatch to really

477
00:23:44,930 --> 00:23:47,420
understand more just reading the code

478
00:23:47,420 --> 00:23:50,690
well we can do some new kind of hacks on

479
00:23:50,690 --> 00:23:53,240
the SmartWatch which of which would have

480
00:23:53,240 --> 00:23:56,710
been quite difficult to to do otherwise

481
00:23:56,710 --> 00:24:03,050
the house alarm so well it's a house

482
00:24:03,050 --> 00:24:05,330
alarm it's meant to protect your friend

483
00:24:05,330 --> 00:24:08,200
to protect you sorry against burglars

484
00:24:08,200 --> 00:24:11,300
what's nice with that one and we'll ante

485
00:24:11,300 --> 00:24:12,950
of other house alarms is that it's

486
00:24:12,950 --> 00:24:15,590
controllable by SMS what's not very nice

487
00:24:15,590 --> 00:24:20,510
is that the SMS are very kind of touchy

488
00:24:20,510 --> 00:24:22,760
on the way the format you have to use to

489
00:24:22,760 --> 00:24:25,160
control remotely their alarm so

490
00:24:25,160 --> 00:24:27,280
basically you've got to send an SMS to

491
00:24:27,280 --> 00:24:29,990
the right phone number of the alarm and

492
00:24:29,990 --> 00:24:32,390
with the right passwords with a very

493
00:24:32,390 --> 00:24:34,910
strict format and if you don't comply to

494
00:24:34,910 --> 00:24:36,320
the right format well it's not working

495
00:24:36,320 --> 00:24:41,540
so the the vendors the vendor decided

496
00:24:41,540 --> 00:24:44,690
then that it would be a good idea to do

497
00:24:44,690 --> 00:24:46,400
an Android application for the house

498
00:24:46,400 --> 00:24:48,770
alarms so as to help the end users and

499
00:24:48,770 --> 00:24:52,100
not write you know wrong SMS the

500
00:24:52,100 --> 00:24:54,110
application when it pops up you

501
00:24:54,110 --> 00:24:56,870
configure its you say ok my phone number

502
00:24:56,870 --> 00:24:59,570
phone number of my alarm is this and the

503
00:24:59,570 --> 00:25:02,990
password is that now please send an SMS

504
00:25:02,990 --> 00:25:07,400
to set it on set it off or control this

505
00:25:07,400 --> 00:25:12,230
or that area that's cool what's not cool

506
00:25:12,230 --> 00:25:16,130
is that it's very insecure so for

507
00:25:16,130 --> 00:25:18,230
instance the the SMS that it is sending

508
00:25:18,230 --> 00:25:20,870
they get into the outbox of the smart of

509
00:25:20,870 --> 00:25:22,040
your smart

510
00:25:22,040 --> 00:25:24,560
smartphone and they don't erase it at

511
00:25:24,560 --> 00:25:27,650
all which means that if somebody grabs

512
00:25:27,650 --> 00:25:30,800
your smartphone or if a virus inspects

513
00:25:30,800 --> 00:25:33,560
the contents of your outbox well that

514
00:25:33,560 --> 00:25:36,980
the attacker gets everything he needs he

515
00:25:36,980 --> 00:25:38,690
has the phone number of the alarm and

516
00:25:38,690 --> 00:25:42,710
the password it's just exactly perfect

517
00:25:42,710 --> 00:25:44,720
you remotely control your your alarm

518
00:25:44,720 --> 00:25:49,570
that way so that that's poor even worse

519
00:25:49,570 --> 00:25:53,000
when you configure the application so

520
00:25:53,000 --> 00:25:54,740
you've got to say that what this is my

521
00:25:54,740 --> 00:25:56,540
phone number and this is my passwords

522
00:25:56,540 --> 00:25:58,340
well they thought okay we're gonna

523
00:25:58,340 --> 00:26:01,640
secure those credentials and I don't

524
00:26:01,640 --> 00:26:03,440
know really what they thought of but

525
00:26:03,440 --> 00:26:04,910
they probably thought you know we're

526
00:26:04,910 --> 00:26:06,710
very good at cryptography so we're gonna

527
00:26:06,710 --> 00:26:09,230
do our own because AES is not so we're

528
00:26:09,230 --> 00:26:11,240
gonna do our own and they did their own

529
00:26:11,240 --> 00:26:13,550
and of course it's extremely crappy and

530
00:26:13,550 --> 00:26:16,640
in like less than half a seconds while

531
00:26:16,640 --> 00:26:19,550
you break it and I don't have really

532
00:26:19,550 --> 00:26:21,170
much more than half a second to do the

533
00:26:21,170 --> 00:26:24,410
demo but I'll do it it's really so

534
00:26:24,410 --> 00:26:30,460
simple so let me go to the right

535
00:26:30,460 --> 00:26:33,460
directory

536
00:26:37,870 --> 00:26:41,890
can you read that hopefully it's not

537
00:26:41,890 --> 00:26:43,570
raise your hands well make it bigger

538
00:26:43,570 --> 00:26:49,720
yeah okay so that's the configuration

539
00:26:49,720 --> 00:26:55,410
file it's kind of encrypted right and

540
00:26:56,940 --> 00:26:58,480
there we go

541
00:26:58,480 --> 00:27:01,030
we decrypt it see it was very very

542
00:27:01,030 --> 00:27:03,130
difficult wasn't it and so you've got

543
00:27:03,130 --> 00:27:06,640
the phone number there and the password

544
00:27:06,640 --> 00:27:09,370
for the alarm you can you can try those

545
00:27:09,370 --> 00:27:11,440
if you want they're fake I don't I don't

546
00:27:11,440 --> 00:27:19,510
mind so there it is so with this

547
00:27:19,510 --> 00:27:21,910
application we have two security issues

548
00:27:21,910 --> 00:27:23,920
and by the way if you weren't using the

549
00:27:23,920 --> 00:27:25,000
Android application

550
00:27:25,000 --> 00:27:27,340
well you'd only have one security issue

551
00:27:27,340 --> 00:27:29,680
so actually the the Android application

552
00:27:29,680 --> 00:27:33,490
is introducing new security issues of

553
00:27:33,490 --> 00:27:36,430
course it's a vulnerability we notify

554
00:27:36,430 --> 00:27:39,610
its the vendor but we didn't get any

555
00:27:39,610 --> 00:27:44,650
answer and that's about all for my

556
00:27:44,650 --> 00:27:48,190
presentation if there is time for

557
00:27:48,190 --> 00:27:50,230
questions I'm ready and if you want to

558
00:27:50,230 --> 00:27:52,480
see the demo afterwards feel free to

559
00:27:52,480 --> 00:27:54,820
come to come again and see me I can do

560
00:27:54,820 --> 00:27:57,340
it as many times as you wish we do have

561
00:27:57,340 --> 00:28:02,050
a couple minutes for questions hi thank

562
00:28:02,050 --> 00:28:06,430
you so much very good again but as with

563
00:28:06,430 --> 00:28:08,520
the previous presentation were the

564
00:28:08,520 --> 00:28:11,260
manufacturers contacted and what were

565
00:28:11,260 --> 00:28:15,370
they replies yeah as I just said I did

566
00:28:15,370 --> 00:28:17,920
contact the vendors and did not get even

567
00:28:17,920 --> 00:28:21,970
and he acknowledged and the any answer

568
00:28:21,970 --> 00:28:25,570
whatsoever tried several emails just to

569
00:28:25,570 --> 00:28:27,400
make sure because in that case you never

570
00:28:27,400 --> 00:28:29,260
know if you're using the right email or

571
00:28:29,260 --> 00:28:31,420
the right way to contact them but they

572
00:28:31,420 --> 00:28:34,090
never answered and tried the supports

573
00:28:34,090 --> 00:28:36,370
for some other reasons they did answer

574
00:28:36,370 --> 00:28:37,750
but they never answered to the

575
00:28:37,750 --> 00:28:39,880
vulnerability report so I believe they

576
00:28:39,880 --> 00:28:43,200
did not want to answer

577
00:28:46,470 --> 00:28:50,440
so the same previous question did did

578
00:28:50,440 --> 00:28:51,850
any of the vendors that you contacted

579
00:28:51,850 --> 00:28:53,500
have any sort of responsible disclosure

580
00:28:53,500 --> 00:28:58,390
policy posted anywhere so mayyyyyo is

581
00:28:58,390 --> 00:29:01,330
the one where we had a vulnerability so

582
00:29:01,330 --> 00:29:03,070
it's the only one I needed to contact

583
00:29:03,070 --> 00:29:05,679
because the toothbrush it's not really a

584
00:29:05,679 --> 00:29:08,470
vulnerability it's just kind of using a

585
00:29:08,470 --> 00:29:12,429
feature of it and no they did not have

586
00:29:12,429 --> 00:29:15,610
as far as I have seen any policy about

587
00:29:15,610 --> 00:29:24,990
that any further questions Thanks

