1
00:00:01,280 --> 00:00:05,460
all made it this morning I'm Chester and

2
00:00:05,460 --> 00:00:06,870
I would like to welcome to the stage

3
00:00:06,870 --> 00:00:09,389
Kathy wing and Steve Brandt from Splunk

4
00:00:09,389 --> 00:00:10,469
they're going to be giving our first

5
00:00:10,469 --> 00:00:12,269
presentation this morning leveraging

6
00:00:12,269 --> 00:00:15,710
passive DNS for network defense

7
00:00:15,710 --> 00:00:20,539
all right so wow you guys are the

8
00:00:20,539 --> 00:00:22,859
industrious ones right you're here at

9
00:00:22,859 --> 00:00:26,910
9:00 the morning after last night really

10
00:00:26,910 --> 00:00:29,730
glad to see you I'm Kathy Wang and I'll

11
00:00:29,730 --> 00:00:31,800
be talking to you today along with my

12
00:00:31,800 --> 00:00:34,860
colleague Steve about the passive DNS

13
00:00:34,860 --> 00:00:39,809
analysis and tool so I woke ass flunk

14
00:00:39,809 --> 00:00:44,100
but as my past is I was a defense

15
00:00:44,100 --> 00:00:46,050
contractor for a number of years working

16
00:00:46,050 --> 00:00:48,570
different environments and I'm also a

17
00:00:48,570 --> 00:00:51,989
former see so in a tech company so I

18
00:00:51,989 --> 00:00:55,110
have a lot of malware detection and

19
00:00:55,110 --> 00:00:58,050
response experience and also working

20
00:00:58,050 --> 00:00:59,820
different security operations

21
00:00:59,820 --> 00:01:03,719
environments so this work came from my

22
00:01:03,719 --> 00:01:06,479
experiences in the past where I felt

23
00:01:06,479 --> 00:01:08,790
like I really could use a tool to do my

24
00:01:08,790 --> 00:01:11,460
job in Incident Response and threat

25
00:01:11,460 --> 00:01:14,130
Intel analysis and triaging

26
00:01:14,130 --> 00:01:16,350
a whole lot better so that's what I'm

27
00:01:16,350 --> 00:01:20,759
hoping to deliver to you guys today I'll

28
00:01:20,759 --> 00:01:24,540
also ask Steve to introduce himself hi

29
00:01:24,540 --> 00:01:28,080
Steve Brant I also work for Splunk been

30
00:01:28,080 --> 00:01:30,540
in the IT industry a little over 23

31
00:01:30,540 --> 00:01:32,970
years I guess it's kind of fortuitous

32
00:01:32,970 --> 00:01:35,970
Kathy was looking at DNS for this and a

33
00:01:35,970 --> 00:01:37,470
colleague of mine and myself did a

34
00:01:37,470 --> 00:01:39,840
little research and a talk last year and

35
00:01:39,840 --> 00:01:42,479
this specifically on DNS exfiltration so

36
00:01:42,479 --> 00:01:45,810
it was a perfect perfect match for for

37
00:01:45,810 --> 00:01:50,280
this ok so before I proceed can you guys

38
00:01:50,280 --> 00:01:53,610
all hear me okay all right

39
00:01:53,610 --> 00:01:56,670
people in the back yeah okay great thank

40
00:01:56,670 --> 00:01:59,850
you all right so what I'm hoping that

41
00:01:59,850 --> 00:02:02,840
you take away from the top today is

42
00:02:02,840 --> 00:02:05,070
understanding a better understanding of

43
00:02:05,070 --> 00:02:07,619
threat Intel triaging what the current

44
00:02:07,619 --> 00:02:10,560
problems are and also why is it

45
00:02:10,560 --> 00:02:11,340
important

46
00:02:11,340 --> 00:02:13,800
right so how many people here at

47
00:02:13,800 --> 00:02:16,850
we do threat Intel work in triaging

48
00:02:16,850 --> 00:02:20,730
okay a few of you great so for the rest

49
00:02:20,730 --> 00:02:22,320
of you I'd like you to totally

50
00:02:22,320 --> 00:02:24,480
understand why this is an important part

51
00:02:24,480 --> 00:02:26,910
of the Incident Response and forensics

52
00:02:26,910 --> 00:02:27,740
process

53
00:02:27,740 --> 00:02:30,330
okay so we'll talk about some of the

54
00:02:30,330 --> 00:02:32,970
gaps that are in threat Intel triaging

55
00:02:32,970 --> 00:02:37,950
today and also why we need internal

56
00:02:37,950 --> 00:02:40,680
passive DNS sensors how will that

57
00:02:40,680 --> 00:02:43,320
improve the visibility of your threat

58
00:02:43,320 --> 00:02:46,380
Intel triaging we'll talk about our

59
00:02:46,380 --> 00:02:49,380
solution and approach and then we you

60
00:02:49,380 --> 00:02:49,740
know

61
00:02:49,740 --> 00:02:52,530
kind of show you how the workflow can be

62
00:02:52,530 --> 00:02:57,300
easier for you with the tool so we've

63
00:02:57,300 --> 00:02:59,220
got a lot of material to cover in the

64
00:02:59,220 --> 00:03:03,420
last in the next 28 minutes or so so I

65
00:03:03,420 --> 00:03:05,250
would prefer if you leave the questions

66
00:03:05,250 --> 00:03:09,900
for the end thank you hi so in terms of

67
00:03:09,900 --> 00:03:13,440
threat Intel I've been doing this kind

68
00:03:13,440 --> 00:03:17,160
of work for a while and people want to

69
00:03:17,160 --> 00:03:20,070
share threat Intel data however they're

70
00:03:20,070 --> 00:03:22,350
still not able to do it very well today

71
00:03:22,350 --> 00:03:25,910
and that's mainly because there's not

72
00:03:25,910 --> 00:03:29,310
consistent formats for sharing that they

73
00:03:29,310 --> 00:03:32,780
can access easily and also automate

74
00:03:32,780 --> 00:03:35,160
automation is key to this whole thing

75
00:03:35,160 --> 00:03:38,070
because there's so much data coming into

76
00:03:38,070 --> 00:03:39,900
the network that you have to analyze

77
00:03:39,900 --> 00:03:43,260
that almost no one has adequate staffing

78
00:03:43,260 --> 00:03:47,130
to do it so you know we need a lot more

79
00:03:47,130 --> 00:03:50,160
tools to help make this happen in a more

80
00:03:50,160 --> 00:03:54,209
automated way and also people we all do

81
00:03:54,209 --> 00:03:57,140
a lot better when we have visual

82
00:03:57,140 --> 00:03:59,940
capabilities that allow us to see at a

83
00:03:59,940 --> 00:04:03,570
quick glance what the situation is right

84
00:04:03,570 --> 00:04:05,850
I mean it's better to do that than to

85
00:04:05,850 --> 00:04:09,300
get a whole list of a table of things to

86
00:04:09,300 --> 00:04:10,260
read through

87
00:04:10,260 --> 00:04:12,959
that's just how we work we do a lot

88
00:04:12,959 --> 00:04:14,400
better when there's good visual

89
00:04:14,400 --> 00:04:19,529
representation of the situation so why

90
00:04:19,529 --> 00:04:21,899
is sweating so important I mean you guys

91
00:04:21,899 --> 00:04:24,060
are all here right you should know this

92
00:04:24,060 --> 00:04:27,389
that we want to target now

93
00:04:27,389 --> 00:04:31,020
isn't a single industry sector that

94
00:04:31,020 --> 00:04:34,310
hasn't been targeted by attacks

95
00:04:34,310 --> 00:04:37,319
sophisticated attacks as well so it

96
00:04:37,319 --> 00:04:38,669
doesn't matter what you're looking at

97
00:04:38,669 --> 00:04:40,650
whether it's health care financial

98
00:04:40,650 --> 00:04:43,560
sector or you know government or

99
00:04:43,560 --> 00:04:44,250
whatever

100
00:04:44,250 --> 00:04:46,889
everyone's highly targeted so it's very

101
00:04:46,889 --> 00:04:49,560
important to continue to do the

102
00:04:49,560 --> 00:04:52,379
threading teleTracking work and also to

103
00:04:52,379 --> 00:04:56,639
automate it and make it better so we all

104
00:04:56,639 --> 00:04:58,849
know external attacks are increasing

105
00:04:58,849 --> 00:05:02,669
right so you know we have your insider

106
00:05:02,669 --> 00:05:05,340
threat issues that go on sure but then

107
00:05:05,340 --> 00:05:07,680
the bulk of the attacks are going to be

108
00:05:07,680 --> 00:05:12,210
from external to the network and on the

109
00:05:12,210 --> 00:05:14,430
other side of it nation-state attacks

110
00:05:14,430 --> 00:05:16,770
are also increasing right they're

111
00:05:16,770 --> 00:05:19,349
certainly not going away and they're

112
00:05:19,349 --> 00:05:20,729
just getting more and more sophisticated

113
00:05:20,729 --> 00:05:24,090
and more difficult to detect and respond

114
00:05:24,090 --> 00:05:28,199
to and also remediate so all of those

115
00:05:28,199 --> 00:05:31,020
factors together make it very very

116
00:05:31,020 --> 00:05:33,539
important that we do good threat Intel

117
00:05:33,539 --> 00:05:35,909
triaging and sharing of that information

118
00:05:35,909 --> 00:05:39,599
with peers in the industry sectors so

119
00:05:39,599 --> 00:05:42,000
that we can more effectively fight

120
00:05:42,000 --> 00:05:48,599
against this type of attack so looking

121
00:05:48,599 --> 00:05:51,680
at this diagram you can see that most

122
00:05:51,680 --> 00:05:54,810
organizations the tech breaches in their

123
00:05:54,810 --> 00:05:58,860
network months after the breach not days

124
00:05:58,860 --> 00:06:02,460
not hours right not even weeks but

125
00:06:02,460 --> 00:06:05,610
months so what does that say about the

126
00:06:05,610 --> 00:06:08,159
current state of how people are able to

127
00:06:08,159 --> 00:06:12,150
automate workflows it's not very good

128
00:06:12,150 --> 00:06:14,659
right it's not a great picture so

129
00:06:14,659 --> 00:06:17,939
everyone wants to share information and

130
00:06:17,939 --> 00:06:21,180
do better at detecting these breaches

131
00:06:21,180 --> 00:06:24,150
and shorten that amount of time that the

132
00:06:24,150 --> 00:06:26,520
attack actually has a chance to do

133
00:06:26,520 --> 00:06:28,949
further damage in the network and spread

134
00:06:28,949 --> 00:06:32,069
further however how do we do that

135
00:06:32,069 --> 00:06:37,440
right so that kind of segues well into

136
00:06:37,440 --> 00:06:40,289
the workflow for threatened health right

137
00:06:40,289 --> 00:06:41,070
now

138
00:06:41,070 --> 00:06:44,220
so we have the ability to discover

139
00:06:44,220 --> 00:06:47,910
threats right visualize and model the

140
00:06:47,910 --> 00:06:50,700
threats and also translate them in some

141
00:06:50,700 --> 00:06:54,090
sort of shareable format and then we

142
00:06:54,090 --> 00:06:57,720
extract the IOC s right from that and

143
00:06:57,720 --> 00:07:00,350
then we share all of that information

144
00:07:00,350 --> 00:07:03,330
with our peers and then we do something

145
00:07:03,330 --> 00:07:06,870
to try to proactively or remediate the

146
00:07:06,870 --> 00:07:10,980
issue well if you look at how well

147
00:07:10,980 --> 00:07:14,750
automated this entire workflow processes

148
00:07:14,750 --> 00:07:19,020
you see that some of these pieces can be

149
00:07:19,020 --> 00:07:21,060
automated and some of these pieces

150
00:07:21,060 --> 00:07:23,960
cannot be automated so for example

151
00:07:23,960 --> 00:07:27,210
visualize or model the threat that is

152
00:07:27,210 --> 00:07:30,420
extremely hard amount automated so you

153
00:07:30,420 --> 00:07:32,820
have these threat Intel analysts that do

154
00:07:32,820 --> 00:07:34,650
a lot of work around this and this is

155
00:07:34,650 --> 00:07:36,030
what they spend the bulk of their time

156
00:07:36,030 --> 00:07:41,340
on but there are other pieces in this

157
00:07:41,340 --> 00:07:44,340
workflow such as translating the models

158
00:07:44,340 --> 00:07:46,830
into shareable format in an automated

159
00:07:46,830 --> 00:07:50,190
way that there's currently not a good

160
00:07:50,190 --> 00:07:54,390
set of tools to do that ok so this is

161
00:07:54,390 --> 00:07:59,870
where the gap really is in my experience

162
00:07:59,870 --> 00:08:03,330
so what are we going to really cover

163
00:08:03,330 --> 00:08:06,270
today in the top so now you have a

164
00:08:06,270 --> 00:08:08,160
better understanding of threat Intel

165
00:08:08,160 --> 00:08:10,170
triaging how that works what the

166
00:08:10,170 --> 00:08:12,690
workflow looks like one needs more work

167
00:08:12,690 --> 00:08:15,570
what the gaps are so today we're going

168
00:08:15,570 --> 00:08:18,210
to talk about how to obtain better

169
00:08:18,210 --> 00:08:21,360
visibility of the malicious domains that

170
00:08:21,360 --> 00:08:25,350
have access your network ok so what

171
00:08:25,350 --> 00:08:27,210
we're not going to do today is talk

172
00:08:27,210 --> 00:08:31,640
about visualization sharing automation

173
00:08:31,640 --> 00:08:35,520
you know so this is an area that I feel

174
00:08:35,520 --> 00:08:38,250
like visibility getting more of that is

175
00:08:38,250 --> 00:08:40,890
very important because ultimately it's

176
00:08:40,890 --> 00:08:43,289
going to help you put together a much

177
00:08:43,289 --> 00:08:45,630
better picture of what happened in your

178
00:08:45,630 --> 00:08:47,970
environment and also share that

179
00:08:47,970 --> 00:08:51,470
information with your peers

180
00:08:51,620 --> 00:08:55,110
so what do we need to increase

181
00:08:55,110 --> 00:09:00,089
visibility right now when you we all

182
00:09:00,089 --> 00:09:02,459
know that when we get attacked with

183
00:09:02,459 --> 00:09:07,670
Melissa malicious domain in our network

184
00:09:07,670 --> 00:09:10,760
some of our endpoints will reach out and

185
00:09:10,760 --> 00:09:13,769
communicate with situ servers right

186
00:09:13,769 --> 00:09:17,010
these are malicious servers and these

187
00:09:17,010 --> 00:09:20,100
servers are ephemeral right these

188
00:09:20,100 --> 00:09:25,709
domains go away very very quickly how do

189
00:09:25,709 --> 00:09:29,490
we capture that information right now a

190
00:09:29,490 --> 00:09:32,519
lot of our threat Intel analysts have

191
00:09:32,519 --> 00:09:35,279
access to services like Farsight or

192
00:09:35,279 --> 00:09:37,829
passive total they have set up public

193
00:09:37,829 --> 00:09:41,880
dns sensors throughout the internet

194
00:09:41,880 --> 00:09:45,329
right and by accessing that service they

195
00:09:45,329 --> 00:09:47,550
can do a search for a particular

196
00:09:47,550 --> 00:09:50,610
malicious domain in their database to

197
00:09:50,610 --> 00:09:53,279
see if it comes up and figure out what

198
00:09:53,279 --> 00:09:56,459
to do next with that get the information

199
00:09:56,459 --> 00:09:59,160
about where else that domain has also

200
00:09:59,160 --> 00:10:01,680
attacked for example and I'm going to

201
00:10:01,680 --> 00:10:03,959
show you since you all many of us are

202
00:10:03,959 --> 00:10:07,170
visual learners I'm going to show you a

203
00:10:07,170 --> 00:10:10,470
diagram shortly on how this works so

204
00:10:10,470 --> 00:10:12,449
what we're looking for is more

205
00:10:12,449 --> 00:10:15,149
visibility inside our own network and

206
00:10:15,149 --> 00:10:17,220
I'll show you this would be clear in a

207
00:10:17,220 --> 00:10:19,829
minute why that's important but that's

208
00:10:19,829 --> 00:10:21,240
what we're missing right now that

209
00:10:21,240 --> 00:10:26,579
visibility inside all our network it's

210
00:10:26,579 --> 00:10:29,250
very difficult for a threat Intel

211
00:10:29,250 --> 00:10:32,730
analyst with limited information about

212
00:10:32,730 --> 00:10:35,269
the malicious domains that have been

213
00:10:35,269 --> 00:10:38,010
accessed by the endpoints inside the

214
00:10:38,010 --> 00:10:40,199
role network to put together a

215
00:10:40,199 --> 00:10:43,199
comprehensive picture of how the attack

216
00:10:43,199 --> 00:10:47,180
was staged and how it worked right so

217
00:10:47,180 --> 00:10:49,860
part of the reason why they need to do

218
00:10:49,860 --> 00:10:52,110
that is because of ultimately trying to

219
00:10:52,110 --> 00:10:55,260
better understand the tactics and

220
00:10:55,260 --> 00:10:58,050
procedures the TTP's that are used by

221
00:10:58,050 --> 00:11:01,290
the attacker in actually attacking their

222
00:11:01,290 --> 00:11:04,140
network and trying to attribute perhaps

223
00:11:04,140 --> 00:11:07,649
who the attacker may be and also at the

224
00:11:07,649 --> 00:11:10,560
same time share that data with their

225
00:11:10,560 --> 00:11:14,220
peers but they do laughs visibility

226
00:11:14,220 --> 00:11:16,230
total visibility they have partial

227
00:11:16,230 --> 00:11:20,160
visibility so if we can build like a

228
00:11:20,160 --> 00:11:24,209
lightweight local passive DNS sensor on

229
00:11:24,209 --> 00:11:27,260
our own network we're going to gain

230
00:11:27,260 --> 00:11:30,990
additional visibility in addition to the

231
00:11:30,990 --> 00:11:34,260
Public DNS sensor information that we

232
00:11:34,260 --> 00:11:36,839
never really had before and I'll show

233
00:11:36,839 --> 00:11:42,180
you we'll show you how we did that all

234
00:11:42,180 --> 00:11:45,689
right so here is a diagram right let's

235
00:11:45,689 --> 00:11:48,329
say that our organization is

236
00:11:48,329 --> 00:11:51,390
organization one in the lower right hand

237
00:11:51,390 --> 00:11:56,250
corner we have had several endpoints in

238
00:11:56,250 --> 00:11:58,740
our organization which I've denoted by

239
00:11:58,740 --> 00:12:03,510
the white circle inside attacked by the

240
00:12:03,510 --> 00:12:08,069
attacker infrastructures nodes okay so a

241
00:12:08,069 --> 00:12:09,959
couple of nodes in the attacker

242
00:12:09,959 --> 00:12:13,319
infrastructure attack endpoints in our

243
00:12:13,319 --> 00:12:18,029
organization one network when we go and

244
00:12:18,029 --> 00:12:22,980
look at the Public DNS sensor database

245
00:12:22,980 --> 00:12:26,010
for that information about the malicious

246
00:12:26,010 --> 00:12:30,240
domain we'll see okay there was

247
00:12:30,240 --> 00:12:34,019
information that it can show us about

248
00:12:34,019 --> 00:12:36,630
one of the endpoints in our organization

249
00:12:36,630 --> 00:12:38,550
but there were a couple of other

250
00:12:38,550 --> 00:12:41,130
endpoints in our organization that also

251
00:12:41,130 --> 00:12:43,949
were attacked by the same infrastructure

252
00:12:43,949 --> 00:12:47,010
however because the sensor the public

253
00:12:47,010 --> 00:12:50,100
sensor wasn't in those network segments

254
00:12:50,100 --> 00:12:54,990
we didn't get that picture right but if

255
00:12:54,990 --> 00:12:58,290
we have P DNS which is the local passive

256
00:12:58,290 --> 00:13:02,069
DNS sensor in our own network we see all

257
00:13:02,069 --> 00:13:05,160
of those different attacks against our

258
00:13:05,160 --> 00:13:10,199
endpoints I've had people ask me is this

259
00:13:10,199 --> 00:13:13,439
meant to replace public dns sensors and

260
00:13:13,439 --> 00:13:16,740
the answer to that is no because

261
00:13:16,740 --> 00:13:19,589
you get additional visibility additional

262
00:13:19,589 --> 00:13:21,420
information but you really still need

263
00:13:21,420 --> 00:13:24,600
that public sensor database access so

264
00:13:24,600 --> 00:13:28,170
you can see that organization - in the

265
00:13:28,170 --> 00:13:30,990
upper right which is appear in our

266
00:13:30,990 --> 00:13:34,050
industry sector also got attacked by the

267
00:13:34,050 --> 00:13:38,370
same infrastructure so now as an analyst

268
00:13:38,370 --> 00:13:40,860
you're putting together a table with all

269
00:13:40,860 --> 00:13:43,410
of this information right and that's

270
00:13:43,410 --> 00:13:45,870
what you're going to use to triage and

271
00:13:45,870 --> 00:13:50,819
further to the threat Intel hi so what

272
00:13:50,819 --> 00:13:53,430
is an analyst building I mean if you're

273
00:13:53,430 --> 00:13:55,199
a threat Intel analyst and you're

274
00:13:55,199 --> 00:13:57,060
triaging and you're trying to attribute

275
00:13:57,060 --> 00:13:59,819
attacks and trying to build a picture of

276
00:13:59,819 --> 00:14:01,649
how the attack took place in your

277
00:14:01,649 --> 00:14:02,480
infrastructure

278
00:14:02,480 --> 00:14:04,500
hopefully you're building something like

279
00:14:04,500 --> 00:14:07,980
this where you have okay and the public

280
00:14:07,980 --> 00:14:12,540
passive DNS sensor side on your left

281
00:14:12,540 --> 00:14:16,139
side you see the domains that actually

282
00:14:16,139 --> 00:14:19,500
you know the attack came from and you

283
00:14:19,500 --> 00:14:21,689
see the IP addresses of what they are

284
00:14:21,689 --> 00:14:26,399
now on the local private DNS sensor

285
00:14:26,399 --> 00:14:29,389
passive DNS center side on your right

286
00:14:29,389 --> 00:14:32,610
you see your information specific to

287
00:14:32,610 --> 00:14:35,009
your network so you're putting together

288
00:14:35,009 --> 00:14:37,410
all this information and that's going to

289
00:14:37,410 --> 00:14:40,350
help you build that visual graph of how

290
00:14:40,350 --> 00:14:45,899
the attack propagated now what I'm going

291
00:14:45,899 --> 00:14:48,600
to do Maps is take that same diagram and

292
00:14:48,600 --> 00:14:51,480
label it with these domains that you see

293
00:14:51,480 --> 00:14:54,180
here right to give you a better idea of

294
00:14:54,180 --> 00:14:59,250
what that looks like visually so you

295
00:14:59,250 --> 00:15:01,860
know so far we talked about why this is

296
00:15:01,860 --> 00:15:04,620
important to have an internal sensor it

297
00:15:04,620 --> 00:15:06,439
gives you that additional visibility

298
00:15:06,439 --> 00:15:09,470
what I'm also going to show you is that

299
00:15:09,470 --> 00:15:17,129
Oh Don hi so when when an endpoint host

300
00:15:17,129 --> 00:15:20,819
gets compromised by an attack I'll give

301
00:15:20,819 --> 00:15:23,519
you one example here where Public DNS

302
00:15:23,519 --> 00:15:28,100
sensors and private internal passive DNS

303
00:15:28,100 --> 00:15:29,810
can work together to give you a better

304
00:15:29,810 --> 00:15:34,220
picture of the attack the endpoint hosts

305
00:15:34,220 --> 00:15:38,529
one and visited a website like CNN and

306
00:15:38,529 --> 00:15:42,050
in doing so there were a couple of ads

307
00:15:42,050 --> 00:15:45,470
that rendered on the website one of the

308
00:15:45,470 --> 00:15:48,019
ads had malicious content embedded in it

309
00:15:48,019 --> 00:15:50,709
so it's kind of a more of a drive-by

310
00:15:50,709 --> 00:15:54,170
situation where the malware compromised

311
00:15:54,170 --> 00:15:57,680
the endpoint host fun that at that point

312
00:15:57,680 --> 00:16:01,220
right there's payloads that are sent

313
00:16:01,220 --> 00:16:03,649
over to the endpoint host and those

314
00:16:03,649 --> 00:16:06,880
communications with the exploit server

315
00:16:06,880 --> 00:16:10,190
but it's a multi-stage attack it's not a

316
00:16:10,190 --> 00:16:12,980
very simple attack by it's multistage so

317
00:16:12,980 --> 00:16:15,130
at that point eventually there's

318
00:16:15,130 --> 00:16:18,709
activity to persist on that endpoint

319
00:16:18,709 --> 00:16:22,399
host and those also callback activity

320
00:16:22,399 --> 00:16:26,240
that occurs through a c2 server from a

321
00:16:26,240 --> 00:16:29,839
public passive DNS sensors standpoint

322
00:16:29,839 --> 00:16:33,889
you see all the checkmarks the green

323
00:16:33,889 --> 00:16:36,350
checkmarks that's what that was see and

324
00:16:36,350 --> 00:16:38,000
that's what they would have in new

325
00:16:38,000 --> 00:16:42,319
database however the staging for the

326
00:16:42,319 --> 00:16:45,350
attacks the latter stages would not be

327
00:16:45,350 --> 00:16:47,480
seen by that publicly on our sensor

328
00:16:47,480 --> 00:16:50,509
because it is originated from your own

329
00:16:50,509 --> 00:16:54,949
endpoint sensor host so having your own

330
00:16:54,949 --> 00:16:58,550
internal passive DNS sensor would allow

331
00:16:58,550 --> 00:17:02,569
you to see all of that activity so think

332
00:17:02,569 --> 00:17:06,140
of it as complementary to public passive

333
00:17:06,140 --> 00:17:09,020
DNS sensors I hope this makes it a lot

334
00:17:09,020 --> 00:17:11,449
more clear on why it's important to have

335
00:17:11,449 --> 00:17:17,119
your own internal sensor so in building

336
00:17:17,119 --> 00:17:20,750
this tool we thought about you know

337
00:17:20,750 --> 00:17:23,900
obviously requirements and looking at

338
00:17:23,900 --> 00:17:25,400
those requirements and thinking about

339
00:17:25,400 --> 00:17:27,500
what do we need to do to make this

340
00:17:27,500 --> 00:17:31,429
usable but not heavyweight right so I

341
00:17:31,429 --> 00:17:34,130
mean if you wanted heavyweight you could

342
00:17:34,130 --> 00:17:37,370
access your full packet capture solution

343
00:17:37,370 --> 00:17:40,800
and you could look up the timestamps

344
00:17:40,800 --> 00:17:42,810
digging to the packet capture you could

345
00:17:42,810 --> 00:17:45,600
look for the content but that's kind of

346
00:17:45,600 --> 00:17:47,580
overkill for what we're trying to do

347
00:17:47,580 --> 00:17:49,980
here which is quickly triaging the

348
00:17:49,980 --> 00:17:53,670
activities that occurred and so what we

349
00:17:53,670 --> 00:17:56,580
want is a more lightweight sensor that

350
00:17:56,580 --> 00:17:59,430
we can access quickly that would allow

351
00:17:59,430 --> 00:18:02,310
us to quickly drill down through the

352
00:18:02,310 --> 00:18:04,920
activity and the DNS queries made by the

353
00:18:04,920 --> 00:18:08,010
endpoint and figure out how we're going

354
00:18:08,010 --> 00:18:10,800
to triage this very quickly right so we

355
00:18:10,800 --> 00:18:12,330
need some sort of a middle ground

356
00:18:12,330 --> 00:18:16,590
between a Public DNS sensor and some

357
00:18:16,590 --> 00:18:19,680
sort of heavyweight full packet capture

358
00:18:19,680 --> 00:18:25,890
solution so we came up with this and now

359
00:18:25,890 --> 00:18:29,030
Steve is going to talk about the tool so

360
00:18:29,030 --> 00:18:31,440
as Kathy mentioned we wanted to put

361
00:18:31,440 --> 00:18:33,510
together a little up you know a tool to

362
00:18:33,510 --> 00:18:36,090
sort of aggregate all the DNS data and

363
00:18:36,090 --> 00:18:37,800
be able to sort of quickly determine if

364
00:18:37,800 --> 00:18:39,720
there's something nefarious with the

365
00:18:39,720 --> 00:18:42,690
system or also to be able to drill down

366
00:18:42,690 --> 00:18:44,160
to see what the histories been on a

367
00:18:44,160 --> 00:18:47,550
particular DNS resolution or in

368
00:18:47,550 --> 00:18:53,940
particular DNS traffic so we decided to

369
00:18:53,940 --> 00:18:55,770
do this on Splunk seemed like the right

370
00:18:55,770 --> 00:18:57,300
thing to do since we work there and have

371
00:18:57,300 --> 00:19:03,390
all the tools at our disposal so given

372
00:19:03,390 --> 00:19:05,640
my experience before with with looking

373
00:19:05,640 --> 00:19:08,640
at exfiltration with through DNS and

374
00:19:08,640 --> 00:19:12,630
with Kathy's with Kathy's experience we

375
00:19:12,630 --> 00:19:15,270
put together a right now it's a

376
00:19:15,270 --> 00:19:16,860
relatively simple app to aggregate all

377
00:19:16,860 --> 00:19:24,000
this so we see you know basically the

378
00:19:24,000 --> 00:19:25,890
the volume of traffic going across the

379
00:19:25,890 --> 00:19:27,720
number of clients making requests to a

380
00:19:27,720 --> 00:19:31,280
particular to a particular DNS site and

381
00:19:31,280 --> 00:19:34,500
what we use to gather this data is a

382
00:19:34,500 --> 00:19:37,470
tool from Splunk called stream Splunk

383
00:19:37,470 --> 00:19:39,300
made an acquisition several years ago of

384
00:19:39,300 --> 00:19:43,350
a company that does network data

385
00:19:43,350 --> 00:19:46,170
gathering and rather than full packet

386
00:19:46,170 --> 00:19:49,080
capture what this does is it actually

387
00:19:49,080 --> 00:19:51,420
just pulls in the metadata for a number

388
00:19:51,420 --> 00:19:53,820
of different protocols DNS being one of

389
00:19:53,820 --> 00:19:54,559
the big

390
00:19:54,559 --> 00:19:57,710
and so we've got you know dates queries

391
00:19:57,710 --> 00:19:59,299
were made we've got the answers to the

392
00:19:59,299 --> 00:20:02,029
queries with queries themselves quite a

393
00:20:02,029 --> 00:20:06,230
bit of data in there again it's just the

394
00:20:06,230 --> 00:20:08,960
metadata so not not huge volumes of data

395
00:20:08,960 --> 00:20:11,029
that you would typically see for a full

396
00:20:11,029 --> 00:20:14,119
packet capture solution now we use

397
00:20:14,119 --> 00:20:16,580
stream just for testing but the way the

398
00:20:16,580 --> 00:20:18,590
app is written there's actually a fair

399
00:20:18,590 --> 00:20:20,029
amount of work on the back end for

400
00:20:20,029 --> 00:20:22,369
normalizing different different types of

401
00:20:22,369 --> 00:20:24,609
data so you could use anything from

402
00:20:24,609 --> 00:20:28,609
stream to Bro if you're you know if you

403
00:20:28,609 --> 00:20:31,009
use bro you can use gigamon so there's

404
00:20:31,009 --> 00:20:32,509
commercial solutions that will feed into

405
00:20:32,509 --> 00:20:34,249
this as well you could even use TCP dump

406
00:20:34,249 --> 00:20:35,869
if you wanted to they wanted to parse

407
00:20:35,869 --> 00:20:41,570
out that data to put in there again I

408
00:20:41,570 --> 00:20:43,249
just talked about the inputs but yeah

409
00:20:43,249 --> 00:20:45,019
there's there's multiple multiple paths

410
00:20:45,019 --> 00:20:48,859
you can take here outputs so this is the

411
00:20:48,859 --> 00:20:50,359
we're going to talk a little bit about

412
00:20:50,359 --> 00:20:54,200
the the front end of the app here these

413
00:20:54,200 --> 00:20:56,330
are the initial ideas that we came up

414
00:20:56,330 --> 00:20:59,299
with for aggregating the data this is

415
00:20:59,299 --> 00:21:02,509
just sort of the mock-ups so looking at

416
00:21:02,509 --> 00:21:04,820
dates that transactions took place and

417
00:21:04,820 --> 00:21:06,830
we've also got a look up in there so you

418
00:21:06,830 --> 00:21:09,159
can quickly see if any malicious domains

419
00:21:09,159 --> 00:21:14,330
you know have been accessed in addition

420
00:21:14,330 --> 00:21:16,309
to that we're showing you know aggregate

421
00:21:16,309 --> 00:21:19,700
the counts of unique IPS that are coming

422
00:21:19,700 --> 00:21:21,950
from the destination all you know all

423
00:21:21,950 --> 00:21:25,039
indicators that potentially indicators

424
00:21:25,039 --> 00:21:28,179
that there might be something going on

425
00:21:28,690 --> 00:21:31,940
there's drill down at each level so we

426
00:21:31,940 --> 00:21:35,690
can actually select an aggregated list

427
00:21:35,690 --> 00:21:37,850
and eventually drill down to each

428
00:21:37,850 --> 00:21:39,799
individual query that took place over a

429
00:21:39,799 --> 00:21:44,299
given time period and of course all

430
00:21:44,299 --> 00:21:46,730
throughout you see the you know any

431
00:21:46,730 --> 00:21:48,859
blacklisted domains you eventually get

432
00:21:48,859 --> 00:21:50,690
down to the actual raw data that came in

433
00:21:50,690 --> 00:21:55,070
you know via the sensor so these are the

434
00:21:55,070 --> 00:21:57,109
actual some screenshots of the actual

435
00:21:57,109 --> 00:22:01,519
app itself as it is now you can see that

436
00:22:01,519 --> 00:22:03,470
you've got number of queries at the top

437
00:22:03,470 --> 00:22:05,190
the number of distinct answer

438
00:22:05,190 --> 00:22:09,660
years potentially all indicators so in

439
00:22:09,660 --> 00:22:13,140
doing the testing with exfiltration you

440
00:22:13,140 --> 00:22:14,820
definitely see you know anything that's

441
00:22:14,820 --> 00:22:17,160
going out is based 32 as part of a

442
00:22:17,160 --> 00:22:18,810
domain name they're not the domain name

443
00:22:18,810 --> 00:22:22,350
but the host name tends to you know not

444
00:22:22,350 --> 00:22:26,040
Chuck these not the distinct answers but

445
00:22:26,040 --> 00:22:28,980
the actual number of queries the unique

446
00:22:28,980 --> 00:22:31,110
subdomains or host names that are coming

447
00:22:31,110 --> 00:22:36,660
up also got a visual diagram here of the

448
00:22:36,660 --> 00:22:38,670
different query types so whether they're

449
00:22:38,670 --> 00:22:42,540
a records or txt records for DNS you can

450
00:22:42,540 --> 00:22:43,950
see sort of a timeline here pretty

451
00:22:43,950 --> 00:22:47,580
quickly and drill down on that and then

452
00:22:47,580 --> 00:22:49,500
you know upon drill down like I said

453
00:22:49,500 --> 00:22:51,000
there's a you have the aggregated list

454
00:22:51,000 --> 00:22:53,340
that you start out with and then as you

455
00:22:53,340 --> 00:22:56,610
sort of click through these you drill

456
00:22:56,610 --> 00:22:58,080
down to the more detailed information

457
00:22:58,080 --> 00:23:00,480
around the clients the number of answers

458
00:23:00,480 --> 00:23:02,550
that were that were sent back for the

459
00:23:02,550 --> 00:23:06,780
query and ultimately you get down this

460
00:23:06,780 --> 00:23:09,300
this lower right hand corner shows each

461
00:23:09,300 --> 00:23:11,610
individual query that went out and by

462
00:23:11,610 --> 00:23:13,740
drilling down on that you like I said

463
00:23:13,740 --> 00:23:14,970
before you get the review at the raw

464
00:23:14,970 --> 00:23:19,860
data so future features we're actually

465
00:23:19,860 --> 00:23:21,780
working on version 2 now version 1 is

466
00:23:21,780 --> 00:23:23,250
fairly Spartan like I said a lot of it

467
00:23:23,250 --> 00:23:26,460
was you know work on the back end to

468
00:23:26,460 --> 00:23:27,720
make it compatible with different

469
00:23:27,720 --> 00:23:31,080
sources we talked to several vendors

470
00:23:31,080 --> 00:23:34,680
that want a public DNS or public passive

471
00:23:34,680 --> 00:23:37,190
DNS vendors that want to integrate and

472
00:23:37,190 --> 00:23:40,110
we're also talking about you know some

473
00:23:40,110 --> 00:23:41,850
different visualizations on the app just

474
00:23:41,850 --> 00:23:45,720
more high level indicators that are easy

475
00:23:45,720 --> 00:23:50,430
to track down with the eye and that's

476
00:23:50,430 --> 00:23:54,180
about it this is all free app encourage

477
00:23:54,180 --> 00:23:56,310
you to download it and try it out our

478
00:23:56,310 --> 00:23:58,530
reward is your your good feedback in use

479
00:23:58,530 --> 00:24:02,790
and this is where you can actually

480
00:24:02,790 --> 00:24:06,260
download the app from Splunk base is a

481
00:24:06,260 --> 00:24:09,210
community site for Splunk where people

482
00:24:09,210 --> 00:24:12,030
can upload apps again it's free

483
00:24:12,030 --> 00:24:14,850
you can download it for free as well and

484
00:24:14,850 --> 00:24:16,440
run it down there there's no restriction

485
00:24:16,440 --> 00:24:17,190
and

486
00:24:17,190 --> 00:24:19,590
stream is free as well so I you know I

487
00:24:19,590 --> 00:24:21,210
got started on this just just trying it

488
00:24:21,210 --> 00:24:22,980
out at home it's a perfectly good

489
00:24:22,980 --> 00:24:27,150
perfectly valid way to to do that and

490
00:24:27,150 --> 00:24:30,210
that's that is about it a time for

491
00:24:30,210 --> 00:24:33,780
question question yeah we have time for

492
00:24:33,780 --> 00:24:36,360
questions anybody looking around here

493
00:24:36,360 --> 00:24:41,490
see if anybody has any questions not

494
00:24:41,490 --> 00:24:45,150
seeing any hello I have questions I'm

495
00:24:45,150 --> 00:24:47,220
curious you know looking at the the data

496
00:24:47,220 --> 00:24:49,620
that you gather with the tool I was

497
00:24:49,620 --> 00:24:52,260
actually so at DEFCON Paul vixie was

498
00:24:52,260 --> 00:24:54,090
giving it scheduled to give a

499
00:24:54,090 --> 00:24:57,050
presentation looking at some interesting

500
00:24:57,050 --> 00:24:59,660
sets of DNS queries that he was seeing

501
00:24:59,660 --> 00:25:02,310
using the data that his organization was

502
00:25:02,310 --> 00:25:04,730
collecting and what was kind of

503
00:25:04,730 --> 00:25:07,440
interesting to me was sort of trying to

504
00:25:07,440 --> 00:25:10,050
figure out you know how to identify the

505
00:25:10,050 --> 00:25:12,570
interesting DNS queries as part of this

506
00:25:12,570 --> 00:25:14,460
tool right when you look at a set of n

507
00:25:14,460 --> 00:25:18,150
points at a customer or a an

508
00:25:18,150 --> 00:25:20,490
organization you've got typically a

509
00:25:20,490 --> 00:25:22,710
really long tail of small numbers of

510
00:25:22,710 --> 00:25:25,020
lookups but those are where you're most

511
00:25:25,020 --> 00:25:27,900
likely to find say C - you know queries

512
00:25:27,900 --> 00:25:29,670
going after these random domain names

513
00:25:29,670 --> 00:25:30,810
that are being generated that kind of

514
00:25:30,810 --> 00:25:32,940
thing - you do you have any advice on

515
00:25:32,940 --> 00:25:34,620
for people that are collecting this data

516
00:25:34,620 --> 00:25:37,020
using passive DNS like how to find the

517
00:25:37,020 --> 00:25:39,150
goal you know how to find the needle in

518
00:25:39,150 --> 00:25:41,910
the haystack if you will I'm periodicity

519
00:25:41,910 --> 00:25:43,950
is one thing so just looking for

520
00:25:43,950 --> 00:25:45,420
anything that you know appears to be

521
00:25:45,420 --> 00:25:47,340
beaconing and that that's actually you

522
00:25:47,340 --> 00:25:48,900
know we've got some spark lines on some

523
00:25:48,900 --> 00:25:50,760
of the some of the tables in there

524
00:25:50,760 --> 00:25:52,440
showing so it's a little easier to see

525
00:25:52,440 --> 00:25:56,340
periodicity the other thing is if you

526
00:25:56,340 --> 00:25:57,960
filter out content providers so you

527
00:25:57,960 --> 00:25:59,490
generally get rid of a lot of the

528
00:25:59,490 --> 00:26:01,260
legitimate ones which is the length of

529
00:26:01,260 --> 00:26:04,410
the query itself content providers tend

530
00:26:04,410 --> 00:26:07,290
to have very very lengthy domain names

531
00:26:07,290 --> 00:26:09,230
subdomains

532
00:26:09,230 --> 00:26:11,520
but yeah that that's another indicator

533
00:26:11,520 --> 00:26:14,130
right there that interesting query is

534
00:26:14,130 --> 00:26:15,480
something I would want to look at us on

535
00:26:15,480 --> 00:26:18,390
is something a very long dns name yeah

536
00:26:18,390 --> 00:26:20,010
he's like you know they'd be a good way

537
00:26:20,010 --> 00:26:21,630
of identifying

538
00:26:21,630 --> 00:26:23,160
points that are exactly potentially

539
00:26:23,160 --> 00:26:24,660
because obviously there's a lot of DMS

540
00:26:24,660 --> 00:26:28,080
activity there and I also was kind of

541
00:26:28,080 --> 00:26:29,340
intrigued at the beginning and talked

542
00:26:29,340 --> 00:26:31,650
about not being a lot of good standards

543
00:26:31,650 --> 00:26:36,150
for threat Intel sharing Kathy and when

544
00:26:36,150 --> 00:26:38,070
I looked at that I always questioned

545
00:26:38,070 --> 00:26:40,500
that myself going well I what is the

546
00:26:40,500 --> 00:26:43,410
reason behind that like is it that we we

547
00:26:43,410 --> 00:26:44,910
don't actually know what's useful to

548
00:26:44,910 --> 00:26:47,100
share or is it that we just haven't

549
00:26:47,100 --> 00:26:48,630
gotten together and agreed upon a format

550
00:26:48,630 --> 00:26:51,750
do you have any thoughts on that there's

551
00:26:51,750 --> 00:26:54,120
there's a lot of different formats

552
00:26:54,120 --> 00:26:58,230
standards out there you know there's the

553
00:26:58,230 --> 00:27:01,770
sticks taxi there's you know open IOC

554
00:27:01,770 --> 00:27:03,360
because there's a lot of different

555
00:27:03,360 --> 00:27:07,350
formats out there one of the problems is

556
00:27:07,350 --> 00:27:10,290
that as an industry we can't all agree

557
00:27:10,290 --> 00:27:13,500
on one format to use right so that's

558
00:27:13,500 --> 00:27:15,180
also part of the problem is none of

559
00:27:15,180 --> 00:27:18,360
those are you know the overwhelmingly

560
00:27:18,360 --> 00:27:21,660
number one use format people like to use

561
00:27:21,660 --> 00:27:24,000
whatever they like to use the other

562
00:27:24,000 --> 00:27:27,810
problem is that in many of the security

563
00:27:27,810 --> 00:27:30,540
operations and throughout Intel groups

564
00:27:30,540 --> 00:27:33,300
were short staffed so there's a lot of

565
00:27:33,300 --> 00:27:36,000
data coming in but not enough people to

566
00:27:36,000 --> 00:27:38,580
look at them so that's the other issue

567
00:27:38,580 --> 00:27:41,460
the third issue is our willingness to

568
00:27:41,460 --> 00:27:44,460
share right we still have in the threat

569
00:27:44,460 --> 00:27:47,880
Intel community that know Matt and Trust

570
00:27:47,880 --> 00:27:50,670
kind of verification system going on and

571
00:27:50,670 --> 00:27:54,060
that will naturally limit the amount of

572
00:27:54,060 --> 00:27:57,260
people that will be able to access

573
00:27:57,260 --> 00:28:00,450
shareable information as well so there's

574
00:28:00,450 --> 00:28:02,400
a lot of different factors that are

575
00:28:02,400 --> 00:28:05,100
preventing us from doing a better job

576
00:28:05,100 --> 00:28:07,440
with sharing this data that's been my

577
00:28:07,440 --> 00:28:11,040
experience well thank you very much any

578
00:28:11,040 --> 00:28:14,610
other questions or if not if we can have

579
00:28:14,610 --> 00:28:15,960
a round of applause I think Kathy and

580
00:28:15,960 --> 00:28:18,520
Steve for their presentation

581
00:28:18,520 --> 00:28:20,580
you

