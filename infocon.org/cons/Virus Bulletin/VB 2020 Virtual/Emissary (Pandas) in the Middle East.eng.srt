1
00:00:08,800 --> 00:00:10,240
hello and welcome

2
00:00:10,240 --> 00:00:11,599
thank you for taking the time to watch

3
00:00:11,599 --> 00:00:14,080
our presentation today on pandemic

4
00:00:14,080 --> 00:00:16,960
emissary pandas in the middle east we

5
00:00:16,960 --> 00:00:18,080
also would like to thank

6
00:00:18,080 --> 00:00:20,240
virus bulletin and all of those involved

7
00:00:20,240 --> 00:00:21,600
in putting together

8
00:00:21,600 --> 00:00:25,199
the virus bulletin local host event

9
00:00:25,199 --> 00:00:27,760
hi my name is jon kumo i'm the team lead

10
00:00:27,760 --> 00:00:28,560
for outreach

11
00:00:28,560 --> 00:00:31,039
at team i'm responsible for the

12
00:00:31,039 --> 00:00:32,079
engagement with

13
00:00:32,079 --> 00:00:35,120
communities and also to sign up for our

14
00:00:35,120 --> 00:00:37,600
community services

15
00:00:37,600 --> 00:00:40,399
and i'm james shank senior security

16
00:00:40,399 --> 00:00:41,280
evangelist

17
00:00:41,280 --> 00:00:42,960
and chief architect of community

18
00:00:42,960 --> 00:00:46,239
services for team montgomery

19
00:00:46,480 --> 00:00:47,920
today we're going to be talking about

20
00:00:47,920 --> 00:00:49,680
several different things we'll talk

21
00:00:49,680 --> 00:00:50,800
about

22
00:00:50,800 --> 00:00:52,960
the emissary pandas and their activity

23
00:00:52,960 --> 00:00:54,559
in the middle east

24
00:00:54,559 --> 00:00:55,840
we'll talk about the attacker

25
00:00:55,840 --> 00:00:58,640
infrastructure we'll talk about twitter

26
00:00:58,640 --> 00:00:59,440
and its use

27
00:00:59,440 --> 00:01:01,680
for geopolitical messaging in the modern

28
00:01:01,680 --> 00:01:02,480
era

29
00:01:02,480 --> 00:01:04,799
and the impact of that messaging on abt

30
00:01:04,799 --> 00:01:06,159
activity

31
00:01:06,159 --> 00:01:07,760
and we'll talk about persian defensive

32
00:01:07,760 --> 00:01:09,520
tools

33
00:01:09,520 --> 00:01:11,439
another way to characterize what we're

34
00:01:11,439 --> 00:01:12,880
talking about today

35
00:01:12,880 --> 00:01:15,200
is scouting scouting is a well-known

36
00:01:15,200 --> 00:01:16,400
military tactic

37
00:01:16,400 --> 00:01:19,680
that's been in use for many many years

38
00:01:19,680 --> 00:01:22,400
but this isn't sufficient what we'd like

39
00:01:22,400 --> 00:01:23,360
to talk about today

40
00:01:23,360 --> 00:01:25,680
is cyberfield awareness cyberfield

41
00:01:25,680 --> 00:01:26,799
awareness

42
00:01:26,799 --> 00:01:29,360
is similar to battlefield awareness it

43
00:01:29,360 --> 00:01:31,040
goes above and beyond

44
00:01:31,040 --> 00:01:33,280
yesterday's threat intelligence to

45
00:01:33,280 --> 00:01:34,400
enable defenders

46
00:01:34,400 --> 00:01:37,759
a more capable and directed response

47
00:01:37,759 --> 00:01:40,880
towards attacker methodologies

48
00:01:40,880 --> 00:01:42,560
our story today begins in summer of

49
00:01:42,560 --> 00:01:44,000
2019.

50
00:01:44,000 --> 00:01:47,280
in june of 2019 ae cert publishes an

51
00:01:47,280 --> 00:01:48,000
advisory

52
00:01:48,000 --> 00:01:50,960
that has a really long english name this

53
00:01:50,960 --> 00:01:53,200
advisory includes 18

54
00:01:53,200 --> 00:01:56,399
ip addresses that are positive iocs

55
00:01:56,399 --> 00:01:59,439
for the apt-27 actor infrastructure

56
00:01:59,439 --> 00:02:00,640
it characterizes some of the

57
00:02:00,640 --> 00:02:02,719
communication techniques that the actors

58
00:02:02,719 --> 00:02:03,119
are

59
00:02:03,119 --> 00:02:07,280
using including use of tcp port 443 for

60
00:02:07,280 --> 00:02:09,520
communications from the victim computers

61
00:02:09,520 --> 00:02:10,160
to the

62
00:02:10,160 --> 00:02:14,400
actor controllers and tcp port 4550

63
00:02:14,400 --> 00:02:16,800
connecting from the higher order

64
00:02:16,800 --> 00:02:18,640
infrastructure into the controllers

65
00:02:18,640 --> 00:02:21,680
and other parts of the infrastructure

66
00:02:21,680 --> 00:02:23,760
they also revealed within this report a

67
00:02:23,760 --> 00:02:25,760
new tool called hyperssl

68
00:02:25,760 --> 00:02:28,080
hyperssl appears to us to be a hyperpro

69
00:02:28,080 --> 00:02:29,120
variant

70
00:02:29,120 --> 00:02:31,599
hyperbro is a family of malware that has

71
00:02:31,599 --> 00:02:32,560
been in use

72
00:02:32,560 --> 00:02:36,160
by the apt-27 actors for quite some time

73
00:02:36,160 --> 00:02:38,480
in our research into this particular

74
00:02:38,480 --> 00:02:39,440
strain

75
00:02:39,440 --> 00:02:41,519
we did find a reference in a fireeye

76
00:02:41,519 --> 00:02:42,800
paper

77
00:02:42,800 --> 00:02:45,040
where they labeled it focus fjord so

78
00:02:45,040 --> 00:02:46,400
just for awareness there might be some

79
00:02:46,400 --> 00:02:47,280
other names by

80
00:02:47,280 --> 00:02:50,000
which this tool is referred starting

81
00:02:50,000 --> 00:02:51,680
with the aesert paper

82
00:02:51,680 --> 00:02:53,920
we take the iocs out of that paper and

83
00:02:53,920 --> 00:02:55,760
dive into our data sets to look to see

84
00:02:55,760 --> 00:02:58,080
what we can do to enrich the data

85
00:02:58,080 --> 00:03:00,080
we quickly notice that there's an x 509

86
00:03:00,080 --> 00:03:01,120
certificate

87
00:03:01,120 --> 00:03:03,599
that's hosted by several of the hosts

88
00:03:03,599 --> 00:03:06,400
that are identified by the esert paper

89
00:03:06,400 --> 00:03:08,560
this x 509 certificate has a particular

90
00:03:08,560 --> 00:03:09,440
issuer

91
00:03:09,440 --> 00:03:11,040
and subject line that is a little bit

92
00:03:11,040 --> 00:03:12,640
unique and is

93
00:03:12,640 --> 00:03:14,159
useful to us later but we'll get into

94
00:03:14,159 --> 00:03:16,159
that

95
00:03:16,159 --> 00:03:18,080
this certificate allows us to identify

96
00:03:18,080 --> 00:03:20,400
other actor-controlled infrastructure

97
00:03:20,400 --> 00:03:22,159
presenting the exact same x-509

98
00:03:22,159 --> 00:03:24,239
certificate we also look into the

99
00:03:24,239 --> 00:03:26,319
network metadata associated with these

100
00:03:26,319 --> 00:03:27,040
hosts

101
00:03:27,040 --> 00:03:29,440
and we notice the tcp 4550 that

102
00:03:29,440 --> 00:03:31,440
aesthetic mentioned being used

103
00:03:31,440 --> 00:03:34,480
but we also see tcp port 22 commonly

104
00:03:34,480 --> 00:03:36,480
used for ssh and we believe this is used

105
00:03:36,480 --> 00:03:38,640
for managing the controllers

106
00:03:38,640 --> 00:03:41,599
we see tcp port 443 in use as well and

107
00:03:41,599 --> 00:03:43,680
udp port 443

108
00:03:43,680 --> 00:03:45,360
as i mentioned we started with the

109
00:03:45,360 --> 00:03:47,120
indicators published in the

110
00:03:47,120 --> 00:03:50,640
easter paper and in our initial round of

111
00:03:50,640 --> 00:03:52,159
looking into further host

112
00:03:52,159 --> 00:03:54,959
we immediately identify 15 more related

113
00:03:54,959 --> 00:03:55,680
hosts

114
00:03:55,680 --> 00:03:57,599
that are part of the apt-27 actor

115
00:03:57,599 --> 00:03:59,120
infrastructure matching several

116
00:03:59,120 --> 00:04:00,720
different fingerprints

117
00:04:00,720 --> 00:04:02,879
and at the time that we did our

118
00:04:02,879 --> 00:04:05,040
investigation into our data sets

119
00:04:05,040 --> 00:04:07,599
several of the hosts that ae cert had

120
00:04:07,599 --> 00:04:08,319
talked about

121
00:04:08,319 --> 00:04:10,879
were no longer online this suggests or

122
00:04:10,879 --> 00:04:12,560
begins to suggest to us

123
00:04:12,560 --> 00:04:14,560
that there may be some dynamic use of

124
00:04:14,560 --> 00:04:19,120
hosts within the apg-27 actor behavior

125
00:04:19,120 --> 00:04:20,918
with our growing understanding of the

126
00:04:20,918 --> 00:04:22,720
apt-27 network

127
00:04:22,720 --> 00:04:26,080
activity we were able to diagram what

128
00:04:26,080 --> 00:04:28,479
the apt-27 infrastructure looked like

129
00:04:28,479 --> 00:04:29,840
from our perspective

130
00:04:29,840 --> 00:04:33,040
in the summer of 2019. but we'll come

131
00:04:33,040 --> 00:04:36,400
back to this in just a moment

132
00:04:36,479 --> 00:04:37,600
at this point we're starting to

133
00:04:37,600 --> 00:04:39,199
understand some of the communication

134
00:04:39,199 --> 00:04:40,160
patterns

135
00:04:40,160 --> 00:04:43,840
that are used by the apt-27 actor group

136
00:04:43,840 --> 00:04:45,600
we see a lot of victim connections from

137
00:04:45,600 --> 00:04:47,040
the middle east in particular

138
00:04:47,040 --> 00:04:49,759
connecting to tcp port 443 of the

139
00:04:49,759 --> 00:04:50,880
controllers

140
00:04:50,880 --> 00:04:53,040
we also see hosts from hong kong and

141
00:04:53,040 --> 00:04:54,000
china connecting

142
00:04:54,000 --> 00:04:57,919
via tcp port 4550 into the controllers

143
00:04:57,919 --> 00:05:00,160
we see ssh connections between several

144
00:05:00,160 --> 00:05:02,560
hosts particularly from some of the

145
00:05:02,560 --> 00:05:05,280
endpoint hosts into the controllers we

146
00:05:05,280 --> 00:05:07,360
also see what appears to us to be vpn

147
00:05:07,360 --> 00:05:09,120
like connections from hong kong host

148
00:05:09,120 --> 00:05:11,440
into the controllers

149
00:05:11,440 --> 00:05:13,360
with the network fingerprints that we've

150
00:05:13,360 --> 00:05:14,960
been discussing we're able to look

151
00:05:14,960 --> 00:05:17,039
through our data holdings to find

152
00:05:17,039 --> 00:05:18,800
communications patterns that match these

153
00:05:18,800 --> 00:05:20,080
fingerprints

154
00:05:20,080 --> 00:05:22,320
here we're showing an example of netflow

155
00:05:22,320 --> 00:05:24,800
data showing victims connecting

156
00:05:24,800 --> 00:05:28,240
via tcp port 443 to the command and

157
00:05:28,240 --> 00:05:28,880
control

158
00:05:28,880 --> 00:05:32,479
servers used by apd's 27 actors

159
00:05:32,479 --> 00:05:34,320
these are just a few examples but even

160
00:05:34,320 --> 00:05:35,680
within this set

161
00:05:35,680 --> 00:05:39,440
you can see victims within the uae

162
00:05:39,440 --> 00:05:41,280
which is consistent with some of the

163
00:05:41,280 --> 00:05:43,680
victimology that's mentioned by aeserts

164
00:05:43,680 --> 00:05:46,240
whitepaper

165
00:05:46,560 --> 00:05:49,440
going back to our summer 2019 diagram

166
00:05:49,440 --> 00:05:50,880
there's a few nodes on here that i would

167
00:05:50,880 --> 00:05:52,560
like to call attention to

168
00:05:52,560 --> 00:05:54,320
the red arrow here points to what we

169
00:05:54,320 --> 00:05:56,479
believe to be an operational node

170
00:05:56,479 --> 00:05:58,240
this node we believe to be used as an

171
00:05:58,240 --> 00:06:01,039
exit point at the end of the vpn tunnel

172
00:06:01,039 --> 00:06:02,400
set up by the actor

173
00:06:02,400 --> 00:06:05,039
this node is hosted at digitalocean its

174
00:06:05,039 --> 00:06:09,919
ip address is 139.59.67.212.

175
00:06:09,919 --> 00:06:12,240
this node was observed hosting the x509

176
00:06:12,240 --> 00:06:13,680
certificate identified

177
00:06:13,680 --> 00:06:17,280
between april and june of 2019.

178
00:06:17,280 --> 00:06:19,120
we see connections into this host that

179
00:06:19,120 --> 00:06:21,039
appear to be vpn connections

180
00:06:21,039 --> 00:06:22,560
and connections out from this host that

181
00:06:22,560 --> 00:06:24,880
appear to be ssh connections

182
00:06:24,880 --> 00:06:26,240
we also see traffic that would be

183
00:06:26,240 --> 00:06:29,280
compatible with possible recon activity

184
00:06:29,280 --> 00:06:30,960
and we believe that this host is used

185
00:06:30,960 --> 00:06:32,560
primarily for management and forward

186
00:06:32,560 --> 00:06:35,039
compromise activities

187
00:06:35,039 --> 00:06:36,800
the gold arrow is pointing to one of the

188
00:06:36,800 --> 00:06:38,560
vpn nodes

189
00:06:38,560 --> 00:06:41,600
this is used as a middle vpn relay this

190
00:06:41,600 --> 00:06:44,080
node hosted the x 509 certificate from

191
00:06:44,080 --> 00:06:47,280
april to july of 2019.

192
00:06:47,280 --> 00:06:50,000
host receives most of the connections

193
00:06:50,000 --> 00:06:50,800
from china

194
00:06:50,800 --> 00:06:53,840
backbone hosts again these connections

195
00:06:53,840 --> 00:06:56,560
are believed to be vpn connections

196
00:06:56,560 --> 00:06:58,880
this connects out to alibaba and digital

197
00:06:58,880 --> 00:07:00,639
ocean hosts

198
00:07:00,639 --> 00:07:03,840
mostly with vpn connections the row of

199
00:07:03,840 --> 00:07:05,599
bluehost below the red arrow are

200
00:07:05,599 --> 00:07:06,960
controllers

201
00:07:06,960 --> 00:07:08,560
these hosts are observed receiving

202
00:07:08,560 --> 00:07:10,400
connections from from

203
00:07:10,400 --> 00:07:14,400
believed victims the row of red hosts

204
00:07:14,400 --> 00:07:17,759
are hosted at alibaba and we believe

205
00:07:17,759 --> 00:07:18,479
that these

206
00:07:18,479 --> 00:07:20,880
may be used to bring data back from the

207
00:07:20,880 --> 00:07:22,960
controllers

208
00:07:22,960 --> 00:07:25,440
the china host on the bottom right we

209
00:07:25,440 --> 00:07:27,120
believe may be closest

210
00:07:27,120 --> 00:07:30,000
to the actors but at this point we're

211
00:07:30,000 --> 00:07:33,039
still building our understanding

212
00:07:33,039 --> 00:07:34,960
in diving into our data sets looking for

213
00:07:34,960 --> 00:07:37,199
other associated behavior we notice that

214
00:07:37,199 --> 00:07:39,120
there's another x 509 certificate that

215
00:07:39,120 --> 00:07:40,000
has a matching

216
00:07:40,000 --> 00:07:43,840
issuer and subject line to the original

217
00:07:43,840 --> 00:07:45,520
x509 certificate

218
00:07:45,520 --> 00:07:48,319
this certificate also has a not before

219
00:07:48,319 --> 00:07:49,120
date

220
00:07:49,120 --> 00:07:51,120
that is within a few minutes of the same

221
00:07:51,120 --> 00:07:53,360
time of day on a different day but same

222
00:07:53,360 --> 00:07:55,039
time of day

223
00:07:55,039 --> 00:07:57,360
of the first x-509 certificate that we

224
00:07:57,360 --> 00:07:58,879
observed

225
00:07:58,879 --> 00:08:00,479
we start to monitor the hosts that are

226
00:08:00,479 --> 00:08:02,160
serving this and we

227
00:08:02,160 --> 00:08:04,000
see multiple fingerprints overlapping

228
00:08:04,000 --> 00:08:05,199
with actor behavior

229
00:08:05,199 --> 00:08:07,199
and with high confidence we can assert

230
00:08:07,199 --> 00:08:08,720
that this certificate is also part of

231
00:08:08,720 --> 00:08:10,319
the apt-27

232
00:08:10,319 --> 00:08:12,639
actor infrastructure this certificate

233
00:08:12,639 --> 00:08:14,319
was observed at the same time

234
00:08:14,319 --> 00:08:16,800
as we still saw activity on that first x

235
00:08:16,800 --> 00:08:18,400
509 certificate so there was an

236
00:08:18,400 --> 00:08:20,319
overlapping duration of the use of the

237
00:08:20,319 --> 00:08:22,960
two x 509 certificates

238
00:08:22,960 --> 00:08:26,240
we also see tcp port 4550

239
00:08:26,240 --> 00:08:28,960
traffic declining during this period but

240
00:08:28,960 --> 00:08:30,879
we see the introduction of a new port

241
00:08:30,879 --> 00:08:34,958
port 55781 again on tcp

242
00:08:34,958 --> 00:08:36,958
that is it in use by the actors at this

243
00:08:36,958 --> 00:08:39,199
time

244
00:08:39,519 --> 00:08:42,159
in september of 2019 we start to have a

245
00:08:42,159 --> 00:08:43,760
more developed understanding of the

246
00:08:43,760 --> 00:08:47,440
actor infrastructure the flow of traffic

247
00:08:47,440 --> 00:08:48,959
appears to be

248
00:08:48,959 --> 00:08:51,839
moving from the actor through vpn

249
00:08:51,839 --> 00:08:54,080
connections at hosting providers

250
00:08:54,080 --> 00:08:57,120
to an operational note management node

251
00:08:57,120 --> 00:08:59,200
and then from there connecting into the

252
00:08:59,200 --> 00:09:02,480
controllers for management purposes

253
00:09:02,480 --> 00:09:05,120
this same exit point is also used for

254
00:09:05,120 --> 00:09:09,279
recon activity at different points

255
00:09:09,279 --> 00:09:11,279
the controllers then all appear to

256
00:09:11,279 --> 00:09:13,360
connect to a node that we're calling a

257
00:09:13,360 --> 00:09:14,800
data path node

258
00:09:14,800 --> 00:09:16,959
we believe that this node may be used

259
00:09:16,959 --> 00:09:18,800
for exfiltration of data from the

260
00:09:18,800 --> 00:09:20,399
controllers

261
00:09:20,399 --> 00:09:23,120
the red arrow points to the same node as

262
00:09:23,120 --> 00:09:26,160
we mentioned before

263
00:09:26,519 --> 00:09:28,000
68.183.94.205

264
00:09:28,000 --> 00:09:30,000
and it's still playing the same role as

265
00:09:30,000 --> 00:09:32,720
it was during summer of 2019

266
00:09:32,720 --> 00:09:36,000
in september the gold arrow points to

267
00:09:36,000 --> 00:09:39,279
a new node this is a data path node it's

268
00:09:39,279 --> 00:09:42,640
receiving tcp port 55781 connections

269
00:09:42,640 --> 00:09:45,120
from the controllers

270
00:09:45,120 --> 00:09:47,200
this is also the first time that we saw

271
00:09:47,200 --> 00:09:49,519
dmit cloud services of

272
00:09:49,519 --> 00:09:52,320
hong kong being used for hosting any of

273
00:09:52,320 --> 00:09:55,120
the infrastructure

274
00:09:55,120 --> 00:09:56,480
also we noticed that there was an

275
00:09:56,480 --> 00:09:58,480
introduction of linode as one of the

276
00:09:58,480 --> 00:10:00,399
hosting providers for both controllers

277
00:10:00,399 --> 00:10:02,839
and some of the nodes hosting the x509

278
00:10:02,839 --> 00:10:04,800
certificate

279
00:10:04,800 --> 00:10:07,920
in september we only see three nodes

280
00:10:07,920 --> 00:10:09,360
still hosting the first

281
00:10:09,360 --> 00:10:12,240
identified x509 certificate but now we

282
00:10:12,240 --> 00:10:12,560
see

283
00:10:12,560 --> 00:10:14,800
10 nodes hosting the second identified x

284
00:10:14,800 --> 00:10:19,680
509 certificate

285
00:10:19,680 --> 00:10:22,800
by november of 2019 we're confident that

286
00:10:22,800 --> 00:10:25,839
tcp port 4550 is no longer in use by the

287
00:10:25,839 --> 00:10:26,560
actors

288
00:10:26,560 --> 00:10:28,320
it's been quite some time since we've

289
00:10:28,320 --> 00:10:29,920
seen this port used

290
00:10:29,920 --> 00:10:32,320
in connections associated with the

291
00:10:32,320 --> 00:10:35,519
apt-27 infrastructure

292
00:10:35,519 --> 00:10:37,120
much of the infrastructure remains

293
00:10:37,120 --> 00:10:38,959
largely the same between september and

294
00:10:38,959 --> 00:10:40,720
november of 2019

295
00:10:40,720 --> 00:10:43,839
but we do see a migration of hosts

296
00:10:43,839 --> 00:10:46,160
that were previously at digitalocean now

297
00:10:46,160 --> 00:10:48,959
moving to linode

298
00:10:48,959 --> 00:10:50,640
we see the introduction of a new node

299
00:10:50,640 --> 00:10:52,079
from china backbone

300
00:10:52,079 --> 00:10:54,000
that is hosting the second x509

301
00:10:54,000 --> 00:10:56,079
certificate this is the first time that

302
00:10:56,079 --> 00:10:57,440
we've observed

303
00:10:57,440 --> 00:10:59,760
chinanet backbone hosting any of the

304
00:10:59,760 --> 00:11:03,040
x509 certificates

305
00:11:03,440 --> 00:11:06,240
we also identify a digital ocean host

306
00:11:06,240 --> 00:11:07,680
that's receiving tcp

307
00:11:07,680 --> 00:11:10,880
8080 connections from a host

308
00:11:10,880 --> 00:11:14,000
that is hosting the x509 certificate but

309
00:11:14,000 --> 00:11:15,760
at this point we aren't sure what the

310
00:11:15,760 --> 00:11:18,800
use of this host is

311
00:11:19,360 --> 00:11:21,760
as we move into december we see some

312
00:11:21,760 --> 00:11:24,160
significant changes

313
00:11:24,160 --> 00:11:26,079
as a note the red arrow and the gold

314
00:11:26,079 --> 00:11:27,839
arrow on this slide point to the same

315
00:11:27,839 --> 00:11:29,200
nodes that we've been referring to in

316
00:11:29,200 --> 00:11:31,519
the past few slides

317
00:11:31,519 --> 00:11:33,839
we see a shift in the total number of

318
00:11:33,839 --> 00:11:35,279
nodes hosted at linode

319
00:11:35,279 --> 00:11:38,560
versus digital ocean where digital ocean

320
00:11:38,560 --> 00:11:41,200
seems to be falling out of favor in use

321
00:11:41,200 --> 00:11:42,640
during december

322
00:11:42,640 --> 00:11:45,279
and linode is increasing in the number

323
00:11:45,279 --> 00:11:46,640
of hosts that are used

324
00:11:46,640 --> 00:11:49,600
in part of the apt-27 infrastructure we

325
00:11:49,600 --> 00:11:51,600
had previously noted the significance of

326
00:11:51,600 --> 00:11:53,279
the red arrowed host

327
00:11:53,279 --> 00:11:55,120
this host is now having some of its

328
00:11:55,120 --> 00:11:56,800
functions performed by

329
00:11:56,800 --> 00:11:59,600
two new hosts that appear on lino's

330
00:11:59,600 --> 00:12:00,560
network

331
00:12:00,560 --> 00:12:02,240
around this time we began to wonder

332
00:12:02,240 --> 00:12:04,000
whether the actors were making a

333
00:12:04,000 --> 00:12:06,639
complete shift away from digitalocean in

334
00:12:06,639 --> 00:12:08,079
favor of lynode

335
00:12:08,079 --> 00:12:10,079
we did note as well that the overall

336
00:12:10,079 --> 00:12:12,480
network increased in size

337
00:12:12,480 --> 00:12:14,160
we also note here that there was an

338
00:12:14,160 --> 00:12:16,160
increase overall in the number of

339
00:12:16,160 --> 00:12:18,639
victim connections we previously were

340
00:12:18,639 --> 00:12:20,639
not showing victim connections

341
00:12:20,639 --> 00:12:23,120
but because of the significant changes

342
00:12:23,120 --> 00:12:26,079
we introduce that on the slide

343
00:12:26,079 --> 00:12:27,760
on the topic of victims we see a

344
00:12:27,760 --> 00:12:30,040
peculiar system incorporated into the

345
00:12:30,040 --> 00:12:33,680
apt-27 actor infrastructure this month

346
00:12:33,680 --> 00:12:35,760
the system shown in the lower left in

347
00:12:35,760 --> 00:12:38,320
yellow is a system at a canadian elder

348
00:12:38,320 --> 00:12:40,800
care facility or nursing home

349
00:12:40,800 --> 00:12:43,360
we suspect this node was compromised yet

350
00:12:43,360 --> 00:12:44,720
this is the first time that we've

351
00:12:44,720 --> 00:12:46,720
observed a compromise system being used

352
00:12:46,720 --> 00:12:47,920
in this way

353
00:12:47,920 --> 00:12:49,519
this node may not have been part of the

354
00:12:49,519 --> 00:12:51,360
infrastructure for very long

355
00:12:51,360 --> 00:12:52,959
but during the time that it was online

356
00:12:52,959 --> 00:12:54,639
we did see some reconnaissance

357
00:12:54,639 --> 00:12:59,120
like activity originating from this node

358
00:12:59,120 --> 00:13:02,560
december 15 of 2019 brings an

359
00:13:02,560 --> 00:13:05,360
interesting change to our story

360
00:13:05,360 --> 00:13:08,399
on this date we see the iranian minister

361
00:13:08,399 --> 00:13:11,440
of communication information technology

362
00:13:11,440 --> 00:13:14,320
tweeting that several of their servers

363
00:13:14,320 --> 00:13:16,160
have been compromised

364
00:13:16,160 --> 00:13:19,279
by a spy mower that they believe it's

365
00:13:19,279 --> 00:13:20,399
linked to

366
00:13:20,399 --> 00:13:24,079
apt 27 actors

367
00:13:24,079 --> 00:13:27,600
diving back into our data and looking

368
00:13:27,600 --> 00:13:28,959
for indicators

369
00:13:28,959 --> 00:13:32,399
from our data we previously have linked

370
00:13:32,399 --> 00:13:35,920
to activities by the apt 27 group

371
00:13:35,920 --> 00:13:39,040
we notice a sample our holdings that had

372
00:13:39,040 --> 00:13:40,079
a shared

373
00:13:40,079 --> 00:13:42,880
new text pattern that was known to be

374
00:13:42,880 --> 00:13:47,360
associated with the epd27 tools

375
00:13:47,360 --> 00:13:50,560
but this sample look odd to us as it

376
00:13:50,560 --> 00:13:51,600
didn't match

377
00:13:51,600 --> 00:13:55,040
several of other signatures so we dive

378
00:13:55,040 --> 00:13:58,079
and look at it the five details of this

379
00:13:58,079 --> 00:13:58,800
mower

380
00:13:58,800 --> 00:14:03,839
show it was called afta

381
00:14:06,480 --> 00:14:10,240
afta is an iranian agency organized

382
00:14:10,240 --> 00:14:12,399
under the supreme national security

383
00:14:12,399 --> 00:14:13,360
council

384
00:14:13,360 --> 00:14:16,399
and responsible in part for secure

385
00:14:16,399 --> 00:14:17,279
iranian

386
00:14:17,279 --> 00:14:20,959
assets in our own sandbox run

387
00:14:20,959 --> 00:14:23,040
we capture the image you can see on the

388
00:14:23,040 --> 00:14:25,040
right on the right hand

389
00:14:25,040 --> 00:14:28,639
of this image you can see the efta logo

390
00:14:28,639 --> 00:14:32,000
and on the left side the logo of bitcoin

391
00:14:32,000 --> 00:14:34,959
which is an iranian malware analysis

392
00:14:34,959 --> 00:14:36,959
company

393
00:14:36,959 --> 00:14:39,040
and they mentioned themselves also in

394
00:14:39,040 --> 00:14:41,199
late december 2019

395
00:14:41,199 --> 00:14:43,839
that they worked in cooperation with

396
00:14:43,839 --> 00:14:45,040
afda

397
00:14:45,040 --> 00:14:49,160
to create a model removal to to clean up

398
00:14:49,160 --> 00:14:52,880
apt-27 while a cooperation

399
00:14:52,880 --> 00:14:55,680
between a private company is not

400
00:14:55,680 --> 00:14:57,199
uncommon

401
00:14:57,199 --> 00:15:00,399
which strike us as interest is that this

402
00:15:00,399 --> 00:15:01,440
partnership

403
00:15:01,440 --> 00:15:04,639
was disclosed very openly and that makes

404
00:15:04,639 --> 00:15:05,600
you wonder

405
00:15:05,600 --> 00:15:09,279
how bad the situation was at the time

406
00:15:09,279 --> 00:15:11,680
thanks for that giacomo so did the

407
00:15:11,680 --> 00:15:13,600
kittens beat the pandas

408
00:15:13,600 --> 00:15:17,199
what does the data show interestingly

409
00:15:17,199 --> 00:15:19,760
in january and late december we see a

410
00:15:19,760 --> 00:15:20,560
complete

411
00:15:20,560 --> 00:15:24,399
stop to all the iranian victim traffic

412
00:15:24,399 --> 00:15:26,560
it appears like the remediation tool and

413
00:15:26,560 --> 00:15:27,519
the efforts that

414
00:15:27,519 --> 00:15:31,040
iran engaged in to clean up their assets

415
00:15:31,040 --> 00:15:33,839
were indeed successful but it doesn't

416
00:15:33,839 --> 00:15:35,040
stop there

417
00:15:35,040 --> 00:15:38,639
the apt-27 actors reduced their overall

418
00:15:38,639 --> 00:15:40,079
activity completely

419
00:15:40,079 --> 00:15:41,839
we see a reduction in the management

420
00:15:41,839 --> 00:15:44,000
traffic we see reduction in the

421
00:15:44,000 --> 00:15:45,040
infrastructure

422
00:15:45,040 --> 00:15:46,480
we see a reduction in the new

423
00:15:46,480 --> 00:15:48,160
victimology

424
00:15:48,160 --> 00:15:51,040
and we see some of the nodes that they

425
00:15:51,040 --> 00:15:52,000
previously use

426
00:15:52,000 --> 00:15:56,880
shifting around of note

427
00:15:57,720 --> 00:15:58,880
68.183.94.205

428
00:15:58,880 --> 00:16:00,880
which was previously the operational

429
00:16:00,880 --> 00:16:03,440
node hosted at digitalocean

430
00:16:03,440 --> 00:16:06,880
is no longer active this was one of the

431
00:16:06,880 --> 00:16:07,680
prominent

432
00:16:07,680 --> 00:16:10,000
and important assets in the actor

433
00:16:10,000 --> 00:16:11,440
infrastructure

434
00:16:11,440 --> 00:16:15,199
prior to january of 2020.

435
00:16:15,199 --> 00:16:16,720
we see a continued shift from

436
00:16:16,720 --> 00:16:19,279
digitalocean to linode

437
00:16:19,279 --> 00:16:21,920
and we see a reduction overall in

438
00:16:21,920 --> 00:16:22,560
victims

439
00:16:22,560 --> 00:16:24,560
and the totality of the victim

440
00:16:24,560 --> 00:16:25,759
connections

441
00:16:25,759 --> 00:16:28,079
this image doesn't show the volume but

442
00:16:28,079 --> 00:16:31,040
the volume is significantly down

443
00:16:31,040 --> 00:16:33,440
the actors appear to not be engaging in

444
00:16:33,440 --> 00:16:35,279
recon activity like we've observed them

445
00:16:35,279 --> 00:16:37,120
in the past

446
00:16:37,120 --> 00:16:39,759
all of this appears like the apt-27

447
00:16:39,759 --> 00:16:42,160
actors responded to the iranian

448
00:16:42,160 --> 00:16:45,680
remediation by deciding to lay low

449
00:16:45,680 --> 00:16:47,839
and tear down infrastructure for a

450
00:16:47,839 --> 00:16:49,519
little while

451
00:16:49,519 --> 00:16:52,160
moving into february of 2020 we see a

452
00:16:52,160 --> 00:16:55,040
continued reduction in overall activity

453
00:16:55,040 --> 00:16:57,199
but we do see recon activity increasing

454
00:16:57,199 --> 00:16:58,480
this month

455
00:16:58,480 --> 00:17:00,240
we also see new countries being

456
00:17:00,240 --> 00:17:02,000
introduced into the

457
00:17:02,000 --> 00:17:04,319
recon activity set of these actors that

458
00:17:04,319 --> 00:17:07,520
we had previously not observed

459
00:17:07,520 --> 00:17:11,119
a host from shangshi telcom in china

460
00:17:11,119 --> 00:17:12,799
is observed connecting into one of our

461
00:17:12,799 --> 00:17:14,880
operational nodes

462
00:17:14,880 --> 00:17:16,480
this is the first time we have seen this

463
00:17:16,480 --> 00:17:18,319
telecommunications company hosting a

464
00:17:18,319 --> 00:17:22,240
node connecting into this infrastructure

465
00:17:22,400 --> 00:17:24,959
with the coming of spring in march of

466
00:17:24,959 --> 00:17:26,240
2020

467
00:17:26,240 --> 00:17:29,280
we see new activity and expansion

468
00:17:29,280 --> 00:17:32,720
of our infrastructure it had previously

469
00:17:32,720 --> 00:17:33,840
appeared to us

470
00:17:33,840 --> 00:17:36,240
that the actors were migrating away from

471
00:17:36,240 --> 00:17:37,520
digitalocean

472
00:17:37,520 --> 00:17:40,320
in favor of linode but with the

473
00:17:40,320 --> 00:17:41,120
introduction

474
00:17:41,120 --> 00:17:44,240
of new hosts at digitalocean in march of

475
00:17:44,240 --> 00:17:45,280
2020

476
00:17:45,280 --> 00:17:47,360
in the introduction of another hosting

477
00:17:47,360 --> 00:17:49,200
provider g-core labs

478
00:17:49,200 --> 00:17:51,679
that we have previously not observed we

479
00:17:51,679 --> 00:17:52,960
begin to understand

480
00:17:52,960 --> 00:17:55,160
that it's perhaps the case that the

481
00:17:55,160 --> 00:17:57,120
apt-27 actors

482
00:17:57,120 --> 00:18:00,480
were adopting a multi-cloud strategy

483
00:18:00,480 --> 00:18:02,559
multi-cloud strategies are popular among

484
00:18:02,559 --> 00:18:03,760
enterprises

485
00:18:03,760 --> 00:18:05,200
for increasing redundancy and

486
00:18:05,200 --> 00:18:07,200
availability and it might be the case

487
00:18:07,200 --> 00:18:08,720
that our threat actors were

488
00:18:08,720 --> 00:18:12,240
seeking this goal as well on this image

489
00:18:12,240 --> 00:18:14,640
you can see two black arrows pointing to

490
00:18:14,640 --> 00:18:17,760
the old operational nodes at linode

491
00:18:17,760 --> 00:18:19,679
these nodes were less active during this

492
00:18:19,679 --> 00:18:20,799
period and

493
00:18:20,799 --> 00:18:23,039
appear to have been retired on the 8th

494
00:18:23,039 --> 00:18:24,000
of march

495
00:18:24,000 --> 00:18:27,280
2020 we see the introduction of two new

496
00:18:27,280 --> 00:18:28,240
nodes

497
00:18:28,240 --> 00:18:31,200
one at alibaba one at digitalocean that

498
00:18:31,200 --> 00:18:33,360
are seen connecting via ssh into the

499
00:18:33,360 --> 00:18:34,240
infrastructure

500
00:18:34,240 --> 00:18:36,559
these are indicated by the red arrows

501
00:18:36,559 --> 00:18:42,879
these nodes are 66.175.218.50 and

502
00:18:43,320 --> 00:18:45,360
47.56.254.96

503
00:18:45,360 --> 00:18:47,440
these hosts have become the new

504
00:18:47,440 --> 00:18:48,880
operational nodes

505
00:18:48,880 --> 00:18:52,559
at the end of march 2020.

506
00:18:53,039 --> 00:18:54,640
moving into april we see the

507
00:18:54,640 --> 00:18:57,520
digitalocean node in the alibaba node

508
00:18:57,520 --> 00:18:59,360
indicated by the red arrows have taken

509
00:18:59,360 --> 00:19:01,520
on the full operational duty as the exit

510
00:19:01,520 --> 00:19:02,799
nodes

511
00:19:02,799 --> 00:19:04,880
we also see some interesting indicators

512
00:19:04,880 --> 00:19:06,000
that perhaps the

513
00:19:06,000 --> 00:19:08,840
iranian remediation was not entirely

514
00:19:08,840 --> 00:19:11,520
successful we see a connection on tcp

515
00:19:11,520 --> 00:19:13,120
port 993

516
00:19:13,120 --> 00:19:15,360
from some iranian assets into one of our

517
00:19:15,360 --> 00:19:17,440
operational nodes

518
00:19:17,440 --> 00:19:19,120
this comes at a time when the

519
00:19:19,120 --> 00:19:21,760
reconnaissance traffic from apt-27 to

520
00:19:21,760 --> 00:19:23,440
iranian address space

521
00:19:23,440 --> 00:19:26,880
is also increasing perhaps the kittens

522
00:19:26,880 --> 00:19:30,080
didn't beat the pandas after all

523
00:19:30,080 --> 00:19:31,440
since the time that we submitted our

524
00:19:31,440 --> 00:19:33,039
paper for fibrous bulletin we've

525
00:19:33,039 --> 00:19:34,000
continued to

526
00:19:34,000 --> 00:19:36,320
track this actor activity they're still

527
00:19:36,320 --> 00:19:37,760
very much active

528
00:19:37,760 --> 00:19:40,080
we did see some changes that are notable

529
00:19:40,080 --> 00:19:42,640
to their patterns of behavior

530
00:19:42,640 --> 00:19:44,559
first we saw the reintroduction of a

531
00:19:44,559 --> 00:19:46,160
host that was previously

532
00:19:46,160 --> 00:19:48,640
appeared to us to be retired during the

533
00:19:48,640 --> 00:19:50,480
turndown in december or the reduction of

534
00:19:50,480 --> 00:19:52,720
activity in december the demit

535
00:19:52,720 --> 00:19:55,200
hosting server came back to life and was

536
00:19:55,200 --> 00:19:56,559
then used again

537
00:19:56,559 --> 00:20:00,240
we also saw tcp55781 traffic seem to

538
00:20:00,240 --> 00:20:01,039
have stopped

539
00:20:01,039 --> 00:20:04,400
or been have been reduced and we see the

540
00:20:04,400 --> 00:20:06,080
introduction of a new port

541
00:20:06,080 --> 00:20:09,919
tcp port 38102 this port we first

542
00:20:09,919 --> 00:20:11,440
observe in late april

543
00:20:11,440 --> 00:20:13,280
and we note that it continues in an

544
00:20:13,280 --> 00:20:14,960
upward trend in usage

545
00:20:14,960 --> 00:20:17,200
through at least june of this year we

546
00:20:17,200 --> 00:20:18,400
also observe

547
00:20:18,400 --> 00:20:20,320
some changes in the victim connections

548
00:20:20,320 --> 00:20:21,440
into controllers

549
00:20:21,440 --> 00:20:23,520
previously we had noted that tcp port

550
00:20:23,520 --> 00:20:24,880
443

551
00:20:24,880 --> 00:20:27,360
was the port in protocol favored for

552
00:20:27,360 --> 00:20:28,960
connections into controllers

553
00:20:28,960 --> 00:20:30,960
in this time period we've started to see

554
00:20:30,960 --> 00:20:32,240
the introduction of udp

555
00:20:32,240 --> 00:20:35,840
53 tcp port 8080

556
00:20:35,840 --> 00:20:39,200
and tcp port 8443 perhaps most

557
00:20:39,200 --> 00:20:41,200
significantly we see a change to their x

558
00:20:41,200 --> 00:20:42,799
509 certificate

559
00:20:42,799 --> 00:20:45,039
patterns of use previously they were

560
00:20:45,039 --> 00:20:45,840
using

561
00:20:45,840 --> 00:20:50,320
a issuer and subject of domain.com

562
00:20:50,320 --> 00:20:53,600
and vpn for the common names and

563
00:20:53,600 --> 00:20:56,880
the certificate attributes

564
00:20:56,880 --> 00:20:58,720
now they're using common names that are

565
00:20:58,720 --> 00:21:00,159
prevalent services of

566
00:21:00,159 --> 00:21:03,360
online companies

567
00:21:03,360 --> 00:21:05,280
we don't have full details as to why

568
00:21:05,280 --> 00:21:07,760
they made this change

569
00:21:07,760 --> 00:21:10,080
in summary the apt-27 actors are not

570
00:21:10,080 --> 00:21:11,440
subtle

571
00:21:11,440 --> 00:21:13,360
in this paper we revealed multiple high

572
00:21:13,360 --> 00:21:16,480
confidence indicators of abt27 activity

573
00:21:16,480 --> 00:21:18,400
including ip addresses x 509

574
00:21:18,400 --> 00:21:20,480
certificates and details of x 509

575
00:21:20,480 --> 00:21:21,440
certificates

576
00:21:21,440 --> 00:21:22,720
as well as several ports and

577
00:21:22,720 --> 00:21:24,640
communication techniques in use by the

578
00:21:24,640 --> 00:21:26,559
actors

579
00:21:26,559 --> 00:21:28,960
we reveal that their preferred method of

580
00:21:28,960 --> 00:21:30,000
management activity

581
00:21:30,000 --> 00:21:33,679
is to create a series of vpn nodes

582
00:21:33,679 --> 00:21:36,159
and at the end of that the ssh out from

583
00:21:36,159 --> 00:21:38,080
those vpn nodes to manage

584
00:21:38,080 --> 00:21:40,480
their controllers as well as for forward

585
00:21:40,480 --> 00:21:42,640
compromise activity

586
00:21:42,640 --> 00:21:44,640
we also reveal certain characteristics

587
00:21:44,640 --> 00:21:46,559
of their victimology

588
00:21:46,559 --> 00:21:48,080
we can confirm that they do target the

589
00:21:48,080 --> 00:21:49,679
middle east but they also target parts

590
00:21:49,679 --> 00:21:52,480
of europe and parts of asia

591
00:21:52,480 --> 00:21:54,400
finally we also talk about how the

592
00:21:54,400 --> 00:21:55,840
kittens caught the pandas

593
00:21:55,840 --> 00:22:00,240
but in the end the pandas came back

594
00:22:00,240 --> 00:22:02,159
this level of understanding about actor

595
00:22:02,159 --> 00:22:04,159
activity this ability to narrate the

596
00:22:04,159 --> 00:22:06,159
entire story

597
00:22:06,159 --> 00:22:12,000
this is cyber field awareness

598
00:22:12,000 --> 00:22:13,200
you for listening thank you for the

599
00:22:13,200 --> 00:22:15,200
opportunity thank you for having us

600
00:22:15,200 --> 00:22:18,559
thanks for inviting us and thanks for

601
00:22:23,080 --> 00:22:26,080
watching

