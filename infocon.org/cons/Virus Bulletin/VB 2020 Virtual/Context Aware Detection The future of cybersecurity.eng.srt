1
00:00:08,400 --> 00:00:10,480
hello and welcome to various bulletin

2
00:00:10,480 --> 00:00:12,639
2020 thank you for tuning in to our

3
00:00:12,639 --> 00:00:13,440
presentation

4
00:00:13,440 --> 00:00:15,839
on context or detection the future of

5
00:00:15,839 --> 00:00:17,119
cyber security

6
00:00:17,119 --> 00:00:19,119
i'm your host rohit cookies and

7
00:00:19,119 --> 00:00:21,119
refreshments will be on the left

8
00:00:21,119 --> 00:00:23,279
or wherever your kitchen is if you don't

9
00:00:23,279 --> 00:00:24,960
have any don't worry we'll try to make

10
00:00:24,960 --> 00:00:26,640
this engaging enough so you won't need

11
00:00:26,640 --> 00:00:27,279
them

12
00:00:27,279 --> 00:00:29,840
so we'll be talking a little bit about

13
00:00:29,840 --> 00:00:31,519
current detection methods how

14
00:00:31,519 --> 00:00:32,960
anti-viruses function

15
00:00:32,960 --> 00:00:35,360
modern threats a little bit about the

16
00:00:35,360 --> 00:00:36,480
current state of things

17
00:00:36,480 --> 00:00:38,559
and then we'll talk about context aware

18
00:00:38,559 --> 00:00:40,000
detection technology

19
00:00:40,000 --> 00:00:42,480
and how things might look in the future

20
00:00:42,480 --> 00:00:44,079
and how we might be able to solve

21
00:00:44,079 --> 00:00:45,920
the challenges or the technical

22
00:00:45,920 --> 00:00:47,760
challenges that are facing the industry

23
00:00:47,760 --> 00:00:48,320
today

24
00:00:48,320 --> 00:00:50,960
before we dive in a little bit about me

25
00:00:50,960 --> 00:00:52,239
some of you may know me

26
00:00:52,239 --> 00:00:54,800
as leo from the pc security channel

27
00:00:54,800 --> 00:00:56,960
that's the name i go by online

28
00:00:56,960 --> 00:01:00,239
i quite enjoy flying gliding when i can

29
00:01:00,239 --> 00:01:02,480
in real life when i can't i do it in

30
00:01:02,480 --> 00:01:04,559
microsoft flight simulator there's my

31
00:01:04,559 --> 00:01:06,479
youtube silver play button

32
00:01:06,479 --> 00:01:08,400
i also love academics that's the

33
00:01:08,400 --> 00:01:10,400
university of nottingham i currently

34
00:01:10,400 --> 00:01:12,159
work with the ingenuity lab there

35
00:01:12,159 --> 00:01:14,320
and a bonus fun fact i wanted to be a

36
00:01:14,320 --> 00:01:16,479
paleontologist when i was a little kid

37
00:01:16,479 --> 00:01:19,280
and now instead of digging up dinosaurs

38
00:01:19,280 --> 00:01:20,720
i dig up malware

39
00:01:20,720 --> 00:01:22,720
interesting transformation hey know a

40
00:01:22,720 --> 00:01:25,360
little bit about the pc security channel

41
00:01:25,360 --> 00:01:27,119
which some of you may have heard of you

42
00:01:27,119 --> 00:01:28,479
might have come across this if you've

43
00:01:28,479 --> 00:01:29,119
been looking

44
00:01:29,119 --> 00:01:31,920
at av reviews or tasks or videos on

45
00:01:31,920 --> 00:01:32,960
cyber security

46
00:01:32,960 --> 00:01:34,640
we're one of the most popular cyber

47
00:01:34,640 --> 00:01:36,400
security channels on youtube

48
00:01:36,400 --> 00:01:38,960
we're also a business based in london

49
00:01:38,960 --> 00:01:41,520
and we do consulting for enterprises to

50
00:01:41,520 --> 00:01:43,280
help them improve their cyber security

51
00:01:43,280 --> 00:01:44,799
standing we also work with av

52
00:01:44,799 --> 00:01:46,960
companies and partners on interesting

53
00:01:46,960 --> 00:01:48,479
cyber security projects

54
00:01:48,479 --> 00:01:50,640
we also create a lot of educational

55
00:01:50,640 --> 00:01:52,320
content so if you're interested in that

56
00:01:52,320 --> 00:01:53,119
kind of thing

57
00:01:53,119 --> 00:01:55,439
feel free to check it out now a bit of a

58
00:01:55,439 --> 00:01:57,360
prelude i like to start things off with

59
00:01:57,360 --> 00:01:58,240
a quote

60
00:01:58,240 --> 00:02:00,159
so since we're talking about context i

61
00:02:00,159 --> 00:02:02,479
went with this one from michael crichton

62
00:02:02,479 --> 00:02:04,640
in the information society nobody thinks

63
00:02:04,640 --> 00:02:06,560
we expected to banish paper but we

64
00:02:06,560 --> 00:02:08,399
actually vanished thought some of you

65
00:02:08,399 --> 00:02:10,080
may be familiar with michael creighton

66
00:02:10,080 --> 00:02:11,038
as the author

67
00:02:11,038 --> 00:02:13,760
of jurassic park you may know the novel

68
00:02:13,760 --> 00:02:14,959
you almost certainly

69
00:02:14,959 --> 00:02:16,640
know the movie and i think what he's

70
00:02:16,640 --> 00:02:18,879
referencing here is the fact that we get

71
00:02:18,879 --> 00:02:19,520
so much of

72
00:02:19,520 --> 00:02:21,599
our information through other sources

73
00:02:21,599 --> 00:02:23,360
and we're constantly in these feedback

74
00:02:23,360 --> 00:02:25,040
loops or echo chambers

75
00:02:25,040 --> 00:02:26,560
the current world sets so many

76
00:02:26,560 --> 00:02:29,360
expectations on us in certain situations

77
00:02:29,360 --> 00:02:29,840
that

78
00:02:29,840 --> 00:02:32,480
we don't really stop to think we're just

79
00:02:32,480 --> 00:02:34,720
expected to think a certain way or to

80
00:02:34,720 --> 00:02:36,480
act a certain way based on that

81
00:02:36,480 --> 00:02:38,160
and so going back to the first

82
00:02:38,160 --> 00:02:40,000
principles and thinking from there is

83
00:02:40,000 --> 00:02:40,959
something that

84
00:02:40,959 --> 00:02:43,840
is lacking in many cases hopefully as we

85
00:02:43,840 --> 00:02:44,879
go through the talk

86
00:02:44,879 --> 00:02:47,680
um we'll kind of tie into the relevance

87
00:02:47,680 --> 00:02:48,319
of this

88
00:02:48,319 --> 00:02:51,120
here's a bit of a joke about context so

89
00:02:51,120 --> 00:02:53,440
scientist says my findings are pointless

90
00:02:53,440 --> 00:02:55,280
when taken out of context

91
00:02:55,280 --> 00:02:57,840
correction published by media scientists

92
00:02:57,840 --> 00:02:58,560
claims

93
00:02:58,560 --> 00:03:01,840
findings are pointless now the point

94
00:03:01,840 --> 00:03:03,760
here is not to bash on media in any

95
00:03:03,760 --> 00:03:05,200
sense but just to point out that

96
00:03:05,200 --> 00:03:07,599
sometimes when we're lacking context

97
00:03:07,599 --> 00:03:09,599
it's really difficult for us to notice

98
00:03:09,599 --> 00:03:12,080
it even when it's pointed out to us

99
00:03:12,080 --> 00:03:13,760
with that let's start talking about

100
00:03:13,760 --> 00:03:15,440
modern cyber threats so what are the

101
00:03:15,440 --> 00:03:17,040
challenges we're facing today

102
00:03:17,040 --> 00:03:20,080
we're facing flawless malware zero day

103
00:03:20,080 --> 00:03:20,879
attacks

104
00:03:20,879 --> 00:03:23,120
in many cases targeted attacks where

105
00:03:23,120 --> 00:03:25,280
attackers have already researched

106
00:03:25,280 --> 00:03:27,680
how to get into a specific organization

107
00:03:27,680 --> 00:03:29,200
that they want to get into

108
00:03:29,200 --> 00:03:31,040
for their financially motivated

109
00:03:31,040 --> 00:03:32,560
malicious operation

110
00:03:32,560 --> 00:03:35,360
hacked systems something that is

111
00:03:35,360 --> 00:03:36,159
typically

112
00:03:36,159 --> 00:03:39,360
outside the purview of anti-virus data

113
00:03:39,360 --> 00:03:41,680
breaches we all hate these right because

114
00:03:41,680 --> 00:03:43,680
when a large company has a data breach

115
00:03:43,680 --> 00:03:45,760
it's like your email is probably there

116
00:03:45,760 --> 00:03:47,840
too

117
00:03:47,920 --> 00:03:50,319
stolen credentials this ties into things

118
00:03:50,319 --> 00:03:51,680
like social engineering

119
00:03:51,680 --> 00:03:53,599
which has become a very common word in

120
00:03:53,599 --> 00:03:55,280
cyber security these days

121
00:03:55,280 --> 00:03:58,080
we've also got apts advanced persistent

122
00:03:58,080 --> 00:03:58,560
threats

123
00:03:58,560 --> 00:04:00,480
where we have attackers with significant

124
00:04:00,480 --> 00:04:01,599
resources

125
00:04:01,599 --> 00:04:03,680
that are highly motivated to break into

126
00:04:03,680 --> 00:04:04,640
certain systems

127
00:04:04,640 --> 00:04:07,280
and in many cases modern detection

128
00:04:07,280 --> 00:04:08,319
technology is

129
00:04:08,319 --> 00:04:10,000
powerless to stop these threats or at

130
00:04:10,000 --> 00:04:11,680
least stop them fast enough

131
00:04:11,680 --> 00:04:14,640
to be effective in preventing any damage

132
00:04:14,640 --> 00:04:15,599
and meanwhile

133
00:04:15,599 --> 00:04:18,880
i came across this file on first total

134
00:04:18,880 --> 00:04:21,358
that all it did was created a pop-up

135
00:04:21,358 --> 00:04:23,199
that said happy birthday dad

136
00:04:23,199 --> 00:04:24,960
probably made by a kid who just learned

137
00:04:24,960 --> 00:04:27,520
how to code and it's detected by 25

138
00:04:27,520 --> 00:04:30,800
engines on versatile and i think this is

139
00:04:30,800 --> 00:04:32,720
why a lot of modern users

140
00:04:32,720 --> 00:04:35,520
are disillusioned with antivirus

141
00:04:35,520 --> 00:04:36,240
programs

142
00:04:36,240 --> 00:04:38,240
not necessarily because they don't like

143
00:04:38,240 --> 00:04:40,479
detection technology or they don't like

144
00:04:40,479 --> 00:04:42,320
the idea of an antivirus

145
00:04:42,320 --> 00:04:44,160
but because they think well if i'm going

146
00:04:44,160 --> 00:04:46,639
to be hit by something that's bad enough

147
00:04:46,639 --> 00:04:48,320
the antivirus won't be able to protect

148
00:04:48,320 --> 00:04:50,479
me anyway and if not

149
00:04:50,479 --> 00:04:53,840
all it's going to be is a hindrance

150
00:04:53,840 --> 00:04:55,759
it's going to take up resources it's

151
00:04:55,759 --> 00:04:57,360
gonna create annoying pop-ups

152
00:04:57,360 --> 00:05:00,240
and the trade-off is not really worth it

153
00:05:00,240 --> 00:05:02,320
especially with every system now coming

154
00:05:02,320 --> 00:05:03,600
with windows defender

155
00:05:03,600 --> 00:05:05,199
and browsers stepping up their

156
00:05:05,199 --> 00:05:06,960
protection game too so it's not like you

157
00:05:06,960 --> 00:05:08,240
have no protection

158
00:05:08,240 --> 00:05:10,560
even if you don't use any cyber security

159
00:05:10,560 --> 00:05:12,240
products that are specifically designed

160
00:05:12,240 --> 00:05:12,800
for it

161
00:05:12,800 --> 00:05:14,400
and when we get down to it i think it's

162
00:05:14,400 --> 00:05:16,160
very important to understand that

163
00:05:16,160 --> 00:05:17,199
usability is

164
00:05:17,199 --> 00:05:20,000
a major concern and users are often

165
00:05:20,000 --> 00:05:22,479
unwilling to trade in their freedoms

166
00:05:22,479 --> 00:05:26,160
for protection now let's take a look at

167
00:05:26,160 --> 00:05:28,240
some modern detection parameters what do

168
00:05:28,240 --> 00:05:30,080
we use to detect malware today

169
00:05:30,080 --> 00:05:32,560
and how does it work so a common one is

170
00:05:32,560 --> 00:05:34,400
digital signatures now some

171
00:05:34,400 --> 00:05:36,479
solutions rely on this more heavily than

172
00:05:36,479 --> 00:05:37,600
others

173
00:05:37,600 --> 00:05:40,479
then we have import dlls and functions

174
00:05:40,479 --> 00:05:43,520
the libraries that a program imports

175
00:05:43,520 --> 00:05:46,720
import hash all that stuff packing

176
00:05:46,720 --> 00:05:47,600
techniques

177
00:05:47,600 --> 00:05:50,800
some solutions will detect software

178
00:05:50,800 --> 00:05:52,080
that's packed a certain way

179
00:05:52,080 --> 00:05:53,919
or an exe file that's packed a certain

180
00:05:53,919 --> 00:05:55,919
way strings related to the use of

181
00:05:55,919 --> 00:05:56,960
certain calls

182
00:05:56,960 --> 00:06:00,160
especially things like encryption vss

183
00:06:00,160 --> 00:06:00,880
admin

184
00:06:00,880 --> 00:06:02,800
if they're noticed in a program

185
00:06:02,800 --> 00:06:04,880
typically they will trigger detections

186
00:06:04,880 --> 00:06:08,000
file entropy is again a common parameter

187
00:06:08,000 --> 00:06:10,960
especially for certain sections section

188
00:06:10,960 --> 00:06:11,520
ranges

189
00:06:11,520 --> 00:06:13,759
all of these are just further indicators

190
00:06:13,759 --> 00:06:16,800
of different types of packing

191
00:06:16,800 --> 00:06:20,240
tls features and the question is

192
00:06:20,240 --> 00:06:22,880
what do any of these have to do with

193
00:06:22,880 --> 00:06:24,080
indicating whether or not

194
00:06:24,080 --> 00:06:26,479
a file is malicious i mean a file not

195
00:06:26,479 --> 00:06:27,919
having a digital signature

196
00:06:27,919 --> 00:06:30,479
does not mean it's malicious in any

197
00:06:30,479 --> 00:06:32,240
sense neither does the use of certain

198
00:06:32,240 --> 00:06:34,160
dlls or functions or

199
00:06:34,160 --> 00:06:36,319
packing techniques maybe it implies that

200
00:06:36,319 --> 00:06:38,240
the file is trying to hide something

201
00:06:38,240 --> 00:06:40,479
or is designed a certain way but none of

202
00:06:40,479 --> 00:06:42,479
these really fundamentally have anything

203
00:06:42,479 --> 00:06:43,759
to do with malice

204
00:06:43,759 --> 00:06:45,440
so the question is why do we use them

205
00:06:45,440 --> 00:06:47,680
the answer is well because they work

206
00:06:47,680 --> 00:06:48,880
because that's what the malicious

207
00:06:48,880 --> 00:06:50,800
authors have used in the past and that's

208
00:06:50,800 --> 00:06:51,520
what we see

209
00:06:51,520 --> 00:06:53,759
in most malware so we realize that if we

210
00:06:53,759 --> 00:06:55,840
use these kinds of parameters we're able

211
00:06:55,840 --> 00:06:57,199
to detect

212
00:06:57,199 --> 00:06:59,120
malware in a reasonable enough way and

213
00:06:59,120 --> 00:07:00,800
that's why we use them

214
00:07:00,800 --> 00:07:03,039
now this brings us to whether or not

215
00:07:03,039 --> 00:07:04,240
this is proactive

216
00:07:04,240 --> 00:07:07,680
as an approach or is it reactive and

217
00:07:07,680 --> 00:07:09,599
while a lot of solutions are proactive

218
00:07:09,599 --> 00:07:11,280
in the sense that they block threats

219
00:07:11,280 --> 00:07:13,280
before they execute or they actively

220
00:07:13,280 --> 00:07:14,560
look for threats

221
00:07:14,560 --> 00:07:16,800
the technique behind finding the threat

222
00:07:16,800 --> 00:07:19,199
itself is actually quite reactive

223
00:07:19,199 --> 00:07:22,560
the current state is malware performs a

224
00:07:22,560 --> 00:07:24,080
certain behavior

225
00:07:24,080 --> 00:07:27,039
analysts research malware they notice

226
00:07:27,039 --> 00:07:27,840
that okay

227
00:07:27,840 --> 00:07:29,840
this is how the malware got into the

228
00:07:29,840 --> 00:07:32,560
system this family does this that family

229
00:07:32,560 --> 00:07:33,199
does that

230
00:07:33,199 --> 00:07:34,800
and then they create a detection

231
00:07:34,800 --> 00:07:36,880
strategy based on what they see

232
00:07:36,880 --> 00:07:38,639
after researching the malware and

233
00:07:38,639 --> 00:07:40,400
understanding its behavior

234
00:07:40,400 --> 00:07:42,160
and then finally the product is

235
00:07:42,160 --> 00:07:44,160
engineered in a way that it detects that

236
00:07:44,160 --> 00:07:46,879
behavior or that kind of pe metadata as

237
00:07:46,879 --> 00:07:48,000
we saw earlier

238
00:07:48,000 --> 00:07:50,160
then you have rules for detection or

239
00:07:50,160 --> 00:07:52,319
rules for behavior blockers

240
00:07:52,319 --> 00:07:54,160
the problem with this approach is that

241
00:07:54,160 --> 00:07:55,759
eventually the list of malicious

242
00:07:55,759 --> 00:07:57,759
behaviors keeps expanding

243
00:07:57,759 --> 00:08:00,479
so as malicious authors realize that

244
00:08:00,479 --> 00:08:02,080
okay if we have these kinds of

245
00:08:02,080 --> 00:08:04,000
parameters in our application it's going

246
00:08:04,000 --> 00:08:05,680
to be detected by ivs

247
00:08:05,680 --> 00:08:07,840
let's try to do something else let's try

248
00:08:07,840 --> 00:08:09,199
to try a different approach

249
00:08:09,199 --> 00:08:10,960
maybe we shouldn't pack our files this

250
00:08:10,960 --> 00:08:12,960
way and instead pack it that way

251
00:08:12,960 --> 00:08:15,039
and as this cat and mouse chase keeps

252
00:08:15,039 --> 00:08:16,240
happening more and more

253
00:08:16,240 --> 00:08:19,280
parameters get added to detection

254
00:08:19,280 --> 00:08:21,840
and eventually it becomes impossible to

255
00:08:21,840 --> 00:08:22,720
not create

256
00:08:22,720 --> 00:08:25,039
false positives because ultimately any

257
00:08:25,039 --> 00:08:26,720
behavior can be malicious and

258
00:08:26,720 --> 00:08:28,479
as soon as the malicious authors start

259
00:08:28,479 --> 00:08:30,639
using it you have to detect it

260
00:08:30,639 --> 00:08:32,799
so what do we do about this whole false

261
00:08:32,799 --> 00:08:34,080
positive problem

262
00:08:34,080 --> 00:08:37,200
well here's a great solution let's

263
00:08:37,200 --> 00:08:41,200
whitelist all the save files

264
00:08:41,200 --> 00:08:43,120
which is what a lot of solutions do to

265
00:08:43,120 --> 00:08:45,279
begin with they just have an application

266
00:08:45,279 --> 00:08:47,120
whitelist and if an application's not in

267
00:08:47,120 --> 00:08:49,040
that well it's blocked regardless of

268
00:08:49,040 --> 00:08:50,640
whether or not it's a prompt created by

269
00:08:50,640 --> 00:08:51,200
your son

270
00:08:51,200 --> 00:08:53,040
to wish you happy birthday doesn't

271
00:08:53,040 --> 00:08:55,040
matter it's not digitally signed it's

272
00:08:55,040 --> 00:08:57,120
not from the list of approved vendors

273
00:08:57,120 --> 00:08:59,040
it's blocked

274
00:08:59,040 --> 00:09:01,680
and we're back to square one so all of

275
00:09:01,680 --> 00:09:03,519
this detection technology that we've

276
00:09:03,519 --> 00:09:04,480
developed

277
00:09:04,480 --> 00:09:06,240
has really not helped if we have to

278
00:09:06,240 --> 00:09:08,240
resort to a white list and if the

279
00:09:08,240 --> 00:09:09,839
application's not in the white list we

280
00:09:09,839 --> 00:09:11,360
have to throw up a prompt saying hey

281
00:09:11,360 --> 00:09:12,959
user do you want to execute this

282
00:09:12,959 --> 00:09:14,000
application

283
00:09:14,000 --> 00:09:15,600
so in light of these problems i think

284
00:09:15,600 --> 00:09:17,040
it's important to go back to first

285
00:09:17,040 --> 00:09:19,360
principles and actually ask the question

286
00:09:19,360 --> 00:09:21,920
what is malware and i've got another

287
00:09:21,920 --> 00:09:22,640
quote from

288
00:09:22,640 --> 00:09:25,440
elon musk who likes to say that he tends

289
00:09:25,440 --> 00:09:26,880
to approach things from physics

290
00:09:26,880 --> 00:09:27,519
framework

291
00:09:27,519 --> 00:09:29,680
and physics teaches you to reason from

292
00:09:29,680 --> 00:09:32,720
first principles rather than by analogy

293
00:09:32,720 --> 00:09:36,000
so malware is shorthand for

294
00:09:36,000 --> 00:09:38,320
malicious software and the key word here

295
00:09:38,320 --> 00:09:40,000
is malicious

296
00:09:40,000 --> 00:09:42,560
which means characterized by malice

297
00:09:42,560 --> 00:09:44,160
intending to do harm

298
00:09:44,160 --> 00:09:45,680
and if we try to get to the bottom of

299
00:09:45,680 --> 00:09:47,440
this the key thing here

300
00:09:47,440 --> 00:09:50,720
is intent so what exactly is malicious

301
00:09:50,720 --> 00:09:51,360
behavior

302
00:09:51,360 --> 00:09:53,600
well transferring data to a server isn't

303
00:09:53,600 --> 00:09:54,640
malicious

304
00:09:54,640 --> 00:09:57,519
info stealers are crypto mining isn't

305
00:09:57,519 --> 00:09:58,800
malicious

306
00:09:58,800 --> 00:10:01,120
solid cryptominers that do it without

307
00:10:01,120 --> 00:10:02,160
the user's consent

308
00:10:02,160 --> 00:10:05,120
are fall encryption isn't malicious in

309
00:10:05,120 --> 00:10:07,360
fact it's a security feature

310
00:10:07,360 --> 00:10:10,399
but ransomware is and what makes all of

311
00:10:10,399 --> 00:10:11,920
these behaviors malicious

312
00:10:11,920 --> 00:10:14,880
is context without that it is impossible

313
00:10:14,880 --> 00:10:15,440
to tell

314
00:10:15,440 --> 00:10:17,920
if a certain operation is malicious or

315
00:10:17,920 --> 00:10:18,560
not

316
00:10:18,560 --> 00:10:20,160
because it's not like malware does

317
00:10:20,160 --> 00:10:22,000
something that's fundamentally different

318
00:10:22,000 --> 00:10:24,320
from safe applications it's the intent

319
00:10:24,320 --> 00:10:25,600
that makes it different

320
00:10:25,600 --> 00:10:27,920
i mean we could have a file encryption

321
00:10:27,920 --> 00:10:29,600
application that all it does

322
00:10:29,600 --> 00:10:32,160
is do file encryption one by one and it

323
00:10:32,160 --> 00:10:34,320
asks the user before it does it and it

324
00:10:34,320 --> 00:10:36,399
saves the key so the user can use it to

325
00:10:36,399 --> 00:10:38,399
then restore the files when they want to

326
00:10:38,399 --> 00:10:40,079
it just simply encrypts them and

327
00:10:40,079 --> 00:10:42,399
decrypts them at the user's notice

328
00:10:42,399 --> 00:10:44,880
and that wouldn't be malicious but it

329
00:10:44,880 --> 00:10:45,839
would still have

330
00:10:45,839 --> 00:10:48,480
a lot of the same pe metadata and the

331
00:10:48,480 --> 00:10:50,320
parameters that would be used for

332
00:10:50,320 --> 00:10:50,959
detection

333
00:10:50,959 --> 00:10:52,720
and i often do come across such files

334
00:10:52,720 --> 00:10:55,040
falsely flagged but i'm not here to just

335
00:10:55,040 --> 00:10:56,720
mention the problem because i think a

336
00:10:56,720 --> 00:10:58,880
lot of us are aware that this exists and

337
00:10:58,880 --> 00:10:59,680
especially

338
00:10:59,680 --> 00:11:01,600
i understand the frustrations of

339
00:11:01,600 --> 00:11:03,040
analysts and

340
00:11:03,040 --> 00:11:04,800
researchers trying to detect these

341
00:11:04,800 --> 00:11:06,640
threats trying to find something that

342
00:11:06,640 --> 00:11:07,279
maps

343
00:11:07,279 --> 00:11:10,240
technically to what malicious intent is

344
00:11:10,240 --> 00:11:12,320
and that's a very difficult problem

345
00:11:12,320 --> 00:11:14,160
one that we've tried to explore so i'm

346
00:11:14,160 --> 00:11:15,920
going to talk a little bit about one of

347
00:11:15,920 --> 00:11:17,920
the projects that we're working on right

348
00:11:17,920 --> 00:11:18,720
now which is

349
00:11:18,720 --> 00:11:22,079
malx this is designed to be a cyber

350
00:11:22,079 --> 00:11:23,519
security testing tool

351
00:11:23,519 --> 00:11:26,560
that also is able to analyze files and

352
00:11:26,560 --> 00:11:28,959
have a lot more functionality so here's

353
00:11:28,959 --> 00:11:31,600
a little bit about how malex works

354
00:11:31,600 --> 00:11:33,920
it's designed to just launch the

355
00:11:33,920 --> 00:11:35,360
suspected malware

356
00:11:35,360 --> 00:11:37,839
gather these pe metadata for static

357
00:11:37,839 --> 00:11:39,600
analysis look at the same kinds of

358
00:11:39,600 --> 00:11:41,519
parameters that we mentioned earlier

359
00:11:41,519 --> 00:11:43,839
and then perform dynamic analysis based

360
00:11:43,839 --> 00:11:45,440
on the program's behavior

361
00:11:45,440 --> 00:11:47,760
and test the system cyber security and

362
00:11:47,760 --> 00:11:49,920
also help us classify the malware

363
00:11:49,920 --> 00:11:51,680
which is supposed to be an interactive

364
00:11:51,680 --> 00:11:53,839
process where you take into account what

365
00:11:53,839 --> 00:11:55,120
the user says as well

366
00:11:55,120 --> 00:11:57,200
one of the experiments we tried with

367
00:11:57,200 --> 00:11:59,680
malex was to classify files

368
00:11:59,680 --> 00:12:02,560
into pups malware and most importantly

369
00:12:02,560 --> 00:12:03,680
irrelevant data

370
00:12:03,680 --> 00:12:05,920
the reason for this was every time we

371
00:12:05,920 --> 00:12:08,240
try to test with certain types of feeds

372
00:12:08,240 --> 00:12:10,639
we encounter a lot of files that are

373
00:12:10,639 --> 00:12:13,279
just falsely flagged just broken files

374
00:12:13,279 --> 00:12:14,800
that are detected as malware

375
00:12:14,800 --> 00:12:16,959
or files that are just benign but

376
00:12:16,959 --> 00:12:18,800
because they have certain strings or

377
00:12:18,800 --> 00:12:20,480
certain kinds of references

378
00:12:20,480 --> 00:12:22,399
most products will flag them and they

379
00:12:22,399 --> 00:12:23,600
end up in our feeds

380
00:12:23,600 --> 00:12:26,240
so we try to solve the problem ourselves

381
00:12:26,240 --> 00:12:27,839
you want to classify things

382
00:12:27,839 --> 00:12:30,320
either it's a pup where it's like it's a

383
00:12:30,320 --> 00:12:31,839
setup application

384
00:12:31,839 --> 00:12:33,839
it might be malicious but it doesn't do

385
00:12:33,839 --> 00:12:35,600
anything malicious directly

386
00:12:35,600 --> 00:12:38,240
and then malware as something that's a

387
00:12:38,240 --> 00:12:39,680
pure threat to the user

388
00:12:39,680 --> 00:12:42,000
and just separate out all sorts of other

389
00:12:42,000 --> 00:12:42,720
garbage

390
00:12:42,720 --> 00:12:44,880
here's a quick screenshot of the actual

391
00:12:44,880 --> 00:12:46,560
application running at the moment it's

392
00:12:46,560 --> 00:12:48,560
just a python script we've tried to keep

393
00:12:48,560 --> 00:12:51,200
it relatively high level and also

394
00:12:51,200 --> 00:12:53,519
the purpose of using python is that it's

395
00:12:53,519 --> 00:12:55,440
interpretive so it's very easy to

396
00:12:55,440 --> 00:12:57,760
change or modify depending on what we

397
00:12:57,760 --> 00:12:59,800
see so the question of how we make the

398
00:12:59,800 --> 00:13:02,240
classifications brings us back to what

399
00:13:02,240 --> 00:13:03,760
makes a file malware

400
00:13:03,760 --> 00:13:06,000
i think we can boil it down to basic

401
00:13:06,000 --> 00:13:08,240
questions like does it perform actions

402
00:13:08,240 --> 00:13:10,079
that result in a detrimental

403
00:13:10,079 --> 00:13:12,639
outcome for the user does it perform

404
00:13:12,639 --> 00:13:14,959
these actions without the user's consent

405
00:13:14,959 --> 00:13:17,120
does it hide itself partially or

406
00:13:17,120 --> 00:13:20,320
completely from the user

407
00:13:20,320 --> 00:13:22,959
and then we come to this realization

408
00:13:22,959 --> 00:13:23,680
that

409
00:13:23,680 --> 00:13:26,000
a file isn't really malware it's the

410
00:13:26,000 --> 00:13:28,320
user interaction with the program

411
00:13:28,320 --> 00:13:30,079
that determines whether or not something

412
00:13:30,079 --> 00:13:32,240
is malware as i mentioned earlier

413
00:13:32,240 --> 00:13:34,800
you could perfectly have a program that

414
00:13:34,800 --> 00:13:36,160
does 90 percent

415
00:13:36,160 --> 00:13:38,560
of what ransomware does which is encrypt

416
00:13:38,560 --> 00:13:39,360
files

417
00:13:39,360 --> 00:13:41,360
but if it interacts with the user in a

418
00:13:41,360 --> 00:13:42,880
different way instead of saying hey

419
00:13:42,880 --> 00:13:45,199
pay us ransom to get your files back if

420
00:13:45,199 --> 00:13:47,120
it says here's your program here's your

421
00:13:47,120 --> 00:13:48,160
security key

422
00:13:48,160 --> 00:13:50,480
use the key to get your files then it's

423
00:13:50,480 --> 00:13:52,399
not malware anymore it's just a security

424
00:13:52,399 --> 00:13:54,320
program that the user can use to lock

425
00:13:54,320 --> 00:13:55,040
their files

426
00:13:55,040 --> 00:13:57,040
and the fact that user interaction is

427
00:13:57,040 --> 00:13:58,800
rarely talked about when discussing

428
00:13:58,800 --> 00:14:01,120
malware or how to detect malware i think

429
00:14:01,120 --> 00:14:02,240
is a major problem

430
00:14:02,240 --> 00:14:05,839
because without it you can't really tell

431
00:14:05,839 --> 00:14:08,079
and we're just classing programs based

432
00:14:08,079 --> 00:14:09,360
on their functionality

433
00:14:09,360 --> 00:14:11,680
and assuming that a regular user just

434
00:14:11,680 --> 00:14:13,519
wouldn't need the kinds of things that

435
00:14:13,519 --> 00:14:14,959
malware does which is

436
00:14:14,959 --> 00:14:17,680
i mean untrue and also as mentioned it

437
00:14:17,680 --> 00:14:19,600
leads us into the whole

438
00:14:19,600 --> 00:14:21,839
spiral of doom where it's like malware

439
00:14:21,839 --> 00:14:23,040
authors just realize

440
00:14:23,040 --> 00:14:25,519
okay so a regular user does this this

441
00:14:25,519 --> 00:14:27,120
and this and they find a way to write

442
00:14:27,120 --> 00:14:29,360
malware using those operations that

443
00:14:29,360 --> 00:14:32,079
you just can't block or the other way

444
00:14:32,079 --> 00:14:32,560
around

445
00:14:32,560 --> 00:14:33,920
you just end up blocking all the

446
00:14:33,920 --> 00:14:35,760
operations but then you have to rely on

447
00:14:35,760 --> 00:14:36,800
a white list

448
00:14:36,800 --> 00:14:38,880
which makes the entire detection

449
00:14:38,880 --> 00:14:41,680
technology irrelevant anyway

450
00:14:41,680 --> 00:14:43,920
and so what i want to do is present some

451
00:14:43,920 --> 00:14:45,920
of the parameters that we used

452
00:14:45,920 --> 00:14:48,000
to classify our malware in the hopes

453
00:14:48,000 --> 00:14:49,839
that maybe some of these are going to be

454
00:14:49,839 --> 00:14:50,639
useful for

455
00:14:50,639 --> 00:14:52,480
detection and i think more and more

456
00:14:52,480 --> 00:14:54,480
products might rely on such

457
00:14:54,480 --> 00:14:56,560
parameters that are more indicative of

458
00:14:56,560 --> 00:14:57,680
user interaction

459
00:14:57,680 --> 00:14:59,839
in the future but let's go over a case

460
00:14:59,839 --> 00:15:01,519
here so let's say an application

461
00:15:01,519 --> 00:15:06,320
is a crypto miner is it malware

462
00:15:06,320 --> 00:15:09,040
we don't know so we have to ask the

463
00:15:09,040 --> 00:15:09,519
question

464
00:15:09,519 --> 00:15:11,600
how does it interact with the user and

465
00:15:11,600 --> 00:15:12,959
we have to look into

466
00:15:12,959 --> 00:15:16,240
what windows it presents does it require

467
00:15:16,240 --> 00:15:18,720
input from the user before mining begins

468
00:15:18,720 --> 00:15:20,800
is it persistent does it have any hidden

469
00:15:20,800 --> 00:15:22,959
components that the user is not aware of

470
00:15:22,959 --> 00:15:26,000
or made aware of

471
00:15:26,000 --> 00:15:28,399
it easy to remove can the user just get

472
00:15:28,399 --> 00:15:29,199
rid of it

473
00:15:29,199 --> 00:15:31,440
just stop it delete it if they want to

474
00:15:31,440 --> 00:15:33,600
or is it something that digs deep into

475
00:15:33,600 --> 00:15:35,839
the system to where you need to have 20

476
00:15:35,839 --> 00:15:37,839
tools to remove it or have to edit the

477
00:15:37,839 --> 00:15:39,120
registry yourself

478
00:15:39,120 --> 00:15:41,759
everything hinges on program user

479
00:15:41,759 --> 00:15:42,560
interaction

480
00:15:42,560 --> 00:15:44,959
and i purposefully presented all of

481
00:15:44,959 --> 00:15:45,839
these things

482
00:15:45,839 --> 00:15:49,600
in a way that they can be converted into

483
00:15:49,600 --> 00:15:51,839
technical parameters because of course

484
00:15:51,839 --> 00:15:53,600
as an analyst you will be looking into

485
00:15:53,600 --> 00:15:55,279
all of these things to decide whether or

486
00:15:55,279 --> 00:15:57,279
not a program should be detected but

487
00:15:57,279 --> 00:15:58,959
once you make that decision

488
00:15:58,959 --> 00:16:00,880
we don't have technical parameters that

489
00:16:00,880 --> 00:16:03,199
closely resemble this decision making

490
00:16:03,199 --> 00:16:04,720
process instead we just have a

491
00:16:04,720 --> 00:16:06,639
completely independent process that we

492
00:16:06,639 --> 00:16:08,560
use to generate a detection for this

493
00:16:08,560 --> 00:16:09,279
program

494
00:16:09,279 --> 00:16:11,040
which doesn't really match with the

495
00:16:11,040 --> 00:16:12,720
thought process behind

496
00:16:12,720 --> 00:16:14,320
why the program should be detected in

497
00:16:14,320 --> 00:16:16,160
the first place now everything mentioned

498
00:16:16,160 --> 00:16:16,560
here

499
00:16:16,560 --> 00:16:18,639
windows presented can be monitored

500
00:16:18,639 --> 00:16:20,480
technically input from user

501
00:16:20,480 --> 00:16:22,560
can be monitored persistence hidden

502
00:16:22,560 --> 00:16:24,560
installations and antivirus can look at

503
00:16:24,560 --> 00:16:25,360
this

504
00:16:25,360 --> 00:16:27,920
is it easy to remove again not very

505
00:16:27,920 --> 00:16:29,839
difficult for an application to look at

506
00:16:29,839 --> 00:16:31,920
and with this i just want to present the

507
00:16:31,920 --> 00:16:33,759
undervalued parameters that we came

508
00:16:33,759 --> 00:16:35,759
across that we found quite useful

509
00:16:35,759 --> 00:16:38,079
and hopefully you're going to find them

510
00:16:38,079 --> 00:16:39,120
quite useful as well

511
00:16:39,120 --> 00:16:41,519
when trying to detect malware

512
00:16:41,519 --> 00:16:42,880
screenshots

513
00:16:42,880 --> 00:16:44,160
everything that's happening on the

514
00:16:44,160 --> 00:16:45,920
screen you need to know what the user is

515
00:16:45,920 --> 00:16:46,720
looking at

516
00:16:46,720 --> 00:16:49,120
when the program is doing its operations

517
00:16:49,120 --> 00:16:50,079
not necessarily

518
00:16:50,079 --> 00:16:52,160
in perfect detail you don't have to

519
00:16:52,160 --> 00:16:54,079
completely give up privacy but

520
00:16:54,079 --> 00:16:55,600
you need to have some idea of what

521
00:16:55,600 --> 00:16:57,199
applications are open does it even

522
00:16:57,199 --> 00:16:58,160
present a window

523
00:16:58,160 --> 00:16:59,519
and some of this data you can get

524
00:16:59,519 --> 00:17:01,360
without screenshots you can just look at

525
00:17:01,360 --> 00:17:02,800
the windows that are open

526
00:17:02,800 --> 00:17:05,119
number of windows and all of this can be

527
00:17:05,119 --> 00:17:06,480
easily monitored

528
00:17:06,480 --> 00:17:08,799
window titles what does the application

529
00:17:08,799 --> 00:17:10,799
say is being presented to the user does

530
00:17:10,799 --> 00:17:11,599
it say that

531
00:17:11,599 --> 00:17:14,480
cryptominer x is the window and it shows

532
00:17:14,480 --> 00:17:15,919
something or is it

533
00:17:15,919 --> 00:17:17,919
a completely different window that says

534
00:17:17,919 --> 00:17:19,119
something else

535
00:17:19,119 --> 00:17:21,520
user input does the user interact with

536
00:17:21,520 --> 00:17:22,480
the application

537
00:17:22,480 --> 00:17:24,880
is the user hitting any keys are they

538
00:17:24,880 --> 00:17:26,880
required to click on something before

539
00:17:26,880 --> 00:17:28,400
the application proceeds

540
00:17:28,400 --> 00:17:30,240
or does it just continue without any

541
00:17:30,240 --> 00:17:32,559
user input file handles

542
00:17:32,559 --> 00:17:34,240
what other files are being accessed or

543
00:17:34,240 --> 00:17:35,760
written by the application

544
00:17:35,760 --> 00:17:37,840
what locations does it work with and

545
00:17:37,840 --> 00:17:39,120
what we've observed

546
00:17:39,120 --> 00:17:41,440
with these parameters is that true

547
00:17:41,440 --> 00:17:42,240
trojans

548
00:17:42,240 --> 00:17:44,080
these days are quite uncommon where

549
00:17:44,080 --> 00:17:46,000
applications put a lot of effort

550
00:17:46,000 --> 00:17:48,640
into disguising themselves as legitimate

551
00:17:48,640 --> 00:17:49,360
programs

552
00:17:49,360 --> 00:17:51,360
or they just look like a legitimate

553
00:17:51,360 --> 00:17:52,880
program to the user

554
00:17:52,880 --> 00:17:55,360
but they do something malicious in fact

555
00:17:55,360 --> 00:17:56,559
in most cases

556
00:17:56,559 --> 00:17:58,400
malicious applications just perform

557
00:17:58,400 --> 00:18:00,320
their actions silently if you have a

558
00:18:00,320 --> 00:18:01,440
hidden back door

559
00:18:01,440 --> 00:18:04,080
or you have a remote access tool mostly

560
00:18:04,080 --> 00:18:06,000
they will just run on a system

561
00:18:06,000 --> 00:18:08,160
dig into some system process or they

562
00:18:08,160 --> 00:18:10,320
will just create registry entry

563
00:18:10,320 --> 00:18:13,280
and do it all silently so maybe we can

564
00:18:13,280 --> 00:18:14,080
framework

565
00:18:14,080 --> 00:18:16,960
a different approach for detection one

566
00:18:16,960 --> 00:18:17,360
where

567
00:18:17,360 --> 00:18:20,240
a new application or process appears and

568
00:18:20,240 --> 00:18:22,400
if it does not notify or interact with

569
00:18:22,400 --> 00:18:23,120
the user

570
00:18:23,120 --> 00:18:25,600
and perform sensitive operations without

571
00:18:25,600 --> 00:18:27,440
permission or notification

572
00:18:27,440 --> 00:18:29,600
leads to a detection now i'm aware that

573
00:18:29,600 --> 00:18:31,200
there are certain behavior blockers that

574
00:18:31,200 --> 00:18:32,720
might be doing something like

575
00:18:32,720 --> 00:18:34,880
this but again i think the key words

576
00:18:34,880 --> 00:18:35,760
here are

577
00:18:35,760 --> 00:18:38,640
the interaction parts does not notify or

578
00:18:38,640 --> 00:18:40,160
interact with the user

579
00:18:40,160 --> 00:18:42,480
perform sensitive operations without

580
00:18:42,480 --> 00:18:43,280
permission

581
00:18:43,280 --> 00:18:45,440
or notification and i think in a lot of

582
00:18:45,440 --> 00:18:46,480
cases what

583
00:18:46,480 --> 00:18:48,880
detection software does is it just says

584
00:18:48,880 --> 00:18:51,039
oh perform sensitive operations

585
00:18:51,039 --> 00:18:53,600
detects it as malware and i think user

586
00:18:53,600 --> 00:18:55,600
interaction is really undervalued here

587
00:18:55,600 --> 00:18:56,080
because

588
00:18:56,080 --> 00:18:58,160
that is really what sets malware apart

589
00:18:58,160 --> 00:19:00,799
from legitimate applications

590
00:19:00,799 --> 00:19:02,960
however i can imagine that some of you

591
00:19:02,960 --> 00:19:04,960
might have been a little bit uneasy when

592
00:19:04,960 --> 00:19:05,600
i mentioned

593
00:19:05,600 --> 00:19:07,600
the use of screenshots for detection

594
00:19:07,600 --> 00:19:09,120
like imagine having your av

595
00:19:09,120 --> 00:19:11,520
program take screenshots every you know

596
00:19:11,520 --> 00:19:13,520
x seconds of your system

597
00:19:13,520 --> 00:19:15,679
that does sound very concerning from a

598
00:19:15,679 --> 00:19:17,760
privacy standpoint and i think that is

599
00:19:17,760 --> 00:19:19,760
why it's going to be very important

600
00:19:19,760 --> 00:19:21,120
moving into the future

601
00:19:21,120 --> 00:19:25,039
that av companies focus on their actual

602
00:19:25,039 --> 00:19:27,120
customers that is the user not on

603
00:19:27,120 --> 00:19:28,400
tertiary benefits

604
00:19:28,400 --> 00:19:31,039
like all the advertising data threat

605
00:19:31,039 --> 00:19:32,640
intelligence etc

606
00:19:32,640 --> 00:19:34,480
with great power comes great

607
00:19:34,480 --> 00:19:37,039
responsibility not originally coined by

608
00:19:37,039 --> 00:19:38,000
peter parker or

609
00:19:38,000 --> 00:19:41,039
spider-man but voltaire said something

610
00:19:41,039 --> 00:19:42,720
similar during the french revolution and

611
00:19:42,720 --> 00:19:43,919
that's probably where the quote

612
00:19:43,919 --> 00:19:44,720
originates

613
00:19:44,720 --> 00:19:47,039
and that is extremely true for antivirus

614
00:19:47,039 --> 00:19:50,240
or any cyber security programs because

615
00:19:50,240 --> 00:19:52,480
at the end of the day you are running at

616
00:19:52,480 --> 00:19:54,880
a system level with a lot of privileges

617
00:19:54,880 --> 00:19:56,400
you're getting to collect a lot of

618
00:19:56,400 --> 00:19:59,039
sensitive data for security purposes

619
00:19:59,039 --> 00:20:02,000
and you just cannot afford to play fast

620
00:20:02,000 --> 00:20:03,200
and loose with it

621
00:20:03,200 --> 00:20:07,120
telemetry to telemarketing no thank you

622
00:20:07,120 --> 00:20:09,200
and i think if we're going to go into a

623
00:20:09,200 --> 00:20:11,360
future where we're going to use a lot

624
00:20:11,360 --> 00:20:12,400
more data

625
00:20:12,400 --> 00:20:14,480
and use the understanding of users

626
00:20:14,480 --> 00:20:16,480
interaction with the program to make

627
00:20:16,480 --> 00:20:18,240
decisions about whether or not something

628
00:20:18,240 --> 00:20:20,320
is malicious we definitely have to stop

629
00:20:20,320 --> 00:20:22,320
using things like that for

630
00:20:22,320 --> 00:20:25,280
marketing purposes av programs also need

631
00:20:25,280 --> 00:20:27,120
to pay attention to vulnerabilities

632
00:20:27,120 --> 00:20:28,080
because

633
00:20:28,080 --> 00:20:30,559
as i mentioned they need a lot of low

634
00:20:30,559 --> 00:20:33,440
level access to the system's operations

635
00:20:33,440 --> 00:20:34,640
and that means if there's a

636
00:20:34,640 --> 00:20:36,799
vulnerability in the av program itself

637
00:20:36,799 --> 00:20:39,200
it becomes a fatal flaw from a cyber

638
00:20:39,200 --> 00:20:40,640
security perspective

639
00:20:40,640 --> 00:20:42,720
and i think trust is going to be a very

640
00:20:42,720 --> 00:20:44,480
important feature for cyber security

641
00:20:44,480 --> 00:20:45,679
products in the future

642
00:20:45,679 --> 00:20:48,000
now some quick credits a big thank you

643
00:20:48,000 --> 00:20:49,280
to the members

644
00:20:49,280 --> 00:20:51,840
of tpsc discord that have really helped

645
00:20:51,840 --> 00:20:53,600
with some of these projects especially

646
00:20:53,600 --> 00:20:54,480
fleur eagle

647
00:20:54,480 --> 00:20:56,880
also a quick shout out to our partners

648
00:20:56,880 --> 00:20:58,080
mcsoft

649
00:20:58,080 --> 00:21:00,000
and a big thank you to you the viewer

650
00:21:00,000 --> 00:21:02,000
for tuning in to this video and making

651
00:21:02,000 --> 00:21:02,880
it this far

652
00:21:02,880 --> 00:21:04,960
if you have any questions feel free to

653
00:21:04,960 --> 00:21:08,000
reach out i'll leave all the information

654
00:21:08,000 --> 00:21:10,559
on screen so you can reach out via email

655
00:21:10,559 --> 00:21:11,520
twitter

656
00:21:11,520 --> 00:21:13,120
whatever you're comfortable you can

657
00:21:13,120 --> 00:21:15,120
check out our website or youtube if you

658
00:21:15,120 --> 00:21:15,760
like

659
00:21:15,760 --> 00:21:17,760
also thank you to verse bulletin for

660
00:21:17,760 --> 00:21:18,799
hosting us

661
00:21:18,799 --> 00:21:29,200
until next time

