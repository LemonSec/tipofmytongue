1
00:00:08,880 --> 00:00:09,760
hello

2
00:00:09,760 --> 00:00:12,559
welcome to this plantation verse built

3
00:00:12,559 --> 00:00:14,920
on 2020.

4
00:00:14,920 --> 00:00:18,800
um today we will talk about the

5
00:00:18,800 --> 00:00:21,199
an incident response that we have to

6
00:00:21,199 --> 00:00:23,519
deal with

7
00:00:23,519 --> 00:00:25,920
from an attacker which is alleged to be

8
00:00:25,920 --> 00:00:26,640
ta

9
00:00:26,640 --> 00:00:30,480
505 so we'll see the case

10
00:00:30,480 --> 00:00:32,960
how we manage incident response the tool

11
00:00:32,960 --> 00:00:33,840
used and

12
00:00:33,840 --> 00:00:37,040
how to find the factors that

13
00:00:37,040 --> 00:00:40,480
currently this group seems to be using

14
00:00:40,480 --> 00:00:43,760
which is the name sdb board so who i am

15
00:00:43,760 --> 00:00:44,480
where are we

16
00:00:44,480 --> 00:00:47,360
i'm paul young i'm leading the incident

17
00:00:47,360 --> 00:00:49,840
restaurants team of excellent services

18
00:00:49,840 --> 00:00:54,640
which is a luxembourgish and belgium

19
00:00:54,640 --> 00:00:57,760
i.t security company

20
00:00:57,760 --> 00:00:59,440
we're doing in response mostly in

21
00:00:59,440 --> 00:01:01,359
belgium example and

22
00:01:01,359 --> 00:01:04,479
some in africa

23
00:01:04,479 --> 00:01:08,080
that's the case so this context is uh

24
00:01:08,080 --> 00:01:11,680
back in december 19

25
00:01:11,680 --> 00:01:14,560
belgian hospitals got some information

26
00:01:14,560 --> 00:01:15,280
from

27
00:01:15,280 --> 00:01:18,960
ioc lists that one of the ioc is

28
00:01:18,960 --> 00:01:19,920
matching

29
00:01:19,920 --> 00:01:23,360
on their fireworks and on some servers

30
00:01:23,360 --> 00:01:23,920
they have

31
00:01:23,920 --> 00:01:26,400
a black screen a command from black as

32
00:01:26,400 --> 00:01:27,600
they find that and some

33
00:01:27,600 --> 00:01:31,200
console so what's happened

34
00:01:31,200 --> 00:01:33,840
the thing is that it's beginning with

35
00:01:33,840 --> 00:01:34,320
some

36
00:01:34,320 --> 00:01:37,520
matching phishing campaign

37
00:01:37,520 --> 00:01:40,159
there are two massive campaign each

38
00:01:40,159 --> 00:01:44,240
delivering to more than 100 mailboxes

39
00:01:44,560 --> 00:01:47,680
the with the campaign are

40
00:01:47,680 --> 00:01:51,360
a week apart and it was injected

41
00:01:51,360 --> 00:01:54,799
by using empty

42
00:01:54,799 --> 00:01:58,240
relay of russian university

43
00:01:58,240 --> 00:02:01,759
so the way it didn't contains any files

44
00:02:01,759 --> 00:02:04,560
it contained only links and an

45
00:02:04,560 --> 00:02:05,920
invitation to one

46
00:02:05,920 --> 00:02:09,440
of what is a sharing file platform it's

47
00:02:09,440 --> 00:02:13,120
like a dropbox for example um

48
00:02:13,120 --> 00:02:16,000
and when the customer click on the link

49
00:02:16,000 --> 00:02:16,959
of course

50
00:02:16,959 --> 00:02:20,160
it is ready redirected to through a

51
00:02:20,160 --> 00:02:21,360
german reduction

52
00:02:21,360 --> 00:02:24,800
minification service and named mercy.d

53
00:02:24,800 --> 00:02:28,239
and finally go back to the

54
00:02:28,239 --> 00:02:31,519
back end which is owned by the attacker

55
00:02:31,519 --> 00:02:35,120
so download the document which is of

56
00:02:35,120 --> 00:02:36,319
course uh

57
00:02:36,319 --> 00:02:39,760
malicious uh document an office one

58
00:02:39,760 --> 00:02:42,160
um what is interesting in this case that

59
00:02:42,160 --> 00:02:43,280
um

60
00:02:43,280 --> 00:02:46,239
the click on the execution of the the

61
00:02:46,239 --> 00:02:46,959
document

62
00:02:46,959 --> 00:02:49,440
was done at 15 days after the fishing

63
00:02:49,440 --> 00:02:50,000
because the guy

64
00:02:50,000 --> 00:02:53,280
was in the holidays and

65
00:02:53,280 --> 00:02:55,519
the cc was still waiting for the click

66
00:02:55,519 --> 00:02:56,560
uh

67
00:02:56,560 --> 00:02:59,920
15 days after so the document contains

68
00:02:59,920 --> 00:03:04,879
uh two of course of vba scripts

69
00:03:04,879 --> 00:03:09,200
and which is interesting to see is that

70
00:03:09,200 --> 00:03:11,040
the document itself contains the

71
00:03:11,040 --> 00:03:12,480
droppers so

72
00:03:12,480 --> 00:03:15,920
there are insights of this document to a

73
00:03:15,920 --> 00:03:18,640
pe a one thirty two bit and one sixty

74
00:03:18,640 --> 00:03:19,280
four one

75
00:03:19,280 --> 00:03:22,560
per byte um and this dropper's name get

76
00:03:22,560 --> 00:03:23,280
two

77
00:03:23,280 --> 00:03:25,920
um depending on the version of the

78
00:03:25,920 --> 00:03:28,720
office so in this case it was a 32-bit

79
00:03:28,720 --> 00:03:32,400
version of uh world the right

80
00:03:32,400 --> 00:03:35,519
dll is called and executed so there is a

81
00:03:35,519 --> 00:03:36,720
decoy

82
00:03:36,720 --> 00:03:39,760
decoy windows during the

83
00:03:39,760 --> 00:03:43,200
execution so once

84
00:03:43,200 --> 00:03:46,640
executed the dropper and i'll get to

85
00:03:46,640 --> 00:03:49,680
reports to another host

86
00:03:49,680 --> 00:03:51,760
it means that it's already the third on

87
00:03:51,760 --> 00:03:53,680
the different website

88
00:03:53,680 --> 00:03:57,280
uh it's reposter hostname the

89
00:03:57,280 --> 00:04:00,879
username of the customer the version of

90
00:04:00,879 --> 00:04:02,319
the operating system

91
00:04:02,319 --> 00:04:05,360
and the list of the running processes

92
00:04:05,360 --> 00:04:08,500
and the configuration is directly

93
00:04:08,500 --> 00:04:10,000
[Music]

94
00:04:10,000 --> 00:04:12,640
it's hardcoded in the data itself so

95
00:04:12,640 --> 00:04:13,280
it's a

96
00:04:13,280 --> 00:04:16,478
part of the executive depending on the

97
00:04:16,478 --> 00:04:19,358
result it's received another payload in

98
00:04:19,358 --> 00:04:20,478
our case

99
00:04:20,478 --> 00:04:22,880
it has a we have some information about

100
00:04:22,880 --> 00:04:24,400
that it's received

101
00:04:24,400 --> 00:04:28,000
an executable named profile3.7.exe we

102
00:04:28,000 --> 00:04:30,320
don't really know what it is

103
00:04:30,320 --> 00:04:33,199
since we didn't achieve to retrieve this

104
00:04:33,199 --> 00:04:33,759
file but

105
00:04:33,759 --> 00:04:36,880
soon after that it installed another

106
00:04:36,880 --> 00:04:38,000
executable which

107
00:04:38,000 --> 00:04:42,080
is sdb board so in our case

108
00:04:42,080 --> 00:04:45,199
sdb boot is the

109
00:04:45,199 --> 00:04:48,400
the backdoor used by the group sd boot

110
00:04:48,400 --> 00:04:49,840
is a fileless malware

111
00:04:49,840 --> 00:04:52,560
it means that well you have a small part

112
00:04:52,560 --> 00:04:53,120
in

113
00:04:53,120 --> 00:04:55,199
an executable under this but in this

114
00:04:55,199 --> 00:04:57,040
executable there is nothing interesting

115
00:04:57,040 --> 00:05:00,240
everything is stored in the registry

116
00:05:00,240 --> 00:05:03,199
the registry location we will see that

117
00:05:03,199 --> 00:05:03,600
is

118
00:05:03,600 --> 00:05:05,759
using a random line in our random

119
00:05:05,759 --> 00:05:07,600
location

120
00:05:07,600 --> 00:05:10,880
and the small executable on the disk

121
00:05:10,880 --> 00:05:14,960
a small pe is only launching it so

122
00:05:14,960 --> 00:05:17,520
it do basically nothing interesting and

123
00:05:17,520 --> 00:05:20,479
it's lower heavy detection

124
00:05:20,479 --> 00:05:23,039
we'll see that every loader is different

125
00:05:23,039 --> 00:05:24,000
by workstation so

126
00:05:24,000 --> 00:05:25,919
it's quite complicated fundamentally

127
00:05:25,919 --> 00:05:28,960
response so how does it works

128
00:05:28,960 --> 00:05:32,880
first the persistence is done simply

129
00:05:32,880 --> 00:05:35,440
by using the current action run key and

130
00:05:35,440 --> 00:05:35,919
there

131
00:05:35,919 --> 00:05:38,639
there is a value random the dealer in

132
00:05:38,639 --> 00:05:40,080
this case it was a x

133
00:05:40,080 --> 00:05:43,199
a b v a g c the dll

134
00:05:43,199 --> 00:05:46,880
and render l is used to execute

135
00:05:46,880 --> 00:05:49,919
this this dll

136
00:05:49,919 --> 00:05:53,600
the dll by itself

137
00:05:53,600 --> 00:05:56,400
contains the configuration of the

138
00:05:56,400 --> 00:05:57,280
location

139
00:05:57,280 --> 00:05:59,840
of the sdb board in the registry it

140
00:05:59,840 --> 00:06:01,280
means it contains

141
00:06:01,280 --> 00:06:04,800
the path in the registry but also

142
00:06:04,800 --> 00:06:08,960
the uid of the user so it's really

143
00:06:08,960 --> 00:06:11,120
if you have a launcher it is unique

144
00:06:11,120 --> 00:06:13,919
prayer user

145
00:06:14,880 --> 00:06:19,440
when the launcher is launched of course

146
00:06:19,440 --> 00:06:23,120
yeah the id gives give to it the link

147
00:06:23,120 --> 00:06:26,240
to the registry path where the

148
00:06:26,240 --> 00:06:29,840
sdb boot is here you can find then

149
00:06:29,840 --> 00:06:32,160
there is a decoy value at the beginning

150
00:06:32,160 --> 00:06:34,000
of the the registry value

151
00:06:34,000 --> 00:06:36,560
and then you have the the launcher so

152
00:06:36,560 --> 00:06:37,039
the

153
00:06:37,039 --> 00:06:40,479
the the devoted uh first you have the

154
00:06:40,479 --> 00:06:43,120
decoy strings then you have a shell code

155
00:06:43,120 --> 00:06:46,160
and a compressed executable

156
00:06:46,160 --> 00:06:48,000
the shell called uncompressing memory

157
00:06:48,000 --> 00:06:49,919
the executable and launch it

158
00:06:49,919 --> 00:06:51,919
the configuration is not obfuscating at

159
00:06:51,919 --> 00:06:54,000
all it's geoclean the pe

160
00:06:54,000 --> 00:06:56,160
uh of course it's compressed but well

161
00:06:56,160 --> 00:06:57,520
it's there so i

162
00:06:57,520 --> 00:07:00,400
will see there is a some place in the

163
00:07:00,400 --> 00:07:01,440
reserved uh

164
00:07:01,440 --> 00:07:04,080
filled by bot safety pot sergey and the

165
00:07:04,080 --> 00:07:05,759
configuration inputs there

166
00:07:05,759 --> 00:07:09,440
the the weather history is

167
00:07:09,440 --> 00:07:11,759
written it's always the same so it's

168
00:07:11,759 --> 00:07:12,560
inch

169
00:07:12,560 --> 00:07:14,639
for a user in the ash key current user

170
00:07:14,639 --> 00:07:16,479
software microsoft then you have three

171
00:07:16,479 --> 00:07:17,520
letters

172
00:07:17,520 --> 00:07:20,560
and then one letter value of

173
00:07:20,560 --> 00:07:24,479
the key so what is sdb board

174
00:07:24,479 --> 00:07:28,960
well it's a back door it shows

175
00:07:28,960 --> 00:07:33,039
in our case but using one common control

176
00:07:33,039 --> 00:07:35,680
it fetched the external ip and report it

177
00:07:35,680 --> 00:07:37,039
once launched

178
00:07:37,039 --> 00:07:41,360
uh it uses a proprietary communication

179
00:07:41,360 --> 00:07:43,840
so it's not http it's not https it's a

180
00:07:43,840 --> 00:07:45,440
binary connection

181
00:07:45,440 --> 00:07:47,520
it's disabled to download file you may

182
00:07:47,520 --> 00:07:48,960
perform file operation

183
00:07:48,960 --> 00:07:51,759
add remove creator folder with a file

184
00:07:51,759 --> 00:07:52,960
and so on

185
00:07:52,960 --> 00:07:56,080
you may execute your execute commands

186
00:07:56,080 --> 00:07:59,440
and stream screen and also which which

187
00:07:59,440 --> 00:08:02,080
we think it was uh evenly used uh

188
00:08:02,080 --> 00:08:04,560
forwarding tcp connection

189
00:08:04,560 --> 00:08:07,840
so what does the attacker

190
00:08:07,840 --> 00:08:10,879
the first thing we see which

191
00:08:10,879 --> 00:08:14,720
appear to be 1 and um 20 minutes after

192
00:08:14,720 --> 00:08:18,160
the first connection of fb bot to the cc

193
00:08:18,160 --> 00:08:21,919
is a ms 1710

194
00:08:21,919 --> 00:08:25,039
tier clay on one domain controller so

195
00:08:25,039 --> 00:08:27,440
well it was quite easy it's a low

196
00:08:27,440 --> 00:08:28,879
hanging fruit

197
00:08:28,879 --> 00:08:32,080
and the attacker is well running a

198
00:08:32,080 --> 00:08:34,080
system in a demand controller

199
00:08:34,080 --> 00:08:37,760
quite fast after the first confirmation

200
00:08:37,760 --> 00:08:42,159
so for persistency i create a user

201
00:08:42,159 --> 00:08:44,000
name support with the password support

202
00:08:44,000 --> 00:08:46,560
with zero that's a bad password

203
00:08:46,560 --> 00:08:50,560
and put it in the admin group

204
00:08:50,560 --> 00:08:52,610
then uh what does

205
00:08:52,610 --> 00:08:53,920
[Music]

206
00:08:53,920 --> 00:08:57,360
that occur mostly he used

207
00:08:57,360 --> 00:09:02,000
two things metapreter and smb exec

208
00:09:02,000 --> 00:09:04,560
we found out some interpreter directly

209
00:09:04,560 --> 00:09:05,760
connected back to

210
00:09:05,760 --> 00:09:09,440
an iep in session

211
00:09:09,440 --> 00:09:12,640
and we also find some metaphor in

212
00:09:12,640 --> 00:09:14,160
listening mode

213
00:09:14,160 --> 00:09:17,600
and he use it as lateral movement like

214
00:09:17,600 --> 00:09:18,160
that

215
00:09:18,160 --> 00:09:22,160
from one to the other we saw that there

216
00:09:22,160 --> 00:09:22,640
is uh

217
00:09:22,640 --> 00:09:25,920
the spread is used by uh smb exec and

218
00:09:25,920 --> 00:09:29,360
we saw a lot of after fact of uh

219
00:09:29,360 --> 00:09:33,120
office and exec on many servers so

220
00:09:33,120 --> 00:09:36,720
there's only three three three

221
00:09:36,720 --> 00:09:40,000
three tools that he is tiny mate

222
00:09:40,000 --> 00:09:44,560
which is a repackage meterpreter stature

223
00:09:44,560 --> 00:09:46,800
which is locally deployed uh unnamed as

224
00:09:46,800 --> 00:09:49,839
the w3.exe

225
00:09:49,839 --> 00:09:52,880
exec and of course um interpreter

226
00:09:52,880 --> 00:09:56,240
so after one day

227
00:09:56,240 --> 00:09:59,040
after roughly 20 hours after the initial

228
00:09:59,040 --> 00:10:00,240
compromise of the first domain

229
00:10:00,240 --> 00:10:01,360
controller

230
00:10:01,360 --> 00:10:04,399
he extracts the sam database

231
00:10:04,399 --> 00:10:07,200
so it tried three things we don't know

232
00:10:07,200 --> 00:10:08,640
if you got issue of its

233
00:10:08,640 --> 00:10:11,519
part of the standard procedure export

234
00:10:11,519 --> 00:10:12,160
all the

235
00:10:12,160 --> 00:10:15,040
registry some security and system by

236
00:10:15,040 --> 00:10:16,640
using red.exe

237
00:10:16,640 --> 00:10:19,360
it used sprockdom to dump the ls iss

238
00:10:19,360 --> 00:10:20,000
memory

239
00:10:20,000 --> 00:10:22,560
and then a tools powered up you will see

240
00:10:22,560 --> 00:10:23,760
that you choose

241
00:10:23,760 --> 00:10:26,800
the intel folder it has done that

242
00:10:26,800 --> 00:10:29,440
a couple of times and this folder was

243
00:10:29,440 --> 00:10:30,240
there

244
00:10:30,240 --> 00:10:35,760
it was a part of some driver on the dc

245
00:10:35,920 --> 00:10:39,760
so by doing that it deployed and

246
00:10:39,760 --> 00:10:41,519
visits more than 50 servers on

247
00:10:41,519 --> 00:10:43,920
workstation

248
00:10:43,920 --> 00:10:47,040
some we will see that after some server

249
00:10:47,040 --> 00:10:48,880
on some servers the reboot was deployed

250
00:10:48,880 --> 00:10:50,800
at system level which

251
00:10:50,800 --> 00:10:53,120
is uh using a different kind of

252
00:10:53,120 --> 00:10:54,560
persistence here it says

253
00:10:54,560 --> 00:10:57,760
you would see that after

254
00:10:57,760 --> 00:11:00,560
so mainly i said before metal printer

255
00:11:00,560 --> 00:11:03,360
and smb exec

256
00:11:03,360 --> 00:11:06,079
so attribution time so the first time we

257
00:11:06,079 --> 00:11:07,760
see on the ping google that's here we

258
00:11:07,760 --> 00:11:09,440
were clear about that that's probably

259
00:11:09,440 --> 00:11:11,120
canadian people

260
00:11:11,120 --> 00:11:14,240
of course that's a joke it's not true

261
00:11:14,240 --> 00:11:16,880
but well it was fun for us uh in belgium

262
00:11:16,880 --> 00:11:17,680
to see someone

263
00:11:17,680 --> 00:11:20,880
being in google canada so

264
00:11:20,880 --> 00:11:22,880
attribution is was done on first by

265
00:11:22,880 --> 00:11:24,079
report of the

266
00:11:24,079 --> 00:11:28,480
the belgian set which come from the nsse

267
00:11:28,480 --> 00:11:31,920
and uh our and uh trinidad also uh

268
00:11:31,920 --> 00:11:35,120
pointed out uh some uh some

269
00:11:35,120 --> 00:11:38,240
same uh back end

270
00:11:38,240 --> 00:11:41,040
uh we found out also a couple of reports

271
00:11:41,040 --> 00:11:41,839
from asec

272
00:11:41,839 --> 00:11:45,120
proof point which after and during the

273
00:11:45,120 --> 00:11:45,760
incident

274
00:11:45,760 --> 00:11:49,120
uh showing us that well it's the same

275
00:11:49,120 --> 00:11:51,920
kind of attacks with some not always the

276
00:11:51,920 --> 00:11:53,279
same tools but

277
00:11:53,279 --> 00:11:56,480
a lot of tools used and the same

278
00:11:56,480 --> 00:11:57,519
methodology

279
00:11:57,519 --> 00:11:59,839
for example in the paper of athekon in

280
00:11:59,839 --> 00:12:01,920
october 19

281
00:12:01,920 --> 00:12:05,519
you will see that the backdoor was

282
00:12:05,519 --> 00:12:08,880
was not same it's named abi but

283
00:12:08,880 --> 00:12:11,839
well it's the same name and uh and so

284
00:12:11,839 --> 00:12:13,600
there's a couple of things which

285
00:12:13,600 --> 00:12:16,880
are looking the same so

286
00:12:16,880 --> 00:12:20,560
uh we have managed to do the incident

287
00:12:20,560 --> 00:12:21,839
response uh

288
00:12:21,839 --> 00:12:25,120
on such a ancillary

289
00:12:25,120 --> 00:12:28,320
just to have a big picture the bridge

290
00:12:28,320 --> 00:12:30,240
occurred friday

291
00:12:30,240 --> 00:12:33,040
the domain was compromised the next day

292
00:12:33,040 --> 00:12:34,639
on saturday

293
00:12:34,639 --> 00:12:38,079
and one week after the customer got

294
00:12:38,079 --> 00:12:43,279
the ioc and and detects the intruder

295
00:12:43,279 --> 00:12:45,120
so they closed the internet for the

296
00:12:45,120 --> 00:12:46,639
server because at the time of the

297
00:12:46,639 --> 00:12:47,600
detection

298
00:12:47,600 --> 00:12:50,320
they only have the ip of the meteor

299
00:12:50,320 --> 00:12:51,760
predator

300
00:12:51,760 --> 00:12:54,240
they didn't detect and see the sdb boat

301
00:12:54,240 --> 00:12:55,120
yet

302
00:12:55,120 --> 00:12:57,839
and really after that we are backing the

303
00:12:57,839 --> 00:12:59,120
incident response

304
00:12:59,120 --> 00:13:02,000
so it was a big environment of course

305
00:13:02,000 --> 00:13:02,639
it's

306
00:13:02,639 --> 00:13:05,680
hospital so it's a flat network

307
00:13:05,680 --> 00:13:08,240
you have a lot of whole things windows 7

308
00:13:08,240 --> 00:13:09,440
and patch

309
00:13:09,440 --> 00:13:13,440
things and more than windows 7 event um

310
00:13:13,440 --> 00:13:15,279
and there is no uncertainty on

311
00:13:15,279 --> 00:13:17,200
preparation you have

312
00:13:17,200 --> 00:13:19,200
a lot of logs to collect with our nuts

313
00:13:19,200 --> 00:13:20,880
and flight so it was not so

314
00:13:20,880 --> 00:13:23,920
so so easy to get into

315
00:13:23,920 --> 00:13:26,079
so the first thing that we have to spot

316
00:13:26,079 --> 00:13:27,519
and was easy to spot

317
00:13:27,519 --> 00:13:30,639
is the assembly exact artifact

318
00:13:30,639 --> 00:13:33,200
when they play with the zombie exact you

319
00:13:33,200 --> 00:13:36,000
may find some btob2 services

320
00:13:36,000 --> 00:13:38,880
there are no renaming and no try to do

321
00:13:38,880 --> 00:13:39,600
it

322
00:13:39,600 --> 00:13:42,000
and you may also find some underscore

323
00:13:42,000 --> 00:13:44,320
underscore output folders on the root of

324
00:13:44,320 --> 00:13:45,920
the c drive

325
00:13:45,920 --> 00:13:49,360
that's artifact created by smba exec

326
00:13:49,360 --> 00:13:53,279
so using event log and using remote

327
00:13:53,279 --> 00:13:56,160
folder scan we were able to find out

328
00:13:56,160 --> 00:13:59,680
some servers for a listening measurement

329
00:13:59,680 --> 00:14:00,399
which was

330
00:14:00,399 --> 00:14:03,279
also done on some servers we use the map

331
00:14:03,279 --> 00:14:03,920
and

332
00:14:03,920 --> 00:14:06,720
we scan the wall network to detect the

333
00:14:06,720 --> 00:14:08,320
ath distance part of

334
00:14:08,320 --> 00:14:12,800
some metropolitan then

335
00:14:12,880 --> 00:14:16,160
we sometimes it was

336
00:14:16,160 --> 00:14:17,920
installed as serious sometimes it was

337
00:14:17,920 --> 00:14:19,920
launched by somebody exec

338
00:14:19,920 --> 00:14:23,519
we found the tiny met and uh

339
00:14:23,519 --> 00:14:26,639
time it's quite easy to spot

340
00:14:26,639 --> 00:14:29,839
as you can see is there you have a tiny

341
00:14:29,839 --> 00:14:30,240
met

342
00:14:30,240 --> 00:14:32,320
uh executable which is nick as is that

343
00:14:32,320 --> 00:14:34,000
the value source that xa

344
00:14:34,000 --> 00:14:35,519
then the method used for the

345
00:14:35,519 --> 00:14:37,680
metropolitan stager so in our case

346
00:14:37,680 --> 00:14:39,920
what's real is tcp

347
00:14:39,920 --> 00:14:44,000
and the ip and the pro of the the cc so

348
00:14:44,000 --> 00:14:46,800
it was quite easy to spot that on logs

349
00:14:46,800 --> 00:14:47,279
and

350
00:14:47,279 --> 00:14:50,639
then and in a file a lot so here's a

351
00:14:50,639 --> 00:14:51,279
picture

352
00:14:51,279 --> 00:14:53,120
the first picture when the detection

353
00:14:53,120 --> 00:14:55,440
occurs by uh using the ioc given by the

354
00:14:55,440 --> 00:14:56,399
certain

355
00:14:56,399 --> 00:14:59,600
version the belgian side sorry um we got

356
00:14:59,600 --> 00:15:00,880
a metropolitan cc

357
00:15:00,880 --> 00:15:04,079
and we got a couple of servo compromised

358
00:15:04,079 --> 00:15:06,639
quickly we found out the passion zero

359
00:15:06,639 --> 00:15:08,959
and then we detect the sdb boat running

360
00:15:08,959 --> 00:15:09,839
on it

361
00:15:09,839 --> 00:15:12,560
the problem once we did that that we

362
00:15:12,560 --> 00:15:13,760
find out

363
00:15:13,760 --> 00:15:16,160
a lot of other server and workstation

364
00:15:16,160 --> 00:15:18,160
connecting to the sdb board cc

365
00:15:18,160 --> 00:15:20,560
and not always connecting also to the

366
00:15:20,560 --> 00:15:23,040
meterpreter so

367
00:15:23,040 --> 00:15:26,880
we know that it was a ta-50 ta50fa and

368
00:15:26,880 --> 00:15:29,360
yeah what they are doing they are doing

369
00:15:29,360 --> 00:15:30,560
ransomware

370
00:15:30,560 --> 00:15:32,320
they are launching one somewhere in this

371
00:15:32,320 --> 00:15:34,320
case it's uh they are alleged to use

372
00:15:34,320 --> 00:15:37,360
club so well

373
00:15:37,360 --> 00:15:41,360
it's a hospital one week and a half

374
00:15:41,360 --> 00:15:43,199
we are for sure detected since the

375
00:15:43,199 --> 00:15:45,440
customer has

376
00:15:45,440 --> 00:15:47,519
shutted down the internet and server

377
00:15:47,519 --> 00:15:48,720
side so

378
00:15:48,720 --> 00:15:52,240
well it was funny so um what was the

379
00:15:52,240 --> 00:15:53,120
action done

380
00:15:53,120 --> 00:15:55,680
and what were the fears action done is

381
00:15:55,680 --> 00:15:57,600
internet is down okay for only for

382
00:15:57,600 --> 00:15:58,480
servers

383
00:15:58,480 --> 00:16:01,040
for at the moment and there there are

384
00:16:01,040 --> 00:16:02,880
some discretionary ways in this case

385
00:16:02,880 --> 00:16:04,399
should we shut down everything so we

386
00:16:04,399 --> 00:16:07,360
claim yes that business should continue

387
00:16:07,360 --> 00:16:08,800
and in hospital the business

388
00:16:08,800 --> 00:16:11,120
communicated so

389
00:16:11,120 --> 00:16:14,000
then we asked immediate encoding of all

390
00:16:14,000 --> 00:16:16,000
the known bad ideas it was done

391
00:16:16,000 --> 00:16:19,440
and we have a solution to detect

392
00:16:19,440 --> 00:16:22,800
running meta preteriting in the in the

393
00:16:22,800 --> 00:16:25,920
80s so that was shown

394
00:16:25,920 --> 00:16:29,120
right now though the problem is that

395
00:16:29,120 --> 00:16:31,680
we still have more after on mapscan we

396
00:16:31,680 --> 00:16:32,560
found out that

397
00:16:32,560 --> 00:16:34,720
we still have more than 300 hosts

398
00:16:34,720 --> 00:16:38,240
vulnerable to ms7010

399
00:16:38,240 --> 00:16:43,279
so okay yeah i'm not confident

400
00:16:43,279 --> 00:16:46,240
then when clockwise builds launch and

401
00:16:46,240 --> 00:16:47,120
then

402
00:16:47,120 --> 00:16:50,880
how to find out other sdb boot maybe sdb

403
00:16:50,880 --> 00:16:51,920
board

404
00:16:51,920 --> 00:16:55,120
some other are present and are using all

405
00:16:55,120 --> 00:16:59,680
their command control that was a fear

406
00:16:59,759 --> 00:17:03,120
to detect this bible board in

407
00:17:03,120 --> 00:17:05,199
such environment with no preparation

408
00:17:05,199 --> 00:17:06,640
it's not so simple

409
00:17:06,640 --> 00:17:09,760
sdb bot is unique has a

410
00:17:09,760 --> 00:17:12,480
four file for the launcher example there

411
00:17:12,480 --> 00:17:13,039
are

412
00:17:13,039 --> 00:17:16,959
unique hash pair sample and the registry

413
00:17:16,959 --> 00:17:18,000
as the location is

414
00:17:18,000 --> 00:17:21,839
random so it's not so easy so first

415
00:17:21,839 --> 00:17:24,640
we are not able to detect it on a file

416
00:17:24,640 --> 00:17:26,880
based that was not possible

417
00:17:26,880 --> 00:17:29,200
so we take a look to try to find a

418
00:17:29,200 --> 00:17:31,520
little create a little script to find

419
00:17:31,520 --> 00:17:32,160
them

420
00:17:32,160 --> 00:17:34,160
using the registry try to find some

421
00:17:34,160 --> 00:17:35,520
paths with three editor

422
00:17:35,520 --> 00:17:38,799
and sub key with one letter it was

423
00:17:38,799 --> 00:17:40,640
running but the problem is to deploy

424
00:17:40,640 --> 00:17:41,280
that on

425
00:17:41,280 --> 00:17:44,840
every endpoint so it's not so simple so

426
00:17:44,840 --> 00:17:47,840
then uh by looking at the code of sdb

427
00:17:47,840 --> 00:17:48,240
boots

428
00:17:48,240 --> 00:17:50,720
we found out that when it is launched uh

429
00:17:50,720 --> 00:17:54,080
it fetched external iep using ip.e.com

430
00:17:54,080 --> 00:17:58,240
in this case and use a not coded

431
00:17:58,240 --> 00:18:01,840
user agent was nice but the customer is

432
00:18:01,840 --> 00:18:02,160
not

433
00:18:02,160 --> 00:18:05,760
able to see the user agent since

434
00:18:05,760 --> 00:18:09,200
it didn't have any proxy so we'll just

435
00:18:09,200 --> 00:18:12,160
be able to detect hostname that are

436
00:18:12,160 --> 00:18:15,360
going to epa epa.pay.com

437
00:18:15,360 --> 00:18:18,480
and well that's not so easy since

438
00:18:18,480 --> 00:18:21,919
it's occurred only once when you start

439
00:18:21,919 --> 00:18:26,240
the bot so it's not variable

440
00:18:26,240 --> 00:18:28,320
and we try to find all the method to be

441
00:18:28,320 --> 00:18:30,000
sure to fetch everything we

442
00:18:30,000 --> 00:18:32,880
at this time we are not sure that ip.com

443
00:18:32,880 --> 00:18:33,440
is the

444
00:18:33,440 --> 00:18:36,000
only service used to fetch the external

445
00:18:36,000 --> 00:18:37,200
ip

446
00:18:37,200 --> 00:18:39,360
so what we see also is that the the

447
00:18:39,360 --> 00:18:42,080
communication part is a network part of

448
00:18:42,080 --> 00:18:46,000
sdb board is quite easy to spot

449
00:18:46,000 --> 00:18:48,720
it use a binary protocol but there is a

450
00:18:48,720 --> 00:18:50,480
really simple uncheck

451
00:18:50,480 --> 00:18:52,640
when sdb board is starting is sent to

452
00:18:52,640 --> 00:18:54,080
the cc

453
00:18:54,080 --> 00:18:56,960
4 bytes which are zero zero zero zero d

454
00:18:56,960 --> 00:18:58,080
co

455
00:18:58,080 --> 00:19:01,120
um and uh uh radical

456
00:19:01,120 --> 00:19:04,080
e c zero and the server answers the same

457
00:19:04,080 --> 00:19:05,039
and after that

458
00:19:05,039 --> 00:19:06,960
uh the communication established and it

459
00:19:06,960 --> 00:19:09,679
started to shrink and receiving and

460
00:19:09,679 --> 00:19:13,360
well start to work it's easy to spot on

461
00:19:13,360 --> 00:19:15,360
the network with an ideas

462
00:19:15,360 --> 00:19:18,000
but in this case again our customer

463
00:19:18,000 --> 00:19:19,760
didn't have any ideas

464
00:19:19,760 --> 00:19:22,160
it was located in bristol so it takes

465
00:19:22,160 --> 00:19:23,360
time to

466
00:19:23,360 --> 00:19:26,960
build and set up and ideas quickly so

467
00:19:26,960 --> 00:19:30,640
it was not usable so what we found out

468
00:19:30,640 --> 00:19:31,600
also is that

469
00:19:31,600 --> 00:19:35,520
sdd boot contains a solution

470
00:19:35,520 --> 00:19:38,000
to override the configuration the

471
00:19:38,000 --> 00:19:39,520
configuration of the malware

472
00:19:39,520 --> 00:19:43,840
may be read from the executable

473
00:19:43,840 --> 00:19:47,840
or from a file ip.xt

474
00:19:47,840 --> 00:19:51,120
the file ip.xt may be on the local drive

475
00:19:51,120 --> 00:19:52,880
at the root of the c drive or in the

476
00:19:52,880 --> 00:19:54,960
folder where i run the cb board

477
00:19:54,960 --> 00:19:57,760
so it's worth another solution to be

478
00:19:57,760 --> 00:19:58,160
sure

479
00:19:58,160 --> 00:20:02,480
that we find out all other

480
00:20:02,480 --> 00:20:04,799
sdb boards even the ones that didn't use

481
00:20:04,799 --> 00:20:07,039
drm server booking.com

482
00:20:07,039 --> 00:20:10,720
and so we deployed iptxt everywhere

483
00:20:10,720 --> 00:20:13,919
and hopefully and happy we were happy of

484
00:20:13,919 --> 00:20:15,039
that that

485
00:20:15,039 --> 00:20:18,799
we didn't found more sdb votes

486
00:20:18,799 --> 00:20:21,840
all the words that we see were already

487
00:20:21,840 --> 00:20:22,960
known and

488
00:20:22,960 --> 00:20:26,640
connecting to dram serversbooking.com

489
00:20:26,640 --> 00:20:29,919
on the server it was not the same

490
00:20:29,919 --> 00:20:31,600
persistency the persistency is more

491
00:20:31,600 --> 00:20:34,240
complicated it shows the application

492
00:20:34,240 --> 00:20:37,679
application compatibility champs so it's

493
00:20:37,679 --> 00:20:38,240
a

494
00:20:38,240 --> 00:20:39,600
let's say a special configuration

495
00:20:39,600 --> 00:20:41,600
registry where you may

496
00:20:41,600 --> 00:20:46,240
patch some file at patching for example

497
00:20:46,240 --> 00:20:49,280
an sdb boots when run

498
00:20:49,280 --> 00:20:51,760
with system privilege use this kind of

499
00:20:51,760 --> 00:20:52,799
persistence

500
00:20:52,799 --> 00:20:55,600
this person's expense was well described

501
00:20:55,600 --> 00:20:55,919
by

502
00:20:55,919 --> 00:20:59,760
firearm in 2017 and we have

503
00:20:59,760 --> 00:21:02,000
the link at the end of the presentation

504
00:21:02,000 --> 00:21:03,679
so in this case

505
00:21:03,679 --> 00:21:06,000
sdb boot is not a standalone process but

506
00:21:06,000 --> 00:21:06,720
is

507
00:21:06,720 --> 00:21:09,520
is injected inside the win logon of the

508
00:21:09,520 --> 00:21:10,559
servers

509
00:21:10,559 --> 00:21:14,960
so for all the servers we use our

510
00:21:14,960 --> 00:21:18,000
um tool the gar our ancient embracement

511
00:21:18,000 --> 00:21:18,480
tool

512
00:21:18,480 --> 00:21:20,320
a google rapid response to deploy an

513
00:21:20,320 --> 00:21:21,520
agent

514
00:21:21,520 --> 00:21:24,559
quickly and to scan the wall server

515
00:21:24,559 --> 00:21:28,080
with the simple yaros

516
00:21:28,080 --> 00:21:30,240
restricting to the winlogon that exit

517
00:21:30,240 --> 00:21:31,520
process and

518
00:21:31,520 --> 00:21:34,320
we again receive all the configuration

519
00:21:34,320 --> 00:21:34,720
of the

520
00:21:34,720 --> 00:21:37,200
divide running and hopefully uh there

521
00:21:37,200 --> 00:21:38,720
was only one

522
00:21:38,720 --> 00:21:42,320
uh drm one cc which is a durant that

523
00:21:42,320 --> 00:21:45,840
server the

524
00:21:46,240 --> 00:21:48,960
so we deployed a couple of solutions as

525
00:21:48,960 --> 00:21:49,840
you can see to

526
00:21:49,840 --> 00:21:53,360
to find out the sdb boards and hopefully

527
00:21:53,360 --> 00:21:54,000
they were

528
00:21:54,000 --> 00:21:57,360
nuts so although they bought so once we

529
00:21:57,360 --> 00:22:00,400
block the cc once we block the

530
00:22:00,400 --> 00:22:02,720
meta pressure we have cut down all

531
00:22:02,720 --> 00:22:03,520
access to

532
00:22:03,520 --> 00:22:06,720
the attacker so what we

533
00:22:06,720 --> 00:22:10,400
have seen is that tf ta sorry

534
00:22:10,400 --> 00:22:13,600
505 is uh is fast they are

535
00:22:13,600 --> 00:22:16,799
fast um they are using tools uh

536
00:22:16,799 --> 00:22:19,600
tools that they know how to deal with uh

537
00:22:19,600 --> 00:22:20,240
they are

538
00:22:20,240 --> 00:22:22,559
using it since months as you can see if

539
00:22:22,559 --> 00:22:23,679
you take a look at the

540
00:22:23,679 --> 00:22:27,520
compilation time of the tools

541
00:22:27,520 --> 00:22:29,919
but they are really really fast in

542
00:22:29,919 --> 00:22:32,559
execution

543
00:22:32,960 --> 00:22:34,559
there is for example for the second

544
00:22:34,559 --> 00:22:37,120
campaign of

545
00:22:37,120 --> 00:22:40,400
fishing the registering the

546
00:22:40,400 --> 00:22:42,799
the day of the campaign is the day

547
00:22:42,799 --> 00:22:45,679
before the day of the fishing campaign

548
00:22:45,679 --> 00:22:48,799
and once they

549
00:22:48,799 --> 00:22:51,840
got access to the maldoc less than 20

550
00:22:51,840 --> 00:22:52,720
hours after

551
00:22:52,720 --> 00:22:55,200
they are dominant mean and have extract

552
00:22:55,200 --> 00:22:57,120
all the domains information

553
00:22:57,120 --> 00:23:00,720
so they are really well it was easy

554
00:23:00,720 --> 00:23:01,840
because they are some

555
00:23:01,840 --> 00:23:05,360
eternal blue weapon but they are knowing

556
00:23:05,360 --> 00:23:09,200
what they do so that was for the

557
00:23:09,200 --> 00:23:11,039
incident and the answer

558
00:23:11,039 --> 00:23:13,120
uh now the question is since we have a

559
00:23:13,120 --> 00:23:14,390
couple of customers

560
00:23:14,390 --> 00:23:15,520
[Music]

561
00:23:15,520 --> 00:23:18,799
with uh we are doing some stuff for them

562
00:23:18,799 --> 00:23:19,120
and

563
00:23:19,120 --> 00:23:21,440
we are managing the cm the idea is to

564
00:23:21,440 --> 00:23:24,000
how to find the other sdb boards

565
00:23:24,000 --> 00:23:28,480
before before the clock ever is launched

566
00:23:28,480 --> 00:23:30,640
so the problem of sdb boat is that this

567
00:23:30,640 --> 00:23:33,039
malware is fireless

568
00:23:33,039 --> 00:23:35,840
and the way it is done with the

569
00:23:35,840 --> 00:23:36,720
configuration

570
00:23:36,720 --> 00:23:39,840
inside the launcher uh

571
00:23:39,840 --> 00:23:43,440
we will do was that there are rayon

572
00:23:43,440 --> 00:23:44,640
sandboxes

573
00:23:44,640 --> 00:23:46,799
uh it's hard to spot some samples and

574
00:23:46,799 --> 00:23:48,400
press the time to write so

575
00:23:48,400 --> 00:23:52,400
how to to deal with them so the id cap

576
00:23:52,400 --> 00:23:55,760
from from the network the they are

577
00:23:55,760 --> 00:23:57,200
already

578
00:23:57,200 --> 00:23:59,279
using clever persistence whereas they

579
00:23:59,279 --> 00:24:02,000
are also using a really simple network

580
00:24:02,000 --> 00:24:03,440
connectivity

581
00:24:03,440 --> 00:24:06,080
if i send 4 byte to the you know to the

582
00:24:06,080 --> 00:24:07,360
sdk vote server

583
00:24:07,360 --> 00:24:09,840
it sends me back 4 byte and that's the

584
00:24:09,840 --> 00:24:10,799
way

585
00:24:10,799 --> 00:24:15,200
that we may use to detect them

586
00:24:15,200 --> 00:24:18,320
so to validate that we have created a

587
00:24:18,320 --> 00:24:22,400
fake uh sdb good server in python

588
00:24:22,400 --> 00:24:25,679
uh we have uh put as delegate

589
00:24:25,679 --> 00:24:28,559
client as they would in front of it and

590
00:24:28,559 --> 00:24:31,039
once it was working well

591
00:24:31,039 --> 00:24:34,640
we are creating we we are creating a

592
00:24:34,640 --> 00:24:36,320
scanner for that

593
00:24:36,320 --> 00:24:39,200
we cannot use masking since we need to

594
00:24:39,200 --> 00:24:40,720
send handbags so

595
00:24:40,720 --> 00:24:44,159
we create a nsu script

596
00:24:44,159 --> 00:24:47,200
this ns script uh uh

597
00:24:47,200 --> 00:24:49,600
send or only send four byte and uh when

598
00:24:49,600 --> 00:24:51,919
the four byte has the same received uh

599
00:24:51,919 --> 00:24:54,240
it declares that uh it's uh it's an sd

600
00:24:54,240 --> 00:24:55,520
will back in

601
00:24:55,520 --> 00:24:57,679
so it's quite easy to do that but the

602
00:24:57,679 --> 00:25:00,080
problem is that it's not so easy to scan

603
00:25:00,080 --> 00:25:01,600
the whole internet

604
00:25:01,600 --> 00:25:05,120
since we are not using mascara but only

605
00:25:05,120 --> 00:25:09,120
a map and since it's only on poor 443

606
00:25:09,120 --> 00:25:09,919
which means

607
00:25:09,919 --> 00:25:12,799
well most of the website on the internet

608
00:25:12,799 --> 00:25:14,000
it's not so simple

609
00:25:14,000 --> 00:25:16,159
to scan the wool internet so the idea is

610
00:25:16,159 --> 00:25:19,120
to since uh and might be slow

611
00:25:19,120 --> 00:25:22,320
um the idea was to have a lot of end map

612
00:25:22,320 --> 00:25:22,880
in part

613
00:25:22,880 --> 00:25:25,039
but well that's not cheap so it was not

614
00:25:25,039 --> 00:25:26,240
the solution so the

615
00:25:26,240 --> 00:25:29,279
the reflection was how to

616
00:25:29,279 --> 00:25:32,240
reduce the scope of the ip ranges to

617
00:25:32,240 --> 00:25:33,840
scan

618
00:25:33,840 --> 00:25:37,200
um there is a lot of hostname

619
00:25:37,200 --> 00:25:40,840
used by sdb world and used by

620
00:25:40,840 --> 00:25:43,840
lh2tl

621
00:25:44,400 --> 00:25:46,640
there is a lot of them which looking the

622
00:25:46,640 --> 00:25:47,520
same

623
00:25:47,520 --> 00:25:50,559
and it's look uh if you take some a few

624
00:25:50,559 --> 00:25:51,919
examples like this

625
00:25:51,919 --> 00:25:54,880
it's like always some labels which are

626
00:25:54,880 --> 00:25:56,559
stick together

627
00:25:56,559 --> 00:26:00,480
so we have for example dream

628
00:26:00,640 --> 00:26:03,840
server dashbooking.com and you may find

629
00:26:03,840 --> 00:26:06,640
other with some of the levels

630
00:26:06,640 --> 00:26:10,400
so what we found out also is that some

631
00:26:10,400 --> 00:26:13,600
ipr used if you take a look at

632
00:26:13,600 --> 00:26:16,799
our thermserverbooking.com uh if you

633
00:26:16,799 --> 00:26:19,600
ask to the passive dns you may see your

634
00:26:19,600 --> 00:26:20,559
other ip

635
00:26:20,559 --> 00:26:23,520
having this hostname so it seems that

636
00:26:23,520 --> 00:26:24,240
this guy

637
00:26:24,240 --> 00:26:27,600
um and they are doing a lot of work so

638
00:26:27,600 --> 00:26:31,200
they like to reuse infrastructure

639
00:26:31,200 --> 00:26:33,440
so they like to reuse infrastructure and

640
00:26:33,440 --> 00:26:34,720
probably

641
00:26:34,720 --> 00:26:38,960
the idea was they don't like to learn

642
00:26:38,960 --> 00:26:43,120
how to buy another domain how to buy

643
00:26:43,120 --> 00:26:46,480
and their another whole thing

644
00:26:46,480 --> 00:26:48,799
it should be maybe always the same

645
00:26:48,799 --> 00:26:51,279
austria as fundamental that was the the

646
00:26:51,279 --> 00:26:52,320
idea

647
00:26:52,320 --> 00:26:55,760
so what we have done we have

648
00:26:55,760 --> 00:26:58,720
looked at all the reports all what we

649
00:26:58,720 --> 00:26:59,520
have

650
00:26:59,520 --> 00:27:02,240
as a report to fetch all the domains

651
00:27:02,240 --> 00:27:03,279
alleged to

652
00:27:03,279 --> 00:27:06,960
ta 505 and we split all the domain by

653
00:27:06,960 --> 00:27:07,679
labels

654
00:27:07,679 --> 00:27:10,159
on dram cloud microsoft and then we have

655
00:27:10,159 --> 00:27:10,880
generated

656
00:27:10,880 --> 00:27:13,279
all the possible words by using two and

657
00:27:13,279 --> 00:27:14,559
three levels

658
00:27:14,559 --> 00:27:18,000
and then all this alt name generated we

659
00:27:18,000 --> 00:27:20,320
have resolved them and

660
00:27:20,320 --> 00:27:23,760
we have kept the autonomous number

661
00:27:23,760 --> 00:27:26,880
the idea was to find out some

662
00:27:26,880 --> 00:27:29,679
network where it could be possible to

663
00:27:29,679 --> 00:27:30,080
have

664
00:27:30,080 --> 00:27:33,120
some ta 505

665
00:27:33,120 --> 00:27:36,480
systems we run the nss script

666
00:27:36,480 --> 00:27:39,440
against this autonomous system and it

667
00:27:39,440 --> 00:27:39,919
was

668
00:27:39,919 --> 00:27:44,000
working we find out 12 sdtv boards

669
00:27:44,000 --> 00:27:46,720
so how to validate that it's not an

670
00:27:46,720 --> 00:27:48,480
honeypot and it's pretty

671
00:27:48,480 --> 00:27:52,159
debuted well that's what we've done

672
00:27:52,159 --> 00:27:54,640
first we see that the sd boards are

673
00:27:54,640 --> 00:27:57,520
invisible to showdown for example

674
00:27:57,520 --> 00:28:00,960
i think it's because since you if you

675
00:28:00,960 --> 00:28:03,440
come with an http you got a reset

676
00:28:03,440 --> 00:28:05,679
if you come where with anything else

677
00:28:05,679 --> 00:28:06,559
that's

678
00:28:06,559 --> 00:28:09,279
the magic deco uncheck you got a result

679
00:28:09,279 --> 00:28:09,679
so

680
00:28:09,679 --> 00:28:12,320
that's why because uh sdb vote is not

681
00:28:12,320 --> 00:28:13,120
visible then

682
00:28:13,120 --> 00:28:15,600
show them so that's the first things

683
00:28:15,600 --> 00:28:16,480
then we see

684
00:28:16,480 --> 00:28:19,279
that most of the systems are ubuntu is

685
00:28:19,279 --> 00:28:21,120
as long as one billion

686
00:28:21,120 --> 00:28:25,279
and if you then something else

687
00:28:25,279 --> 00:28:27,360
than the crew you have the results so

688
00:28:27,360 --> 00:28:29,360
it's quite easy to spout

689
00:28:29,360 --> 00:28:32,559
to spot as they would and to remove from

690
00:28:32,559 --> 00:28:33,919
this list

691
00:28:33,919 --> 00:28:36,320
some honeypot because of course you may

692
00:28:36,320 --> 00:28:38,480
find so many thoughts

693
00:28:38,480 --> 00:28:40,960
the strange things that we find out we

694
00:28:40,960 --> 00:28:43,200
are not we don't know what it is

695
00:28:43,200 --> 00:28:46,240
maybe it's related to um to uh

696
00:28:46,240 --> 00:28:49,600
to the window itself but on most of them

697
00:28:49,600 --> 00:28:52,640
except one zodian 10

698
00:28:52,640 --> 00:28:55,840
you have the per 800 which is

699
00:28:55,840 --> 00:29:00,080
in listening mode so here we go

700
00:29:00,080 --> 00:29:03,600
in june of this year after uh using data

701
00:29:03,600 --> 00:29:07,520
from passive dns since the beginning of

702
00:29:08,399 --> 00:29:11,840
of the for 19.3 on january

703
00:29:11,840 --> 00:29:15,200
until june 2020 so with passive dns and

704
00:29:15,200 --> 00:29:16,080
the scanner

705
00:29:16,080 --> 00:29:19,039
we were able to uh find out 10 austnam

706
00:29:19,039 --> 00:29:20,960
used by

707
00:29:20,960 --> 00:29:26,080
this group on this

708
00:29:26,080 --> 00:29:28,480
thanos you have nine of them which are

709
00:29:28,480 --> 00:29:29,679
earp and

710
00:29:29,679 --> 00:29:33,200
eleven backhand active

711
00:29:33,679 --> 00:29:36,960
in in june

712
00:29:36,960 --> 00:29:40,559
the company german company

713
00:29:40,559 --> 00:29:43,600
telecom has sent a report

714
00:29:43,600 --> 00:29:46,960
which claims that now sdb bot is using

715
00:29:46,960 --> 00:29:50,960
tls we don't have any any sample yet so

716
00:29:50,960 --> 00:29:53,919
i can't confirm but in this case it will

717
00:29:53,919 --> 00:29:54,960
means that

718
00:29:54,960 --> 00:29:58,399
this solution will not work anymore but

719
00:29:58,399 --> 00:30:01,360
in august

720
00:30:02,080 --> 00:30:06,080
we found out another server

721
00:30:06,080 --> 00:30:09,679
located in germany and

722
00:30:09,679 --> 00:30:11,760
of course we thought there are some

723
00:30:11,760 --> 00:30:14,080
three other

724
00:30:14,080 --> 00:30:17,440
several uh three others name which

725
00:30:17,440 --> 00:30:21,360
are right and now not active anymore

726
00:30:21,360 --> 00:30:25,039
so we will see we don't know

727
00:30:25,039 --> 00:30:28,640
what future is coming many groups is it

728
00:30:28,640 --> 00:30:31,039
some whole server is it some false

729
00:30:31,039 --> 00:30:32,880
society we can sell

730
00:30:32,880 --> 00:30:36,240
so if you want access to to this tracker

731
00:30:36,240 --> 00:30:37,120
just

732
00:30:37,120 --> 00:30:40,080
contact us we will be happy to share

733
00:30:40,080 --> 00:30:42,240
this information

734
00:30:42,240 --> 00:30:45,279
so just for finishing uh here's a list

735
00:30:45,279 --> 00:30:48,960
of the iocs that we have as you can see

736
00:30:48,960 --> 00:30:51,679
um so domain knowledge to this group

737
00:30:51,679 --> 00:30:52,320
it's uh

738
00:30:52,320 --> 00:30:55,120
just uh you know she don't test in

739
00:30:55,120 --> 00:30:56,000
french

740
00:30:56,000 --> 00:30:59,519
it's huge um well

741
00:30:59,519 --> 00:31:01,600
maybe there are some mistakes but well

742
00:31:01,600 --> 00:31:04,320
it's really impressive

743
00:31:04,320 --> 00:31:07,279
some tactics and techniques and of

744
00:31:07,279 --> 00:31:08,320
course

745
00:31:08,320 --> 00:31:11,360
references of all the

746
00:31:11,360 --> 00:31:14,720
papers or the people

747
00:31:14,720 --> 00:31:17,279
working against these guys and thanks to

748
00:31:17,279 --> 00:31:18,559
them

749
00:31:18,559 --> 00:31:21,600
uh thank you vera vilta uh

750
00:31:21,600 --> 00:31:23,679
for watching me listening me it was

751
00:31:23,679 --> 00:31:24,960
quite strange to do it

752
00:31:24,960 --> 00:31:28,080
remotely thanks a lot and

753
00:31:28,080 --> 00:31:33,840
take care

754
00:31:35,679 --> 00:31:37,760
you

