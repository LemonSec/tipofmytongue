1
00:00:08,800 --> 00:00:09,679
hello

2
00:00:09,679 --> 00:00:12,719
i'm des beck i'm a cyber security

3
00:00:12,719 --> 00:00:13,599
engineer at

4
00:00:13,599 --> 00:00:15,759
mitre and i'll be talking about the

5
00:00:15,759 --> 00:00:17,920
malware behavior catalog

6
00:00:17,920 --> 00:00:20,880
otherwise known as mbc which provides a

7
00:00:20,880 --> 00:00:22,800
standardized vocabulary to support

8
00:00:22,800 --> 00:00:25,199
malware analysis use cases

9
00:00:25,199 --> 00:00:27,359
i'll be focusing on using mbc for

10
00:00:27,359 --> 00:00:29,279
standardized reporting

11
00:00:29,279 --> 00:00:31,760
which improves interpretation of malware

12
00:00:31,760 --> 00:00:33,520
analysis results

13
00:00:33,520 --> 00:00:35,520
as well as how those results can be used

14
00:00:35,520 --> 00:00:38,800
for detection and mitigation

15
00:00:38,800 --> 00:00:41,040
so i'll start with an overview of mbc to

16
00:00:41,040 --> 00:00:43,280
include other use cases

17
00:00:43,280 --> 00:00:46,480
its relationship to mitre attack and

18
00:00:46,480 --> 00:00:49,680
nbc's components and then from there

19
00:00:49,680 --> 00:00:50,879
we'll focus on how

20
00:00:50,879 --> 00:00:55,519
mbc is used in standardized reporting

21
00:00:56,079 --> 00:00:58,480
so mbc is a catalog of objectives and

22
00:00:58,480 --> 00:01:00,079
behaviors created to support

23
00:01:00,079 --> 00:01:02,960
malware analysis use cases so to get

24
00:01:02,960 --> 00:01:04,479
started here's an example

25
00:01:04,479 --> 00:01:06,159
of some of the objectives which are in

26
00:01:06,159 --> 00:01:07,760
the boulder font

27
00:01:07,760 --> 00:01:09,920
and behaviors which are in the regular

28
00:01:09,920 --> 00:01:12,159
font that might be associated with the

29
00:01:12,159 --> 00:01:14,240
malware sample

30
00:01:14,240 --> 00:01:16,400
so it could be if you look under the

31
00:01:16,400 --> 00:01:18,080
anti-behavioral analysis you know

32
00:01:18,080 --> 00:01:19,040
malware may make

33
00:01:19,040 --> 00:01:21,520
analysis difficult by delaying execution

34
00:01:21,520 --> 00:01:24,320
or having obfuscated code

35
00:01:24,320 --> 00:01:27,200
it may disable security tools under

36
00:01:27,200 --> 00:01:28,320
impact you'll see you know

37
00:01:28,320 --> 00:01:31,360
it may hijack system resources and this

38
00:01:31,360 --> 00:01:33,439
is just a sampling of the behaviors that

39
00:01:33,439 --> 00:01:34,720
are defined in the pc

40
00:01:34,720 --> 00:01:36,320
that can be associated with the malware

41
00:01:36,320 --> 00:01:39,040
sample so

42
00:01:39,040 --> 00:01:41,439
as far as other use cases you know today

43
00:01:41,439 --> 00:01:42,079
we're going to

44
00:01:42,079 --> 00:01:44,720
focus on standardized reporting but

45
00:01:44,720 --> 00:01:46,479
there are other use cases as well

46
00:01:46,479 --> 00:01:49,119
so for example mbc can be used to

47
00:01:49,119 --> 00:01:49,759
correlate

48
00:01:49,759 --> 00:01:52,799
malware analysis results so say you have

49
00:01:52,799 --> 00:01:53,200
you know

50
00:01:53,200 --> 00:01:54,720
different tools a couple of different

51
00:01:54,720 --> 00:01:56,240
tools you can

52
00:01:56,240 --> 00:01:58,320
if they're both mapped into nbc you can

53
00:01:58,320 --> 00:01:59,439
compare to see

54
00:01:59,439 --> 00:02:02,399
if they the results agree if they do

55
00:02:02,399 --> 00:02:04,159
agree you could be more confident in the

56
00:02:04,159 --> 00:02:05,520
results

57
00:02:05,520 --> 00:02:08,800
and if they don't agree then you'll know

58
00:02:08,800 --> 00:02:11,440
where to focus for further analysis

59
00:02:11,440 --> 00:02:14,319
um nbc also supports malware labeling to

60
00:02:14,319 --> 00:02:16,800
generate data sets for research

61
00:02:16,800 --> 00:02:20,800
so you know given a data set which has

62
00:02:20,800 --> 00:02:23,520
its behaviors labeled with nbc

63
00:02:23,520 --> 00:02:25,360
would enable you know researchers to

64
00:02:25,360 --> 00:02:27,440
extract whatever subset that

65
00:02:27,440 --> 00:02:30,400
meets some chosen criteria and then also

66
00:02:30,400 --> 00:02:30,959
it

67
00:02:30,959 --> 00:02:32,959
supports you know the malware analysis

68
00:02:32,959 --> 00:02:34,959
process and that's because

69
00:02:34,959 --> 00:02:36,400
you know having a set of behaviors

70
00:02:36,400 --> 00:02:38,080
identified and organized

71
00:02:38,080 --> 00:02:41,840
helps an analyst know what to look for

72
00:02:42,160 --> 00:02:44,879
so i'm sure many viewers are familiar

73
00:02:44,879 --> 00:02:46,400
with mitre attack

74
00:02:46,400 --> 00:02:48,879
it's a curated knowledge base and model

75
00:02:48,879 --> 00:02:50,000
for cyber adversary

76
00:02:50,000 --> 00:02:52,720
behavior and it's widely used to capture

77
00:02:52,720 --> 00:02:54,640
various aspects of the adversary life

78
00:02:54,640 --> 00:02:55,760
cycle

79
00:02:55,760 --> 00:02:58,800
so i should i want to point out that nbc

80
00:02:58,800 --> 00:03:01,680
is not part of attack you know the nbc

81
00:03:01,680 --> 00:03:03,680
team is not part of the attack team

82
00:03:03,680 --> 00:03:05,760
you know their independent efforts but

83
00:03:05,760 --> 00:03:07,760
nbc is related to attack so it's

84
00:03:07,760 --> 00:03:09,280
important to know the basics

85
00:03:09,280 --> 00:03:11,280
and understand that relationship between

86
00:03:11,280 --> 00:03:12,640
them um

87
00:03:12,640 --> 00:03:15,120
attack for enterprise defense defines

88
00:03:15,120 --> 00:03:16,400
adversary ttp

89
00:03:16,400 --> 00:03:19,360
seen during the analysis of an intrusion

90
00:03:19,360 --> 00:03:21,280
and the associated tactics you know the

91
00:03:21,280 --> 00:03:23,440
adversary's technical goals

92
00:03:23,440 --> 00:03:25,920
range from initial access to impact and

93
00:03:25,920 --> 00:03:27,840
are listed there underneath the attack

94
00:03:27,840 --> 00:03:29,040
for enterprise

95
00:03:29,040 --> 00:03:31,519
label and they aren't shown but

96
00:03:31,519 --> 00:03:33,120
associated with each tactic

97
00:03:33,120 --> 00:03:35,519
are what attack calls techniques which

98
00:03:35,519 --> 00:03:37,760
are how an adversary achieves a tactical

99
00:03:37,760 --> 00:03:39,280
objective

100
00:03:39,280 --> 00:03:40,799
and then you've got pre-attack you know

101
00:03:40,799 --> 00:03:42,400
it covers the earlier

102
00:03:42,400 --> 00:03:45,280
phases of a cyber attack but as tactics

103
00:03:45,280 --> 00:03:46,560
aren't shown because they don't relate

104
00:03:46,560 --> 00:03:48,319
to nbc

105
00:03:48,319 --> 00:03:50,720
um and a few years ago we talked to the

106
00:03:50,720 --> 00:03:51,840
attack team

107
00:03:51,840 --> 00:03:54,239
our mdc team talked to them about

108
00:03:54,239 --> 00:03:55,280
expanding attack

109
00:03:55,280 --> 00:03:57,040
to cover malware analysis more

110
00:03:57,040 --> 00:03:58,400
thoroughly or

111
00:03:58,400 --> 00:04:01,599
those use cases more thoroughly um but

112
00:04:01,599 --> 00:04:02,799
you know we weren't the only ones

113
00:04:02,799 --> 00:04:04,799
wanting attack to expand

114
00:04:04,799 --> 00:04:06,640
and you know attack can't expand to

115
00:04:06,640 --> 00:04:08,560
cover every use case and everybody who

116
00:04:08,560 --> 00:04:09,760
wants it to

117
00:04:09,760 --> 00:04:12,640
so instead we decided to develop nbc you

118
00:04:12,640 --> 00:04:14,319
know not just to support malware

119
00:04:14,319 --> 00:04:15,200
analysis

120
00:04:15,200 --> 00:04:17,759
but also you know as a model and a test

121
00:04:17,759 --> 00:04:19,759
case for how attack could be modified by

122
00:04:19,759 --> 00:04:22,639
second parties

123
00:04:24,479 --> 00:04:28,080
so um as far as you know adversaries

124
00:04:28,080 --> 00:04:28,800
behaviors

125
00:04:28,800 --> 00:04:30,560
adversary behaviors and malware

126
00:04:30,560 --> 00:04:32,240
behaviors you know they they overlap

127
00:04:32,240 --> 00:04:35,680
adversaries sometimes use malware um

128
00:04:35,680 --> 00:04:38,080
nbc aside you know attack is used in

129
00:04:38,080 --> 00:04:40,240
reporting to capture malware behaviors

130
00:04:40,240 --> 00:04:42,400
so for example joe sandbox falcon

131
00:04:42,400 --> 00:04:44,400
sandbox any run

132
00:04:44,400 --> 00:04:46,639
cuckoo sandbox you know they currently

133
00:04:46,639 --> 00:04:47,840
map behaviors

134
00:04:47,840 --> 00:04:50,880
to attack techniques but attack is

135
00:04:50,880 --> 00:04:53,840
oriented toward adversaries not malware

136
00:04:53,840 --> 00:04:55,680
it generally focuses on behaviors

137
00:04:55,680 --> 00:04:57,840
identified during an intrusion

138
00:04:57,840 --> 00:04:59,440
rather than those discovered during

139
00:04:59,440 --> 00:05:02,160
analyses like are done for malware

140
00:05:02,160 --> 00:05:03,680
and that's not to say some malware

141
00:05:03,680 --> 00:05:05,680
behaviors don't map nicely into attack

142
00:05:05,680 --> 00:05:08,479
many do for example you'll see that

143
00:05:08,479 --> 00:05:09,199
example there

144
00:05:09,199 --> 00:05:11,680
starts command.exe for commands

145
00:05:11,680 --> 00:05:12,720
execution

146
00:05:12,720 --> 00:05:16,000
that maps to attack version 7

147
00:05:16,000 --> 00:05:18,160
it's sub-technique command and scripting

148
00:05:18,160 --> 00:05:19,600
interpreter windows

149
00:05:19,600 --> 00:05:22,080
command shell but there are some malware

150
00:05:22,080 --> 00:05:23,759
behaviors that can't be mapped

151
00:05:23,759 --> 00:05:26,479
the best examples are anti-analysis

152
00:05:26,479 --> 00:05:28,320
behaviors like those that are listed you

153
00:05:28,320 --> 00:05:28,639
know

154
00:05:28,639 --> 00:05:31,039
for example queries kernel debugger

155
00:05:31,039 --> 00:05:33,599
information

156
00:05:34,160 --> 00:05:36,639
so those missing behaviors in attack

157
00:05:36,639 --> 00:05:39,360
motivated the development for mdc

158
00:05:39,360 --> 00:05:41,919
so nbc expands upon attack by defining

159
00:05:41,919 --> 00:05:43,199
new behaviors

160
00:05:43,199 --> 00:05:46,160
like anti-analysis behaviors and what we

161
00:05:46,160 --> 00:05:48,400
call micro behaviors which i'll define

162
00:05:48,400 --> 00:05:51,440
in a minute nbc moves away from attack's

163
00:05:51,440 --> 00:05:53,360
focus on the adversary perspective

164
00:05:53,360 --> 00:05:56,479
and instead focuses on malware code and

165
00:05:56,479 --> 00:05:57,759
as the diagram there

166
00:05:57,759 --> 00:06:01,280
the table shows nbc version 2

167
00:06:01,280 --> 00:06:04,800
it's been updated to work or to be

168
00:06:04,800 --> 00:06:06,960
compatible with attack version 7 it

169
00:06:06,960 --> 00:06:09,280
defines 41 new behaviors

170
00:06:09,280 --> 00:06:12,400
23 micro behaviors and it enhances with

171
00:06:12,400 --> 00:06:14,479
malware analysis details

172
00:06:14,479 --> 00:06:18,319
30 attack techniques or sub techniques

173
00:06:18,319 --> 00:06:19,360
and if you're familiar with the

174
00:06:19,360 --> 00:06:22,319
philosophy of the attack methodology

175
00:06:22,319 --> 00:06:24,400
you'll recognize the bullets in blue as

176
00:06:24,400 --> 00:06:26,880
malware code-oriented analogs

177
00:06:26,880 --> 00:06:29,759
so mbc maintains a malware code-oriented

178
00:06:29,759 --> 00:06:30,880
perspective

179
00:06:30,880 --> 00:06:33,199
it focuses on real-world malware

180
00:06:33,199 --> 00:06:34,639
behaviors and it maintains an

181
00:06:34,639 --> 00:06:38,160
appropriate level of abstraction

182
00:06:39,600 --> 00:06:42,319
so these are the components of mbc we've

183
00:06:42,319 --> 00:06:43,919
got the objectives which

184
00:06:43,919 --> 00:06:46,400
are you know those are why malware does

185
00:06:46,400 --> 00:06:47,440
something

186
00:06:47,440 --> 00:06:49,840
a behavior or micro behavior captures

187
00:06:49,840 --> 00:06:51,759
what the malware does to accomplish

188
00:06:51,759 --> 00:06:54,319
the objective and a method refines the

189
00:06:54,319 --> 00:06:55,280
behavior

190
00:06:55,280 --> 00:06:56,880
so the standard way of capturing the

191
00:06:56,880 --> 00:06:59,680
components is as a list separated with

192
00:06:59,680 --> 00:07:01,599
double colons where the objective is in

193
00:07:01,599 --> 00:07:04,160
all caps and that's our convention for

194
00:07:04,160 --> 00:07:06,880
using nbc um and then these three

195
00:07:06,880 --> 00:07:08,400
components have equivalence

196
00:07:08,400 --> 00:07:10,240
in attack you know objectives are like

197
00:07:10,240 --> 00:07:13,680
tactics behaviors are like techniques

198
00:07:13,680 --> 00:07:16,639
nbc defined methods before attack define

199
00:07:16,639 --> 00:07:17,520
sub-techniques

200
00:07:17,520 --> 00:07:19,440
so they're a bit different but they they

201
00:07:19,440 --> 00:07:21,840
serve a similar purpose

202
00:07:21,840 --> 00:07:23,919
and in mbc we're also building a

203
00:07:23,919 --> 00:07:25,680
collection of malware that exhibit the

204
00:07:25,680 --> 00:07:27,599
different behaviors and methods

205
00:07:27,599 --> 00:07:29,520
and we haven't done it yet but we're

206
00:07:29,520 --> 00:07:31,360
planning to build a library of code

207
00:07:31,360 --> 00:07:32,160
snippets

208
00:07:32,160 --> 00:07:35,759
that exemplify each behavior

209
00:07:36,560 --> 00:07:39,120
so mbc adopts attacks higher level

210
00:07:39,120 --> 00:07:39,919
structure

211
00:07:39,919 --> 00:07:42,160
and many mbc objectives correspond to

212
00:07:42,160 --> 00:07:43,680
attack tactics

213
00:07:43,680 --> 00:07:46,639
the objectives are shown on this slide

214
00:07:46,639 --> 00:07:48,000
and if you're familiar with attack

215
00:07:48,000 --> 00:07:49,680
you'll recognize you know persistence

216
00:07:49,680 --> 00:07:52,000
execution impact and so forth

217
00:07:52,000 --> 00:07:54,400
then the objectives outlined in yellow

218
00:07:54,400 --> 00:07:56,160
are not defined in attack

219
00:07:56,160 --> 00:07:58,319
but they're key to malware analysis such

220
00:07:58,319 --> 00:08:00,400
as you know the anti-analysis

221
00:08:00,400 --> 00:08:03,680
objectives up in the upper upper right

222
00:08:03,680 --> 00:08:05,759
um and we also found when we looked at

223
00:08:05,759 --> 00:08:08,960
behaviors identified by analysis tools

224
00:08:08,960 --> 00:08:11,199
some that were really low level they

225
00:08:11,199 --> 00:08:12,240
supported many

226
00:08:12,240 --> 00:08:14,240
objectives and other behaviors they

227
00:08:14,240 --> 00:08:16,319
weren't malicious in and of themselves

228
00:08:16,319 --> 00:08:16,879
but

229
00:08:16,879 --> 00:08:18,639
you know they're often identified during

230
00:08:18,639 --> 00:08:20,319
analysis so they're captured

231
00:08:20,319 --> 00:08:22,639
so we capture them in mbc and those are

232
00:08:22,639 --> 00:08:23,520
what we call

233
00:08:23,520 --> 00:08:25,440
micro behaviors and then the associated

234
00:08:25,440 --> 00:08:27,360
micro objectives that are kind of like

235
00:08:27,360 --> 00:08:28,160
the

236
00:08:28,160 --> 00:08:30,319
categories of the micro behaviors and

237
00:08:30,319 --> 00:08:33,440
they're related to things like you know

238
00:08:33,440 --> 00:08:37,200
http ftp dns communication cryptography

239
00:08:37,200 --> 00:08:41,839
and so forth

240
00:08:43,120 --> 00:08:46,399
so um as far as uh

241
00:08:46,399 --> 00:08:50,000
nbc relative to attack they are meant to

242
00:08:50,000 --> 00:08:51,839
be used in combination or nbc is meant

243
00:08:51,839 --> 00:08:52,560
to be used

244
00:08:52,560 --> 00:08:54,800
in combination with attack we don't want

245
00:08:54,800 --> 00:08:57,279
to duplicate attack content

246
00:08:57,279 --> 00:09:00,080
in nbc version one if you'd seen it

247
00:09:00,080 --> 00:09:00,800
before

248
00:09:00,800 --> 00:09:02,160
you know at that point we were

249
00:09:02,160 --> 00:09:04,080
referencing all attack techniques

250
00:09:04,080 --> 00:09:05,920
relevant to malware analysis

251
00:09:05,920 --> 00:09:07,600
there was a stub for you know each

252
00:09:07,600 --> 00:09:09,040
individual technique that applied to

253
00:09:09,040 --> 00:09:09,920
malware

254
00:09:09,920 --> 00:09:12,000
but in version two we've moved away from

255
00:09:12,000 --> 00:09:13,279
that and

256
00:09:13,279 --> 00:09:15,519
version two of nbc only contains

257
00:09:15,519 --> 00:09:16,720
behaviors that are new

258
00:09:16,720 --> 00:09:20,560
or have added content so but the idea

259
00:09:20,560 --> 00:09:22,399
that attack techniques will still be

260
00:09:22,399 --> 00:09:25,279
referenced and used as needed

261
00:09:25,279 --> 00:09:28,560
so in some cases though we've enhanced

262
00:09:28,560 --> 00:09:30,560
an attack technique and that's the

263
00:09:30,560 --> 00:09:32,399
malware behavior you know it extends a

264
00:09:32,399 --> 00:09:33,839
tax description

265
00:09:33,839 --> 00:09:37,440
to cover some specific aspect of malware

266
00:09:37,440 --> 00:09:40,240
in other cases we found that an attack

267
00:09:40,240 --> 00:09:41,920
technique was too broad

268
00:09:41,920 --> 00:09:43,920
so we refined it and defined multiple

269
00:09:43,920 --> 00:09:46,000
behaviors and there's an example there

270
00:09:46,000 --> 00:09:48,080
if you know software packing

271
00:09:48,080 --> 00:09:51,200
an attack uh relates to both what

272
00:09:51,200 --> 00:09:52,959
we think of packing from a malware

273
00:09:52,959 --> 00:09:54,880
perspective as well as

274
00:09:54,880 --> 00:09:57,120
you know of obfuscation of executable

275
00:09:57,120 --> 00:09:58,480
code we've separated those and there are

276
00:09:58,480 --> 00:09:59,760
two different behaviors

277
00:09:59,760 --> 00:10:03,760
in nbc and then when there is no attack

278
00:10:03,760 --> 00:10:04,560
technique

279
00:10:04,560 --> 00:10:06,320
for behavior that's needed to support a

280
00:10:06,320 --> 00:10:08,240
malware analysis use case

281
00:10:08,240 --> 00:10:11,360
we define a new nbc only behavior and

282
00:10:11,360 --> 00:10:12,800
it's been interesting because

283
00:10:12,800 --> 00:10:14,399
attack has grown over the years to

284
00:10:14,399 --> 00:10:16,000
include techniques that

285
00:10:16,000 --> 00:10:19,040
nbc had already defined

286
00:10:19,040 --> 00:10:22,880
um and so this example shows kind of how

287
00:10:22,880 --> 00:10:24,560
we handle those cases

288
00:10:24,560 --> 00:10:27,279
so the attack technique um

289
00:10:27,279 --> 00:10:28,480
virtualization

290
00:10:28,480 --> 00:10:31,200
sandbox evasion which is associated with

291
00:10:31,200 --> 00:10:32,000
the defense

292
00:10:32,000 --> 00:10:34,160
evasion tactic was defined after we

293
00:10:34,160 --> 00:10:36,959
define related behaviors in nbc

294
00:10:36,959 --> 00:10:39,760
nbc has these kind of lower level

295
00:10:39,760 --> 00:10:42,800
descriptions or definitions of behaviors

296
00:10:42,800 --> 00:10:46,240
nbc separates detect from evade and we

297
00:10:46,240 --> 00:10:47,680
separate sandboxes

298
00:10:47,680 --> 00:10:50,959
from virtual machines but as the errors

299
00:10:50,959 --> 00:10:51,760
show

300
00:10:51,760 --> 00:10:54,480
um some of the nbc methods relate to

301
00:10:54,480 --> 00:10:56,880
attack subtechniques i mean they're

302
00:10:56,880 --> 00:10:59,680
the same you know after when you look at

303
00:10:59,680 --> 00:11:00,959
their definitions

304
00:11:00,959 --> 00:11:03,279
so to make things less confusing we

305
00:11:03,279 --> 00:11:04,880
reference the attack content

306
00:11:04,880 --> 00:11:08,320
as i'll show in the next slide so

307
00:11:08,320 --> 00:11:11,920
here's an example mbc is available as

308
00:11:11,920 --> 00:11:13,680
markdown files on github i'll give the

309
00:11:13,680 --> 00:11:15,360
link and more information at the end of

310
00:11:15,360 --> 00:11:16,880
the talk

311
00:11:16,880 --> 00:11:18,959
and this is an example of one of the

312
00:11:18,959 --> 00:11:20,240
behavior pages

313
00:11:20,240 --> 00:11:22,560
this is the dynamic analysis evasion

314
00:11:22,560 --> 00:11:23,279
behavior

315
00:11:23,279 --> 00:11:27,440
that i showed in the previous slide

316
00:11:27,440 --> 00:11:31,040
and so you can see that

317
00:11:31,040 --> 00:11:33,920
at the top of the table that we show

318
00:11:33,920 --> 00:11:36,000
that the virtualization sandbox evasion

319
00:11:36,000 --> 00:11:37,839
attack technique is shown to be related

320
00:11:37,839 --> 00:11:40,240
we list it there and then if you see

321
00:11:40,240 --> 00:11:41,680
down in the description

322
00:11:41,680 --> 00:11:43,920
for one of the methods the delayed

323
00:11:43,920 --> 00:11:45,279
execution method

324
00:11:45,279 --> 00:11:46,959
it too includes a reference to the

325
00:11:46,959 --> 00:11:49,120
time-based evasion subtechnique that

326
00:11:49,120 --> 00:11:50,639
attack defines

327
00:11:50,639 --> 00:11:53,920
so we do link it up um

328
00:11:53,920 --> 00:11:56,079
so as to you know show what's equivalent

329
00:11:56,079 --> 00:11:58,399
or similarities between the

330
00:11:58,399 --> 00:12:01,680
two um between attack and nbc

331
00:12:01,680 --> 00:12:03,600
so there wasn't room to show the entire

332
00:12:03,600 --> 00:12:05,920
page associated with this behavior

333
00:12:05,920 --> 00:12:08,800
but um each page also includes a table

334
00:12:08,800 --> 00:12:10,560
of example malware that exhibit the

335
00:12:10,560 --> 00:12:11,360
behavior

336
00:12:11,360 --> 00:12:15,600
and then references and so forth

337
00:12:16,240 --> 00:12:18,800
so with the basics of nbc covered i'll

338
00:12:18,800 --> 00:12:21,040
now talk about how nbc is used in

339
00:12:21,040 --> 00:12:23,040
standardized reporting

340
00:12:23,040 --> 00:12:25,200
assuming sticks is used as the reporting

341
00:12:25,200 --> 00:12:26,160
format

342
00:12:26,160 --> 00:12:28,480
there are three components uh one

343
00:12:28,480 --> 00:12:30,320
component involves mapping tool

344
00:12:30,320 --> 00:12:32,160
signatures that will generate analysis

345
00:12:32,160 --> 00:12:33,040
content

346
00:12:33,040 --> 00:12:36,079
content to mbc and then the second

347
00:12:36,079 --> 00:12:39,040
component is that nbc must be expressed

348
00:12:39,040 --> 00:12:42,399
in sticks and a third component is that

349
00:12:42,399 --> 00:12:44,720
the tool report you know the output that

350
00:12:44,720 --> 00:12:45,440
tool

351
00:12:45,440 --> 00:12:47,760
provides that too must be translated in

352
00:12:47,760 --> 00:12:49,360
the stick so those are the three

353
00:12:49,360 --> 00:12:53,839
pieces um

354
00:12:54,079 --> 00:12:56,399
and i'll be using cuckoo sandbox for the

355
00:12:56,399 --> 00:12:57,519
signature

356
00:12:57,519 --> 00:13:00,160
mapping example so it has cuckoo sandbox

357
00:13:00,160 --> 00:13:03,600
has a community repository of 565

358
00:13:03,600 --> 00:13:07,360
signatures and of those 313

359
00:13:07,360 --> 00:13:09,040
are behaviors that are appropriate for

360
00:13:09,040 --> 00:13:11,760
mapping to nbc or attack

361
00:13:11,760 --> 00:13:14,160
the others are av related or not

362
00:13:14,160 --> 00:13:16,399
behavior related

363
00:13:16,399 --> 00:13:19,600
and then 165 signatures

364
00:13:19,600 --> 00:13:21,360
were already mapped to attack version

365
00:13:21,360 --> 00:13:22,880
six those were in the community

366
00:13:22,880 --> 00:13:23,920
repository and

367
00:13:23,920 --> 00:13:26,880
included those mappings but then we used

368
00:13:26,880 --> 00:13:27,760
nbc's

369
00:13:27,760 --> 00:13:30,480
malware focus content and we were able

370
00:13:30,480 --> 00:13:31,360
to update

371
00:13:31,360 --> 00:13:34,160
83 with a more accurate mapping that's

372
00:13:34,160 --> 00:13:36,240
actually means we changed the mapping

373
00:13:36,240 --> 00:13:39,199
um to something that was more related in

374
00:13:39,199 --> 00:13:40,800
looking at the signatures

375
00:13:40,800 --> 00:13:43,839
and then we extended 21 of them

376
00:13:43,839 --> 00:13:46,079
extension meaning that we defined an

377
00:13:46,079 --> 00:13:47,120
additional behavior

378
00:13:47,120 --> 00:13:48,560
there are some signatures that have more

379
00:13:48,560 --> 00:13:51,279
than one behavior map to it

380
00:13:51,279 --> 00:13:54,079
and then working with the you know the

381
00:13:54,079 --> 00:13:56,320
nbc only behaviors that we define

382
00:13:56,320 --> 00:13:59,839
we were able to look at

383
00:13:59,839 --> 00:14:01,360
some of the other signatures and in the

384
00:14:01,360 --> 00:14:03,920
end we defined 148 new mappings so we

385
00:14:03,920 --> 00:14:05,760
got a lot more coverage by having the

386
00:14:05,760 --> 00:14:09,439
malware focus of nbc

387
00:14:09,680 --> 00:14:11,680
so this table shows a few example

388
00:14:11,680 --> 00:14:12,720
mappings

389
00:14:12,720 --> 00:14:15,920
some signatures map to nbc behaviors

390
00:14:15,920 --> 00:14:17,839
which have identifiers starting with

391
00:14:17,839 --> 00:14:20,399
a b that's in the first line there of

392
00:14:20,399 --> 00:14:21,360
the table

393
00:14:21,360 --> 00:14:23,440
and then some map to micro behaviors

394
00:14:23,440 --> 00:14:25,519
their identifiers start with a c

395
00:14:25,519 --> 00:14:27,440
and actually it was by working through

396
00:14:27,440 --> 00:14:29,199
the cuckoo signatures

397
00:14:29,199 --> 00:14:30,880
that we decided to define micro

398
00:14:30,880 --> 00:14:32,320
behaviors in the first place because

399
00:14:32,320 --> 00:14:34,160
there were a lot of things that

400
00:14:34,160 --> 00:14:36,000
weren't mapping low level things and

401
00:14:36,000 --> 00:14:37,760
that's where the idea came up

402
00:14:37,760 --> 00:14:40,639
came from and then some signatures map

403
00:14:40,639 --> 00:14:42,800
to attack techniques

404
00:14:42,800 --> 00:14:44,880
that have malware focused enhanced

405
00:14:44,880 --> 00:14:46,079
content

406
00:14:46,079 --> 00:14:48,800
and those identifiers start with an e

407
00:14:48,800 --> 00:14:50,399
for enhanced and they keep the same

408
00:14:50,399 --> 00:14:52,800
number as an attack and that's the

409
00:14:52,800 --> 00:14:54,720
third line there you know the process

410
00:14:54,720 --> 00:14:57,760
injection process halloween example

411
00:14:57,760 --> 00:15:00,639
and then there are some uh signatures

412
00:15:00,639 --> 00:15:01,040
that

413
00:15:01,040 --> 00:15:03,519
map to standard attack techniques those

414
00:15:03,519 --> 00:15:06,240
identifiers start with a t

415
00:15:06,240 --> 00:15:08,160
and then given the mapping so we you

416
00:15:08,160 --> 00:15:10,079
know mapped all the signatures that were

417
00:15:10,079 --> 00:15:13,519
in the repository um given that

418
00:15:13,519 --> 00:15:17,680
we then added the proper identifier to

419
00:15:17,680 --> 00:15:19,519
the cuckoo signature and so i've shown

420
00:15:19,519 --> 00:15:20,959
you know an example of the signature

421
00:15:20,959 --> 00:15:22,560
this is the signature that

422
00:15:22,560 --> 00:15:27,040
goes along with the anti-sandbox sleep

423
00:15:27,040 --> 00:15:28,959
signature defined in cuckoo and you can

424
00:15:28,959 --> 00:15:31,120
see in the ttp

425
00:15:31,120 --> 00:15:33,920
field we've added that which corresponds

426
00:15:33,920 --> 00:15:34,880
to

427
00:15:34,880 --> 00:15:37,199
the dynamic analysis of asian delayed

428
00:15:37,199 --> 00:15:38,320
execution

429
00:15:38,320 --> 00:15:41,839
that's the b00

430
00:15:42,399 --> 00:15:45,600
so and then the latest mapping

431
00:15:45,600 --> 00:15:49,040
which includes so it uses nbc version 2

432
00:15:49,040 --> 00:15:52,320
and attack version 7. that's available

433
00:15:52,320 --> 00:15:57,040
um on github on the mbc project

434
00:15:57,040 --> 00:16:00,560
pages and so you can find it there

435
00:16:03,360 --> 00:16:05,519
so we have the tool in this case cuckoo

436
00:16:05,519 --> 00:16:06,560
mapped to

437
00:16:06,560 --> 00:16:09,600
nbc and attack as we just looked at so

438
00:16:09,600 --> 00:16:11,120
now we need to express

439
00:16:11,120 --> 00:16:14,480
mbc and the cuckoo output in sticks

440
00:16:14,480 --> 00:16:16,639
so stixx is a language for exchanging

441
00:16:16,639 --> 00:16:18,560
cyber threat information

442
00:16:18,560 --> 00:16:20,480
i don't have time to go into the details

443
00:16:20,480 --> 00:16:22,000
but i've given the reference to the

444
00:16:22,000 --> 00:16:22,639
latest

445
00:16:22,639 --> 00:16:24,240
committee specification there at the

446
00:16:24,240 --> 00:16:25,920
bottom of the slide um

447
00:16:25,920 --> 00:16:28,000
for those who are familiar with sticks

448
00:16:28,000 --> 00:16:29,120
the relevant

449
00:16:29,120 --> 00:16:31,680
sdos are the attack pattern malware

450
00:16:31,680 --> 00:16:32,639
analysis

451
00:16:32,639 --> 00:16:35,839
and malware objects and then we use the

452
00:16:35,839 --> 00:16:37,839
relationship objects to associate the

453
00:16:37,839 --> 00:16:39,600
actual nbc behaviors

454
00:16:39,600 --> 00:16:42,720
with analyses and our samples so i'll

455
00:16:42,720 --> 00:16:44,240
show a couple of examples

456
00:16:44,240 --> 00:16:47,519
next um so

457
00:16:47,519 --> 00:16:50,560
expressing nbc in sticks that's

458
00:16:50,560 --> 00:16:52,959
what enables you to then use mbc through

459
00:16:52,959 --> 00:16:54,560
tooling and apis

460
00:16:54,560 --> 00:16:57,120
and we've used the same six objects as

461
00:16:57,120 --> 00:16:59,040
attack uses to express is

462
00:16:59,040 --> 00:17:01,279
its content so if you're already using

463
00:17:01,279 --> 00:17:03,040
attack using nbc

464
00:17:03,040 --> 00:17:05,039
it shouldn't be any different because

465
00:17:05,039 --> 00:17:06,799
we're using for example each of our

466
00:17:06,799 --> 00:17:07,439
behaviors

467
00:17:07,439 --> 00:17:10,079
is captured as an attack pattern object

468
00:17:10,079 --> 00:17:12,000
as you can see in this example

469
00:17:12,000 --> 00:17:13,839
um the name of the property is the name

470
00:17:13,839 --> 00:17:15,199
of the behavior

471
00:17:15,199 --> 00:17:18,079
the phase name of a kill chain also hide

472
00:17:18,079 --> 00:17:19,199
it up there

473
00:17:19,199 --> 00:17:21,359
corresponds to the objective or tactic

474
00:17:21,359 --> 00:17:22,880
as attack would say

475
00:17:22,880 --> 00:17:24,720
and then the identifier is defined as a

476
00:17:24,720 --> 00:17:27,679
property of an external reference

477
00:17:27,679 --> 00:17:30,320
um and the content is available there's

478
00:17:30,320 --> 00:17:30,880
a

479
00:17:30,880 --> 00:17:34,480
nbc nbc-62 repository on github and i

480
00:17:34,480 --> 00:17:35,679
put the link there

481
00:17:35,679 --> 00:17:39,280
where you can get that content

482
00:17:39,360 --> 00:17:41,280
and then these next two slides show how

483
00:17:41,280 --> 00:17:42,400
cuckoo analysis

484
00:17:42,400 --> 00:17:45,360
results nnbc can be captured in sticks

485
00:17:45,360 --> 00:17:46,640
2.1

486
00:17:46,640 --> 00:17:49,039
so this analysis malware analysis object

487
00:17:49,039 --> 00:17:49,919
captures the

488
00:17:49,919 --> 00:17:52,400
cuckoo output you see that that cuckoo's

489
00:17:52,400 --> 00:17:53,840
listed as the product

490
00:17:53,840 --> 00:17:56,000
and then the various analysis details

491
00:17:56,000 --> 00:17:57,360
are captured in different object

492
00:17:57,360 --> 00:17:58,160
properties

493
00:17:58,160 --> 00:17:59,600
and i haven't really gone into them here

494
00:17:59,600 --> 00:18:02,080
but um you know it may be found a domain

495
00:18:02,080 --> 00:18:03,760
name or ip addresses you can see that

496
00:18:03,760 --> 00:18:04,640
those are there

497
00:18:04,640 --> 00:18:06,559
whatever is in that cuckoo report would

498
00:18:06,559 --> 00:18:08,160
be captured

499
00:18:08,160 --> 00:18:11,200
in in the malware analysis object and

500
00:18:11,200 --> 00:18:12,559
then kind of the

501
00:18:12,559 --> 00:18:15,679
nbc related part to that is that there's

502
00:18:15,679 --> 00:18:19,679
um the six relationship object is used

503
00:18:19,679 --> 00:18:20,559
and so

504
00:18:20,559 --> 00:18:24,080
in this example you can see that the

505
00:18:24,080 --> 00:18:26,559
object type is derived from or the

506
00:18:26,559 --> 00:18:27,600
relationship type

507
00:18:27,600 --> 00:18:30,080
is derived from with the source the

508
00:18:30,080 --> 00:18:31,760
attack pattern which corresponds to the

509
00:18:31,760 --> 00:18:32,720
behavior

510
00:18:32,720 --> 00:18:35,120
and the target is the malware analysis

511
00:18:35,120 --> 00:18:36,960
object which corresponds to

512
00:18:36,960 --> 00:18:39,280
the cuckoo analysis so so this kind of

513
00:18:39,280 --> 00:18:40,160
reads you know

514
00:18:40,160 --> 00:18:42,160
the behavior was derived from the

515
00:18:42,160 --> 00:18:43,520
analysis

516
00:18:43,520 --> 00:18:45,360
uh and then a similar relationship could

517
00:18:45,360 --> 00:18:47,200
be used to associate

518
00:18:47,200 --> 00:18:49,600
the nbc behavior or the malware behavior

519
00:18:49,600 --> 00:18:50,240
really

520
00:18:50,240 --> 00:18:53,280
with the actual malware sample so that's

521
00:18:53,280 --> 00:18:56,000
again you you kind of have to have some

522
00:18:56,000 --> 00:18:57,520
knowledge of sticks to

523
00:18:57,520 --> 00:18:59,200
thoroughly understand this but it kind

524
00:18:59,200 --> 00:19:01,039
of gives an idea of how

525
00:19:01,039 --> 00:19:02,640
you know the standardized reporting

526
00:19:02,640 --> 00:19:04,880
comes out from

527
00:19:04,880 --> 00:19:09,039
using nbc so as far as next steps

528
00:19:09,039 --> 00:19:12,320
we'd like to define mappings between nbc

529
00:19:12,320 --> 00:19:14,240
and other analysis tools

530
00:19:14,240 --> 00:19:16,320
like we've done for cuckoo we're

531
00:19:16,320 --> 00:19:18,400
currently mapping the fireeye

532
00:19:18,400 --> 00:19:21,760
flair team's open source capitol to nbc

533
00:19:21,760 --> 00:19:23,760
and hope to have that done relatively

534
00:19:23,760 --> 00:19:25,120
soon

535
00:19:25,120 --> 00:19:27,280
we also plan to expand the malware

536
00:19:27,280 --> 00:19:28,559
example content

537
00:19:28,559 --> 00:19:30,720
and to create a repository of code

538
00:19:30,720 --> 00:19:32,720
snippets to provide examples of how each

539
00:19:32,720 --> 00:19:34,559
behavior is implemented

540
00:19:34,559 --> 00:19:37,280
and then for now all the content is in

541
00:19:37,280 --> 00:19:38,720
markdown files

542
00:19:38,720 --> 00:19:41,679
on github the github site has separate

543
00:19:41,679 --> 00:19:43,360
pages for each behavior

544
00:19:43,360 --> 00:19:46,640
there is a fairly long list of faqs

545
00:19:46,640 --> 00:19:49,360
and a set of malware examples or example

546
00:19:49,360 --> 00:19:51,200
malware

547
00:19:51,200 --> 00:19:53,520
a few organizations are using nbc but

548
00:19:53,520 --> 00:19:54,799
it'd be great of course to have more

549
00:19:54,799 --> 00:19:57,280
people using it and helping to refine it

550
00:19:57,280 --> 00:19:59,840
so please have a look at github and if

551
00:19:59,840 --> 00:20:02,240
you'd like to join the discussion list

552
00:20:02,240 --> 00:20:06,320
please send a request to mbc mitre.org

553
00:20:06,320 --> 00:20:16,720
so thank you very much

