1
00:00:08,960 --> 00:00:10,480
welcome everyone

2
00:00:10,480 --> 00:00:13,519
uh i hope you guys having a great time

3
00:00:13,519 --> 00:00:16,560
for the vb local so today we are going

4
00:00:16,560 --> 00:00:19,119
to talk about compromising iot cnc

5
00:00:19,119 --> 00:00:19,680
panels

6
00:00:19,680 --> 00:00:23,279
for unearthing infections so this is a

7
00:00:23,279 --> 00:00:25,519
talk based on our research for last

8
00:00:25,519 --> 00:00:26,640
couple of months

9
00:00:26,640 --> 00:00:28,720
and we'll take you through some of the

10
00:00:28,720 --> 00:00:30,480
interesting findings

11
00:00:30,480 --> 00:00:33,200
and some real world deployments of iod

12
00:00:33,200 --> 00:00:34,960
cnc panels

13
00:00:34,960 --> 00:00:37,920
so let's get it started so first of all

14
00:00:37,920 --> 00:00:38,800
i will be

15
00:00:38,800 --> 00:00:41,360
thankful to wireless bulletin team for

16
00:00:41,360 --> 00:00:42,160
allowing us

17
00:00:42,160 --> 00:00:44,719
uh to present this research and giving

18
00:00:44,719 --> 00:00:46,399
us the opportunity to share the

19
00:00:46,399 --> 00:00:48,239
intelligence with the

20
00:00:48,239 --> 00:00:51,520
security research community

21
00:00:51,520 --> 00:00:55,280
so before moving further

22
00:00:55,280 --> 00:00:57,840
uh we want to lay a disclaimer here so

23
00:00:57,840 --> 00:00:59,600
all the security research that we are

24
00:00:59,600 --> 00:01:00,960
going to present in this

25
00:01:00,960 --> 00:01:04,239
talk is totally based on our

26
00:01:04,239 --> 00:01:05,840
independent research and it does not

27
00:01:05,840 --> 00:01:08,000
relate to any of our previous or present

28
00:01:08,000 --> 00:01:10,640
employers

29
00:01:11,760 --> 00:01:13,920
so a little bit background of us uh

30
00:01:13,920 --> 00:01:15,520
we've been in this uh

31
00:01:15,520 --> 00:01:18,479
industry for more than 12 years uh you

32
00:01:18,479 --> 00:01:18,880
know

33
00:01:18,880 --> 00:01:21,439
contributed to the security research

34
00:01:21,439 --> 00:01:24,000
community in multiple ways

35
00:01:24,000 --> 00:01:26,320
so you can visit our websites here and

36
00:01:26,320 --> 00:01:28,159
get a glimpse of it what we have done in

37
00:01:28,159 --> 00:01:31,759
the past and what we are up to

38
00:01:33,600 --> 00:01:36,880
okay so what is our agenda today

39
00:01:36,880 --> 00:01:38,560
right so we're going to first take a

40
00:01:38,560 --> 00:01:41,360
look into why iod threat or botnets

41
00:01:41,360 --> 00:01:44,240
exist right a brief history of iot

42
00:01:44,240 --> 00:01:45,680
botnets

43
00:01:45,680 --> 00:01:48,640
detecting hunting iot bots and cnc

44
00:01:48,640 --> 00:01:50,159
panels

45
00:01:50,159 --> 00:01:52,000
we'll take a look into the compromising

46
00:01:52,000 --> 00:01:54,079
cnc panels whatever are the techniques

47
00:01:54,079 --> 00:01:55,920
that we can opt for

48
00:01:55,920 --> 00:01:58,479
to go ahead with it and then look into

49
00:01:58,479 --> 00:01:59,040
multiple

50
00:01:59,040 --> 00:02:01,439
iot partners cnc panels that we have

51
00:02:01,439 --> 00:02:02,079
found

52
00:02:02,079 --> 00:02:05,360
and compromised uh during the course of

53
00:02:05,360 --> 00:02:06,240
this research

54
00:02:06,240 --> 00:02:08,080
so that you actually get a glimpse of it

55
00:02:08,080 --> 00:02:11,038
what exactly how it looks like

56
00:02:11,038 --> 00:02:12,800
and then we have some demonstrations to

57
00:02:12,800 --> 00:02:14,400
actually show you you know

58
00:02:14,400 --> 00:02:16,080
the kind of research we have done and

59
00:02:16,080 --> 00:02:17,680
i'd give you a glimpse of it you know

60
00:02:17,680 --> 00:02:18,400
what

61
00:02:18,400 --> 00:02:22,800
exactly the research entails too

62
00:02:22,800 --> 00:02:24,640
so let's take a look into why iot

63
00:02:24,640 --> 00:02:26,560
threads or botnets exist right

64
00:02:26,560 --> 00:02:30,000
so if you look a couple of this media

65
00:02:30,000 --> 00:02:32,959
captures that i have presented here so

66
00:02:32,959 --> 00:02:34,000
in this case

67
00:02:34,000 --> 00:02:38,080
so it looks like iot devices

68
00:02:38,080 --> 00:02:40,160
are the forefront of exploitation these

69
00:02:40,160 --> 00:02:41,440
days

70
00:02:41,440 --> 00:02:43,440
and the reason for that is because the

71
00:02:43,440 --> 00:02:44,560
more and more

72
00:02:44,560 --> 00:02:46,720
the world is becoming connected these

73
00:02:46,720 --> 00:02:48,560
devices are going to play a significant

74
00:02:48,560 --> 00:02:50,640
role for example you know mobile phones

75
00:02:50,640 --> 00:02:53,599
for example network-based iot devices

76
00:02:53,599 --> 00:02:56,400
and sort of things most of these devices

77
00:02:56,400 --> 00:02:58,319
are connected to the internet

78
00:02:58,319 --> 00:03:00,159
which means that if there's a problem in

79
00:03:00,159 --> 00:03:02,080
the configuration and there any kind of

80
00:03:02,080 --> 00:03:03,519
scary flaw

81
00:03:03,519 --> 00:03:06,640
in the way these devices are deployed

82
00:03:06,640 --> 00:03:08,800
this could go into a problematic

83
00:03:08,800 --> 00:03:10,879
scenario because attackers can go after

84
00:03:10,879 --> 00:03:12,400
these devices and utilize

85
00:03:12,400 --> 00:03:15,519
them for nefarious purposes so looking

86
00:03:15,519 --> 00:03:16,640
at the

87
00:03:16,640 --> 00:03:19,200
some of these uh you know media reports

88
00:03:19,200 --> 00:03:21,120
you can clearly see the kind of world we

89
00:03:21,120 --> 00:03:22,879
are living in and the kind of threats

90
00:03:22,879 --> 00:03:24,720
that we are actually

91
00:03:24,720 --> 00:03:28,959
uh looking to see in the coming time

92
00:03:28,959 --> 00:03:30,560
you know we are entering into energy

93
00:03:30,560 --> 00:03:32,640
markets where you know iot partners

94
00:03:32,640 --> 00:03:33,920
going to manipulate them

95
00:03:33,920 --> 00:03:36,799
at that market as well infrastructure

96
00:03:36,799 --> 00:03:38,159
you know manufacturing

97
00:03:38,159 --> 00:03:40,319
that's a one part of it but even for our

98
00:03:40,319 --> 00:03:41,920
day-to-day routine

99
00:03:41,920 --> 00:03:44,799
uh purposes right iot devices are being

100
00:03:44,799 --> 00:03:46,720
exploited a lot and we'll take a deep

101
00:03:46,720 --> 00:03:47,840
dive into

102
00:03:47,840 --> 00:03:50,879
it down the line but it's a realistic

103
00:03:50,879 --> 00:03:51,519
problem

104
00:03:51,519 --> 00:03:54,560
so we need a realistic solution for it

105
00:03:54,560 --> 00:03:56,319
but even before going into you know

106
00:03:56,319 --> 00:03:58,720
developing or some kind of strong

107
00:03:58,720 --> 00:04:01,519
scary solutions to defend against these

108
00:04:01,519 --> 00:04:02,640
attacks

109
00:04:02,640 --> 00:04:05,040
we really need to understand you know

110
00:04:05,040 --> 00:04:06,720
how these attacks occur

111
00:04:06,720 --> 00:04:08,400
and how we really need to gain

112
00:04:08,400 --> 00:04:11,360
intelligence out of it

113
00:04:11,360 --> 00:04:14,560
so let's take a look into a potential

114
00:04:14,560 --> 00:04:15,280
view of

115
00:04:15,280 --> 00:04:21,440
botnet history so starting from 2008

116
00:04:21,440 --> 00:04:24,000
until now we have seen many different

117
00:04:24,000 --> 00:04:26,800
variants of related to iot partners

118
00:04:26,800 --> 00:04:31,120
these partners are very specific to um

119
00:04:31,120 --> 00:04:33,680
devices or they are being used as a

120
00:04:33,680 --> 00:04:35,360
broad-based partners which means like

121
00:04:35,360 --> 00:04:37,680
they're actually going to go after multi

122
00:04:37,680 --> 00:04:39,919
uh you know different types of devices

123
00:04:39,919 --> 00:04:41,360
irrespective of the

124
00:04:41,360 --> 00:04:43,759
you know categorization and then just

125
00:04:43,759 --> 00:04:45,600
try to simply build a botnet out of it

126
00:04:45,600 --> 00:04:47,600
but there are certain botnets

127
00:04:47,600 --> 00:04:49,520
we are actually going to target very

128
00:04:49,520 --> 00:04:52,160
specific iot devices

129
00:04:52,160 --> 00:04:55,040
irrespective of all that you know there

130
00:04:55,040 --> 00:04:57,759
are a lot of partners that have been uh

131
00:04:57,759 --> 00:04:59,600
you know developed in the last many

132
00:04:59,600 --> 00:05:02,720
years interesting one the

133
00:05:02,720 --> 00:05:05,120
resurgence happened with the mirai and

134
00:05:05,120 --> 00:05:07,039
then we have seen that how mirai code

135
00:05:07,039 --> 00:05:07,680
has been

136
00:05:07,680 --> 00:05:10,320
reused multiple times to build

137
00:05:10,320 --> 00:05:12,560
additional set of iot partners

138
00:05:12,560 --> 00:05:14,240
with different kind of functionalities

139
00:05:14,240 --> 00:05:17,199
that adhere to or the way attacker

140
00:05:17,199 --> 00:05:20,479
wanna go after so they build amend the

141
00:05:20,479 --> 00:05:20,880
code

142
00:05:20,880 --> 00:05:24,880
accordingly that suits their agenda

143
00:05:24,880 --> 00:05:26,720
to actually trigger infections and build

144
00:05:26,720 --> 00:05:28,720
botnets but the history

145
00:05:28,720 --> 00:05:30,720
you look at we are dealing with these uh

146
00:05:30,720 --> 00:05:33,199
iot partners for a long period of time

147
00:05:33,199 --> 00:05:35,680
but these days the volumes are pretty

148
00:05:35,680 --> 00:05:37,360
high as opposed to what we have seen

149
00:05:37,360 --> 00:05:39,840
earlier

150
00:05:40,560 --> 00:05:43,280
now so we're going to take a deep dive

151
00:05:43,280 --> 00:05:45,199
into detecting and hunting of iot

152
00:05:45,199 --> 00:05:47,520
binaries and cnc panels

153
00:05:47,520 --> 00:05:49,600
and there are a couple of uh you know

154
00:05:49,600 --> 00:05:51,440
pretty interesting techniques that we

155
00:05:51,440 --> 00:05:52,880
have opted

156
00:05:52,880 --> 00:05:56,240
to actually go after at first

157
00:05:56,240 --> 00:05:58,960
detection of iot binaries and then how

158
00:05:58,960 --> 00:05:59,680
we actually

159
00:05:59,680 --> 00:06:02,720
went after you know detecting cnc panels

160
00:06:02,720 --> 00:06:04,880
you can similarly of these techniques in

161
00:06:04,880 --> 00:06:07,840
your day-to-day routine

162
00:06:07,919 --> 00:06:12,000
jobs to actually detect the cnc panels

163
00:06:12,000 --> 00:06:15,039
remember visualization which means you

164
00:06:15,039 --> 00:06:17,120
really need to first find out

165
00:06:17,120 --> 00:06:20,160
where are these cnc panels located

166
00:06:20,160 --> 00:06:22,160
and then at the end of the day once you

167
00:06:22,160 --> 00:06:23,759
detect these panels then you can

168
00:06:23,759 --> 00:06:25,199
actually go after

169
00:06:25,199 --> 00:06:28,080
compromising them so it is very very

170
00:06:28,080 --> 00:06:30,720
important how you're going to detect

171
00:06:30,720 --> 00:06:33,280
where the bot is communicating back to

172
00:06:33,280 --> 00:06:34,000
the

173
00:06:34,000 --> 00:06:36,720
command and control servers so let's

174
00:06:36,720 --> 00:06:38,240
take a look into the very first

175
00:06:38,240 --> 00:06:40,000
important part is by mapping the remote

176
00:06:40,000 --> 00:06:40,800
servers

177
00:06:40,800 --> 00:06:43,120
which means that you really need to find

178
00:06:43,120 --> 00:06:45,360
out where exactly the iot

179
00:06:45,360 --> 00:06:49,039
bots or iot binaries are located

180
00:06:49,039 --> 00:06:51,039
because what happened in a simple uh you

181
00:06:51,039 --> 00:06:52,319
know infection

182
00:06:52,319 --> 00:06:55,199
model that once you exploit our iot

183
00:06:55,199 --> 00:06:56,880
device and then you actually create a

184
00:06:56,880 --> 00:06:57,599
temporary

185
00:06:57,599 --> 00:06:59,919
file and then you basically utilize the

186
00:06:59,919 --> 00:07:02,880
already present

187
00:07:02,880 --> 00:07:05,680
command tools such as curl wk to fetch

188
00:07:05,680 --> 00:07:07,680
these files from the remote servers

189
00:07:07,680 --> 00:07:10,720
and then installing bot binders into

190
00:07:10,720 --> 00:07:12,880
this compromise iot devices

191
00:07:12,880 --> 00:07:14,319
and then these devices are starting

192
00:07:14,319 --> 00:07:15,840
connecting back to their command and

193
00:07:15,840 --> 00:07:17,599
control servers

194
00:07:17,599 --> 00:07:19,520
to actually transmit the data back and

195
00:07:19,520 --> 00:07:21,120
then you know steal

196
00:07:21,120 --> 00:07:22,960
uh very interesting or sensitive

197
00:07:22,960 --> 00:07:25,599
information out of the iot devices

198
00:07:25,599 --> 00:07:27,759
so what are the different techniques you

199
00:07:27,759 --> 00:07:28,800
know

200
00:07:28,800 --> 00:07:30,800
if you go for a broad-based scanning you

201
00:07:30,800 --> 00:07:33,199
can actually go after

202
00:07:33,199 --> 00:07:36,639
you know detecting you know indexed uh

203
00:07:36,639 --> 00:07:39,120
directories on the remote http servers

204
00:07:39,120 --> 00:07:40,479
and then you can also build certain

205
00:07:40,479 --> 00:07:43,120
signatures for different architectures

206
00:07:43,120 --> 00:07:44,639
which means that let's say if there's a

207
00:07:44,639 --> 00:07:46,720
file which is going to run on x86

208
00:07:46,720 --> 00:07:47,599
architecture

209
00:07:47,599 --> 00:07:50,479
on a mips one and few others so you can

210
00:07:50,479 --> 00:07:52,400
build that and keep on scanning the open

211
00:07:52,400 --> 00:07:54,720
or exposed

212
00:07:54,720 --> 00:07:58,479
indexed directories anonymous ft servers

213
00:07:58,479 --> 00:08:01,520
are also being used uh reason for that

214
00:08:01,520 --> 00:08:02,879
is you can you can actually

215
00:08:02,879 --> 00:08:05,680
you know basically dump a couple of bot

216
00:08:05,680 --> 00:08:06,560
binaries there

217
00:08:06,560 --> 00:08:08,160
and since there's anonymous access

218
00:08:08,160 --> 00:08:09,759
anybody can access to it

219
00:08:09,759 --> 00:08:11,759
and then from compromise iot device they

220
00:08:11,759 --> 00:08:13,599
can fetch more binaries out of it

221
00:08:13,599 --> 00:08:16,000
or are direct downloadable links to the

222
00:08:16,000 --> 00:08:17,520
bot binaries

223
00:08:17,520 --> 00:08:19,759
another interesting point where we

224
00:08:19,759 --> 00:08:21,280
actually want to go after

225
00:08:21,280 --> 00:08:24,479
you know how we can detect cnc panels

226
00:08:24,479 --> 00:08:27,120
so hard coded cnc server ip addresses

227
00:08:27,120 --> 00:08:28,240
and bot binaries

228
00:08:28,240 --> 00:08:30,639
so when you reverse certain bot binaries

229
00:08:30,639 --> 00:08:31,840
cnc panel

230
00:08:31,840 --> 00:08:33,760
uh you know identification which means

231
00:08:33,760 --> 00:08:35,679
like the ip addresses are hard coded

232
00:08:35,679 --> 00:08:36,479
into it

233
00:08:36,479 --> 00:08:38,479
and when as soon as the bot is installed

234
00:08:38,479 --> 00:08:40,320
on the iot device it connects back and

235
00:08:40,320 --> 00:08:40,958
starts

236
00:08:40,958 --> 00:08:42,640
you know transmitting the data back to

237
00:08:42,640 --> 00:08:44,240
the command and control server

238
00:08:44,240 --> 00:08:45,760
so you can use reverse engineering

239
00:08:45,760 --> 00:08:47,279
techniques to actually go after

240
00:08:47,279 --> 00:08:49,519
extracting some of the cnc servers

241
00:08:49,519 --> 00:08:53,360
ip addresses another interesting

242
00:08:53,360 --> 00:08:55,839
technique is extracting cnc panel

243
00:08:55,839 --> 00:08:57,200
artifacts from the network traffic

244
00:08:57,200 --> 00:08:59,440
generated by the iot device

245
00:08:59,440 --> 00:09:01,519
so which is very much important because

246
00:09:01,519 --> 00:09:03,360
as soon as you are actually

247
00:09:03,360 --> 00:09:05,440
checking the network level behavior of a

248
00:09:05,440 --> 00:09:07,680
couple of iot devices you can also

249
00:09:07,680 --> 00:09:09,680
detect the kind of traffic that has been

250
00:09:09,680 --> 00:09:11,920
flowing from the iot devices

251
00:09:11,920 --> 00:09:15,120
to the remote servers you can also build

252
00:09:15,120 --> 00:09:16,800
iot device profile as well

253
00:09:16,800 --> 00:09:19,839
because you can select and detect

254
00:09:19,839 --> 00:09:21,680
why this particular iot device is

255
00:09:21,680 --> 00:09:23,360
communicating in such a way and why it

256
00:09:23,360 --> 00:09:25,120
is connecting back to the remote

257
00:09:25,120 --> 00:09:26,720
server which is outside of the

258
00:09:26,720 --> 00:09:29,360
organization just for a one simple

259
00:09:29,360 --> 00:09:34,480
heuristic or a signature or anomaly

260
00:09:34,839 --> 00:09:36,080
detection

261
00:09:36,080 --> 00:09:38,640
and then you can also figure it out you

262
00:09:38,640 --> 00:09:40,240
know where it has been connecting to and

263
00:09:40,240 --> 00:09:41,680
then you can also extract some of the

264
00:09:41,680 --> 00:09:43,279
cnc panel

265
00:09:43,279 --> 00:09:45,519
ip addresses out of the network traffic

266
00:09:45,519 --> 00:09:47,120
one of the interesting thing is that you

267
00:09:47,120 --> 00:09:48,640
know a couple of this mirai variants

268
00:09:48,640 --> 00:09:51,279
have hard codeds or encryption keys

269
00:09:51,279 --> 00:09:53,200
and if you extract the jar encryption

270
00:09:53,200 --> 00:09:55,839
key you are able to actually decrypt the

271
00:09:55,839 --> 00:09:58,240
you know encrypted traffic basically the

272
00:09:58,240 --> 00:09:59,600
data and then you can figure out what

273
00:09:59,600 --> 00:10:01,279
kind of information is being sent to the

274
00:10:01,279 --> 00:10:02,720
cnc panel

275
00:10:02,720 --> 00:10:04,800
we'll take a basically we're going to

276
00:10:04,800 --> 00:10:06,320
look into the you know

277
00:10:06,320 --> 00:10:08,240
small demonstration later on in this

278
00:10:08,240 --> 00:10:09,360
context

279
00:10:09,360 --> 00:10:11,519
memory forensics to extract cnc

280
00:10:11,519 --> 00:10:13,839
information from the active processes

281
00:10:13,839 --> 00:10:16,640
if you see that you know iot partner

282
00:10:16,640 --> 00:10:18,000
operator or designer is

283
00:10:18,000 --> 00:10:19,760
so using some advanced techniques so

284
00:10:19,760 --> 00:10:21,839
some ways that you know whenever the iot

285
00:10:21,839 --> 00:10:22,800
binary

286
00:10:22,800 --> 00:10:24,640
is installed on the compromise iot

287
00:10:24,640 --> 00:10:26,560
device and when it runs

288
00:10:26,560 --> 00:10:29,519
uh the cnc's uh server addresses are

289
00:10:29,519 --> 00:10:31,519
generated on the fly

290
00:10:31,519 --> 00:10:33,279
it's like a dynamic generation of those

291
00:10:33,279 --> 00:10:35,360
addresses and once this processes are

292
00:10:35,360 --> 00:10:37,360
active you can perform memory forensics

293
00:10:37,360 --> 00:10:38,240
to dump

294
00:10:38,240 --> 00:10:41,040
certain kind of uh you know cnc panel ip

295
00:10:41,040 --> 00:10:42,160
addresses out of it

296
00:10:42,160 --> 00:10:45,680
if it is you know present in that

297
00:10:45,680 --> 00:10:48,399
in the design of that iot bot or a

298
00:10:48,399 --> 00:10:50,720
binary

299
00:10:50,720 --> 00:10:52,320
another interesting part is to direct

300
00:10:52,320 --> 00:10:54,240
cnc panelists in a broad based

301
00:10:54,240 --> 00:10:55,440
scanning approach whereas like

302
00:10:55,440 --> 00:10:57,680
identification and reconnaissance of

303
00:10:57,680 --> 00:10:58,959
potential suspicious

304
00:10:58,959 --> 00:11:01,760
iot devices multiple administrative

305
00:11:01,760 --> 00:11:02,560
interfaces

306
00:11:02,560 --> 00:11:06,320
telnet ftp and http so in this case we

307
00:11:06,320 --> 00:11:07,839
are not only going to look after where

308
00:11:07,839 --> 00:11:10,240
the cnc panel resides but we also want

309
00:11:10,240 --> 00:11:12,480
to take a look into

310
00:11:12,480 --> 00:11:14,480
the exposed administrative interfaces of

311
00:11:14,480 --> 00:11:16,000
these iot devices

312
00:11:16,000 --> 00:11:18,800
and then try to actually compromise them

313
00:11:18,800 --> 00:11:20,800
and once you do it and try to

314
00:11:20,800 --> 00:11:22,880
extract certain artifacts out of those

315
00:11:22,880 --> 00:11:24,800
compromised iter devices

316
00:11:24,800 --> 00:11:29,040
to see where exactly the cnc

317
00:11:29,040 --> 00:11:31,920
server is located looking at the way iot

318
00:11:31,920 --> 00:11:34,320
board binary communicates for example

319
00:11:34,320 --> 00:11:36,160
we don't have an access to iot boss

320
00:11:36,160 --> 00:11:37,680
based binary but we are seeing some

321
00:11:37,680 --> 00:11:39,760
suspicious traffic is being generated

322
00:11:39,760 --> 00:11:40,240
from

323
00:11:40,240 --> 00:11:43,360
the iot device and if if

324
00:11:43,360 --> 00:11:45,839
that is the case or we can simply find

325
00:11:45,839 --> 00:11:46,560
that you know

326
00:11:46,560 --> 00:11:48,959
the certain iot device ip addresses are

327
00:11:48,959 --> 00:11:50,480
treated as suspicious so you can

328
00:11:50,480 --> 00:11:52,399
actually basically go after

329
00:11:52,399 --> 00:11:54,720
and try to see if you can basic kind of

330
00:11:54,720 --> 00:11:56,639
compromise the administrative interface

331
00:11:56,639 --> 00:11:58,399
and get into those iot device

332
00:11:58,399 --> 00:12:01,200
and try to see if there are bot binaries

333
00:12:01,200 --> 00:12:02,639
are available there

334
00:12:02,639 --> 00:12:05,040
so there is always this reverse hacking

335
00:12:05,040 --> 00:12:05,760
approach

336
00:12:05,760 --> 00:12:07,120
where we actually going after

337
00:12:07,120 --> 00:12:09,600
compromised iot devices then actually

338
00:12:09,600 --> 00:12:11,760
extracting information related to cnc

339
00:12:11,760 --> 00:12:13,600
panels from there as well

340
00:12:13,600 --> 00:12:15,120
we have tried this approach and it

341
00:12:15,120 --> 00:12:17,279
worked pretty well as well

342
00:12:17,279 --> 00:12:19,279
another interesting technique is broad

343
00:12:19,279 --> 00:12:21,279
scanning of remote servers on the large

344
00:12:21,279 --> 00:12:22,000
scale

345
00:12:22,000 --> 00:12:25,360
based on known indicators the idea is

346
00:12:25,360 --> 00:12:27,680
like you know you can scan broadly

347
00:12:27,680 --> 00:12:30,560
of the remote servers on a large scale

348
00:12:30,560 --> 00:12:32,560
based on known indicators and try to

349
00:12:32,560 --> 00:12:33,279
find out

350
00:12:33,279 --> 00:12:35,760
you know if we see any kind of uh you

351
00:12:35,760 --> 00:12:38,079
know cnc server

352
00:12:38,079 --> 00:12:40,639
for specific bonus available there as

353
00:12:40,639 --> 00:12:41,519
well

354
00:12:41,519 --> 00:12:43,519
so we can use multiple these type of

355
00:12:43,519 --> 00:12:44,800
techniques to actually go after

356
00:12:44,800 --> 00:12:46,320
detecting

357
00:12:46,320 --> 00:12:48,240
the cnc panels now once you have

358
00:12:48,240 --> 00:12:50,399
detected the cnc panel

359
00:12:50,399 --> 00:12:52,720
we really need to go after compromising

360
00:12:52,720 --> 00:12:54,079
it right there a couple of

361
00:12:54,079 --> 00:12:56,000
techniques that you can use but i have

362
00:12:56,000 --> 00:12:57,360
used what we

363
00:12:57,360 --> 00:12:58,720
are discussing here is a couple of

364
00:12:58,720 --> 00:13:01,200
interesting one that we have actually

365
00:13:01,200 --> 00:13:03,360
utilized during our research

366
00:13:03,360 --> 00:13:05,440
compromising front-end interfaces what

367
00:13:05,440 --> 00:13:07,200
that means is like gaining access to the

368
00:13:07,200 --> 00:13:09,200
administrative interfaces

369
00:13:09,200 --> 00:13:11,920
uh so we have detected a cnc panel it

370
00:13:11,920 --> 00:13:13,680
has like a front-end interface

371
00:13:13,680 --> 00:13:15,519
uh depending on what kind of customer

372
00:13:15,519 --> 00:13:17,120
custom protocol

373
00:13:17,120 --> 00:13:20,560
has been used to create and build the

374
00:13:20,560 --> 00:13:22,320
communication channel and the way

375
00:13:22,320 --> 00:13:24,480
administrative interface works

376
00:13:24,480 --> 00:13:26,480
you can conduct brute force attacks to

377
00:13:26,480 --> 00:13:27,519
actually try to

378
00:13:27,519 --> 00:13:29,920
you know gain direct access to the

379
00:13:29,920 --> 00:13:31,839
administrative interface of the cnc

380
00:13:31,839 --> 00:13:33,200
panel

381
00:13:33,200 --> 00:13:35,519
that is the one important part another

382
00:13:35,519 --> 00:13:37,120
interesting part is the compromising the

383
00:13:37,120 --> 00:13:38,240
backend databases

384
00:13:38,240 --> 00:13:41,279
see remember whenever the multi parts

385
00:13:41,279 --> 00:13:43,279
right you know multiple iot bots

386
00:13:43,279 --> 00:13:45,440
residing on compromised iot devices

387
00:13:45,440 --> 00:13:47,440
connecting back to the cnc panel they

388
00:13:47,440 --> 00:13:48,079
need to have

389
00:13:48,079 --> 00:13:50,320
some database at the back end which

390
00:13:50,320 --> 00:13:51,199
means that

391
00:13:51,199 --> 00:13:52,560
all the information related to the

392
00:13:52,560 --> 00:13:54,480
compromised iot parts

393
00:13:54,480 --> 00:13:56,560
are going to store there so in this

394
00:13:56,560 --> 00:13:58,000
technique what we are going to after we

395
00:13:58,000 --> 00:13:58,639
are going

396
00:13:58,639 --> 00:14:02,320
to find like exposed mysql

397
00:14:02,320 --> 00:14:04,639
databases for example mysql is heavily

398
00:14:04,639 --> 00:14:06,880
used as a backend database for cnc

399
00:14:06,880 --> 00:14:07,920
panels

400
00:14:07,920 --> 00:14:08,959
and then actually we are going to

401
00:14:08,959 --> 00:14:10,800
compromise it directly by finding you

402
00:14:10,800 --> 00:14:12,639
know either vulnerabilities in it or

403
00:14:12,639 --> 00:14:14,800
cracking accounts so that you can get a

404
00:14:14,800 --> 00:14:16,560
database account access

405
00:14:16,560 --> 00:14:18,560
and once you get it you can basically go

406
00:14:18,560 --> 00:14:19,839
through all the tables that are

407
00:14:19,839 --> 00:14:21,279
available there and dump

408
00:14:21,279 --> 00:14:23,440
the you know username and passwords for

409
00:14:23,440 --> 00:14:25,440
all the different iot devices

410
00:14:25,440 --> 00:14:28,480
basically iot bots that are

411
00:14:28,480 --> 00:14:29,839
you know running active on the

412
00:14:29,839 --> 00:14:32,160
compromised devices and there are many

413
00:14:32,160 --> 00:14:33,760
scanning tools available we'll take a

414
00:14:33,760 --> 00:14:34,720
look into

415
00:14:34,720 --> 00:14:37,360
one scanning tool later on vulnerability

416
00:14:37,360 --> 00:14:38,240
exploitation

417
00:14:38,240 --> 00:14:39,760
basically going after finding

418
00:14:39,760 --> 00:14:41,760
vulnerabilities into cnc

419
00:14:41,760 --> 00:14:44,560
panels in the custom protocols or for

420
00:14:44,560 --> 00:14:45,279
example

421
00:14:45,279 --> 00:14:48,639
if the cnc panel is using http or telnet

422
00:14:48,639 --> 00:14:50,160
and all that and try to find

423
00:14:50,160 --> 00:14:52,720
vulnerabilities in that and basically

424
00:14:52,720 --> 00:14:55,199
getting direct access to the

425
00:14:55,199 --> 00:14:58,480
cnc panel there using reuse of

426
00:14:58,480 --> 00:15:00,320
credential

427
00:15:00,320 --> 00:15:02,320
this is a very important approach in

428
00:15:02,320 --> 00:15:03,760
this case what we have seen that you

429
00:15:03,760 --> 00:15:05,760
know sometimes you go after compromise

430
00:15:05,760 --> 00:15:06,240
iot

431
00:15:06,240 --> 00:15:09,360
devices and you find out some active uh

432
00:15:09,360 --> 00:15:09,920
you know

433
00:15:09,920 --> 00:15:12,000
credentials username and password and

434
00:15:12,000 --> 00:15:14,240
you build a huge list of those

435
00:15:14,240 --> 00:15:16,800
credentials and basically user using

436
00:15:16,800 --> 00:15:17,360
those

437
00:15:17,360 --> 00:15:20,880
that list of username and passwords to

438
00:15:20,880 --> 00:15:21,360
actually

439
00:15:21,360 --> 00:15:24,240
target cnc panels conducting brute force

440
00:15:24,240 --> 00:15:25,920
or account cracking attempts to see if

441
00:15:25,920 --> 00:15:27,839
you can get access to it so basically

442
00:15:27,839 --> 00:15:29,040
sometimes

443
00:15:29,040 --> 00:15:30,959
um you know these passwords or

444
00:15:30,959 --> 00:15:32,720
credentials that we extracted are of

445
00:15:32,720 --> 00:15:34,720
compromised iot devices they work pretty

446
00:15:34,720 --> 00:15:37,040
well on the cnc panels as well

447
00:15:37,040 --> 00:15:38,959
so reuse credential approach is an

448
00:15:38,959 --> 00:15:40,320
important

449
00:15:40,320 --> 00:15:42,160
technique that you can also use in your

450
00:15:42,160 --> 00:15:45,360
environment to basically go after

451
00:15:45,360 --> 00:15:50,079
compromising iot partners cnc panels

452
00:15:50,079 --> 00:15:51,519
so let's take a look into the

453
00:15:51,519 --> 00:15:53,199
interesting case study so

454
00:15:53,199 --> 00:15:55,279
on this particular slide you can take a

455
00:15:55,279 --> 00:15:58,079
look into one of the mysql scanner

456
00:15:58,079 --> 00:16:00,800
the tool is being designed to actually

457
00:16:00,800 --> 00:16:01,279
go

458
00:16:01,279 --> 00:16:05,440
after uh you know some of the exposed

459
00:16:05,440 --> 00:16:08,160
cnc panels which are running mysql

460
00:16:08,160 --> 00:16:09,120
servers and

461
00:16:09,120 --> 00:16:12,079
as a backend database and basically it's

462
00:16:12,079 --> 00:16:12,720
gonna go

463
00:16:12,720 --> 00:16:15,759
after scanning of those instances

464
00:16:15,759 --> 00:16:19,040
try to find out the you know vulnerable

465
00:16:19,040 --> 00:16:21,600
deployments and once you get an access

466
00:16:21,600 --> 00:16:23,279
to the mysql server

467
00:16:23,279 --> 00:16:25,759
then it's going to go to each and every

468
00:16:25,759 --> 00:16:28,399
single table in that mysql database

469
00:16:28,399 --> 00:16:30,880
to dump all the credentials username

470
00:16:30,880 --> 00:16:31,839
passwords

471
00:16:31,839 --> 00:16:35,279
or anything interesting information

472
00:16:35,279 --> 00:16:38,240
related to iot bots they're running on a

473
00:16:38,240 --> 00:16:39,519
compromised devices

474
00:16:39,519 --> 00:16:41,199
so this is the kind of approach we go

475
00:16:41,199 --> 00:16:43,759
after automating

476
00:16:43,759 --> 00:16:47,120
the uh different techniques so that we

477
00:16:47,120 --> 00:16:48,800
don't spend too much time

478
00:16:48,800 --> 00:16:51,120
into and avoid manual intervention there

479
00:16:51,120 --> 00:16:52,240
just run it

480
00:16:52,240 --> 00:16:53,920
you can use these kind of tools for a

481
00:16:53,920 --> 00:16:55,920
broad-based scanning provide the you

482
00:16:55,920 --> 00:16:56,959
know host list

483
00:16:56,959 --> 00:16:59,279
and then based on the intelligence that

484
00:16:59,279 --> 00:17:00,639
you gathered earlier

485
00:17:00,639 --> 00:17:03,839
and then also provide a list of the cnc

486
00:17:03,839 --> 00:17:04,160
uh

487
00:17:04,160 --> 00:17:06,559
panels including some of the credential

488
00:17:06,559 --> 00:17:07,280
list as well

489
00:17:07,280 --> 00:17:08,799
but it worked pretty well we need to

490
00:17:08,799 --> 00:17:10,799
automate if you really want to go for

491
00:17:10,799 --> 00:17:12,160
broadband scanning

492
00:17:12,160 --> 00:17:14,720
try to ensure that we found multiple

493
00:17:14,720 --> 00:17:16,160
infected

494
00:17:16,160 --> 00:17:19,280
uh you know either iot devices in this

495
00:17:19,280 --> 00:17:19,679
case

496
00:17:19,679 --> 00:17:22,240
or basically more specifically let me

497
00:17:22,240 --> 00:17:24,240
put it in this way is

498
00:17:24,240 --> 00:17:28,000
iot partner cnc panels

499
00:17:29,600 --> 00:17:32,720
so we have discussed la interesting

500
00:17:32,720 --> 00:17:34,080
techniques related to

501
00:17:34,080 --> 00:17:37,200
you know earlier we talked about in

502
00:17:37,200 --> 00:17:39,520
detecting cnc panels detecting

503
00:17:39,520 --> 00:17:41,919
iot binaries and also going after

504
00:17:41,919 --> 00:17:44,240
compromising

505
00:17:44,240 --> 00:17:48,000
some of these cnc panels

506
00:17:48,000 --> 00:17:50,160
this is uh our in-house tool which we

507
00:17:50,160 --> 00:17:51,120
have utilized

508
00:17:51,120 --> 00:17:53,600
earlier the it is very interesting one

509
00:17:53,600 --> 00:17:55,679
the interface is on a telegram the way

510
00:17:55,679 --> 00:17:57,200
we have structured you know utilizing

511
00:17:57,200 --> 00:17:58,799
this tool directly from your mobile as

512
00:17:58,799 --> 00:18:00,400
well you have telegram service the

513
00:18:00,400 --> 00:18:02,559
backend is created in such a way

514
00:18:02,559 --> 00:18:04,400
you can send commands wireless telegram

515
00:18:04,400 --> 00:18:05,919
service and then you can get all the

516
00:18:05,919 --> 00:18:08,080
details of specific ip addresses and all

517
00:18:08,080 --> 00:18:09,200
that

518
00:18:09,200 --> 00:18:10,799
so in this case you can see we have an

519
00:18:10,799 --> 00:18:12,640
iot malware tracker and then we also

520
00:18:12,640 --> 00:18:15,200
have our iot malware sandbox so we have

521
00:18:15,200 --> 00:18:16,880
actually given you a few examples

522
00:18:16,880 --> 00:18:19,760
and um we just simply send a command

523
00:18:19,760 --> 00:18:21,039
like here

524
00:18:21,039 --> 00:18:23,200
cnc online so it's gonna give us what

525
00:18:23,200 --> 00:18:25,280
are the iot cnc servers that are

526
00:18:25,280 --> 00:18:27,520
online based on the techniques that we

527
00:18:27,520 --> 00:18:29,120
have discussed earlier

528
00:18:29,120 --> 00:18:31,679
and if we want to run iot you know

529
00:18:31,679 --> 00:18:32,559
sandbox

530
00:18:32,559 --> 00:18:35,600
uh execution for uh in fa kind of

531
00:18:35,600 --> 00:18:38,240
specific iot binary you can also do that

532
00:18:38,240 --> 00:18:40,160
provide the url that is gonna do and

533
00:18:40,160 --> 00:18:42,320
conduct all the behavior analysis

534
00:18:42,320 --> 00:18:44,240
so this is how in house we have

535
00:18:44,240 --> 00:18:45,360
automated it

536
00:18:45,360 --> 00:18:48,320
and we utilize this approach for a

537
00:18:48,320 --> 00:18:49,200
couple of months

538
00:18:49,200 --> 00:18:51,760
and utilizing and we keep on updating

539
00:18:51,760 --> 00:18:53,440
our techniques and tactics that we have

540
00:18:53,440 --> 00:18:55,440
discussed earlier

541
00:18:55,440 --> 00:18:56,720
i hope this one isn't a pretty

542
00:18:56,720 --> 00:18:59,200
interesting

543
00:18:59,360 --> 00:19:01,919
you know tool to look at uh and you can

544
00:19:01,919 --> 00:19:03,520
also go after building these kind of

545
00:19:03,520 --> 00:19:06,240
similar tools as well

546
00:19:06,240 --> 00:19:08,400
now let's talk a little bit about fun

547
00:19:08,400 --> 00:19:09,760
and profit here right

548
00:19:09,760 --> 00:19:12,000
sometimes you know you can go after

549
00:19:12,000 --> 00:19:14,960
compromising the cnc panels

550
00:19:14,960 --> 00:19:18,799
and sometimes you could easily find out

551
00:19:18,799 --> 00:19:20,160
that you know you're not able to

552
00:19:20,160 --> 00:19:21,440
compromise

553
00:19:21,440 --> 00:19:23,039
uh you know the remote server running

554
00:19:23,039 --> 00:19:24,559
cnc panel

555
00:19:24,559 --> 00:19:27,679
for iot specific iot partners but then

556
00:19:27,679 --> 00:19:29,120
there's that you know approach that we

557
00:19:29,120 --> 00:19:30,080
used to follow

558
00:19:30,080 --> 00:19:31,840
go for a crash and a kill right what

559
00:19:31,840 --> 00:19:33,679
that means is that you know

560
00:19:33,679 --> 00:19:35,440
is it possible that you can actually

561
00:19:35,440 --> 00:19:38,000
crash the remote cnc server

562
00:19:38,000 --> 00:19:41,280
uh and it you might not be able to

563
00:19:41,280 --> 00:19:43,360
compromise it completely but at least

564
00:19:43,360 --> 00:19:45,360
you know you're able to have some fun

565
00:19:45,360 --> 00:19:47,200
there as well

566
00:19:47,200 --> 00:19:49,919
so it is based on like you know for

567
00:19:49,919 --> 00:19:51,440
crashing remote services

568
00:19:51,440 --> 00:19:53,039
literally based on the research where

569
00:19:53,039 --> 00:19:54,000
you actually found some kind of

570
00:19:54,000 --> 00:19:56,400
vulnerability or a design flaw in

571
00:19:56,400 --> 00:19:58,880
some of the iot pod binaries or the way

572
00:19:58,880 --> 00:19:59,760
iot

573
00:19:59,760 --> 00:20:02,880
cnc panels are deployed because they

574
00:20:02,880 --> 00:20:04,559
have to create some network service and

575
00:20:04,559 --> 00:20:06,080
then you connect to that network service

576
00:20:06,080 --> 00:20:07,679
and then you're gonna get access to the

577
00:20:07,679 --> 00:20:09,200
cnc panel

578
00:20:09,200 --> 00:20:11,520
so one of the one like um the majority

579
00:20:11,520 --> 00:20:13,200
of the mirai variant has

580
00:20:13,200 --> 00:20:16,240
some issues associated with it you know

581
00:20:16,240 --> 00:20:17,520
if you look for the vulnerability

582
00:20:17,520 --> 00:20:19,200
detection point of view you can actually

583
00:20:19,200 --> 00:20:21,280
go after analyze the source code detect

584
00:20:21,280 --> 00:20:22,080
for

585
00:20:22,080 --> 00:20:24,720
you know buffer allocation functions and

586
00:20:24,720 --> 00:20:26,320
then try to see how the buffers have

587
00:20:26,320 --> 00:20:28,640
been allocated if there any kind of

588
00:20:28,640 --> 00:20:30,799
you know buffer has been bounded for

589
00:20:30,799 --> 00:20:32,480
specific ranges

590
00:20:32,480 --> 00:20:34,640
and if not you try to see what kind of

591
00:20:34,640 --> 00:20:36,080
limit has been set up there

592
00:20:36,080 --> 00:20:37,679
if you know the limit you can actually

593
00:20:37,679 --> 00:20:39,760
trigger some buffer overflows there

594
00:20:39,760 --> 00:20:43,200
to actually crash the network service

595
00:20:43,200 --> 00:20:46,480
sporting cnc panel functionalities so in

596
00:20:46,480 --> 00:20:48,240
this case this is what happens

597
00:20:48,240 --> 00:20:50,480
when you actually go after uh you know

598
00:20:50,480 --> 00:20:52,400
mirai or some of its related

599
00:20:52,400 --> 00:20:55,760
variants uh uh cnc panels you can

600
00:20:55,760 --> 00:20:57,120
basically use this code

601
00:20:57,120 --> 00:20:59,600
create a socket create a buffer if you

602
00:20:59,600 --> 00:21:01,280
can send it up continuously

603
00:21:01,280 --> 00:21:03,600
you can basically crash so in this case

604
00:21:03,600 --> 00:21:05,039
is that you know research is not

605
00:21:05,039 --> 00:21:07,440
entirely sometimes focused on um

606
00:21:07,440 --> 00:21:09,440
you know compromising cnc panels for

607
00:21:09,440 --> 00:21:11,360
building intelligence and sharing that

608
00:21:11,360 --> 00:21:13,039
intelligence with the security research

609
00:21:13,039 --> 00:21:13,919
community

610
00:21:13,919 --> 00:21:16,000
so that we can build strong solutions

611
00:21:16,000 --> 00:21:18,000
but it also depends upon detecting some

612
00:21:18,000 --> 00:21:19,919
vulnerabilities in those

613
00:21:19,919 --> 00:21:22,640
cnc panel software as well this is one

614
00:21:22,640 --> 00:21:24,720
simple example we want to talk about it

615
00:21:24,720 --> 00:21:26,400
so that you can a glimpse of it and you

616
00:21:26,400 --> 00:21:28,400
can you know do more research based on

617
00:21:28,400 --> 00:21:29,679
these kind of things when you are

618
00:21:29,679 --> 00:21:30,880
analyzing the

619
00:21:30,880 --> 00:21:34,159
source code or binaries

620
00:21:34,159 --> 00:21:36,880
now so let's just revisit you know we

621
00:21:36,880 --> 00:21:38,080
started with

622
00:21:38,080 --> 00:21:39,919
you know why what is the iot partner

623
00:21:39,919 --> 00:21:42,080
history looks like why iot

624
00:21:42,080 --> 00:21:44,000
uh you know threats and botnets matter

625
00:21:44,000 --> 00:21:45,280
you know some of the interesting

626
00:21:45,280 --> 00:21:46,640
techniques related to

627
00:21:46,640 --> 00:21:49,280
you know iot bots um hunting and

628
00:21:49,280 --> 00:21:52,400
detection of iot binaries and cnc panels

629
00:21:52,400 --> 00:21:53,600
then we look into some of the

630
00:21:53,600 --> 00:21:55,600
interesting artifacts related how to

631
00:21:55,600 --> 00:21:57,520
actually go after compromising cnc

632
00:21:57,520 --> 00:21:59,120
panels

633
00:21:59,120 --> 00:22:01,200
we also went through one of the source

634
00:22:01,200 --> 00:22:03,039
code

635
00:22:03,039 --> 00:22:04,880
which is related to one of the mysql

636
00:22:04,880 --> 00:22:06,320
scanner to conduct

637
00:22:06,320 --> 00:22:10,240
automated detection of backend

638
00:22:10,240 --> 00:22:12,240
databases using cnc panels and

639
00:22:12,240 --> 00:22:13,600
enumerating

640
00:22:13,600 --> 00:22:16,960
the uh iot bot tables on the fly once

641
00:22:16,960 --> 00:22:17,679
you

642
00:22:17,679 --> 00:22:20,320
get an access to the database then we

643
00:22:20,320 --> 00:22:21,360
take a look into

644
00:22:21,360 --> 00:22:23,360
some of the interesting uh you know

645
00:22:23,360 --> 00:22:25,360
tools that we have developed in-house

646
00:22:25,360 --> 00:22:27,440
a telegram based front-end with the

647
00:22:27,440 --> 00:22:28,720
back-end to actually

648
00:22:28,720 --> 00:22:31,679
build iot tracker and the malware

649
00:22:31,679 --> 00:22:33,280
detection service

650
00:22:33,280 --> 00:22:35,679
and then we actually went through some

651
00:22:35,679 --> 00:22:37,600
of the fun and profit scenarios you know

652
00:22:37,600 --> 00:22:40,080
how certain vulnerabilities not uh you

653
00:22:40,080 --> 00:22:41,280
know help you to create

654
00:22:41,280 --> 00:22:43,840
uh an exploit where you can complete

655
00:22:43,840 --> 00:22:45,440
compromise but you get at least crash

656
00:22:45,440 --> 00:22:47,280
certain cnc panels and that can be

657
00:22:47,280 --> 00:22:50,159
useful in certain scenarios as well

658
00:22:50,159 --> 00:22:52,000
so after going through all these things

659
00:22:52,000 --> 00:22:53,679
and going through techniques and tactics

660
00:22:53,679 --> 00:22:54,960
now take a look into

661
00:22:54,960 --> 00:22:58,240
a multiple iot box cnc panels

662
00:22:58,240 --> 00:23:00,720
uh what that entails to what we are

663
00:23:00,720 --> 00:23:01,679
going to show

664
00:23:01,679 --> 00:23:05,440
uh you here is a couple of cnc panels

665
00:23:05,440 --> 00:23:07,200
that have been compromised based on the

666
00:23:07,200 --> 00:23:08,480
techniques that we have discussed

667
00:23:08,480 --> 00:23:09,280
earlier

668
00:23:09,280 --> 00:23:10,640
and this will actually gives you the

669
00:23:10,640 --> 00:23:14,400
flavor how it looks like

670
00:23:15,280 --> 00:23:19,440
so now in this look at this particular

671
00:23:19,440 --> 00:23:21,440
slide you can actually get a feel of you

672
00:23:21,440 --> 00:23:24,320
know how the mana iot partner cnc panel

673
00:23:24,320 --> 00:23:25,760
looks like right

674
00:23:25,760 --> 00:23:28,240
so once you get into the cnc panel it

675
00:23:28,240 --> 00:23:29,919
actually shows you a lot of

676
00:23:29,919 --> 00:23:33,200
uh different commands that it sports and

677
00:23:33,200 --> 00:23:34,159
then if you look at

678
00:23:34,159 --> 00:23:36,159
some of the dos modules it can tell you

679
00:23:36,159 --> 00:23:38,080
what kind of denial or service attacks

680
00:23:38,080 --> 00:23:39,360
it can trigger

681
00:23:39,360 --> 00:23:41,919
from there and basically is going to

682
00:23:41,919 --> 00:23:43,679
tell most of their compromised iot

683
00:23:43,679 --> 00:23:45,200
devices to start la

684
00:23:45,200 --> 00:23:47,440
you know launch of denial of service

685
00:23:47,440 --> 00:23:49,600
targeting specific ips

686
00:23:49,600 --> 00:23:52,720
or basically go after

687
00:23:52,720 --> 00:23:54,400
impacting the availability of remote

688
00:23:54,400 --> 00:23:56,400
servers

689
00:23:56,400 --> 00:23:58,880
interesting one now look at the another

690
00:23:58,880 --> 00:24:02,000
example of vivid iot botnet cnc panel

691
00:24:02,000 --> 00:24:04,080
you can get a glimpse of it how this iot

692
00:24:04,080 --> 00:24:05,919
partner cnc panel looks like

693
00:24:05,919 --> 00:24:07,919
similarly we're just you know giving you

694
00:24:07,919 --> 00:24:08,960
a few

695
00:24:08,960 --> 00:24:11,760
uh you know overview of you know how the

696
00:24:11,760 --> 00:24:13,600
server stats look like you know what is

697
00:24:13,600 --> 00:24:15,520
the cost associated with launching the

698
00:24:15,520 --> 00:24:16,880
denial of service and

699
00:24:16,880 --> 00:24:18,559
you know sort of things but this

700
00:24:18,559 --> 00:24:21,120
actually gives you the idea how

701
00:24:21,120 --> 00:24:24,240
the iot botnet operators operate in real

702
00:24:24,240 --> 00:24:28,240
time and how the cnc panel looks like

703
00:24:29,200 --> 00:24:30,880
take a look into the another example

704
00:24:30,880 --> 00:24:34,159
here is a kawai iot partner cnc panel

705
00:24:34,159 --> 00:24:36,000
you can get a feel of it how it looks

706
00:24:36,000 --> 00:24:38,240
like

707
00:24:39,039 --> 00:24:41,600
another one is a verizon iot partner cnc

708
00:24:41,600 --> 00:24:42,480
panel

709
00:24:42,480 --> 00:24:44,400
and you can clearly see you know once

710
00:24:44,400 --> 00:24:46,240
you log in into that uh you know command

711
00:24:46,240 --> 00:24:48,080
and control panel how much

712
00:24:48,080 --> 00:24:50,799
you know uh infections have been

713
00:24:50,799 --> 00:24:51,279
triggered

714
00:24:51,279 --> 00:24:53,520
already what kind of commands that are

715
00:24:53,520 --> 00:24:55,520
available and then what kind of denial

716
00:24:55,520 --> 00:24:57,120
or service modules that are available

717
00:24:57,120 --> 00:24:58,480
that you can trigger

718
00:24:58,480 --> 00:25:01,440
uh i'll give you a quick demo of this uh

719
00:25:01,440 --> 00:25:03,520
cnc panel as well later on

720
00:25:03,520 --> 00:25:05,279
so that you can get a feel of it how it

721
00:25:05,279 --> 00:25:07,440
looks like

722
00:25:07,440 --> 00:25:09,679
and another one interesting example is

723
00:25:09,679 --> 00:25:12,159
the goon iot bottom and it basically

724
00:25:12,159 --> 00:25:14,240
you know another iot botnet that

725
00:25:14,240 --> 00:25:15,919
actually go after

726
00:25:15,919 --> 00:25:18,480
you know launching different type of

727
00:25:18,480 --> 00:25:19,279
attacks

728
00:25:19,279 --> 00:25:21,600
uh from the compromised iot devices but

729
00:25:21,600 --> 00:25:24,159
once you get inside of the iot panel

730
00:25:24,159 --> 00:25:26,720
you can get a feel of it how it kind of

731
00:25:26,720 --> 00:25:28,640
look like

732
00:25:28,640 --> 00:25:31,360
now at this point of time you can get a

733
00:25:31,360 --> 00:25:32,480
you know flavor of

734
00:25:32,480 --> 00:25:35,039
couple of different cnc panels uh that

735
00:25:35,039 --> 00:25:36,559
we have discussed

736
00:25:36,559 --> 00:25:39,880
uh and basically we found you know uh

737
00:25:39,880 --> 00:25:43,039
compromising scenario uh where we

738
00:25:43,039 --> 00:25:44,799
actually able to penetrate into those

739
00:25:44,799 --> 00:25:45,840
panels

740
00:25:45,840 --> 00:25:47,919
and then able to give you a glimpse of

741
00:25:47,919 --> 00:25:50,080
it how it looks like in real time

742
00:25:50,080 --> 00:25:51,840
but even if you are doing an interesting

743
00:25:51,840 --> 00:25:53,440
research on this you can use the same

744
00:25:53,440 --> 00:25:55,520
techniques and tactics and you can build

745
00:25:55,520 --> 00:25:56,799
very you know

746
00:25:56,799 --> 00:26:00,240
intelligence uh pool with multitude of

747
00:26:00,240 --> 00:26:01,200
resources

748
00:26:01,200 --> 00:26:03,200
and then you know different uh signature

749
00:26:03,200 --> 00:26:04,880
heuristics you know

750
00:26:04,880 --> 00:26:07,200
and only detection based indicators and

751
00:26:07,200 --> 00:26:09,120
you can go after launching

752
00:26:09,120 --> 00:26:11,760
a large-scale scanning in a controlled

753
00:26:11,760 --> 00:26:14,080
fashion to detect these kind of

754
00:26:14,080 --> 00:26:17,279
devices and basically coming up within a

755
00:26:17,279 --> 00:26:19,279
building of security solutions there we

756
00:26:19,279 --> 00:26:21,279
can actually detect and prevent

757
00:26:21,279 --> 00:26:24,400
against these kind of attacks now let's

758
00:26:24,400 --> 00:26:26,799
go through some a couple of interesting

759
00:26:26,799 --> 00:26:29,919
demos and take a look into it

760
00:26:29,919 --> 00:26:31,679
the very first one this is related to

761
00:26:31,679 --> 00:26:33,760
extracting the zorki out of the

762
00:26:33,760 --> 00:26:36,400
mirai and couple of related variants and

763
00:26:36,400 --> 00:26:38,240
once you extract this kind of zorky it

764
00:26:38,240 --> 00:26:39,039
is very

765
00:26:39,039 --> 00:26:41,760
easy for you to actually decrypt all the

766
00:26:41,760 --> 00:26:43,840
network traffic basically the data that

767
00:26:43,840 --> 00:26:46,480
is sent from the compromised

768
00:26:46,480 --> 00:26:50,640
iot devices to the cnc panel

769
00:26:50,640 --> 00:26:52,640
so this actually gives you a why reverse

770
00:26:52,640 --> 00:26:54,080
engineering is important

771
00:26:54,080 --> 00:26:55,679
and how we can actually utilize to

772
00:26:55,679 --> 00:26:57,760
detect cnc panel because if network

773
00:26:57,760 --> 00:26:59,440
traffic is going on data is going

774
00:26:59,440 --> 00:27:00,799
through the remote server you have the

775
00:27:00,799 --> 00:27:01,679
identity

776
00:27:01,679 --> 00:27:03,200
but what kind of additional data is

777
00:27:03,200 --> 00:27:04,720
being sent by that

778
00:27:04,720 --> 00:27:06,640
compromised iot device so let's take a

779
00:27:06,640 --> 00:27:09,039
look at it

780
00:27:09,279 --> 00:27:11,520
so in this case uh you know we are gonna

781
00:27:11,520 --> 00:27:12,880
use radari

782
00:27:12,880 --> 00:27:15,120
and to actually look into some of the

783
00:27:15,120 --> 00:27:16,960
you know one of the one level

784
00:27:16,960 --> 00:27:20,240
version uh i won't say one level version

785
00:27:20,240 --> 00:27:22,000
it is basically one of the iot bot

786
00:27:22,000 --> 00:27:24,000
binder here

787
00:27:24,000 --> 00:27:25,520
and we're basically going into the

788
00:27:25,520 --> 00:27:28,799
disassembly mode here

789
00:27:32,240 --> 00:27:33,840
you can see like it starts searching for

790
00:27:33,840 --> 00:27:36,000
12 bytes in a specific memory address

791
00:27:36,000 --> 00:27:37,919
range

792
00:27:37,919 --> 00:27:39,520
and we are basically here looking into

793
00:27:39,520 --> 00:27:42,559
specific offsets

794
00:27:42,799 --> 00:27:45,279
and you can see that you know after uh

795
00:27:45,279 --> 00:27:46,880
disassembly

796
00:27:46,880 --> 00:27:48,720
we are able to extract some of the you

797
00:27:48,720 --> 00:27:50,480
know x86

798
00:27:50,480 --> 00:27:52,240
uh instructions here how it is being

799
00:27:52,240 --> 00:27:55,840
performed what is exactly looks like

800
00:27:55,919 --> 00:27:58,720
and now you can clearly see this is the

801
00:27:58,720 --> 00:27:59,120
this

802
00:27:59,120 --> 00:28:02,320
is the string and this is the primarily

803
00:28:02,320 --> 00:28:04,080
most important

804
00:28:04,080 --> 00:28:07,279
part of the zorki which is being used

805
00:28:07,279 --> 00:28:08,640
multiple times here

806
00:28:08,640 --> 00:28:12,159
so when you use this key again and again

807
00:28:12,159 --> 00:28:15,440
which basically like adba adva or you

808
00:28:15,440 --> 00:28:18,559
can also try for is a basic offset here

809
00:28:18,559 --> 00:28:21,840
with that memory address there's a

810
00:28:21,840 --> 00:28:23,279
pointing to this string you are able to

811
00:28:23,279 --> 00:28:25,679
find what kind of key is directly there

812
00:28:25,679 --> 00:28:27,840
and you can reiterate it to the multiple

813
00:28:27,840 --> 00:28:29,120
offsets to build the holes

814
00:28:29,120 --> 00:28:31,520
or key and you can utilize that zorky to

815
00:28:31,520 --> 00:28:32,399
decrypt the

816
00:28:32,399 --> 00:28:34,720
network traffic so the idea in here is

817
00:28:34,720 --> 00:28:36,320
that we have to actually perform reverse

818
00:28:36,320 --> 00:28:38,080
engineering the iot bot binaries to

819
00:28:38,080 --> 00:28:40,640
extract uh the interesting information

820
00:28:40,640 --> 00:28:42,559
basically the hard codeds or keys in

821
00:28:42,559 --> 00:28:45,840
this case

822
00:28:46,720 --> 00:28:48,080
now let's look at the another

823
00:28:48,080 --> 00:28:50,000
interesting demo here

824
00:28:50,000 --> 00:28:51,760
if you remember uh when we're going

825
00:28:51,760 --> 00:28:53,200
through the you know some of the

826
00:28:53,200 --> 00:28:55,440
examples of the compromise cnc panel the

827
00:28:55,440 --> 00:28:56,960
verizon one so this is a

828
00:28:56,960 --> 00:28:58,799
little demo of it so you can get a feel

829
00:28:58,799 --> 00:29:01,120
of it

830
00:29:04,080 --> 00:29:07,360
enjoy the little music

831
00:29:07,679 --> 00:29:13,840
so we're logging into the cnc panel here

832
00:29:14,799 --> 00:29:27,679
it's a verizon iot partner cnc panel

833
00:29:27,679 --> 00:29:29,679
so you can see a couple of the you know

834
00:29:29,679 --> 00:29:33,760
commands that have been reiterated here

835
00:29:34,799 --> 00:29:36,799
dumping the info and try to give you the

836
00:29:36,799 --> 00:29:39,679
feel how the cnc panel behaves right

837
00:29:39,679 --> 00:29:42,960
in the real time so you can clearly see

838
00:29:42,960 --> 00:29:46,880
since this is a now you can clearly see

839
00:29:46,880 --> 00:29:48,480
commands and other things that are

840
00:29:48,480 --> 00:29:52,000
supported here for us

841
00:29:52,000 --> 00:29:54,000
our research is entirely focused on

842
00:29:54,000 --> 00:29:56,080
understanding the behavior of these cnc

843
00:29:56,080 --> 00:29:58,240
panels how they are actually advancing

844
00:29:58,240 --> 00:30:00,080
on a regular intervals of time with a

845
00:30:00,080 --> 00:30:01,039
new variance of

846
00:30:01,039 --> 00:30:04,159
iod partners and to control

847
00:30:04,159 --> 00:30:07,919
every single assessment the every way of

848
00:30:07,919 --> 00:30:09,200
intelligence gathering

849
00:30:09,200 --> 00:30:11,200
approaches that we have is all

850
00:30:11,200 --> 00:30:12,320
controlled

851
00:30:12,320 --> 00:30:15,919
uh way toward any kind of impact on the

852
00:30:15,919 --> 00:30:18,000
real world so it's all about being in

853
00:30:18,000 --> 00:30:19,679
the part of the conducting research in a

854
00:30:19,679 --> 00:30:21,440
responsible disclosure

855
00:30:21,440 --> 00:30:22,960
the idea to share with the research

856
00:30:22,960 --> 00:30:24,399
community is to highlight how they can

857
00:30:24,399 --> 00:30:25,840
also utilize

858
00:30:25,840 --> 00:30:28,080
uh these kind of techniques and tactics

859
00:30:28,080 --> 00:30:29,760
to build stronger

860
00:30:29,760 --> 00:30:33,039
threat intelligence solutions

861
00:30:33,039 --> 00:30:35,200
now take a look at the another one uh

862
00:30:35,200 --> 00:30:36,240
here in this case

863
00:30:36,240 --> 00:30:38,480
the idea is to actually show you a

864
00:30:38,480 --> 00:30:39,440
number of

865
00:30:39,440 --> 00:30:43,840
different iot partner cnc panels

866
00:30:48,080 --> 00:30:52,320
so this is another variant called kavari

867
00:31:03,360 --> 00:31:06,000
most of these you know iot botnet cnc

868
00:31:06,000 --> 00:31:06,559
panels

869
00:31:06,559 --> 00:31:09,840
kind of sport custom uh developed

870
00:31:09,840 --> 00:31:12,559
uh you know cnc panel code here you can

871
00:31:12,559 --> 00:31:14,080
see the another one

872
00:31:14,080 --> 00:31:19,840
cnc panel

873
00:31:21,120 --> 00:31:23,120
we will log into it there is the another

874
00:31:23,120 --> 00:31:24,960
one

875
00:31:24,960 --> 00:31:26,399
so what we are doing here is like you

876
00:31:26,399 --> 00:31:28,399
know we are going through multiple

877
00:31:28,399 --> 00:31:33,039
iot cnc panels in a one go

878
00:31:33,039 --> 00:31:36,240
so you can clearly see here

879
00:31:43,760 --> 00:31:49,039
another one dank net

880
00:31:51,840 --> 00:31:54,320
so you can imagine at this point of time

881
00:31:54,320 --> 00:31:55,279
how many

882
00:31:55,279 --> 00:31:57,919
different iot partner cnc panels exist

883
00:31:57,919 --> 00:32:00,159
we have just given you a flavor

884
00:32:00,159 --> 00:32:02,880
of a few ones but we have detected a

885
00:32:02,880 --> 00:32:06,000
large set of iod partners cnc panels

886
00:32:06,000 --> 00:32:08,480
interestingly you can clearly see the

887
00:32:08,480 --> 00:32:09,200
masses

888
00:32:09,200 --> 00:32:11,120
your admin don't share logins i have a

889
00:32:11,120 --> 00:32:13,120
log don't attack to the government

890
00:32:13,120 --> 00:32:15,039
duh if you want to buy a score this and

891
00:32:15,039 --> 00:32:17,600
that this is like a crimeware services

892
00:32:17,600 --> 00:32:19,440
you know the uh the botan operator is

893
00:32:19,440 --> 00:32:21,279
actually utilizing this compromise

894
00:32:21,279 --> 00:32:24,240
this uh iot partner to actually conduct

895
00:32:24,240 --> 00:32:26,640
some kind of uh nefarious operations

896
00:32:26,640 --> 00:32:28,399
if somebody wants it as a part of the

897
00:32:28,399 --> 00:32:29,679
crimeware service model

898
00:32:29,679 --> 00:32:31,360
we are not interested in these kind of

899
00:32:31,360 --> 00:32:33,279
things all we are interested in how we

900
00:32:33,279 --> 00:32:34,320
can build strong

901
00:32:34,320 --> 00:32:36,640
and robust intelligence out of it so

902
00:32:36,640 --> 00:32:38,559
that we can feed into our

903
00:32:38,559 --> 00:32:43,679
detection engines now

904
00:32:43,679 --> 00:32:46,559
what is the inference of the stock what

905
00:32:46,559 --> 00:32:47,200
we have

906
00:32:47,200 --> 00:32:50,240
uh you know believe

907
00:32:50,240 --> 00:32:52,720
that we conduct this kind of research to

908
00:32:52,720 --> 00:32:55,440
actually build strong security

909
00:32:55,440 --> 00:32:57,919
detection and prevention solutions we

910
00:32:57,919 --> 00:32:59,200
want to share this kind of

911
00:32:59,200 --> 00:33:02,720
threat research intelligence uh

912
00:33:02,720 --> 00:33:06,159
with the community we believe that it's

913
00:33:06,159 --> 00:33:06,480
a

914
00:33:06,480 --> 00:33:08,720
it's a dual communication channel where

915
00:33:08,720 --> 00:33:10,080
you share with the community

916
00:33:10,080 --> 00:33:13,120
and you learn from the community and

917
00:33:13,120 --> 00:33:14,320
virus bulletin is

918
00:33:14,320 --> 00:33:16,640
is one such community which is actually

919
00:33:16,640 --> 00:33:18,480
supporting a large set of security

920
00:33:18,480 --> 00:33:20,159
researchers all around the world so that

921
00:33:20,159 --> 00:33:22,000
they can share their work and you know

922
00:33:22,000 --> 00:33:23,039
make them

923
00:33:23,039 --> 00:33:25,440
try to you know reduce the impact and

924
00:33:25,440 --> 00:33:27,679
risk associated with these

925
00:33:27,679 --> 00:33:31,039
botnets so our inference in this case is

926
00:33:31,039 --> 00:33:33,360
very simple than the street penetrate

927
00:33:33,360 --> 00:33:35,519
the cnc servers to build intelligence to

928
00:33:35,519 --> 00:33:37,600
support and defend attacks in the iot

929
00:33:37,600 --> 00:33:39,120
hemisphere

930
00:33:39,120 --> 00:33:40,880
very much important until unless you're

931
00:33:40,880 --> 00:33:42,960
not going to find out how the cnc panel

932
00:33:42,960 --> 00:33:43,919
operates

933
00:33:43,919 --> 00:33:45,360
how they are designed how they are

934
00:33:45,360 --> 00:33:47,200
developed what the customer broadcast

935
00:33:47,200 --> 00:33:48,799
sorry custom protocols they are

936
00:33:48,799 --> 00:33:49,840
supporting

937
00:33:49,840 --> 00:33:53,360
and all those sort of things and if you

938
00:33:53,360 --> 00:33:55,679
don't go that deep it is really really

939
00:33:55,679 --> 00:33:57,600
hard to subvert these attacks right

940
00:33:57,600 --> 00:33:58,880
because we never have an

941
00:33:58,880 --> 00:34:01,039
idea if you don't visualize the security

942
00:34:01,039 --> 00:34:03,279
threats there is no way you can prevent

943
00:34:03,279 --> 00:34:05,039
it because you don't have any idea how

944
00:34:05,039 --> 00:34:06,159
these attacks operate

945
00:34:06,159 --> 00:34:08,399
and how botnet operators actually go

946
00:34:08,399 --> 00:34:09,918
after conducting very

947
00:34:09,918 --> 00:34:12,320
illicit operations on the internet but

948
00:34:12,320 --> 00:34:14,159
believe it build intelligence

949
00:34:14,159 --> 00:34:17,679
conduct research penetrate

950
00:34:17,679 --> 00:34:20,560
again rebuild strong intelligence

951
00:34:20,560 --> 00:34:21,599
indicators

952
00:34:21,599 --> 00:34:23,760
and actually enhance the security state

953
00:34:23,760 --> 00:34:25,918
of the solutions

954
00:34:25,918 --> 00:34:28,079
so that being said questions and queries

955
00:34:28,079 --> 00:34:30,639
uh i will more than happy to answer

956
00:34:30,639 --> 00:34:32,399
any kind of queries you have and take

957
00:34:32,399 --> 00:34:34,560
this discussion to the next level

958
00:34:34,560 --> 00:34:36,960
uh you can visit our website and feel

959
00:34:36,960 --> 00:34:37,918
free to

960
00:34:37,918 --> 00:34:40,960
ping us directly there or contact uh

961
00:34:40,960 --> 00:34:42,639
directly by there

962
00:34:42,639 --> 00:34:45,359
looking forward to more discussions at

963
00:34:45,359 --> 00:34:46,719
last

964
00:34:46,719 --> 00:34:49,440
we really want to be thankful to wires

965
00:34:49,440 --> 00:34:51,119
bulletin

966
00:34:51,119 --> 00:34:53,119
committee again for giving us an

967
00:34:53,119 --> 00:34:54,879
opportunity to share

968
00:34:54,879 --> 00:34:58,799
and present our research in this space

969
00:35:00,839 --> 00:35:03,839
thanks

970
00:35:05,359 --> 00:35:07,440
you

