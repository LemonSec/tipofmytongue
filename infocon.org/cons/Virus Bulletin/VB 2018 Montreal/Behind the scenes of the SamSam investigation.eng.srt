1
00:00:00,650 --> 00:00:03,419
okay everybody please take your seat and

2
00:00:03,419 --> 00:00:06,060
the next presentation here in the green

3
00:00:06,060 --> 00:00:09,510
room you will receive Peter McKenzie and

4
00:00:09,510 --> 00:00:13,200
Andrea branded with the risk with the

5
00:00:13,200 --> 00:00:16,139
presentation behind the scenes of the

6
00:00:16,139 --> 00:00:19,350
sense enhance our Andrew is here with us

7
00:00:19,350 --> 00:00:21,359
and will present welcome Andrew thank

8
00:00:21,359 --> 00:00:22,529
you

9
00:00:22,529 --> 00:00:24,359
so I have to apologize to the audience

10
00:00:24,359 --> 00:00:27,060
because my co-presenter Peter McKenzie

11
00:00:27,060 --> 00:00:29,689
was not able to attend so I will be

12
00:00:29,689 --> 00:00:33,270
presenting alone today and I also should

13
00:00:33,270 --> 00:00:36,329
at least it at the beginning mentioned

14
00:00:36,329 --> 00:00:38,910
that it was Peter McKenzie and dorka

15
00:00:38,910 --> 00:00:41,670
palatte who's one of our top who was one

16
00:00:41,670 --> 00:00:43,800
of our top reverse engineers who did

17
00:00:43,800 --> 00:00:46,590
most of the research on this project and

18
00:00:46,590 --> 00:00:50,520
we really hold all of them in a steam I

19
00:00:50,520 --> 00:00:52,170
was just the the last guy standing

20
00:00:52,170 --> 00:00:54,840
basically to do the presentation so it

21
00:00:54,840 --> 00:00:57,059
really the kudos belong to them but I'm

22
00:00:57,059 --> 00:00:58,649
gonna talk a little bit about Sam Sam

23
00:00:58,649 --> 00:01:01,530
and how we did some of the investigation

24
00:01:01,530 --> 00:01:06,420
that led to it we published a big report

25
00:01:06,420 --> 00:01:09,840
about Sam Sam its behavior how they

26
00:01:09,840 --> 00:01:12,390
collect their payments tracking the

27
00:01:12,390 --> 00:01:15,930
attackers and understanding their their

28
00:01:15,930 --> 00:01:18,330
modus operandi in a big report that got

29
00:01:18,330 --> 00:01:20,640
published in in August and the report

30
00:01:20,640 --> 00:01:22,770
links are here including some follow-up

31
00:01:22,770 --> 00:01:25,350
blog posts and other reports on what

32
00:01:25,350 --> 00:01:27,360
we're calling targeted ransomware which

33
00:01:27,360 --> 00:01:30,570
is the the term that we're using for the

34
00:01:30,570 --> 00:01:33,060
type of attack that we're discussing so

35
00:01:33,060 --> 00:01:36,329
so what Sam Sam so in many ways in many

36
00:01:36,329 --> 00:01:38,759
respects it's it's a conventional

37
00:01:38,759 --> 00:01:40,860
ransomware that we've seen a million

38
00:01:40,860 --> 00:01:45,090
times but it does have certain

39
00:01:45,090 --> 00:01:47,759
characteristics that are unique one of

40
00:01:47,759 --> 00:01:50,220
them is the the very high cost of

41
00:01:50,220 --> 00:01:54,240
recovery so with many ransomware we'll

42
00:01:54,240 --> 00:01:56,340
charge between a few hundred and maybe a

43
00:01:56,340 --> 00:01:58,799
few thousand dollars the Sam Sam

44
00:01:58,799 --> 00:02:01,560
ransomware was charging upwards of seven

45
00:02:01,560 --> 00:02:04,770
bitcoins to restore the machines that

46
00:02:04,770 --> 00:02:06,560
was that were had been encrypted and

47
00:02:06,560 --> 00:02:10,080
that is very very high compared to most

48
00:02:10,080 --> 00:02:13,110
other ransomware so how does the attack

49
00:02:13,110 --> 00:02:13,650
work

50
00:02:13,650 --> 00:02:15,569
I'm gonna just kind of rush through this

51
00:02:15,569 --> 00:02:17,670
as quick as I can essentially the the

52
00:02:17,670 --> 00:02:20,670
attacker or attackers we don't know

53
00:02:20,670 --> 00:02:23,010
exactly how many are part of the Sam Sam

54
00:02:23,010 --> 00:02:25,739
group could be of one or a very small

55
00:02:25,739 --> 00:02:26,700
number of people

56
00:02:26,700 --> 00:02:28,769
we suspect that it's a small group of

57
00:02:28,769 --> 00:02:31,370
people max because they have had

58
00:02:31,370 --> 00:02:33,900
incredibly good OPSEC they're not

59
00:02:33,900 --> 00:02:35,849
bragging about it on dark markets or

60
00:02:35,849 --> 00:02:39,000
dark forums they're just getting the job

61
00:02:39,000 --> 00:02:41,400
done and collecting the cash and really

62
00:02:41,400 --> 00:02:43,140
the only criteria that they seem to have

63
00:02:43,140 --> 00:02:46,829
is can the target pay they have attacked

64
00:02:46,829 --> 00:02:49,970
large organizations like hospitals

65
00:02:49,970 --> 00:02:52,290
government agencies like the city of

66
00:02:52,290 --> 00:02:53,670
Atlanta but they've also attacked

67
00:02:53,670 --> 00:02:56,310
smaller groups like homeless charities

68
00:02:56,310 --> 00:02:58,079
and and other organizations like that

69
00:02:58,079 --> 00:02:59,939
and really they just care about whether

70
00:02:59,939 --> 00:03:01,879
they can get the target to pay them

71
00:03:01,879 --> 00:03:05,450
they're conducting their attacks using a

72
00:03:05,450 --> 00:03:08,280
extremely manual extremely brute force

73
00:03:08,280 --> 00:03:11,459
method there they have been for most of

74
00:03:11,459 --> 00:03:12,989
the time that they have been doing this

75
00:03:12,989 --> 00:03:15,959
using just brute force attacks against

76
00:03:15,959 --> 00:03:18,810
remote desktop and then in in the

77
00:03:18,810 --> 00:03:20,639
earlier days they were also targeting

78
00:03:20,639 --> 00:03:22,319
servers that were running software

79
00:03:22,319 --> 00:03:24,930
called JBoss that and that particular

80
00:03:24,930 --> 00:03:26,910
server had a few vulnerabilities and

81
00:03:26,910 --> 00:03:28,139
there was some exploit tools and they

82
00:03:28,139 --> 00:03:29,819
were just using these exploit tools to

83
00:03:29,819 --> 00:03:32,579
break into servers and use that as their

84
00:03:32,579 --> 00:03:35,849
foothold into the corporate network once

85
00:03:35,849 --> 00:03:38,459
they're in there elevating their

86
00:03:38,459 --> 00:03:40,829
privileges using tools like me me cats

87
00:03:40,829 --> 00:03:44,459
to sniff for administrator passwords and

88
00:03:44,459 --> 00:03:46,530
eventually when they would get in an

89
00:03:46,530 --> 00:03:49,769
admin password they would be use those

90
00:03:49,769 --> 00:03:53,250
credentials to use conventional Windows

91
00:03:53,250 --> 00:03:55,680
sysadmin techniques to distribute them

92
00:03:55,680 --> 00:03:58,500
malware simultaneously to all active

93
00:03:58,500 --> 00:04:01,139
machines on the network and then boom

94
00:04:01,139 --> 00:04:02,849
they were done they would it would start

95
00:04:02,849 --> 00:04:05,280
encrypting and all they had to do was

96
00:04:05,280 --> 00:04:06,750
sit back and wait for the victims to

97
00:04:06,750 --> 00:04:08,930
come and pay and come and pay they did

98
00:04:08,930 --> 00:04:11,340
so let's talk a little bit first about

99
00:04:11,340 --> 00:04:13,260
the malware and then we'll talk a little

100
00:04:13,260 --> 00:04:16,260
bit about the collection of payments so

101
00:04:16,260 --> 00:04:17,940
this was this little chart just kind of

102
00:04:17,940 --> 00:04:20,608
details our understanding of the

103
00:04:20,608 --> 00:04:23,610
development process of Sam Sam this was

104
00:04:23,610 --> 00:04:26,490
part of the report in general there were

105
00:04:26,490 --> 00:04:27,660
three

106
00:04:27,660 --> 00:04:29,970
major versions of Sam Sam were in the

107
00:04:29,970 --> 00:04:33,419
middle of version three right now its

108
00:04:33,419 --> 00:04:35,850
earliest iterations were discovered at

109
00:04:35,850 --> 00:04:38,340
the end of 2015 and we didn't see the

110
00:04:38,340 --> 00:04:41,250
very first attacks until January 2016 so

111
00:04:41,250 --> 00:04:43,830
in that time they have gone through

112
00:04:43,830 --> 00:04:45,990
these these multiple revisions in the

113
00:04:45,990 --> 00:04:48,720
earliest days of the ransomware they

114
00:04:48,720 --> 00:04:51,210
were doing experimentation to find

115
00:04:51,210 --> 00:04:54,150
what's the best methods of protecting

116
00:04:54,150 --> 00:04:56,840
themselves and masking and preventing

117
00:04:56,840 --> 00:04:59,970
researchers from doing analysis by the

118
00:04:59,970 --> 00:05:03,810
second version of the of the malware we

119
00:05:03,810 --> 00:05:06,240
started to see that they were adding

120
00:05:06,240 --> 00:05:09,000
garbage code and starting to encrypt

121
00:05:09,000 --> 00:05:12,270
strings and adding new features to sort

122
00:05:12,270 --> 00:05:14,130
of the word analysis and by the third

123
00:05:14,130 --> 00:05:17,610
version they had refined this even

124
00:05:17,610 --> 00:05:20,310
further and changed their methods to

125
00:05:20,310 --> 00:05:23,000
make it even harder to do the analysis

126
00:05:23,000 --> 00:05:25,710
but you know what a dedicated reverse

127
00:05:25,710 --> 00:05:28,880
engineer was able to get through it

128
00:05:28,880 --> 00:05:31,200
really the the biggest thing that we

129
00:05:31,200 --> 00:05:34,380
noticed was that just in the days before

130
00:05:34,380 --> 00:05:37,590
we released our report on this and we

131
00:05:37,590 --> 00:05:39,950
had been tracking this group and

132
00:05:39,950 --> 00:05:43,590
contacting the victims directly to get

133
00:05:43,590 --> 00:05:46,260
information from them we saw that for

134
00:05:46,260 --> 00:05:48,870
one attack they changed their file

135
00:05:48,870 --> 00:05:51,150
suffix that they used to append to all

136
00:05:51,150 --> 00:05:52,849
their encrypted files to dot Sophos

137
00:05:52,849 --> 00:05:55,970
which was I guess a kind of you know

138
00:05:55,970 --> 00:05:58,349
notification that we're we're on to you

139
00:05:58,349 --> 00:06:00,720
but then they switch that over to

140
00:06:00,720 --> 00:06:04,229
something Nike 20:18 right after that

141
00:06:04,229 --> 00:06:07,039
and I think they've used that ever since

142
00:06:07,039 --> 00:06:09,660
so as I mentioned they had sort of over

143
00:06:09,660 --> 00:06:12,599
time improved their OPSEC they started

144
00:06:12,599 --> 00:06:14,430
in this early version by just kind of

145
00:06:14,430 --> 00:06:18,180
encoding strings as base64 and then they

146
00:06:18,180 --> 00:06:20,190
started to encrypt the strings using AES

147
00:06:20,190 --> 00:06:22,260
and they started adding this garbage

148
00:06:22,260 --> 00:06:24,330
code and other things to thwart analysis

149
00:06:24,330 --> 00:06:26,880
and you know send us off on a wild goose

150
00:06:26,880 --> 00:06:27,210
chase

151
00:06:27,210 --> 00:06:29,070
and then by the firt the third version

152
00:06:29,070 --> 00:06:30,660
we started to see this thing called the

153
00:06:30,660 --> 00:06:32,729
runner which was essentially a dropper

154
00:06:32,729 --> 00:06:35,820
that would deliver the payload it was

155
00:06:35,820 --> 00:06:37,590
embedded encrypted inside the dropper

156
00:06:37,590 --> 00:06:39,540
and it would it would decrypt and and

157
00:06:39,540 --> 00:06:41,730
drop the payload that was the the

158
00:06:41,730 --> 00:06:43,410
ransomware executable and then they

159
00:06:43,410 --> 00:06:45,380
started to sort of segment out

160
00:06:45,380 --> 00:06:48,960
components of the malware including the

161
00:06:48,960 --> 00:06:51,090
Decrypter in two separate libraries that

162
00:06:51,090 --> 00:06:53,670
they would also bundle into the dropper

163
00:06:53,670 --> 00:06:56,970
the dropper would do things like it

164
00:06:56,970 --> 00:06:59,520
would you would have to invoke a batch

165
00:06:59,520 --> 00:07:03,720
file with a password as a flag in order

166
00:07:03,720 --> 00:07:05,640
to run them ransomware so it became very

167
00:07:05,640 --> 00:07:07,560
difficult even if you had the executable

168
00:07:07,560 --> 00:07:09,360
you could pull it out a virus virus

169
00:07:09,360 --> 00:07:11,640
total or some other repository you

170
00:07:11,640 --> 00:07:13,440
couldn't actually run it unless you had

171
00:07:13,440 --> 00:07:14,970
this batch file and the password that

172
00:07:14,970 --> 00:07:19,500
goes with it right so the way that they

173
00:07:19,500 --> 00:07:22,620
do their encryption is sort of designed

174
00:07:22,620 --> 00:07:25,230
to maximize the amount of damage that

175
00:07:25,230 --> 00:07:28,200
they can do so in addition to sort of

176
00:07:28,200 --> 00:07:32,070
creating a sort of a text extension list

177
00:07:32,070 --> 00:07:34,770
of all the targeted files that are the

178
00:07:34,770 --> 00:07:37,560
first ones that they want to hit once

179
00:07:37,560 --> 00:07:39,300
they have run through all those things

180
00:07:39,300 --> 00:07:41,520
which are all the the usual suspects

181
00:07:41,520 --> 00:07:43,650
documents office documents like Excel

182
00:07:43,650 --> 00:07:47,010
spreadsheets images movies and and you

183
00:07:47,010 --> 00:07:48,540
know everything you can imagine a normal

184
00:07:48,540 --> 00:07:50,940
ransomware would target it doesn't stop

185
00:07:50,940 --> 00:07:53,070
there so it it created has this

186
00:07:53,070 --> 00:07:55,830
hard-coded list of paths and files that

187
00:07:55,830 --> 00:07:58,140
are white listed and those are

188
00:07:58,140 --> 00:08:00,840
essentially the the minimum requirements

189
00:08:00,840 --> 00:08:02,520
for a Windows machine to maintain

190
00:08:02,520 --> 00:08:06,180
operational status and not crash if so

191
00:08:06,180 --> 00:08:08,670
they are not encrypted and then the

192
00:08:08,670 --> 00:08:11,160
system will look at everything else

193
00:08:11,160 --> 00:08:12,510
that's on the hard drive all the

194
00:08:12,510 --> 00:08:14,730
programs all the configuration files for

195
00:08:14,730 --> 00:08:16,950
those programs other data files

196
00:08:16,950 --> 00:08:20,310
databases organize them by size and go

197
00:08:20,310 --> 00:08:22,710
from smallest to largest and encrypt all

198
00:08:22,710 --> 00:08:25,350
of those in sequence from smallest to

199
00:08:25,350 --> 00:08:28,500
largest so that it it does eventually

200
00:08:28,500 --> 00:08:31,590
get everything and what this does is it

201
00:08:31,590 --> 00:08:35,419
results in a machine that basically is

202
00:08:35,419 --> 00:08:38,760
unusable until you re image the machine

203
00:08:38,760 --> 00:08:40,799
back to a clean image and put those

204
00:08:40,799 --> 00:08:42,900
programs back and then bring back the

205
00:08:42,900 --> 00:08:45,710
data from a backup so everything takes

206
00:08:45,710 --> 00:08:48,690
much much longer to restore I think the

207
00:08:48,690 --> 00:08:51,590
victims start to realize and have a

208
00:08:51,590 --> 00:08:54,770
attack and that's when they decide that

209
00:08:54,770 --> 00:08:58,280
the the cost of the ransom being you

210
00:08:58,280 --> 00:09:01,310
know between 30 and you know $65,000

211
00:09:01,310 --> 00:09:02,600
depending on the value the bitcoin that

212
00:09:02,600 --> 00:09:06,560
week is probably worth it compared to

213
00:09:06,560 --> 00:09:09,650
the enormous amount of lost productivity

214
00:09:09,650 --> 00:09:13,610
and time and just the cost of replacing

215
00:09:13,610 --> 00:09:15,920
a lot of equipment or getting it back up

216
00:09:15,920 --> 00:09:17,930
and running in a short amount of time to

217
00:09:17,930 --> 00:09:21,800
keep business operating so how did we

218
00:09:21,800 --> 00:09:25,100
find the victims well in some cases it

219
00:09:25,100 --> 00:09:28,880
was easy because we knew who they were

220
00:09:28,880 --> 00:09:31,610
there were many high-profile targets as

221
00:09:31,610 --> 00:09:33,020
I mentioned there were government

222
00:09:33,020 --> 00:09:34,760
targets there were targets in health

223
00:09:34,760 --> 00:09:37,400
care targets in education and some of

224
00:09:37,400 --> 00:09:38,960
these victims included things like the

225
00:09:38,960 --> 00:09:40,910
city of Atlanta and the Colorado

226
00:09:40,910 --> 00:09:42,710
Department of Transportation which is

227
00:09:42,710 --> 00:09:45,890
the state where I live and some

228
00:09:45,890 --> 00:09:47,330
hospitals and other health care

229
00:09:47,330 --> 00:09:51,170
providers and what we found was that at

230
00:09:51,170 --> 00:09:53,540
these companies and organizations had

231
00:09:53,540 --> 00:09:55,760
basically publicized the fact that they

232
00:09:55,760 --> 00:09:57,530
had been hit with ransomware as some in

233
00:09:57,530 --> 00:09:59,060
some cases they identified that it was

234
00:09:59,060 --> 00:10:01,550
Sam Sam in other cases we're able to

235
00:10:01,550 --> 00:10:03,500
deduce that it was Sam Sam based on what

236
00:10:03,500 --> 00:10:07,340
they described but they these groups

237
00:10:07,340 --> 00:10:10,040
were basically a small percentage of the

238
00:10:10,040 --> 00:10:11,570
victims in fact they were fewer than

239
00:10:11,570 --> 00:10:14,990
half here are some of the distribution

240
00:10:14,990 --> 00:10:17,330
of the of the victims around the world

241
00:10:17,330 --> 00:10:19,700
and you could see that the majority of

242
00:10:19,700 --> 00:10:23,090
them essentially it were in the Anglo

243
00:10:23,090 --> 00:10:24,980
sphere meaning the the english-speaking

244
00:10:24,980 --> 00:10:28,190
part of the world US Canada the Great

245
00:10:28,190 --> 00:10:29,750
Britain were really some kind of in the

246
00:10:29,750 --> 00:10:32,210
top Australia was in there as well and

247
00:10:32,210 --> 00:10:33,350
then there there seemed to be a

248
00:10:33,350 --> 00:10:35,360
relatively high percentage in Belgium

249
00:10:35,360 --> 00:10:38,090
there may be some institutions in that

250
00:10:38,090 --> 00:10:40,790
country which cater to English speakers

251
00:10:40,790 --> 00:10:43,240
as well and people from those countries

252
00:10:43,240 --> 00:10:47,810
there are so many more victims so one of

253
00:10:47,810 --> 00:10:49,760
the things that we realized early on is

254
00:10:49,760 --> 00:10:52,460
that each victim would when they you

255
00:10:52,460 --> 00:10:53,900
know when the ransomware would display

256
00:10:53,900 --> 00:10:55,880
the ransom note they the ransom note was

257
00:10:55,880 --> 00:10:58,310
unique to each victim the rents the

258
00:10:58,310 --> 00:10:59,870
unique things in the ransom note

259
00:10:59,870 --> 00:11:02,450
were the onion address that pointed to a

260
00:11:02,450 --> 00:11:03,480
page where

261
00:11:03,480 --> 00:11:07,700
the victim could go to transact the the

262
00:11:07,700 --> 00:11:10,950
conclusion of this you know business

263
00:11:10,950 --> 00:11:13,650
proposition from these people and there

264
00:11:13,650 --> 00:11:15,270
was also a unique Bitcoin payment

265
00:11:15,270 --> 00:11:18,450
address for each victim and when we

266
00:11:18,450 --> 00:11:20,610
started googling for the text of these

267
00:11:20,610 --> 00:11:22,800
ransom notes we found a whole lot more

268
00:11:22,800 --> 00:11:25,650
of them in some cases on public web

269
00:11:25,650 --> 00:11:27,720
servers where the web server had been a

270
00:11:27,720 --> 00:11:30,120
victim and and the ransom note and the

271
00:11:30,120 --> 00:11:32,010
encrypted files were still on the web

272
00:11:32,010 --> 00:11:33,180
server and they've been indexed by

273
00:11:33,180 --> 00:11:34,620
Google and been there for a really long

274
00:11:34,620 --> 00:11:38,070
time and that was actually kind of

275
00:11:38,070 --> 00:11:41,100
amazing to discover and then the the

276
00:11:41,100 --> 00:11:43,950
next thing we started to do was track

277
00:11:43,950 --> 00:11:47,250
payments that had gone from those known

278
00:11:47,250 --> 00:11:50,190
Bitcoin addresses and that was actually

279
00:11:50,190 --> 00:11:51,990
very interesting and what that revealed

280
00:11:51,990 --> 00:11:54,840
to us was that the total number of

281
00:11:54,840 --> 00:11:57,480
victims was almost was more than double

282
00:11:57,480 --> 00:12:00,090
what we that the organizations that had

283
00:12:00,090 --> 00:12:01,710
publicly announced that they had been

284
00:12:01,710 --> 00:12:05,340
victimized and that all of the companies

285
00:12:05,340 --> 00:12:08,040
or organizations that had not announced

286
00:12:08,040 --> 00:12:11,040
who they were were essentially private

287
00:12:11,040 --> 00:12:13,500
companies and and they still many of

288
00:12:13,500 --> 00:12:15,290
those victims have still never

289
00:12:15,290 --> 00:12:19,140
acknowledged the attack so who are these

290
00:12:19,140 --> 00:12:21,420
groups that were the silent victims that

291
00:12:21,420 --> 00:12:24,540
didn't want to really talk about it well

292
00:12:24,540 --> 00:12:26,250
they're in the energy sector financial

293
00:12:26,250 --> 00:12:27,840
services manufacturing you can see the

294
00:12:27,840 --> 00:12:29,340
list here I don't need to read them all

295
00:12:29,340 --> 00:12:32,910
but they span the gamut of large

296
00:12:32,910 --> 00:12:34,950
businesses and organizations that you

297
00:12:34,950 --> 00:12:37,470
can imagine would be able to pay which

298
00:12:37,470 --> 00:12:40,890
is really the only criteria I suppose

299
00:12:40,890 --> 00:12:42,450
one other criteria was that they had to

300
00:12:42,450 --> 00:12:44,490
be running Windows machines and and that

301
00:12:44,490 --> 00:12:45,870
those Windows machines had to be part of

302
00:12:45,870 --> 00:12:47,910
their business but I think that that's

303
00:12:47,910 --> 00:12:52,470
kind of a given so we identified roughly

304
00:12:52,470 --> 00:12:56,220
90 victim organizations this was in some

305
00:12:56,220 --> 00:12:57,900
cases through these searches in some

306
00:12:57,900 --> 00:13:00,320
cases because we contacted them directly

307
00:13:00,320 --> 00:13:03,660
our research eventually revealed that

308
00:13:03,660 --> 00:13:06,630
there were roughly 230 victims that paid

309
00:13:06,630 --> 00:13:10,230
ransom and that those who didn't

310
00:13:10,230 --> 00:13:12,780
identify claimed that it was just

311
00:13:12,780 --> 00:13:15,030
computer problems or some kind of an

312
00:13:15,030 --> 00:13:15,540
attack

313
00:13:15,540 --> 00:13:18,139
but they didn't actually specify Sam Sam

314
00:13:18,139 --> 00:13:20,639
so and some other vendors including

315
00:13:20,639 --> 00:13:23,519
Cisco talus and and our partners in the

316
00:13:23,519 --> 00:13:27,029
cyber threat association also shared

317
00:13:27,029 --> 00:13:28,410
some information with us and that was

318
00:13:28,410 --> 00:13:30,360
very valuable to help us find even more

319
00:13:30,360 --> 00:13:33,899
and in the end all of the research that

320
00:13:33,899 --> 00:13:36,779
we were able to do was essentially

321
00:13:36,779 --> 00:13:38,850
dependent on these partners giving us

322
00:13:38,850 --> 00:13:40,470
their information or anything that they

323
00:13:40,470 --> 00:13:42,149
could tell us about the ransomware

324
00:13:42,149 --> 00:13:44,730
because without that partnership and

325
00:13:44,730 --> 00:13:47,190
that trust between those victims and us

326
00:13:47,190 --> 00:13:49,800
we would never live literally never have

327
00:13:49,800 --> 00:13:52,620
been able to get things like the Runner

328
00:13:52,620 --> 00:13:55,829
and the passwords and the samples to be

329
00:13:55,829 --> 00:13:58,050
able to do the testing and reverse

330
00:13:58,050 --> 00:14:00,300
engineering that we did so we're very

331
00:14:00,300 --> 00:14:02,579
grateful to those organizations that

332
00:14:02,579 --> 00:14:05,850
share that information with us all right

333
00:14:05,850 --> 00:14:06,690
let's talk a little bit about the

334
00:14:06,690 --> 00:14:10,079
payments so this is our chart that we

335
00:14:10,079 --> 00:14:14,120
derived from tracking payments over the

336
00:14:14,120 --> 00:14:17,670
roughly 21 22 months from the time that

337
00:14:17,670 --> 00:14:20,310
we started doing the research until the

338
00:14:20,310 --> 00:14:22,949
report came out you can see that the end

339
00:14:22,949 --> 00:14:25,560
of 2016 was sort of the banner month for

340
00:14:25,560 --> 00:14:27,779
these guys they got 19 payments and one

341
00:14:27,779 --> 00:14:30,089
month that must have made a very nice

342
00:14:30,089 --> 00:14:33,569
Christmas for whoever this was and as I

343
00:14:33,569 --> 00:14:34,889
mentioned all the payments had been done

344
00:14:34,889 --> 00:14:36,930
through Bitcoin so all the payments were

345
00:14:36,930 --> 00:14:41,790
to unique addresses and then and and of

346
00:14:41,790 --> 00:14:44,970
157 of those addresses had been used as

347
00:14:44,970 --> 00:14:46,529
of the time that the report came out

348
00:14:46,529 --> 00:14:49,079
there may be a few additional that are

349
00:14:49,079 --> 00:14:50,220
that just didn't make it into this

350
00:14:50,220 --> 00:14:51,360
presentation that have happened

351
00:14:51,360 --> 00:14:54,510
subsequently all of those payments

352
00:14:54,510 --> 00:14:56,610
essentially went into one of three

353
00:14:56,610 --> 00:14:59,250
wallets and the wallets they didn't

354
00:14:59,250 --> 00:15:01,620
exactly parallel the three versions of

355
00:15:01,620 --> 00:15:04,380
the ransomware in timing but it kind of

356
00:15:04,380 --> 00:15:05,639
seems like that's an interesting

357
00:15:05,639 --> 00:15:08,189
connection that basically that there

358
00:15:08,189 --> 00:15:10,380
were three of them that received all

359
00:15:10,380 --> 00:15:13,290
these payments now I am NOT an expert in

360
00:15:13,290 --> 00:15:15,389
tracking Bitcoin transactions but my

361
00:15:15,389 --> 00:15:17,730
understanding of this is that once you

362
00:15:17,730 --> 00:15:19,470
understand what the payment address is

363
00:15:19,470 --> 00:15:22,290
and the wallet is you can then follow

364
00:15:22,290 --> 00:15:24,470
and track the blockchain to be able to

365
00:15:24,470 --> 00:15:27,000
see how they distribute these payments

366
00:15:27,000 --> 00:15:27,610
or

367
00:15:27,610 --> 00:15:29,260
and try to do the money laundering that

368
00:15:29,260 --> 00:15:31,740
hides the destination or the eventual

369
00:15:31,740 --> 00:15:35,920
recipient of them and that's a that is

370
00:15:35,920 --> 00:15:38,790
essentially how we did that tracking

371
00:15:38,790 --> 00:15:42,480
these guys were making tons of money so

372
00:15:42,480 --> 00:15:46,630
over time the ransom demand stayed

373
00:15:46,630 --> 00:15:48,790
relatively the same I think it

374
00:15:48,790 --> 00:15:50,770
fluctuated in the amount of Bitcoin just

375
00:15:50,770 --> 00:15:52,839
a bit as the the price of Bitcoin

376
00:15:52,839 --> 00:15:55,450
changed but you can see that gradually

377
00:15:55,450 --> 00:15:57,490
over time the trend line was that they

378
00:15:57,490 --> 00:15:58,990
were trying to make more money with each

379
00:15:58,990 --> 00:16:01,660
subsequent transaction and it did kind

380
00:16:01,660 --> 00:16:03,550
of bounce up and down but it did get

381
00:16:03,550 --> 00:16:06,670
there right up until I guess their peak

382
00:16:06,670 --> 00:16:08,470
payment that they received was earlier

383
00:16:08,470 --> 00:16:10,330
this year for for almost fifty two

384
00:16:10,330 --> 00:16:15,430
thousand dollars so how do they hide the

385
00:16:15,430 --> 00:16:18,630
way that they transact this this cash

386
00:16:18,630 --> 00:16:21,160
there are all these different ways that

387
00:16:21,160 --> 00:16:22,830
you can you basically launder

388
00:16:22,830 --> 00:16:25,150
cryptocurrency right so there's these

389
00:16:25,150 --> 00:16:27,490
tumblr services which essentially break

390
00:16:27,490 --> 00:16:31,420
out the the payment into hundreds or

391
00:16:31,420 --> 00:16:35,940
thousands of fractional cryptocurrency

392
00:16:35,940 --> 00:16:38,709
segments and then they trade those

393
00:16:38,709 --> 00:16:40,959
around and then those get broken up

394
00:16:40,959 --> 00:16:43,150
further and swapped around even more and

395
00:16:43,150 --> 00:16:44,560
it's basically it's literally like

396
00:16:44,560 --> 00:16:46,839
throwing your clothes in the dryer and

397
00:16:46,839 --> 00:16:48,520
then they come out you know having been

398
00:16:48,520 --> 00:16:53,520
spun around at the end with very little

399
00:16:53,520 --> 00:16:56,680
it's not easy to track back through

400
00:16:56,680 --> 00:16:57,940
those that you know hundreds or

401
00:16:57,940 --> 00:16:59,800
thousands of transactions and those you

402
00:16:59,800 --> 00:17:02,080
know lots and lots of little pieces then

403
00:17:02,080 --> 00:17:04,599
they were also trying out converting

404
00:17:04,599 --> 00:17:07,449
from Bitcoin to Manero and other digital

405
00:17:07,449 --> 00:17:09,250
currencies and and they were using these

406
00:17:09,250 --> 00:17:11,349
things called mixers which basically

407
00:17:11,349 --> 00:17:13,630
substitute Bitcoin for other kinds of

408
00:17:13,630 --> 00:17:16,270
currencies that are not tradable in

409
00:17:16,270 --> 00:17:19,059
invisible ways and then trading them

410
00:17:19,059 --> 00:17:21,579
back into a tradable Bitcoin later on

411
00:17:21,579 --> 00:17:23,770
and they were actually using all three

412
00:17:23,770 --> 00:17:25,869
of these methods interchangeably and

413
00:17:25,869 --> 00:17:28,170
sometimes you know all at the same time

414
00:17:28,170 --> 00:17:32,559
in order to mask these transactions so

415
00:17:32,559 --> 00:17:36,220
this is the this is our calculation of

416
00:17:36,220 --> 00:17:38,970
how we came to the

417
00:17:38,970 --> 00:17:40,950
when I submitted this talk it was almost

418
00:17:40,950 --> 00:17:43,560
six million dollars and then on blackhat

419
00:17:43,560 --> 00:17:45,390
day one they collected enough payments

420
00:17:45,390 --> 00:17:46,830
that they had actually topped six

421
00:17:46,830 --> 00:17:49,260
million dollars so thankfully we got the

422
00:17:49,260 --> 00:17:51,450
we got the Steve Austin joke in there in

423
00:17:51,450 --> 00:17:53,610
the opening slide but the idea here is

424
00:17:53,610 --> 00:17:55,680
that they were making bucket loads of

425
00:17:55,680 --> 00:17:58,290
cash and I mean this was just unheard of

426
00:17:58,290 --> 00:18:00,210
amounts of money in this short of amount

427
00:18:00,210 --> 00:18:01,620
of time for doing this kind of a

428
00:18:01,620 --> 00:18:04,260
ransomware attack with the sort of the

429
00:18:04,260 --> 00:18:07,110
top take being in December 17 where they

430
00:18:07,110 --> 00:18:09,350
made about five hundred thousand dollars

431
00:18:09,350 --> 00:18:13,260
okay so who is the Sam Sam threat actor

432
00:18:13,260 --> 00:18:16,830
we still don't know we are aware that

433
00:18:16,830 --> 00:18:19,710
it's probably a small group of people we

434
00:18:19,710 --> 00:18:23,340
are aware that there there are certain

435
00:18:23,340 --> 00:18:24,750
people that are part of this team that

436
00:18:24,750 --> 00:18:27,320
seemed to have specialization in unique

437
00:18:27,320 --> 00:18:30,360
tactics and techniques and so that's why

438
00:18:30,360 --> 00:18:32,520
we kind of think that there's a small

439
00:18:32,520 --> 00:18:33,960
group instead of just a single guy

440
00:18:33,960 --> 00:18:36,720
although it could very well be a single

441
00:18:36,720 --> 00:18:39,660
very very skilled programmer and social

442
00:18:39,660 --> 00:18:41,310
engineer and Customer Support

443
00:18:41,310 --> 00:18:43,440
Specialists but they so they do all of

444
00:18:43,440 --> 00:18:47,160
these things the person is probably

445
00:18:47,160 --> 00:18:49,140
proficient in English but not a native

446
00:18:49,140 --> 00:18:50,490
speaker I'll explain a little bit about

447
00:18:50,490 --> 00:18:52,860
that later and they have as I mentioned

448
00:18:52,860 --> 00:18:55,830
very good OPSEC there's been no bragging

449
00:18:55,830 --> 00:18:59,190
no you know claiming of you know buying

450
00:18:59,190 --> 00:19:01,950
large yachts and fancy cars and posting

451
00:19:01,950 --> 00:19:03,690
pictures of themselves on Facebook with

452
00:19:03,690 --> 00:19:06,020
their ill-gotten gains they've just

453
00:19:06,020 --> 00:19:07,950
basically been making a bunch of money

454
00:19:07,950 --> 00:19:09,660
and keeping real quiet about it which is

455
00:19:09,660 --> 00:19:12,560
probably the safest thing for them to do

456
00:19:12,560 --> 00:19:16,290
the way that the the attacker operates

457
00:19:16,290 --> 00:19:19,230
when when a victim is hit is that they

458
00:19:19,230 --> 00:19:21,030
send this link right and it's a tor link

459
00:19:21,030 --> 00:19:23,330
to an onion site that the the attacker

460
00:19:23,330 --> 00:19:26,610
runs it's actually basically like a

461
00:19:26,610 --> 00:19:28,520
message board or communications board

462
00:19:28,520 --> 00:19:31,650
when a victim is hit they're able to

463
00:19:31,650 --> 00:19:33,930
send a message to the attacker and in

464
00:19:33,930 --> 00:19:35,460
near-real-time the attacker will

465
00:19:35,460 --> 00:19:37,260
actually message them back which is

466
00:19:37,260 --> 00:19:38,910
actually kind of interesting so that in

467
00:19:38,910 --> 00:19:41,370
in a couple of cases we were able to

468
00:19:41,370 --> 00:19:43,920
obtain screenshots from victims when

469
00:19:43,920 --> 00:19:44,970
they had been in gay

470
00:19:44,970 --> 00:19:47,159
aged in a conversation back and forth

471
00:19:47,159 --> 00:19:48,510
with the attacker I'm gonna show you a

472
00:19:48,510 --> 00:19:50,760
screenshot of that now and yeah the

473
00:19:50,760 --> 00:19:53,130
attacker is a clearly very technically

474
00:19:53,130 --> 00:19:57,330
competent and a complete sociopath so

475
00:19:57,330 --> 00:19:59,909
here's a screenshot that was given to us

476
00:19:59,909 --> 00:20:01,740
by one of the victims we've masked out

477
00:20:01,740 --> 00:20:04,770
all the details to hide the identity of

478
00:20:04,770 --> 00:20:07,980
the victim but the gist of it is that

479
00:20:07,980 --> 00:20:09,900
basically the victim would post a

480
00:20:09,900 --> 00:20:11,789
comment on the left the person would

481
00:20:11,789 --> 00:20:14,130
respond on the right and in fact one of

482
00:20:14,130 --> 00:20:16,590
the sort of hallmarks of Sam Sam has

483
00:20:16,590 --> 00:20:18,990
been that the the customer service of

484
00:20:18,990 --> 00:20:21,720
these guys is actually pretty good that

485
00:20:21,720 --> 00:20:24,390
when you have finally paid your seven

486
00:20:24,390 --> 00:20:26,220
bitcoins and you're ready to decrypt

487
00:20:26,220 --> 00:20:27,990
your entire network all at once if

488
00:20:27,990 --> 00:20:29,669
there's any kind of problem with the

489
00:20:29,669 --> 00:20:31,080
Decrypter they will actually work with

490
00:20:31,080 --> 00:20:32,940
you to make sure that you can get your

491
00:20:32,940 --> 00:20:35,940
files back so I gave a presentation

492
00:20:35,940 --> 00:20:37,679
similar to this one last week and there

493
00:20:37,679 --> 00:20:40,230
was a question that was asked have they

494
00:20:40,230 --> 00:20:42,720
ever struck the same victim twice and to

495
00:20:42,720 --> 00:20:44,940
our knowledge they have not but that

496
00:20:44,940 --> 00:20:47,250
doesn't mean that they couldn't I think

497
00:20:47,250 --> 00:20:49,620
that they just move on and and go to the

498
00:20:49,620 --> 00:20:51,419
next target after this again it we're

499
00:20:51,419 --> 00:20:54,390
talking about a small group and they you

500
00:20:54,390 --> 00:20:56,820
know I think if they were to revitalise

501
00:20:56,820 --> 00:20:59,460
the same victims multiple times they

502
00:20:59,460 --> 00:21:01,020
might find it more difficult to collect

503
00:21:01,020 --> 00:21:06,030
payment but that is just a guess all

504
00:21:06,030 --> 00:21:08,130
right so some of the things that we know

505
00:21:08,130 --> 00:21:10,620
about the attackers is that again they

506
00:21:10,620 --> 00:21:13,500
are not super great English speakers and

507
00:21:13,500 --> 00:21:16,830
they do have these written tics that

508
00:21:16,830 --> 00:21:19,020
they kind of you know repeat over and

509
00:21:19,020 --> 00:21:21,390
over again in their communications and

510
00:21:21,390 --> 00:21:24,690
and also in the in the ransom notes as

511
00:21:24,690 --> 00:21:26,130
well and some of them is that you can

512
00:21:26,130 --> 00:21:27,600
see that there's some some pretty

513
00:21:27,600 --> 00:21:30,120
obvious spelling and punctuation errors

514
00:21:30,120 --> 00:21:34,020
and and this is just characteristic of

515
00:21:34,020 --> 00:21:36,030
someone who's just not the you know

516
00:21:36,030 --> 00:21:38,190
English is not their their main skill

517
00:21:38,190 --> 00:21:41,130
and that that's probably okay one of the

518
00:21:41,130 --> 00:21:42,809
other weird things that we noticed

519
00:21:42,809 --> 00:21:44,220
that's just a characteristic of this

520
00:21:44,220 --> 00:21:47,460
person is that they always seem to treat

521
00:21:47,460 --> 00:21:49,740
a comma as though it's the same as a

522
00:21:49,740 --> 00:21:51,750
period and so they kind of capitalized

523
00:21:51,750 --> 00:21:53,429
they put a space in the capital letter

524
00:21:53,429 --> 00:21:55,020
after it every time

525
00:21:55,020 --> 00:21:57,000
and it's just the sort of unique

526
00:21:57,000 --> 00:21:59,790
behavior that we see both in the ransom

527
00:21:59,790 --> 00:22:01,700
notes and in the chats that we've

528
00:22:01,700 --> 00:22:04,530
managed to obtain screenshots of justice

529
00:22:04,530 --> 00:22:06,930
just a strange thing and you know

530
00:22:06,930 --> 00:22:07,920
clearly it's someone who doesn't

531
00:22:07,920 --> 00:22:09,450
understand the purpose of this

532
00:22:09,450 --> 00:22:11,520
punctuation and you know that clearly

533
00:22:11,520 --> 00:22:13,560
doesn't you know affect their ability to

534
00:22:13,560 --> 00:22:17,850
earn money that was the entirety of my

535
00:22:17,850 --> 00:22:20,370
presentation I do need to thank Peter

536
00:22:20,370 --> 00:22:22,950
and Orca because it is really all of

537
00:22:22,950 --> 00:22:26,370
their work that we relied on to to be

538
00:22:26,370 --> 00:22:29,880
able to do this presentation and we did

539
00:22:29,880 --> 00:22:31,740
have a lot of partners from other

540
00:22:31,740 --> 00:22:33,510
organizations who shared with us

541
00:22:33,510 --> 00:22:36,840
information about the victims the ransom

542
00:22:36,840 --> 00:22:39,390
notes the Bitcoin addresses and we're

543
00:22:39,390 --> 00:22:42,180
very grateful to all of their for all of

544
00:22:42,180 --> 00:22:45,000
their help and and we would ask that if

545
00:22:45,000 --> 00:22:47,580
anyone here also would like to

546
00:22:47,580 --> 00:22:49,800
collaborate with us we are open to

547
00:22:49,800 --> 00:22:51,990
collaborating with you on future

548
00:22:51,990 --> 00:22:54,180
research of this type and specifically

549
00:22:54,180 --> 00:22:57,030
with these targeted ransomware campaigns

550
00:22:57,030 --> 00:22:59,970
we are tracking a new type of targeted

551
00:22:59,970 --> 00:23:02,760
ransomware campaign called Rio which is

552
00:23:02,760 --> 00:23:05,310
seeming to use the same methodology as

553
00:23:05,310 --> 00:23:07,740
Sam Sam and interestingly Sam Sam has

554
00:23:07,740 --> 00:23:10,080
gone relatively dark in the last couple

555
00:23:10,080 --> 00:23:12,000
of months I son surprisingly perhaps

556
00:23:12,000 --> 00:23:13,500
because of the report that kind of

557
00:23:13,500 --> 00:23:16,590
called a lot of attention to them but

558
00:23:16,590 --> 00:23:18,690
yes if you're interested or you have

559
00:23:18,690 --> 00:23:20,760
information that you can share with us

560
00:23:20,760 --> 00:23:22,710
we are happy to work with you so please

561
00:23:22,710 --> 00:23:24,810
reach out to me and I would like the

562
00:23:24,810 --> 00:23:26,760
audience to give me two questions before

563
00:23:26,760 --> 00:23:29,810
I jump off the stage

