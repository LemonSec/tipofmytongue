1
00:00:00,030 --> 00:00:02,009
okay everybody please take your seats

2
00:00:02,009 --> 00:00:03,540
for the final session of the day and

3
00:00:03,540 --> 00:00:09,030
Emmett queue this thing on tap tap

4
00:00:09,030 --> 00:00:12,059
yeah okay cool before I start how many

5
00:00:12,059 --> 00:00:14,160
of you attended last the last taught by

6
00:00:14,160 --> 00:00:18,570
Thomas okay cool I just want to say

7
00:00:18,570 --> 00:00:20,760
something before I start with my thing I

8
00:00:20,760 --> 00:00:22,710
just talked about with Thomas after his

9
00:00:22,710 --> 00:00:24,900
talk someone asked if there are any

10
00:00:24,900 --> 00:00:27,359
tools or any ways to mitigate the

11
00:00:27,359 --> 00:00:28,410
attacks that he talked about

12
00:00:28,410 --> 00:00:30,689
and is there a way to like enforce code

13
00:00:30,689 --> 00:00:34,140
signatures and stuff and then I I

14
00:00:34,140 --> 00:00:35,640
thought about it for a little bit and I

15
00:00:35,640 --> 00:00:37,920
talked about with Thomas and actually if

16
00:00:37,920 --> 00:00:41,790
you are hijacking dynamic library adaiah

17
00:00:41,790 --> 00:00:42,480
lib

18
00:00:42,480 --> 00:00:44,489
you can actually override the function

19
00:00:44,489 --> 00:00:46,230
that checks the signature which is what

20
00:00:46,230 --> 00:00:49,079
Thomas suggested to do so I thought

21
00:00:49,079 --> 00:00:52,190
about a quick fix just sharing with you

22
00:00:52,190 --> 00:00:56,190
when you are writing your program start

23
00:00:56,190 --> 00:00:59,010
your program pause all threads its

24
00:00:59,010 --> 00:01:02,309
I click this yeah okay start your

25
00:01:02,309 --> 00:01:04,080
program make sure that none of the

26
00:01:04,080 --> 00:01:05,850
threads are doing anything important

27
00:01:05,850 --> 00:01:08,369
check your signature first and then load

28
00:01:08,369 --> 00:01:10,320
everything else because if someone

29
00:01:10,320 --> 00:01:12,960
hijacks Lib system they can also hijack

30
00:01:12,960 --> 00:01:14,610
SEC static code validity check which is

31
00:01:14,610 --> 00:01:16,770
the call that you are calling in order

32
00:01:16,770 --> 00:01:19,770
to check your signatures so free fix for

33
00:01:19,770 --> 00:01:24,570
everyone and now for my okay so hi

34
00:01:24,570 --> 00:01:28,140
everyone I may go a little bit over time

35
00:01:28,140 --> 00:01:31,189
this is cool with the conference so

36
00:01:31,189 --> 00:01:33,900
please like stick around because it's

37
00:01:33,900 --> 00:01:35,750
definitely worth it because it's just a

38
00:01:35,750 --> 00:01:38,490
cascade of dumb what I'm gonna show

39
00:01:38,490 --> 00:01:41,579
you that's me real quick

40
00:01:41,579 --> 00:01:43,890
my name is weird I'm originally from

41
00:01:43,890 --> 00:01:46,439
Israel I am now a very well-documented

42
00:01:46,439 --> 00:01:51,479
US immigrant all right I'm in Canada no

43
00:01:51,479 --> 00:01:56,250
one gives a I am the head of

44
00:01:56,250 --> 00:01:57,899
security research at cyber ease in

45
00:01:57,899 --> 00:02:00,090
Nocturna switch is our Advanced Research

46
00:02:00,090 --> 00:02:02,880
Lab and services arm of the organization

47
00:02:02,880 --> 00:02:06,149
I do a lot of research from low-level to

48
00:02:06,149 --> 00:02:08,068
malware and Mac and Windows and Linux

49
00:02:08,068 --> 00:02:10,410
and everything and I should post on

50
00:02:10,410 --> 00:02:12,690
Twitter and that's my handle so make

51
00:02:12,690 --> 00:02:13,620
sure you can also

52
00:02:13,620 --> 00:02:17,370
make sure you also heckle me there now

53
00:02:17,370 --> 00:02:19,019
before I start I need to give you guys a

54
00:02:19,019 --> 00:02:21,750
quick history lesson because this dumb

55
00:02:21,750 --> 00:02:24,629
story has been going on for a while and

56
00:02:24,629 --> 00:02:26,760
it's honestly the gift that the gift

57
00:02:26,760 --> 00:02:29,040
that keeps on giving at least for me

58
00:02:29,040 --> 00:02:32,459
so back in 2016 about two years ago from

59
00:02:32,459 --> 00:02:33,239
now

60
00:02:33,239 --> 00:02:35,430
I was bored one evening I was still

61
00:02:35,430 --> 00:02:37,230
living in Israel back at the time and I

62
00:02:37,230 --> 00:02:40,950
was an IRC on a channel that's called

63
00:02:40,950 --> 00:02:44,190
Mecca OS xr/e that's mainly revolves

64
00:02:44,190 --> 00:02:47,640
around OS X reverse engineering and some

65
00:02:47,640 --> 00:02:49,829
guy popped in to IRC and said hey I have

66
00:02:49,829 --> 00:02:52,440
this really weird thing going on in my

67
00:02:52,440 --> 00:02:54,720
machine and I don't know what it is

68
00:02:54,720 --> 00:02:57,299
but I have a bunch of new users that I

69
00:02:57,299 --> 00:03:00,450
don't know they have root privileges my

70
00:03:00,450 --> 00:03:02,970
machine is really slow I'm getting

71
00:03:02,970 --> 00:03:05,069
bombarded with ads I have no idea what

72
00:03:05,069 --> 00:03:08,220
this is so I was bored enough that

73
00:03:08,220 --> 00:03:09,810
evening so I took that thing and I

74
00:03:09,810 --> 00:03:12,209
toured completely apart I released a

75
00:03:12,209 --> 00:03:15,780
series of blog posts and articles and I

76
00:03:15,780 --> 00:03:18,510
even talked about it in some conferences

77
00:03:18,510 --> 00:03:22,829
and excuse me I ended up finding exactly

78
00:03:22,829 --> 00:03:24,930
who stands behind that adware that I

79
00:03:24,930 --> 00:03:27,090
named that OS X spirit because it was a

80
00:03:27,090 --> 00:03:29,760
port of the windows period ad where I

81
00:03:29,760 --> 00:03:32,459
found out that was an Israeli company of

82
00:03:32,459 --> 00:03:36,269
course and it had some really shady

83
00:03:36,269 --> 00:03:39,000
Israeli people behind it of course I can

84
00:03:39,000 --> 00:03:40,859
say that it's cool I'm a shady Israeli

85
00:03:40,859 --> 00:03:45,629
guy and I ended up naming them and if

86
00:03:45,629 --> 00:03:46,919
you were clever enough you could easily

87
00:03:46,919 --> 00:03:49,230
find their photos and and that's how it

88
00:03:49,230 --> 00:03:52,799
ended for me about two years ago and

89
00:03:52,799 --> 00:03:55,049
then almost a year ago in November of

90
00:03:55,049 --> 00:03:58,139
2017 I have a bunch of yarra rules and

91
00:03:58,139 --> 00:03:59,669
they're starting and they started to

92
00:03:59,669 --> 00:04:01,410
light up like a Christmas tree because

93
00:04:01,410 --> 00:04:04,319
apparently those idiots were back with

94
00:04:04,319 --> 00:04:08,970
some more shitty adware I of course as I

95
00:04:08,970 --> 00:04:11,639
said I posted a bunch of tweets on

96
00:04:11,639 --> 00:04:14,879
Twitter and within less than a day I

97
00:04:14,879 --> 00:04:18,750
started getting legal threats from the

98
00:04:18,750 --> 00:04:20,160
company that's called targeting edge

99
00:04:20,160 --> 00:04:22,289
which is the company that develops OSX

100
00:04:22,289 --> 00:04:25,080
spirit and have those people working for

101
00:04:25,080 --> 00:04:27,030
them the guys that I have

102
00:04:27,030 --> 00:04:29,730
and masked unmask if you will now I

103
00:04:29,730 --> 00:04:33,060
won't spend any time on this because

104
00:04:33,060 --> 00:04:35,250
this is absolutely crap but basically

105
00:04:35,250 --> 00:04:37,950
they called me cybersecurity expert with

106
00:04:37,950 --> 00:04:39,870
quotes they say that I don't know

107
00:04:39,870 --> 00:04:41,610
anything they said that this that their

108
00:04:41,610 --> 00:04:45,090
product is not malware that they have

109
00:04:45,090 --> 00:04:47,040
nothing to do with period they are

110
00:04:47,040 --> 00:04:49,800
completely unrelated to that which is

111
00:04:49,800 --> 00:04:51,660
kind of stupid because I already proved

112
00:04:51,660 --> 00:04:53,940
that they are because their names was in

113
00:04:53,940 --> 00:04:58,410
the goddamn code but then again they

114
00:04:58,410 --> 00:04:59,940
said that they had nothing to do with it

115
00:04:59,940 --> 00:05:04,020
I said that I actually do believe that

116
00:05:04,020 --> 00:05:07,110
they are behind it I proved it again I

117
00:05:07,110 --> 00:05:09,630
also said that they are trying to

118
00:05:09,630 --> 00:05:12,419
distance themselves themselves from this

119
00:05:12,419 --> 00:05:13,890
product they said we are not trying to

120
00:05:13,890 --> 00:05:15,270
distance ourselves from this product

121
00:05:15,270 --> 00:05:18,450
because we have no relation to it we

122
00:05:18,450 --> 00:05:20,760
will revisit that claim in the last

123
00:05:20,760 --> 00:05:25,410
slide of this talk also and and most

124
00:05:25,410 --> 00:05:28,320
importantly they said that there that's

125
00:05:28,320 --> 00:05:29,669
what I just said that they're not trying

126
00:05:29,669 --> 00:05:30,990
to distance themselves but they also

127
00:05:30,990 --> 00:05:33,270
said that their product is not trying to

128
00:05:33,270 --> 00:05:35,490
take over your machine which is which it

129
00:05:35,490 --> 00:05:37,979
it totally does that and I will show you

130
00:05:37,979 --> 00:05:39,990
that as well so basically what happened

131
00:05:39,990 --> 00:05:43,979
as every day they sent me and cyber

132
00:05:43,979 --> 00:05:45,780
reasons attorney they send us a bunch of

133
00:05:45,780 --> 00:05:47,940
legal threat letters sometimes they send

134
00:05:47,940 --> 00:05:49,890
us even to a day and they try to deter

135
00:05:49,890 --> 00:05:52,620
us from doing our our job now at this

136
00:05:52,620 --> 00:05:54,570
point this was a year after the whole

137
00:05:54,570 --> 00:05:56,669
period thing like I already proved it

138
00:05:56,669 --> 00:05:58,590
was them I had nothing like I had

139
00:05:58,590 --> 00:06:01,080
nothing clever to add because their

140
00:06:01,080 --> 00:06:03,630
photos were everywhere but once they

141
00:06:03,630 --> 00:06:06,060
started to like send me legal threat

142
00:06:06,060 --> 00:06:09,570
letters I got kind of pissed off and

143
00:06:09,570 --> 00:06:11,880
luckily our CEO was like hey let's

144
00:06:11,880 --> 00:06:13,110
they want to with us let's

145
00:06:13,110 --> 00:06:15,750
with them back so III got management

146
00:06:15,750 --> 00:06:19,800
behind me so ok let's play they then

147
00:06:19,800 --> 00:06:22,080
said that their product is not malware

148
00:06:22,080 --> 00:06:24,300
and then they sent in their letter they

149
00:06:24,300 --> 00:06:27,960
said here is e sets here is e sets

150
00:06:27,960 --> 00:06:30,810
definition of what malware is and of

151
00:06:30,810 --> 00:06:33,510
course they check every one of those

152
00:06:33,510 --> 00:06:35,820
boxes which is really stupid and I will

153
00:06:35,820 --> 00:06:37,880
show you that as well

154
00:06:37,880 --> 00:06:40,240
so now we need

155
00:06:40,240 --> 00:06:44,169
start with what happened to most the

156
00:06:44,169 --> 00:06:45,460
funniest thing is that they actually

157
00:06:45,460 --> 00:06:48,430
they said okay if you are going to

158
00:06:48,430 --> 00:06:50,800
publish your report because at the

159
00:06:50,800 --> 00:06:52,270
beginning they tried to send us a cease

160
00:06:52,270 --> 00:06:54,430
and desist but then we told them hey

161
00:06:54,430 --> 00:06:55,900
your sis and desist doesn't mean

162
00:06:55,900 --> 00:06:57,610
anything I mean you're in Israel we're

163
00:06:57,610 --> 00:07:00,639
in the US we are not this is not like an

164
00:07:00,639 --> 00:07:02,710
opinion this is all facts we've proven

165
00:07:02,710 --> 00:07:05,020
that this is you before and they said

166
00:07:05,020 --> 00:07:07,479
well if you are going to publish your

167
00:07:07,479 --> 00:07:11,770
report we demand demand that you will

168
00:07:11,770 --> 00:07:15,669
publish this sort of I don't know how to

169
00:07:15,669 --> 00:07:18,099
call it exactly a disclaimer an article

170
00:07:18,099 --> 00:07:20,440
whatever in your report because this is

171
00:07:20,440 --> 00:07:22,900
basically their version of things now we

172
00:07:22,900 --> 00:07:25,840
are absolutely not obligated to put that

173
00:07:25,840 --> 00:07:27,819
anywhere not in our report not in our

174
00:07:27,819 --> 00:07:29,710
slide shown on our slide deck not in

175
00:07:29,710 --> 00:07:31,750
everything but this is so profoundly

176
00:07:31,750 --> 00:07:37,000
stupid that we had to do it so and again

177
00:07:37,000 --> 00:07:40,360
I will make those slides available there

178
00:07:40,360 --> 00:07:43,360
is already a different version of this

179
00:07:43,360 --> 00:07:45,520
talk on YouTube that you can also see

180
00:07:45,520 --> 00:07:47,289
that because it's it's a waste of time

181
00:07:47,289 --> 00:07:50,770
honestly now their claim was everything

182
00:07:50,770 --> 00:07:52,870
is kosher we are not doing everything

183
00:07:52,870 --> 00:07:54,940
we're not doing anything weird we're not

184
00:07:54,940 --> 00:07:57,310
hijacking your machine everything is in

185
00:07:57,310 --> 00:07:59,500
the end-user License Agreement now for

186
00:07:59,500 --> 00:08:01,810
the life of me I couldn't find an

187
00:08:01,810 --> 00:08:03,520
end-user License Agreement and I had

188
00:08:03,520 --> 00:08:05,110
about a thousand samples of their

189
00:08:05,110 --> 00:08:07,930
installers there is no end user License

190
00:08:07,930 --> 00:08:10,000
Agreement anywhere there is nothing on

191
00:08:10,000 --> 00:08:13,180
their website and and the only thing

192
00:08:13,180 --> 00:08:16,000
that that is that is on their website is

193
00:08:16,000 --> 00:08:19,240
an email address but when Zach Whitaker

194
00:08:19,240 --> 00:08:21,610
which is he's a journalist used to work

195
00:08:21,610 --> 00:08:23,050
at ZDNet back at the time now he's a

196
00:08:23,050 --> 00:08:25,180
TechCrunch Zack Whitaker tried to reach

197
00:08:25,180 --> 00:08:26,680
out to them because he was writing an

198
00:08:26,680 --> 00:08:28,840
article on this whole thing so he sent

199
00:08:28,840 --> 00:08:30,630
an email to info at targeting edge.com

200
00:08:30,630 --> 00:08:33,370
which is on their website and their and

201
00:08:33,370 --> 00:08:35,020
the email address doesn't exist and the

202
00:08:35,020 --> 00:08:37,390
email bounced back so yeah everything is

203
00:08:37,390 --> 00:08:41,169
kosher and everything is awesome so here

204
00:08:41,169 --> 00:08:44,169
we are now starting this whole cascade

205
00:08:44,169 --> 00:08:47,470
of stupidness again now before I get

206
00:08:47,470 --> 00:08:50,020
technical I need to explain for a second

207
00:08:50,020 --> 00:08:52,449
how Mac installers work how people

208
00:08:52,449 --> 00:08:53,330
usually get

209
00:08:53,330 --> 00:08:57,050
with ADD we're on Macs so let's talk

210
00:08:57,050 --> 00:08:58,580
about it's really like it'll take me a

211
00:08:58,580 --> 00:08:59,029
minute

212
00:08:59,029 --> 00:09:02,000
so in Mac installers machan stores are

213
00:09:02,000 --> 00:09:04,279
actually called packages and packages

214
00:09:04,279 --> 00:09:07,070
have a few features one of those

215
00:09:07,070 --> 00:09:08,360
features is something that's called a

216
00:09:08,360 --> 00:09:10,970
pre-flight script now a pre-flight

217
00:09:10,970 --> 00:09:13,459
script is a script that when you create

218
00:09:13,459 --> 00:09:14,899
the Installer you can define a preflight

219
00:09:14,899 --> 00:09:16,730
script in applet in a pre-flight script

220
00:09:16,730 --> 00:09:20,690
will run will get executed as soon as

221
00:09:20,690 --> 00:09:23,060
the Installer is launched so that means

222
00:09:23,060 --> 00:09:25,880
that that that runs before the end user

223
00:09:25,880 --> 00:09:27,620
License Agreement that runs before you

224
00:09:27,620 --> 00:09:30,829
click I agree that literally runs once

225
00:09:30,829 --> 00:09:33,200
you double click the Installer and

226
00:09:33,200 --> 00:09:34,880
usually the way that those things work

227
00:09:34,880 --> 00:09:37,100
is that you are that you're going to one

228
00:09:37,100 --> 00:09:38,810
of those shitty software websites like

229
00:09:38,810 --> 00:09:40,940
softonic and download.com and all of

230
00:09:40,940 --> 00:09:42,800
those and then you download whatever you

231
00:09:42,800 --> 00:09:44,630
want to download for example VLC media

232
00:09:44,630 --> 00:09:47,360
player but then what you will get is an

233
00:09:47,360 --> 00:09:49,670
installer that was made but by one of

234
00:09:49,670 --> 00:09:51,560
those targeting edge kind of adware

235
00:09:51,560 --> 00:09:53,959
software monetization companies and you

236
00:09:53,959 --> 00:09:56,329
will get an installer that sometimes

237
00:09:56,329 --> 00:09:58,670
will actually install what you wanted to

238
00:09:58,670 --> 00:10:00,950
install and sometimes it will not but it

239
00:10:00,950 --> 00:10:02,810
will also with it will always install

240
00:10:02,810 --> 00:10:04,520
some sort of adware in your machine and

241
00:10:04,520 --> 00:10:06,320
the way that it happens is that the

242
00:10:06,320 --> 00:10:08,120
Adler is installed through those

243
00:10:08,120 --> 00:10:10,700
preflight scripts so you click you

244
00:10:10,700 --> 00:10:12,589
double-click the thing and then your you

245
00:10:12,589 --> 00:10:15,500
get you get adware which I call herpes

246
00:10:15,500 --> 00:10:17,180
so you double click the thing you get

247
00:10:17,180 --> 00:10:20,480
herpes and then maybe maybe you get VLC

248
00:10:20,480 --> 00:10:22,850
media player but most in in most of the

249
00:10:22,850 --> 00:10:24,440
cases you don't get anything you just

250
00:10:24,440 --> 00:10:27,649
get herpes which is a lose-lose

251
00:10:27,649 --> 00:10:32,120
situation for everyone now the new

252
00:10:32,120 --> 00:10:34,250
installers that I looked at the ones

253
00:10:34,250 --> 00:10:36,760
that started showing up on my own rules

254
00:10:36,760 --> 00:10:40,130
had something really weird with them the

255
00:10:40,130 --> 00:10:43,070
preflight script was was accessing that

256
00:10:43,070 --> 00:10:45,589
URL and as you can see I don't have a

257
00:10:45,589 --> 00:10:48,199
pointer but where the red arrow is right

258
00:10:48,199 --> 00:10:51,709
you know you can see that there is an ID

259
00:10:51,709 --> 00:10:54,649
now that idea is like a long gooood that

260
00:10:54,649 --> 00:10:56,870
only works once so this good is

261
00:10:56,870 --> 00:11:00,110
generated every time you download the

262
00:11:00,110 --> 00:11:03,649
package now obviously by the time I got

263
00:11:03,649 --> 00:11:06,079
the samples that package was already

264
00:11:06,079 --> 00:11:07,170
executed

265
00:11:07,170 --> 00:11:08,880
already executed in someone else's

266
00:11:08,880 --> 00:11:12,450
machine so that link did not work so at

267
00:11:12,450 --> 00:11:14,279
that point I was kind of stuck because I

268
00:11:14,279 --> 00:11:16,470
had something but I couldn't get it to

269
00:11:16,470 --> 00:11:19,800
work so what I did is basically my life

270
00:11:19,800 --> 00:11:22,320
motto when everything fails apply

271
00:11:22,320 --> 00:11:26,490
 so I just took that whole URL

272
00:11:26,490 --> 00:11:29,550
shove it into Python and I just said

273
00:11:29,550 --> 00:11:32,490
okay requests dot get and I try to

274
00:11:32,490 --> 00:11:36,209
request that URL but instead of instead

275
00:11:36,209 --> 00:11:39,269
of putting that long ID here I just I

276
00:11:39,269 --> 00:11:41,970
just put a single quote just a single

277
00:11:41,970 --> 00:11:44,190
quote and I said I wonder what's gonna

278
00:11:44,190 --> 00:11:46,459
happen if I'll send that request and

279
00:11:46,459 --> 00:11:50,010
what happened is I got another URL back

280
00:11:50,010 --> 00:11:54,690
from the server and I was like okay what

281
00:11:54,690 --> 00:11:56,550
is going to happen if I'll request that

282
00:11:56,550 --> 00:11:58,939
URL

283
00:12:02,670 --> 00:12:05,760
I got an installation stripped with like

284
00:12:05,760 --> 00:12:09,030
300 and something lines right oh my god

285
00:12:09,030 --> 00:12:12,240
that's great and I'll zoom in quite a

286
00:12:12,240 --> 00:12:13,800
bit for you because it's kind of hard to

287
00:12:13,800 --> 00:12:16,020
see but if you look here like right in

288
00:12:16,020 --> 00:12:17,610
the middle you can see that things are

289
00:12:17,610 --> 00:12:22,170
running with sudo and if something is if

290
00:12:22,170 --> 00:12:24,480
they're if they have the ability to run

291
00:12:24,480 --> 00:12:28,170
something with sudo that means that they

292
00:12:28,170 --> 00:12:29,640
can run stuff with root because usually

293
00:12:29,640 --> 00:12:32,610
when you do sudo something the machine

294
00:12:32,610 --> 00:12:34,050
will ask you for your root for your

295
00:12:34,050 --> 00:12:36,180
password which on on on a default

296
00:12:36,180 --> 00:12:38,640
installation of Mac OS your root

297
00:12:38,640 --> 00:12:40,950
password is basically your own password

298
00:12:40,950 --> 00:12:42,750
because you were su doing as yourself

299
00:12:42,750 --> 00:12:45,450
it's the practice that's also common in

300
00:12:45,450 --> 00:12:48,030
like Ubuntu Linux installations and it's

301
00:12:48,030 --> 00:12:51,080
kind of bad so that thing should stop

302
00:12:51,080 --> 00:12:54,210
but the question is how can they run

303
00:12:54,210 --> 00:12:56,790
things with like root access if they

304
00:12:56,790 --> 00:12:58,890
have just started running and like the

305
00:12:58,890 --> 00:13:01,140
thing does not ask for your password so

306
00:13:01,140 --> 00:13:04,640
I actually answered that in my previous

307
00:13:04,640 --> 00:13:07,050
talk about period from two years ago

308
00:13:07,050 --> 00:13:09,000
when you are running a package installer

309
00:13:09,000 --> 00:13:10,680
on Mac the first thing that happens is

310
00:13:10,680 --> 00:13:14,070
you get a pop-up that says the package

311
00:13:14,070 --> 00:13:15,840
installer or whatever installer wants

312
00:13:15,840 --> 00:13:17,460
your permission to change some stuff on

313
00:13:17,460 --> 00:13:18,780
your system because obviously you need

314
00:13:18,780 --> 00:13:21,270
to give it permissions to install once

315
00:13:21,270 --> 00:13:23,820
you give it the password the installer

316
00:13:23,820 --> 00:13:25,200
has your password and it can run

317
00:13:25,200 --> 00:13:27,150
anything as root because your password

318
00:13:27,150 --> 00:13:29,340
is the root password so this is how they

319
00:13:29,340 --> 00:13:31,470
escalate themselves through it's not

320
00:13:31,470 --> 00:13:33,540
clever it's pretty dumb but that's how

321
00:13:33,540 --> 00:13:38,010
things are now once this once this huge

322
00:13:38,010 --> 00:13:40,290
script is running so as yeah as I stated

323
00:13:40,290 --> 00:13:44,460
it has 320 law and 329 lines which is

324
00:13:44,460 --> 00:13:48,210
that thing now this script was almost

325
00:13:48,210 --> 00:13:50,880
identical to the script from two years

326
00:13:50,880 --> 00:13:52,740
ago and again like targeting edge say

327
00:13:52,740 --> 00:13:54,870
they keep saying we have nothing to do

328
00:13:54,870 --> 00:13:56,880
with this we are not connected to this

329
00:13:56,880 --> 00:14:00,240
by any way or form and yet the code is

330
00:14:00,240 --> 00:14:02,850
like almost identical it was like 99%

331
00:14:02,850 --> 00:14:03,960
identical the only thing that was

332
00:14:03,960 --> 00:14:06,120
different was a bunch of URLs and some

333
00:14:06,120 --> 00:14:08,640
other like variables but the code was

334
00:14:08,640 --> 00:14:12,630
exactly the same that script had a lot

335
00:14:12,630 --> 00:14:15,970
of URLs those URLs resolved to

336
00:14:15,970 --> 00:14:19,029
a bunch of different servers so and

337
00:14:19,029 --> 00:14:21,759
those servers also had DGA addresses

338
00:14:21,759 --> 00:14:23,769
every anybody here knows what a DGA

339
00:14:23,769 --> 00:14:26,889
is okay cool so for those of you that

340
00:14:26,889 --> 00:14:29,860
don't know DGA stands for domain

341
00:14:29,860 --> 00:14:32,319
generation algorithm that means that

342
00:14:32,319 --> 00:14:34,420
it's it's a it's a it's a tactic that

343
00:14:34,420 --> 00:14:37,149
that a lot of malware are using it

344
00:14:37,149 --> 00:14:39,069
basically means that there is like an

345
00:14:39,069 --> 00:14:41,949
algorithm that generates predictable

346
00:14:41,949 --> 00:14:44,639
domain names and then the attackers can

347
00:14:44,639 --> 00:14:47,680
register domain names on the fly because

348
00:14:47,680 --> 00:14:49,629
if one of their domains that was

349
00:14:49,629 --> 00:14:52,689
connected to a C&C was blocked or was

350
00:14:52,689 --> 00:14:54,160
published somewhere they could just

351
00:14:54,160 --> 00:14:56,470
scrap that domain and register the and

352
00:14:56,470 --> 00:14:58,839
register a different domain and this

353
00:14:58,839 --> 00:15:00,790
does not need to be synced in any way

354
00:15:00,790 --> 00:15:03,160
with the malware because the algorithm

355
00:15:03,160 --> 00:15:04,750
that's in the malware is going to

356
00:15:04,750 --> 00:15:06,759
generate a domain that is predictable by

357
00:15:06,759 --> 00:15:08,740
the attackers so that's exactly what

358
00:15:08,740 --> 00:15:10,120
they did all of their domains were like

359
00:15:10,120 --> 00:15:12,279
weird and like had all of this I mean

360
00:15:12,279 --> 00:15:13,629
also look they look like completely

361
00:15:13,629 --> 00:15:15,490
random like a cat walked on the keyboard

362
00:15:15,490 --> 00:15:17,920
and there were a bunch of domains like

363
00:15:17,920 --> 00:15:21,009
like this in the adware and again like

364
00:15:21,009 --> 00:15:22,360
when you see something like that as a

365
00:15:22,360 --> 00:15:23,680
malware research you're automatically

366
00:15:23,680 --> 00:15:25,149
like wow this is malware like did

367
00:15:25,149 --> 00:15:27,309
nothing nothing legitimate ever looks

368
00:15:27,309 --> 00:15:30,189
like that now those scripts there that

369
00:15:30,189 --> 00:15:32,379
those scripts that are running they are

370
00:15:32,379 --> 00:15:34,660
downloading a bunch of payloads and

371
00:15:34,660 --> 00:15:37,089
every time it's like those Russian it's

372
00:15:37,089 --> 00:15:38,829
like this Russian matryoshka dolls where

373
00:15:38,829 --> 00:15:40,329
you open one and there's a smaller doll

374
00:15:40,329 --> 00:15:41,559
inside and you open one and there's a

375
00:15:41,559 --> 00:15:43,540
smaller one inside so that's pretty much

376
00:15:43,540 --> 00:15:46,779
how they work and let's look at that for

377
00:15:46,779 --> 00:15:50,019
a second so first of all when the first

378
00:15:50,019 --> 00:15:52,389
script runs it generates a random name a

379
00:15:52,389 --> 00:15:54,430
random word sorry the way that it does

380
00:15:54,430 --> 00:15:56,199
that and this is taken directly from the

381
00:15:56,199 --> 00:15:57,430
script there is a function that's called

382
00:15:57,430 --> 00:16:00,370
R and E stands for random and it

383
00:16:00,370 --> 00:16:03,040
basically just cats the the dictionary

384
00:16:03,040 --> 00:16:05,170
the word dictionary file that exists on

385
00:16:05,170 --> 00:16:07,660
any Mac and slash USR slash Hirst /

386
00:16:07,660 --> 00:16:11,379
share / nicht slash words it then picks

387
00:16:11,379 --> 00:16:13,660
up a random word and saves it into a

388
00:16:13,660 --> 00:16:15,790
variable the / the the purpose of this

389
00:16:15,790 --> 00:16:18,850
thing is to make each installation on

390
00:16:18,850 --> 00:16:21,879
each computer different so if I am as a

391
00:16:21,879 --> 00:16:24,850
researcher for example if I put in on my

392
00:16:24,850 --> 00:16:26,439
machine and the word it was selected is

393
00:16:26,439 --> 00:16:27,320
table

394
00:16:27,320 --> 00:16:30,410
then I will tell my friends hey see if

395
00:16:30,410 --> 00:16:32,300
you have this launch agent or a

396
00:16:32,300 --> 00:16:34,130
directory or a file or whatever that's

397
00:16:34,130 --> 00:16:36,110
called table obviously they won't have

398
00:16:36,110 --> 00:16:38,360
it because in their machine a different

399
00:16:38,360 --> 00:16:41,330
a different word was selected so part of

400
00:16:41,330 --> 00:16:45,040
making it stealthy is to generate a

401
00:16:45,040 --> 00:16:48,740
random word thing is that exactly the

402
00:16:48,740 --> 00:16:50,960
same thing with the same line with the

403
00:16:50,960 --> 00:16:52,670
same function name with the same line of

404
00:16:52,670 --> 00:16:55,070
code exactly the same thing happened two

405
00:16:55,070 --> 00:16:57,320
years ago in old period and period v1

406
00:16:57,320 --> 00:16:58,910
and again they say that they have

407
00:16:58,910 --> 00:17:02,900
nothing to do with it once the random

408
00:17:02,900 --> 00:17:04,970
word was generated the next step would

409
00:17:04,970 --> 00:17:08,300
be to get the unique identifier of the

410
00:17:08,300 --> 00:17:10,730
computer so each Mac has a unique

411
00:17:10,730 --> 00:17:12,560
identifier like a serial number and

412
00:17:12,560 --> 00:17:14,569
there is only one of those in the world

413
00:17:14,569 --> 00:17:18,349
so your Mac is unique and this this

414
00:17:18,349 --> 00:17:22,750
unique identifier is being taken from

415
00:17:22,750 --> 00:17:26,420
from IO reg which they think about it

416
00:17:26,420 --> 00:17:28,610
like the registry on Windows but on Mac

417
00:17:28,610 --> 00:17:31,720
so they're simply executing IR edge and

418
00:17:31,720 --> 00:17:34,520
they're taking that piece of information

419
00:17:34,520 --> 00:17:37,130
from IO reg which is your unique

420
00:17:37,130 --> 00:17:38,750
identifier of your Mac and then they

421
00:17:38,750 --> 00:17:40,790
send it to their server now if you look

422
00:17:40,790 --> 00:17:43,370
at the domain here you can see one of

423
00:17:43,370 --> 00:17:44,690
those weird domains right it's like a

424
00:17:44,690 --> 00:17:46,520
number and then it's like it looks like

425
00:17:46,520 --> 00:17:48,350
a cat walked on keyboard as I said and

426
00:17:48,350 --> 00:17:51,050
then they take your they take your

427
00:17:51,050 --> 00:17:53,240
identifier and they send it back to them

428
00:17:53,240 --> 00:17:55,460
and they do that because that's how they

429
00:17:55,460 --> 00:17:57,380
can identify you and that's how they can

430
00:17:57,380 --> 00:18:01,190
know if adware was actually executed and

431
00:18:01,190 --> 00:18:03,040
installed on your machine successfully

432
00:18:03,040 --> 00:18:06,290
they explicitly said that they don't do

433
00:18:06,290 --> 00:18:12,530
that the next step will be to phone home

434
00:18:12,530 --> 00:18:17,120
and say hey everything is going well so

435
00:18:17,120 --> 00:18:20,210
they will they're phoning home with your

436
00:18:20,210 --> 00:18:21,530
unique identifier and they're saying

437
00:18:21,530 --> 00:18:25,640
okay I have now installed period on this

438
00:18:25,640 --> 00:18:29,900
machine identified by your UUID and then

439
00:18:29,900 --> 00:18:35,120
they will download another payload this

440
00:18:35,120 --> 00:18:37,160
payload will create a launch agent which

441
00:18:37,160 --> 00:18:41,120
is an auto run in Mac speak and that and

442
00:18:41,120 --> 00:18:43,280
that oughta run we'll also have a random

443
00:18:43,280 --> 00:18:48,770
name now if you look at the file that's

444
00:18:48,770 --> 00:18:51,140
that's being downloaded because this

445
00:18:51,140 --> 00:18:53,809
also downloads a binary executable and

446
00:18:53,809 --> 00:18:56,480
if you look at the binary executable and

447
00:18:56,480 --> 00:18:58,400
you look at the names of the functions

448
00:18:58,400 --> 00:19:00,680
you can see something very interesting

449
00:19:00,680 --> 00:19:03,110
so you can see that the names of the

450
00:19:03,110 --> 00:19:04,670
functions are start updates and

451
00:19:04,670 --> 00:19:07,010
connection did receive response did

452
00:19:07,010 --> 00:19:08,990
receive data will cache bla bla bla bla

453
00:19:08,990 --> 00:19:12,140
bla and then they have a function that's

454
00:19:12,140 --> 00:19:14,390
called run external application which

455
00:19:14,390 --> 00:19:17,450
accepts arguments and when you look at

456
00:19:17,450 --> 00:19:21,350
it and either Pro you see that I hope

457
00:19:21,350 --> 00:19:24,800
that this is legible enough you can see

458
00:19:24,800 --> 00:19:26,870
that there actually this function

459
00:19:26,870 --> 00:19:29,480
actually executes s'b in SH your shell

460
00:19:29,480 --> 00:19:32,990
interpreter and it takes an argument so

461
00:19:32,990 --> 00:19:35,600
this is basically a rat now which is

462
00:19:35,600 --> 00:19:36,740
something that they didn't have before

463
00:19:36,740 --> 00:19:39,500
so right right now they have the ability

464
00:19:39,500 --> 00:19:42,050
not only that they're installed on your

465
00:19:42,050 --> 00:19:43,850
machine they also have functionality

466
00:19:43,850 --> 00:19:46,400
which is like a rat they can execute

467
00:19:46,400 --> 00:19:49,190
commands and they can execute commands

468
00:19:49,190 --> 00:19:51,140
as root which is something that they

469
00:19:51,140 --> 00:19:55,120
explicitly said that they're not doing

470
00:19:55,450 --> 00:19:58,010
another interesting fact about this

471
00:19:58,010 --> 00:20:00,980
binary is that as it is code signed now

472
00:20:00,980 --> 00:20:03,830
as Tomas just mentioned in his talk code

473
00:20:03,830 --> 00:20:06,350
signature is a feature that Apple added

474
00:20:06,350 --> 00:20:07,640
that's supposed to make everything more

475
00:20:07,640 --> 00:20:10,820
secure because every binary that's

476
00:20:10,820 --> 00:20:12,950
executed on a Mac system should be code

477
00:20:12,950 --> 00:20:16,730
sign now here's the thing code signing

478
00:20:16,730 --> 00:20:19,130
on Apple is kind of dumb because in

479
00:20:19,130 --> 00:20:21,740
order to get a code signing certificate

480
00:20:21,740 --> 00:20:24,590
you need to pay Apple 99 dollars and

481
00:20:24,590 --> 00:20:32,210
tell them a story so in old period what

482
00:20:32,210 --> 00:20:34,790
they what they did is they stockpiled a

483
00:20:34,790 --> 00:20:37,660
bunch of code signing certificates and

484
00:20:37,660 --> 00:20:40,730
and every time I found a new variant of

485
00:20:40,730 --> 00:20:42,679
their code and I found a new server that

486
00:20:42,679 --> 00:20:44,900
distributes their malware I contacted

487
00:20:44,900 --> 00:20:46,610
Apple and I said hey this is the hash

488
00:20:46,610 --> 00:20:48,559
this is the this is the code signing

489
00:20:48,559 --> 00:20:51,110
certificate please revoke it then Apple

490
00:20:51,110 --> 00:20:53,660
went ahead and revoked it and within 25

491
00:20:53,660 --> 00:20:54,480
minutes

492
00:20:54,480 --> 00:20:56,640
they had a new version with a different

493
00:20:56,640 --> 00:20:58,440
code signature and I did this process

494
00:20:58,440 --> 00:21:00,870
for like 25 or 30 times and then I just

495
00:21:00,870 --> 00:21:03,000
stopped and I realized they just have a

496
00:21:03,000 --> 00:21:06,030
bunch of code signing certificates now

497
00:21:06,030 --> 00:21:07,770
all of those code signing certificates

498
00:21:07,770 --> 00:21:11,640
from two years ago had had Israeli names

499
00:21:11,640 --> 00:21:13,470
so that's when I started suspecting that

500
00:21:13,470 --> 00:21:14,010
hmm

501
00:21:14,010 --> 00:21:17,070
this is interesting they are Israeli Wow

502
00:21:17,070 --> 00:21:19,440
I am running low on time and there are a

503
00:21:19,440 --> 00:21:24,450
lot of slides this is kind of bad I am

504
00:21:24,450 --> 00:21:26,250
running through through this so if there

505
00:21:26,250 --> 00:21:27,840
are any questions please stop me after

506
00:21:27,840 --> 00:21:29,250
please like stop me at the hallway after

507
00:21:29,250 --> 00:21:30,809
talk and ask me more questions but I

508
00:21:30,809 --> 00:21:36,419
gotta run through now once once the the

509
00:21:36,419 --> 00:21:38,130
second payload with the launch agent was

510
00:21:38,130 --> 00:21:40,530
installed it will enumerate the list of

511
00:21:40,530 --> 00:21:42,900
running processes because the purpose of

512
00:21:42,900 --> 00:21:44,880
this ad the purpose of this malware is

513
00:21:44,880 --> 00:21:46,919
to basically show you ads and he needs

514
00:21:46,919 --> 00:21:49,169
to see which browsers you're running on

515
00:21:49,169 --> 00:21:51,179
your machine so it will list the running

516
00:21:51,179 --> 00:21:55,530
processes it will check for browsers and

517
00:21:55,530 --> 00:21:58,679
it will then know which ad package to

518
00:21:58,679 --> 00:22:00,210
download because it needs to download an

519
00:22:00,210 --> 00:22:01,650
ad package it works with your browser

520
00:22:01,650 --> 00:22:04,830
whether you're using Chrome or Firefox

521
00:22:04,830 --> 00:22:07,950
or another interesting thing that you'll

522
00:22:07,950 --> 00:22:11,370
soon see it will also create another

523
00:22:11,370 --> 00:22:12,809
launch agent and it will generate

524
00:22:12,809 --> 00:22:15,600
another another random name for it and

525
00:22:15,600 --> 00:22:17,160
the reason that they're doing it is like

526
00:22:17,160 --> 00:22:18,630
a bunch of watchdogs because if you

527
00:22:18,630 --> 00:22:20,730
remove one launch agent then then then

528
00:22:20,730 --> 00:22:22,470
they still have another launch agent

529
00:22:22,470 --> 00:22:23,730
that makes sure that things are still

530
00:22:23,730 --> 00:22:25,290
running and it will then create a new

531
00:22:25,290 --> 00:22:28,049
launch agent over and over again as you

532
00:22:28,049 --> 00:22:29,820
can see the randomly generated words are

533
00:22:29,820 --> 00:22:32,760
right here in my case it was roadless it

534
00:22:32,760 --> 00:22:34,679
basically took two words Road and less

535
00:22:34,679 --> 00:22:38,610
and mashed it together so now they we

536
00:22:38,610 --> 00:22:40,440
have more payloads because as I said

537
00:22:40,440 --> 00:22:44,520
it's like a matryoshka doll so now their

538
00:22:44,520 --> 00:22:46,650
script is downloading another payload

539
00:22:46,650 --> 00:22:49,530
this time it's a tar.gz archive and when

540
00:22:49,530 --> 00:22:51,720
it's when it's extracted we could see

541
00:22:51,720 --> 00:22:54,030
some interesting things we can see a

542
00:22:54,030 --> 00:22:56,070
file that's called browser enhancer and

543
00:22:56,070 --> 00:22:57,929
there is a file that's called updater

544
00:22:57,929 --> 00:22:59,880
and a file that's called protector now

545
00:22:59,880 --> 00:23:01,410
when I looked at protectors and what

546
00:23:01,410 --> 00:23:02,460
protector

547
00:23:02,460 --> 00:23:05,210
what are they protecting against so

548
00:23:05,210 --> 00:23:07,740
protector is actually a binary file and

549
00:23:07,740 --> 00:23:08,310
executable

550
00:23:08,310 --> 00:23:11,160
that has only one purpose and it's the

551
00:23:11,160 --> 00:23:13,230
its purpose is to check that all of the

552
00:23:13,230 --> 00:23:15,360
payloads are running and that all of the

553
00:23:15,360 --> 00:23:17,250
launch agents and launched demons are

554
00:23:17,250 --> 00:23:19,410
still there this is the watchdog I was I

555
00:23:19,410 --> 00:23:22,050
was talking about if one of those if one

556
00:23:22,050 --> 00:23:23,910
of those was removed it will be brought

557
00:23:23,910 --> 00:23:28,200
back by a protector again protector is

558
00:23:28,200 --> 00:23:30,060
setting up another launch daemon with a

559
00:23:30,060 --> 00:23:31,470
random name but this time instead of

560
00:23:31,470 --> 00:23:33,750
generating it from the dictionary file

561
00:23:33,750 --> 00:23:35,940
there is another files called names dot

562
00:23:35,940 --> 00:23:38,220
DB and it just has a bunch of strings in

563
00:23:38,220 --> 00:23:39,930
it and it just randomly picks something

564
00:23:39,930 --> 00:23:42,240
from that file and creates a launch

565
00:23:42,240 --> 00:23:47,340
agent now here's something pretty cool

566
00:23:47,340 --> 00:23:50,570
that their script that installs the

567
00:23:50,570 --> 00:23:52,890
script that installs the ad package

568
00:23:52,890 --> 00:23:55,740
removes looks for a plug-in or Safari

569
00:23:55,740 --> 00:23:57,240
plug-in that's called Omni key and

570
00:23:57,240 --> 00:24:00,090
removes it the reason that it's removing

571
00:24:00,090 --> 00:24:01,650
it is because Omni key apparently

572
00:24:01,650 --> 00:24:04,890
interferes with their malware so they

573
00:24:04,890 --> 00:24:06,270
just straight up removing it without

574
00:24:06,270 --> 00:24:08,040
asking you anything which is again

575
00:24:08,040 --> 00:24:09,540
something that they said that they that

576
00:24:09,540 --> 00:24:13,260
they're not doing now for awhile I was

577
00:24:13,260 --> 00:24:15,390
wondering okay I call it period and like

578
00:24:15,390 --> 00:24:18,270
all AV engines are now calling it period

579
00:24:18,270 --> 00:24:21,540
but what are they calling it and since

580
00:24:21,540 --> 00:24:23,420
they are like they're off SEC is awesome

581
00:24:23,420 --> 00:24:27,150
all of the code is commented and when

582
00:24:27,150 --> 00:24:28,440
the thing is starting to run it's

583
00:24:28,440 --> 00:24:30,900
actually saying installing the Vinci so

584
00:24:30,900 --> 00:24:32,580
that's why I called I called it the

585
00:24:32,580 --> 00:24:34,470
Vinci Code which is a shitty pun but I

586
00:24:34,470 --> 00:24:36,810
just had to do it now let's talk for a

587
00:24:36,810 --> 00:24:38,790
second about browser enhancer app which

588
00:24:38,790 --> 00:24:40,230
is one of the binary files that are

589
00:24:40,230 --> 00:24:42,360
being downloaded this gif is so

590
00:24:42,360 --> 00:24:43,890
awesome and you're you all of you are

591
00:24:43,890 --> 00:24:48,930
very confused right now so as I

592
00:24:48,930 --> 00:24:50,430
demonstrated in my previous talk about

593
00:24:50,430 --> 00:24:53,670
period their framework of choice is QT

594
00:24:53,670 --> 00:24:56,400
which is a cross-platform development

595
00:24:56,400 --> 00:24:59,910
framework they used it all the time and

596
00:24:59,910 --> 00:25:01,410
all of their tools and periods version

597
00:25:01,410 --> 00:25:04,050
one and this is just another indicator

598
00:25:04,050 --> 00:25:06,600
that ties it to them although again they

599
00:25:06,600 --> 00:25:07,890
say that it's not them and they have

600
00:25:07,890 --> 00:25:10,380
nothing to do with it now browser

601
00:25:10,380 --> 00:25:12,810
enhancer will look for browsers in order

602
00:25:12,810 --> 00:25:15,150
to change their settings now browser

603
00:25:15,150 --> 00:25:17,460
enhancer is looking for Firefox Safari

604
00:25:17,460 --> 00:25:21,180
Chrome or Microsoft Internet Explorer on

605
00:25:21,180 --> 00:25:22,380
a Mac

606
00:25:22,380 --> 00:25:25,799
now always open I'm giving this talk

607
00:25:25,799 --> 00:25:27,570
there's like one there's like one clever

608
00:25:27,570 --> 00:25:29,130
bastard in the audience it said well but

609
00:25:29,130 --> 00:25:31,260
there was there is a Mac a Microsoft

610
00:25:31,260 --> 00:25:33,600
Internet Explorer from Mac like yes

611
00:25:33,600 --> 00:25:36,660
there was one in version 6 we are like

612
00:25:36,660 --> 00:25:39,330
what there's no there's like Explorer

613
00:25:39,330 --> 00:25:41,190
the last version was what like 13 or 12

614
00:25:41,190 --> 00:25:42,809
or something like that doesn't happen

615
00:25:42,809 --> 00:25:44,549
anymore and then the same person says

616
00:25:44,549 --> 00:25:48,809
yeah but you can run whine so no that

617
00:25:48,809 --> 00:25:49,260
won't work

618
00:25:49,260 --> 00:25:51,539
this is like this is a straight-up

619
00:25:51,539 --> 00:25:53,370
mistake and this is really dumb because

620
00:25:53,370 --> 00:25:54,780
they ported part of their code from

621
00:25:54,780 --> 00:25:56,460
Windows

622
00:25:56,460 --> 00:25:58,830
another thing that's like really funny

623
00:25:58,830 --> 00:26:00,450
and again I found it in the old version

624
00:26:00,450 --> 00:26:04,740
are registry keys inside the binary why

625
00:26:04,740 --> 00:26:06,630
would there be a registry key inside a

626
00:26:06,630 --> 00:26:08,820
Mac binary and how the hell did it even

627
00:26:08,820 --> 00:26:11,940
compile I don't know but it's there it's

628
00:26:11,940 --> 00:26:14,370
just some more examples for for sloppy

629
00:26:14,370 --> 00:26:14,970
code

630
00:26:14,970 --> 00:26:18,030
now once browser enhancer is executed

631
00:26:18,030 --> 00:26:20,760
the browser's will restart themselves

632
00:26:20,760 --> 00:26:24,000
because they need to enable the freshly

633
00:26:24,000 --> 00:26:26,280
installed features now what are those

634
00:26:26,280 --> 00:26:29,720
features one might ask they are tracking

635
00:26:29,720 --> 00:26:32,250
every one of your cookies sometimes

636
00:26:32,250 --> 00:26:33,690
they're even sending your cookies back

637
00:26:33,690 --> 00:26:35,610
to them again it's something that

638
00:26:35,610 --> 00:26:37,110
they're saying that they're not doing

639
00:26:37,110 --> 00:26:39,990
and it's also hijacking your search page

640
00:26:39,990 --> 00:26:42,570
now if you look at what you're doing

641
00:26:42,570 --> 00:26:45,360
here they're actually using OSA Script

642
00:26:45,360 --> 00:26:47,700
which is the Apple script interpreter

643
00:26:47,700 --> 00:26:49,590
that was mentioned by both Patrick and

644
00:26:49,590 --> 00:26:52,620
Thomas if you don't know what Apple

645
00:26:52,620 --> 00:26:54,150
script is it's a very convenient

646
00:26:54,150 --> 00:26:56,130
scripting language which you can use

647
00:26:56,130 --> 00:26:58,320
English to just do things like tell

648
00:26:58,320 --> 00:27:00,840
application Firefox to launch or tell

649
00:27:00,840 --> 00:27:03,630
application Firefox to close windows now

650
00:27:03,630 --> 00:27:05,220
in the very little time that I actually

651
00:27:05,220 --> 00:27:07,770
have a minute is it ok if I steal like

652
00:27:07,770 --> 00:27:10,490
five or ten extra minutes from your time

653
00:27:10,490 --> 00:27:13,740
awesome huh this is so much I feel so

654
00:27:13,740 --> 00:27:14,429
much better now

655
00:27:14,429 --> 00:27:16,799
it's impossible to do this like to do

656
00:27:16,799 --> 00:27:19,890
this talk in like 25 minutes now Apple

657
00:27:19,890 --> 00:27:21,990
script we're gonna go right back into it

658
00:27:21,990 --> 00:27:25,260
but if we look at the at the hijack

659
00:27:25,260 --> 00:27:29,820
search page we can see this great search

660
00:27:29,820 --> 00:27:32,250
engine that we all know that's called

661
00:27:32,250 --> 00:27:34,799
tikka search and if we look at the

662
00:27:34,799 --> 00:27:35,820
bottom

663
00:27:35,820 --> 00:27:37,859
we can see the tikka search is actually

664
00:27:37,859 --> 00:27:40,950
a product of another great adware giant

665
00:27:40,950 --> 00:27:43,919
from my home country which is Babylon

666
00:27:43,919 --> 00:27:47,669
limited so again this is all fine this

667
00:27:47,669 --> 00:27:49,320
is not adware this is not malware this

668
00:27:49,320 --> 00:27:52,769
is great but there is more

669
00:27:52,769 --> 00:27:56,879
so another payload that's another

670
00:27:56,879 --> 00:28:00,509
payload that's being downloaded is

671
00:28:00,509 --> 00:28:02,519
another binary executable that's called

672
00:28:02,519 --> 00:28:05,429
Mac ver now Mac ver will be renamed to

673
00:28:05,429 --> 00:28:07,619
yet another randomly generated name by

674
00:28:07,619 --> 00:28:10,200
the same way which is just grabbing a

675
00:28:10,200 --> 00:28:12,359
random word and and and putting it in a

676
00:28:12,359 --> 00:28:16,529
variable after this word was was

677
00:28:16,529 --> 00:28:19,669
acquired was generated there will be

678
00:28:19,669 --> 00:28:22,379
there will now be a launch agent that's

679
00:28:22,379 --> 00:28:23,700
created the launch agent name will be

680
00:28:23,700 --> 00:28:27,210
will be comm dot application dot P list

681
00:28:27,210 --> 00:28:30,720
and it will be created in slash library

682
00:28:30,720 --> 00:28:34,349
slash preferences and if we look at the

683
00:28:34,349 --> 00:28:36,479
the content of it we can see the

684
00:28:36,479 --> 00:28:38,009
randomly generated name right here

685
00:28:38,009 --> 00:28:44,970
sailcloth okay and this is this is not

686
00:28:44,970 --> 00:28:47,190
important we don't have time now we need

687
00:28:47,190 --> 00:28:49,619
to look at Mac ver because this is a

688
00:28:49,619 --> 00:28:51,679
crucial part of understanding of

689
00:28:51,679 --> 00:28:53,399
understanding that thing and how it

690
00:28:53,399 --> 00:28:57,179
works now Mac ver is a 64 bit Mach Oh

691
00:28:57,179 --> 00:28:59,129
executable Mach o is the executable

692
00:28:59,129 --> 00:29:01,649
format that runs on Macs just like

693
00:29:01,649 --> 00:29:04,849
Windows has Pease Linux has elfs and

694
00:29:04,849 --> 00:29:09,059
Macs have mako's now unlike all of the

695
00:29:09,059 --> 00:29:11,429
other executables that are dropped by

696
00:29:11,429 --> 00:29:15,090
targeting edge on your on your machines

697
00:29:15,090 --> 00:29:18,869
Mac red does not import any QT resources

698
00:29:18,869 --> 00:29:21,989
which is kind of weird but because they

699
00:29:21,989 --> 00:29:24,389
use QT for everything but they have but

700
00:29:24,389 --> 00:29:25,979
actually Mac word is doing a lot of

701
00:29:25,979 --> 00:29:28,379
other interesting things so I'm gonna

702
00:29:28,379 --> 00:29:30,720
give you a pro tip right now so this is

703
00:29:30,720 --> 00:29:32,639
a screenshot of the strengths section

704
00:29:32,639 --> 00:29:35,519
through Ida Pro and you can see a lot of

705
00:29:35,519 --> 00:29:38,729
base 64 code now when you want to

706
00:29:38,729 --> 00:29:41,820
encrypt something and make it encrypted

707
00:29:41,820 --> 00:29:45,779
and secure and impossible to make sense

708
00:29:45,779 --> 00:29:48,809
of you encrypt something with base 64

709
00:29:48,809 --> 00:29:49,560
because

710
00:29:49,560 --> 00:29:51,540
know that base64 is the most secured

711
00:29:51,540 --> 00:30:00,260
form of encryption out there now once I

712
00:30:00,260 --> 00:30:03,090
decrypted and it was very very very hard

713
00:30:03,090 --> 00:30:05,280
and it took you know days of advanced

714
00:30:05,280 --> 00:30:07,680
research to decrypt all of those base64

715
00:30:07,680 --> 00:30:10,410
strings it revealed a lot of Apple

716
00:30:10,410 --> 00:30:14,010
script code now I already mentioned what

717
00:30:14,010 --> 00:30:17,100
Apple script is now the way that Apple

718
00:30:17,100 --> 00:30:18,810
Strip works is that if you want to

719
00:30:18,810 --> 00:30:21,980
conform with Apple's development

720
00:30:21,980 --> 00:30:25,710
methodologies your app supposed to have

721
00:30:25,710 --> 00:30:29,040
supposed to have an apple script API for

722
00:30:29,040 --> 00:30:31,440
example Photoshop has up an apple script

723
00:30:31,440 --> 00:30:33,570
API you can tell Photoshop to do stuff

724
00:30:33,570 --> 00:30:35,370
so a lot of people are using Apple

725
00:30:35,370 --> 00:30:37,020
stripped to automate a lot of mundane

726
00:30:37,020 --> 00:30:39,540
tasks for example I used to have a strip

727
00:30:39,540 --> 00:30:43,290
a photo shabal strip that apply the

728
00:30:43,290 --> 00:30:46,200
frame to like a bunch of photos that

729
00:30:46,200 --> 00:30:47,940
used to take with my camera so instead

730
00:30:47,940 --> 00:30:49,650
of like going to each photo when

731
00:30:49,650 --> 00:30:52,110
applying that frame I would just have an

732
00:30:52,110 --> 00:30:53,970
Apple script that will tell Photoshop to

733
00:30:53,970 --> 00:30:56,610
take a bunch a whole bunch of photos and

734
00:30:56,610 --> 00:30:59,070
put a frame to them because Apple script

735
00:30:59,070 --> 00:31:01,950
is very convenient to automate tasks in

736
00:31:01,950 --> 00:31:05,370
other and other applications this is

737
00:31:05,370 --> 00:31:08,550
basically code injection so yo dawg i

738
00:31:08,550 --> 00:31:10,320
heard you like code injections so we

739
00:31:10,320 --> 00:31:12,030
used apple strip to inject code that

740
00:31:12,030 --> 00:31:14,880
injects javascript to your browser so

741
00:31:14,880 --> 00:31:16,350
this is basically what they're doing

742
00:31:16,350 --> 00:31:19,860
with spirit now when decrypting dose

743
00:31:19,860 --> 00:31:23,630
base64 strings what we actually get is a

744
00:31:23,630 --> 00:31:26,610
lot of Apple script code now if we look

745
00:31:26,610 --> 00:31:30,390
at that code we can see if Safari is

746
00:31:30,390 --> 00:31:32,970
running then tell applications Safari to

747
00:31:32,970 --> 00:31:34,680
set page source to do JavaScript

748
00:31:34,680 --> 00:31:36,690
document body blah blah blah and then it

749
00:31:36,690 --> 00:31:38,340
just injects a bunch of JavaScript code

750
00:31:38,340 --> 00:31:41,370
to your browser again this is a feature

751
00:31:41,370 --> 00:31:43,500
of your operating system they're not

752
00:31:43,500 --> 00:31:45,060
hacking anything they're not exploiting

753
00:31:45,060 --> 00:31:47,280
anything Apple script is a feature of

754
00:31:47,280 --> 00:31:50,070
Mac OS and they're just using that

755
00:31:50,070 --> 00:31:51,570
feature which is something that they

756
00:31:51,570 --> 00:31:52,740
actually said that they're doing they

757
00:31:52,740 --> 00:31:54,030
said we're not exploiting we're just

758
00:31:54,030 --> 00:31:55,950
using features so they got that one

759
00:31:55,950 --> 00:31:58,500
right and they're actually using that

760
00:31:58,500 --> 00:32:00,540
feature to inject JavaScript to your

761
00:32:00,540 --> 00:32:02,430
browser and that javascript actually

762
00:32:02,430 --> 00:32:03,360
plans all

763
00:32:03,360 --> 00:32:06,900
that crap in your browser here is the

764
00:32:06,900 --> 00:32:09,030
same thing but for Chrome this time so

765
00:32:09,030 --> 00:32:11,160
again if Chrome is running then inject a

766
00:32:11,160 --> 00:32:14,400
whole bunch of crap into it so just to

767
00:32:14,400 --> 00:32:15,540
get things straight because I'm like

768
00:32:15,540 --> 00:32:18,390
running here we have the binary that's

769
00:32:18,390 --> 00:32:20,670
called Mac ver Mac ver launches OC

770
00:32:20,670 --> 00:32:22,080
script which is the Apple script

771
00:32:22,080 --> 00:32:25,260
interpreter and it then gets the URL

772
00:32:25,260 --> 00:32:28,980
that runs on Chrome again just by using

773
00:32:28,980 --> 00:32:31,590
AppleScript and if the URL matches a

774
00:32:31,590 --> 00:32:36,179
certain a certain rule set if you will

775
00:32:36,179 --> 00:32:38,820
it will then inject JavaScript that will

776
00:32:38,820 --> 00:32:41,010
display ads in your browser so if you

777
00:32:41,010 --> 00:32:43,799
are in Amazon and you are looking for

778
00:32:43,799 --> 00:32:47,250
shoes Oh Matt fur will know that and

779
00:32:47,250 --> 00:32:49,230
they will take all of that information

780
00:32:49,230 --> 00:32:51,900
from your browser they will send it back

781
00:32:51,900 --> 00:32:53,490
to targeting edges server then there

782
00:32:53,490 --> 00:32:56,580
will be a bidding war for ads and then

783
00:32:56,580 --> 00:32:58,590
Mackler will inject to your browser

784
00:32:58,590 --> 00:33:01,230
using oh so script using javascript it

785
00:33:01,230 --> 00:33:03,299
will inject ads that are relevant to you

786
00:33:03,299 --> 00:33:04,980
because you're looking to buy shoes and

787
00:33:04,980 --> 00:33:06,960
you are on Amazon that whole thing

788
00:33:06,960 --> 00:33:11,070
happens every second so that thing makes

789
00:33:11,070 --> 00:33:13,740
your computer really really slow now in

790
00:33:13,740 --> 00:33:15,660
older versions of period and periods v1

791
00:33:15,660 --> 00:33:17,580
targeting edge actually installed a

792
00:33:17,580 --> 00:33:20,940
proxy server in your machine my my talk

793
00:33:20,940 --> 00:33:23,130
is a new tube just look for my name type

794
00:33:23,130 --> 00:33:24,330
parrot and you'll find it

795
00:33:24,330 --> 00:33:26,910
I'm going in to great lengths of detail

796
00:33:26,910 --> 00:33:29,940
in in that talk now the nice thing about

797
00:33:29,940 --> 00:33:32,220
writing articles about targeting edge is

798
00:33:32,220 --> 00:33:34,500
that they are reading my articles so

799
00:33:34,500 --> 00:33:38,450
they are implementing my advice so I

800
00:33:38,450 --> 00:33:40,799
said in like my first talk I said wow

801
00:33:40,799 --> 00:33:42,660
why are they doing all of this dumb

802
00:33:42,660 --> 00:33:44,580
stuff we're like downloading a proxy

803
00:33:44,580 --> 00:33:46,290
server and rerouting your traffic and

804
00:33:46,290 --> 00:33:47,910
messing with your firewall they could

805
00:33:47,910 --> 00:33:49,950
just use Apple script and then they just

806
00:33:49,950 --> 00:33:52,530
did it and after my previous talk when I

807
00:33:52,530 --> 00:33:54,660
talked about the base64 stuff they

808
00:33:54,660 --> 00:33:56,309
released a new variant and they actually

809
00:33:56,309 --> 00:34:00,120
used encryption so like it's so cool to

810
00:34:00,120 --> 00:34:03,949
have this relationship with them so

811
00:34:04,220 --> 00:34:06,929
another cool thing is that if we're

812
00:34:06,929 --> 00:34:09,149
running Mac were in a terminal because

813
00:34:09,149 --> 00:34:11,070
originally they did not think that

814
00:34:11,070 --> 00:34:13,290
anyone will run their app in a terminal

815
00:34:13,290 --> 00:34:16,449
because they're so hackery and you

816
00:34:16,449 --> 00:34:18,879
like that but if you run it in a

817
00:34:18,879 --> 00:34:20,800
terminal it actually has a really really

818
00:34:20,800 --> 00:34:25,270
useful debug output so here is me

819
00:34:25,270 --> 00:34:27,429
running that and going to Google and I

820
00:34:27,429 --> 00:34:29,530
just typed error and you can see the

821
00:34:29,530 --> 00:34:32,379
whole URL here google.com slash search

822
00:34:32,379 --> 00:34:34,359
blah blah blah blah blah and this is the

823
00:34:34,359 --> 00:34:36,520
query error right here and then it sends

824
00:34:36,520 --> 00:34:39,690
it back to them and then the server

825
00:34:39,690 --> 00:34:43,510
sends them a URL loading pages dot info

826
00:34:43,510 --> 00:34:45,099
and then there's a long gooood blah blah

827
00:34:45,099 --> 00:34:47,500
blah and then you can see that the URL

828
00:34:47,500 --> 00:34:49,810
that's being sent back from their server

829
00:34:49,810 --> 00:34:52,540
is then being sent to the server via all

830
00:34:52,540 --> 00:34:54,399
of that crap I showed you just two

831
00:34:54,399 --> 00:34:57,820
slides ago and then it gives me a fake a

832
00:34:57,820 --> 00:35:03,760
fake AV add for for mackeeper

833
00:35:03,760 --> 00:35:07,260
which is like the really the garbage of

834
00:35:07,260 --> 00:35:11,200
OS X and if you ever thinking if you're

835
00:35:11,200 --> 00:35:12,460
ever thinking about installing mackeeper

836
00:35:12,460 --> 00:35:15,280
just don't run away leave your computer

837
00:35:15,280 --> 00:35:16,869
just run outside don't ever do that

838
00:35:16,869 --> 00:35:19,140
because this will install more crap I

839
00:35:19,140 --> 00:35:24,450
wonder if you're gonna sue me also now

840
00:35:24,450 --> 00:35:27,339
in the previous episodes of targeting

841
00:35:27,339 --> 00:35:29,560
edge though of my experience with

842
00:35:29,560 --> 00:35:31,300
targeting edge the way that I found them

843
00:35:31,300 --> 00:35:35,050
was I was actually being lazy and I was

844
00:35:35,050 --> 00:35:37,000
still I was running their malware and

845
00:35:37,000 --> 00:35:38,589
they started to run to download all of

846
00:35:38,589 --> 00:35:41,020
those tar.gz archives on my machine and

847
00:35:41,020 --> 00:35:42,970
I was too lazy to fire up another test

848
00:35:42,970 --> 00:35:45,400
VM and wait for the thing to boot and

849
00:35:45,400 --> 00:35:47,200
put the thing inside so it's just ok

850
00:35:47,200 --> 00:35:49,000
instead of extracting the file on my

851
00:35:49,000 --> 00:35:51,490
machine I'll just list the files that

852
00:35:51,490 --> 00:35:54,040
are inside the tar.gz archive now the

853
00:35:54,040 --> 00:35:55,960
cool thing about the tar.gz archive is

854
00:35:55,960 --> 00:35:58,540
that it's a POSIX format and because

855
00:35:58,540 --> 00:36:00,849
it's a POSIX format it saves the

856
00:36:00,849 --> 00:36:03,069
original permissions as they were

857
00:36:03,069 --> 00:36:05,650
created on the original machine inside

858
00:36:05,650 --> 00:36:07,810
the archive so if you're listing the

859
00:36:07,810 --> 00:36:09,640
archive you can see the original user

860
00:36:09,640 --> 00:36:12,400
name and the group that created the

861
00:36:12,400 --> 00:36:14,650
archive on the original machine now two

862
00:36:14,650 --> 00:36:16,510
years ago and that's how I found them

863
00:36:16,510 --> 00:36:18,970
the username was their first and last

864
00:36:18,970 --> 00:36:21,579
name and that's how I found them and

865
00:36:21,579 --> 00:36:23,349
like that quick LinkedIn search and I

866
00:36:23,349 --> 00:36:25,329
found targeting engine was super easy to

867
00:36:25,329 --> 00:36:27,160
spot them and because they're listening

868
00:36:27,160 --> 00:36:28,970
to my talks and maybe even a 10

869
00:36:28,970 --> 00:36:30,650
some of them because I gave it in Israel

870
00:36:30,650 --> 00:36:35,680
ones now all of the usernames are Batman

871
00:36:35,680 --> 00:36:40,099
but it's fine don't worry about it so if

872
00:36:40,099 --> 00:36:43,070
we're talking about attribution I mean I

873
00:36:43,070 --> 00:36:44,720
have all of the proof from two years ago

874
00:36:44,720 --> 00:36:46,490
that it's them but yet they're still

875
00:36:46,490 --> 00:36:48,470
saying we have nothing to do with this

876
00:36:48,470 --> 00:36:51,950
and and we have no relation to os

877
00:36:51,950 --> 00:36:54,140
experience whatsoever and like this is

878
00:36:54,140 --> 00:36:56,180
where I'm bringing this puppy home and

879
00:36:56,180 --> 00:37:01,010
letting you all go so now I have I have

880
00:37:01,010 --> 00:37:02,390
pretty good knowledge of how they work

881
00:37:02,390 --> 00:37:03,859
and I already done it before and I

882
00:37:03,859 --> 00:37:05,510
already know like what kind of

883
00:37:05,510 --> 00:37:07,280
techniques they're using and what kind

884
00:37:07,280 --> 00:37:08,359
of stupid mistakes that they're using

885
00:37:08,359 --> 00:37:09,950
and obviously when I'm writing a big

886
00:37:09,950 --> 00:37:11,480
report and sharing everything I'm not

887
00:37:11,480 --> 00:37:13,820
really sharing everything keeping some

888
00:37:13,820 --> 00:37:15,470
some information to myself because I

889
00:37:15,470 --> 00:37:18,230
want to find them again so let's see

890
00:37:18,230 --> 00:37:19,910
what we have so far right so we have

891
00:37:19,910 --> 00:37:22,250
code that looks almost identical to the

892
00:37:22,250 --> 00:37:23,900
code from two years ago and because I

893
00:37:23,900 --> 00:37:25,490
was going through it really really fast

894
00:37:25,490 --> 00:37:27,560
go to go go to YouTube check out my

895
00:37:27,560 --> 00:37:29,300
previous talk from two years ago and

896
00:37:29,300 --> 00:37:30,920
you'll get it like this will all make

897
00:37:30,920 --> 00:37:33,589
sense their methods which is their

898
00:37:33,589 --> 00:37:35,270
scripts and their payloads and the way

899
00:37:35,270 --> 00:37:36,950
that they're generating random strings

900
00:37:36,950 --> 00:37:38,330
and random names and everything like

901
00:37:38,330 --> 00:37:40,220
we've seen the exact same code two years

902
00:37:40,220 --> 00:37:42,859
ago and there's also frantic letters

903
00:37:42,859 --> 00:37:44,359
from their attorneys telling us this is

904
00:37:44,359 --> 00:37:46,869
not us although it is clearly them and

905
00:37:46,869 --> 00:37:49,220
obviously if it's not if it's not them

906
00:37:49,220 --> 00:37:51,440
why are they so protective of their

907
00:37:51,440 --> 00:37:55,820
intellectual property who knows but the

908
00:37:55,820 --> 00:37:58,160
thing is that all of all of this is just

909
00:37:58,160 --> 00:38:01,310
my opinion it's not really proof right

910
00:38:01,310 --> 00:38:05,510
so what is proof so when we're looking

911
00:38:05,510 --> 00:38:08,089
at their domains we can see that all of

912
00:38:08,089 --> 00:38:09,980
their domains and they have a ton of

913
00:38:09,980 --> 00:38:12,260
them all of their domains are registered

914
00:38:12,260 --> 00:38:16,280
with the privacy the privacy thing where

915
00:38:16,280 --> 00:38:17,869
you do a who is on the domain and you

916
00:38:17,869 --> 00:38:19,550
get like domains by proxy and you can't

917
00:38:19,550 --> 00:38:22,220
see who registered that domain now what

918
00:38:22,220 --> 00:38:23,869
I noticed is that all of their domains

919
00:38:23,869 --> 00:38:25,910
are registered in batches usually of ten

920
00:38:25,910 --> 00:38:28,040
or twelve domains at a time

921
00:38:28,040 --> 00:38:30,710
but there was one batch where they

922
00:38:30,710 --> 00:38:33,080
someone just up and forgot to

923
00:38:33,080 --> 00:38:35,210
check the privacy box and pay the extra

924
00:38:35,210 --> 00:38:38,119
ten bucks for the privacy so they had a

925
00:38:38,119 --> 00:38:41,089
bunch of domains that share an IP

926
00:38:41,089 --> 00:38:42,930
address with a bunch of their other

927
00:38:42,930 --> 00:38:46,559
and if you look at the and that was the

928
00:38:46,559 --> 00:38:49,440
domain here and if you look at the email

929
00:38:49,440 --> 00:38:52,500
that registered them it's their email of

930
00:38:52,500 --> 00:38:58,170
their CEO which is right here but again

931
00:38:58,170 --> 00:39:02,579
what is proof right and here is in who

932
00:39:02,579 --> 00:39:04,829
is on that domain and this is the name

933
00:39:04,829 --> 00:39:07,289
of their CEO and this is targeting edge

934
00:39:07,289 --> 00:39:09,660
and this is their address which is

935
00:39:09,660 --> 00:39:11,970
literally three streets away from our

936
00:39:11,970 --> 00:39:14,910
offices in Tel Aviv which is kind of

937
00:39:14,910 --> 00:39:19,819
fine it's kind of fun but there's also a

938
00:39:19,819 --> 00:39:23,490
resume that was sent to us by one of the

939
00:39:23,490 --> 00:39:25,020
people that wrote Pierre at one of the

940
00:39:25,020 --> 00:39:27,420
names and it was sent to us after I

941
00:39:27,420 --> 00:39:29,849
published my two articles two years ago

942
00:39:29,849 --> 00:39:32,700
so that was sent to me last January by

943
00:39:32,700 --> 00:39:35,220
our recruiter asking me if I know this

944
00:39:35,220 --> 00:39:38,670
guy because in his resume that he sent

945
00:39:38,670 --> 00:39:40,140
us because he wanted to work for cyber

946
00:39:40,140 --> 00:39:48,809
reason he wrote this let's process that

947
00:39:48,809 --> 00:39:52,890
for me because I say I was an

948
00:39:52,890 --> 00:39:54,779
and I saved this for last so like when

949
00:39:54,779 --> 00:39:56,130
they're lawyers kept threatening us

950
00:39:56,130 --> 00:39:56,849
every day

951
00:39:56,849 --> 00:39:58,770
so our attorney was like listen you got

952
00:39:58,770 --> 00:40:00,390
to send them their resume and I had like

953
00:40:00,390 --> 00:40:02,240
I fought with our attorney I'm like no

954
00:40:02,240 --> 00:40:05,700
no let's save it and feel like

955
00:40:05,700 --> 00:40:07,109
really goes bad and then like when they

956
00:40:07,109 --> 00:40:08,430
start sending us like three letters a

957
00:40:08,430 --> 00:40:09,750
day I was like ah this

958
00:40:09,750 --> 00:40:12,900
okay just say oh yeah who's this guy so

959
00:40:12,900 --> 00:40:14,640
that was super funny and that the point

960
00:40:14,640 --> 00:40:15,900
that was the point where they just gave

961
00:40:15,900 --> 00:40:20,069
up and remember and again I I went

962
00:40:20,069 --> 00:40:21,660
through it really really quickly but in

963
00:40:21,660 --> 00:40:23,039
their letters in their frantic letters

964
00:40:23,039 --> 00:40:24,420
they said we don't we didn't use any

965
00:40:24,420 --> 00:40:25,890
exploits we're not doing anything

966
00:40:25,890 --> 00:40:28,109
illegal blah blah blah but this dude in

967
00:40:28,109 --> 00:40:29,819
his resume says my work appeared in the

968
00:40:29,819 --> 00:40:31,260
cyber Reason lab report which is my

969
00:40:31,260 --> 00:40:34,559
report an IT neucom article when you go

970
00:40:34,559 --> 00:40:37,170
to that article you can see Mac OSX root

971
00:40:37,170 --> 00:40:39,539
privileges zero day under active exploit

972
00:40:39,539 --> 00:40:44,309
by adware so this guy basically admitted

973
00:40:44,309 --> 00:40:47,460
all of that crap in a resume that he

974
00:40:47,460 --> 00:40:50,150
sent to us

975
00:40:53,030 --> 00:40:59,070
what do you think III invited his resume

976
00:40:59,070 --> 00:41:04,950
to my junk folder no I don't know no I

977
00:41:04,950 --> 00:41:06,900
was also in Boston by that time so like

978
00:41:06,900 --> 00:41:12,270
no but but the answer is no so before I

979
00:41:12,270 --> 00:41:14,730
let you all go if there's one message I

980
00:41:14,730 --> 00:41:18,960
want to send after this talk is I went

981
00:41:18,960 --> 00:41:20,310
for all of this really really quickly

982
00:41:20,310 --> 00:41:21,930
and I showed you how an adware can

983
00:41:21,930 --> 00:41:23,880
completely on your machine and like use

984
00:41:23,880 --> 00:41:27,150
operating system features and not

985
00:41:27,150 --> 00:41:29,070
exploit anything and basically I showed

986
00:41:29,070 --> 00:41:32,790
you how crappy OS X is but that's not

987
00:41:32,790 --> 00:41:34,050
the takeaway to don't want to give you

988
00:41:34,050 --> 00:41:35,790
because if you ever spend some time

989
00:41:35,790 --> 00:41:37,620
doing some research work on OS X you

990
00:41:37,620 --> 00:41:40,110
already know that what I do want to tell

991
00:41:40,110 --> 00:41:43,680
you is if you're a malware researcher if

992
00:41:43,680 --> 00:41:45,300
you're doing security research and you

993
00:41:45,300 --> 00:41:47,910
stand you're starting to get threat

994
00:41:47,910 --> 00:41:49,950
letters from attorney it means that

995
00:41:49,950 --> 00:41:51,990
you're that you're doing your job the

996
00:41:51,990 --> 00:41:56,610
right way so try to work with your

997
00:41:56,610 --> 00:41:58,440
employer try to work with your legal

998
00:41:58,440 --> 00:42:01,170
department try to make them understand

999
00:42:01,170 --> 00:42:02,430
that this is actually important because

1000
00:42:02,430 --> 00:42:04,980
I can tell you something about something

1001
00:42:04,980 --> 00:42:08,160
that happened when I was doing this work

1002
00:42:08,160 --> 00:42:12,600
a large publication that one of their

1003
00:42:12,600 --> 00:42:14,430
journalists might be in this room

1004
00:42:14,430 --> 00:42:17,340
earlier is he here I don't see him it's

1005
00:42:17,340 --> 00:42:20,430
a very large publication their name is

1006
00:42:20,430 --> 00:42:23,280
like it's a very very important part of

1007
00:42:23,280 --> 00:42:27,920
your computer like a physical part and

1008
00:42:27,920 --> 00:42:31,350
they got an exclusive story like an

1009
00:42:31,350 --> 00:42:33,630
exclusive to write an exclusive story

1010
00:42:33,630 --> 00:42:35,520
about that whole thing and I worked with

1011
00:42:35,520 --> 00:42:37,920
that journalist which I love and I

1012
00:42:37,920 --> 00:42:40,110
respect him a lot I have nothing against

1013
00:42:40,110 --> 00:42:42,570
him don't get me wrong but their legal

1014
00:42:42,570 --> 00:42:46,290
department got a bunch of threat letters

1015
00:42:46,290 --> 00:42:47,700
from targeting edge as well

1016
00:42:47,700 --> 00:42:50,550
now this media company that this

1017
00:42:50,550 --> 00:42:54,600
journalist is working for sent people to

1018
00:42:54,600 --> 00:42:58,380
interview Isis operatives in Iraq and

1019
00:42:58,380 --> 00:43:00,420
Syria in Syria these are like these are

1020
00:43:00,420 --> 00:43:02,580
people that like you know Isis don't

1021
00:43:02,580 --> 00:43:05,980
 around and those that

1022
00:43:05,980 --> 00:43:08,140
company doesn't around as well and

1023
00:43:08,140 --> 00:43:10,720
yet they got scared of some like Mickey

1024
00:43:10,720 --> 00:43:14,530
Mouse threat letters so if someone is

1025
00:43:14,530 --> 00:43:16,450
threatening you and if someone is

1026
00:43:16,450 --> 00:43:18,369
keeping you from doing your job and

1027
00:43:18,369 --> 00:43:20,650
trying to threat you from threat trying

1028
00:43:20,650 --> 00:43:22,540
to threaten you and scare you from doing

1029
00:43:22,540 --> 00:43:24,010
your job it means that you're doing it

1030
00:43:24,010 --> 00:43:26,140
right so insist on it with your employer

1031
00:43:26,140 --> 00:43:28,030
and insist on it with your legal

1032
00:43:28,030 --> 00:43:29,800
department and make sure that if you did

1033
00:43:29,800 --> 00:43:31,450
something and you expose something and

1034
00:43:31,450 --> 00:43:33,430
you believe that it's malicious make

1035
00:43:33,430 --> 00:43:34,660
sure that it goes out there and don't

1036
00:43:34,660 --> 00:43:37,060
let other people scare you if you have

1037
00:43:37,060 --> 00:43:38,830
any more questions because I'm Way over

1038
00:43:38,830 --> 00:43:41,230
time I'll be outside and all of this

1039
00:43:41,230 --> 00:43:43,420
stuff is on YouTube and on the cyber

1040
00:43:43,420 --> 00:43:45,550
easin blog and just heckle me on twitter

1041
00:43:45,550 --> 00:43:47,109
if you have any more questions thank you

1042
00:43:47,109 --> 00:43:48,430
very much for your attention it's an

1043
00:43:48,430 --> 00:43:49,590
honor to be here thank you

1044
00:43:49,590 --> 00:43:51,849
[Applause]

