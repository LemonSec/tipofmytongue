1
00:00:01,599 --> 00:00:03,360
okay let's continue with the second

2
00:00:03,360 --> 00:00:04,480
presentation

3
00:00:04,480 --> 00:00:07,839
uh about a middle east apt group uh

4
00:00:07,839 --> 00:00:09,920
it's presented by asio ko from

5
00:00:09,920 --> 00:00:11,360
checkpoint and it's called the big bang

6
00:00:11,360 --> 00:00:14,480
theory by aptc

7
00:00:14,920 --> 00:00:16,079
23.

8
00:00:16,079 --> 00:00:19,119
that's the second

9
00:00:20,880 --> 00:00:23,680
great hello everyone my name is seal and

10
00:00:23,680 --> 00:00:25,199
today i want to present to you the big

11
00:00:25,199 --> 00:00:26,720
bang theory by aptc

12
00:00:26,720 --> 00:00:30,320
23. uh to introduce myself i'm a malware

13
00:00:30,320 --> 00:00:32,159
analyst from checkpoint i've been in the

14
00:00:32,159 --> 00:00:33,120
infosec field

15
00:00:33,120 --> 00:00:35,840
for two years uh my mother tongue is

16
00:00:35,840 --> 00:00:37,920
arabic so if you're doing any research

17
00:00:37,920 --> 00:00:39,680
that has to do with the middle east come

18
00:00:39,680 --> 00:00:41,120
talk to me after this i'm very

19
00:00:41,120 --> 00:00:42,160
interested

20
00:00:42,160 --> 00:00:43,680
um and i'm also on twitter and on

21
00:00:43,680 --> 00:00:45,600
linkedin so feel free to follow connect

22
00:00:45,600 --> 00:00:46,879
or whatever

23
00:00:46,879 --> 00:00:48,879
and just before we start i'd like to

24
00:00:48,879 --> 00:00:52,079
give a brief introduction of the aptc 23

25
00:00:52,079 --> 00:00:53,920
which is the name given to a threat

26
00:00:53,920 --> 00:00:57,039
group by kehu 360 when they first

27
00:00:57,039 --> 00:00:58,079
discovered

28
00:00:58,079 --> 00:01:00,399
the first campaign of this threat group

29
00:01:00,399 --> 00:01:02,960
in early 2017

30
00:01:02,960 --> 00:01:05,280
and this threat group uses both mobile

31
00:01:05,280 --> 00:01:07,439
and desktop attack vectors to target

32
00:01:07,439 --> 00:01:08,400
victims in the

33
00:01:08,400 --> 00:01:10,159
middle east but more specifically

34
00:01:10,159 --> 00:01:12,080
palestinian victims

35
00:01:12,080 --> 00:01:14,080
and they tailor the content of their

36
00:01:14,080 --> 00:01:16,560
applications to such an audience

37
00:01:16,560 --> 00:01:18,159
and the different tools that were used

38
00:01:18,159 --> 00:01:20,000
by this uh threat group were given

39
00:01:20,000 --> 00:01:22,320
different names such as micropsia casper

40
00:01:22,320 --> 00:01:23,439
agent

41
00:01:23,439 --> 00:01:25,040
and the different campaigns were also

42
00:01:25,040 --> 00:01:27,360
called frozen cell or even in some cases

43
00:01:27,360 --> 00:01:28,799
arid viper

44
00:01:28,799 --> 00:01:32,000
and my investigation of aptc 23 started

45
00:01:32,000 --> 00:01:33,119
when i came across

46
00:01:33,119 --> 00:01:35,280
this file called the monthly press

47
00:01:35,280 --> 00:01:37,600
report or translated into the monthly

48
00:01:37,600 --> 00:01:38,640
press report

49
00:01:38,640 --> 00:01:41,119
and when it is double clicked it opens

50
00:01:41,119 --> 00:01:42,720
up this document

51
00:01:42,720 --> 00:01:44,960
and this document looks very legitimate

52
00:01:44,960 --> 00:01:46,640
for many reasons uh

53
00:01:46,640 --> 00:01:48,799
first off it uses the logo of the

54
00:01:48,799 --> 00:01:50,399
political and national guidance

55
00:01:50,399 --> 00:01:51,360
committee

56
00:01:51,360 --> 00:01:53,040
but also the logo of the state of

57
00:01:53,040 --> 00:01:54,479
palestine

58
00:01:54,479 --> 00:01:57,600
the original title of the document is uh

59
00:01:57,600 --> 00:02:00,079
his supremacy colonel sama barakal which

60
00:02:00,079 --> 00:02:02,079
is actually the head of this committee

61
00:02:02,079 --> 00:02:03,439
and we see him in this picture right

62
00:02:03,439 --> 00:02:05,360
here hello

63
00:02:05,360 --> 00:02:07,360
and the news headlines in the press

64
00:02:07,360 --> 00:02:09,119
report are copied uh

65
00:02:09,119 --> 00:02:11,680
word by word from legitimate palestinian

66
00:02:11,680 --> 00:02:13,200
websites

67
00:02:13,200 --> 00:02:15,120
and those headlines or those reports

68
00:02:15,120 --> 00:02:17,280
were published on the 28th of march

69
00:02:17,280 --> 00:02:19,200
which is actually a day before

70
00:02:19,200 --> 00:02:21,520
the timestamp in the document the 29th

71
00:02:21,520 --> 00:02:22,879
of march

72
00:02:22,879 --> 00:02:24,640
but despite all of this there may be

73
00:02:24,640 --> 00:02:26,319
some warning signs for someone who has

74
00:02:26,319 --> 00:02:28,560
double-clicked the document because

75
00:02:28,560 --> 00:02:30,319
even though its original name was the

76
00:02:30,319 --> 00:02:31,680
monthly press report

77
00:02:31,680 --> 00:02:34,879
the title says the daily press report

78
00:02:34,879 --> 00:02:36,959
and microsoft word shows us that the

79
00:02:36,959 --> 00:02:38,160
opened file is

80
00:02:38,160 --> 00:02:41,040
uh called uh 29th of march.doc and not

81
00:02:41,040 --> 00:02:43,200
the original file name we have seen

82
00:02:43,200 --> 00:02:45,599
so let's go back to where it all began

83
00:02:45,599 --> 00:02:46,319
the

84
00:02:46,319 --> 00:02:48,319
monthly press report is as a matter of

85
00:02:48,319 --> 00:02:50,800
fact a self-extracting archive

86
00:02:50,800 --> 00:02:52,800
and that means that when it is double

87
00:02:52,800 --> 00:02:55,360
clicked uh it extracts its contents and

88
00:02:55,360 --> 00:02:57,040
runs them so we get

89
00:02:57,040 --> 00:02:59,440
the uh 29th of march dock which we have

90
00:02:59,440 --> 00:03:00,080
just seen

91
00:03:00,080 --> 00:03:01,840
and this is used as a decoy for the

92
00:03:01,840 --> 00:03:03,599
victim you know to tell them all is good

93
00:03:03,599 --> 00:03:05,200
you clicked a word document

94
00:03:05,200 --> 00:03:08,000
it's okay but we also have a lovely

95
00:03:08,000 --> 00:03:09,680
executable running in the background

96
00:03:09,680 --> 00:03:11,519
called driver installer you

97
00:03:11,519 --> 00:03:13,040
and this is what we want to look into

98
00:03:13,040 --> 00:03:14,879
next this is where the juicy stuff

99
00:03:14,879 --> 00:03:15,680
happens

100
00:03:15,680 --> 00:03:17,599
because this is actually a malware

101
00:03:17,599 --> 00:03:19,599
written in c plus

102
00:03:19,599 --> 00:03:21,760
um and to take a deeper dive into the

103
00:03:21,760 --> 00:03:24,159
code uh the driver installer u starts

104
00:03:24,159 --> 00:03:26,159
with some persistence attempts uh it

105
00:03:26,159 --> 00:03:26,959
looks for

106
00:03:26,959 --> 00:03:29,840
the program data directory by using the

107
00:03:29,840 --> 00:03:32,080
get special folder path function

108
00:03:32,080 --> 00:03:33,920
if it gets an error by calling this

109
00:03:33,920 --> 00:03:35,840
function it displays the message

110
00:03:35,840 --> 00:03:38,799
you'll need error handling here and a

111
00:03:38,799 --> 00:03:39,360
simple

112
00:03:39,360 --> 00:03:41,440
google search of this string shows us

113
00:03:41,440 --> 00:03:43,760
that this chunk of code was copied as

114
00:03:43,760 --> 00:03:46,239
is from stack overflow the threat actor

115
00:03:46,239 --> 00:03:47,840
didn't even bother changing their

116
00:03:47,840 --> 00:03:48,720
handling message

117
00:03:48,720 --> 00:03:51,360
you know why should they um and once

118
00:03:51,360 --> 00:03:53,840
that program data directory is found a

119
00:03:53,840 --> 00:03:55,680
subdirectory is created by the name

120
00:03:55,680 --> 00:03:56,959
internet assistant

121
00:03:56,959 --> 00:03:58,879
and mind the typo in the word internet

122
00:03:58,879 --> 00:04:01,280
there is an additional e there

123
00:04:01,280 --> 00:04:04,319
and this is important for later on and

124
00:04:04,319 --> 00:04:06,239
the executable of course is copied into

125
00:04:06,239 --> 00:04:08,319
that directory and a scheduled task is

126
00:04:08,319 --> 00:04:11,280
set to run this executable

127
00:04:11,280 --> 00:04:13,439
mutex is also created to prevent

128
00:04:13,439 --> 00:04:15,519
multiple instances of the malware to run

129
00:04:15,519 --> 00:04:17,199
on the same machine and the mutex is

130
00:04:17,199 --> 00:04:20,079
also called internet assistant n

131
00:04:20,079 --> 00:04:22,880
great moving on to the cnc communication

132
00:04:22,880 --> 00:04:25,280
of the sample the sample has an embedded

133
00:04:25,280 --> 00:04:28,240
cnc address which it can contact over

134
00:04:28,240 --> 00:04:28,639
both

135
00:04:28,639 --> 00:04:31,680
port 80 and port 443 it has a comodo

136
00:04:31,680 --> 00:04:32,880
certificate

137
00:04:32,880 --> 00:04:36,080
so it can use https and if for any

138
00:04:36,080 --> 00:04:37,840
reason the sample gets back an

139
00:04:37,840 --> 00:04:39,600
error from this communication attempt to

140
00:04:39,600 --> 00:04:41,759
know whether the cnc is down or there

141
00:04:41,759 --> 00:04:44,080
was no internet connection at the time

142
00:04:44,080 --> 00:04:46,960
the sample can use a backup cnc address

143
00:04:46,960 --> 00:04:49,280
which is also hard coded in the sample

144
00:04:49,280 --> 00:04:49,759
and

145
00:04:49,759 --> 00:04:52,400
it sends a request to the following url

146
00:04:52,400 --> 00:04:52,880
which

147
00:04:52,880 --> 00:04:56,000
looks like it's base64 encoded

148
00:04:56,000 --> 00:04:59,360
and if we decode this url we get devices

149
00:04:59,360 --> 00:04:59,840
slash

150
00:04:59,840 --> 00:05:02,400
yet another base64 encoded string and if

151
00:05:02,400 --> 00:05:04,080
we decode that twice we get

152
00:05:04,080 --> 00:05:06,880
devices slash requests but the sample

153
00:05:06,880 --> 00:05:08,720
does communicate with the url

154
00:05:08,720 --> 00:05:11,360
in its encoding in its encoded form and

155
00:05:11,360 --> 00:05:13,280
not in the decoded one

156
00:05:13,280 --> 00:05:14,960
and the thread actor could send back a

157
00:05:14,960 --> 00:05:17,440
new cnc address as a response you know

158
00:05:17,440 --> 00:05:17,840
if they

159
00:05:17,840 --> 00:05:20,000
decide to change the infrastructure or

160
00:05:20,000 --> 00:05:21,520
if the main one is down

161
00:05:21,520 --> 00:05:23,440
and that response is matched with a

162
00:05:23,440 --> 00:05:24,880
regular expression

163
00:05:24,880 --> 00:05:27,120
if it does if it is indeed a domain then

164
00:05:27,120 --> 00:05:30,720
the server name is set to that new value

165
00:05:30,720 --> 00:05:34,400
um and a unique identifier is created

166
00:05:34,400 --> 00:05:36,639
for each victim using their computer

167
00:05:36,639 --> 00:05:36,960
name

168
00:05:36,960 --> 00:05:39,440
their username and random string all are

169
00:05:39,440 --> 00:05:41,120
separated by an underscore

170
00:05:41,120 --> 00:05:43,199
and this of course is used later on in

171
00:05:43,199 --> 00:05:44,720
all the requests that are sent

172
00:05:44,720 --> 00:05:47,280
to the cnc server from that specific

173
00:05:47,280 --> 00:05:48,080
victim

174
00:05:48,080 --> 00:05:50,880
and the first request is used to

175
00:05:50,880 --> 00:05:52,400
register or to create

176
00:05:52,400 --> 00:05:55,280
that victim so it is sent to the url api

177
00:05:55,280 --> 00:05:56,400
serve create

178
00:05:56,400 --> 00:05:59,680
along with four parameters um

179
00:05:59,680 --> 00:06:02,000
the first parameter is actually the name

180
00:06:02,000 --> 00:06:04,960
which is the base64 encoded ui uid we've

181
00:06:04,960 --> 00:06:05,759
just seen

182
00:06:05,759 --> 00:06:07,919
the second parameter is the operating

183
00:06:07,919 --> 00:06:09,120
system version

184
00:06:09,120 --> 00:06:11,120
the third parameter is supposed to be

185
00:06:11,120 --> 00:06:13,759
the malware name or the app name and

186
00:06:13,759 --> 00:06:15,840
if you remember the executable was

187
00:06:15,840 --> 00:06:17,680
called driver installer u but in this

188
00:06:17,680 --> 00:06:18,639
case the app name

189
00:06:18,639 --> 00:06:20,319
is internet assistant that's the one

190
00:06:20,319 --> 00:06:21,759
that is sent

191
00:06:21,759 --> 00:06:24,000
um and the last parameter is of course

192
00:06:24,000 --> 00:06:27,600
av and he installed anti-virus vendors

193
00:06:27,600 --> 00:06:30,400
cool so when the victim is successfully

194
00:06:30,400 --> 00:06:31,600
registered

195
00:06:31,600 --> 00:06:34,319
the malware would start generating post

196
00:06:34,319 --> 00:06:35,759
requests to

197
00:06:35,759 --> 00:06:37,600
api server requests along with the

198
00:06:37,600 --> 00:06:40,080
victim id every minute

199
00:06:40,080 --> 00:06:42,720
and if something else besides the victim

200
00:06:42,720 --> 00:06:43,759
id is sent

201
00:06:43,759 --> 00:06:46,160
the cnc replies with a weird error

202
00:06:46,160 --> 00:06:46,800
message

203
00:06:46,800 --> 00:06:50,160
sorry not found this device

204
00:06:50,160 --> 00:06:52,560
but if the id is correct and all is good

205
00:06:52,560 --> 00:06:55,039
then it will respond with uh

206
00:06:55,039 --> 00:06:59,039
an interesting json array and we have

207
00:06:59,039 --> 00:07:01,280
uh in the json area elements that are

208
00:07:01,280 --> 00:07:03,440
marked as true or false

209
00:07:03,440 --> 00:07:06,319
and as a matter of fact the malware

210
00:07:06,319 --> 00:07:08,560
itself divides its functionality into

211
00:07:08,560 --> 00:07:09,919
so-called modules

212
00:07:09,919 --> 00:07:12,400
each module is in charge of a specific

213
00:07:12,400 --> 00:07:13,520
task or for

214
00:07:13,520 --> 00:07:15,759
exfiltrating a certain kind of data from

215
00:07:15,759 --> 00:07:17,280
the victim's machine

216
00:07:17,280 --> 00:07:18,800
and you can see that they have weird

217
00:07:18,800 --> 00:07:22,960
names like penny or kuthrapali

218
00:07:22,960 --> 00:07:25,759
and the first module is run file and

219
00:07:25,759 --> 00:07:28,479
there is no plot list that runs a file

220
00:07:28,479 --> 00:07:30,479
but there are six other modules that are

221
00:07:30,479 --> 00:07:32,400
named after characters and

222
00:07:32,400 --> 00:07:36,160
actors from the big bang series from the

223
00:07:36,160 --> 00:07:38,639
tv show and this is basically the reason

224
00:07:38,639 --> 00:07:40,479
why we decided to call this campaign

225
00:07:40,479 --> 00:07:43,680
the big bang theory attack um and they

226
00:07:43,680 --> 00:07:44,160
are

227
00:07:44,160 --> 00:07:47,280
in charge of some uh tasks such as uh

228
00:07:47,280 --> 00:07:48,240
you know

229
00:07:48,240 --> 00:07:50,160
deleting the payload for a touch of

230
00:07:50,160 --> 00:07:52,240
stealth you know to self-destruct

231
00:07:52,240 --> 00:07:54,400
uh they could send a list of running

232
00:07:54,400 --> 00:07:56,879
processes to the

233
00:07:56,879 --> 00:07:59,039
threat actor using the wallowitz module

234
00:07:59,039 --> 00:08:00,639
and then the threat actor could decide

235
00:08:00,639 --> 00:08:02,240
to terminate a process if you're running

236
00:08:02,240 --> 00:08:03,759
wireshark for example they could

237
00:08:03,759 --> 00:08:04,720
terminate that

238
00:08:04,720 --> 00:08:08,400
using the hofstadter module and

239
00:08:08,400 --> 00:08:10,319
in the example we have seen the only

240
00:08:10,319 --> 00:08:12,240
module that was marked as true was

241
00:08:12,240 --> 00:08:15,919
penny um and in that case the uh malware

242
00:08:15,919 --> 00:08:18,080
code checks uh the mod the element's

243
00:08:18,080 --> 00:08:19,360
name if it is penny

244
00:08:19,360 --> 00:08:21,599
it checks if it's marked as true and if

245
00:08:21,599 --> 00:08:24,319
it is true a file is uploaded to

246
00:08:24,319 --> 00:08:26,720
api server request slash id slash penny

247
00:08:26,720 --> 00:08:28,560
or which in this case the file is a

248
00:08:28,560 --> 00:08:32,000
screenshot taken from our malware lab

249
00:08:32,000 --> 00:08:34,479
um and one cool thing about those

250
00:08:34,479 --> 00:08:36,000
modules is that some of them

251
00:08:36,000 --> 00:08:39,360
have uh comments or remarks that were

252
00:08:39,360 --> 00:08:41,919
probably there for debugging purposes by

253
00:08:41,919 --> 00:08:42,240
the

254
00:08:42,240 --> 00:08:45,040
threat actor um and they were left in

255
00:08:45,040 --> 00:08:46,880
the code uh and those remar

256
00:08:46,880 --> 00:08:49,040
those comments are base 64 encoded and

257
00:08:49,040 --> 00:08:50,320
if we decode them

258
00:08:50,320 --> 00:08:53,440
we also get some weird things like

259
00:08:53,440 --> 00:08:56,800
my prog is exit or download file text

260
00:08:56,800 --> 00:08:59,279
and so on and so forth um and these were

261
00:08:59,279 --> 00:09:00,880
interesting and they were aggressive

262
00:09:00,880 --> 00:09:04,160
we were able to find uh new uh we were

263
00:09:04,160 --> 00:09:05,920
able to get to new findings using

264
00:09:05,920 --> 00:09:07,920
using those documents and we'll using

265
00:09:07,920 --> 00:09:09,040
those comments

266
00:09:09,040 --> 00:09:12,480
and we will look into that in a bit

267
00:09:12,480 --> 00:09:14,640
and in addition to the actors from the

268
00:09:14,640 --> 00:09:16,720
tv series the big bang theory there were

269
00:09:16,720 --> 00:09:19,440
also three modules named after actors

270
00:09:19,440 --> 00:09:21,680
from a turkish tv series called the

271
00:09:21,680 --> 00:09:23,360
relish er to grow

272
00:09:23,360 --> 00:09:26,399
and those modules show some of the

273
00:09:26,399 --> 00:09:28,959
espionage attempts of the malware sample

274
00:09:28,959 --> 00:09:30,160
because they're

275
00:09:30,160 --> 00:09:34,000
able to download an executable from a

276
00:09:34,000 --> 00:09:35,200
remote service

277
00:09:35,200 --> 00:09:36,959
and they can change that executables

278
00:09:36,959 --> 00:09:39,519
extension from txt to exe

279
00:09:39,519 --> 00:09:41,200
and they could send back a list of

280
00:09:41,200 --> 00:09:43,519
documents or partitions to the threat

281
00:09:43,519 --> 00:09:44,320
actor

282
00:09:44,320 --> 00:09:46,240
and we can see that unlike you know your

283
00:09:46,240 --> 00:09:47,839
usual rats that are after

284
00:09:47,839 --> 00:09:50,720
the credentials or browser history or

285
00:09:50,720 --> 00:09:52,640
try to key log the victim

286
00:09:52,640 --> 00:09:54,640
this one is interested in kind of

287
00:09:54,640 --> 00:09:56,399
building a profile of the

288
00:09:56,399 --> 00:09:57,920
victim and seeing what's going on in

289
00:09:57,920 --> 00:10:00,160
their machine and we see that they are

290
00:10:00,160 --> 00:10:01,040
interested

291
00:10:01,040 --> 00:10:03,519
in files with specific extensions such

292
00:10:03,519 --> 00:10:04,160
as

293
00:10:04,160 --> 00:10:08,079
doc xls pdf or csv

294
00:10:08,079 --> 00:10:11,040
and the document that we started with if

295
00:10:11,040 --> 00:10:12,720
you remember it the press report

296
00:10:12,720 --> 00:10:14,480
it could have actually belonged to a

297
00:10:14,480 --> 00:10:16,079
victim that was infected

298
00:10:16,079 --> 00:10:18,079
by a sample of this malware and this

299
00:10:18,079 --> 00:10:19,920
document could have been stolen and used

300
00:10:19,920 --> 00:10:20,399
and

301
00:10:20,399 --> 00:10:22,720
used in future generations of this

302
00:10:22,720 --> 00:10:23,920
attack

303
00:10:23,920 --> 00:10:25,519
that's that's interesting to keep in

304
00:10:25,519 --> 00:10:27,440
mind and

305
00:10:27,440 --> 00:10:29,519
apart from the tv stars there are also

306
00:10:29,519 --> 00:10:31,440
the the last three modules

307
00:10:31,440 --> 00:10:34,560
use are apparently

308
00:10:34,560 --> 00:10:38,000
in turkish and we don't really

309
00:10:38,000 --> 00:10:40,640
know what those modules do and the

310
00:10:40,640 --> 00:10:41,519
reason for that

311
00:10:41,519 --> 00:10:44,560
is because we only got them back as a

312
00:10:44,560 --> 00:10:46,079
response from the cnc

313
00:10:46,079 --> 00:10:48,800
server in the json array and they were

314
00:10:48,800 --> 00:10:50,800
always marked as false and even if we

315
00:10:50,800 --> 00:10:53,040
tried to tamper the https response and

316
00:10:53,040 --> 00:10:54,240
mark them as true

317
00:10:54,240 --> 00:10:56,000
we don't we can't really get the malware

318
00:10:56,000 --> 00:10:57,920
to handle them so what this could

319
00:10:57,920 --> 00:10:59,920
indicate is that the sample is still

320
00:10:59,920 --> 00:11:01,760
being developed and that there may be

321
00:11:01,760 --> 00:11:03,600
other samples in the future with more

322
00:11:03,600 --> 00:11:06,000
capabilities and they will be able to do

323
00:11:06,000 --> 00:11:07,920
more damage in the victims machine and

324
00:11:07,920 --> 00:11:10,800
get more data out of it

325
00:11:10,800 --> 00:11:14,079
cool so as an overview of the malware we

326
00:11:14,079 --> 00:11:15,920
have seen its persistence attempt

327
00:11:15,920 --> 00:11:17,680
we've seen the fact that it uses a

328
00:11:17,680 --> 00:11:20,480
backup cnc address and that it

329
00:11:20,480 --> 00:11:22,640
fingerprints the victims using their own

330
00:11:22,640 --> 00:11:24,480
information

331
00:11:24,480 --> 00:11:26,560
it has multiple functionalities that are

332
00:11:26,560 --> 00:11:28,320
divided into modules

333
00:11:28,320 --> 00:11:30,720
and it can send different commands to

334
00:11:30,720 --> 00:11:32,880
get different kinds of data

335
00:11:32,880 --> 00:11:35,279
it is likely a part of a multi-stage

336
00:11:35,279 --> 00:11:37,040
attack and we know this because it is

337
00:11:37,040 --> 00:11:38,720
capable of downloading another

338
00:11:38,720 --> 00:11:40,880
executable from a different server

339
00:11:40,880 --> 00:11:43,440
so we're most probably looking at the

340
00:11:43,440 --> 00:11:45,440
first stage only and not at the full

341
00:11:45,440 --> 00:11:47,279
infection chain

342
00:11:47,279 --> 00:11:50,240
um and we we couldn't get the sample to

343
00:11:50,240 --> 00:11:51,200
send us anything

344
00:11:51,200 --> 00:11:54,240
interesting in our malware labs we tried

345
00:11:54,240 --> 00:11:54,639
we

346
00:11:54,639 --> 00:11:56,880
let it run for two whole days uh there

347
00:11:56,880 --> 00:11:58,800
were no interesting interesting commands

348
00:11:58,800 --> 00:12:00,160
that were sent back

349
00:12:00,160 --> 00:12:02,399
from the cnc the only thing that they

350
00:12:02,399 --> 00:12:03,920
were did was

351
00:12:03,920 --> 00:12:06,240
send a command to take a screenshot from

352
00:12:06,240 --> 00:12:09,200
our machine but nothing else

353
00:12:09,200 --> 00:12:11,760
um so it seems to be after specific

354
00:12:11,760 --> 00:12:13,600
victims and it does so by looking at the

355
00:12:13,600 --> 00:12:15,200
screenshots by looking at the list of

356
00:12:15,200 --> 00:12:16,800
documents that they have

357
00:12:16,800 --> 00:12:18,800
and only then will they proceed to send

358
00:12:18,800 --> 00:12:21,680
them more malicious stuff

359
00:12:21,680 --> 00:12:24,959
um and we wanted to know i mean we

360
00:12:24,959 --> 00:12:26,320
realized this is something that is

361
00:12:26,320 --> 00:12:28,000
interesting and we wanted to see

362
00:12:28,000 --> 00:12:30,079
if there are more files like this one

363
00:12:30,079 --> 00:12:31,600
out there or if we're looking at

364
00:12:31,600 --> 00:12:32,320
something

365
00:12:32,320 --> 00:12:34,959
that is unique uh or you know if someone

366
00:12:34,959 --> 00:12:37,760
has already researched this before

367
00:12:37,760 --> 00:12:39,360
and then we decided to use some of the

368
00:12:39,360 --> 00:12:41,279
unique identifiers that we have

369
00:12:41,279 --> 00:12:43,040
seen in our own sample so if you

370
00:12:43,040 --> 00:12:44,480
remember the name

371
00:12:44,480 --> 00:12:46,959
internet assistant with the typo we used

372
00:12:46,959 --> 00:12:48,480
that and we were able to find one

373
00:12:48,480 --> 00:12:50,480
additional executable in the wild that

374
00:12:50,480 --> 00:12:52,240
uses that name

375
00:12:52,240 --> 00:12:56,079
and using the base64 encoded comments

376
00:12:56,079 --> 00:12:57,680
and also some unique strings from the

377
00:12:57,680 --> 00:12:59,920
sample itself we were able to build

378
00:12:59,920 --> 00:13:02,639
yara rules and those got us back an

379
00:13:02,639 --> 00:13:04,000
additional executable

380
00:13:04,000 --> 00:13:07,279
called win graphic driver

381
00:13:07,279 --> 00:13:08,480
and it basically had the same

382
00:13:08,480 --> 00:13:10,560
functionality as our sample the only

383
00:13:10,560 --> 00:13:12,160
difference was that

384
00:13:12,160 --> 00:13:15,440
instead of the tv actor names it only

385
00:13:15,440 --> 00:13:16,000
used

386
00:13:16,000 --> 00:13:19,760
names of bmw cars for some reason

387
00:13:19,760 --> 00:13:21,440
but that wasn't enough for us i mean we

388
00:13:21,440 --> 00:13:23,519
were able to find two samples great but

389
00:13:23,519 --> 00:13:26,000
we wanted to know more about this

390
00:13:26,000 --> 00:13:28,160
and so we turned to the cnc addresses

391
00:13:28,160 --> 00:13:30,079
and tried to find out more about this

392
00:13:30,079 --> 00:13:31,920
infrastructure

393
00:13:31,920 --> 00:13:34,079
and unlike your typical cnc where if you

394
00:13:34,079 --> 00:13:36,079
access it through a browser it doesn't

395
00:13:36,079 --> 00:13:39,120
show you anything it sends back a 404

396
00:13:39,120 --> 00:13:42,720
or doesn't show any response these ones

397
00:13:42,720 --> 00:13:45,199
show ready-made the ones that appeared

398
00:13:45,199 --> 00:13:46,000
in the samples

399
00:13:46,000 --> 00:13:48,160
show ready-made bootstrap templates when

400
00:13:48,160 --> 00:13:51,040
they are accessed through a browser

401
00:13:51,040 --> 00:13:52,720
and there were some changes that were

402
00:13:52,720 --> 00:13:54,880
made to the bootstrap template some of

403
00:13:54,880 --> 00:13:56,800
the default strings were changed into

404
00:13:56,800 --> 00:13:58,160
things like

405
00:13:58,160 --> 00:14:00,160
probably the most music site in the

406
00:14:00,160 --> 00:14:01,800
world or contact at

407
00:14:01,800 --> 00:14:03,360
somethingsomething.com

408
00:14:03,360 --> 00:14:06,399
and those strings again they repeat the

409
00:14:06,399 --> 00:14:07,839
english that we have seen in the

410
00:14:07,839 --> 00:14:09,760
comments before with the grammatical

411
00:14:09,760 --> 00:14:11,440
mistakes and whatever

412
00:14:11,440 --> 00:14:13,680
but they also enabled us to look them up

413
00:14:13,680 --> 00:14:15,279
in different search engines

414
00:14:15,279 --> 00:14:18,480
and find websites with the exact same

415
00:14:18,480 --> 00:14:19,440
structure

416
00:14:19,440 --> 00:14:21,199
and the same content that could have

417
00:14:21,199 --> 00:14:23,360
been used for future samples

418
00:14:23,360 --> 00:14:26,079
so we were able to get i think four or

419
00:14:26,079 --> 00:14:28,160
five additional domains using uh

420
00:14:28,160 --> 00:14:31,120
just looking up those strings but that

421
00:14:31,120 --> 00:14:32,959
wasn't enough for us

422
00:14:32,959 --> 00:14:35,680
and we wanted to relate this perhaps to

423
00:14:35,680 --> 00:14:37,120
a bigger campaign or see if

424
00:14:37,120 --> 00:14:40,240
it has been uh going on for a while and

425
00:14:40,240 --> 00:14:41,920
this is when we

426
00:14:41,920 --> 00:14:45,600
came across this report by cisco's telus

427
00:14:45,600 --> 00:14:49,199
and they researched a malware written in

428
00:14:49,199 --> 00:14:51,120
delphi that was used to target

429
00:14:51,120 --> 00:14:52,639
palestinians

430
00:14:52,639 --> 00:14:55,920
and some of the characteristics of this

431
00:14:55,920 --> 00:14:56,639
malware

432
00:14:56,639 --> 00:14:59,440
were very similar to the one that we had

433
00:14:59,440 --> 00:15:01,279
for example the use of

434
00:15:01,279 --> 00:15:04,480
decoy documents but also

435
00:15:04,480 --> 00:15:07,920
the references to tv shows they used the

436
00:15:07,920 --> 00:15:10,560
same format with the json areas elements

437
00:15:10,560 --> 00:15:12,639
marked as true or false

438
00:15:12,639 --> 00:15:15,680
and even some one of the uh cnc websites

439
00:15:15,680 --> 00:15:16,920
was called

440
00:15:16,920 --> 00:15:19,360
sheldoncooper.info so we knew that this

441
00:15:19,360 --> 00:15:21,920
was related to our sample

442
00:15:21,920 --> 00:15:24,160
and using this we were able to get to

443
00:15:24,160 --> 00:15:26,240
more reports by different security

444
00:15:26,240 --> 00:15:27,920
vendors who have done an amazing job by

445
00:15:27,920 --> 00:15:28,560
the way

446
00:15:28,560 --> 00:15:30,880
in covering uh the different aspects and

447
00:15:30,880 --> 00:15:32,160
the different campaigns

448
00:15:32,160 --> 00:15:35,600
by this threat group and

449
00:15:35,600 --> 00:15:37,839
some of the vendors only looked at the

450
00:15:37,839 --> 00:15:39,759
mobile aspects or the desktop

451
00:15:39,759 --> 00:15:42,079
aspects of this attack not all of them

452
00:15:42,079 --> 00:15:45,759
attributed this attack to aptc 23

453
00:15:45,759 --> 00:15:47,920
and we realized that we were looking at

454
00:15:47,920 --> 00:15:49,839
an evolving malware it's something that

455
00:15:49,839 --> 00:15:51,279
constantly changes

456
00:15:51,279 --> 00:15:54,160
our urls were only able to detect recent

457
00:15:54,160 --> 00:15:55,199
files that

458
00:15:55,199 --> 00:15:57,680
almost looked uh more or less the same

459
00:15:57,680 --> 00:15:59,040
as ours

460
00:15:59,040 --> 00:16:00,880
but they weren't able to detect any of

461
00:16:00,880 --> 00:16:03,040
the old ones

462
00:16:03,040 --> 00:16:07,600
and there were more than 200 domains

463
00:16:07,600 --> 00:16:10,480
in total used as cnc's from all of those

464
00:16:10,480 --> 00:16:12,000
researches

465
00:16:12,000 --> 00:16:14,079
and that's when i realized i really

466
00:16:14,079 --> 00:16:15,120
needed some help

467
00:16:15,120 --> 00:16:17,519
in connecting the dots and kind of

468
00:16:17,519 --> 00:16:18,639
figure

469
00:16:18,639 --> 00:16:20,639
looking over this massive amount amount

470
00:16:20,639 --> 00:16:24,480
of data that all of the vendors found

471
00:16:24,480 --> 00:16:27,440
and that's when i decided to literally

472
00:16:27,440 --> 00:16:28,720
connect the dot

473
00:16:28,720 --> 00:16:32,160
and create this mapping of aptc

474
00:16:32,160 --> 00:16:35,680
23 and just gather all the information

475
00:16:35,680 --> 00:16:36,000
that

476
00:16:36,000 --> 00:16:38,800
the vendors were able to find so what

477
00:16:38,800 --> 00:16:39,920
this mapping shows

478
00:16:39,920 --> 00:16:44,000
is the campaign researched by the

479
00:16:44,000 --> 00:16:45,279
different vendors the

480
00:16:45,279 --> 00:16:47,279
cnc servers that they managed to find

481
00:16:47,279 --> 00:16:48,800
the tv show references

482
00:16:48,800 --> 00:16:52,000
that those cnc uh servers make

483
00:16:52,000 --> 00:16:54,000
and there were some cool connections

484
00:16:54,000 --> 00:16:56,480
because we were able to see for example

485
00:16:56,480 --> 00:16:57,600
a cnc

486
00:16:57,600 --> 00:17:00,480
that was discovered by uh two different

487
00:17:00,480 --> 00:17:02,240
vendors in two different generations of

488
00:17:02,240 --> 00:17:04,799
this campaign or it was used as a cnc

489
00:17:04,799 --> 00:17:05,359
server

490
00:17:05,359 --> 00:17:06,959
for both an application and an

491
00:17:06,959 --> 00:17:09,439
executable

492
00:17:09,439 --> 00:17:11,039
and there were some interesting

493
00:17:11,039 --> 00:17:14,079
connections that we were able to see

494
00:17:14,079 --> 00:17:16,079
um and when i started adding those

495
00:17:16,079 --> 00:17:17,520
domains that was dealing with massive

496
00:17:17,520 --> 00:17:18,480
amounts of them

497
00:17:18,480 --> 00:17:21,599
and then i thought to myself um there is

498
00:17:21,599 --> 00:17:22,559
no way in hell

499
00:17:22,559 --> 00:17:24,880
someone that has been launching this

500
00:17:24,880 --> 00:17:25,599
attack

501
00:17:25,599 --> 00:17:27,199
and using both applications and

502
00:17:27,199 --> 00:17:28,799
executable didn't slip

503
00:17:28,799 --> 00:17:31,840
up at some point and didn't give away

504
00:17:31,840 --> 00:17:34,720
something that could help us find out um

505
00:17:34,720 --> 00:17:35,760
anything about their

506
00:17:35,760 --> 00:17:37,679
true identity or kind of just get an

507
00:17:37,679 --> 00:17:39,840
idea of what their incentive is behind

508
00:17:39,840 --> 00:17:42,160
this attack

509
00:17:42,160 --> 00:17:44,240
and then i realized that uh in the first

510
00:17:44,240 --> 00:17:46,000
reports that covered this campaign were

511
00:17:46,000 --> 00:17:47,520
the threat group by

512
00:17:47,520 --> 00:17:51,039
palo alto networks and kihu 360

513
00:17:51,039 --> 00:17:52,960
they mentioned that some of the domains

514
00:17:52,960 --> 00:17:54,320
that were registered

515
00:17:54,320 --> 00:17:57,440
back in 2016 used the name

516
00:17:57,440 --> 00:18:01,520
adam swift in their whois information

517
00:18:01,520 --> 00:18:04,400
um and there were approximately 30

518
00:18:04,400 --> 00:18:05,360
domains

519
00:18:05,360 --> 00:18:07,919
that used this uh name and the reports

520
00:18:07,919 --> 00:18:09,679
didn't mention much else about this adam

521
00:18:09,679 --> 00:18:10,480
swift

522
00:18:10,480 --> 00:18:12,880
so i decided to give it a closer look

523
00:18:12,880 --> 00:18:14,720
and see if i can get any interesting

524
00:18:14,720 --> 00:18:16,000
details

525
00:18:16,000 --> 00:18:19,679
out of the whois information

526
00:18:20,160 --> 00:18:22,720
and there were some interesting details

527
00:18:22,720 --> 00:18:24,960
the email address that was used adam

528
00:18:24,960 --> 00:18:26,960
swift 2016

529
00:18:26,960 --> 00:18:28,799
correlates with the year that those

530
00:18:28,799 --> 00:18:30,240
domains were registered in

531
00:18:30,240 --> 00:18:33,760
2016. the street name that was provided

532
00:18:33,760 --> 00:18:35,840
in the who is information is a real

533
00:18:35,840 --> 00:18:37,120
street in gaza

534
00:18:37,120 --> 00:18:39,760
with many businesses registered there

535
00:18:39,760 --> 00:18:42,320
the uh postal code 972 is the country

536
00:18:42,320 --> 00:18:45,520
code for the west bank or for israel

537
00:18:45,520 --> 00:18:47,600
and the phone number um even though it

538
00:18:47,600 --> 00:18:49,679
starts with a 6-3 which is the

539
00:18:49,679 --> 00:18:52,960
vietnamese country code i think

540
00:18:52,960 --> 00:18:54,799
if you omit that you get a number that

541
00:18:54,799 --> 00:18:56,880
starts with zero five nine

542
00:18:56,880 --> 00:18:58,880
and a number that starts with zero five

543
00:18:58,880 --> 00:19:01,760
nine matches the uh ones given by the uh

544
00:19:01,760 --> 00:19:03,520
palestinian mobile carrier as

545
00:19:03,520 --> 00:19:07,120
well um and this was confirmed by the

546
00:19:07,120 --> 00:19:08,960
who is information of the first

547
00:19:08,960 --> 00:19:11,360
domain that was registered under adam

548
00:19:11,360 --> 00:19:12,320
swift

549
00:19:12,320 --> 00:19:16,160
because it showed this number with 970

550
00:19:16,160 --> 00:19:18,640
country code which is the gaza country

551
00:19:18,640 --> 00:19:20,480
code

552
00:19:20,480 --> 00:19:23,760
um and i try to obviously i try to look

553
00:19:23,760 --> 00:19:25,679
up this number it has no whatsapp or

554
00:19:25,679 --> 00:19:28,000
telegram accounts i haven't tried to

555
00:19:28,000 --> 00:19:30,720
call it yet i don't know what i would do

556
00:19:30,720 --> 00:19:32,240
if the threat actor picks up

557
00:19:32,240 --> 00:19:34,400
but it's interesting the use of this

558
00:19:34,400 --> 00:19:36,400
information the use of a palestinian

559
00:19:36,400 --> 00:19:37,600
mobile number and

560
00:19:37,600 --> 00:19:39,760
a palestinian street address so it's

561
00:19:39,760 --> 00:19:41,760
possible again the threat act that the

562
00:19:41,760 --> 00:19:42,640
threat actor

563
00:19:42,640 --> 00:19:44,240
is using information that they are

564
00:19:44,240 --> 00:19:46,480
familiar with information from their

565
00:19:46,480 --> 00:19:48,880
surroundings

566
00:19:48,880 --> 00:19:52,160
and newer websites that were

567
00:19:52,160 --> 00:19:55,520
used in campaigns in 2018 didn't give

568
00:19:55,520 --> 00:19:57,520
away that much information a lot of them

569
00:19:57,520 --> 00:19:58,480
didn't have

570
00:19:58,480 --> 00:20:01,679
any uh relevant who is but some of them

571
00:20:01,679 --> 00:20:05,200
were registered using palestinian

572
00:20:05,200 --> 00:20:09,760
web hosting companies um

573
00:20:09,760 --> 00:20:11,520
and that's and those companies are also

574
00:20:11,520 --> 00:20:13,120
located in gaza

575
00:20:13,120 --> 00:20:15,440
and this is not to say you know that

576
00:20:15,440 --> 00:20:16,799
they're related to this

577
00:20:16,799 --> 00:20:19,120
operation or that they're in charge of

578
00:20:19,120 --> 00:20:20,799
it they seem to be very legitimate

579
00:20:20,799 --> 00:20:21,760
businesses

580
00:20:21,760 --> 00:20:25,120
um but the choice of these companies is

581
00:20:25,120 --> 00:20:26,240
interesting because

582
00:20:26,240 --> 00:20:28,480
this can also help us pinpoint kind of

583
00:20:28,480 --> 00:20:30,559
the whereabouts of the threat actor

584
00:20:30,559 --> 00:20:32,799
and know that they are using services in

585
00:20:32,799 --> 00:20:34,799
their surrounding services that they

586
00:20:34,799 --> 00:20:36,480
know

587
00:20:36,480 --> 00:20:38,400
and the first one of these for example

588
00:20:38,400 --> 00:20:39,600
the atiaf

589
00:20:39,600 --> 00:20:42,880
company is um if we look at their

590
00:20:42,880 --> 00:20:44,640
facebook page actually we see that they

591
00:20:44,640 --> 00:20:45,600
are located

592
00:20:45,600 --> 00:20:48,320
in al-jala street which we have seen in

593
00:20:48,320 --> 00:20:49,919
the who is information

594
00:20:49,919 --> 00:20:53,360
um used by adam swift and

595
00:20:53,360 --> 00:20:56,080
uh if we look at their description we

596
00:20:56,080 --> 00:20:57,039
can see

597
00:20:57,039 --> 00:21:00,400
that they do things like mobile app

598
00:21:00,400 --> 00:21:01,200
development

599
00:21:01,200 --> 00:21:03,120
web development web design and web

600
00:21:03,120 --> 00:21:04,960
hosting

601
00:21:04,960 --> 00:21:06,960
and they look like again they have many

602
00:21:06,960 --> 00:21:08,720
customers they show some of their

603
00:21:08,720 --> 00:21:10,159
products the applications and the

604
00:21:10,159 --> 00:21:11,919
websites they have worked on

605
00:21:11,919 --> 00:21:15,200
um but and they don't seem to be related

606
00:21:15,200 --> 00:21:15,760
to this

607
00:21:15,760 --> 00:21:17,840
but they could provide a perfect

608
00:21:17,840 --> 00:21:19,440
environment for someone

609
00:21:19,440 --> 00:21:21,600
who is launching an attack with both

610
00:21:21,600 --> 00:21:23,120
mobile and desktop

611
00:21:23,120 --> 00:21:26,320
attack vectors to come from um

612
00:21:26,320 --> 00:21:28,400
and this was all an attempt for me to

613
00:21:28,400 --> 00:21:30,159
kind of build the profile

614
00:21:30,159 --> 00:21:32,159
of the threat actor of whoever is behind

615
00:21:32,159 --> 00:21:35,200
this and try to find out more about them

616
00:21:35,200 --> 00:21:37,600
and more recently i came across

617
00:21:37,600 --> 00:21:39,440
something that someone published on

618
00:21:39,440 --> 00:21:41,360
pastebin

619
00:21:41,360 --> 00:21:43,520
and they have been looking into this

620
00:21:43,520 --> 00:21:44,960
threat group as well but more

621
00:21:44,960 --> 00:21:47,120
specifically into the mobile aspect

622
00:21:47,120 --> 00:21:49,760
they're called robinhood lead no idea

623
00:21:49,760 --> 00:21:50,640
who they are

624
00:21:50,640 --> 00:21:53,200
um and they were looking into the mobile

625
00:21:53,200 --> 00:21:55,679
applications they even released a tool

626
00:21:55,679 --> 00:21:59,679
to help victims get rid of the malicious

627
00:21:59,679 --> 00:22:01,600
applications and remove them from their

628
00:22:01,600 --> 00:22:03,919
device

629
00:22:03,919 --> 00:22:06,320
but in addition they were also able to

630
00:22:06,320 --> 00:22:07,520
gain access

631
00:22:07,520 --> 00:22:10,080
to the cnc server used by the malicious

632
00:22:10,080 --> 00:22:12,320
application that they found and they

633
00:22:12,320 --> 00:22:13,039
released

634
00:22:13,039 --> 00:22:16,159
some of the images found on that cnc

635
00:22:16,159 --> 00:22:19,520
server and a lot of those images were

636
00:22:19,520 --> 00:22:20,559
you know pictures

637
00:22:20,559 --> 00:22:23,200
taken from victor taken by victims and

638
00:22:23,200 --> 00:22:25,200
then stolen by the threat actors

639
00:22:25,200 --> 00:22:28,000
selfies and whatnot but some of the

640
00:22:28,000 --> 00:22:28,720
images

641
00:22:28,720 --> 00:22:32,000
were screenshots and some of those

642
00:22:32,000 --> 00:22:32,880
screenshots

643
00:22:32,880 --> 00:22:35,200
were taking were taken from the threat

644
00:22:35,200 --> 00:22:37,840
actors developing environment

645
00:22:37,840 --> 00:22:40,320
when they were actually working on the

646
00:22:40,320 --> 00:22:41,679
code

647
00:22:41,679 --> 00:22:43,360
and i decided to again look at the

648
00:22:43,360 --> 00:22:45,120
screenshots and see if they can tell me

649
00:22:45,120 --> 00:22:46,480
something that i don't already know

650
00:22:46,480 --> 00:22:48,000
about the threat actor and see if i can

651
00:22:48,000 --> 00:22:50,159
get more information out of them

652
00:22:50,159 --> 00:22:52,000
and the screenshots show that two

653
00:22:52,000 --> 00:22:53,840
screens are being used so we already

654
00:22:53,840 --> 00:22:54,320
know we're

655
00:22:54,320 --> 00:22:56,960
dealing with a professional and the

656
00:22:56,960 --> 00:22:58,000
first screen

657
00:22:58,000 --> 00:23:00,880
showed a visual studio developing

658
00:23:00,880 --> 00:23:02,000
environment

659
00:23:02,000 --> 00:23:05,039
and we see code uh being written in c

660
00:23:05,039 --> 00:23:08,080
plus in the background and the json area

661
00:23:08,080 --> 00:23:09,760
that we're already familiar with you

662
00:23:09,760 --> 00:23:12,080
know with weird names marked as true or

663
00:23:12,080 --> 00:23:12,960
false

664
00:23:12,960 --> 00:23:14,880
probably or you know we know that one of

665
00:23:14,880 --> 00:23:16,400
the ones marked as true

666
00:23:16,400 --> 00:23:18,880
is in charge of the screenshot taking

667
00:23:18,880 --> 00:23:20,880
functionality so this is why we ended up

668
00:23:20,880 --> 00:23:23,840
with the screenshot

669
00:23:24,240 --> 00:23:26,159
and we see that the logged in user to

670
00:23:26,159 --> 00:23:27,679
this visual studio

671
00:23:27,679 --> 00:23:30,880
is someone called nurashem

672
00:23:30,880 --> 00:23:34,159
and the other screen also showed a panel

673
00:23:34,159 --> 00:23:36,799
or a dashboard for keeping track of

674
00:23:36,799 --> 00:23:38,000
victims

675
00:23:38,000 --> 00:23:40,159
and the logged in user to the dashboard

676
00:23:40,159 --> 00:23:41,440
is called sema

677
00:23:41,440 --> 00:23:43,120
we don't know much else about this

678
00:23:43,120 --> 00:23:44,559
person from the dashboard

679
00:23:44,559 --> 00:23:46,559
the available information that we see

680
00:23:46,559 --> 00:23:48,640
here the ip address and whatever

681
00:23:48,640 --> 00:23:52,080
that all belongs to a palestinian victim

682
00:23:52,080 --> 00:23:54,400
but we do see you know tabs open in

683
00:23:54,400 --> 00:23:55,360
arabic

684
00:23:55,360 --> 00:23:58,640
we see uh bookmarks about c plus plus

685
00:23:58,640 --> 00:23:59,279
issues

686
00:23:59,279 --> 00:24:01,120
and at the bottom we see a resource

687
00:24:01,120 --> 00:24:02,400
hacker and

688
00:24:02,400 --> 00:24:04,400
tools like pycharm and so on and so

689
00:24:04,400 --> 00:24:06,400
forth

690
00:24:06,400 --> 00:24:08,720
another screenshot from the thread

691
00:24:08,720 --> 00:24:10,720
actors development environment

692
00:24:10,720 --> 00:24:14,720
showed an open facebook tab

693
00:24:14,720 --> 00:24:18,159
and naturally when i saw this i created

694
00:24:18,159 --> 00:24:20,400
a fake facebook profile and started

695
00:24:20,400 --> 00:24:21,120
looking

696
00:24:21,120 --> 00:24:23,679
for anyone called nura and try to see if

697
00:24:23,679 --> 00:24:24,159
their

698
00:24:24,159 --> 00:24:26,320
profile picture matches this tiny icon

699
00:24:26,320 --> 00:24:27,360
that we see here

700
00:24:27,360 --> 00:24:29,279
i try to enroll in all of the groups

701
00:24:29,279 --> 00:24:30,880
that we see and look through the

702
00:24:30,880 --> 00:24:32,640
remember lists for someone with this

703
00:24:32,640 --> 00:24:33,760
name in this picture

704
00:24:33,760 --> 00:24:35,600
i stalked all of the people that they

705
00:24:35,600 --> 00:24:37,039
talked with and looked through their

706
00:24:37,039 --> 00:24:39,039
friend lists and groups and likes and

707
00:24:39,039 --> 00:24:40,159
pages

708
00:24:40,159 --> 00:24:41,919
i looked through this page for someone

709
00:24:41,919 --> 00:24:43,840
called lara who liked it and through

710
00:24:43,840 --> 00:24:46,320
that tried to find someone called nura

711
00:24:46,320 --> 00:24:49,120
i looked for pages that have same icons

712
00:24:49,120 --> 00:24:50,480
that match the ones that we see on the

713
00:24:50,480 --> 00:24:52,720
screen and i even looked at this url

714
00:24:52,720 --> 00:24:55,919
we see in this picture to no avail

715
00:24:55,919 --> 00:24:58,640
i couldn't find this facebook profile i

716
00:24:58,640 --> 00:25:00,799
believe it has been deactivated

717
00:25:00,799 --> 00:25:03,039
since uh you see that the timestamp or

718
00:25:03,039 --> 00:25:04,720
the date at the bottom

719
00:25:04,720 --> 00:25:06,320
shows that this screenshot was taken in

720
00:25:06,320 --> 00:25:08,720
january they could have removed the

721
00:25:08,720 --> 00:25:10,799
profile changed the name or changed the

722
00:25:10,799 --> 00:25:12,080
picture i don't know

723
00:25:12,080 --> 00:25:13,679
i would love to be proven wrong but it

724
00:25:13,679 --> 00:25:16,400
seems to have been deactivated

725
00:25:16,400 --> 00:25:19,279
and that's when i decided to look for

726
00:25:19,279 --> 00:25:21,360
the name we have seen in visual studio

727
00:25:21,360 --> 00:25:22,480
no rashem

728
00:25:22,480 --> 00:25:25,520
in google and it resulted in this

729
00:25:25,520 --> 00:25:26,640
picture

730
00:25:26,640 --> 00:25:28,880
which did look like the tiny icon that

731
00:25:28,880 --> 00:25:31,120
we have just seen in facebook

732
00:25:31,120 --> 00:25:34,320
um and this picture came from a twitter

733
00:25:34,320 --> 00:25:34,960
account

734
00:25:34,960 --> 00:25:38,559
also under the name nurashem and looking

735
00:25:38,559 --> 00:25:39,840
at this twitter account

736
00:25:39,840 --> 00:25:42,320
we see that they are interested in news

737
00:25:42,320 --> 00:25:44,159
about information security

738
00:25:44,159 --> 00:25:46,400
they follow you know hybrid analysis

739
00:25:46,400 --> 00:25:48,880
malware hunter team mobile security

740
00:25:48,880 --> 00:25:51,200
um and if we look at their tweets we

741
00:25:51,200 --> 00:25:52,559
also see

742
00:25:52,559 --> 00:25:55,760
that they the first one was called was

743
00:25:55,760 --> 00:25:58,880
hello world and they like some things

744
00:25:58,880 --> 00:25:59,520
about

745
00:25:59,520 --> 00:26:02,880
um php and web development

746
00:26:02,880 --> 00:26:06,320
uh so we do seem to be looking at an a

747
00:26:06,320 --> 00:26:08,000
twitter avatar that belongs to the

748
00:26:08,000 --> 00:26:08,960
threat actor

749
00:26:08,960 --> 00:26:12,720
behind aptc 23 and this account is still

750
00:26:12,720 --> 00:26:14,720
active by the way

751
00:26:14,720 --> 00:26:17,520
but i wasn't able to get anything else

752
00:26:17,520 --> 00:26:19,520
out of this or kind of find out more

753
00:26:19,520 --> 00:26:20,400
about

754
00:26:20,400 --> 00:26:22,159
the person behind this or their true

755
00:26:22,159 --> 00:26:25,600
identity it's just interesting to note

756
00:26:25,600 --> 00:26:28,799
but in conclusion we're looking at

757
00:26:28,799 --> 00:26:30,720
an ongoing attack even after we

758
00:26:30,720 --> 00:26:32,960
published our own research into the big

759
00:26:32,960 --> 00:26:34,960
bang campaign other vendors also found

760
00:26:34,960 --> 00:26:36,480
newer samples and

761
00:26:36,480 --> 00:26:38,400
published their insights to them as well

762
00:26:38,400 --> 00:26:40,000
they're still going um

763
00:26:40,000 --> 00:26:41,600
and releasing more applications and

764
00:26:41,600 --> 00:26:43,120
executables

765
00:26:43,120 --> 00:26:45,840
um even though the code is a bit hard to

766
00:26:45,840 --> 00:26:47,840
keep track of we see that

767
00:26:47,840 --> 00:26:50,080
they follow the same characteristics the

768
00:26:50,080 --> 00:26:51,440
the signature move

769
00:26:51,440 --> 00:26:54,159
of this uh threat group seems to be

770
00:26:54,159 --> 00:26:56,159
referencing tv shows whether in the

771
00:26:56,159 --> 00:26:58,640
domains or in the uh json area or the

772
00:26:58,640 --> 00:26:59,600
urls

773
00:26:59,600 --> 00:27:01,520
uh so that's something that could easily

774
00:27:01,520 --> 00:27:03,919
identify a malware that's being spread

775
00:27:03,919 --> 00:27:06,640
by uh this threat group we've seen its

776
00:27:06,640 --> 00:27:09,200
espionage attempts and the fact that it

777
00:27:09,200 --> 00:27:11,840
doesn't it's not after financial gain it

778
00:27:11,840 --> 00:27:12,640
looks for

779
00:27:12,640 --> 00:27:15,440
the documents and tries to identify the

780
00:27:15,440 --> 00:27:17,360
victim before moving on to the next

781
00:27:17,360 --> 00:27:19,279
stage

782
00:27:19,279 --> 00:27:21,279
and it seems like we're looking at a

783
00:27:21,279 --> 00:27:23,200
palestinian threat actor

784
00:27:23,200 --> 00:27:26,240
that uses their knowledge of the uh

785
00:27:26,240 --> 00:27:27,279
palestinian

786
00:27:27,279 --> 00:27:30,559
world and the palestinian people and

787
00:27:30,559 --> 00:27:32,559
uses that against them basically they

788
00:27:32,559 --> 00:27:34,159
know what kind of applications they're

789
00:27:34,159 --> 00:27:35,679
likely to download they know what kind

790
00:27:35,679 --> 00:27:36,080
of

791
00:27:36,080 --> 00:27:37,919
documents they're likely to be looking

792
00:27:37,919 --> 00:27:40,159
at and so they weaponize those documents

793
00:27:40,159 --> 00:27:43,520
and those applications against them

794
00:27:43,520 --> 00:27:49,840
thank you okay

