1
00:00:00,709 --> 00:00:03,990
excellent so I would like to introduce

2
00:00:03,990 --> 00:00:06,210
our next speaker

3
00:00:06,210 --> 00:00:08,790
Jerome Segura from Malwarebytes we'll be

4
00:00:08,790 --> 00:00:10,800
presenting from drive-by download to

5
00:00:10,800 --> 00:00:12,929
drive by mining understanding the new

6
00:00:12,929 --> 00:00:14,849
paradigm we could have a round of

7
00:00:14,849 --> 00:00:22,310
applause welcome to Ron Thank You Chet

8
00:00:22,310 --> 00:00:25,650
all right so I'm a superior searcher at

9
00:00:25,650 --> 00:00:28,619
Malibu it's my area of focus is web

10
00:00:28,619 --> 00:00:30,960
threats anything from malvit izing

11
00:00:30,960 --> 00:00:34,710
exploit kits and something new in the

12
00:00:34,710 --> 00:00:36,899
last year or so that i'm going to talk

13
00:00:36,899 --> 00:00:42,350
about today so the web threat landscape

14
00:00:42,350 --> 00:00:45,239
has really changed in the last I'd say

15
00:00:45,239 --> 00:00:48,629
maybe two three years we're used to be

16
00:00:48,629 --> 00:00:51,510
dominated by drive-by download attacks

17
00:00:51,510 --> 00:00:54,930
expertise in particular and it's changed

18
00:00:54,930 --> 00:00:57,270
dramatically where you know the same

19
00:00:57,270 --> 00:00:58,800
exploit kids have lost their firepower

20
00:00:58,800 --> 00:01:01,289
and it was interesting talked earlier by

21
00:01:01,289 --> 00:01:03,229
Gabor where we see a lot of is exploits

22
00:01:03,229 --> 00:01:06,960
actually go on to you know being office

23
00:01:06,960 --> 00:01:09,080
exploits instead of being web exploits

24
00:01:09,080 --> 00:01:12,990
but in the meantime and you know we've

25
00:01:12,990 --> 00:01:15,390
been talking about crypto miners it's

26
00:01:15,390 --> 00:01:16,409
probably you know one of the most

27
00:01:16,409 --> 00:01:18,180
identified threats out there

28
00:01:18,180 --> 00:01:21,509
they're everywhere web technologies have

29
00:01:21,509 --> 00:01:25,229
evolved this out coins as well and you

30
00:01:25,229 --> 00:01:27,689
know that has made some changes possible

31
00:01:27,689 --> 00:01:30,150
where mining is happening at a different

32
00:01:30,150 --> 00:01:32,880
scale but also interestingly inside of

33
00:01:32,880 --> 00:01:35,729
your browser which you may not think

34
00:01:35,729 --> 00:01:37,530
it's possible but actually that's work

35
00:01:37,530 --> 00:01:39,380
pretty well

36
00:01:39,380 --> 00:01:43,170
so in browser mining or browser-based

37
00:01:43,170 --> 00:01:46,140
mining has been kind of proposed as the

38
00:01:46,140 --> 00:01:50,189
replacement for ads but so far and as

39
00:01:50,189 --> 00:01:51,439
I'm going to show in this presentation

40
00:01:51,439 --> 00:01:53,189
most of what we've seen has been

41
00:01:53,189 --> 00:01:57,420
criminal uses but first of all let's

42
00:01:57,420 --> 00:01:59,790
talk about exploit kits browser exploit

43
00:01:59,790 --> 00:02:01,710
kits I think there was a time where we

44
00:02:01,710 --> 00:02:03,600
just exploit kits but now we have to

45
00:02:03,600 --> 00:02:06,000
specify you know is it web-based or is

46
00:02:06,000 --> 00:02:09,690
it office based the typical drive-by

47
00:02:09,690 --> 00:02:12,030
download scenario this is a very simple

48
00:02:12,030 --> 00:02:13,390
flowchart

49
00:02:13,390 --> 00:02:14,800
you have a website that has been

50
00:02:14,800 --> 00:02:18,190
injected or maybe is showing a malicious

51
00:02:18,190 --> 00:02:20,740
advert there's some kind of traffic or

52
00:02:20,740 --> 00:02:22,380
direction maybe a TDS involved

53
00:02:22,380 --> 00:02:26,260
redirecting your browser to an exploit

54
00:02:26,260 --> 00:02:30,340
landing page and on that page there are

55
00:02:30,340 --> 00:02:32,770
vulnerabilities for your browser or one

56
00:02:32,770 --> 00:02:36,370
of its plugins that will try and exploit

57
00:02:36,370 --> 00:02:37,810
the vulnerability to download malware

58
00:02:37,810 --> 00:02:41,500
and the payout is once the malware is

59
00:02:41,500 --> 00:02:43,810
installed and that's how criminals make

60
00:02:43,810 --> 00:02:47,010
money per install perfect him and

61
00:02:47,010 --> 00:02:50,350
obviously it's very dependent on the

62
00:02:50,350 --> 00:02:54,910
kind of exploits we can use exploit kids

63
00:02:54,910 --> 00:02:57,430
were there was a time when they were be

64
00:02:57,430 --> 00:02:59,760
more important most important threats

65
00:02:59,760 --> 00:03:04,000
and for variety of reasons but mostly

66
00:03:04,000 --> 00:03:06,400
because there were so many exploits

67
00:03:06,400 --> 00:03:08,590
available so many zero days you know

68
00:03:08,590 --> 00:03:11,080
there are unpatched vulnerabilities that

69
00:03:11,080 --> 00:03:13,840
would come you know back-to-back you'd

70
00:03:13,840 --> 00:03:15,400
have Internet Explorer you have Flash

71
00:03:15,400 --> 00:03:18,880
Player and so this constant you know

72
00:03:18,880 --> 00:03:21,340
addition of new exploits was really

73
00:03:21,340 --> 00:03:24,070
creating those powerful tools that were

74
00:03:24,070 --> 00:03:27,190
dreaded by everybody and you know we

75
00:03:27,190 --> 00:03:29,260
were witnessing really large drive-by

76
00:03:29,260 --> 00:03:32,049
download campaigns on top publishers via

77
00:03:32,049 --> 00:03:35,380
malvert izing for example and you know

78
00:03:35,380 --> 00:03:37,420
for me it was very interested in exploit

79
00:03:37,420 --> 00:03:39,459
kids these were interesting times like

80
00:03:39,459 --> 00:03:42,070
we were not you know doing nothing we

81
00:03:42,070 --> 00:03:43,420
were very busy tracking all of that

82
00:03:43,420 --> 00:03:47,799
stuff but in the last few years there

83
00:03:47,799 --> 00:03:51,090
have been changes in a particular

84
00:03:51,090 --> 00:03:56,650
browser market share so in these graphs

85
00:03:56,650 --> 00:04:00,489
you see the market share for IE such

86
00:04:00,489 --> 00:04:03,100
that covers about five years where these

87
00:04:03,100 --> 00:04:04,750
are worldwide numbers about thirty

88
00:04:04,750 --> 00:04:07,470
percent down to eight percent and

89
00:04:07,470 --> 00:04:09,370
something similar with the flash player

90
00:04:09,370 --> 00:04:12,340
over twenty percent and now under five

91
00:04:12,340 --> 00:04:14,920
percent and this is pretty significant

92
00:04:14,920 --> 00:04:17,560
because it means the surface of attack

93
00:04:17,560 --> 00:04:21,488
is a lot more reduced and therefore

94
00:04:21,488 --> 00:04:23,710
exploits have lost a lot of their

95
00:04:23,710 --> 00:04:26,280
firepower

96
00:04:26,980 --> 00:04:30,200
at the same time there have been some

97
00:04:30,200 --> 00:04:32,860
major players that have been taken out

98
00:04:32,860 --> 00:04:35,780
for example the black hole creator ponch

99
00:04:35,780 --> 00:04:38,360
was arrested the nuclear expert kids

100
00:04:38,360 --> 00:04:40,570
vanished after security researchers

101
00:04:40,570 --> 00:04:46,310
exposed it and more recently in 2016 the

102
00:04:46,310 --> 00:04:48,110
angular expert kids which was dominant

103
00:04:48,110 --> 00:04:51,980
just disappeared in June and that really

104
00:04:51,980 --> 00:04:55,010
created a void where maybe there could

105
00:04:55,010 --> 00:04:56,720
have been competitors that would have

106
00:04:56,720 --> 00:04:59,450
come up and taken advantage of that void

107
00:04:59,450 --> 00:05:02,930
but nobody really did instead what we

108
00:05:02,930 --> 00:05:07,400
saw is existing exploit kids not really

109
00:05:07,400 --> 00:05:10,160
innovating but just continuing user

110
00:05:10,160 --> 00:05:14,120
older and stale exploits and also some

111
00:05:14,120 --> 00:05:17,210
of these exploit kids were leaked there

112
00:05:17,210 --> 00:05:19,100
were public dumps and then we saw you

113
00:05:19,100 --> 00:05:21,950
know less sophisticated actors that took

114
00:05:21,950 --> 00:05:22,310
them

115
00:05:22,310 --> 00:05:24,740
copy the code pasted it give it a new

116
00:05:24,740 --> 00:05:26,780
name and advertise it in underground

117
00:05:26,780 --> 00:05:29,900
forms but I mean the main takeaway here

118
00:05:29,900 --> 00:05:34,880
is really no innovation and that's kind

119
00:05:34,880 --> 00:05:38,810
of resulted in frustration from the

120
00:05:38,810 --> 00:05:41,300
malware distributors themselves this is

121
00:05:41,300 --> 00:05:43,930
a screenshot of a forum post where

122
00:05:43,930 --> 00:05:46,160
malware distributor is complaining

123
00:05:46,160 --> 00:05:48,860
saying expert kids are a waste of money

124
00:05:48,860 --> 00:05:51,020
when you thrown in the trash

125
00:05:51,020 --> 00:05:52,880
especially in rich countries you just

126
00:05:52,880 --> 00:05:55,640
can't infect users any more using those

127
00:05:55,640 --> 00:05:58,940
stale exploits and it's just not

128
00:05:58,940 --> 00:06:01,250
profitable for them to use this as a

129
00:06:01,250 --> 00:06:03,500
delivery method they have to use spam or

130
00:06:03,500 --> 00:06:08,240
some other technique but having said

131
00:06:08,240 --> 00:06:12,770
that in 2018 things have been a bit

132
00:06:12,770 --> 00:06:14,419
interesting if you've been looking at

133
00:06:14,419 --> 00:06:17,090
expert kids and I think part of it is

134
00:06:17,090 --> 00:06:19,669
because we've seen a few new zero-days

135
00:06:19,669 --> 00:06:22,460
which was unexpected for Internet

136
00:06:22,460 --> 00:06:25,010
Explorer and the Flash Player so even

137
00:06:25,010 --> 00:06:26,750
though it you know the market share

138
00:06:26,750 --> 00:06:30,770
hasn't gone back the availability of

139
00:06:30,770 --> 00:06:33,680
this zero-days made it you know

140
00:06:33,680 --> 00:06:38,240
interesting to use in certain geographic

141
00:06:38,240 --> 00:06:41,830
vacations for example in Asia where

142
00:06:41,830 --> 00:06:44,270
Internet Explorer is still fairly use

143
00:06:44,270 --> 00:06:46,730
like in South Korea or Japan I think

144
00:06:46,730 --> 00:06:49,460
it's about 30% in South Korea and Japan

145
00:06:49,460 --> 00:06:54,410
is also a bit of usage and so we've seen

146
00:06:54,410 --> 00:06:57,580
existing exploit kids incorporate those

147
00:06:57,580 --> 00:07:00,980
those new zero days which you know they

148
00:07:00,980 --> 00:07:05,420
were proof of concepts for and also new

149
00:07:05,420 --> 00:07:08,720
exploit kids so you know at this point

150
00:07:08,720 --> 00:07:11,000
in time I don't think we can close the

151
00:07:11,000 --> 00:07:13,070
chapter yet on exploit kids

152
00:07:13,070 --> 00:07:14,420
it's not over there's still something

153
00:07:14,420 --> 00:07:17,960
going on but definitely it's not what it

154
00:07:17,960 --> 00:07:24,710
used to be in the mean time in the last

155
00:07:24,710 --> 00:07:27,350
few years there's been a lot of

156
00:07:27,350 --> 00:07:29,120
developments with cryptocurrencies and

157
00:07:29,120 --> 00:07:35,210
technologies and crypto mining has

158
00:07:35,210 --> 00:07:38,540
really taken off so Bitcoin mining of

159
00:07:38,540 --> 00:07:39,980
course has been going on for many years

160
00:07:39,980 --> 00:07:44,990
but you know it's become so difficult to

161
00:07:44,990 --> 00:07:47,960
mine that only particular farms with

162
00:07:47,960 --> 00:07:50,740
particular hardware can do it but

163
00:07:50,740 --> 00:07:53,960
nevertheless in 2017 the value of

164
00:07:53,960 --> 00:07:56,660
Bitcoin skyrocketed to $20,000 almost

165
00:07:56,660 --> 00:08:01,880
and by doing that also you know led to a

166
00:08:01,880 --> 00:08:05,630
lot of other cryptocurrencies as out

167
00:08:05,630 --> 00:08:08,480
coins to also gain value with a big

168
00:08:08,480 --> 00:08:10,010
difference is that those currencies can

169
00:08:10,010 --> 00:08:14,360
be mined on average computers and they

170
00:08:14,360 --> 00:08:17,300
also offer better anonymity which is

171
00:08:17,300 --> 00:08:19,870
something that criminals obviously like

172
00:08:19,870 --> 00:08:23,690
also in 2017 double if recede develops

173
00:08:23,690 --> 00:08:26,780
the web assembly technology that allows

174
00:08:26,780 --> 00:08:29,750
code to run at native speed within the

175
00:08:29,750 --> 00:08:32,270
browser this is an important development

176
00:08:32,270 --> 00:08:35,000
for the web and a good development but

177
00:08:35,000 --> 00:08:36,230
at the same time it opened up this

178
00:08:36,230 --> 00:08:39,799
opportunity to to mine in the browser

179
00:08:39,799 --> 00:08:43,220
which was possible before but with

180
00:08:43,220 --> 00:08:48,110
obviously severe performance hits so

181
00:08:48,110 --> 00:08:50,720
let's talk about in browser miners and

182
00:08:50,720 --> 00:08:51,889
I'm going to take the example of

183
00:08:51,889 --> 00:08:56,379
five it's a browser minor API for Manero

184
00:08:56,379 --> 00:08:58,279
probably one of the most common

185
00:08:58,279 --> 00:08:59,449
cryptocurrencies

186
00:08:59,449 --> 00:09:03,769
and you know it's it advertises that as

187
00:09:03,769 --> 00:09:07,429
a monetization tool for your website so

188
00:09:07,429 --> 00:09:10,100
your webmaster you want to make some

189
00:09:10,100 --> 00:09:12,019
money from your traffic you copy and

190
00:09:12,019 --> 00:09:15,109
paste a bit of JavaScript and people

191
00:09:15,109 --> 00:09:19,249
that visit the page will be mining for

192
00:09:19,249 --> 00:09:20,689
that cryptocurrencies and you will earn

193
00:09:20,689 --> 00:09:23,029
the money for it they take a 30%

194
00:09:23,029 --> 00:09:25,879
commission but people think coin I've

195
00:09:25,879 --> 00:09:28,369
created this thing but they didn't the

196
00:09:28,369 --> 00:09:32,029
concept is actually older and it was a

197
00:09:32,029 --> 00:09:34,369
group of students at MIT that kind of

198
00:09:34,369 --> 00:09:37,100
you know developed this this concept of

199
00:09:37,100 --> 00:09:38,419
hey you know this could be an

200
00:09:38,419 --> 00:09:41,839
alternative to advertisements it didn't

201
00:09:41,839 --> 00:09:43,249
go well for them they got sued and

202
00:09:43,249 --> 00:09:46,189
eventually they you know they they stuck

203
00:09:46,189 --> 00:09:48,559
on the idea but I think coin hive came

204
00:09:48,559 --> 00:09:50,600
at the right time with developments of

205
00:09:50,600 --> 00:09:53,629
alkynes and web assembly and you know

206
00:09:53,629 --> 00:09:57,160
that took off in a very big way

207
00:09:57,160 --> 00:10:00,019
unfortunately what we saw was that it

208
00:10:00,019 --> 00:10:03,439
was also abused almost overnight the

209
00:10:03,439 --> 00:10:06,739
graph shows the number of connections to

210
00:10:06,739 --> 00:10:09,259
coin hive and I believe it was the fall

211
00:10:09,259 --> 00:10:10,540
of 2017

212
00:10:10,540 --> 00:10:14,029
that Malibu I saw and on average it was

213
00:10:14,029 --> 00:10:17,419
eight million connections to coin higher

214
00:10:17,419 --> 00:10:20,089
calm that we were seeing per day which

215
00:10:20,089 --> 00:10:25,069
is pretty huge so let's talk about the

216
00:10:25,069 --> 00:10:26,869
abuse of browser-based mining because

217
00:10:26,869 --> 00:10:28,879
Bursa based mining is completely

218
00:10:28,879 --> 00:10:30,889
legitimate it's okay to mine and it's

219
00:10:30,889 --> 00:10:33,199
okay to mine in the browser but what is

220
00:10:33,199 --> 00:10:35,660
not okay is what we call drive-by mining

221
00:10:35,660 --> 00:10:38,569
also known as crypto jacking so drive-by

222
00:10:38,569 --> 00:10:41,329
binding is this process which is

223
00:10:41,329 --> 00:10:44,329
platform agnostic I mean it can run on a

224
00:10:44,329 --> 00:10:47,809
Mac or Windows PC or on a mobile device

225
00:10:47,809 --> 00:10:51,739
and it starts with a website that has

226
00:10:51,739 --> 00:10:55,249
been injected if a compromise or an

227
00:10:55,249 --> 00:10:57,439
advert or something else that injects

228
00:10:57,439 --> 00:11:00,470
into it has a bit of JavaScript that

229
00:11:00,470 --> 00:11:03,289
calls the web mining API which there are

230
00:11:03,289 --> 00:11:05,150
many available coin hive is one

231
00:11:05,150 --> 00:11:08,600
coin hemp crypto loot and others that

232
00:11:08,600 --> 00:11:11,000
downloads webassembly code which is the

233
00:11:11,000 --> 00:11:13,670
binary that's gonna perform the mining

234
00:11:13,670 --> 00:11:16,790
operation in the browser and then what

235
00:11:16,790 --> 00:11:19,220
you see from the user point of view is

236
00:11:19,220 --> 00:11:23,360
you see your CPU will spike and you know

237
00:11:23,360 --> 00:11:25,730
depending on if it's criminally used or

238
00:11:25,730 --> 00:11:29,870
not it could spite you 100% but the

239
00:11:29,870 --> 00:11:31,730
person doesn't really matter what

240
00:11:31,730 --> 00:11:34,670
matters is that this happens silently

241
00:11:34,670 --> 00:11:38,060
without your consent and eventually the

242
00:11:38,060 --> 00:11:41,779
payout is you have the bad guys that are

243
00:11:41,779 --> 00:11:44,960
making money typically Monero and that

244
00:11:44,960 --> 00:11:48,310
fuels you know the cyber crime economy

245
00:11:48,310 --> 00:11:50,060
so I'll talk a little bit about

246
00:11:50,060 --> 00:11:52,700
something that for me really defines the

247
00:11:52,700 --> 00:11:55,910
starting point of Drybar mining which is

248
00:11:55,910 --> 00:11:59,810
the Pirate Bay so in September 2017 the

249
00:11:59,810 --> 00:12:00,440
Pirate Bay

250
00:12:00,440 --> 00:12:02,150
they weren't hacked but they decided to

251
00:12:02,150 --> 00:12:05,630
try out this thing of we're gonna run

252
00:12:05,630 --> 00:12:09,650
coin hive on our site the problem is

253
00:12:09,650 --> 00:12:12,709
they did not inform their users and it

254
00:12:12,709 --> 00:12:13,970
didn't take very long before somebody

255
00:12:13,970 --> 00:12:16,820
say hey you know something is weird I'm

256
00:12:16,820 --> 00:12:18,529
on this page and my CPUs a hundred

257
00:12:18,529 --> 00:12:20,470
percent I don't know what's going on and

258
00:12:20,470 --> 00:12:23,000
then a lot of people complain about it

259
00:12:23,000 --> 00:12:26,690
and you know people are okay supporting

260
00:12:26,690 --> 00:12:29,330
the Pirate Bay this big fans of it but

261
00:12:29,330 --> 00:12:31,430
they really didn't like that they were

262
00:12:31,430 --> 00:12:34,160
running this code that they had never

263
00:12:34,160 --> 00:12:36,110
seen before and hijacking all their

264
00:12:36,110 --> 00:12:37,790
resources that did not go well

265
00:12:37,790 --> 00:12:40,100
so for me this is important when we look

266
00:12:40,100 --> 00:12:42,050
at you know the crypto jackin phenomenon

267
00:12:42,050 --> 00:12:44,120
to say hey the Pirate Bay is really what

268
00:12:44,120 --> 00:12:48,890
started it so from a traffic point of

269
00:12:48,890 --> 00:12:51,709
view I'm a big fan of the Fidler web

270
00:12:51,709 --> 00:12:54,589
debugger myself and it allows me to see

271
00:12:54,589 --> 00:12:56,750
what's going on behind the scenes and I

272
00:12:56,750 --> 00:12:59,870
just wanted to show you know what does

273
00:12:59,870 --> 00:13:03,500
browser-based mining implies so first of

274
00:13:03,500 --> 00:13:05,720
all you have you know the website or

275
00:13:05,720 --> 00:13:10,279
page you're on it has a bit of

276
00:13:10,279 --> 00:13:14,030
JavaScript code which contains typically

277
00:13:14,030 --> 00:13:17,329
a link to the service you're using for

278
00:13:17,329 --> 00:13:18,300
mining

279
00:13:18,300 --> 00:13:21,450
and perhaps some parameters maybe the

280
00:13:21,450 --> 00:13:24,510
how much CPU you want to use but more

281
00:13:24,510 --> 00:13:28,200
importantly licky where the the profits

282
00:13:28,200 --> 00:13:30,660
from mining are gonna go to and then the

283
00:13:30,660 --> 00:13:36,270
second session is the mining API

284
00:13:36,270 --> 00:13:39,380
provider so in this example coin hive

285
00:13:39,380 --> 00:13:43,260
that's the library the library is long

286
00:13:43,260 --> 00:13:45,800
piece of JavaScript that also contains

287
00:13:45,800 --> 00:13:49,560
inline web assembly code and the web

288
00:13:49,560 --> 00:13:53,760
assembly which is a dot Weiser module is

289
00:13:53,760 --> 00:13:57,420
what's going to run the the mining into

290
00:13:57,420 --> 00:14:00,360
your browser and the last thing we see

291
00:14:00,360 --> 00:14:04,730
number three is a WebSocket connection

292
00:14:04,730 --> 00:14:08,760
to their back-end which essentially is a

293
00:14:08,760 --> 00:14:11,580
way for your browser to communicate with

294
00:14:11,580 --> 00:14:14,340
the mining API to receive the tasks and

295
00:14:14,340 --> 00:14:17,520
send completed tasks and that's kind of

296
00:14:17,520 --> 00:14:19,860
a dual communication mechanism that's

297
00:14:19,860 --> 00:14:22,560
really important so this is in three

298
00:14:22,560 --> 00:14:25,050
simple steps what happens when you go to

299
00:14:25,050 --> 00:14:28,290
a website does that in browser mining so

300
00:14:28,290 --> 00:14:31,020
this is an example of coin hive here we

301
00:14:31,020 --> 00:14:34,230
see a crypto loot same same procedure

302
00:14:34,230 --> 00:14:35,820
the code looks a bit different

303
00:14:35,820 --> 00:14:40,590
obfuscated this is coin hemp again

304
00:14:40,590 --> 00:14:45,120
similar and this is I believe perfect

305
00:14:45,120 --> 00:14:45,480
miner

306
00:14:45,480 --> 00:14:49,050
I didn't mention that but by far coin

307
00:14:49,050 --> 00:14:51,690
hive is still the leader in terms of you

308
00:14:51,690 --> 00:14:53,250
know service that provides browser-based

309
00:14:53,250 --> 00:14:56,940
mining but you know in the wake of this

310
00:14:56,940 --> 00:14:59,070
new phenomenon to have in a lot of other

311
00:14:59,070 --> 00:15:03,710
you know competitors and copycats now

312
00:15:03,710 --> 00:15:06,300
let's talk about some high profile cases

313
00:15:06,300 --> 00:15:11,520
and campaigns so you know whenever is

314
00:15:11,520 --> 00:15:13,230
something new a new phenomenon usually

315
00:15:13,230 --> 00:15:15,840
you're gonna see abuse and you know

316
00:15:15,840 --> 00:15:19,710
that's what you know is gonna define the

317
00:15:19,710 --> 00:15:22,170
scope of this thing is this limited you

318
00:15:22,170 --> 00:15:24,090
know to some few web sites or is this

319
00:15:24,090 --> 00:15:26,100
something that's impacting a lot of

320
00:15:26,100 --> 00:15:28,579
users well

321
00:15:28,579 --> 00:15:30,290
there are a lot of cases for example

322
00:15:30,290 --> 00:15:33,860
YouTube the double-click ad that was

323
00:15:33,860 --> 00:15:37,879
serving a coin hive mining you'd be

324
00:15:37,879 --> 00:15:39,259
watching the YouTube video and at the

325
00:15:39,259 --> 00:15:40,519
same time you were mining you didn't

326
00:15:40,519 --> 00:15:42,199
know that pretty big considering its

327
00:15:42,199 --> 00:15:46,069
YouTube other ad networks were also

328
00:15:46,069 --> 00:15:49,339
abused to serve coin hive Starbucks

329
00:15:49,339 --> 00:15:51,649
believe it was in Brazil with a free

330
00:15:51,649 --> 00:15:54,529
Wi-Fi also giving you you know some

331
00:15:54,529 --> 00:15:57,619
mining tasks to do and more importantly

332
00:15:57,619 --> 00:16:01,069
a lot of video streaming websites I've

333
00:16:01,069 --> 00:16:03,379
been using that they haven't been hacked

334
00:16:03,379 --> 00:16:05,509
we're doing it on purpose to monetize

335
00:16:05,509 --> 00:16:07,369
obviously but these are an interesting

336
00:16:07,369 --> 00:16:09,860
category and definitely by far the most

337
00:16:09,860 --> 00:16:15,049
common users of browser miners which is

338
00:16:15,049 --> 00:16:16,699
interesting because they are also

339
00:16:16,699 --> 00:16:19,519
generating the most traffic and people

340
00:16:19,519 --> 00:16:21,199
tend to spend a lot of time on those

341
00:16:21,199 --> 00:16:25,129
pages and you know crypto miners are a

342
00:16:25,129 --> 00:16:26,420
bit different than a typical malware

343
00:16:26,420 --> 00:16:28,220
infection where you in fact once and

344
00:16:28,220 --> 00:16:29,480
then you can you know that's it

345
00:16:29,480 --> 00:16:32,049
the job is done with a browser miner the

346
00:16:32,049 --> 00:16:34,429
longer you run it the more profit you

347
00:16:34,429 --> 00:16:36,860
make so you have you know it's all on

348
00:16:36,860 --> 00:16:38,449
your advantage to have people stay on

349
00:16:38,449 --> 00:16:41,499
the webpage for as long as possible and

350
00:16:41,499 --> 00:16:43,699
then there have been attacks that have

351
00:16:43,699 --> 00:16:47,660
been very opportunistic in nature for

352
00:16:47,660 --> 00:16:50,179
example Drupal the popular content

353
00:16:50,179 --> 00:16:54,970
management system suffered back-to-back

354
00:16:54,970 --> 00:16:58,489
critical vulnerabilities and you know

355
00:16:58,489 --> 00:17:00,860
like we see WordPress or theirs they

356
00:17:00,860 --> 00:17:04,819
usually get exploited pretty rapidly in

357
00:17:04,819 --> 00:17:08,799
the wild and that was the case here and

358
00:17:08,799 --> 00:17:12,859
what we saw is attackers you know user

359
00:17:12,859 --> 00:17:14,510
miners both on the server side they're

360
00:17:14,510 --> 00:17:17,029
running the Linux binaries to mine and

361
00:17:17,029 --> 00:17:19,339
on the client side they were injecting

362
00:17:19,339 --> 00:17:22,220
Drupal web sites with mining code as

363
00:17:22,220 --> 00:17:24,250
well so they're monetizing both sides

364
00:17:24,250 --> 00:17:27,619
and this was different from you know the

365
00:17:27,619 --> 00:17:29,630
lot of of the cases we saw where you

366
00:17:29,630 --> 00:17:32,630
know Jim Bob's website was hacked and

367
00:17:32,630 --> 00:17:34,480
had coin hive because this was you know

368
00:17:34,480 --> 00:17:37,580
perpetrated by the same actors targeting

369
00:17:37,580 --> 00:17:40,630
larger scale

370
00:17:40,630 --> 00:17:45,299
and then perhaps the biggest to date

371
00:17:45,299 --> 00:17:47,440
drop by mining incident has been

372
00:17:47,440 --> 00:17:51,610
happening on routers this was initially

373
00:17:51,610 --> 00:17:55,900
discovered by Spyder labs Simon Kenan we

374
00:17:55,900 --> 00:17:58,990
found that an exploit for a mikrotik

375
00:17:58,990 --> 00:18:01,630
router which is a particular brand of

376
00:18:01,630 --> 00:18:04,600
router and had been patched months ago

377
00:18:04,600 --> 00:18:06,910
was being exploited in the wild and a

378
00:18:06,910 --> 00:18:10,510
pretty large scale I believe the current

379
00:18:10,510 --> 00:18:13,510
numbers are still two hundred thousand

380
00:18:13,510 --> 00:18:15,130
or so routers that have been compromised

381
00:18:15,130 --> 00:18:17,140
and injected not only with coin high but

382
00:18:17,140 --> 00:18:20,350
other types of miners as well so what's

383
00:18:20,350 --> 00:18:21,640
particularly interesting about this one

384
00:18:21,640 --> 00:18:24,580
is rather than infect individual

385
00:18:24,580 --> 00:18:27,400
websites where you run the risk of users

386
00:18:27,400 --> 00:18:29,860
leaving the website and then the mining

387
00:18:29,860 --> 00:18:32,409
activity stops when you compromise the

388
00:18:32,409 --> 00:18:34,659
router you compromise the entire

389
00:18:34,659 --> 00:18:37,539
browsing session no matter wherever you

390
00:18:37,539 --> 00:18:39,070
know they travel throughout you know the

391
00:18:39,070 --> 00:18:41,500
different web sites and also the fact

392
00:18:41,500 --> 00:18:43,990
that compromised one router you have

393
00:18:43,990 --> 00:18:46,210
many users behind that router that are

394
00:18:46,210 --> 00:18:48,100
served Internet so that's a pretty good

395
00:18:48,100 --> 00:18:54,190
idea just a few odds observations that

396
00:18:54,190 --> 00:18:56,799
we made as well our good friends the

397
00:18:56,799 --> 00:19:00,070
text report scammers using the fake

398
00:19:00,070 --> 00:19:02,740
browser worker pages they were also

399
00:19:02,740 --> 00:19:04,990
writing coin hive which kind of

400
00:19:04,990 --> 00:19:05,590
surprised me

401
00:19:05,590 --> 00:19:10,600
so as you're waiting on the page your

402
00:19:10,600 --> 00:19:15,429
computer is mining and this websites

403
00:19:15,429 --> 00:19:19,240
which had nine web miners in that same

404
00:19:19,240 --> 00:19:23,260
page which makes no sense I mean one web

405
00:19:23,260 --> 00:19:24,820
miner can consume a hundred percent of

406
00:19:24,820 --> 00:19:27,789
your CPU I put nine like there's only so

407
00:19:27,789 --> 00:19:30,159
much CPU available so I don't know what

408
00:19:30,159 --> 00:19:32,500
they're trying to accomplish here but it

409
00:19:32,500 --> 00:19:39,400
was right and this site so this site was

410
00:19:39,400 --> 00:19:41,770
interesting because they used the

411
00:19:41,770 --> 00:19:44,860
legitimate opt-in version of coin hire

412
00:19:44,860 --> 00:19:48,520
which is called of mine and so you were

413
00:19:48,520 --> 00:19:50,860
presented with this prompt saying hey do

414
00:19:50,860 --> 00:19:52,120
you want to allow us to mind while

415
00:19:52,120 --> 00:19:53,180
you're visiting our page

416
00:19:53,180 --> 00:19:57,470
and the problem is they were also

417
00:19:57,470 --> 00:20:00,140
running the silent corner of API at the

418
00:20:00,140 --> 00:20:02,150
same time so ever you said yes or no

419
00:20:02,150 --> 00:20:08,059
you'd be mining anyway so now let's talk

420
00:20:08,059 --> 00:20:09,470
about some evasion and persistence

421
00:20:09,470 --> 00:20:11,270
techniques because like every new

422
00:20:11,270 --> 00:20:12,890
phenomenon what you're gonna see in the

423
00:20:12,890 --> 00:20:15,860
beginning is criminals jump on it they

424
00:20:15,860 --> 00:20:17,930
don't offer skate anything and then

425
00:20:17,930 --> 00:20:20,360
security vendors catch up and so they

426
00:20:20,360 --> 00:20:23,660
have to adapt as well so you know in the

427
00:20:23,660 --> 00:20:26,510
beginning it was easy to just use the

428
00:20:26,510 --> 00:20:29,090
coin hive service and nobody was

429
00:20:29,090 --> 00:20:30,830
blocking it I mean we were one of the

430
00:20:30,830 --> 00:20:33,290
few in Mahwah bytes who kind of foresaw

431
00:20:33,290 --> 00:20:36,170
the misfit new phenomenon and started

432
00:20:36,170 --> 00:20:37,850
blocking coin I have right away and

433
00:20:37,850 --> 00:20:39,260
that's why we saw you know such high

434
00:20:39,260 --> 00:20:42,890
numbers but in the weeks later what we

435
00:20:42,890 --> 00:20:46,790
saw is you know the bad guys realized

436
00:20:46,790 --> 00:20:49,760
well kkona hive comm is blocked so we've

437
00:20:49,760 --> 00:20:51,380
got to use something else so they use

438
00:20:51,380 --> 00:20:55,550
proxies they used cloud services the

439
00:20:55,550 --> 00:20:57,350
thing with those is you can't blacklist

440
00:20:57,350 --> 00:20:59,860
those because obviously if you black is

441
00:20:59,860 --> 00:21:03,590
Google oz then your black sting a bunch

442
00:21:03,590 --> 00:21:07,010
of legitimate web services they're free

443
00:21:07,010 --> 00:21:10,010
they're disposable so a blacklist

444
00:21:10,010 --> 00:21:13,070
approach to blocking crypto jacking is

445
00:21:13,070 --> 00:21:15,200
not efficient there have been studies

446
00:21:15,200 --> 00:21:16,970
actually showing that you know the

447
00:21:16,970 --> 00:21:19,730
popular extensions or tools out there

448
00:21:19,730 --> 00:21:21,860
only block about twenty to thirty

449
00:21:21,860 --> 00:21:26,600
percent and that's a problem in the

450
00:21:26,600 --> 00:21:27,850
screenshots you see the same website

451
00:21:27,850 --> 00:21:31,250
first using coin hype calm and then

452
00:21:31,250 --> 00:21:34,970
switching to a hostname under now that

453
00:21:34,970 --> 00:21:36,890
CH which use a web service that's free

454
00:21:36,890 --> 00:21:40,580
and they kept changing the host name and

455
00:21:40,580 --> 00:21:42,080
then you're playing the cat-and-mouse

456
00:21:42,080 --> 00:21:48,340
game and then you have sites that use

457
00:21:48,340 --> 00:21:52,400
CPU evasion techniques you know a

458
00:21:52,400 --> 00:21:54,650
popular symptom of browser mining or

459
00:21:54,650 --> 00:21:56,540
mining in general is high CPU

460
00:21:56,540 --> 00:21:58,760
consumption so if your CPU expect that a

461
00:21:58,760 --> 00:22:00,350
hard percent and you're not actually

462
00:22:00,350 --> 00:22:02,480
doing anything chances are there is a

463
00:22:02,480 --> 00:22:06,020
miner on your machine so what you can do

464
00:22:06,020 --> 00:22:06,830
is throw

465
00:22:06,830 --> 00:22:09,880
that mining activity - under the 50% and

466
00:22:09,880 --> 00:22:12,590
also ensure that only one miner runs at

467
00:22:12,590 --> 00:22:14,179
the same time you kill the all the other

468
00:22:14,179 --> 00:22:17,029
miners and if you do that if you're

469
00:22:17,029 --> 00:22:21,710
doing a behavior rural approach on you

470
00:22:21,710 --> 00:22:24,440
know the CPU activity this is perfectly

471
00:22:24,440 --> 00:22:25,789
normal it was going to fly under the

472
00:22:25,789 --> 00:22:31,370
radar now another interesting one is

473
00:22:31,370 --> 00:22:33,980
string efficient which you know I study

474
00:22:33,980 --> 00:22:36,200
a lot of web threats and I see that a

475
00:22:36,200 --> 00:22:38,929
lot I mean everything to me is

476
00:22:38,929 --> 00:22:41,809
officiated base64 some other Association

477
00:22:41,809 --> 00:22:44,120
there's really ever something that's in

478
00:22:44,120 --> 00:22:46,429
clear text in the beginning everything

479
00:22:46,429 --> 00:22:47,389
was in clear text

480
00:22:47,389 --> 00:22:49,940
you know the coin hype comm all of that

481
00:22:49,940 --> 00:22:52,669
you just browse the Dom and it was right

482
00:22:52,669 --> 00:22:56,000
there but again that's something that's

483
00:22:56,000 --> 00:22:59,149
easy to detect so what we're seeing now

484
00:22:59,149 --> 00:23:01,070
is pretty much everything is obfuscated

485
00:23:01,070 --> 00:23:06,350
double efficient the web assembly module

486
00:23:06,350 --> 00:23:08,720
is also it's in line but it's office

487
00:23:08,720 --> 00:23:11,510
gated and you know if you're trying to

488
00:23:11,510 --> 00:23:14,240
target particular strings within you

489
00:23:14,240 --> 00:23:15,409
know the source code you're not gonna

490
00:23:15,409 --> 00:23:17,830
see anything

491
00:23:18,639 --> 00:23:21,019
another interesting technique that we

492
00:23:21,019 --> 00:23:25,789
observed was the use of pop-unders which

493
00:23:25,789 --> 00:23:27,830
I've been you know going on for four

494
00:23:27,830 --> 00:23:30,260
years it's not something new but

495
00:23:30,260 --> 00:23:32,539
interesting concept nonetheless when it

496
00:23:32,539 --> 00:23:36,230
applies to browser mining the idea is

497
00:23:36,230 --> 00:23:37,700
you know you go to your website usually

498
00:23:37,700 --> 00:23:41,000
I saw those on streaming websites when

499
00:23:41,000 --> 00:23:43,179
you click with an on click event and

500
00:23:43,179 --> 00:23:46,309
there's a pop under that go hides under

501
00:23:46,309 --> 00:23:48,830
your taskbar I don't know if you can see

502
00:23:48,830 --> 00:23:51,289
it well here I in Windows 10 you can

503
00:23:51,289 --> 00:23:53,750
allow transparency the pop under is

504
00:23:53,750 --> 00:23:56,029
under the clock you can actually close

505
00:23:56,029 --> 00:23:58,970
it you can see it though so what happens

506
00:23:58,970 --> 00:24:02,000
is user on the site they close their

507
00:24:02,000 --> 00:24:03,440
browser or they go to a different page

508
00:24:03,440 --> 00:24:06,559
but the mining activity continues for as

509
00:24:06,559 --> 00:24:08,510
long as that pop under is there so that

510
00:24:08,510 --> 00:24:13,000
was pretty clever yeah

511
00:24:14,180 --> 00:24:16,580
so rapidly let's talk about legitimate

512
00:24:16,580 --> 00:24:20,540
uses of in-browser mining these are our

513
00:24:20,540 --> 00:24:23,870
numbers from the last month of the

514
00:24:23,870 --> 00:24:26,840
silent coin high of API versus their

515
00:24:26,840 --> 00:24:29,630
opt-in of mine

516
00:24:29,630 --> 00:24:31,760
it's from our telemetry so results may

517
00:24:31,760 --> 00:24:34,160
differ of course but what we see is the

518
00:24:34,160 --> 00:24:37,460
ratio is pretty clear the Sinai dpi of

519
00:24:37,460 --> 00:24:40,730
connive is by far dominating legitimate

520
00:24:40,730 --> 00:24:43,550
use cases with off mine very very few

521
00:24:43,550 --> 00:24:46,670
and to me that represents part of the

522
00:24:46,670 --> 00:24:49,820
problem of why we see so much criminal

523
00:24:49,820 --> 00:24:54,050
use and why you know drop by mining from

524
00:24:54,050 --> 00:24:56,720
the get-go was almost destined to be

525
00:24:56,720 --> 00:24:59,930
abused is because that same silent API

526
00:24:59,930 --> 00:25:02,390
has been kept in business and obviously

527
00:25:02,390 --> 00:25:03,890
you know if Cohen hive had come up and

528
00:25:03,890 --> 00:25:06,350
say well we're gonna force opt in for

529
00:25:06,350 --> 00:25:08,600
everything we definitely see a lot of

530
00:25:08,600 --> 00:25:11,540
these abuse and there are other

531
00:25:11,540 --> 00:25:14,180
cryptocurrencies like GSC coin that have

532
00:25:14,180 --> 00:25:16,010
taken a very different approach where

533
00:25:16,010 --> 00:25:20,000
they say all that we allow is the by

534
00:25:20,000 --> 00:25:22,340
user obtained by choice and that to me

535
00:25:22,340 --> 00:25:27,350
makes a lot more sense also you know the

536
00:25:27,350 --> 00:25:29,300
argument that in browser mining could

537
00:25:29,300 --> 00:25:32,210
replace advertisements well it doesn't

538
00:25:32,210 --> 00:25:34,910
make that much money it makes a lot less

539
00:25:34,910 --> 00:25:37,010
money than than ads there's been a few

540
00:25:37,010 --> 00:25:39,350
white papers on the topic which say well

541
00:25:39,350 --> 00:25:41,600
as still make a lot more money unless

542
00:25:41,600 --> 00:25:43,070
you have a site that has a lot of

543
00:25:43,070 --> 00:25:45,050
traffic where users will spend a long

544
00:25:45,050 --> 00:25:45,530
time

545
00:25:45,530 --> 00:25:50,050
it's very negligible and unfortunately

546
00:25:50,050 --> 00:25:53,840
even the opt-in version of coin hive can

547
00:25:53,840 --> 00:25:57,100
be abused we've seen cases where salon

548
00:25:57,100 --> 00:25:59,840
said hey there's a you're using another

549
00:25:59,840 --> 00:26:02,900
blocker we're gonna mine so you can

550
00:26:02,900 --> 00:26:05,840
consume our contents and you know give

551
00:26:05,840 --> 00:26:08,840
us some revenue but then even though you

552
00:26:08,840 --> 00:26:10,580
consented to it your CPU expect a

553
00:26:10,580 --> 00:26:12,560
hundred percent you could not even

554
00:26:12,560 --> 00:26:14,960
normally visit their website so again

555
00:26:14,960 --> 00:26:18,050
you know poor implementation even of the

556
00:26:18,050 --> 00:26:21,860
legitimate API so to me they're still a

557
00:26:21,860 --> 00:26:25,610
long road ahead for legitimate in

558
00:26:25,610 --> 00:26:27,030
browser mining

559
00:26:27,030 --> 00:26:29,940
yes it can be an alternative to ads if

560
00:26:29,940 --> 00:26:32,610
done properly for sure we need user

561
00:26:32,610 --> 00:26:35,610
consent that's the you know the baseline

562
00:26:35,610 --> 00:26:37,860
users after you're obtained otherwise it

563
00:26:37,860 --> 00:26:40,410
is drive-by mining it's it's you know

564
00:26:40,410 --> 00:26:43,500
it's a criminal use and you have to

565
00:26:43,500 --> 00:26:46,860
respect the user CPU you know it's not

566
00:26:46,860 --> 00:26:50,430
okay to use 100% of the CPU but we also

567
00:26:50,430 --> 00:26:53,610
need to change that negative image that

568
00:26:53,610 --> 00:26:55,860
browser-based mining has gained since

569
00:26:55,860 --> 00:26:58,500
the very beginning and how is that gonna

570
00:26:58,500 --> 00:27:01,440
work when there's so much more criminal

571
00:27:01,440 --> 00:27:05,960
use cases than legitimate use cases I

572
00:27:06,050 --> 00:27:10,170
think also the the future of

573
00:27:10,170 --> 00:27:12,960
browser-based mining is gonna depend on

574
00:27:12,960 --> 00:27:14,550
what we see with the value of

575
00:27:14,550 --> 00:27:17,880
cryptocurrencies definitely you know in

576
00:27:17,880 --> 00:27:21,240
the fall of 2017 this was made possible

577
00:27:21,240 --> 00:27:23,820
because Bitcoin went so high and

578
00:27:23,820 --> 00:27:26,100
everybody got like fever cryptocurrency

579
00:27:26,100 --> 00:27:28,260
fever it was like that's mine that's

580
00:27:28,260 --> 00:27:33,000
mine you know in 2018 a woman went down

581
00:27:33,000 --> 00:27:36,570
quite a bit and I think you know we're

582
00:27:36,570 --> 00:27:39,930
seeing a bit less activity so to me you

583
00:27:39,930 --> 00:27:42,450
know if again we see a spike with the

584
00:27:42,450 --> 00:27:44,160
value of cryptocurrencies we're gonna

585
00:27:44,160 --> 00:27:47,520
see an interest in all sorts of miners

586
00:27:47,520 --> 00:27:49,590
whether the in in browser or binary

587
00:27:49,590 --> 00:27:53,280
based you know typical miners so in

588
00:27:53,280 --> 00:27:58,220
summary draw by mining emerged as

589
00:27:58,220 --> 00:28:01,920
cryptocurrencies gain value and as web

590
00:28:01,920 --> 00:28:04,800
technologies improved we would not be

591
00:28:04,800 --> 00:28:07,170
doing that if we had if we did not have

592
00:28:07,170 --> 00:28:09,750
webassembly and WebSockets and all of

593
00:28:09,750 --> 00:28:12,210
that that's you know that makes it

594
00:28:12,210 --> 00:28:15,360
possible and also because I think you

595
00:28:15,360 --> 00:28:19,830
know in terms of web threats like I

596
00:28:19,830 --> 00:28:21,630
mentioned the browser market share now

597
00:28:21,630 --> 00:28:23,240
is dominated by Google Chrome and

598
00:28:23,240 --> 00:28:25,260
exploits drive-by downloads don't work

599
00:28:25,260 --> 00:28:27,000
on Chrome right I mean we haven't seen

600
00:28:27,000 --> 00:28:29,160
really many so exploit kids are kind of

601
00:28:29,160 --> 00:28:31,860
an IE thing only so in chrome you gotta

602
00:28:31,860 --> 00:28:34,980
have other threats and you know drive-by

603
00:28:34,980 --> 00:28:37,950
mining is a big one and we also see that

604
00:28:37,950 --> 00:28:40,470
it attackers opportunistic

605
00:28:40,470 --> 00:28:43,700
whenever there's a new vulnerability

606
00:28:43,700 --> 00:28:47,310
whether it's in a CMS or you know an IOT

607
00:28:47,310 --> 00:28:49,590
device is gonna get exploited and they

608
00:28:49,590 --> 00:28:51,150
really like this and they'd like to do

609
00:28:51,150 --> 00:28:53,550
it at scale and of course scaling is

610
00:28:53,550 --> 00:28:54,960
really what's gonna make money with

611
00:28:54,960 --> 00:28:58,730
crypto mining and of course you know

612
00:28:58,730 --> 00:29:01,560
criminals have fully engaged in evasion

613
00:29:01,560 --> 00:29:04,140
techniques that's perfectly normal we

614
00:29:04,140 --> 00:29:07,500
expected that and current defenses

615
00:29:07,500 --> 00:29:09,720
against browser-based mining are not

616
00:29:09,720 --> 00:29:11,850
working I'm not saying they're not good

617
00:29:11,850 --> 00:29:14,670
black lists are part of your you know

618
00:29:14,670 --> 00:29:16,530
protection model but they're not

619
00:29:16,530 --> 00:29:18,990
sufficient and there still needs to be

620
00:29:18,990 --> 00:29:22,140
more work done into heuristic based

621
00:29:22,140 --> 00:29:23,880
protection behavior based protection

622
00:29:23,880 --> 00:29:26,940
which is going to be tricky based on you

623
00:29:26,940 --> 00:29:28,890
know what just said about these various

624
00:29:28,890 --> 00:29:34,380
evasion techniques and that's it if you

625
00:29:34,380 --> 00:29:36,980
have any questions

