1
00:00:00,030 --> 00:00:02,399
all right if you could take your seats

2
00:00:02,399 --> 00:00:08,099
and thank you for attending we're gonna

3
00:00:08,099 --> 00:00:09,809
hear my Paul and Warren from Cisco

4
00:00:09,809 --> 00:00:11,940
Dallas talk to us about Olympic

5
00:00:11,940 --> 00:00:14,610
destroyer take it away guys hey guys

6
00:00:14,610 --> 00:00:16,560
thanks all for coming so we actually

7
00:00:16,560 --> 00:00:18,720
Tunes the title a little bit our title

8
00:00:18,720 --> 00:00:20,640
was originally who wasn't responsible

9
00:00:20,640 --> 00:00:21,510
for a limit destroyer

10
00:00:21,510 --> 00:00:23,970
we will very much cover that but we also

11
00:00:23,970 --> 00:00:26,220
just realized that attribution is a

12
00:00:26,220 --> 00:00:28,199
complete circus so we're gonna go

13
00:00:28,199 --> 00:00:30,060
through some of the naivety that exist

14
00:00:30,060 --> 00:00:31,320
and some of the complications that come

15
00:00:31,320 --> 00:00:33,450
up with it so Paul's gonna do half and

16
00:00:33,450 --> 00:00:34,739
I'm gonna do half and well will flick

17
00:00:34,739 --> 00:00:38,040
through sue obligatory Who am I I'm

18
00:00:38,040 --> 00:00:39,719
security researcher with Cisco towels

19
00:00:39,719 --> 00:00:42,180
Paul and I worked together on lots of

20
00:00:42,180 --> 00:00:44,340
interesting different apt stuff for the

21
00:00:44,340 --> 00:00:46,800
last three or four years I like you're

22
00:00:46,800 --> 00:00:48,059
gonna malware finder like pretty much

23
00:00:48,059 --> 00:00:49,070
everyone in this room

24
00:00:49,070 --> 00:00:51,210
my background is network engineering

25
00:00:51,210 --> 00:00:52,739
moved into malware analysis threat

26
00:00:52,739 --> 00:00:54,989
intelligence and if anyone ever wants to

27
00:00:54,989 --> 00:00:56,969
tan I'm cool fine or be sighs Belfast so

28
00:00:56,969 --> 00:00:58,920
I'll be very happy if you wanted to chat

29
00:00:58,920 --> 00:01:02,219
and talk about that alejandra port works

30
00:01:02,219 --> 00:01:06,540
yes it works fine so my name is Bert as

31
00:01:06,540 --> 00:01:08,700
you can hear them I'm French but like

32
00:01:08,700 --> 00:01:10,860
the previous speakers said to me two

33
00:01:10,860 --> 00:01:13,470
hours ago for my English it's not my

34
00:01:13,470 --> 00:01:18,330
fault it's cuz I'm French so yeah I'm

35
00:01:18,330 --> 00:01:20,280
marijuana distance rich researcher at

36
00:01:20,280 --> 00:01:22,530
Cisco Terrace so basically I work on a

37
00:01:22,530 --> 00:01:25,350
lot of different apt related stuff don't

38
00:01:25,350 --> 00:01:27,869
go it besides Belfast go at BOTS

39
00:01:27,869 --> 00:01:29,790
confessor conference I organized of

40
00:01:29,790 --> 00:01:32,790
course cuz Island is shitty its range of

41
00:01:32,790 --> 00:01:38,159
the time extra kala lie Nala lie so come

42
00:01:38,159 --> 00:01:41,549
in France the food a beta of course and

43
00:01:41,549 --> 00:01:43,619
we have windup Guiness yeah everything

44
00:01:43,619 --> 00:01:44,009
is better

45
00:01:44,009 --> 00:01:46,620
we have dinners in versus arty

46
00:01:46,620 --> 00:01:51,510
you got Liam Guinness yeah so more

47
00:01:51,510 --> 00:01:53,280
seriously we are here to speak about on

48
00:01:53,280 --> 00:01:54,180
MP destroyer

49
00:01:54,180 --> 00:01:57,360
so everything start by this article for

50
00:01:57,360 --> 00:01:59,340
me I really Thomas and they I think

51
00:01:59,340 --> 00:02:02,310
something like that and it looks when I

52
00:02:02,310 --> 00:02:04,140
read it it looks something interesting

53
00:02:04,140 --> 00:02:06,660
so I started to work on the era stuff to

54
00:02:06,660 --> 00:02:09,449
maybe find it if I was lucky

55
00:02:09,449 --> 00:02:11,400
how will it bring you why I was lucky

56
00:02:11,400 --> 00:02:16,170
and how powerful we are and just to have

57
00:02:16,170 --> 00:02:18,630
an idea of the real impact about this

58
00:02:18,630 --> 00:02:23,070
case is the ring the ceremony the

59
00:02:23,070 --> 00:02:26,190
opening ceremony website was an

60
00:02:26,190 --> 00:02:29,160
available ticket system well done so

61
00:02:29,160 --> 00:02:30,900
people are not able to print it get to

62
00:02:30,900 --> 00:02:35,610
to go inside of off any big game and the

63
00:02:35,610 --> 00:02:38,220
Wi-Fi was unavailable on some part of

64
00:02:38,220 --> 00:02:41,040
the organization and it was done during

65
00:02:41,040 --> 00:02:43,800
few few hours so it could be worse

66
00:02:43,800 --> 00:02:46,560
because finally everything worked and

67
00:02:46,560 --> 00:02:49,020
the ceremony was here it was it was

68
00:02:49,020 --> 00:02:52,290
streamed everywhere on the world etc but

69
00:02:52,290 --> 00:02:55,440
there is a real impact on this case on

70
00:02:55,440 --> 00:03:01,320
local people in in South Korea so here I

71
00:03:01,320 --> 00:03:03,480
don't even know why we translate it I

72
00:03:03,480 --> 00:03:07,910
think everybody is able to read but it's

73
00:03:07,910 --> 00:03:12,090
text from incident response team manager

74
00:03:12,090 --> 00:03:16,980
on this incident and 50 internal server

75
00:03:16,980 --> 00:03:22,590
was impacted by this malware so included

76
00:03:22,590 --> 00:03:25,430
Active Directory and database servers so

77
00:03:25,430 --> 00:03:28,700
sensitive server as you can imagine and

78
00:03:28,700 --> 00:03:33,239
Olympic game organization has around 300

79
00:03:33,239 --> 00:03:36,630
service so it's not all the servers but

80
00:03:36,630 --> 00:03:40,500
it's a large part anyway so how works of

81
00:03:40,500 --> 00:03:46,190
Marwa it's very similar from

82
00:03:46,190 --> 00:03:48,750
architecture part of use and what we saw

83
00:03:48,750 --> 00:03:51,090
in the past like I want to cry not pitch

84
00:03:51,090 --> 00:03:53,550
extra so you have the malware that scan

85
00:03:53,550 --> 00:03:54,750
your internal network

86
00:03:54,750 --> 00:03:59,310
he used legitimate protocol you

87
00:03:59,310 --> 00:04:01,260
by every system and mr. otto in the

88
00:04:01,260 --> 00:04:04,610
world like PS exact w a knife already

89
00:04:04,610 --> 00:04:07,080
standard normal here provided by

90
00:04:07,080 --> 00:04:10,530
microsoft and try to propagate inside of

91
00:04:10,530 --> 00:04:14,970
the network so it's not magic you cannot

92
00:04:14,970 --> 00:04:16,829
go from a machine to another machine

93
00:04:16,829 --> 00:04:18,690
without any credential and stuff like

94
00:04:18,690 --> 00:04:20,839
that so the Marwin need to have some

95
00:04:20,839 --> 00:04:25,080
information Hue's several trick to get

96
00:04:25,080 --> 00:04:27,740
this information the first one she

97
00:04:27,740 --> 00:04:31,550
implemented a browser steerer so every

98
00:04:31,550 --> 00:04:34,680
username and password are coded on the

99
00:04:34,680 --> 00:04:37,220
brothers Chrome Firefox Internet

100
00:04:37,220 --> 00:04:41,280
Explorer was exfiltrated was collected

101
00:04:41,280 --> 00:04:44,130
by the malware and this created a

102
00:04:44,130 --> 00:04:46,229
dictionary of password and try

103
00:04:46,229 --> 00:04:48,780
propagation with this password because

104
00:04:48,780 --> 00:04:50,340
as you know everybody use the same

105
00:04:50,340 --> 00:04:52,889
password everywhere so that's why he

106
00:04:52,889 --> 00:04:57,300
take brought up as well another way to

107
00:04:57,300 --> 00:05:01,850
get password on system it's to steal

108
00:05:01,850 --> 00:05:06,210
system password credential ash so to do

109
00:05:06,210 --> 00:05:08,910
that the malware huge mimikatz it's a

110
00:05:08,910 --> 00:05:12,180
very famous open-source tool to perform

111
00:05:12,180 --> 00:05:14,610
pass oh hush so to get hash from memory

112
00:05:14,610 --> 00:05:17,850
and to jump on another machine and he

113
00:05:17,850 --> 00:05:19,620
simply repackage mimikatz

114
00:05:19,620 --> 00:05:23,700
and use it like that to get a stop

115
00:05:23,700 --> 00:05:28,169
password on on the system once he get

116
00:05:28,169 --> 00:05:30,300
hold this password she created

117
00:05:30,300 --> 00:05:33,840
dictionary lists and patch himself so

118
00:05:33,840 --> 00:05:37,260
itself he patched the malware add this

119
00:05:37,260 --> 00:05:40,620
credential and this copy was sent to the

120
00:05:40,620 --> 00:05:43,200
next server executed and the same thing

121
00:05:43,200 --> 00:05:47,070
was performed new password was add on

122
00:05:47,070 --> 00:05:49,139
the list and etc so Moultonborough is

123
00:05:49,139 --> 00:05:52,650
executed more you have after it password

124
00:05:52,650 --> 00:05:58,530
inside of the binary finally the main

125
00:05:58,530 --> 00:06:01,380
goal of what we named olympic destroyer

126
00:06:01,380 --> 00:06:02,760
is to destroy the machine i will

127
00:06:02,760 --> 00:06:04,710
describe you exactly the different step

128
00:06:04,710 --> 00:06:09,690
for destruction and yeah here is a

129
00:06:09,690 --> 00:06:12,590
screenshot of password stealer

130
00:06:12,590 --> 00:06:15,860
basically sure he the brothers used the

131
00:06:15,860 --> 00:06:19,400
SPLA light database we simply perform

132
00:06:19,400 --> 00:06:22,400
query to get last well and everything

133
00:06:22,400 --> 00:06:24,800
was sent by a named pipe to the main

134
00:06:24,800 --> 00:06:29,990
module here he is the mimikatz code so

135
00:06:29,990 --> 00:06:33,820
basically it's it's how it format

136
00:06:33,820 --> 00:06:39,020
credential and here is on the binary I

137
00:06:39,020 --> 00:06:42,080
analyzed first the opcode it password so

138
00:06:42,080 --> 00:06:44,450
first when I open the document I thought

139
00:06:44,450 --> 00:06:47,090
Z as a binary I thought the attacker

140
00:06:47,090 --> 00:06:49,550
already had some password but in fact

141
00:06:49,550 --> 00:06:53,300
it's bass well stolen from a previous

142
00:06:53,300 --> 00:06:55,820
execution so it was executed on the

143
00:06:55,820 --> 00:06:58,490
first machine and the sample hi had

144
00:06:58,490 --> 00:07:02,000
access was not the first initial one but

145
00:07:02,000 --> 00:07:04,610
another one if you check on VG for

146
00:07:04,610 --> 00:07:07,910
example you can have sample we as the

147
00:07:07,910 --> 00:07:09,890
killer boom boom so the last name of the

148
00:07:09,890 --> 00:07:12,290
Vitesse and ducks inside of the binary

149
00:07:12,290 --> 00:07:14,570
so i think there is a kind of infinite

150
00:07:14,570 --> 00:07:17,840
loop so you send sample to VT VT

151
00:07:17,840 --> 00:07:20,030
executed in sandbox generate a new

152
00:07:20,030 --> 00:07:22,400
binary with viticulture this one is sent

153
00:07:22,400 --> 00:07:24,560
to VT which is exhibited in sender so I

154
00:07:24,560 --> 00:07:27,560
think it cost some resource to VT to

155
00:07:27,560 --> 00:07:31,330
under this sample and yeah if you want

156
00:07:31,330 --> 00:07:34,340
breaking news and something we don't

157
00:07:34,340 --> 00:07:37,520
disclose on our publication how I detect

158
00:07:37,520 --> 00:07:41,050
this malware my yahuwah's function

159
00:07:41,050 --> 00:07:43,910
so really simplest URL we've ever

160
00:07:43,910 --> 00:07:44,300
written

161
00:07:44,300 --> 00:07:47,330
yes during Olympic game a crater yahood

162
00:07:47,330 --> 00:07:50,390
wisp reaction cause why not and luckily

163
00:07:50,390 --> 00:07:54,380
the domain the real domain of Olympic

164
00:07:54,380 --> 00:07:57,260
game organizer his Pyeongchang 2018 so

165
00:07:57,260 --> 00:08:04,490
that's how I found it here he is like a

166
00:08:04,490 --> 00:08:07,180
little bit like previous speaker said

167
00:08:07,180 --> 00:08:11,840
the Marat destroy Shadow Copy so

168
00:08:11,840 --> 00:08:13,820
snapshot performed by Windows are

169
00:08:13,820 --> 00:08:18,650
destroyed and he destroyed backup on the

170
00:08:18,650 --> 00:08:22,220
system and something very interesting it

171
00:08:22,220 --> 00:08:25,490
does not wipe the local file but he

172
00:08:25,490 --> 00:08:26,520
Wi-Fi

173
00:08:26,520 --> 00:08:31,050
on chef folder so not local stuff but if

174
00:08:31,050 --> 00:08:35,159
you map a file on your server or laptop

175
00:08:35,159 --> 00:08:38,010
he would destroy a file on this chef

176
00:08:38,010 --> 00:08:38,719
folder

177
00:08:38,719 --> 00:08:42,089
basically on company every important

178
00:08:42,089 --> 00:08:43,740
fight I'm not store locally you can lost

179
00:08:43,740 --> 00:08:45,930
your laptop you can be stolen whatever

180
00:08:45,930 --> 00:08:47,640
if they don't care everything is put on

181
00:08:47,640 --> 00:08:51,089
the chef and in this case the matter a

182
00:08:51,089 --> 00:08:56,399
target share so it's very common for for

183
00:08:56,399 --> 00:09:00,570
for wiper he destroyed a boot club boot

184
00:09:00,570 --> 00:09:04,920
recovery and as on previous case he

185
00:09:04,920 --> 00:09:07,500
destroyed event lock so same thing is to

186
00:09:07,500 --> 00:09:13,589
annoy forensic investigation and there's

187
00:09:13,589 --> 00:09:16,829
our stuff this one is less common the

188
00:09:16,829 --> 00:09:19,410
malware list every windows services and

189
00:09:19,410 --> 00:09:22,410
switch off each services one after one

190
00:09:22,410 --> 00:09:25,740
extra so basically your system cannot

191
00:09:25,740 --> 00:09:27,510
boot anymore if you if whole your

192
00:09:27,510 --> 00:09:34,440
service are disabled so this is where it

193
00:09:34,440 --> 00:09:36,450
could really quite funny for us and we

194
00:09:36,450 --> 00:09:37,560
obviously published a lot of information

195
00:09:37,560 --> 00:09:40,050
on let me destroy at the time obviously

196
00:09:40,050 --> 00:09:41,520
what came out that similar to what mom

197
00:09:41,520 --> 00:09:43,050
was talking about earlier researchers

198
00:09:43,050 --> 00:09:45,029
will continue concepts and ideas that

199
00:09:45,029 --> 00:09:46,410
have been published and all their

200
00:09:46,410 --> 00:09:48,089
information to find out more information

201
00:09:48,089 --> 00:09:50,399
which is cool so this is sort of what

202
00:09:50,399 --> 00:09:51,899
happened after we published about lamp

203
00:09:51,899 --> 00:09:53,670
destroyer Kaspersky came out with a

204
00:09:53,670 --> 00:09:55,500
great report some I became I with an

205
00:09:55,500 --> 00:09:56,820
interesting report about other elements

206
00:09:56,820 --> 00:09:58,920
and we started to look at it a bit more

207
00:09:58,920 --> 00:10:00,360
and this is where we came up with that

208
00:10:00,360 --> 00:10:01,740
who was responsible for another

209
00:10:01,740 --> 00:10:06,000
destroyer portion who the media circus

210
00:10:06,000 --> 00:10:09,230
started like this definitely North Korea

211
00:10:09,230 --> 00:10:11,130
actually no it wasn't North Korea

212
00:10:11,130 --> 00:10:12,420
definitely wasn't North Korea it was

213
00:10:12,420 --> 00:10:14,970
definitely China and I went from China

214
00:10:14,970 --> 00:10:17,160
to Russia so we just named three nations

215
00:10:17,160 --> 00:10:19,079
today it's just for the fun of it in the

216
00:10:19,079 --> 00:10:21,630
media and King denote the we didn't

217
00:10:21,630 --> 00:10:24,240
point out or name any nation states are

218
00:10:24,240 --> 00:10:26,339
out to be disdain anyone at the time but

219
00:10:26,339 --> 00:10:27,779
this is how it sort of started for us to

220
00:10:27,779 --> 00:10:29,520
when you see different reports coming

221
00:10:29,520 --> 00:10:30,630
out from different companies different

222
00:10:30,630 --> 00:10:32,490
vendors and different researchers you

223
00:10:32,490 --> 00:10:33,990
start looking back the trial understand

224
00:10:33,990 --> 00:10:35,130
well did we miss something or what

225
00:10:35,130 --> 00:10:36,720
further information could we ascertain

226
00:10:36,720 --> 00:10:38,430
and this is where we started to look at

227
00:10:38,430 --> 00:10:40,080
the links that were being talked about

228
00:10:40,080 --> 00:10:42,960
sooo Lazarus group magnetically

229
00:10:42,960 --> 00:10:44,550
discussed by lots of people all the time

230
00:10:44,550 --> 00:10:47,370
and one of the overlaps that we started

231
00:10:47,370 --> 00:10:49,560
to see was some of the blue north mal

232
00:10:49,560 --> 00:10:51,330
were used by Lazarus group for some of

233
00:10:51,330 --> 00:10:53,090
the swift infrastructure bank heists and

234
00:10:53,090 --> 00:10:56,070
that was a very very simple one so again

235
00:10:56,070 --> 00:10:58,530
when you Charlie the attribution I mean

236
00:10:58,530 --> 00:11:00,660
one thought was brilliant and the whole

237
00:11:00,660 --> 00:11:02,790
idea here is attribution never lets us

238
00:11:02,790 --> 00:11:05,070
win we don't ever win because we can't

239
00:11:05,070 --> 00:11:06,450
generally do anything about it is the

240
00:11:06,450 --> 00:11:08,820
research organization as a van der as a

241
00:11:08,820 --> 00:11:11,460
company et cetera law enforcement of the

242
00:11:11,460 --> 00:11:12,330
people who need to win and that's

243
00:11:12,330 --> 00:11:13,740
ultimately the people we need to try and

244
00:11:13,740 --> 00:11:16,590
engage layers with etc add back to the

245
00:11:16,590 --> 00:11:17,220
Metallica

246
00:11:17,220 --> 00:11:20,670
so EVT chk was a string that existed in

247
00:11:20,670 --> 00:11:22,770
the blue north group malware samples I

248
00:11:22,770 --> 00:11:26,280
think of his EBT chkl but dot text and I

249
00:11:26,280 --> 00:11:27,960
think this similarly used the dot text

250
00:11:27,960 --> 00:11:30,660
inputs ooh a small link but one that

251
00:11:30,660 --> 00:11:32,190
maybe points out this could be something

252
00:11:32,190 --> 00:11:34,230
related similarly using finally in

253
00:11:34,230 --> 00:11:35,340
patterns because it's something that

254
00:11:35,340 --> 00:11:38,400
exists attackers continue to be lazy the

255
00:11:38,400 --> 00:11:41,310
CM wiper crude sooner we were wiped the

256
00:11:41,310 --> 00:11:42,900
first thousand bytes of the largest

257
00:11:42,900 --> 00:11:44,700
files identified they didn't wipe

258
00:11:44,700 --> 00:11:46,620
everything like some of the malware

259
00:11:46,620 --> 00:11:48,060
that's a higher discuss was about wiping

260
00:11:48,060 --> 00:11:50,130
whole files who infrastructures whole

261
00:11:50,130 --> 00:11:52,830
systems olymic destroyer from a local

262
00:11:52,830 --> 00:11:54,750
perspective was trying to wipe out small

263
00:11:54,750 --> 00:11:56,670
sets of files the reason for this is

264
00:11:56,670 --> 00:11:59,070
speed the Viking wiped things quickly I

265
00:11:59,070 --> 00:12:01,080
can move on to the next file quickly etc

266
00:12:01,080 --> 00:12:02,690
etc so these are some of the

267
00:12:02,690 --> 00:12:04,440
responsibilities that lied with it that

268
00:12:04,440 --> 00:12:06,270
we start at the overlap and then

269
00:12:06,270 --> 00:12:09,020
Kaspersky came out with a great report

270
00:12:09,020 --> 00:12:11,670
sukhasan steam at grid started looking

271
00:12:11,670 --> 00:12:15,150
at rich header information now we look

272
00:12:15,150 --> 00:12:16,680
at malware all the time how many people

273
00:12:16,680 --> 00:12:18,150
honestly ever looked at rich header

274
00:12:18,150 --> 00:12:22,740
stuff so like excellent except costly

275
00:12:22,740 --> 00:12:24,420
because he doesn't kind this purpose at

276
00:12:24,420 --> 00:12:26,730
so we're like one other guy it's not

277
00:12:26,730 --> 00:12:28,800
something that I generally do I do think

278
00:12:28,800 --> 00:12:29,760
it's something you generally do

279
00:12:29,760 --> 00:12:31,380
generally you get the header to make

280
00:12:31,380 --> 00:12:33,420
sure it's a readable file type of it's

281
00:12:33,420 --> 00:12:35,070
not as it corrupted has it been tampered

282
00:12:35,070 --> 00:12:35,430
with

283
00:12:35,430 --> 00:12:38,160
is it sabotage can you fix it etc but

284
00:12:38,160 --> 00:12:39,900
know that the guys at Kaspersky quite

285
00:12:39,900 --> 00:12:42,960
quite rightly pointed out that the two

286
00:12:42,960 --> 00:12:45,990
rich I don't have a pointer sorry the

287
00:12:45,990 --> 00:12:48,720
two overlap and cool bases that exist

288
00:12:48,720 --> 00:12:51,660
here within them are pretty much all of

289
00:12:51,660 --> 00:12:53,070
the rich text header nor the poem with

290
00:12:53,070 --> 00:12:53,870
rich tax errors

291
00:12:53,870 --> 00:12:55,850
very very undocumented which again is

292
00:12:55,850 --> 00:12:57,200
why maybe not a lot of people would cut

293
00:12:57,200 --> 00:12:57,440
it

294
00:12:57,440 --> 00:12:59,089
but what Kaspersky discovered is on the

295
00:12:59,089 --> 00:13:01,250
left we see the blue North sample sushi

296
00:13:01,250 --> 00:13:02,870
with laser script and on the right

297
00:13:02,870 --> 00:13:04,580
dynamic destroyer samples we published

298
00:13:04,580 --> 00:13:06,650
it but right down until the last like

299
00:13:06,650 --> 00:13:08,540
four bites it's completely identical

300
00:13:08,540 --> 00:13:10,730
that's not something that happens by

301
00:13:10,730 --> 00:13:11,330
accident

302
00:13:11,330 --> 00:13:14,930
it just is not an accidental outcome of

303
00:13:14,930 --> 00:13:17,060
compilation and when you actually start

304
00:13:17,060 --> 00:13:18,770
to look at the code what Eugene

305
00:13:18,770 --> 00:13:20,600
Kaspersky did they identified that

306
00:13:20,600 --> 00:13:22,640
whenever you decode the information

307
00:13:22,640 --> 00:13:24,470
related to the rich text header you

308
00:13:24,470 --> 00:13:26,930
actually start to understand water was

309
00:13:26,930 --> 00:13:30,020
compiled by so the blue north sample as

310
00:13:30,020 --> 00:13:31,370
you see on the left and the Olympic

311
00:13:31,370 --> 00:13:32,990
short sample on the right would suggest

312
00:13:32,990 --> 00:13:35,960
that were identified and compiled by the

313
00:13:35,960 --> 00:13:39,710
just to do 2003 what you see the VC to

314
00:13:39,710 --> 00:13:42,529
say the VC six element but in actuality

315
00:13:42,529 --> 00:13:45,830
it's an AK 64-bit compiled platform that

316
00:13:45,830 --> 00:13:48,860
was compiled and Visual Studio 2010 so

317
00:13:48,860 --> 00:13:50,000
what's all that what's the point of all

318
00:13:50,000 --> 00:13:51,260
that was a point to discuss in rich text

319
00:13:51,260 --> 00:13:54,170
format well it was completely copy

320
00:13:54,170 --> 00:13:56,330
pasted and I was a complete fabricated

321
00:13:56,330 --> 00:13:57,560
header there was nothing real about it

322
00:13:57,560 --> 00:13:59,540
from a compilation perspective that

323
00:13:59,540 --> 00:14:01,459
rings alarm bells from each straightaway

324
00:14:01,459 --> 00:14:03,320
and shoot all right in the world so

325
00:14:03,320 --> 00:14:05,360
that's our first sort of interpretation

326
00:14:05,360 --> 00:14:07,790
of multiple false flags that existed

327
00:14:07,790 --> 00:14:11,300
within Olympic destroyer and then we

328
00:14:11,300 --> 00:14:14,180
moved on to and some output from insert

329
00:14:14,180 --> 00:14:15,740
labs who think are about here this

330
00:14:15,740 --> 00:14:17,839
week's through insert labs write a very

331
00:14:17,839 --> 00:14:20,450
nice code similarity platform and insert

332
00:14:20,450 --> 00:14:20,839
labs

333
00:14:20,839 --> 00:14:22,370
published some information about the

334
00:14:22,370 --> 00:14:26,150
kotrina existed so apt 3 para PI an apt

335
00:14:26,150 --> 00:14:28,760
10 men you pass well they also wanted

336
00:14:28,760 --> 00:14:29,990
the genome on this party of a longer

337
00:14:29,990 --> 00:14:31,459
destroyer because they also had cooled

338
00:14:31,459 --> 00:14:33,890
over a lab that existed so similarities

339
00:14:33,890 --> 00:14:35,630
that we were able identify were

340
00:14:35,630 --> 00:14:37,580
credential stealers so this was open

341
00:14:37,580 --> 00:14:39,890
source code which could mean it was or

342
00:14:39,890 --> 00:14:42,020
wasn't a false flag they could have been

343
00:14:42,020 --> 00:14:43,550
an actor who reused to see em open

344
00:14:43,550 --> 00:14:45,290
source code they alternatively could

345
00:14:45,290 --> 00:14:46,580
have been an actor who deliberately put

346
00:14:46,580 --> 00:14:48,470
that in that there are multiple outcomes

347
00:14:48,470 --> 00:14:50,000
that can exist there and then

348
00:14:50,000 --> 00:14:52,100
similarities and the AAS function an apt

349
00:14:52,100 --> 00:14:54,560
10 and one thing to point out about the

350
00:14:54,560 --> 00:14:56,360
apt handling that is the only time

351
00:14:56,360 --> 00:14:59,029
that's been identified so maybe it forms

352
00:14:59,029 --> 00:15:00,290
a stronger link that this could be a

353
00:15:00,290 --> 00:15:02,839
relation to a PT 10 but then why can't

354
00:15:02,839 --> 00:15:04,790
it be related to a PT 3 or why can't it

355
00:15:04,790 --> 00:15:06,740
be the laser script so we start to see

356
00:15:06,740 --> 00:15:07,520
this combination

357
00:15:07,520 --> 00:15:11,540
a false flag buildup happen and then we

358
00:15:11,540 --> 00:15:14,900
seen what we dog nieta not patty with

359
00:15:14,900 --> 00:15:17,060
the same propagation technique Perce

360
00:15:17,060 --> 00:15:19,340
exact WMI using mimic huts that became

361
00:15:19,340 --> 00:15:21,740
very very prevalent and samples and

362
00:15:21,740 --> 00:15:23,270
attacks that we've seen over the last 18

363
00:15:23,270 --> 00:15:26,900
months we've seen WMI used multiple

364
00:15:26,900 --> 00:15:29,540
attacks to have the warm and propagation

365
00:15:29,540 --> 00:15:31,880
technique to allow you to go from box a

366
00:15:31,880 --> 00:15:34,310
box be too boxy again this one mentioned

367
00:15:34,310 --> 00:15:35,840
automated operations become very

368
00:15:35,840 --> 00:15:37,190
important for these type of skill

369
00:15:37,190 --> 00:15:39,170
attacks you can't just drop a box and

370
00:15:39,170 --> 00:15:42,320
wait for a remote user to access it and

371
00:15:42,320 --> 00:15:44,540
then carry on moving around living off

372
00:15:44,540 --> 00:15:45,860
the land on that infrastructure when

373
00:15:45,860 --> 00:15:47,150
you've got automated operations like

374
00:15:47,150 --> 00:15:49,340
this you need code that can go off and

375
00:15:49,340 --> 00:15:50,450
do that and this is where worm

376
00:15:50,450 --> 00:15:52,900
propagation type cout comes in and

377
00:15:52,900 --> 00:15:54,770
seeing where the transfer still in

378
00:15:54,770 --> 00:15:56,300
credentials to me and me and pipe so

379
00:15:56,300 --> 00:15:58,280
again many cats if anyone has ever

380
00:15:58,280 --> 00:15:59,690
looked at many cats you'll see that the

381
00:15:59,690 --> 00:16:01,190
proof of concept code is out there the

382
00:16:01,190 --> 00:16:02,720
fully code is on github it's open source

383
00:16:02,720 --> 00:16:03,800
anyone can use it

384
00:16:03,800 --> 00:16:06,110
ie Antioch tur can use it and a good guy

385
00:16:06,110 --> 00:16:07,700
can use it which is used very he'll even

386
00:16:07,700 --> 00:16:09,740
read him and any bad guy can use it

387
00:16:09,740 --> 00:16:11,540
which we see very heavily under the last

388
00:16:11,540 --> 00:16:15,440
18 months eternal romance is where it

389
00:16:15,440 --> 00:16:18,650
get really really interesting for us so

390
00:16:18,650 --> 00:16:20,980
Paul and I worked on a levee destroyer

391
00:16:20,980 --> 00:16:23,300
quite a lot for maybe two or three days

392
00:16:23,300 --> 00:16:25,700
and did all the things we need to do to

393
00:16:25,700 --> 00:16:29,150
publish information and then a couple of

394
00:16:29,150 --> 00:16:30,350
slides there I'll talk about some

395
00:16:30,350 --> 00:16:31,940
attribution that came out from Microsoft

396
00:16:31,940 --> 00:16:33,770
related to eternal romance so that made

397
00:16:33,770 --> 00:16:35,240
us sort of revisit that because when we

398
00:16:35,240 --> 00:16:36,530
were looking at we didn't see any

399
00:16:36,530 --> 00:16:39,140
evidence of eternal romance so the best

400
00:16:39,140 --> 00:16:41,300
way to see eternal romance is during

401
00:16:41,300 --> 00:16:42,800
dynamic analysis where it will attempt

402
00:16:42,800 --> 00:16:44,690
to open up SMB ports and will attempt to

403
00:16:44,690 --> 00:16:46,190
try and spread propagate exploit

404
00:16:46,190 --> 00:16:48,650
etcetera that just didn't happen and let

405
00:16:48,650 --> 00:16:50,090
me destroy however when you actually

406
00:16:50,090 --> 00:16:52,040
look at the code base you see the four

407
00:16:52,040 --> 00:16:53,450
structures that relate to eternal

408
00:16:53,450 --> 00:16:53,870
romance

409
00:16:53,870 --> 00:16:57,050
being in there so they actually are used

410
00:16:57,050 --> 00:16:58,790
sorry they actually are input in the

411
00:16:58,790 --> 00:16:59,990
code but they're never actually used

412
00:16:59,990 --> 00:17:03,110
anywhere and you see this sue this is

413
00:17:03,110 --> 00:17:05,329
the proof of concept code for eternal

414
00:17:05,329 --> 00:17:07,430
romance those four structures existed

415
00:17:07,430 --> 00:17:09,500
within a limited destroyer if you go and

416
00:17:09,500 --> 00:17:11,569
grab the olympic destroyer sample you'll

417
00:17:11,569 --> 00:17:13,670
see all this code and they're just never

418
00:17:13,670 --> 00:17:15,260
use never reference never called as a

419
00:17:15,260 --> 00:17:17,900
function never used anywhere along so

420
00:17:17,900 --> 00:17:19,069
how we go up to that was basically

421
00:17:19,069 --> 00:17:21,079
windows defender sent a tweet out in

422
00:17:21,079 --> 00:17:21,980
February

423
00:17:21,980 --> 00:17:25,699
and said fresh analysis of this has led

424
00:17:25,699 --> 00:17:27,919
to eternal rumors being used and we were

425
00:17:27,919 --> 00:17:31,279
like yeah at this time I was a rib

426
00:17:31,279 --> 00:17:33,230
pissed because I said I missed

427
00:17:33,230 --> 00:17:36,289
something big and I started to to

428
00:17:36,289 --> 00:17:38,360
understand why I fail basically and

429
00:17:38,360 --> 00:17:40,340
where is the code of eternal remnants

430
00:17:40,340 --> 00:17:43,129
and trust me it's real time consuming to

431
00:17:43,129 --> 00:17:45,470
look for something that does not exist

432
00:17:45,470 --> 00:17:48,259
you cannot prove a negative that is the

433
00:17:48,259 --> 00:17:49,999
most important lesson I think the Pole

434
00:17:49,999 --> 00:17:51,259
and I learned from this you cannot prove

435
00:17:51,259 --> 00:17:51,830
a negative

436
00:17:51,830 --> 00:17:54,740
so our boss was like where's the eternal

437
00:17:54,740 --> 00:18:00,049
room outside of it there is no well it

438
00:18:00,049 --> 00:18:01,429
can't be right Microsoft if said it and

439
00:18:01,429 --> 00:18:02,990
that's Korea Microsoft do some awesome

440
00:18:02,990 --> 00:18:06,289
research we got in touch with Microsoft

441
00:18:06,289 --> 00:18:07,669
and started to discuss how do we get to

442
00:18:07,669 --> 00:18:09,470
this point of play what what has led you

443
00:18:09,470 --> 00:18:10,879
to say that's because we don't agree

444
00:18:10,879 --> 00:18:13,190
with you that wasn't about public

445
00:18:13,190 --> 00:18:14,779
slander or slinging anybody under a

446
00:18:14,779 --> 00:18:16,519
posture and I think we got it was simply

447
00:18:16,519 --> 00:18:18,619
Paul and I thought we had done something

448
00:18:18,619 --> 00:18:18,950
wrong

449
00:18:18,950 --> 00:18:20,869
pause about the seg fault and john-boy

450
00:18:20,869 --> 00:18:22,610
at the window so we needed to stop that

451
00:18:22,610 --> 00:18:23,990
from happening and understand what was

452
00:18:23,990 --> 00:18:27,799
wrong so why we believe the Microsoft

453
00:18:27,799 --> 00:18:29,330
team this conclusion was a view Google

454
00:18:29,330 --> 00:18:31,519
some of the code that exists within the

455
00:18:31,519 --> 00:18:32,869
structures that relate to eternal

456
00:18:32,869 --> 00:18:34,940
romance the very first hit that you see

457
00:18:34,940 --> 00:18:39,049
is a mess 1710 which is the eternal

458
00:18:39,049 --> 00:18:41,990
romance platform so that's the code

459
00:18:41,990 --> 00:18:42,950
available on github

460
00:18:42,950 --> 00:18:45,230
we think what has happened is someone

461
00:18:45,230 --> 00:18:48,619
has been analyzing and as we all do you

462
00:18:48,619 --> 00:18:50,899
your Google in windows API is on MSDN or

463
00:18:50,899 --> 00:18:52,549
you're googling random stuff like this

464
00:18:52,549 --> 00:18:55,190
to try and make complicated tracks come

465
00:18:55,190 --> 00:18:57,169
together we believe they've maybe Google

466
00:18:57,169 --> 00:18:58,730
this information from the structure and

467
00:18:58,730 --> 00:19:01,159
came to the point with God that

468
00:19:01,159 --> 00:19:02,899
basically the exploit the Python script

469
00:19:02,899 --> 00:19:05,450
existed first and they figured okay this

470
00:19:05,450 --> 00:19:07,220
is what's happened so as I say we got in

471
00:19:07,220 --> 00:19:08,659
touch with whom we discussed what the

472
00:19:08,659 --> 00:19:10,720
actual with the actuality of this was

473
00:19:10,720 --> 00:19:13,730
and then twelve hours later they put out

474
00:19:13,730 --> 00:19:16,429
a tweet to say actually that didn't

475
00:19:16,429 --> 00:19:18,049
happen so Paul and I were very happy

476
00:19:18,049 --> 00:19:20,360
when our boss was very happy cuz he then

477
00:19:20,360 --> 00:19:21,649
believed that we were good at our job

478
00:19:21,649 --> 00:19:22,879
and we were actually doing things right

479
00:19:22,879 --> 00:19:25,039
Paul knew longer seg faulted and we had

480
00:19:25,039 --> 00:19:27,619
a happy life ever after and then we

481
00:19:27,619 --> 00:19:29,869
ended up here and so we obviously

482
00:19:29,869 --> 00:19:31,730
continue to look at it as well to see

483
00:19:31,730 --> 00:19:32,809
who's going on and some of the

484
00:19:32,809 --> 00:19:34,800
comparisons that we came to the

485
00:19:34,800 --> 00:19:36,870
I've discussed really briefly I would

486
00:19:36,870 --> 00:19:38,760
existed between Olympic destroyer and

487
00:19:38,760 --> 00:19:40,530
yet district not Padua and bad Robert

488
00:19:40,530 --> 00:19:42,240
so we've seen similarities and

489
00:19:42,240 --> 00:19:43,950
propagation techniques we've seen

490
00:19:43,950 --> 00:19:45,960
similarities and exploits used however

491
00:19:45,960 --> 00:19:47,730
as I just discussed eternal romance was

492
00:19:47,730 --> 00:19:50,340
not used on Olympic destroyer but when

493
00:19:50,340 --> 00:19:51,780
you've got pieces of code base that

494
00:19:51,780 --> 00:19:53,400
relate to they exist within your code

495
00:19:53,400 --> 00:19:55,110
it's very easy to jump to the conclusion

496
00:19:55,110 --> 00:19:57,210
that it is used which is what we seen

497
00:19:57,210 --> 00:20:00,240
happen we seen many cats use we seen

498
00:20:00,240 --> 00:20:01,740
credentials being passed forth and

499
00:20:01,740 --> 00:20:03,540
passed back and forth mimic cats

500
00:20:03,540 --> 00:20:05,190
we've seen some files encrypted we've

501
00:20:05,190 --> 00:20:07,170
seen some files deleted we've seen some

502
00:20:07,170 --> 00:20:09,210
machines destroyed so we get that point

503
00:20:09,210 --> 00:20:10,890
in time where we have small linking

504
00:20:10,890 --> 00:20:12,360
similarities that exist between these

505
00:20:12,360 --> 00:20:14,070
multiple campaigns over the last 18

506
00:20:14,070 --> 00:20:14,480
months

507
00:20:14,480 --> 00:20:18,330
and what that also reports down to is we

508
00:20:18,330 --> 00:20:20,220
believe this author purposely planted

509
00:20:20,220 --> 00:20:22,800
false flags we went through Lazarus

510
00:20:22,800 --> 00:20:23,910
group overlaps

511
00:20:23,910 --> 00:20:25,680
we went through apt 3 and apt 10

512
00:20:25,680 --> 00:20:27,060
overlaps and then we went through

513
00:20:27,060 --> 00:20:29,370
eternal romance overlaps that doesn't

514
00:20:29,370 --> 00:20:30,180
happen by accident

515
00:20:30,180 --> 00:20:32,550
possibly one happens by accident where

516
00:20:32,550 --> 00:20:34,140
you have code overlap you can maybe copy

517
00:20:34,140 --> 00:20:35,610
and pasted something like the turn

518
00:20:35,610 --> 00:20:37,710
rumors so that could very quickly cause

519
00:20:37,710 --> 00:20:40,110
it a similarity engine to freak out

520
00:20:40,110 --> 00:20:42,000
because it sees all this information

521
00:20:42,000 --> 00:20:43,740
related to this sample but also in this

522
00:20:43,740 --> 00:20:46,080
sample the open source related platforms

523
00:20:46,080 --> 00:20:47,790
or warlock can happen ie mimic cancer

524
00:20:47,790 --> 00:20:51,180
but we believe it was purposely included

525
00:20:51,180 --> 00:20:54,150
false flag information what's the point

526
00:20:54,150 --> 00:20:55,530
of that well it can be taken to the

527
00:20:55,530 --> 00:20:57,330
extreme of a country denying an attack

528
00:20:57,330 --> 00:20:59,880
on their party false attribution again

529
00:20:59,880 --> 00:21:01,500
the biggest issue with attribution is we

530
00:21:01,500 --> 00:21:05,040
as security researchers like that

531
00:21:05,040 --> 00:21:06,210
overarching

532
00:21:06,210 --> 00:21:09,150
piece of information that exists only on

533
00:21:09,150 --> 00:21:11,910
under law enforcement so we can't write

534
00:21:11,910 --> 00:21:13,500
indictments we can't write warrants we

535
00:21:13,500 --> 00:21:15,240
can't smash down doors and take servers

536
00:21:15,240 --> 00:21:17,400
we really nice of all of us could do

537
00:21:17,400 --> 00:21:18,510
that because I'm sure would be very

538
00:21:18,510 --> 00:21:19,800
successful in doing that and we would

539
00:21:19,800 --> 00:21:21,240
have great fun doing it but we just

540
00:21:21,240 --> 00:21:22,980
don't have the capability to do that

541
00:21:22,980 --> 00:21:24,840
what we have the capability to do is

542
00:21:24,840 --> 00:21:26,490
look at technical implementations of

543
00:21:26,490 --> 00:21:28,950
code we look at how binaries operate we

544
00:21:28,950 --> 00:21:30,180
look at how they work we look at the

545
00:21:30,180 --> 00:21:32,190
codes that are used a long way and we

546
00:21:32,190 --> 00:21:34,740
try and make a I don't want to say

547
00:21:34,740 --> 00:21:36,630
derisory but we try and make an attempt

548
00:21:36,630 --> 00:21:39,300
at attribution at times but we just

549
00:21:39,300 --> 00:21:42,150
don't have the tools and I do want to

550
00:21:42,150 --> 00:21:43,710
say skillset because I think some of us

551
00:21:43,710 --> 00:21:45,180
do have the skill sets for it I don't

552
00:21:45,180 --> 00:21:46,950
think that's a skill set that's missing

553
00:21:46,950 --> 00:21:47,580
in this and this

554
00:21:47,580 --> 00:21:49,169
I just think it's we don't have the

555
00:21:49,169 --> 00:21:51,509
necessary tools to do it but it could

556
00:21:51,509 --> 00:21:53,879
really go from the extreme of the press

557
00:21:53,879 --> 00:21:55,379
saying it was North Korea the press

558
00:21:55,379 --> 00:21:57,119
saying it was China and the press saying

559
00:21:57,119 --> 00:22:00,389
it was Russia - this being said well we

560
00:22:00,389 --> 00:22:01,739
think it was then because of this code

561
00:22:01,739 --> 00:22:03,929
overlap the the point of that all that

562
00:22:03,929 --> 00:22:05,909
Rommel is basically don't take for

563
00:22:05,909 --> 00:22:07,139
granted would you read in a piece of

564
00:22:07,139 --> 00:22:10,110
code because it's not always right a

565
00:22:10,110 --> 00:22:12,360
limit destroyed specifically had real

566
00:22:12,360 --> 00:22:14,190
potential to do a lot more damage we

567
00:22:14,190 --> 00:22:15,749
don't really know why but they had the

568
00:22:15,749 --> 00:22:17,610
potential to wipe that whole

569
00:22:17,610 --> 00:22:20,129
infrastructure and wiped out all the

570
00:22:20,129 --> 00:22:21,690
whole investment that had been in for

571
00:22:21,690 --> 00:22:23,070
the Hong Kong Olympics they could have

572
00:22:23,070 --> 00:22:24,659
wiped out all three hundred servers they

573
00:22:24,659 --> 00:22:26,820
didn't we don't really know why we could

574
00:22:26,820 --> 00:22:28,080
toss a coin and we could make

575
00:22:28,080 --> 00:22:30,720
assumptions as the way a destructive

576
00:22:30,720 --> 00:22:33,499
malware will continue to be popular

577
00:22:33,499 --> 00:22:37,049
whose board a crypto jaqen I know I am

578
00:22:37,049 --> 00:22:39,509
yeah who's bored of Bitcoin miners I

579
00:22:39,509 --> 00:22:42,299
know I am so this gives us something a

580
00:22:42,299 --> 00:22:43,799
bit more fun to look up because we need

581
00:22:43,799 --> 00:22:45,419
to try and catch it quickly because we

582
00:22:45,419 --> 00:22:47,039
need to stop machines being impacted and

583
00:22:47,039 --> 00:22:49,109
we need to stop stuff being taken down

584
00:22:49,109 --> 00:22:52,649
essentially and advanced reactors will

585
00:22:52,649 --> 00:22:55,200
continue to evolve they'll continue to

586
00:22:55,200 --> 00:22:57,749
copy each other whether or not that's in

587
00:22:57,749 --> 00:23:00,059
VN I did premature or whether it's

588
00:23:00,059 --> 00:23:01,200
because they think someone else was

589
00:23:01,200 --> 00:23:02,639
better cooled in them the key and

590
00:23:02,639 --> 00:23:04,200
there's some life lessons we'll never

591
00:23:04,200 --> 00:23:06,269
really knew the point of this is

592
00:23:06,269 --> 00:23:09,210
basically don't Luger cold dude assume

593
00:23:09,210 --> 00:23:10,739
it's right and do this soon because it

594
00:23:10,739 --> 00:23:12,539
exists in one platform that it's correct

595
00:23:12,539 --> 00:23:15,809
on another platform and the circus is

596
00:23:15,809 --> 00:23:17,789
not I closed today is your last day to

597
00:23:17,789 --> 00:23:18,869
clone around with Fraulein

598
00:23:18,869 --> 00:23:21,918
so yeah

