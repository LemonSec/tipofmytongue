1
00:00:00,000 --> 00:00:02,669
good morning and welcome to the first

2
00:00:02,669 --> 00:00:05,940
session in the Red Room at vb 2014 the

3
00:00:05,940 --> 00:00:07,919
to kick us off this morning we have a

4
00:00:07,919 --> 00:00:09,660
paper that attempts to peer into the

5
00:00:09,660 --> 00:00:12,599
mists of time by predicting malicious

6
00:00:12,599 --> 00:00:15,929
domains could you please welcome way zoo

7
00:00:15,929 --> 00:00:20,180
and Carl Sanders from palo alto networks

8
00:00:23,720 --> 00:00:27,830
oh thank you tear good morning everyone

9
00:00:27,830 --> 00:00:30,800
on my miss way I'm coming from polazo

10
00:00:30,800 --> 00:00:34,550
networks and this is calendars he'll be

11
00:00:34,550 --> 00:00:36,879
my toe speaker for this presentation

12
00:00:36,879 --> 00:00:39,949
today um we're going to talk about the

13
00:00:39,949 --> 00:00:42,199
work we did with predicting malicious

14
00:00:42,199 --> 00:00:44,659
domains it's a it's a collaboration work

15
00:00:44,659 --> 00:00:47,900
between myself Attell and one of our

16
00:00:47,900 --> 00:00:49,670
colleague in xinjiang who could not be

17
00:00:49,670 --> 00:00:56,059
here today okay so I'm sure everybody

18
00:00:56,059 --> 00:00:59,000
here knows was malicious domain ace but

19
00:00:59,000 --> 00:01:01,040
just for the purpose of presentation let

20
00:01:01,040 --> 00:01:02,680
me go through a little bit since

21
00:01:02,680 --> 00:01:04,750
information about malicious domains

22
00:01:04,750 --> 00:01:07,430
they're used for different purposes most

23
00:01:07,430 --> 00:01:09,200
common ones we know for command and

24
00:01:09,200 --> 00:01:11,720
control and the mower distributions like

25
00:01:11,720 --> 00:01:14,119
Troy by downloads and also fishing those

26
00:01:14,119 --> 00:01:18,500
are probably the most important to use

27
00:01:18,500 --> 00:01:20,689
for malicious domains and the workhorse

28
00:01:20,689 --> 00:01:22,970
more the reason we focus on malicious

29
00:01:22,970 --> 00:01:25,430
domains is because they are used for

30
00:01:25,430 --> 00:01:27,259
different attack vectors and they're

31
00:01:27,259 --> 00:01:30,680
pretty much show up everywhere in

32
00:01:30,680 --> 00:01:35,330
security less than a threat landscape so

33
00:01:35,330 --> 00:01:39,890
the goal remains the same because since

34
00:01:39,890 --> 00:01:42,020
we since the since the use of malicious

35
00:01:42,020 --> 00:01:45,229
domains is to detect them to plot and to

36
00:01:45,229 --> 00:01:48,770
do that the current method mostly like

37
00:01:48,770 --> 00:01:51,229
this so we have a lot of reputation

38
00:01:51,229 --> 00:01:53,930
based the malicious domain blacklist so

39
00:01:53,930 --> 00:01:56,900
everybody trying to find the detect

40
00:01:56,900 --> 00:01:58,790
evidence of malicious domains like here

41
00:01:58,790 --> 00:02:00,590
you have some malicious script code you

42
00:02:00,590 --> 00:02:04,729
have been distribution malware's you has

43
00:02:04,729 --> 00:02:06,619
been invited some Ephraim's and you go

44
00:02:06,619 --> 00:02:09,019
through a lot of traffic irradiation a

45
00:02:09,019 --> 00:02:12,530
change things like that so in general

46
00:02:12,530 --> 00:02:14,989
the current approaches detect evidence

47
00:02:14,989 --> 00:02:16,909
of malicious content or malicious

48
00:02:16,909 --> 00:02:19,640
activities unleashed on the domains and

49
00:02:19,640 --> 00:02:21,890
put them into this reputation based

50
00:02:21,890 --> 00:02:25,220
malicious from and blacklist so seems

51
00:02:25,220 --> 00:02:27,159
like everything is okay it's all good um

52
00:02:27,159 --> 00:02:31,549
but what's the problem the problem is

53
00:02:31,549 --> 00:02:36,200
there's always a but first it's kind of

54
00:02:36,200 --> 00:02:37,460
in retrospect

55
00:02:37,460 --> 00:02:39,890
meaning the detection of malicious

56
00:02:39,890 --> 00:02:42,290
domains happens after the malicious

57
00:02:42,290 --> 00:02:47,780
domains are in use and so not just us

58
00:02:47,780 --> 00:02:50,630
attackers also noticed this what they do

59
00:02:50,630 --> 00:02:52,520
they make sure a lot of malicious

60
00:02:52,520 --> 00:02:54,110
domains only live for a very short

61
00:02:54,110 --> 00:02:57,070
period so it's short-lived meaning

62
00:02:57,070 --> 00:02:59,420
they're only used for a very short

63
00:02:59,420 --> 00:03:01,940
period of time for their malicious

64
00:03:01,940 --> 00:03:04,460
purpose activities and they have been

65
00:03:04,460 --> 00:03:06,650
developed different evasion techniques

66
00:03:06,650 --> 00:03:08,810
one of which the most famous one is that

67
00:03:08,810 --> 00:03:13,060
common generation algorithm so I'm just

68
00:03:13,060 --> 00:03:15,980
in case some of you not familiar with

69
00:03:15,980 --> 00:03:18,080
the term demand generation algorithm is

70
00:03:18,080 --> 00:03:22,100
that its algorithm used by some of the

71
00:03:22,100 --> 00:03:25,070
modern malware's it will use a seed as

72
00:03:25,070 --> 00:03:27,110
input and the generator a list of

73
00:03:27,110 --> 00:03:29,360
domains based on the seed and they will

74
00:03:29,360 --> 00:03:31,280
keep connecting to each one of these

75
00:03:31,280 --> 00:03:32,960
domains on the list to make sure to

76
00:03:32,960 --> 00:03:34,970
check which wine is life and they use

77
00:03:34,970 --> 00:03:38,420
that live one as potential like the C&C

78
00:03:38,420 --> 00:03:44,390
server or things like that so continue

79
00:03:44,390 --> 00:03:46,730
the problem this is the game we've been

80
00:03:46,730 --> 00:03:49,160
playing right now and in this picture we

81
00:03:49,160 --> 00:03:51,710
actually come if I remember correctly

82
00:03:51,710 --> 00:03:58,670
Jerry is the smart one so put into one

83
00:03:58,670 --> 00:04:00,410
sentence we are always one step behind

84
00:04:00,410 --> 00:04:02,810
the bad guys so that's the scenario

85
00:04:02,810 --> 00:04:06,110
we're we're looking at so what can we do

86
00:04:06,110 --> 00:04:07,820
that's initial natural question we're

87
00:04:07,820 --> 00:04:11,360
going to ask next um I'm not sure I'm

88
00:04:11,360 --> 00:04:12,650
probably know if you can recognize this

89
00:04:12,650 --> 00:04:14,810
this picture is coming from the movie

90
00:04:14,810 --> 00:04:17,600
called Minority Report it's saying that

91
00:04:17,600 --> 00:04:21,320
this the in future I will how far away a

92
00:04:21,320 --> 00:04:24,950
police department try to prevent a crime

93
00:04:24,950 --> 00:04:28,130
even before it's happening the same case

94
00:04:28,130 --> 00:04:30,500
here so in this work we predict

95
00:04:30,500 --> 00:04:32,780
malicious domains but not use the magic

96
00:04:32,780 --> 00:04:36,650
eight it's just a symbol um so how the

97
00:04:36,650 --> 00:04:40,100
petition goes first are we ought to say

98
00:04:40,100 --> 00:04:41,540
this is the first step towards this

99
00:04:41,540 --> 00:04:44,000
effort because it's clearly a lot of

100
00:04:44,000 --> 00:04:47,060
uncertainty characters here is not like

101
00:04:47,060 --> 00:04:49,520
it when people talking about prediction

102
00:04:49,520 --> 00:04:50,810
some people thinks is not going to

103
00:04:50,810 --> 00:04:53,060
happen but this just our effort to try

104
00:04:53,060 --> 00:04:57,380
to make it try to use this and work in

105
00:04:57,380 --> 00:05:00,560
this direction so the whole work

106
00:05:00,560 --> 00:05:01,940
basically based on these two

107
00:05:01,940 --> 00:05:03,980
observations the first of the division

108
00:05:03,980 --> 00:05:05,419
is called the life cycle of malicious

109
00:05:05,419 --> 00:05:07,910
domains which I will explain in details

110
00:05:07,910 --> 00:05:10,220
later the second one called reuse of

111
00:05:10,220 --> 00:05:14,330
valuable resources so our like your

112
00:05:14,330 --> 00:05:17,990
philosophy is kind of predict based on

113
00:05:17,990 --> 00:05:19,700
what's things we already know and try to

114
00:05:19,700 --> 00:05:21,440
predict things we don't know so from

115
00:05:21,440 --> 00:05:24,860
known to unknown and for this work we

116
00:05:24,860 --> 00:05:26,690
only focus on newly registered and

117
00:05:26,690 --> 00:05:28,790
malicious domains this also including

118
00:05:28,790 --> 00:05:30,470
domains that the registration has been

119
00:05:30,470 --> 00:05:31,970
changed like from one owner to another

120
00:05:31,970 --> 00:05:36,710
since like that and so the alchemist

121
00:05:36,710 --> 00:05:38,270
work is we try to provide early warning

122
00:05:38,270 --> 00:05:42,620
after malicious domains okay so the

123
00:05:42,620 --> 00:05:44,510
first of the vision the malicious the

124
00:05:44,510 --> 00:05:47,210
lifecycle of malicious domains it it

125
00:05:47,210 --> 00:05:49,419
goes like this you have different faces

126
00:05:49,419 --> 00:05:53,240
and DIF different steps actually and

127
00:05:53,240 --> 00:05:55,190
different steps aggregated into three

128
00:05:55,190 --> 00:05:58,010
main phases the preparation phase the

129
00:05:58,010 --> 00:05:59,870
activation phase and of course the

130
00:05:59,870 --> 00:06:02,450
deactivation face it's very

131
00:06:02,450 --> 00:06:05,180
straightforward so we start with slack

132
00:06:05,180 --> 00:06:07,310
name imagine your attacker you want to

133
00:06:07,310 --> 00:06:08,960
use registrations two men for the other

134
00:06:08,960 --> 00:06:10,789
purpose you have to came up with the

135
00:06:10,789 --> 00:06:13,400
name you can choose from tons of

136
00:06:13,400 --> 00:06:16,520
top-level domains and you need to go to

137
00:06:16,520 --> 00:06:20,479
a midwestern like GoDaddy to pay like

138
00:06:20,479 --> 00:06:22,310
maybe depends on the top level domain

139
00:06:22,310 --> 00:06:24,080
you choose from ten dollars to twenty

140
00:06:24,080 --> 00:06:25,370
dollars fifty dollars you can register

141
00:06:25,370 --> 00:06:28,280
min for a year and after that you have a

142
00:06:28,280 --> 00:06:29,990
set of DNS record mean you have to let

143
00:06:29,990 --> 00:06:33,020
people be able to find your domain um to

144
00:06:33,020 --> 00:06:36,139
connect to it again then you push the

145
00:06:36,139 --> 00:06:38,510
button okay everything goes online you

146
00:06:38,510 --> 00:06:41,120
can do whatever on in ten do you have

147
00:06:41,120 --> 00:06:44,570
for the domain and hopefully very

148
00:06:44,570 --> 00:06:49,250
shortly it got detected so the security

149
00:06:49,250 --> 00:06:51,350
word know this is a bad omen and there

150
00:06:51,350 --> 00:06:54,710
will be that it will be suspended it

151
00:06:54,710 --> 00:06:57,680
will be locked so modern often this is

152
00:06:57,680 --> 00:07:00,530
done by the domain registrant based on

153
00:07:00,530 --> 00:07:02,630
the report they received from the firm

154
00:07:02,630 --> 00:07:04,820
people say okay we find evidence of

155
00:07:04,820 --> 00:07:06,530
still men doing malicious activities so

156
00:07:06,530 --> 00:07:08,240
you have to block it and actually

157
00:07:08,240 --> 00:07:10,760
they're willing to do this because once

158
00:07:10,760 --> 00:07:14,150
they block it kind like the early d

159
00:07:14,150 --> 00:07:16,580
block this domain the earlier they can

160
00:07:16,580 --> 00:07:18,740
get you the back and then put it on the

161
00:07:18,740 --> 00:07:21,140
market again so it's just make more

162
00:07:21,140 --> 00:07:24,890
money after well depends on who block

163
00:07:24,890 --> 00:07:27,580
and why they block it unlock it and

164
00:07:27,580 --> 00:07:30,710
resell it so this is the whole cycle

165
00:07:30,710 --> 00:07:32,840
thing what we're talking about this on

166
00:07:32,840 --> 00:07:36,980
we will show you later on so based on

167
00:07:36,980 --> 00:07:39,410
this we have the we propose this is for

168
00:07:39,410 --> 00:07:41,870
like a different types of approaches or

169
00:07:41,870 --> 00:07:43,810
some of them are actually heuristics for

170
00:07:43,810 --> 00:07:46,820
example the first one is the or reuse of

171
00:07:46,820 --> 00:07:50,060
domain names and the second one is a pre

172
00:07:50,060 --> 00:07:52,460
generated the domain names and the sort

173
00:07:52,460 --> 00:07:53,870
of why is a connection between different

174
00:07:53,870 --> 00:07:55,880
militias domains and the last one is the

175
00:07:55,880 --> 00:07:59,510
DNS queries so this kind of like our our

176
00:07:59,510 --> 00:08:03,710
weapon to do the prediction we start

177
00:08:03,710 --> 00:08:05,690
with the first one the reuse of domain

178
00:08:05,690 --> 00:08:08,870
names so remember a cycle we just talked

179
00:08:08,870 --> 00:08:12,260
about so the form the time a malicious

180
00:08:12,260 --> 00:08:13,940
domain being registered and being used

181
00:08:13,940 --> 00:08:16,630
and to it being block and reused again

182
00:08:16,630 --> 00:08:19,070
there's a time interval normally this

183
00:08:19,070 --> 00:08:22,670
thing is over a year and so after that

184
00:08:22,670 --> 00:08:26,240
timing to go back to the market and it

185
00:08:26,240 --> 00:08:28,340
should be cleared from most if not all

186
00:08:28,340 --> 00:08:30,050
the militias to amend blacklist because

187
00:08:30,050 --> 00:08:31,700
at that time the malicious activity or

188
00:08:31,700 --> 00:08:33,559
our content has already gone there's no

189
00:08:33,559 --> 00:08:35,809
reason to keep it on list meanings clean

190
00:08:35,809 --> 00:08:39,770
domain again so this is our first of

191
00:08:39,770 --> 00:08:41,510
observation this kind of domains the

192
00:08:41,510 --> 00:08:43,849
second of evisceration is on this domain

193
00:08:43,849 --> 00:08:47,510
always maintained resolvable even in the

194
00:08:47,510 --> 00:08:49,700
KO during the face they're suspended or

195
00:08:49,700 --> 00:08:52,370
blocked and the normally they're in the

196
00:08:52,370 --> 00:08:54,590
form of dublin parking meaning if you

197
00:08:54,590 --> 00:08:56,720
actually visited domain you can say say

198
00:08:56,720 --> 00:08:59,360
some content over there most mostly in

199
00:08:59,360 --> 00:09:01,490
most cases is just some other wise men

200
00:09:01,490 --> 00:09:04,040
to swing by the domain registry who own

201
00:09:04,040 --> 00:09:08,150
the domain at that time but if just

202
00:09:08,150 --> 00:09:10,400
based on this to Michael okay we find

203
00:09:10,400 --> 00:09:12,410
that we know this domain was malicious

204
00:09:12,410 --> 00:09:15,170
tool in a year ago and we now say it's

205
00:09:15,170 --> 00:09:17,660
resolved again just based on this tool

206
00:09:17,660 --> 00:09:18,259
there will be

207
00:09:18,259 --> 00:09:20,899
tons of domains English system is a

208
00:09:20,899 --> 00:09:23,869
candidate for malicious domains so what

209
00:09:23,869 --> 00:09:26,029
do i do we need to apply some kind of

210
00:09:26,029 --> 00:09:27,979
filtering which we call her ability

211
00:09:27,979 --> 00:09:30,919
score this probability score is based on

212
00:09:30,919 --> 00:09:33,439
first the domain name like how random it

213
00:09:33,439 --> 00:09:36,799
look like is the domain name looks like

214
00:09:36,799 --> 00:09:40,100
an existing legitimate do men like a for

215
00:09:40,100 --> 00:09:41,869
example Facebook will be something like

216
00:09:41,869 --> 00:09:46,639
f 00 k book something like that um what

217
00:09:46,639 --> 00:09:48,470
kind of top-level domain you choose if

218
00:09:48,470 --> 00:09:52,459
it's just calm knife or dot bz o.co CC c

219
00:09:52,459 --> 00:09:55,069
we all know that different top-level

220
00:09:55,069 --> 00:09:56,989
domains have different weights and how

221
00:09:56,989 --> 00:09:59,749
often changes in the IP address does it

222
00:09:59,749 --> 00:10:02,179
look like fast facts two mins and the

223
00:10:02,179 --> 00:10:03,559
last one is the price for domain

224
00:10:03,559 --> 00:10:05,059
transfer because there's always the

225
00:10:05,059 --> 00:10:11,959
economy model again and behind this so

226
00:10:11,959 --> 00:10:15,499
um based on this based on probability

227
00:10:15,499 --> 00:10:18,859
score we can calculate how likely this

228
00:10:18,859 --> 00:10:20,989
domain this previously detect malicious

229
00:10:20,989 --> 00:10:22,970
comments will be used for malicious

230
00:10:22,970 --> 00:10:25,970
purposes get and that's how I predicting

231
00:10:25,970 --> 00:10:28,369
the first first approach the second

232
00:10:28,369 --> 00:10:31,160
approach is based on their the technique

233
00:10:31,160 --> 00:10:33,379
the division technique technique we just

234
00:10:33,379 --> 00:10:34,609
talked about the domain generation

235
00:10:34,609 --> 00:10:39,679
algorithm and so normally understand of

236
00:10:39,679 --> 00:10:41,539
demand generation algorithm is that it

237
00:10:41,539 --> 00:10:43,879
is used for generate a list of potential

238
00:10:43,879 --> 00:10:46,369
rendezvous points meaning that the

239
00:10:46,369 --> 00:10:48,439
attacker don't want hard-coded the CNC

240
00:10:48,439 --> 00:10:50,449
servers into mauer they distribute on

241
00:10:50,449 --> 00:10:53,239
all the clients the machines rather they

242
00:10:53,239 --> 00:10:54,739
want those clients machines to looking

243
00:10:54,739 --> 00:10:59,269
for DM sorry x 2 hello hey still hear me

244
00:10:59,269 --> 00:11:03,619
give it back ok um they wanted a malware

245
00:11:03,619 --> 00:11:06,109
to look for those domains and so that

246
00:11:06,109 --> 00:11:09,199
they can bypass the the current approach

247
00:11:09,199 --> 00:11:12,199
the domain blacklist approach but that's

248
00:11:12,199 --> 00:11:15,589
just the normal assumption for this what

249
00:11:15,589 --> 00:11:17,869
we discover the based on analysis a lot

250
00:11:17,869 --> 00:11:19,850
of demand generation algorithms is that

251
00:11:19,850 --> 00:11:23,179
first their model any malware can use

252
00:11:23,179 --> 00:11:25,220
that model and they have been used for

253
00:11:25,220 --> 00:11:27,019
different purpose other than just the

254
00:11:27,019 --> 00:11:29,659
rendezvous points for example we noticed

255
00:11:29,659 --> 00:11:31,159
some of the bow or sample actually use

256
00:11:31,159 --> 00:11:31,830
coming generation

257
00:11:31,830 --> 00:11:34,590
algorithm to generate the noise so when

258
00:11:34,590 --> 00:11:36,600
the maro maro excuse you can see a bunch

259
00:11:36,600 --> 00:11:39,660
of T has requested most of them retains

260
00:11:39,660 --> 00:11:41,460
the next 20 mins but there are few

261
00:11:41,460 --> 00:11:44,190
actually embedded and they're not next

262
00:11:44,190 --> 00:11:46,530
and they are not to be part of not as

263
00:11:46,530 --> 00:11:48,030
part of the answer requests that looks

264
00:11:48,030 --> 00:11:49,980
suspicious meaning they are trying to

265
00:11:49,980 --> 00:11:51,960
take your attention away to something

266
00:11:51,960 --> 00:11:53,460
that not being used at the same thing

267
00:11:53,460 --> 00:11:56,610
and hide their real sincere servers so

268
00:11:56,610 --> 00:11:59,280
we start in mind that the DG is actually

269
00:11:59,280 --> 00:12:01,710
not that simple the problem is to use

270
00:12:01,710 --> 00:12:03,390
the GA to pray generating domains is

271
00:12:03,390 --> 00:12:05,760
first we have to solve this problem

272
00:12:05,760 --> 00:12:08,010
first of course find the DJ TGM hours

273
00:12:08,010 --> 00:12:09,900
and we have some sandbox based

274
00:12:09,900 --> 00:12:12,990
technologies from which we run the mower

275
00:12:12,990 --> 00:12:15,960
samples oh and we can look for the DNS

276
00:12:15,960 --> 00:12:18,480
requests the pattern and if they have

277
00:12:18,480 --> 00:12:20,940
multiple TS requested to non-existent

278
00:12:20,940 --> 00:12:22,980
domains and which the domain name looks

279
00:12:22,980 --> 00:12:26,250
like random we think it's the potential

280
00:12:26,250 --> 00:12:28,260
Malaysia sorry potential malware that

281
00:12:28,260 --> 00:12:31,110
used eg a technique the second step is

282
00:12:31,110 --> 00:12:32,760
very important we have to filter the

283
00:12:32,760 --> 00:12:34,530
noise many we have to identify the

284
00:12:34,530 --> 00:12:36,990
purpose of this the DGA tourism be used

285
00:12:36,990 --> 00:12:38,760
in English malware I can mention before

286
00:12:38,760 --> 00:12:40,560
not all of them being used for potential

287
00:12:40,560 --> 00:12:44,100
students ifs or purpose and third one is

288
00:12:44,100 --> 00:12:47,040
we have to find a DJ seed each DG

289
00:12:47,040 --> 00:12:48,870
algorithm has a seed and the scenes

290
00:12:48,870 --> 00:12:50,310
configured configure is the first

291
00:12:50,310 --> 00:12:52,920
ephemeris DG example since that the seed

292
00:12:52,920 --> 00:12:54,960
has been changing because the postal

293
00:12:54,960 --> 00:12:57,420
attacker sorry the attacker has realized

294
00:12:57,420 --> 00:12:59,400
that using the system time not very

295
00:12:59,400 --> 00:13:02,130
reliable so they have been moving to

296
00:13:02,130 --> 00:13:04,260
other things for example we noticed some

297
00:13:04,260 --> 00:13:08,220
of GTG malware actually such the search

298
00:13:08,220 --> 00:13:10,740
engine page like Google or Bing within

299
00:13:10,740 --> 00:13:12,240
not so changing pages there such time

300
00:13:12,240 --> 00:13:13,950
STEM fields they just use that as the

301
00:13:13,950 --> 00:13:17,460
seed so the challenge here is not just

302
00:13:17,460 --> 00:13:19,470
as financing manually through reverse

303
00:13:19,470 --> 00:13:21,690
engineering which works but requires a

304
00:13:21,690 --> 00:13:23,550
lot of manual effort what we're trying

305
00:13:23,550 --> 00:13:25,470
to do is without the reverse engineering

306
00:13:25,470 --> 00:13:27,600
so what we propose is actually a black

307
00:13:27,600 --> 00:13:33,410
back sorry black box base the testing

308
00:13:35,149 --> 00:13:44,309
hello well feels much better haha so and

309
00:13:44,309 --> 00:13:48,059
the last one is each TJ domains depends

310
00:13:48,059 --> 00:13:50,729
on half and they activated the G

311
00:13:50,729 --> 00:13:52,409
algorithm will generally to list of

312
00:13:52,409 --> 00:13:54,089
domains like every hour every three

313
00:13:54,089 --> 00:13:56,339
hours every day basically what we're

314
00:13:56,339 --> 00:13:58,169
trying to say is that if we have a lot

315
00:13:58,169 --> 00:14:00,179
of TG mouse and you have you are to

316
00:14:00,179 --> 00:14:02,339
figure out the DG algorithm and you run

317
00:14:02,339 --> 00:14:04,499
them to protect the future domains you

318
00:14:04,499 --> 00:14:06,989
will have a large list of domains so

319
00:14:06,989 --> 00:14:09,059
which one of these domains will actually

320
00:14:09,059 --> 00:14:12,689
be used we have to keep one it again so

321
00:14:12,689 --> 00:14:13,859
that's the problems we're trying to

322
00:14:13,859 --> 00:14:16,019
solve and the most important technique

323
00:14:16,019 --> 00:14:18,659
we used is called black box testing the

324
00:14:18,659 --> 00:14:20,639
purpose of this technique is to find the

325
00:14:20,639 --> 00:14:23,129
seed if its first its most simple ones

326
00:14:23,129 --> 00:14:24,929
if you use the time we can always change

327
00:14:24,929 --> 00:14:27,029
this system time and run some post

328
00:14:27,029 --> 00:14:28,919
multiple times that's it that's the

329
00:14:28,919 --> 00:14:31,349
general idea and see if the if the if

330
00:14:31,349 --> 00:14:46,489
the hello hello hello

331
00:14:46,570 --> 00:14:49,750
yes really

332
00:14:54,579 --> 00:14:57,809
Idaho hold it

333
00:14:59,320 --> 00:15:02,010
thanks

334
00:15:05,760 --> 00:15:13,660
hello sorry so um yes black box i tested

335
00:15:13,660 --> 00:15:18,250
um but first these other than the system

336
00:15:18,250 --> 00:15:21,490
x them we have to do something else for

337
00:15:21,490 --> 00:15:23,620
example the case i just mentioned if

338
00:15:23,620 --> 00:15:25,570
it's looking for something specific to

339
00:15:25,570 --> 00:15:27,970
domain sorry specific webpage like

340
00:15:27,970 --> 00:15:30,820
Google's Google's page we have to be

341
00:15:30,820 --> 00:15:33,010
able to feed that page with some of

342
00:15:33,010 --> 00:15:36,880
modifications if we suspect is that is

343
00:15:36,880 --> 00:15:39,460
the is the is the time stand in that

344
00:15:39,460 --> 00:15:41,740
page will be used at the seed we need to

345
00:15:41,740 --> 00:15:43,480
have we need to change the timestamp

346
00:15:43,480 --> 00:15:45,160
losing that page and faded it to the

347
00:15:45,160 --> 00:15:46,720
different executions of the same hour

348
00:15:46,720 --> 00:15:49,290
then we can see whether this change of

349
00:15:49,290 --> 00:15:51,970
potential or improved candidate well

350
00:15:51,970 --> 00:15:54,010
result in the generation of different

351
00:15:54,010 --> 00:15:57,130
list of them in TJ domains so that's how

352
00:15:57,130 --> 00:16:00,820
we do the black box testing and with

353
00:16:00,820 --> 00:16:03,520
that if when we figure out the input it

354
00:16:03,520 --> 00:16:06,340
to this the DJ domains we will

355
00:16:06,340 --> 00:16:07,900
manipulate the include for example it's

356
00:16:07,900 --> 00:16:09,760
time based most comments time-based will

357
00:16:09,760 --> 00:16:11,800
just change the time to tomorrow that

358
00:16:11,800 --> 00:16:14,080
they have tomorrow like that and so we

359
00:16:14,080 --> 00:16:15,970
can predict to the domain names that

360
00:16:15,970 --> 00:16:17,560
will be used for the malicious purpose

361
00:16:17,560 --> 00:16:22,450
and so the third one the third approach

362
00:16:22,450 --> 00:16:25,990
our heuristic is reuse of valuable

363
00:16:25,990 --> 00:16:28,000
resources this is actually our second

364
00:16:28,000 --> 00:16:31,650
observation this is very prevalent on

365
00:16:31,650 --> 00:16:35,170
one of the resources i mean like servers

366
00:16:35,170 --> 00:16:36,970
for example bulletproof servers you can

367
00:16:36,970 --> 00:16:39,370
buy these servers from online they're

368
00:16:39,370 --> 00:16:41,170
normally hosted in some countries that

369
00:16:41,170 --> 00:16:43,720
doesn't care much about internet crime

370
00:16:43,720 --> 00:16:46,870
or they're somehow protected but they

371
00:16:46,870 --> 00:16:49,090
costly cost them a lot comparing to

372
00:16:49,090 --> 00:16:52,240
register domains and the host an IPS for

373
00:16:52,240 --> 00:16:53,980
example you fatty the host so you can

374
00:16:53,980 --> 00:16:56,050
bodies you can purchase this bar night

375
00:16:56,050 --> 00:16:58,600
from other attackers and used for

376
00:16:58,600 --> 00:17:01,390
different purposes and the of course

377
00:17:01,390 --> 00:17:02,830
domain names although its shape it's

378
00:17:02,830 --> 00:17:06,670
going to cost something so i guess the

379
00:17:06,670 --> 00:17:08,709
question party people going to ask is

380
00:17:08,709 --> 00:17:11,290
why the resources are

381
00:17:11,290 --> 00:17:15,400
hello why the resources are reused about

382
00:17:15,400 --> 00:17:18,730
money of course just put it into one

383
00:17:18,730 --> 00:17:24,099
word it's down or because they are

384
00:17:24,099 --> 00:17:28,740
valuable and they can be used for gum

385
00:17:28,740 --> 00:17:31,740
surgery

386
00:17:33,750 --> 00:17:41,080
something is major Horner listen live I

387
00:17:41,080 --> 00:17:44,740
can just use it hello okay just use this

388
00:17:44,740 --> 00:17:55,450
one so money of course and we noticed

389
00:17:55,450 --> 00:17:58,090
this reuse of resources across different

390
00:17:58,090 --> 00:18:04,960
malicious activities for example for

391
00:18:04,960 --> 00:18:08,050
example sometimes this part net was used

392
00:18:08,050 --> 00:18:13,920
to hello sometimes they saw looked at me

393
00:18:13,920 --> 00:18:22,960
bonide was hello ok yep I'll try to hold

394
00:18:22,960 --> 00:18:25,980
the very worst deal

395
00:18:32,659 --> 00:18:38,539
so I think you get idea connections um

396
00:18:38,539 --> 00:18:40,980
so let's talk about connections what

397
00:18:40,980 --> 00:18:42,630
kind of connections were use in this

398
00:18:42,630 --> 00:18:45,240
work first the same name servers as we

399
00:18:45,240 --> 00:18:47,850
mentioned before 70s name servers can be

400
00:18:47,850 --> 00:18:49,950
used to resolve different domain names

401
00:18:49,950 --> 00:18:53,039
so they but by nature reusable and they

402
00:18:53,039 --> 00:18:56,610
often host on bulletproof servers so for

403
00:18:56,610 --> 00:18:58,799
example this is the wonderful malicious

404
00:18:58,799 --> 00:19:01,830
name servers we discovered it has taught

405
00:19:01,830 --> 00:19:03,389
are you at the end but that's not the

406
00:19:03,389 --> 00:19:05,179
reason we detected malicious name server

407
00:19:05,179 --> 00:19:08,039
over the time we find it has 128

408
00:19:08,039 --> 00:19:09,929
malicious domains actually use this name

409
00:19:09,929 --> 00:19:13,049
server to resolve to the resolve their

410
00:19:13,049 --> 00:19:19,559
dns records and so but not not not

411
00:19:19,559 --> 00:19:21,659
because of a server result of different

412
00:19:21,659 --> 00:19:23,399
domain names are some of the malicious

413
00:19:23,399 --> 00:19:27,120
domain is so we call the name server is

414
00:19:27,120 --> 00:19:28,769
actually malicious name server and use

415
00:19:28,769 --> 00:19:31,110
that in protection we have to do some

416
00:19:31,110 --> 00:19:33,840
filtering for example if the name server

417
00:19:33,840 --> 00:19:35,820
belongs to some terminal registrants not

418
00:19:35,820 --> 00:19:37,740
just the big ones like GoDaddy some

419
00:19:37,740 --> 00:19:40,500
small ones too they can be used to

420
00:19:40,500 --> 00:19:42,870
resolve many many different domain names

421
00:19:42,870 --> 00:19:45,210
and many of them could be malicious but

422
00:19:45,210 --> 00:19:49,370
we will not use them in prediction I

423
00:19:49,370 --> 00:19:52,620
could coming from like CDN or web

424
00:19:52,620 --> 00:19:55,049
hosting or sometimes just to use once

425
00:19:55,049 --> 00:19:59,009
this name server itself we are filled to

426
00:19:59,009 --> 00:20:03,539
all this out and when we find the

427
00:20:03,539 --> 00:20:05,429
candidate malicious name server that has

428
00:20:05,429 --> 00:20:08,159
potential to be used of to host of

429
00:20:08,159 --> 00:20:10,889
future malicious domains we have this

430
00:20:10,889 --> 00:20:12,779
passive DNS data feed and we search the

431
00:20:12,779 --> 00:20:15,179
passive DNS data feed regularly to find

432
00:20:15,179 --> 00:20:16,740
the malicious domains map to this name

433
00:20:16,740 --> 00:20:19,649
server um the next connection is the

434
00:20:19,649 --> 00:20:21,539
same IP address this coming from

435
00:20:21,539 --> 00:20:23,490
heuristic that in fact the host has be

436
00:20:23,490 --> 00:20:27,690
used for different purposes um so first

437
00:20:27,690 --> 00:20:29,789
there's no malicious domains IP address

438
00:20:29,789 --> 00:20:32,100
each domain map to some IP address and

439
00:20:32,100 --> 00:20:35,429
the second source of information is a

440
00:20:35,429 --> 00:20:37,649
sinkhole identify infected host we have

441
00:20:37,649 --> 00:20:39,030
our own sinkhole project

442
00:20:39,030 --> 00:20:40,590
that has been collecting in fact the

443
00:20:40,590 --> 00:20:44,280
house I piece but problem again you need

444
00:20:44,280 --> 00:20:46,920
to do some filtering the purpose of

445
00:20:46,920 --> 00:20:48,900
filtering is to identify the nature of

446
00:20:48,900 --> 00:20:51,240
functionality of the psyche for example

447
00:20:51,240 --> 00:20:54,140
some of this IP a portal IPS like

448
00:20:54,140 --> 00:20:57,630
there's the usenet so the infected host

449
00:20:57,630 --> 00:20:59,280
as you're behind this IP you cannot use

450
00:20:59,280 --> 00:21:01,590
like this I hear obviously some of the

451
00:21:01,590 --> 00:21:04,200
cloud IP is like from AWS from Claude

452
00:21:04,200 --> 00:21:07,020
fair and others like city and web

453
00:21:07,020 --> 00:21:10,170
hosting at ease so basically we find

454
00:21:10,170 --> 00:21:11,880
that the IPS has been used associate

455
00:21:11,880 --> 00:21:13,320
with malicious two men before we apply

456
00:21:13,320 --> 00:21:15,450
the filtering and the rest we use them

457
00:21:15,450 --> 00:21:21,480
to do the prediction um the third one is

458
00:21:21,480 --> 00:21:23,310
the same or similar register into

459
00:21:23,310 --> 00:21:25,950
information the reason we use the

460
00:21:25,950 --> 00:21:27,750
different malicious dementia from

461
00:21:27,750 --> 00:21:29,970
different times share similar who is

462
00:21:29,970 --> 00:21:33,510
information is because sometimes the

463
00:21:33,510 --> 00:21:35,220
attackers like to embody some pseudo

464
00:21:35,220 --> 00:21:37,140
identification information like fake

465
00:21:37,140 --> 00:21:42,360
characters other cases like a batch of

466
00:21:42,360 --> 00:21:44,280
domains which I actually registered

467
00:21:44,280 --> 00:21:47,370
together using stolen credentials and

468
00:21:47,370 --> 00:21:49,740
they are used over time for like one by

469
00:21:49,740 --> 00:21:52,680
one so there's the connection so how do

470
00:21:52,680 --> 00:21:54,240
we search for this connection we search

471
00:21:54,240 --> 00:21:57,420
for registrant names address emails

472
00:21:57,420 --> 00:21:59,880
phone numbers and the date registering

473
00:21:59,880 --> 00:22:02,250
date and for different type of

474
00:22:02,250 --> 00:22:04,350
information when we do the searching we

475
00:22:04,350 --> 00:22:06,060
use either use fuzzy matching or we use

476
00:22:06,060 --> 00:22:12,150
exam match on the last type of pro sure

477
00:22:12,150 --> 00:22:16,350
we use is DNS queries remember the life

478
00:22:16,350 --> 00:22:17,940
cycle of malicious to men's there is the

479
00:22:17,940 --> 00:22:20,040
step between you register domain name to

480
00:22:20,040 --> 00:22:23,010
your set up dns server and to the actual

481
00:22:23,010 --> 00:22:25,620
activation there's some time gap over

482
00:22:25,620 --> 00:22:27,570
there and there will be some patterns in

483
00:22:27,570 --> 00:22:31,050
the dns queries so since we have the

484
00:22:31,050 --> 00:22:36,750
passive DNS data collection we can

485
00:22:36,750 --> 00:22:39,840
looking for this specific patterns the

486
00:22:39,840 --> 00:22:41,190
patterns the for example when you're

487
00:22:41,190 --> 00:22:43,380
setting up dns servers or when you

488
00:22:43,380 --> 00:22:46,440
modify in the dns records or when you

489
00:22:46,440 --> 00:22:48,390
testing something as resolutions this is

490
00:22:48,390 --> 00:22:50,310
the normal stuff people go to to make

491
00:22:50,310 --> 00:22:51,570
sure that the u.s. actually works

492
00:22:51,570 --> 00:22:52,830
whether for militia

493
00:22:52,830 --> 00:22:55,230
purpose of benign purposes they're

494
00:22:55,230 --> 00:22:57,059
different from when the domain is up

495
00:22:57,059 --> 00:23:00,210
different dns queries coming in so there

496
00:23:00,210 --> 00:23:02,059
will be different to temporal patterns

497
00:23:02,059 --> 00:23:05,909
for example this actually is as in

498
00:23:05,909 --> 00:23:07,980
another case the sudden outbreak of the

499
00:23:07,980 --> 00:23:09,990
Indians queries this is used for

500
00:23:09,990 --> 00:23:12,630
detector and provide early warning on

501
00:23:12,630 --> 00:23:15,480
outbreak of these malicious activities I

502
00:23:15,480 --> 00:23:17,730
thought all of sudden this domain was

503
00:23:17,730 --> 00:23:19,679
put in use and all the queries has come

504
00:23:19,679 --> 00:23:23,970
in and periodic Aquarius this is most

505
00:23:23,970 --> 00:23:26,010
likely made by some automatically ways

506
00:23:26,010 --> 00:23:30,240
like a code and of course the Q name the

507
00:23:30,240 --> 00:23:33,179
query the query name is DGA like its

508
00:23:33,179 --> 00:23:34,950
look like a random or look like new

509
00:23:34,950 --> 00:23:40,169
malicious domains so that are the four

510
00:23:40,169 --> 00:23:44,850
types of patterns we're looking for we

511
00:23:44,850 --> 00:23:48,269
do the prediction and we did some

512
00:23:48,269 --> 00:23:51,360
evaluations as well of course before the

513
00:23:51,360 --> 00:23:53,159
evaluation among to just briefly

514
00:23:53,159 --> 00:23:55,380
introduce the data set because of all

515
00:23:55,380 --> 00:23:58,350
these heuristics approaches they have to

516
00:23:58,350 --> 00:24:01,049
work on large set of live data in order

517
00:24:01,049 --> 00:24:03,230
to actually capture something meaningful

518
00:24:03,230 --> 00:24:07,260
so the first thing is passively as data

519
00:24:07,260 --> 00:24:10,010
collection we have collaboration with

520
00:24:10,010 --> 00:24:13,429
passive DNS provider called the far set

521
00:24:13,429 --> 00:24:17,309
use without SI e and we also have our

522
00:24:17,309 --> 00:24:20,190
own passive DNS collections roughly we

523
00:24:20,190 --> 00:24:23,309
have like 1.5 billing dance queries from

524
00:24:23,309 --> 00:24:25,679
in per day and we have our own Cinco

525
00:24:25,679 --> 00:24:28,799
project up to now we already have 1.2

526
00:24:28,799 --> 00:24:31,769
billion incoming connections and 208 m

527
00:24:31,769 --> 00:24:34,980
eating infected IP address and we have

528
00:24:34,980 --> 00:24:37,350
the whois records every day we will just

529
00:24:37,350 --> 00:24:40,320
query who is the whois records for new

530
00:24:40,320 --> 00:24:42,269
malicious domains or the past malicious

531
00:24:42,269 --> 00:24:43,919
demand sieved who is records has been

532
00:24:43,919 --> 00:24:46,620
changed or updated and at last we have

533
00:24:46,620 --> 00:24:49,279
that location database provide the

534
00:24:49,279 --> 00:24:51,389
geolocation and the registering

535
00:24:51,389 --> 00:24:56,039
information for IP segments so um this

536
00:24:56,039 --> 00:24:57,899
is how we do the evaluation first we are

537
00:24:57,899 --> 00:25:00,059
we predict a list of them within

538
00:25:00,059 --> 00:25:01,919
malicious domains that will be used or

539
00:25:01,919 --> 00:25:04,289
about to be used for malicious purpose

540
00:25:04,289 --> 00:25:06,690
and we publish them as

541
00:25:06,690 --> 00:25:09,870
part of our DNA signature and we do

542
00:25:09,870 --> 00:25:11,490
Article II checked the virus total just

543
00:25:11,490 --> 00:25:15,930
as a reference so it turns out over

544
00:25:15,930 --> 00:25:17,910
eighty percent of these domains on our

545
00:25:17,910 --> 00:25:20,790
list eventually we'll have the worst

546
00:25:20,790 --> 00:25:22,530
total detection rate larger than one and

547
00:25:22,530 --> 00:25:24,930
by the way that's not us we're not on

548
00:25:24,930 --> 00:25:28,230
the worst photo least another thing is

549
00:25:28,230 --> 00:25:30,720
to because the prediction is about to

550
00:25:30,720 --> 00:25:33,240
like put a malicious two men out there

551
00:25:33,240 --> 00:25:35,520
before they're used to give some time

552
00:25:35,520 --> 00:25:38,100
advantage so we measure that by the time

553
00:25:38,100 --> 00:25:40,770
difference that we release the detected

554
00:25:40,770 --> 00:25:43,610
domain as malicious domain and the

555
00:25:43,610 --> 00:25:46,440
domains actually shows up in passivity

556
00:25:46,440 --> 00:25:49,200
as fees we think when it shows up in

557
00:25:49,200 --> 00:25:51,180
somebody's ash doing the query and there

558
00:25:51,180 --> 00:25:53,600
are maybe trying to use it so on average

559
00:25:53,600 --> 00:25:57,570
we have eight hours advance the time

560
00:25:57,570 --> 00:25:59,640
difference between we detect and

561
00:25:59,640 --> 00:26:01,350
published the link to it shows up in

562
00:26:01,350 --> 00:26:04,440
passiveness feet and the last one is

563
00:26:04,440 --> 00:26:08,520
done we publish these domains and their

564
00:26:08,520 --> 00:26:10,380
signatures and they will be applied in

565
00:26:10,380 --> 00:26:12,330
your productive our wars and the we can

566
00:26:12,330 --> 00:26:13,650
monitor how many of the signature has

567
00:26:13,650 --> 00:26:16,110
been triggered so over half of them has

568
00:26:16,110 --> 00:26:20,820
been triggered but this this only coming

569
00:26:20,820 --> 00:26:23,670
from like five or six different fare

570
00:26:23,670 --> 00:26:25,650
awards that we have control for the rest

571
00:26:25,650 --> 00:26:27,900
of fairway don't even know whether they

572
00:26:27,900 --> 00:26:34,890
are trigger or not so a summary um this

573
00:26:34,890 --> 00:26:37,080
is a as I mentioned before first step

574
00:26:37,080 --> 00:26:38,670
towards the perfecting of malicious

575
00:26:38,670 --> 00:26:41,280
domains and we propose different

576
00:26:41,280 --> 00:26:45,360
approaches based on two observations one

577
00:26:45,360 --> 00:26:46,770
is the dominant life cycle and the

578
00:26:46,770 --> 00:26:49,500
secondary use of valuable resources and

579
00:26:49,500 --> 00:26:52,230
the devaluation shows that it is

580
00:26:52,230 --> 00:26:54,470
actually effective in protecting

581
00:26:54,470 --> 00:26:59,250
malicious domains um so with that I will

582
00:26:59,250 --> 00:27:01,050
take questions and thank you guys for

583
00:27:01,050 --> 00:27:02,940
your patience and you know the change of

584
00:27:02,940 --> 00:27:05,750
the devices

585
00:27:09,980 --> 00:27:12,330
so we do have several minutes for

586
00:27:12,330 --> 00:27:17,689
questions is anyone up yep

