1
00:00:00,000 --> 00:00:02,190
so the third presentation of this

2
00:00:02,190 --> 00:00:07,170
morning is by tbell heavy and DMI drewb

3
00:00:07,170 --> 00:00:11,269
so without further ado please go ahead

4
00:00:11,660 --> 00:00:15,450
thank you very much so hi everybody hi

5
00:00:15,450 --> 00:00:17,520
virus Bolton very pleased to be here

6
00:00:17,520 --> 00:00:19,470
it's an honor to be invited at the virus

7
00:00:19,470 --> 00:00:20,730
Bolton's the first time for us

8
00:00:20,730 --> 00:00:22,980
especially first time in Seattle as well

9
00:00:22,980 --> 00:00:25,830
beautiful city so the title of this

10
00:00:25,830 --> 00:00:27,859
presentation is designed to discover

11
00:00:27,859 --> 00:00:29,880
security analytics with a 3d

12
00:00:29,880 --> 00:00:34,110
visualization engine now allow me to

13
00:00:34,110 --> 00:00:36,180
quickly introduce myself i'm t-bo hi I'm

14
00:00:36,180 --> 00:00:39,239
a security researcher opendns and the

15
00:00:39,239 --> 00:00:41,100
main focus of my research is data

16
00:00:41,100 --> 00:00:44,239
visualization before that I used to be a

17
00:00:44,239 --> 00:00:47,010
software engineer at Nvidia for like

18
00:00:47,010 --> 00:00:49,980
four years and now I apply my data

19
00:00:49,980 --> 00:00:51,899
visualization technique in 3d graphics

20
00:00:51,899 --> 00:00:55,020
technique to pretty much the data are we

21
00:00:55,020 --> 00:00:59,250
having every day I opendns and then I'm

22
00:00:59,250 --> 00:01:01,289
DMA soup so some of you already saw me

23
00:01:01,289 --> 00:01:03,629
in a previous talk and the focus of what

24
00:01:03,629 --> 00:01:05,939
they do is basically analyze our DNS

25
00:01:05,939 --> 00:01:09,750
data and IP infrastructure to discover

26
00:01:09,750 --> 00:01:13,590
new threats without further ado the

27
00:01:13,590 --> 00:01:15,180
agenda of today will be as follows so

28
00:01:15,180 --> 00:01:16,920
we'll start with a presentation of open

29
00:01:16,920 --> 00:01:19,200
dns and then we'll talk about our threat

30
00:01:19,200 --> 00:01:21,780
intelligence platform we called 3d s

31
00:01:21,780 --> 00:01:24,090
graph for 3d investigate and then we'll

32
00:01:24,090 --> 00:01:26,759
talk about one of the models we have the

33
00:01:26,759 --> 00:01:28,380
co-occurrences model which is very

34
00:01:28,380 --> 00:01:31,280
useful to discover new attack domains

35
00:01:31,280 --> 00:01:34,470
the way we explore this core Curren is a

36
00:01:34,470 --> 00:01:36,540
graph because it's about the graph as

37
00:01:36,540 --> 00:01:38,700
you'll see later is to use a ripple

38
00:01:38,700 --> 00:01:42,000
effect phenomena and we'll explain it

39
00:01:42,000 --> 00:01:44,520
and then we'll showcase this model with

40
00:01:44,520 --> 00:01:46,890
two use cases one about cryptolocker and

41
00:01:46,890 --> 00:01:48,329
the other one about Zeus came over and

42
00:01:48,329 --> 00:01:50,270
then we'll conclude with some

43
00:01:50,270 --> 00:01:54,110
interesting points so the opendns

44
00:01:54,110 --> 00:01:56,969
worldwide presence consists in 23 data

45
00:01:56,969 --> 00:02:00,060
centers across four continents and that

46
00:02:00,060 --> 00:02:02,310
allows us to see a lot of traffic it's

47
00:02:02,310 --> 00:02:04,049
of two types so we have the recursive

48
00:02:04,049 --> 00:02:06,270
traffic which is between our users and

49
00:02:06,270 --> 00:02:09,149
us our resolvers so for that you'll see

50
00:02:09,149 --> 00:02:11,129
like time stamps client IPS and domains

51
00:02:11,129 --> 00:02:12,340
with some other

52
00:02:12,340 --> 00:02:14,930
features and then on the other side you

53
00:02:14,930 --> 00:02:16,430
have the authoritative traffic and

54
00:02:16,430 --> 00:02:18,049
that's basically between our resolvers

55
00:02:18,049 --> 00:02:19,639
and the authoritative name servers of

56
00:02:19,639 --> 00:02:21,590
the internet and that's how we basically

57
00:02:21,590 --> 00:02:27,799
build our DNS DB so all of that data

58
00:02:27,799 --> 00:02:29,719
allowed us to build this threat

59
00:02:29,719 --> 00:02:32,269
intelligence platform and as you see

60
00:02:32,269 --> 00:02:34,219
here it's the web interface so at the at

61
00:02:34,219 --> 00:02:37,219
the top you can enter like a domain an

62
00:02:37,219 --> 00:02:39,799
IP or an asn in this case it's virus

63
00:02:39,799 --> 00:02:42,200
bulletin com and then what we can see is

64
00:02:42,200 --> 00:02:45,530
the traffic or the lookups over the past

65
00:02:45,530 --> 00:02:48,680
30 days from our users and interestingly

66
00:02:48,680 --> 00:02:50,599
you see that virus bulletin is a popular

67
00:02:50,599 --> 00:02:52,909
site because it's a periodic pattern

68
00:02:52,909 --> 00:02:55,669
with some spikes in some days but

69
00:02:55,669 --> 00:02:57,949
overall across all of the data centers

70
00:02:57,949 --> 00:03:00,079
you see that people regularly go visit

71
00:03:00,079 --> 00:03:02,510
the site you know to get all kinds of

72
00:03:02,510 --> 00:03:03,889
information about the conference or

73
00:03:03,889 --> 00:03:07,340
about blogs and other info the other

74
00:03:07,340 --> 00:03:09,829
thing you can see at the second part of

75
00:03:09,829 --> 00:03:13,969
the like the slide is that you have the

76
00:03:13,969 --> 00:03:15,769
requestor geo distribution and that's

77
00:03:15,769 --> 00:03:18,769
basically a breakdown by countries that

78
00:03:18,769 --> 00:03:21,019
are looking up this domain so again you

79
00:03:21,019 --> 00:03:23,239
can see how popular a domain is across

80
00:03:23,239 --> 00:03:26,479
different geographical regions the other

81
00:03:26,479 --> 00:03:28,819
part of this web page and obviously you

82
00:03:28,819 --> 00:03:33,079
could use this via bulk API look up but

83
00:03:33,079 --> 00:03:34,459
what we see on the web interface is

84
00:03:34,459 --> 00:03:36,439
basically the IP address so in this case

85
00:03:36,439 --> 00:03:38,479
it's a cname so it's an alias for

86
00:03:38,479 --> 00:03:41,659
another host name that has an IP and we

87
00:03:41,659 --> 00:03:43,459
also can see the name servers IP so

88
00:03:43,459 --> 00:03:44,989
since we see the authoritative traffic

89
00:03:44,989 --> 00:03:47,060
then we have also visibility into all of

90
00:03:47,060 --> 00:03:49,030
the nameservers IPS that respond to us

91
00:03:49,030 --> 00:03:52,459
with the records and in case of DNS

92
00:03:52,459 --> 00:03:54,590
hijacking you'll be able to figure out

93
00:03:54,590 --> 00:03:57,379
if there are some anomaly anomalies in

94
00:03:57,379 --> 00:03:59,900
the responses you're getting and finally

95
00:03:59,900 --> 00:04:01,370
at the bottom you have the

96
00:04:01,370 --> 00:04:03,139
co-occurrences and related domains and

97
00:04:03,139 --> 00:04:05,389
these are the kind of the topic of the

98
00:04:05,389 --> 00:04:06,919
stock because we're talking about

99
00:04:06,919 --> 00:04:08,750
domains that have been looked up by the

100
00:04:08,750 --> 00:04:10,280
same people you're in a short time

101
00:04:10,280 --> 00:04:12,379
period and in this case we see that

102
00:04:12,379 --> 00:04:18,738
virus bulletin is popular also with AV

103
00:04:18,738 --> 00:04:20,988
tests and use nicks and these are

104
00:04:20,988 --> 00:04:23,510
security related sites so somewhat you

105
00:04:23,510 --> 00:04:25,580
can also find other related sites in

106
00:04:25,580 --> 00:04:26,000
terms of

107
00:04:26,000 --> 00:04:33,290
themes or campaigns or topics so as di

108
00:04:33,290 --> 00:04:35,270
just explained the security graph is an

109
00:04:35,270 --> 00:04:37,550
amazing tool you know to have a lot

110
00:04:37,550 --> 00:04:39,710
indicators and emergency mash up all the

111
00:04:39,710 --> 00:04:41,840
information that we have extracted from

112
00:04:41,840 --> 00:04:44,180
our DNS logs but I would like to give

113
00:04:44,180 --> 00:04:46,070
you a different perspective of the

114
00:04:46,070 --> 00:04:48,500
security graph the first one the web UI

115
00:04:48,500 --> 00:04:51,500
is showing you one IP one is no.1 domain

116
00:04:51,500 --> 00:04:54,170
and has a lot information but let's try

117
00:04:54,170 --> 00:04:56,000
to step back a little bit and look at

118
00:04:56,000 --> 00:04:58,400
you know several domain or IPS together

119
00:04:58,400 --> 00:05:00,950
and this is what we obtain so in this

120
00:05:00,950 --> 00:05:04,100
model we have a graph at 3d graph that

121
00:05:04,100 --> 00:05:06,950
we extracted from wikileaks org and as

122
00:05:06,950 --> 00:05:08,930
you can see there's a certain color code

123
00:05:08,930 --> 00:05:12,950
the white nodes are the domain names the

124
00:05:12,950 --> 00:05:15,919
cyan light blue nodes are the IP

125
00:05:15,919 --> 00:05:19,820
addresses the yellow ones are like the

126
00:05:19,820 --> 00:05:22,010
who is information that we have and the

127
00:05:22,010 --> 00:05:24,950
purple ones are the s and numbers so we

128
00:05:24,950 --> 00:05:26,240
have pretty much different types of

129
00:05:26,240 --> 00:05:27,950
nodes inside this graph and these are

130
00:05:27,950 --> 00:05:29,720
all the internet entities that we

131
00:05:29,720 --> 00:05:33,140
extract from our DNS logs and also we

132
00:05:33,140 --> 00:05:34,729
have different type of edges makes

133
00:05:34,729 --> 00:05:36,710
complete sense we have you know domain

134
00:05:36,710 --> 00:05:39,229
to IP mapping so that's a relationship

135
00:05:39,229 --> 00:05:42,110
between domain an IP we have domain to

136
00:05:42,110 --> 00:05:43,550
who is information we know who

137
00:05:43,550 --> 00:05:46,400
registered the domain we have you know

138
00:05:46,400 --> 00:05:48,320
different domain connected together that

139
00:05:48,320 --> 00:05:49,550
could be related domains or

140
00:05:49,550 --> 00:05:51,530
co-occurrences the one that dr just

141
00:05:51,530 --> 00:05:54,290
explained and you can see on some edges

142
00:05:54,290 --> 00:05:56,000
you have a certain small particle

143
00:05:56,000 --> 00:05:59,030
floating over them we mapped the speed

144
00:05:59,030 --> 00:06:00,710
of that particle on what we call the

145
00:06:00,710 --> 00:06:02,060
co-occurrence core we're going to

146
00:06:02,060 --> 00:06:03,440
describe it a little bit later but

147
00:06:03,440 --> 00:06:05,660
essentially it's a in summary is pretty

148
00:06:05,660 --> 00:06:07,160
much looking at traffic in the amount of

149
00:06:07,160 --> 00:06:12,740
traffic as you can see the security

150
00:06:12,740 --> 00:06:15,050
graph is a graph so we'd like to cover a

151
00:06:15,050 --> 00:06:16,729
couple of fundamentals before we go

152
00:06:16,729 --> 00:06:20,000
deeper into details so the graph in

153
00:06:20,000 --> 00:06:22,490
essence is a set of nodes and edges it's

154
00:06:22,490 --> 00:06:24,500
also called vertices so as you can see

155
00:06:24,500 --> 00:06:27,350
in this example 0 1 2 3 represents the

156
00:06:27,350 --> 00:06:30,350
nodes and all the ages 0 is connected to

157
00:06:30,350 --> 00:06:33,440
10 is connected to two etc etc that

158
00:06:33,440 --> 00:06:35,090
gives you a representation the visual

159
00:06:35,090 --> 00:06:37,280
image that you have here is pretty much

160
00:06:37,280 --> 00:06:38,729
a representation of the

161
00:06:38,729 --> 00:06:41,339
more definition of the graph now

162
00:06:41,339 --> 00:06:43,589
obviously graph theory is much more

163
00:06:43,589 --> 00:06:46,620
complicated in that in you know we

164
00:06:46,620 --> 00:06:48,330
pretty much bill graphs I have different

165
00:06:48,330 --> 00:06:50,039
types of no different type of edges and

166
00:06:50,039 --> 00:06:53,069
we do a lot of things with them some

167
00:06:53,069 --> 00:06:55,199
metrics just so you have an idea of the

168
00:06:55,199 --> 00:06:57,719
size of the graph we're dealing with so

169
00:06:57,719 --> 00:06:59,129
it's a semantic web based on our DNS

170
00:06:59,129 --> 00:07:03,419
logs we have around 60 million DNS

171
00:07:03,419 --> 00:07:06,120
requests per day and that gives us after

172
00:07:06,120 --> 00:07:09,360
refining the information like around 46

173
00:07:09,360 --> 00:07:11,309
million notes per day that only includes

174
00:07:11,309 --> 00:07:14,879
domain and IP and after that thousand

175
00:07:14,879 --> 00:07:19,199
and sorry 174 million edges per day and

176
00:07:19,199 --> 00:07:23,009
let's also domain IP mapping so dealing

177
00:07:23,009 --> 00:07:25,439
with a graph that size gives us a really

178
00:07:25,439 --> 00:07:27,960
interesting challenges especially in

179
00:07:27,960 --> 00:07:30,719
term data visualization and we can

180
00:07:30,719 --> 00:07:32,520
pretty much summarize all different

181
00:07:32,520 --> 00:07:34,620
approaches you know with this this

182
00:07:34,620 --> 00:07:36,569
triangle the first one would be the

183
00:07:36,569 --> 00:07:38,129
grouping technique is how we can deal

184
00:07:38,129 --> 00:07:40,289
with big data grouping is pretty much

185
00:07:40,289 --> 00:07:43,319
looking at the high level view of the

186
00:07:43,319 --> 00:07:45,389
security graph for example if you take

187
00:07:45,389 --> 00:07:46,949
the graph of all the employees in

188
00:07:46,949 --> 00:07:49,080
company while grouping would be grouping

189
00:07:49,080 --> 00:07:50,909
the employees by teams and you can still

190
00:07:50,909 --> 00:07:52,740
see the hierarchy even though you lose

191
00:07:52,740 --> 00:07:56,159
some granularity sampling would be you

192
00:07:56,159 --> 00:07:57,360
know just look in a certain neighborhood

193
00:07:57,360 --> 00:07:59,599
with finer details but like completely

194
00:07:59,599 --> 00:08:01,740
discarding the rest so for example that

195
00:08:01,740 --> 00:08:03,689
would be looking at me my manager my

196
00:08:03,689 --> 00:08:05,839
colleagues and people under me and

197
00:08:05,839 --> 00:08:08,370
parallelization when all hope is lost to

198
00:08:08,370 --> 00:08:10,620
refine like filter out the information

199
00:08:10,620 --> 00:08:12,719
you just use more power to process the

200
00:08:12,719 --> 00:08:15,180
information now let's take a look at

201
00:08:15,180 --> 00:08:18,499
very very interesting on first use case

202
00:08:18,499 --> 00:08:20,849
so our first use case will be

203
00:08:20,849 --> 00:08:22,649
cryptolocker and then we'll explain how

204
00:08:22,649 --> 00:08:25,050
we can use the model to explore the

205
00:08:25,050 --> 00:08:27,809
domains relate to it so all of you know

206
00:08:27,809 --> 00:08:30,330
about cryptolocker it came on the threat

207
00:08:30,330 --> 00:08:33,539
surface back in november or last fall

208
00:08:33,539 --> 00:08:35,639
and then it in a nutshell it's a

209
00:08:35,639 --> 00:08:38,339
ransomware where if you get infected

210
00:08:38,339 --> 00:08:41,159
then it will try to communicate with

211
00:08:41,159 --> 00:08:43,799
dj's and if one of them resolves and it

212
00:08:43,799 --> 00:08:46,110
will download a public key and then that

213
00:08:46,110 --> 00:08:47,670
public key is used in a process that

214
00:08:47,670 --> 00:08:49,329
will encrypt

215
00:08:49,329 --> 00:08:51,249
the files on your disk and then you have

216
00:08:51,249 --> 00:08:53,079
a splash screen that will ask you to pay

217
00:08:53,079 --> 00:08:55,899
the ransom otherwise all your data is

218
00:08:55,899 --> 00:08:59,170
not we'll never get recovered now the

219
00:08:59,170 --> 00:09:01,360
thing is we use the co-occurrences model

220
00:09:01,360 --> 00:09:03,549
to track down these domains so you don't

221
00:09:03,549 --> 00:09:05,619
have to necessarily have the sample to

222
00:09:05,619 --> 00:09:08,170
grab the algorithm or to observe what

223
00:09:08,170 --> 00:09:11,079
the lockups are looking like what we do

224
00:09:11,079 --> 00:09:13,179
here is we use our logs the query log so

225
00:09:13,179 --> 00:09:15,249
we have the timestamp client IP and then

226
00:09:15,249 --> 00:09:17,170
domain and then we use the temporal

227
00:09:17,170 --> 00:09:19,449
proximity of domain lookups and for that

228
00:09:19,449 --> 00:09:20,920
you build a bipartite graph between

229
00:09:20,920 --> 00:09:22,869
client IP is looking up domains during a

230
00:09:22,869 --> 00:09:24,939
short time period and from that graph

231
00:09:24,939 --> 00:09:26,619
you'll build another one where you

232
00:09:26,619 --> 00:09:28,209
basically build an edge between two

233
00:09:28,209 --> 00:09:30,249
domains if they have been looked up by

234
00:09:30,249 --> 00:09:32,049
the same clients during that short time

235
00:09:32,049 --> 00:09:33,850
period so let's say as earlier we saw

236
00:09:33,850 --> 00:09:36,129
virus bulletin what's going with let's

237
00:09:36,129 --> 00:09:39,339
say usenix com org or with a V test or

238
00:09:39,339 --> 00:09:41,589
some other AV vendor and that's because

239
00:09:41,589 --> 00:09:43,329
a lot of people went to visit virus

240
00:09:43,329 --> 00:09:45,489
bulletins website but they also they

241
00:09:45,489 --> 00:09:47,920
were also interested in visiting other

242
00:09:47,920 --> 00:09:50,949
security you know conference sites and

243
00:09:50,949 --> 00:09:54,850
related things so that allows us to kind

244
00:09:54,850 --> 00:09:57,189
of study interesting use cases so the

245
00:09:57,189 --> 00:09:58,839
first one that we mentioned is the

246
00:09:58,839 --> 00:10:01,480
botnet C&C so in the case of dj's if you

247
00:10:01,480 --> 00:10:03,579
have malware that is looking up domains

248
00:10:03,579 --> 00:10:07,139
in succession with a high kind of

249
00:10:07,139 --> 00:10:09,429
repetitively then you will see it in the

250
00:10:09,429 --> 00:10:11,019
logs and that way you can build those

251
00:10:11,019 --> 00:10:12,660
edges between the co-occurring domains

252
00:10:12,660 --> 00:10:15,910
the other case was very interesting

253
00:10:15,910 --> 00:10:19,600
because for instance as an example last

254
00:10:19,600 --> 00:10:22,029
fall when the target breach happened we

255
00:10:22,029 --> 00:10:23,769
saw Spike to a lot of carding sites

256
00:10:23,769 --> 00:10:25,179
selling the stolen credit card

257
00:10:25,179 --> 00:10:27,220
information so we started with the seed

258
00:10:27,220 --> 00:10:28,869
of these domains and then we explore the

259
00:10:28,869 --> 00:10:31,239
core courses graph and we were able to

260
00:10:31,239 --> 00:10:33,399
grab a lot of other related carding

261
00:10:33,399 --> 00:10:35,410
sites but also some hacking forums and

262
00:10:35,410 --> 00:10:38,410
you know sites that are related to the

263
00:10:38,410 --> 00:10:42,100
underground market I would say the other

264
00:10:42,100 --> 00:10:43,989
interesting case is when you deal with

265
00:10:43,989 --> 00:10:45,939
click fraud so we have a lot of infected

266
00:10:45,939 --> 00:10:48,489
machines trying to connect to all these

267
00:10:48,489 --> 00:10:51,309
sites and trying to generate fake clicks

268
00:10:51,309 --> 00:10:53,889
so you'll see that in the logs and using

269
00:10:53,889 --> 00:10:55,629
the co-occurrences model you can also

270
00:10:55,629 --> 00:10:58,600
tie them together without even having

271
00:10:58,600 --> 00:11:00,819
infected machines with a sample

272
00:11:00,819 --> 00:11:04,089
trying to dissect it on a host so that's

273
00:11:04,089 --> 00:11:05,619
kind of the power here of the of the

274
00:11:05,619 --> 00:11:08,289
model now the way we explore the score

275
00:11:08,289 --> 00:11:10,569
curses graph is pretty simple we call it

276
00:11:10,569 --> 00:11:12,249
the ripple effect just for like a nice

277
00:11:12,249 --> 00:11:15,100
name that it's basically a BFS that goes

278
00:11:15,100 --> 00:11:17,829
from a seed of domains and then it goes

279
00:11:17,829 --> 00:11:20,499
either multiple levels or it just stops

280
00:11:20,499 --> 00:11:26,049
after a number of visited domains let's

281
00:11:26,049 --> 00:11:27,549
take a look at a visual representation

282
00:11:27,549 --> 00:11:29,319
what a BFS and different sampling

283
00:11:29,319 --> 00:11:31,779
techniques mean so on the left side you

284
00:11:31,779 --> 00:11:34,299
have representation of the BFS I start

285
00:11:34,299 --> 00:11:36,429
with number zero which is my seed domain

286
00:11:36,429 --> 00:11:39,939
then I traverso explore the first ripple

287
00:11:39,939 --> 00:11:41,859
the number one then number two so

288
00:11:41,859 --> 00:11:43,749
essentially I take a note the neighbors

289
00:11:43,749 --> 00:11:45,189
neighbors the neighbors neighbors

290
00:11:45,189 --> 00:11:48,220
neighbors neighbors etc etc on different

291
00:11:48,220 --> 00:11:51,039
levels this sampling technique has some

292
00:11:51,039 --> 00:11:52,539
defects and we're going to explain them

293
00:11:52,539 --> 00:11:54,879
a little bit later but let's consider

294
00:11:54,879 --> 00:11:56,499
this new one the random walk technique

295
00:11:56,499 --> 00:11:58,779
is also very interesting we start from

296
00:11:58,779 --> 00:12:00,639
one known domain and then we choose a

297
00:12:00,639 --> 00:12:03,220
random path in start inside the huge

298
00:12:03,220 --> 00:12:05,859
graph that we have to deal with so

299
00:12:05,859 --> 00:12:07,569
essentially this random walk is going to

300
00:12:07,569 --> 00:12:09,220
be ten steps as you can see here start

301
00:12:09,220 --> 00:12:10,329
from the root and then choose a

302
00:12:10,329 --> 00:12:12,729
completely random direction and I do

303
00:12:12,729 --> 00:12:14,859
that a couple of times and the result is

304
00:12:14,859 --> 00:12:16,779
pretty much a sum of all the random path

305
00:12:16,779 --> 00:12:19,179
of the inside this huge graphs that can

306
00:12:19,179 --> 00:12:20,649
give you even if you discard love

307
00:12:20,649 --> 00:12:22,689
information you can see deeper in the

308
00:12:22,689 --> 00:12:24,369
neighborhood and you can see pretty much

309
00:12:24,369 --> 00:12:26,769
a structure of your cluster and so the

310
00:12:26,769 --> 00:12:29,589
structure of everything is around you so

311
00:12:29,589 --> 00:12:31,600
let's apply that to cryptolocker and see

312
00:12:31,600 --> 00:12:34,419
how it looks like so here in this graph

313
00:12:34,419 --> 00:12:36,729
this is so cool currents graph and we

314
00:12:36,729 --> 00:12:38,499
have a collar coat all the red nodes are

315
00:12:38,499 --> 00:12:41,199
the known DJ domains all the green ones

316
00:12:41,199 --> 00:12:42,699
are completely benign domain have

317
00:12:42,699 --> 00:12:44,829
nothing to do with cryptolocker and all

318
00:12:44,829 --> 00:12:47,049
the white ones are the ones which we

319
00:12:47,049 --> 00:12:48,579
haven't classified yet we don't know

320
00:12:48,579 --> 00:12:50,350
anything about them so it's very

321
00:12:50,350 --> 00:12:52,629
interesting to see that's just looking

322
00:12:52,629 --> 00:12:54,939
at this those co-occurrences using the

323
00:12:54,939 --> 00:12:57,579
ripple effect this BFS and extracting

324
00:12:57,579 --> 00:12:59,799
all the neighboring co-occurrences we

325
00:12:59,799 --> 00:13:01,629
can discover clusters new clusters of

326
00:13:01,629 --> 00:13:04,299
DGA domains also one thing that is

327
00:13:04,299 --> 00:13:06,729
important to notice here is that we have

328
00:13:06,729 --> 00:13:09,009
this pretty much green cluster here that

329
00:13:09,009 --> 00:13:12,369
is connected to those red ones but if

330
00:13:12,369 --> 00:13:13,730
you remember at the big

331
00:13:13,730 --> 00:13:15,560
of the presentation we talked about the

332
00:13:15,560 --> 00:13:17,180
co-occurrence core which is pretty much

333
00:13:17,180 --> 00:13:18,769
the amount of traffic transitional

334
00:13:18,769 --> 00:13:21,769
traffic you can see that between the red

335
00:13:21,769 --> 00:13:24,829
and green cluster you have a very slow

336
00:13:24,829 --> 00:13:26,720
particle which means we have very few

337
00:13:26,720 --> 00:13:29,060
traffic there's pretty much noise so if

338
00:13:29,060 --> 00:13:30,740
you do an interesting analogy between

339
00:13:30,740 --> 00:13:33,680
you know instructing the DG domains and

340
00:13:33,680 --> 00:13:35,240
extracting the brain tumor that would be

341
00:13:35,240 --> 00:13:37,639
pretty much having a certain co-current

342
00:13:37,639 --> 00:13:39,949
threshold and cutting the edges just to

343
00:13:39,949 --> 00:13:43,010
extract the right cluster now let's see

344
00:13:43,010 --> 00:13:44,839
how the random walk works from those

345
00:13:44,839 --> 00:13:49,579
data sets here's the same technique we

346
00:13:49,579 --> 00:13:51,620
start with one known jejeje domain that

347
00:13:51,620 --> 00:13:53,570
wasn't the same day but it's it's the

348
00:13:53,570 --> 00:13:56,570
same button it so you can see that the

349
00:13:56,570 --> 00:13:58,490
random walk chooses you know random

350
00:13:58,490 --> 00:13:59,990
paths in completely different directions

351
00:13:59,990 --> 00:14:01,730
and what's really interesting this in

352
00:14:01,730 --> 00:14:03,620
this data set even though we didn't know

353
00:14:03,620 --> 00:14:05,000
anything about the structure of the

354
00:14:05,000 --> 00:14:07,040
topology of the cluster we can still see

355
00:14:07,040 --> 00:14:09,949
this chain of dgs and also the color

356
00:14:09,949 --> 00:14:12,649
code here is a map on the DGA score so

357
00:14:12,649 --> 00:14:14,240
if it's completely map on the red

358
00:14:14,240 --> 00:14:17,630
gradient so if it's really red means

359
00:14:17,630 --> 00:14:22,850
that it's very likely to be DGA so again

360
00:14:22,850 --> 00:14:26,180
you can see all the also some some edges

361
00:14:26,180 --> 00:14:27,740
or some paths are completely going in

362
00:14:27,740 --> 00:14:29,360
the middle of nowhere which pretty much

363
00:14:29,360 --> 00:14:30,889
means they don't really belong to the

364
00:14:30,889 --> 00:14:33,260
neighboring cluster so even though you

365
00:14:33,260 --> 00:14:34,730
don't know anything about the

366
00:14:34,730 --> 00:14:36,110
neighboring topology you can still

367
00:14:36,110 --> 00:14:39,790
discover it using random or techniques

368
00:14:43,270 --> 00:14:46,330
so as a second use case in this

369
00:14:46,330 --> 00:14:49,870
presentation is the Zeus came over so

370
00:14:49,870 --> 00:14:51,550
this game over as you all know is a

371
00:14:51,550 --> 00:14:53,800
Trojan a bank in Trojan and there are

372
00:14:53,800 --> 00:14:55,690
like two versions that we know of the

373
00:14:55,690 --> 00:14:57,570
old gas that has been taken down or

374
00:14:57,570 --> 00:15:00,850
attempted to be taken down by operation

375
00:15:00,850 --> 00:15:03,490
tovar back in May and the second version

376
00:15:03,490 --> 00:15:06,370
appeared back in July when the first one

377
00:15:06,370 --> 00:15:08,920
was using peer-to-peer with a DG a

378
00:15:08,920 --> 00:15:11,620
fallback the second one gave up on the

379
00:15:11,620 --> 00:15:14,260
peer-to-peer but it used fast flux for

380
00:15:14,260 --> 00:15:16,240
for hosting the CNCs in the beginning

381
00:15:16,240 --> 00:15:18,430
but now there are kind of isolated IPS

382
00:15:18,430 --> 00:15:20,740
but it still uses the dj's for the

383
00:15:20,740 --> 00:15:24,430
domains and we still see both old gods

384
00:15:24,430 --> 00:15:26,080
and new gods in our traffic which is

385
00:15:26,080 --> 00:15:29,800
part of what we will cover here so if we

386
00:15:29,800 --> 00:15:33,580
take old gods domains interestingly for

387
00:15:33,580 --> 00:15:35,790
the domains of the day we'll see them

388
00:15:35,790 --> 00:15:39,400
reappear for the next four days and at

389
00:15:39,400 --> 00:15:42,670
the bottom the co-occurrences data there

390
00:15:42,670 --> 00:15:44,290
is basically all of the domains that

391
00:15:44,290 --> 00:15:45,580
have been looked up during the short

392
00:15:45,580 --> 00:15:47,770
time period by the same client so again

393
00:15:47,770 --> 00:15:49,960
as we mentioned earlier without in silly

394
00:15:49,960 --> 00:15:51,550
having the sample you can grab all of

395
00:15:51,550 --> 00:15:52,990
the domains that have been looked up by

396
00:15:52,990 --> 00:15:56,770
infected hosts just for reference the

397
00:15:56,770 --> 00:15:59,260
md5 for the old gods is the one there

398
00:15:59,260 --> 00:16:01,330
you see and then the behavior is that

399
00:16:01,330 --> 00:16:02,950
you have a thousand DGA domains looked

400
00:16:02,950 --> 00:16:05,140
up by the sample before it stops and

401
00:16:05,140 --> 00:16:07,480
then it will try again for the next few

402
00:16:07,480 --> 00:16:11,400
days however if you look at the new gods

403
00:16:11,400 --> 00:16:15,970
which we said appeared in early july of

404
00:16:15,970 --> 00:16:18,820
this year the traffic is only for 24

405
00:16:18,820 --> 00:16:20,080
hours which is kind of the expected

406
00:16:20,080 --> 00:16:22,440
behavior and we also see that the

407
00:16:22,440 --> 00:16:25,120
co-occurrences or related domains also

408
00:16:25,120 --> 00:16:26,770
show us the related ones that have been

409
00:16:26,770 --> 00:16:30,370
looked up by the victims now the md5 is

410
00:16:30,370 --> 00:16:32,650
that one for your reference and the

411
00:16:32,650 --> 00:16:34,600
expected behavior was to have a thousand

412
00:16:34,600 --> 00:16:36,760
dj's looked up by the sample before it

413
00:16:36,760 --> 00:16:40,630
stops and then it will kind of redo the

414
00:16:40,630 --> 00:16:43,540
process 24 hours before it goes to the

415
00:16:43,540 --> 00:16:47,500
next sequence of domains now we were

416
00:16:47,500 --> 00:16:48,970
interested in seeing you know just from

417
00:16:48,970 --> 00:16:51,100
our traffic the kind of victims we have

418
00:16:51,100 --> 00:16:54,700
or infected potentially infected IPS so

419
00:16:54,700 --> 00:16:56,769
for the old guys the concentration is

420
00:16:56,769 --> 00:16:58,809
in the United States but mostly turkey

421
00:16:58,809 --> 00:17:01,389
India Indonesia Egypt and some African

422
00:17:01,389 --> 00:17:03,579
countries and then for the new guys

423
00:17:03,579 --> 00:17:06,010
there's a lot of traffic coming from the

424
00:17:06,010 --> 00:17:09,099
UK and the United States and some from

425
00:17:09,099 --> 00:17:11,619
India and then we were interested in

426
00:17:11,619 --> 00:17:13,539
looking at the intersection in other

427
00:17:13,539 --> 00:17:18,819
words the overlap so for that we studied

428
00:17:18,819 --> 00:17:21,250
the domains of old gods for those four

429
00:17:21,250 --> 00:17:23,470
days because the list will kind of

430
00:17:23,470 --> 00:17:25,599
repeat for the next four days however

431
00:17:25,599 --> 00:17:27,490
for the new guys we took the domains

432
00:17:27,490 --> 00:17:31,120
generated for September 8th September

433
00:17:31,120 --> 00:17:33,820
9th 10th and 11th and then we looked at

434
00:17:33,820 --> 00:17:35,860
the client IP is looking them up and

435
00:17:35,860 --> 00:17:38,049
then we try to see the intersection and

436
00:17:38,049 --> 00:17:41,500
we saw that the mostly in most infected

437
00:17:41,500 --> 00:17:43,120
countries were the United States and

438
00:17:43,120 --> 00:17:45,669
India and then some in African countries

439
00:17:45,669 --> 00:17:52,149
in the United Kingdom again let's take a

440
00:17:52,149 --> 00:17:55,659
look at this co-occurrence graph we

441
00:17:55,659 --> 00:17:57,490
start from one known to skim over domain

442
00:17:57,490 --> 00:17:59,260
now we extract all the neighbors

443
00:17:59,260 --> 00:18:02,500
neighbors neighbors etc etc we can see

444
00:18:02,500 --> 00:18:04,840
that you know the accumulation of all

445
00:18:04,840 --> 00:18:06,730
transition the transitions between the

446
00:18:06,730 --> 00:18:09,100
DG domains over four days creates a very

447
00:18:09,100 --> 00:18:11,260
dense cluster as you can see here and

448
00:18:11,260 --> 00:18:13,330
now I want to talk about one defects of

449
00:18:13,330 --> 00:18:17,020
the BFS if you remember correctly the

450
00:18:17,020 --> 00:18:19,360
BFS stops for a certain number of levels

451
00:18:19,360 --> 00:18:21,639
the last level doesn't have any

452
00:18:21,639 --> 00:18:24,130
neighbors which means you know it's

453
00:18:24,130 --> 00:18:26,500
going to be very parse at the outskirts

454
00:18:26,500 --> 00:18:29,649
at the edges of the graph so this is

455
00:18:29,649 --> 00:18:31,270
something to consider here so what

456
00:18:31,270 --> 00:18:32,770
you're seeing here is like all the

457
00:18:32,770 --> 00:18:34,240
traffic and all the transitions between

458
00:18:34,240 --> 00:18:36,130
all the DGA domains and it creates

459
00:18:36,130 --> 00:18:38,080
something very dense now let's compare

460
00:18:38,080 --> 00:18:40,179
it this is the old swiss game over by

461
00:18:40,179 --> 00:18:42,100
the way now let's compared to the new

462
00:18:42,100 --> 00:18:49,179
one so here is how we actually create a

463
00:18:49,179 --> 00:18:51,580
3d representation of the graph we start

464
00:18:51,580 --> 00:18:53,440
with all the points placed in the center

465
00:18:53,440 --> 00:18:56,230
and like in hemisphere we used some

466
00:18:56,230 --> 00:18:59,529
particle physics it's very simple all

467
00:18:59,529 --> 00:19:01,240
the nodes that are connected are going

468
00:19:01,240 --> 00:19:02,529
to attract each other all the nodes are

469
00:19:02,529 --> 00:19:04,090
disconnected and I'm going to repost

470
00:19:04,090 --> 00:19:06,909
each other and then we let the physics

471
00:19:06,909 --> 00:19:08,429
run and we obtain

472
00:19:08,429 --> 00:19:09,960
it's kind of a dis molecular shape

473
00:19:09,960 --> 00:19:12,749
layout it makes complete sense because

474
00:19:12,749 --> 00:19:15,240
the force directed algorithm pull model

475
00:19:15,240 --> 00:19:17,639
has been inspired by celestial bodies

476
00:19:17,639 --> 00:19:19,860
forces it's not exactly the same model

477
00:19:19,860 --> 00:19:21,749
because it's to complicate to implement

478
00:19:21,749 --> 00:19:24,210
but it's very inspired by that then you

479
00:19:24,210 --> 00:19:26,369
can see the new structure the topology

480
00:19:26,369 --> 00:19:30,210
of all the co-occurrences you can see

481
00:19:30,210 --> 00:19:32,129
that has a complete chain and it's like

482
00:19:32,129 --> 00:19:35,549
it's looping at some point as well now

483
00:19:35,549 --> 00:19:38,149
how did we create this data set we used

484
00:19:38,149 --> 00:19:40,740
what we call the minor script the minor

485
00:19:40,740 --> 00:19:42,629
script is pretty much a Python script

486
00:19:42,629 --> 00:19:45,809
that is going to do this BFS for us it

487
00:19:45,809 --> 00:19:48,210
uses our security graph API where we can

488
00:19:48,210 --> 00:19:49,769
request pretty much all the

489
00:19:49,769 --> 00:19:51,090
co-occurrence is starting from one

490
00:19:51,090 --> 00:19:54,509
domain and then finally one thing that

491
00:19:54,509 --> 00:19:57,450
is really interesting to notice is the

492
00:19:57,450 --> 00:19:59,340
strict structure and strict topology of

493
00:19:59,340 --> 00:20:01,679
this graph almost every node in this

494
00:20:01,679 --> 00:20:05,490
graph have like around ten neighbors and

495
00:20:05,490 --> 00:20:07,470
the really interesting thing here is

496
00:20:07,470 --> 00:20:09,990
that since the the topology is so strict

497
00:20:09,990 --> 00:20:11,610
we can detect it automatically with our

498
00:20:11,610 --> 00:20:13,289
Python scripts so we can pretty much

499
00:20:13,289 --> 00:20:16,590
extract things like respect the same

500
00:20:16,590 --> 00:20:19,220
topology without knowing what it is

501
00:20:19,220 --> 00:20:23,119
they're interesting data set

502
00:20:25,610 --> 00:20:30,180
less than 10 minutes please so in

503
00:20:30,180 --> 00:20:32,760
conclusion what we shared with you was

504
00:20:32,760 --> 00:20:34,560
an overview of our threat intelligence

505
00:20:34,560 --> 00:20:38,730
platform so it's a product we have but

506
00:20:38,730 --> 00:20:41,460
it's also open for researchers if you

507
00:20:41,460 --> 00:20:43,530
are doing your own research so you're

508
00:20:43,530 --> 00:20:45,900
welcome to contact us to get access to

509
00:20:45,900 --> 00:20:48,450
it we also introduced the co-occurrences

510
00:20:48,450 --> 00:20:50,940
model which helps us build this graph

511
00:20:50,940 --> 00:20:53,160
that you can then explore and then

512
00:20:53,160 --> 00:20:54,570
you'll find all kinds of domains that

513
00:20:54,570 --> 00:20:56,820
are either related to a same attack or

514
00:20:56,820 --> 00:20:59,160
they are related to kind of a theme that

515
00:20:59,160 --> 00:21:01,140
users are interested in so we mentioned

516
00:21:01,140 --> 00:21:03,270
the carding sites also we use it a lot

517
00:21:03,270 --> 00:21:06,270
to you know explore hacking related

518
00:21:06,270 --> 00:21:11,990
websites sometimes click fraud spam

519
00:21:11,990 --> 00:21:14,310
everything where you have a lot of

520
00:21:14,310 --> 00:21:18,090
clients looking up domains in mass that

521
00:21:18,090 --> 00:21:21,210
phenomena we can detect pretty easily

522
00:21:21,210 --> 00:21:24,480
with our models the other thing we we

523
00:21:24,480 --> 00:21:26,220
mentioned is that we have a unique view

524
00:21:26,220 --> 00:21:28,830
when we render this with the 3d

525
00:21:28,830 --> 00:21:30,510
visualization engine because

526
00:21:30,510 --> 00:21:32,850
visualization here can be very useful in

527
00:21:32,850 --> 00:21:37,190
the sense if you just see the text or

528
00:21:37,190 --> 00:21:39,840
representation of nodes and edges in a

529
00:21:39,840 --> 00:21:43,800
textual format you cannot see certain

530
00:21:43,800 --> 00:21:45,540
obvious patterns but when you visualize

531
00:21:45,540 --> 00:21:47,730
it you'll realize that you saw in the

532
00:21:47,730 --> 00:21:50,730
Zeus came over case it's a chain where

533
00:21:50,730 --> 00:21:53,840
every domain has a limited number of

534
00:21:53,840 --> 00:21:56,490
domains that are co-occurring with it

535
00:21:56,490 --> 00:21:57,960
over time so it's kind of very

536
00:21:57,960 --> 00:21:59,940
interesting here and like as tebow

537
00:21:59,940 --> 00:22:01,890
mentioned if you apply like some graph

538
00:22:01,890 --> 00:22:04,350
exploration on if you're looking for

539
00:22:04,350 --> 00:22:05,880
certain patterns like you're looking for

540
00:22:05,880 --> 00:22:08,040
specific sub graphs with certain

541
00:22:08,040 --> 00:22:10,200
features in your big one then you can

542
00:22:10,200 --> 00:22:13,860
find islands of these suspicious related

543
00:22:13,860 --> 00:22:16,260
domains and finally the use cases that

544
00:22:16,260 --> 00:22:18,480
we just discussed where cryptolocker and

545
00:22:18,480 --> 00:22:20,250
Zeus came over but we see it a lot in

546
00:22:20,250 --> 00:22:23,040
other DGA algorithm I mean DGA malware

547
00:22:23,040 --> 00:22:25,890
DJ based malware so I remember there

548
00:22:25,890 --> 00:22:29,370
were cases of safenet remnant a lot of

549
00:22:29,370 --> 00:22:31,230
the known ones like push do for instance

550
00:22:31,230 --> 00:22:34,290
that use DGA so this can be applied in a

551
00:22:34,290 --> 00:22:37,660
lot of interesting threats

552
00:22:37,660 --> 00:22:42,020
so thank you all for being here will be

553
00:22:42,020 --> 00:22:44,570
very happy to answer questions but also

554
00:22:44,570 --> 00:22:46,220
I would like to give a shout out to our

555
00:22:46,220 --> 00:22:48,530
research team so being used to work with

556
00:22:48,530 --> 00:22:50,810
us but then she left so we miss her a

557
00:22:50,810 --> 00:22:52,460
lot but then also Frank dooney and

558
00:22:52,460 --> 00:22:55,580
Anthony casa and Thomas and Andrew hey

559
00:22:55,580 --> 00:22:58,899
so thank you everyone

