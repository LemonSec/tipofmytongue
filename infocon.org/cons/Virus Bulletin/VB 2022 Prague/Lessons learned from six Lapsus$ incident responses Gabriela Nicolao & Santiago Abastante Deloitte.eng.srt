1
00:00:02,460 --> 00:00:05,160
thank you and thank you for attending

2
00:00:05,160 --> 00:00:07,980
this talk uh basically known as

3
00:00:07,980 --> 00:00:10,559
rulersunder from six lapsos incident

4
00:00:10,559 --> 00:00:13,500
responses and uh we I'm going to

5
00:00:13,500 --> 00:00:15,960
introduce the both of us we are Santiago

6
00:00:15,960 --> 00:00:17,940
and Gabriela we are based in Argentina

7
00:00:17,940 --> 00:00:19,619
and for those who don't know that

8
00:00:19,619 --> 00:00:21,359
country is basically the country where

9
00:00:21,359 --> 00:00:25,380
the Popa Messi comes from so we work in

10
00:00:25,380 --> 00:00:27,720
a thread Intel team

11
00:00:27,720 --> 00:00:30,180
um this is the first attendance and talk

12
00:00:30,180 --> 00:00:33,660
of Santiago it is my seven attendance on

13
00:00:33,660 --> 00:00:37,620
on Fifth presentation so I want to thank

14
00:00:37,620 --> 00:00:40,320
the conference for that and we are just

15
00:00:40,320 --> 00:00:44,640
part of a brother team in which uh we

16
00:00:44,640 --> 00:00:46,800
have different skill sets Santiago is

17
00:00:46,800 --> 00:00:50,100
more focus on cloud security me myself

18
00:00:50,100 --> 00:00:52,440
more Ferguson malware analysis and we

19
00:00:52,440 --> 00:00:54,300
work both together with other people in

20
00:00:54,300 --> 00:00:56,039
collaboration to

21
00:00:56,039 --> 00:00:59,219
um work in Instagram responses so we do

22
00:00:59,219 --> 00:01:01,860
pretty uh interesting stuff and before

23
00:01:01,860 --> 00:01:05,159
continuing I we wanted to make a special

24
00:01:05,159 --> 00:01:08,460
mention of our leader and Mentor Lucena

25
00:01:08,460 --> 00:01:10,140
Martins That was supposed to come to

26
00:01:10,140 --> 00:01:13,080
this conference but he's currently

27
00:01:13,080 --> 00:01:16,380
um battling breast cancer so we wanted

28
00:01:16,380 --> 00:01:18,540
to dedicate this presentation to him and

29
00:01:18,540 --> 00:01:20,880
also remind you to go to the doctor and

30
00:01:20,880 --> 00:01:22,680
take care of your health

31
00:01:22,680 --> 00:01:23,939
so

32
00:01:23,939 --> 00:01:26,400
um this is the agenda we have prepared

33
00:01:26,400 --> 00:01:29,159
for this presentation we are first going

34
00:01:29,159 --> 00:01:32,220
to talk about uh details of lapsu so we

35
00:01:32,220 --> 00:01:34,560
are all in the same page then um

36
00:01:34,560 --> 00:01:36,960
Santiago is going to talk about the

37
00:01:36,960 --> 00:01:38,640
things interesting things that we

38
00:01:38,640 --> 00:01:41,040
observed during the incidents and then

39
00:01:41,040 --> 00:01:43,979
we are going to finish with some lesson

40
00:01:43,979 --> 00:01:46,799
letters on or take away from from the

41
00:01:46,799 --> 00:01:49,200
things that we are observed

42
00:01:49,200 --> 00:01:50,579
so

43
00:01:50,579 --> 00:01:53,579
who is lapses

44
00:01:53,579 --> 00:01:58,020
so labsus is a predator that has been

45
00:01:58,020 --> 00:02:00,200
known since

46
00:02:00,200 --> 00:02:03,439
mid-2021 and has been active since then

47
00:02:03,439 --> 00:02:07,079
and this group is uh suspected to be

48
00:02:07,079 --> 00:02:10,199
from Brazil but there are also a sort of

49
00:02:10,199 --> 00:02:11,940
public Nations there are also people

50
00:02:11,940 --> 00:02:15,959
that were related to well the England

51
00:02:15,959 --> 00:02:20,280
and um this group is basically uh doing

52
00:02:20,280 --> 00:02:24,120
stuff for the money they they hack to uh

53
00:02:24,120 --> 00:02:27,480
have a revenue new outer lab but they

54
00:02:27,480 --> 00:02:28,500
also

55
00:02:28,500 --> 00:02:31,560
um just watch the world burn because

56
00:02:31,560 --> 00:02:33,840
there are some incidents that they

57
00:02:33,840 --> 00:02:35,760
didn't even ask for anything but they

58
00:02:35,760 --> 00:02:39,180
just released the the data of the of the

59
00:02:39,180 --> 00:02:42,599
affected companies so that is why we use

60
00:02:42,599 --> 00:02:45,239
the The Joker theme basically that is a

61
00:02:45,239 --> 00:02:46,560
phrase that you can see in a Batman

62
00:02:46,560 --> 00:02:50,040
movie and um well the suspects behind

63
00:02:50,040 --> 00:02:52,860
this thread actor as I mentioned that

64
00:02:52,860 --> 00:02:55,800
there was a there were some people that

65
00:02:55,800 --> 00:02:59,220
were suspected in in England

66
00:02:59,220 --> 00:03:01,080
um there is in particular one person

67
00:03:01,080 --> 00:03:04,140
that goes by the nickname a white or

68
00:03:04,140 --> 00:03:06,239
Bridge base that we are going to talk

69
00:03:06,239 --> 00:03:09,660
more of in the next slide and uh well

70
00:03:09,660 --> 00:03:11,640
there were also people not only at

71
00:03:11,640 --> 00:03:14,040
inertia but about more people that were

72
00:03:14,040 --> 00:03:14,959
um

73
00:03:14,959 --> 00:03:18,180
investigated in in Brazil so

74
00:03:18,180 --> 00:03:21,180
um the the the the the the those are the

75
00:03:21,180 --> 00:03:24,000
the main countries of uh were these

76
00:03:24,000 --> 00:03:25,080
people of

77
00:03:25,080 --> 00:03:28,860
um are well supposedly belong to and

78
00:03:28,860 --> 00:03:31,500
some a couple of things we can highlight

79
00:03:31,500 --> 00:03:33,840
about this redactor is that well at the

80
00:03:33,840 --> 00:03:36,780
beginning uh people maybe consider they

81
00:03:36,780 --> 00:03:38,640
were a ransomware gang but that is not

82
00:03:38,640 --> 00:03:41,099
the case they just exorbit them they

83
00:03:41,099 --> 00:03:44,280
either exfiltrate files or they

84
00:03:44,280 --> 00:03:47,940
um uh copy repositories and uh they

85
00:03:47,940 --> 00:03:50,580
don't use a ransomware and also they

86
00:03:50,580 --> 00:03:53,459
rely a lot on in telegram they have a

87
00:03:53,459 --> 00:03:56,099
their Communications using that that

88
00:03:56,099 --> 00:03:59,280
platform we observe at least three

89
00:03:59,280 --> 00:04:01,080
channels I think there is a little more

90
00:04:01,080 --> 00:04:03,659
but they basically they had a channel

91
00:04:03,659 --> 00:04:06,959
for like a news field uh in which they

92
00:04:06,959 --> 00:04:08,819
brag a lot and and I can say that is

93
00:04:08,819 --> 00:04:10,739
something else that is the ego is

94
00:04:10,739 --> 00:04:12,599
something that also can be noticed in

95
00:04:12,599 --> 00:04:13,860
this group

96
00:04:13,860 --> 00:04:17,160
um there is uh another challenge that is

97
00:04:17,160 --> 00:04:20,040
a SC app there there is another or there

98
00:04:20,040 --> 00:04:21,899
was another one that it was more for

99
00:04:21,899 --> 00:04:24,840
communicated with them and another one

100
00:04:24,840 --> 00:04:28,380
that was to hire insiders that is also

101
00:04:28,380 --> 00:04:30,120
down currently

102
00:04:30,120 --> 00:04:33,680
so uh regarding the doxing so on

103
00:04:33,680 --> 00:04:39,720
November 2000 on uh 21 uh this person

104
00:04:39,720 --> 00:04:42,540
that goes by the nickname white uh

105
00:04:42,540 --> 00:04:43,680
bought

106
00:04:43,680 --> 00:04:47,419
um a website from two Administration or

107
00:04:47,419 --> 00:04:50,220
administrators of that website that is

108
00:04:50,220 --> 00:04:53,400
called duckswin.com and

109
00:04:53,400 --> 00:04:56,580
um basically this white person uh didn't

110
00:04:56,580 --> 00:05:00,660
uh do a good job without a website the

111
00:05:00,660 --> 00:05:02,639
website started to lose reputation so

112
00:05:02,639 --> 00:05:04,860
people started to become angry about

113
00:05:04,860 --> 00:05:08,699
that so these two former administrators

114
00:05:08,699 --> 00:05:12,540
decided to buy it back from him for a

115
00:05:12,540 --> 00:05:15,840
fragment the money they paid and then

116
00:05:15,840 --> 00:05:19,500
um in January 2022 these two people

117
00:05:19,500 --> 00:05:23,580
decided to just release uh it to tax

118
00:05:23,580 --> 00:05:26,039
this person to release information and

119
00:05:26,039 --> 00:05:28,020
not only Personnel where the person

120
00:05:28,020 --> 00:05:32,639
lived and where the name and photos but

121
00:05:32,639 --> 00:05:36,720
also it mentioned uh things related to

122
00:05:36,720 --> 00:05:39,660
this person such as email accounts

123
00:05:39,660 --> 00:05:43,139
social media accounts and also more

124
00:05:43,139 --> 00:05:45,840
importantly for us the that domain that

125
00:05:45,840 --> 00:05:48,660
you see there elix.direct that will

126
00:05:48,660 --> 00:05:50,880
become relevant in the next slide and

127
00:05:50,880 --> 00:05:52,800
and also Santiago is going to talk more

128
00:05:52,800 --> 00:05:55,020
later

129
00:05:55,020 --> 00:05:58,500
so we wanted to do a certain uh a sort

130
00:05:58,500 --> 00:06:00,180
of timeline because there are a lot of

131
00:06:00,180 --> 00:06:05,340
of news in the in in the wild and

132
00:06:05,340 --> 00:06:09,300
um we wanted to put some colors also so

133
00:06:09,300 --> 00:06:12,539
I and and we didn't want to shame any

134
00:06:12,539 --> 00:06:14,759
um affected organization so we only

135
00:06:14,759 --> 00:06:17,759
mentioned the industry and the country

136
00:06:17,759 --> 00:06:21,120
uh an affected organization uh belong to

137
00:06:21,120 --> 00:06:24,360
so I I will soon colors so

138
00:06:24,360 --> 00:06:27,660
um orange represents incidents that

139
00:06:27,660 --> 00:06:29,819
didn't make the public eye and were

140
00:06:29,819 --> 00:06:34,620
handled by us uh green public incidents

141
00:06:34,620 --> 00:06:37,400
um a blue events that happened in

142
00:06:37,400 --> 00:06:41,580
intolerum in red we put some mentions

143
00:06:41,580 --> 00:06:44,520
some event that these people

144
00:06:44,520 --> 00:06:47,460
um maybe brag about them in in telegram

145
00:06:47,460 --> 00:06:49,500
but we didn't find any evidence to

146
00:06:49,500 --> 00:06:53,460
support that so we have to like don't

147
00:06:53,460 --> 00:06:56,580
worry much about it and then in uh in

148
00:06:56,580 --> 00:06:59,340
yellow we put some events related to to

149
00:06:59,340 --> 00:07:02,460
this rule right so in the world you will

150
00:07:02,460 --> 00:07:05,400
see that the first related activity to

151
00:07:05,400 --> 00:07:08,639
this group was a found in June but we

152
00:07:08,639 --> 00:07:10,620
actually uh had a client that got

153
00:07:10,620 --> 00:07:14,220
affected uh in May and we could do that

154
00:07:14,220 --> 00:07:16,860
relation because we found that email

155
00:07:16,860 --> 00:07:19,860
that uh you kind of see maybe there but

156
00:07:19,860 --> 00:07:23,220
it's me at least dot direct that if you

157
00:07:23,220 --> 00:07:25,259
remember is the same domain that was

158
00:07:25,259 --> 00:07:27,120
related to this

159
00:07:27,120 --> 00:07:29,880
um user white so

160
00:07:29,880 --> 00:07:31,979
um we believe that at least the

161
00:07:31,979 --> 00:07:34,380
activities of this group started back in

162
00:07:34,380 --> 00:07:37,259
May 2021 and since then they have

163
00:07:37,259 --> 00:07:39,900
targeted uh different Industries

164
00:07:39,900 --> 00:07:43,259
Financial consumer TMT mostly also

165
00:07:43,259 --> 00:07:46,139
public sector a lot and we found one of

166
00:07:46,139 --> 00:07:48,180
our clients that belong to the inertia

167
00:07:48,180 --> 00:07:52,080
resources uh industry also and um they

168
00:07:52,080 --> 00:07:55,740
they they started to well to

169
00:07:55,740 --> 00:07:57,020
um

170
00:07:57,020 --> 00:08:02,160
to affect victims I and in December they

171
00:08:02,160 --> 00:08:04,979
um they decided or or it was when the

172
00:08:04,979 --> 00:08:07,620
the telegram accounts started to appear

173
00:08:07,620 --> 00:08:11,280
and they used those telegrams to leak

174
00:08:11,280 --> 00:08:13,500
data they share

175
00:08:13,500 --> 00:08:17,460
um archive files and um and then try to

176
00:08:17,460 --> 00:08:21,360
brag about it and then in January 2022

177
00:08:21,360 --> 00:08:24,539
as I mentioned before uh one person was

178
00:08:24,539 --> 00:08:28,740
dogs and and and in in March there was a

179
00:08:28,740 --> 00:08:31,440
lot of activity of this group uh they

180
00:08:31,440 --> 00:08:33,599
they posted in the telegram channel that

181
00:08:33,599 --> 00:08:35,880
we were looking for insiders in really

182
00:08:35,880 --> 00:08:38,219
particular companies they they were

183
00:08:38,219 --> 00:08:41,880
named and um also in that month was when

184
00:08:41,880 --> 00:08:44,219
people started to get caught in in

185
00:08:44,219 --> 00:08:46,560
England and we observed a lot of

186
00:08:46,560 --> 00:08:49,980
activity then in in August we we we all

187
00:08:49,980 --> 00:08:53,700
saw that the the people were getting

188
00:08:53,700 --> 00:08:56,640
investigated in Brazil and then in

189
00:08:56,640 --> 00:08:59,880
September so there were two major

190
00:08:59,880 --> 00:09:01,860
companies that were affected and were

191
00:09:01,860 --> 00:09:04,440
attributed to lapses and

192
00:09:04,440 --> 00:09:07,140
um well last week there was a suspect

193
00:09:07,140 --> 00:09:11,399
that was a cut so this is like the

194
00:09:11,399 --> 00:09:13,440
summary of what we know so far about

195
00:09:13,440 --> 00:09:14,940
this threat

196
00:09:14,940 --> 00:09:17,940
and here we don't worry we are not going

197
00:09:17,940 --> 00:09:20,339
to go through all the ttbs we just

198
00:09:20,339 --> 00:09:22,980
wanted to uh to put my trip because we

199
00:09:22,980 --> 00:09:25,800
love major and um and keep in mind that

200
00:09:25,800 --> 00:09:29,279
this week uh the they said that in

201
00:09:29,279 --> 00:09:31,320
October they were going to release

202
00:09:31,320 --> 00:09:35,160
Matthew 12 so keep a tune stay tuned so

203
00:09:35,160 --> 00:09:37,500
uh basically what we wanted to represent

204
00:09:37,500 --> 00:09:40,200
here don't worry we will share the the

205
00:09:40,200 --> 00:09:43,380
slides we wanted to represent that

206
00:09:43,380 --> 00:09:46,019
um some people maybe think that this uh

207
00:09:46,019 --> 00:09:48,660
Predator is more like a script Kitty

208
00:09:48,660 --> 00:09:53,720
because it finds maybe credentials in in

209
00:09:53,720 --> 00:09:56,940
repositories but we believe that it is

210
00:09:56,940 --> 00:09:59,040
not the case because what we observing

211
00:09:59,040 --> 00:10:01,440
the series is that at least these guys

212
00:10:01,440 --> 00:10:03,899
are much more than that they they have a

213
00:10:03,899 --> 00:10:06,060
lot of knowledge they they know why they

214
00:10:06,060 --> 00:10:08,459
do they know uh some things that that

215
00:10:08,459 --> 00:10:13,459
well Santiago will will show us next

216
00:10:15,899 --> 00:10:18,959
thanks we're not going to talk about

217
00:10:18,959 --> 00:10:21,180
whatever is public so we are not going

218
00:10:21,180 --> 00:10:24,240
to talk about MFA fatigue Sim swapping

219
00:10:24,240 --> 00:10:27,300
and buying credentials and that stuff

220
00:10:27,300 --> 00:10:30,839
but we what we have seen twice is for

221
00:10:30,839 --> 00:10:33,839
example uh the execution of a red line

222
00:10:33,839 --> 00:10:37,500
malware an infostiler that they use to

223
00:10:37,500 --> 00:10:40,320
get Chrome credentials with those

224
00:10:40,320 --> 00:10:44,279
credentials they were able to access a

225
00:10:44,279 --> 00:10:47,579
internal company system like other data

226
00:10:47,579 --> 00:10:48,920
or other

227
00:10:48,920 --> 00:10:50,880
credentials walls

228
00:10:50,880 --> 00:10:53,160
that was really important for them

229
00:10:53,160 --> 00:10:55,140
because that allows them to Pivot

230
00:10:55,140 --> 00:10:57,899
laterally and to elevate privileges in

231
00:10:57,899 --> 00:11:01,140
in different attacks and as you can see

232
00:11:01,140 --> 00:11:03,779
here if you don't Harden enough those

233
00:11:03,779 --> 00:11:06,300
kind of services it can be really hard

234
00:11:06,300 --> 00:11:07,519
because

235
00:11:07,519 --> 00:11:10,140
most companies share or most employees

236
00:11:10,140 --> 00:11:13,860
share their their Chrome browser and and

237
00:11:13,860 --> 00:11:17,760
sessions between Works company

238
00:11:17,760 --> 00:11:19,680
workstations and personal workstations

239
00:11:19,680 --> 00:11:23,459
so with that they they can get access to

240
00:11:23,459 --> 00:11:26,060
company credentials compromising

241
00:11:26,060 --> 00:11:28,800
employee workstations

242
00:11:28,800 --> 00:11:31,680
then a in another opportunity what we

243
00:11:31,680 --> 00:11:34,500
saw is that they compromised and exposed

244
00:11:34,500 --> 00:11:36,779
Microsoft Exchange Server

245
00:11:36,779 --> 00:11:39,839
only to get access to a specific email

246
00:11:39,839 --> 00:11:43,260
address that email address was the one

247
00:11:43,260 --> 00:11:49,200
that managed the AWS root user for you

248
00:11:49,200 --> 00:11:51,959
that don't know the AWS user is like

249
00:11:51,959 --> 00:11:54,060
every road user so they were able to

250
00:11:54,060 --> 00:11:56,220
take over the whole AWS account with

251
00:11:56,220 --> 00:12:00,120
that but we we also notice in five of

252
00:12:00,120 --> 00:12:03,060
those six incidents that they were they

253
00:12:03,060 --> 00:12:05,540
were having a specific

254
00:12:05,540 --> 00:12:08,760
objectives with those AWS accounts that

255
00:12:08,760 --> 00:12:12,899
we are going to show after a the AWS

256
00:12:12,899 --> 00:12:14,700
root account takeover is something that

257
00:12:14,700 --> 00:12:16,260
is really easy to do if the account is

258
00:12:16,260 --> 00:12:18,959
not highlighted properly because it's

259
00:12:18,959 --> 00:12:21,839
only a matter of asking for the for the

260
00:12:21,839 --> 00:12:24,920
email reset password as you can see here

261
00:12:24,920 --> 00:12:28,320
and and and they were able to achieve

262
00:12:28,320 --> 00:12:31,740
this without being Detective

263
00:12:31,740 --> 00:12:34,440
another way that they were able to

264
00:12:34,440 --> 00:12:37,380
compromise another client was through an

265
00:12:37,380 --> 00:12:41,339
exposed shankings box okay for you that

266
00:12:41,339 --> 00:12:43,440
don't know shenkins is a tool that is

267
00:12:43,440 --> 00:12:47,420
used by devops teams to handle cicd

268
00:12:47,420 --> 00:12:50,940
pipelines and it's already really really

269
00:12:50,940 --> 00:12:54,420
well used tool and but if not harling

270
00:12:54,420 --> 00:12:56,760
properly it can be super dangerous

271
00:12:56,760 --> 00:12:58,380
because

272
00:12:58,380 --> 00:13:01,920
um it used it it used to be used to

273
00:13:01,920 --> 00:13:06,120
access AWS to create infrastructure so

274
00:13:06,120 --> 00:13:09,600
it can have it usually has admin access

275
00:13:09,600 --> 00:13:12,120
over AWS

276
00:13:12,120 --> 00:13:14,160
um it's happened the same when when when

277
00:13:14,160 --> 00:13:17,220
you have credentials exposed in GitHub

278
00:13:17,220 --> 00:13:19,680
repositories in another case we found

279
00:13:19,680 --> 00:13:23,040
that two or if you get if they were able

280
00:13:23,040 --> 00:13:27,560
to get a im user credentials that were

281
00:13:27,560 --> 00:13:30,740
stored in a computer in a in our station

282
00:13:30,740 --> 00:13:34,019
that are hard-coded and are in plain

283
00:13:34,019 --> 00:13:37,200
text all these in this Vector of

284
00:13:37,200 --> 00:13:39,480
compromise we we have seen all this

285
00:13:39,480 --> 00:13:41,279
Vector of compromise and they were

286
00:13:41,279 --> 00:13:45,540
always trying to find a a way to get to

287
00:13:45,540 --> 00:13:46,980
the AWS account

288
00:13:46,980 --> 00:13:50,519
and get an account they call right

289
00:13:50,519 --> 00:13:53,519
when they access it to another AWS

290
00:13:53,519 --> 00:13:56,100
account the first thing they they did

291
00:13:56,100 --> 00:13:59,760
was to retrieve all the secrets and all

292
00:13:59,760 --> 00:14:02,880
the data they they could from S3 buckets

293
00:14:02,880 --> 00:14:05,940
an extra bucket is like a data store a

294
00:14:05,940 --> 00:14:09,540
an object level store and they used a

295
00:14:09,540 --> 00:14:12,240
tool that's called S3 browser that is

296
00:14:12,240 --> 00:14:14,880
not known as a malicious tool but we we

297
00:14:14,880 --> 00:14:19,620
saw that in in several times uh then

298
00:14:19,620 --> 00:14:22,320
they tried to access GitHub and gitlab

299
00:14:22,320 --> 00:14:25,980
code repositories to to to leaked data

300
00:14:25,980 --> 00:14:29,220
and they use engrock and file Sila to

301
00:14:29,220 --> 00:14:32,959
exfiltrate that along with Dropbox

302
00:14:32,959 --> 00:14:37,079
once they did that they tried in in most

303
00:14:37,079 --> 00:14:40,019
of the cases to execute a nuke against

304
00:14:40,019 --> 00:14:44,060
AWS account the nuke is is a way of

305
00:14:44,060 --> 00:14:47,699
wiping the account on its whole like

306
00:14:47,699 --> 00:14:51,660
destroying servers databases storage

307
00:14:51,660 --> 00:14:54,440
everything that is is is

308
00:14:54,440 --> 00:14:56,160
supporting the the company

309
00:14:56,160 --> 00:14:58,139
infrastructure

310
00:14:58,139 --> 00:15:00,680
um so we're going to do a demo of that

311
00:15:00,680 --> 00:15:03,300
this is a trick that we can only do once

312
00:15:03,300 --> 00:15:05,220
because we are going to to New Canada

313
00:15:05,220 --> 00:15:08,339
race account so let's hope and let's

314
00:15:08,339 --> 00:15:11,880
pray to the Democrats that it works

315
00:15:11,880 --> 00:15:14,639
so first what I wanted to show you I

316
00:15:14,639 --> 00:15:16,920
don't know if you can see it

317
00:15:16,920 --> 00:15:20,279
really well but

318
00:15:20,279 --> 00:15:21,680
okay

319
00:15:21,680 --> 00:15:25,260
credentials in AWS are hard-coded

320
00:15:25,260 --> 00:15:27,720
in this path

321
00:15:27,720 --> 00:15:30,240
if they are not coloring properly

322
00:15:30,240 --> 00:15:34,800
is dot AWS credentials as you can see if

323
00:15:34,800 --> 00:15:37,260
the if the company does it didn't apply

324
00:15:37,260 --> 00:15:40,019
a well security practice

325
00:15:40,019 --> 00:15:42,060
you are going to see this like that so

326
00:15:42,060 --> 00:15:44,820
without knowing much about AWS they were

327
00:15:44,820 --> 00:15:47,100
able to retrieve credentials from the

328
00:15:47,100 --> 00:15:48,360
schenkings box

329
00:15:48,360 --> 00:15:52,740
a and then how many of you have seen an

330
00:15:52,740 --> 00:15:54,600
AWS account

331
00:15:54,600 --> 00:15:56,940
well I'm going to show you that it's not

332
00:15:56,940 --> 00:15:58,980
necessary to detonate an account

333
00:15:58,980 --> 00:16:02,220
so with these credentials they move to a

334
00:16:02,220 --> 00:16:04,380
tool that's called stream browser

335
00:16:04,380 --> 00:16:07,019
this one

336
00:16:07,019 --> 00:16:10,279
they have the credentials here

337
00:16:16,019 --> 00:16:18,300
once they go they were able to leak the

338
00:16:18,300 --> 00:16:21,959
credentials they open history browser

339
00:16:21,959 --> 00:16:23,399
so

340
00:16:23,399 --> 00:16:26,420
they said

341
00:16:26,760 --> 00:16:29,839
that's a key

342
00:16:32,100 --> 00:16:35,360
the secret attacks are key

343
00:16:49,079 --> 00:16:51,899
and the tool what it does is start

344
00:16:51,899 --> 00:16:54,560
showing you

345
00:16:55,399 --> 00:16:58,320
for example these are examples of data

346
00:16:58,320 --> 00:17:00,480
stores that we created for this purpose

347
00:17:00,480 --> 00:17:05,400
and logs in AWS are stored in s32 so

348
00:17:05,400 --> 00:17:07,679
with this they are able to go to the AWS

349
00:17:07,679 --> 00:17:09,419
logs for example

350
00:17:09,419 --> 00:17:13,500
and delete it and delete them

351
00:17:13,500 --> 00:17:14,880
without

352
00:17:14,880 --> 00:17:17,160
much trouble

353
00:17:17,160 --> 00:17:20,699
they are also able to

354
00:17:20,699 --> 00:17:22,919
create

355
00:17:22,919 --> 00:17:26,600
a new AWS user

356
00:17:28,079 --> 00:17:30,299
for them to gain persistence in the

357
00:17:30,299 --> 00:17:31,620
account

358
00:17:31,620 --> 00:17:34,080
so in some opportunities what we saw is

359
00:17:34,080 --> 00:17:35,640
that they were able to create a service

360
00:17:35,640 --> 00:17:39,740
user that is not detected by default

361
00:17:39,740 --> 00:17:44,220
with the in the companies right

362
00:17:44,220 --> 00:17:45,960
once they did this

363
00:17:45,960 --> 00:17:47,280
they

364
00:17:47,280 --> 00:17:49,559
executed this command

365
00:17:49,559 --> 00:17:53,220
that is AWS nuke right as you can see is

366
00:17:53,220 --> 00:17:57,480
nuke a config file that is a basic yaml

367
00:17:57,480 --> 00:17:58,260
file

368
00:17:58,260 --> 00:18:00,840
they set the credentials from the AWS

369
00:18:00,840 --> 00:18:03,020
account

370
00:18:07,020 --> 00:18:10,580
and what the tool is going to do

371
00:18:11,760 --> 00:18:13,559
is to start enumerating the resources

372
00:18:13,559 --> 00:18:15,419
that is going to destroy

373
00:18:15,419 --> 00:18:18,120
in this case we were going to destroy

374
00:18:18,120 --> 00:18:20,400
the S3 buckets only

375
00:18:20,400 --> 00:18:22,380
but we're what we're going to do is a

376
00:18:22,380 --> 00:18:24,720
full destroy of all the environment so I

377
00:18:24,720 --> 00:18:27,179
will change it to the full path

378
00:18:27,179 --> 00:18:30,740
and now you are going to see

379
00:18:31,980 --> 00:18:33,780
all the resources that is going to

380
00:18:33,780 --> 00:18:38,640
destroy I am users ec2 servers

381
00:18:38,640 --> 00:18:42,059
everything right this is like the it's

382
00:18:42,059 --> 00:18:45,740
telling you what it's going to destroy

383
00:18:47,340 --> 00:18:49,740
in the main ways testing I'm going to

384
00:18:49,740 --> 00:18:52,380
show you the AWS console so for example

385
00:18:52,380 --> 00:18:53,880
these are some servers that we have

386
00:18:53,880 --> 00:18:56,760
created for this purpose these are some

387
00:18:56,760 --> 00:18:58,260
S3 buckets

388
00:18:58,260 --> 00:19:00,720
these handsome IM users that are core

389
00:19:00,720 --> 00:19:04,200
AWS components so if I

390
00:19:04,200 --> 00:19:07,460
execute it here

391
00:19:08,700 --> 00:19:10,980
it's going to start trying to destroy

392
00:19:10,980 --> 00:19:12,419
everything

393
00:19:12,419 --> 00:19:15,419
it's going to die sometime so I think

394
00:19:15,419 --> 00:19:16,500
we're going to continue with the

395
00:19:16,500 --> 00:19:18,240
presentation and then we can show you

396
00:19:18,240 --> 00:19:20,280
how the account doesn't have anything

397
00:19:20,280 --> 00:19:23,418
any anymore

398
00:19:23,640 --> 00:19:26,059
so

399
00:19:28,140 --> 00:19:31,799
from a Bluetooth perspective the the

400
00:19:31,799 --> 00:19:33,840
important thing is how can we detect

401
00:19:33,840 --> 00:19:36,539
this Behavior right so as you can see

402
00:19:36,539 --> 00:19:40,200
here the S3 browser tool leaves a trail

403
00:19:40,200 --> 00:19:43,679
in the user agent so you can detect the

404
00:19:43,679 --> 00:19:46,080
in the in AWS logs that somebody is

405
00:19:46,080 --> 00:19:47,460
trying to access your infrastructure

406
00:19:47,460 --> 00:19:51,059
using that tool so if you see that in

407
00:19:51,059 --> 00:19:52,980
your logs it's a sign that you are

408
00:19:52,980 --> 00:19:54,900
trying there is something there there is

409
00:19:54,900 --> 00:19:56,340
somebody that is trying to enumerate

410
00:19:56,340 --> 00:19:57,960
your account

411
00:19:57,960 --> 00:20:01,919
the AWS nuke is harder because it's a go

412
00:20:01,919 --> 00:20:04,799
script so it doesn't it doesn't leave a

413
00:20:04,799 --> 00:20:06,840
trade like that so it's important to

414
00:20:06,840 --> 00:20:09,480
understand the behavior of of what the

415
00:20:09,480 --> 00:20:12,539
tool does in the enumeration phase in

416
00:20:12,539 --> 00:20:14,100
order to create a detection use case

417
00:20:14,100 --> 00:20:17,100
properly

418
00:20:17,299 --> 00:20:20,039
lastly a

419
00:20:20,039 --> 00:20:23,160
what we found in one of the incidents we

420
00:20:23,160 --> 00:20:25,500
were analyzing a workstation and we

421
00:20:25,500 --> 00:20:28,620
found an open Dropbox session so we were

422
00:20:28,620 --> 00:20:32,760
able to to to see what other clients

423
00:20:32,760 --> 00:20:37,799
this group had hacked and which data had

424
00:20:37,799 --> 00:20:40,799
exfield rate as you can see there the

425
00:20:40,799 --> 00:20:43,980
the registration was created upon the

426
00:20:43,980 --> 00:20:46,460
the the email of

427
00:20:46,460 --> 00:20:48,299
admin.lexdirected this is the email that

428
00:20:48,299 --> 00:20:51,059
Gabby mentioned before

429
00:20:51,059 --> 00:20:51,720
um

430
00:20:51,720 --> 00:20:54,179
and there were a lot of hacks from

431
00:20:54,179 --> 00:20:55,820
different countries

432
00:20:55,820 --> 00:20:58,380
especially in Latin America

433
00:20:58,380 --> 00:21:02,940
we also found a an invoice from their

434
00:21:02,940 --> 00:21:05,280
from the payment of the premium account

435
00:21:05,280 --> 00:21:10,860
of Dropbox that was aligned with this

436
00:21:10,860 --> 00:21:14,820
with a with an with a credit card so we

437
00:21:14,820 --> 00:21:17,880
were able to to do some research in that

438
00:21:17,880 --> 00:21:20,120
matter

439
00:21:20,940 --> 00:21:24,000
so to wrap it up we wanted to mention

440
00:21:24,000 --> 00:21:26,940
some uh takeaway basically this is

441
00:21:26,940 --> 00:21:29,340
really aligned with what we have been

442
00:21:29,340 --> 00:21:32,460
listening these days and and just in the

443
00:21:32,460 --> 00:21:35,280
the Target that was before this one so a

444
00:21:35,280 --> 00:21:38,940
division of course is hard and uh but

445
00:21:38,940 --> 00:21:42,059
um besides all the the complications

446
00:21:42,059 --> 00:21:45,240
that we can have it is good to at least

447
00:21:45,240 --> 00:21:48,720
try to identify gtbs because what we

448
00:21:48,720 --> 00:21:51,659
learn is that in insane response that

449
00:21:51,659 --> 00:21:55,140
can help us to uh maybe anticipate some

450
00:21:55,140 --> 00:21:58,200
of the moves we can anticipate what the

451
00:21:58,200 --> 00:22:01,919
this people may be doing next so that is

452
00:22:01,919 --> 00:22:04,679
helpful for us to uh to have in advance

453
00:22:04,679 --> 00:22:07,919
then uh well thread intelligence is key

454
00:22:07,919 --> 00:22:10,320
during Asian response and and

455
00:22:10,320 --> 00:22:13,980
unfortunately for us so our leader is

456
00:22:13,980 --> 00:22:16,200
both the leader of the Indian response

457
00:22:16,200 --> 00:22:18,539
team and the three Intel team so we both

458
00:22:18,539 --> 00:22:20,940
the teams work together in all things

459
00:22:20,940 --> 00:22:23,159
students and and that is something that

460
00:22:23,159 --> 00:22:25,919
it must be done because we need to

461
00:22:25,919 --> 00:22:28,500
really work in collaboration and and and

462
00:22:28,500 --> 00:22:30,659
and try to help each other into

463
00:22:30,659 --> 00:22:33,299
defeating these guys and then of course

464
00:22:33,299 --> 00:22:35,400
take care of the weakest link that are

465
00:22:35,400 --> 00:22:38,220
humans we are we heard a lot about and

466
00:22:38,220 --> 00:22:42,240
Fa fatigue lately and we always try to

467
00:22:42,240 --> 00:22:44,580
put the best in our products and your

468
00:22:44,580 --> 00:22:47,280
products and and that is really cool but

469
00:22:47,280 --> 00:22:50,580
we also try to uh have to to to educate

470
00:22:50,580 --> 00:22:53,100
users and and try to to be more

471
00:22:53,100 --> 00:22:57,020
um empathetic and help people and as

472
00:22:57,020 --> 00:22:59,700
Santiago was just showing cloud is great

473
00:22:59,700 --> 00:23:02,299
but you need to be able to configure it

474
00:23:02,299 --> 00:23:05,640
appropriately because if not well nasty

475
00:23:05,640 --> 00:23:08,100
things can happen and and your business

476
00:23:08,100 --> 00:23:11,780
can suffer a lot and lastly

477
00:23:11,780 --> 00:23:14,100
unpredictables reductors can be

478
00:23:14,100 --> 00:23:16,620
dangerous so these guys

479
00:23:16,620 --> 00:23:20,039
um they didn't show a a sort of a

480
00:23:20,039 --> 00:23:23,400
specific specific pattern they just do

481
00:23:23,400 --> 00:23:25,559
whatever they wanted sometimes they ask

482
00:23:25,559 --> 00:23:28,140
for money sometimes they didn't so

483
00:23:28,140 --> 00:23:32,280
um and that a kind of behavior can be

484
00:23:32,280 --> 00:23:35,159
really difficult for us to uh to keep

485
00:23:35,159 --> 00:23:37,860
track on and and well to help our

486
00:23:37,860 --> 00:23:40,320
clients so so well keep that in mind and

487
00:23:40,320 --> 00:23:43,740
and lastly we wanted to share with you

488
00:23:43,740 --> 00:23:47,460
um some uh interesting thing that that

489
00:23:47,460 --> 00:23:51,120
wheels are in incidents that are not

490
00:23:51,120 --> 00:23:53,940
related to lapses but regarding the

491
00:23:53,940 --> 00:23:56,400
predictability of redactors sometimes in

492
00:23:56,400 --> 00:23:59,159
order to achieve their goals uh they do

493
00:23:59,159 --> 00:24:01,980
like really other things and in this

494
00:24:01,980 --> 00:24:04,620
case in an incident that in both Branson

495
00:24:04,620 --> 00:24:07,700
were one of our clients

496
00:24:07,700 --> 00:24:09,539
was left

497
00:24:09,539 --> 00:24:13,559
um a phone message that girl went like

498
00:24:13,559 --> 00:24:14,460
this

499
00:24:14,460 --> 00:24:17,460
minutos

500
00:24:28,980 --> 00:24:31,980
hello

501
00:24:33,240 --> 00:24:36,480
I hope you do speak English because this

502
00:24:36,480 --> 00:24:38,659
message is very important

503
00:24:38,659 --> 00:24:42,120
my name is Michael and we attacked your

504
00:24:42,120 --> 00:24:46,380
company two days ago and now we have a

505
00:24:46,380 --> 00:24:48,539
huge volume of your company's

506
00:24:48,539 --> 00:24:50,780
confidential data

507
00:24:50,780 --> 00:24:54,780
encrypted on your company servers and

508
00:24:54,780 --> 00:24:57,059
download it to our servers

509
00:24:57,059 --> 00:24:59,820
we have your partners and clients data

510
00:24:59,820 --> 00:25:03,720
Financial Accounting data and much more

511
00:25:03,720 --> 00:25:06,179
we want negotiations

512
00:25:06,179 --> 00:25:08,760
how to start negotiations

513
00:25:08,760 --> 00:25:12,900
take your I.T specialists and go to your

514
00:25:12,900 --> 00:25:17,520
server and find any folder you can open

515
00:25:17,520 --> 00:25:20,700
so we just wanted to give you a little

516
00:25:20,700 --> 00:25:22,980
glance of uh interesting things that can

517
00:25:22,980 --> 00:25:24,600
happen in an incident because maybe we

518
00:25:24,600 --> 00:25:26,460
are not that used to outside that kind

519
00:25:26,460 --> 00:25:28,919
of stuff and uh and these are the the

520
00:25:28,919 --> 00:25:31,980
people that we are against uh remember

521
00:25:31,980 --> 00:25:34,020
that there are so those people behind

522
00:25:34,020 --> 00:25:36,779
all these attacks and also it's not

523
00:25:36,779 --> 00:25:38,760
funny to see this when you're trying to

524
00:25:38,760 --> 00:25:41,100
access your your company infrastructure

525
00:25:41,100 --> 00:25:43,740
this is the comp the account all wipe

526
00:25:43,740 --> 00:25:44,700
out

527
00:25:44,700 --> 00:25:47,460
so it's like you lose everything and you

528
00:25:47,460 --> 00:25:50,220
are not able to to restore it

529
00:25:50,220 --> 00:25:53,240
and I think that's it that's it

530
00:25:53,240 --> 00:25:59,220
[Applause]

531
00:25:59,220 --> 00:26:01,200
okay we have time for a couple of

532
00:26:01,200 --> 00:26:03,480
questions I see there is one gentleman

533
00:26:03,480 --> 00:26:05,880
over here

534
00:26:05,880 --> 00:26:08,659
hold on

535
00:26:09,600 --> 00:26:11,279
yeah

536
00:26:11,279 --> 00:26:14,039
thanks for a great presentation

537
00:26:14,039 --> 00:26:16,620
um can you share if like the screen you

538
00:26:16,620 --> 00:26:19,559
are seeing there no access so would they

539
00:26:19,559 --> 00:26:21,480
also be able to provide you with a

540
00:26:21,480 --> 00:26:22,679
recovery

541
00:26:22,679 --> 00:26:25,140
of that data was that the data that was

542
00:26:25,140 --> 00:26:27,720
exfiltrated yes they first exfiltrate

543
00:26:27,720 --> 00:26:29,760
the data and they did destroy everything

544
00:26:29,760 --> 00:26:32,940
the data including the in that what they

545
00:26:32,940 --> 00:26:36,480
destroyed right so if you don't have an

546
00:26:36,480 --> 00:26:39,720
an isolated backup in another media you

547
00:26:39,720 --> 00:26:43,980
will lose it anyways you will lose it in

548
00:26:43,980 --> 00:26:45,539
that matter right

549
00:26:45,539 --> 00:26:48,059
so for the recovery part of the stuff

550
00:26:48,059 --> 00:26:50,640
they exfiltrated would they

551
00:26:50,640 --> 00:26:52,740
would they provide that tool do you know

552
00:26:52,740 --> 00:26:55,740
no no no because they they don't ask for

553
00:26:55,740 --> 00:26:59,039
ransom normally right it's like they

554
00:26:59,039 --> 00:27:02,460
could if because they have the data but

555
00:27:02,460 --> 00:27:04,860
we haven't seen that they are contacting

556
00:27:04,860 --> 00:27:08,039
the our clients in order to to read to

557
00:27:08,039 --> 00:27:11,340
to return the data what they say is that

558
00:27:11,340 --> 00:27:15,900
in some in one case I think it was they

559
00:27:15,900 --> 00:27:18,720
like trying to talk with them in order

560
00:27:18,720 --> 00:27:21,779
to not to leak that data or to not to

561
00:27:21,779 --> 00:27:24,900
appear in their telegram Channel but

562
00:27:24,900 --> 00:27:28,140
normally they only leak the data and

563
00:27:28,140 --> 00:27:31,799
in one shot without notice

564
00:27:31,799 --> 00:27:34,500
thanks one something funny that we saw

565
00:27:34,500 --> 00:27:36,900
also is that they they made they they

566
00:27:36,900 --> 00:27:40,200
made a pool for example of which plane

567
00:27:40,200 --> 00:27:44,460
data do you want us to leak and they set

568
00:27:44,460 --> 00:27:47,400
three clients and the people voted in

569
00:27:47,400 --> 00:27:50,520
order to to see what client they wanted

570
00:27:50,520 --> 00:27:53,460
the data but the funny thing is that

571
00:27:53,460 --> 00:27:58,500
that act pushed the other clients to to

572
00:27:58,500 --> 00:28:01,919
to to to say that they were hacked uh

573
00:28:01,919 --> 00:28:06,260
besides they didn't click the data right

574
00:28:07,919 --> 00:28:11,779
okay any other questions

575
00:28:13,500 --> 00:28:15,539
actually I have one

576
00:28:15,539 --> 00:28:18,419
don't you think that a lot of the lapses

577
00:28:18,419 --> 00:28:21,120
attacks are not contributing to what I

578
00:28:21,120 --> 00:28:23,760
see the human problem because you you

579
00:28:23,760 --> 00:28:27,480
have the MFA fatigue attack and a couple

580
00:28:27,480 --> 00:28:29,520
of other things social engineering stuff

581
00:28:29,520 --> 00:28:33,179
to get inside it is that right or am I

582
00:28:33,179 --> 00:28:35,820
wrong the thing is that they they take

583
00:28:35,820 --> 00:28:38,400
the opportunity right if they if they

584
00:28:38,400 --> 00:28:41,460
see uh I wouldn't have really I won't

585
00:28:41,460 --> 00:28:45,059
enable box they go through there the the

586
00:28:45,059 --> 00:28:47,100
the important thing of the human link is

587
00:28:47,100 --> 00:28:51,960
that because the main focus was to

588
00:28:51,960 --> 00:28:55,679
buy those credentials or to bypass those

589
00:28:55,679 --> 00:29:00,200
logins or to take advantages of the weak

590
00:29:00,200 --> 00:29:04,679
remote access tools right it's it's they

591
00:29:04,679 --> 00:29:07,380
they are not stuck with one that's why

592
00:29:07,380 --> 00:29:10,260
what's super important the the ttps that

593
00:29:10,260 --> 00:29:13,140
Gary showed is like and and the problem

594
00:29:13,140 --> 00:29:15,840
with attribution that a lot of tdps are

595
00:29:15,840 --> 00:29:19,080
overlapping so it it's part of it it's

596
00:29:19,080 --> 00:29:21,899
like maybe it's normal to to have in

597
00:29:21,899 --> 00:29:25,200
mind having a patching protocol or to

598
00:29:25,200 --> 00:29:27,840
harden the the the what we are exposing

599
00:29:27,840 --> 00:29:32,100
online but we we are not still fully

600
00:29:32,100 --> 00:29:34,620
aware of what we should do regarding or

601
00:29:34,620 --> 00:29:38,039
or the people that's working with us

602
00:29:38,039 --> 00:29:39,299
okay

603
00:29:39,299 --> 00:29:41,399
any other questions

604
00:29:41,399 --> 00:29:45,439
no let's think together

605
00:29:46,480 --> 00:29:49,180
[Applause]

