1
00:00:02,100 --> 00:00:03,959
my name is jono

2
00:00:03,959 --> 00:00:06,060
um I am a senior technical threat

3
00:00:06,060 --> 00:00:07,620
intelligence analyst within the kind of

4
00:00:07,620 --> 00:00:11,280
wider PWC uh cyber team

5
00:00:11,280 --> 00:00:13,080
um I love these introduction slides not

6
00:00:13,080 --> 00:00:14,759
because well I'm not really relevant

7
00:00:14,759 --> 00:00:16,139
like you can read everything there is to

8
00:00:16,139 --> 00:00:18,119
know about me on this slide but I like

9
00:00:18,119 --> 00:00:19,740
taking these opportunities to talk about

10
00:00:19,740 --> 00:00:21,539
my team

11
00:00:21,539 --> 00:00:23,100
um because without them I well I

12
00:00:23,100 --> 00:00:24,480
wouldn't be standing up here today not

13
00:00:24,480 --> 00:00:26,220
they didn't save my life but they did

14
00:00:26,220 --> 00:00:28,080
allow me to kind of go into a field

15
00:00:28,080 --> 00:00:29,519
completely by accident

16
00:00:29,519 --> 00:00:31,800
um I can't really get into it now but I

17
00:00:31,800 --> 00:00:33,719
confuse the word instant response for

18
00:00:33,719 --> 00:00:34,920
international relations on a job

19
00:00:34,920 --> 00:00:37,380
application and actually ended up in TI

20
00:00:37,380 --> 00:00:39,360
just completely by accident so I really

21
00:00:39,360 --> 00:00:41,640
shouldn't be here but thanks to the PWC

22
00:00:41,640 --> 00:00:43,079
team and thank you to the VB team as

23
00:00:43,079 --> 00:00:45,239
well for selecting this talk I'm uh

24
00:00:45,239 --> 00:00:49,620
super humbled and very very grateful and

25
00:00:49,620 --> 00:00:51,180
I guess when I when I think about what

26
00:00:51,180 --> 00:00:53,340
really interests me about TI and what

27
00:00:53,340 --> 00:00:55,320
really makes me excited about doing

28
00:00:55,320 --> 00:00:59,340
research is being able to tell a story

29
00:00:59,340 --> 00:01:01,739
um most of the malware that's analyzed

30
00:01:01,739 --> 00:01:03,960
by the PWC team and I'm sure by CTI

31
00:01:03,960 --> 00:01:06,299
analysts in this in this room is it's

32
00:01:06,299 --> 00:01:08,220
not boring but it's really hard to tell

33
00:01:08,220 --> 00:01:09,900
a story about it

34
00:01:09,900 --> 00:01:12,360
um you end up having to kind of debug

35
00:01:12,360 --> 00:01:14,640
stay in either go back to the debugger

36
00:01:14,640 --> 00:01:17,640
it's not sexy it's not cool but this is

37
00:01:17,640 --> 00:01:20,520
a story of a threat actor that actually

38
00:01:20,520 --> 00:01:22,680
has like a really cool story

39
00:01:22,680 --> 00:01:24,119
um and it's pretty much the only reason

40
00:01:24,119 --> 00:01:25,619
that I put it in for a request for

41
00:01:25,619 --> 00:01:27,540
proposal is because I I like it I think

42
00:01:27,540 --> 00:01:30,960
it's cool but I'm also burdened with

43
00:01:30,960 --> 00:01:33,420
having to to tell the story I have 30

44
00:01:33,420 --> 00:01:34,860
minutes to tell the story of attractor

45
00:01:34,860 --> 00:01:36,119
that we spent eight to nine months

46
00:01:36,119 --> 00:01:38,520
analyzing which is that sucks like I

47
00:01:38,520 --> 00:01:40,740
would like to spend longer but I'm using

48
00:01:40,740 --> 00:01:43,979
this agenda as a way to kind of help me

49
00:01:43,979 --> 00:01:46,520
more than you summarize this activity

50
00:01:46,520 --> 00:01:48,840
and present to you basically our

51
00:01:48,840 --> 00:01:51,299
research over the last well just under a

52
00:01:51,299 --> 00:01:51,960
year

53
00:01:51,960 --> 00:01:53,100
um so

54
00:01:53,100 --> 00:01:54,659
who what am I talking about I'm talking

55
00:01:54,659 --> 00:01:57,360
about a highly likely china-based

56
00:01:57,360 --> 00:01:58,979
product now I don't love the diamond

57
00:01:58,979 --> 00:02:01,079
model all the time but in this instance

58
00:02:01,079 --> 00:02:03,119
it's actually really helpful because we

59
00:02:03,119 --> 00:02:05,759
have a really concrete idea of what and

60
00:02:05,759 --> 00:02:08,580
who red Dev 26 actually is as I said

61
00:02:08,580 --> 00:02:10,139
it's highly likely a china-based threat

62
00:02:10,139 --> 00:02:12,900
actor they have a very very specific

63
00:02:12,900 --> 00:02:14,819
tool set and this will be quite

64
00:02:14,819 --> 00:02:16,800
significant later on in the presentation

65
00:02:16,800 --> 00:02:19,200
when it comes to attribution not the

66
00:02:19,200 --> 00:02:20,760
attribution always matters but in this

67
00:02:20,760 --> 00:02:23,760
case it's it's kind of contested

68
00:02:23,760 --> 00:02:25,560
um the tool set that we're talking about

69
00:02:25,560 --> 00:02:27,840
is a dll loader that we call shelf

70
00:02:27,840 --> 00:02:31,020
loader and that leads into a final stage

71
00:02:31,020 --> 00:02:32,700
payload which is kind of like a reverse

72
00:02:32,700 --> 00:02:34,140
shell it looks a little bit like

73
00:02:34,140 --> 00:02:36,420
interpreter but it's it's a fairly

74
00:02:36,420 --> 00:02:37,980
standard reverse shell it has upload

75
00:02:37,980 --> 00:02:40,379
download file right read capabilities

76
00:02:40,379 --> 00:02:42,959
it also has very specific victimologies

77
00:02:42,959 --> 00:02:45,300
we're talking South China Sea countries

78
00:02:45,300 --> 00:02:48,420
or rather entities based in countries

79
00:02:48,420 --> 00:02:50,220
within the South China Sea as well as

80
00:02:50,220 --> 00:02:53,060
the East China Sea too more recently

81
00:02:53,060 --> 00:02:55,200
there is infrastructure overlap between

82
00:02:55,200 --> 00:02:56,760
campaigns or at least in the earlier

83
00:02:56,760 --> 00:03:00,000
campaigns recently we've seen a turn

84
00:03:00,000 --> 00:03:04,080
towards more less shared infrastructure

85
00:03:04,080 --> 00:03:06,180
and more one by one campaign basis

86
00:03:06,180 --> 00:03:09,060
however some of the victims which aren't

87
00:03:09,060 --> 00:03:10,920
related to The Campaign appear on

88
00:03:10,920 --> 00:03:13,140
multiple IPS so I again if someone could

89
00:03:13,140 --> 00:03:14,400
help me answer that question that'd be

90
00:03:14,400 --> 00:03:16,400
awesome because I don't know why that is

91
00:03:16,400 --> 00:03:19,379
but with the kind of introduction of the

92
00:03:19,379 --> 00:03:21,420
threat actor out the way it is time to

93
00:03:21,420 --> 00:03:23,940
talk about well how we got here because

94
00:03:23,940 --> 00:03:26,040
it's always interesting for me as an

95
00:03:26,040 --> 00:03:28,260
analyst to hear how people start

96
00:03:28,260 --> 00:03:30,900
analyzing activity and this is also a

97
00:03:30,900 --> 00:03:32,400
great opportunity for me to shout out

98
00:03:32,400 --> 00:03:35,159
one of my one of my best colleagues and

99
00:03:35,159 --> 00:03:37,739
a close friend John Southworth bits of

100
00:03:37,739 --> 00:03:39,900
binary on Twitter who basically passed

101
00:03:39,900 --> 00:03:41,360
me this because he had too much to do

102
00:03:41,360 --> 00:03:43,680
and eventually we ended up expanding

103
00:03:43,680 --> 00:03:45,239
this into the threat actor that it is

104
00:03:45,239 --> 00:03:47,519
today but essentially I was given this

105
00:03:47,519 --> 00:03:50,760
sample from February 2022 which was

106
00:03:50,760 --> 00:03:53,580
targeting uh well it looked to be

107
00:03:53,580 --> 00:03:55,560
targeting the asean conference that was

108
00:03:55,560 --> 00:03:57,180
going on in the same month

109
00:03:57,180 --> 00:04:00,060
and I looked in our threat intelligence

110
00:04:00,060 --> 00:04:01,860
repository and portal and saw that we'd

111
00:04:01,860 --> 00:04:04,319
actually seen similar asean targeting

112
00:04:04,319 --> 00:04:06,659
back when there was a previous Summit in

113
00:04:06,659 --> 00:04:08,400
May 2021

114
00:04:08,400 --> 00:04:11,519
if you I by chance looked at the dll of

115
00:04:11,519 --> 00:04:14,340
that report in May 2021 and found that

116
00:04:14,340 --> 00:04:15,720
actually and I don't know if you can see

117
00:04:15,720 --> 00:04:16,978
it on the screen all the way in the back

118
00:04:16,978 --> 00:04:19,500
because I've struggled all day but these

119
00:04:19,500 --> 00:04:21,779
two dlls they're different but they are

120
00:04:21,779 --> 00:04:23,520
very very similar similar enough that I

121
00:04:23,520 --> 00:04:24,960
was like okay

122
00:04:24,960 --> 00:04:27,000
bit weird I should probably keep

123
00:04:27,000 --> 00:04:28,680
investigating this

124
00:04:28,680 --> 00:04:31,440
now this is where stuff kind of gets

125
00:04:31,440 --> 00:04:33,600
complicated because

126
00:04:33,600 --> 00:04:37,440
in May 2021 the IP that was used

127
00:04:37,440 --> 00:04:40,020
was attributed in open source to apt-41

128
00:04:40,020 --> 00:04:43,020
or barium yeah barium

129
00:04:43,020 --> 00:04:45,720
and then this activity in February 22

130
00:04:45,720 --> 00:04:48,300
was attributed to Mustang Panda or

131
00:04:48,300 --> 00:04:50,160
bronze president both of those are

132
00:04:50,160 --> 00:04:51,540
china-based threat actors with their own

133
00:04:51,540 --> 00:04:53,100
bespoke ttps

134
00:04:53,100 --> 00:04:56,400
now I fell victim to apt-41 in well not

135
00:04:56,400 --> 00:04:58,860
me I I wasn't hacked by apt-41 but I

136
00:04:58,860 --> 00:05:01,199
fell victim to the victimology kind of

137
00:05:01,199 --> 00:05:03,360
trap of apt-41 and I actually said in

138
00:05:03,360 --> 00:05:05,100
our first report it could actually be

139
00:05:05,100 --> 00:05:08,040
APC 41 based on the infrastructure

140
00:05:08,040 --> 00:05:10,259
when that report came out in February

141
00:05:10,259 --> 00:05:13,320
2022 it was actually it actually came

142
00:05:13,320 --> 00:05:16,199
out that the it the IP that was used in

143
00:05:16,199 --> 00:05:17,880
that campaign that was attributed to

144
00:05:17,880 --> 00:05:21,240
apt-41 was downgraded so actually I was

145
00:05:21,240 --> 00:05:22,919
left calling it apt-41 without any

146
00:05:22,919 --> 00:05:26,400
evidence which that sucked but it led me

147
00:05:26,400 --> 00:05:29,400
to think if I can find two dlls that are

148
00:05:29,400 --> 00:05:31,440
very similar that are almost a year

149
00:05:31,440 --> 00:05:32,820
apart they're about nine months apart

150
00:05:32,820 --> 00:05:35,039
that look very similar that do exactly

151
00:05:35,039 --> 00:05:36,600
the same thing

152
00:05:36,600 --> 00:05:39,600
what what else can I investigate and so

153
00:05:39,600 --> 00:05:41,220
I made like a very brief ER rule it

154
00:05:41,220 --> 00:05:43,139
wasn't pretty it wasn't cool but it did

155
00:05:43,139 --> 00:05:46,380
get me to a sample from January 2021 so

156
00:05:46,380 --> 00:05:48,600
we're still in February 2022 having made

157
00:05:48,600 --> 00:05:50,940
that asean report however

158
00:05:50,940 --> 00:05:54,360
I am now looking at a binary from 2020

159
00:05:54,360 --> 00:05:57,539
January 2022 so the month proceeding and

160
00:05:57,539 --> 00:05:59,639
then after that I said oh okay right

161
00:05:59,639 --> 00:06:01,740
well we've got we've got quite a lot

162
00:06:01,740 --> 00:06:03,360
here I should probably do some more work

163
00:06:03,360 --> 00:06:06,960
on this threat actor and I did and we

164
00:06:06,960 --> 00:06:09,539
found 17 other binaries uh one of which

165
00:06:09,539 --> 00:06:12,620
is from 2019 and the rest are from 2021

166
00:06:12,620 --> 00:06:15,539
and I will say that most of this

167
00:06:15,539 --> 00:06:17,460
analysis was not done through malware

168
00:06:17,460 --> 00:06:19,199
analysis I did very little re at this

169
00:06:19,199 --> 00:06:21,660
point it was just spray and pray Yara at

170
00:06:21,660 --> 00:06:23,039
some of the strings and some of the

171
00:06:23,039 --> 00:06:25,080
malware and hope that it actually works

172
00:06:25,080 --> 00:06:27,840
and it did so we ended up with again I

173
00:06:27,840 --> 00:06:29,940
hope you can see this red is not a good

174
00:06:29,940 --> 00:06:32,100
color in light but

175
00:06:32,100 --> 00:06:35,100
in 2019 we see one binary

176
00:06:35,100 --> 00:06:38,880
we don't see any until 2021 a very

177
00:06:38,880 --> 00:06:41,699
specific event in 2021

178
00:06:41,699 --> 00:06:43,800
and then the threat actor just continues

179
00:06:43,800 --> 00:06:45,360
to ramp up activity let me just check

180
00:06:45,360 --> 00:06:47,460
the time continues to ramp up activity

181
00:06:47,460 --> 00:06:49,020
all the way

182
00:06:49,020 --> 00:06:50,360
into

183
00:06:50,360 --> 00:06:52,680
2022 all the way in fact up to August

184
00:06:52,680 --> 00:06:54,660
2022 was the last binary that I've seen

185
00:06:54,660 --> 00:06:57,900
with this rad actor it seems to me at

186
00:06:57,900 --> 00:07:02,699
least that from 2021 onwards we see a a

187
00:07:02,699 --> 00:07:04,500
specific goal in mind when they're

188
00:07:04,500 --> 00:07:07,740
targeting whereas in 2019 well they're

189
00:07:07,740 --> 00:07:09,660
not using the reverse shell in 2019

190
00:07:09,660 --> 00:07:11,160
they're using cobblestrike so the

191
00:07:11,160 --> 00:07:14,280
operations are a bit less clear

192
00:07:14,280 --> 00:07:16,680
and that makes me think and I have to be

193
00:07:16,680 --> 00:07:18,300
very careful because in threat

194
00:07:18,300 --> 00:07:20,039
intelligence we often use assessment

195
00:07:20,039 --> 00:07:22,259
confidence or confidence assessments I

196
00:07:22,259 --> 00:07:23,639
should say in fact we always use

197
00:07:23,639 --> 00:07:25,560
confidence assessments

198
00:07:25,560 --> 00:07:27,599
and I'm going to have to not use that

199
00:07:27,599 --> 00:07:29,940
right now so forgive me TI gods for

200
00:07:29,940 --> 00:07:31,680
doing what I'm about to do

201
00:07:31,680 --> 00:07:34,199
there is no activity between 2020 no

202
00:07:34,199 --> 00:07:37,680
observable activity between 2020 2019

203
00:07:37,680 --> 00:07:39,599
and 2021.

204
00:07:39,599 --> 00:07:43,319
between the year 2019 and 2021 we see a

205
00:07:43,319 --> 00:07:44,819
kind of shift in code base

206
00:07:44,819 --> 00:07:46,380
and we'll see that when we come on to

207
00:07:46,380 --> 00:07:48,780
the changes in the binary But ultimately

208
00:07:48,780 --> 00:07:51,720
what we see is actually the threat actor

209
00:07:51,720 --> 00:07:54,660
makes the binary less clean in 2021 than

210
00:07:54,660 --> 00:07:57,599
they do in 2019. in addition they stop

211
00:07:57,599 --> 00:08:00,120
using Cobalt strike and they start using

212
00:08:00,120 --> 00:08:02,580
this reverse shell that I will kind of

213
00:08:02,580 --> 00:08:03,900
talk about in technical detail in a

214
00:08:03,900 --> 00:08:05,580
little bit

215
00:08:05,580 --> 00:08:07,800
which makes me think

216
00:08:07,800 --> 00:08:10,319
we have clustered all of this under red

217
00:08:10,319 --> 00:08:12,060
deck 26 just by virtue of the fact

218
00:08:12,060 --> 00:08:13,620
malware and infrastructure and

219
00:08:13,620 --> 00:08:15,180
victimology because there is overlap

220
00:08:15,180 --> 00:08:17,039
across all three which is good enough

221
00:08:17,039 --> 00:08:18,419
for me

222
00:08:18,419 --> 00:08:19,740
but

223
00:08:19,740 --> 00:08:23,039
it is possible that actually as we know

224
00:08:23,039 --> 00:08:24,360
china-based train actors do love to

225
00:08:24,360 --> 00:08:26,160
share code and there is overlap across

226
00:08:26,160 --> 00:08:27,720
multiple threat actors and I I think

227
00:08:27,720 --> 00:08:30,240
about shared malware Shadow pads plug X

228
00:08:30,240 --> 00:08:33,839
and poison ivy etc etc all of those

229
00:08:33,839 --> 00:08:35,399
malwares have been shared across

230
00:08:35,399 --> 00:08:37,380
multiple threat actors it could be that

231
00:08:37,380 --> 00:08:39,899
actually red Dev 26 doesn't start out as

232
00:08:39,899 --> 00:08:42,360
red Dev 26 starts out as another threat

233
00:08:42,360 --> 00:08:44,099
actor and what we're clustering is Red

234
00:08:44,099 --> 00:08:45,839
Dead 26 is actually

235
00:08:45,839 --> 00:08:48,360
another threat actor reusing code base

236
00:08:48,360 --> 00:08:50,820
from a previous generation of of malware

237
00:08:50,820 --> 00:08:54,180
but who knows it's not my well it is my

238
00:08:54,180 --> 00:08:56,700
job but I don't know that that part

239
00:08:56,700 --> 00:08:59,279
so this is what happened when I actually

240
00:08:59,279 --> 00:09:00,660
mapped it out now I will say full

241
00:09:00,660 --> 00:09:02,580
disclosure I did what I thought was a

242
00:09:02,580 --> 00:09:05,040
really nice graph of all the dlls nobody

243
00:09:05,040 --> 00:09:06,779
in my team agreed with me so we ended up

244
00:09:06,779 --> 00:09:08,940
with this as a compromise so this is all

245
00:09:08,940 --> 00:09:10,860
the raw archives that have I have seen

246
00:09:10,860 --> 00:09:14,160
related to Red Dev 26 activity as you

247
00:09:14,160 --> 00:09:17,100
can see Myanmar starts off as being a

248
00:09:17,100 --> 00:09:19,500
really big Target now again there are a

249
00:09:19,500 --> 00:09:21,000
couple of caveats or rather cool little

250
00:09:21,000 --> 00:09:22,680
tidbits that I actually have time to

251
00:09:22,680 --> 00:09:24,720
mention you can see oh I'm going to use

252
00:09:24,720 --> 00:09:27,360
the laser all in one this thing here you

253
00:09:27,360 --> 00:09:29,480
can see a 2019

254
00:09:29,480 --> 00:09:33,000
timestamp that's wrong the thracter

255
00:09:33,000 --> 00:09:34,980
realistic probability as far as I'm

256
00:09:34,980 --> 00:09:36,899
aware what they do is they take the

257
00:09:36,899 --> 00:09:38,820
actual legitimate all-in-one font which

258
00:09:38,820 --> 00:09:41,940
is a font package for uh that was on the

259
00:09:41,940 --> 00:09:44,279
president of myanmar's website they

260
00:09:44,279 --> 00:09:46,920
repackaged it with their own dll now I

261
00:09:46,920 --> 00:09:48,779
don't know whether they put it back

262
00:09:48,779 --> 00:09:51,839
inside the the actual legitimate place

263
00:09:51,839 --> 00:09:54,420
in the in the present of myanmar's

264
00:09:54,420 --> 00:09:58,200
website but in BT the ITW URL is that

265
00:09:58,200 --> 00:10:00,240
link so I don't know make of that what

266
00:10:00,240 --> 00:10:02,100
you will but either way the threat actor

267
00:10:02,100 --> 00:10:04,740
uses or repurposes a legitimate zip

268
00:10:04,740 --> 00:10:07,200
package for their own ends which I

269
00:10:07,200 --> 00:10:08,760
thought was pretty interesting and then

270
00:10:08,760 --> 00:10:11,760
we kind of see this like cluster

271
00:10:11,760 --> 00:10:14,640
and then we see this one here uh this is

272
00:10:14,640 --> 00:10:16,260
interesting for pretty much non-related

273
00:10:16,260 --> 00:10:17,519
reason but I'm so glad I could actually

274
00:10:17,519 --> 00:10:19,260
segue into it now

275
00:10:19,260 --> 00:10:23,519
this this ZIP includes a a Word document

276
00:10:23,519 --> 00:10:27,000
uh which is related to a an article made

277
00:10:27,000 --> 00:10:29,760
by oh you're really testing my

278
00:10:29,760 --> 00:10:33,060
preparation skills now oh made by a an

279
00:10:33,060 --> 00:10:34,320
Asian youth

280
00:10:34,320 --> 00:10:35,040
um

281
00:10:35,040 --> 00:10:36,720
Outlet when I can't remember the name of

282
00:10:36,720 --> 00:10:38,580
them but I'm sure I could after this

283
00:10:38,580 --> 00:10:39,779
talk like directly after it I'll

284
00:10:39,779 --> 00:10:41,040
remember it

285
00:10:41,040 --> 00:10:44,160
um it was it was the article was made in

286
00:10:44,160 --> 00:10:49,140
26th of April 2022 and the packaged the

287
00:10:49,140 --> 00:10:50,880
original early modifications of the

288
00:10:50,880 --> 00:10:53,640
document was April 26 2022 but the

289
00:10:53,640 --> 00:10:55,500
latest modification was the 5th of May

290
00:10:55,500 --> 00:10:58,079
which is exactly the same as the zip I

291
00:10:58,079 --> 00:11:00,420
speculated or I made an assessment a

292
00:11:00,420 --> 00:11:02,040
confidence assessment with a realistic

293
00:11:02,040 --> 00:11:03,300
probability that actually the threat

294
00:11:03,300 --> 00:11:05,820
actor had poised to Target whoever they

295
00:11:05,820 --> 00:11:07,500
were tasked to Target they took the

296
00:11:07,500 --> 00:11:08,760
original translation of the document

297
00:11:08,760 --> 00:11:10,440
which was English and then they

298
00:11:10,440 --> 00:11:12,600
translated it badly into whichever

299
00:11:12,600 --> 00:11:14,579
language they needed to for the Target

300
00:11:14,579 --> 00:11:16,440
and in this case it was Burmese which is

301
00:11:16,440 --> 00:11:19,079
the official language of Myanmar

302
00:11:19,079 --> 00:11:21,000
um one also really interesting thing to

303
00:11:21,000 --> 00:11:23,100
note before I I I'm on time that's fine

304
00:11:23,100 --> 00:11:25,440
one interesting thing to note here is

305
00:11:25,440 --> 00:11:28,620
this this is where we see red Dev 26

306
00:11:28,620 --> 00:11:30,360
start up operations again which is

307
00:11:30,360 --> 00:11:33,060
actually February 2nd 2022 or at least

308
00:11:33,060 --> 00:11:36,959
the dll is compiled February 2022.

309
00:11:36,959 --> 00:11:40,380
uh in the first of February 2022 that's

310
00:11:40,380 --> 00:11:43,380
when the Myanmar coup starts so we see a

311
00:11:43,380 --> 00:11:45,779
very specific date of a geopolitical

312
00:11:45,779 --> 00:11:48,300
event followed by Red 26 activity and

313
00:11:48,300 --> 00:11:50,279
that is followed up again the

314
00:11:50,279 --> 00:11:52,740
Philippines there is a lot of discussion

315
00:11:52,740 --> 00:11:54,720
around the relationship between duterte

316
00:11:54,720 --> 00:11:56,880
or Rodrigo duterte's Philippines

317
00:11:56,880 --> 00:11:59,459
president and Xi Jinping or the kind of

318
00:11:59,459 --> 00:12:00,839
the CCP in general around their

319
00:12:00,839 --> 00:12:03,060
relationship and the pivot back towards

320
00:12:03,060 --> 00:12:05,459
the United States well we see three

321
00:12:05,459 --> 00:12:07,500
three pretty distinct Philippines

322
00:12:07,500 --> 00:12:10,200
targets Philippine targeting or

323
00:12:10,200 --> 00:12:11,820
targeting philippine-based entities

324
00:12:11,820 --> 00:12:14,940
throughout the November into December

325
00:12:14,940 --> 00:12:17,760
into early 2022 kind of Nexus

326
00:12:17,760 --> 00:12:19,920
and then we have some random well I say

327
00:12:19,920 --> 00:12:21,779
random there are asean events going on

328
00:12:21,779 --> 00:12:23,880
but it's it's not as cool as Myanmar of

329
00:12:23,880 --> 00:12:25,019
the Philippines in terms of like

330
00:12:25,019 --> 00:12:27,660
consistent targeting but we see clearly

331
00:12:27,660 --> 00:12:29,640
Red Dead 26 has a motivation when it

332
00:12:29,640 --> 00:12:31,860
comes to kind of targeting of entities

333
00:12:31,860 --> 00:12:34,260
and then we have Thailand which is this

334
00:12:34,260 --> 00:12:36,000
is roughly when discussions begin about

335
00:12:36,000 --> 00:12:37,380
are they going to be shared exercises

336
00:12:37,380 --> 00:12:41,279
between Thailand and the and the CC and

337
00:12:41,279 --> 00:12:43,620
the pla which took place in August 25th

338
00:12:43,620 --> 00:12:47,519
of 2022 which is great so

339
00:12:47,519 --> 00:12:49,019
we've kind of mapped out the threat

340
00:12:49,019 --> 00:12:51,959
actor what do they actually do how do

341
00:12:51,959 --> 00:12:54,120
they actually operate well this is an

342
00:12:54,120 --> 00:12:56,220
overview I don't really know how much I

343
00:12:56,220 --> 00:12:58,500
want to kind of go over this but

344
00:12:58,500 --> 00:12:59,459
essentially

345
00:12:59,459 --> 00:13:02,339
we are fairly certain realistic

346
00:13:02,339 --> 00:13:05,040
probability realistic probability to

347
00:13:05,040 --> 00:13:07,620
highly likely confident that the threat

348
00:13:07,620 --> 00:13:09,959
actor uses spear phishing as an initial

349
00:13:09,959 --> 00:13:12,839
access method I say that because we know

350
00:13:12,839 --> 00:13:14,940
that most of the campaigns that we have

351
00:13:14,940 --> 00:13:18,360
observed use either Dropbox or a G Drive

352
00:13:18,360 --> 00:13:20,639
Link which you would click on and the

353
00:13:20,639 --> 00:13:21,959
payload would arrive on your system in

354
00:13:21,959 --> 00:13:22,980
downloads

355
00:13:22,980 --> 00:13:25,260
it doesn't execute automatically which

356
00:13:25,260 --> 00:13:28,920
leads me to assess that the threat actor

357
00:13:28,920 --> 00:13:30,180
has two

358
00:13:30,180 --> 00:13:33,060
has to convince or coerce the victim

359
00:13:33,060 --> 00:13:35,339
into targeting or clicking on the link

360
00:13:35,339 --> 00:13:37,260
and we'll see in a little bit that they

361
00:13:37,260 --> 00:13:39,420
do some methods for to try and encourage

362
00:13:39,420 --> 00:13:41,760
that and and that includes very kind of

363
00:13:41,760 --> 00:13:44,279
Spock standard things which include

364
00:13:44,279 --> 00:13:47,700
um using a PDF logo for an executable or

365
00:13:47,700 --> 00:13:49,740
hiding the dll on system all that good

366
00:13:49,740 --> 00:13:51,480
stuff basically doing as much as

367
00:13:51,480 --> 00:13:53,880
possible to kind of hide operations that

368
00:13:53,880 --> 00:13:56,220
leads into what we'd call shelf loader

369
00:13:56,220 --> 00:13:58,139
which is loaded via a benign X cutable

370
00:13:58,139 --> 00:14:00,300
which then downloads

371
00:14:00,300 --> 00:14:02,880
in memory a payload which is kind of

372
00:14:02,880 --> 00:14:05,040
like a second Stager which calls to a C2

373
00:14:05,040 --> 00:14:07,800
that C2 downloads a load of a load of

374
00:14:07,800 --> 00:14:10,500
Shell Code which is then rc4 decrypted

375
00:14:10,500 --> 00:14:13,860
and a 9x or key decrypted or decoded

376
00:14:13,860 --> 00:14:16,680
sorry into the actual command or the

377
00:14:16,680 --> 00:14:18,300
reverse shell payload

378
00:14:18,300 --> 00:14:20,279
this is shelf loader

379
00:14:20,279 --> 00:14:22,200
um if you ever get given the binary and

380
00:14:22,200 --> 00:14:23,760
I will say a full disclosure that I will

381
00:14:23,760 --> 00:14:25,980
be putting are your rules for this

382
00:14:25,980 --> 00:14:28,440
reactor and their binaries on our public

383
00:14:28,440 --> 00:14:30,240
GitHub probably tomorrow when I put the

384
00:14:30,240 --> 00:14:32,160
slides in but it will be up I promise it

385
00:14:32,160 --> 00:14:34,620
will be up this is the function I want

386
00:14:34,620 --> 00:14:36,480
people to focus on it's the kind of

387
00:14:36,480 --> 00:14:39,120
where the resource sits and we'll talk a

388
00:14:39,120 --> 00:14:41,040
little bit about how the threat actor

389
00:14:41,040 --> 00:14:43,019
does this or the techniques that they

390
00:14:43,019 --> 00:14:45,240
use to change over time because it

391
00:14:45,240 --> 00:14:47,459
wasn't always this way they have

392
00:14:47,459 --> 00:14:49,620
improved their techniques over time and

393
00:14:49,620 --> 00:14:50,880
changed some things and that's cool

394
00:14:50,880 --> 00:14:52,380
because we like

395
00:14:52,380 --> 00:14:54,600
we like stories and threat Intel we like

396
00:14:54,600 --> 00:14:56,279
the ability to see not Hands-On keyboard

397
00:14:56,279 --> 00:14:58,380
level stuff but the ability where to see

398
00:14:58,380 --> 00:14:59,820
whether threat actor has made choices

399
00:14:59,820 --> 00:15:02,160
cognizant choices and some of these

400
00:15:02,160 --> 00:15:04,139
choices are really cool so I'm not I'm

401
00:15:04,139 --> 00:15:05,399
not kind of prefacing my whole

402
00:15:05,399 --> 00:15:06,540
presentation but there is some cool

403
00:15:06,540 --> 00:15:09,060
stuff coming that isn't just this

404
00:15:09,060 --> 00:15:11,339
um you can see here the

405
00:15:11,339 --> 00:15:12,720
the

406
00:15:12,720 --> 00:15:17,040
how the malware pulls the next stage

407
00:15:17,040 --> 00:15:19,860
payload from the C2 so again I don't

408
00:15:19,860 --> 00:15:21,480
know if you can see this but but I'm

409
00:15:21,480 --> 00:15:23,040
going to use the laser pointer again so

410
00:15:23,040 --> 00:15:25,019
you have the first six bytes which are

411
00:15:25,019 --> 00:15:26,699
actually a fake TLS header and it's a

412
00:15:26,699 --> 00:15:28,139
way for the malware to kind of spoof

413
00:15:28,139 --> 00:15:30,480
Network traffic and then you have these

414
00:15:30,480 --> 00:15:33,420
three bytes 170303 and hex which the

415
00:15:33,420 --> 00:15:34,980
malware will check for just to make sure

416
00:15:34,980 --> 00:15:36,240
that actually this is the right payload

417
00:15:36,240 --> 00:15:37,740
that's what we're looking at

418
00:15:37,740 --> 00:15:40,320
the these nine bytes in total are the

419
00:15:40,320 --> 00:15:43,079
rc4 decrypted or the uh not the rc4 the

420
00:15:43,079 --> 00:15:44,880
X the nine by X all that's used after

421
00:15:44,880 --> 00:15:48,060
the rc4 the rc4 and the nine by xor

422
00:15:48,060 --> 00:15:51,180
never change uh from 2021 all the way up

423
00:15:51,180 --> 00:15:53,519
to now they don't change uh if you're

424
00:15:53,519 --> 00:15:55,139
watching this red Dev 26 please don't

425
00:15:55,139 --> 00:15:57,779
change we've really enjoyed uh having

426
00:15:57,779 --> 00:15:59,220
not had to work all that hard after

427
00:15:59,220 --> 00:16:01,320
reversing one of them but that's

428
00:16:01,320 --> 00:16:03,360
essentially shelf loader uh it's it's

429
00:16:03,360 --> 00:16:06,899
between BPF door and Crimson wrap from

430
00:16:06,899 --> 00:16:08,579
transparent tribe it's about somewhere

431
00:16:08,579 --> 00:16:11,220
in the middle of complexity but the next

432
00:16:11,220 --> 00:16:13,260
stage functionality is a little bit not

433
00:16:13,260 --> 00:16:15,480
trickier it's just more interesting the

434
00:16:15,480 --> 00:16:18,060
thrac uses a double pointer structure so

435
00:16:18,060 --> 00:16:19,980
what they do is as you can see here they

436
00:16:19,980 --> 00:16:22,560
basically make a structure of apis or d

437
00:16:22,560 --> 00:16:25,320
words to apis that they call and then

438
00:16:25,320 --> 00:16:27,959
they'll use a separate structure which

439
00:16:27,959 --> 00:16:29,459
you can kind of see here they'll use a

440
00:16:29,459 --> 00:16:31,380
separate structure to call that

441
00:16:31,380 --> 00:16:32,820
structure

442
00:16:32,820 --> 00:16:34,980
um and that's how they load apis into

443
00:16:34,980 --> 00:16:36,779
their command shell and you can kind of

444
00:16:36,779 --> 00:16:38,399
see the functionality of the command

445
00:16:38,399 --> 00:16:39,899
shell they've even included flame text

446
00:16:39,899 --> 00:16:42,180
strings which is really nice of them but

447
00:16:42,180 --> 00:16:44,459
you follow the you follow the functions

448
00:16:44,459 --> 00:16:45,899
and you can get the functionality that

449
00:16:45,899 --> 00:16:46,860
you need

450
00:16:46,860 --> 00:16:49,199
there is an interesting victim

451
00:16:49,199 --> 00:16:53,579
from August 2022 with we assess that the

452
00:16:53,579 --> 00:16:55,440
victim has uploaded the Shelf loader

453
00:16:55,440 --> 00:16:57,360
binary they've also uploaded two other

454
00:16:57,360 --> 00:16:59,940
files alongside with it that one of them

455
00:16:59,940 --> 00:17:02,339
is a golang backdoor seems to be bespoke

456
00:17:02,339 --> 00:17:04,160
I haven't analyzed it enough yet

457
00:17:04,160 --> 00:17:06,839
alongside a kind of a networking

458
00:17:06,839 --> 00:17:10,640
protocol like open source GitHub

459
00:17:10,640 --> 00:17:12,900
executable which again more work needs

460
00:17:12,900 --> 00:17:14,400
to be done on that but maybe you'll see

461
00:17:14,400 --> 00:17:16,020
me here again next year to talk about it

462
00:17:16,020 --> 00:17:18,480
but we we assess that there are more

463
00:17:18,480 --> 00:17:20,099
payloads after this this is just kind of

464
00:17:20,099 --> 00:17:21,780
the the beach head for them to kind of

465
00:17:21,780 --> 00:17:23,400
start doing what they actually want to

466
00:17:23,400 --> 00:17:25,439
be doing and we know the payload works

467
00:17:25,439 --> 00:17:27,419
it makes sense to me that they haven't

468
00:17:27,419 --> 00:17:28,860
altered all that much

469
00:17:28,860 --> 00:17:30,960
because

470
00:17:30,960 --> 00:17:33,059
they they have victims we've seen in the

471
00:17:33,059 --> 00:17:34,620
netflow victims beaconing out to the

472
00:17:34,620 --> 00:17:37,260
evict uh the c2ips of the malware so we

473
00:17:37,260 --> 00:17:39,480
know it works and we assess that there

474
00:17:39,480 --> 00:17:40,980
isn't enough information in open source

475
00:17:40,980 --> 00:17:41,880
for them to actually have to change

476
00:17:41,880 --> 00:17:43,500
anything so

477
00:17:43,500 --> 00:17:46,620
uh this is why it is what it is

478
00:17:46,620 --> 00:17:48,419
so we can talk a little bit now about

479
00:17:48,419 --> 00:17:50,340
the changes made some of them are more

480
00:17:50,340 --> 00:17:52,200
fun than others and some of them can be

481
00:17:52,200 --> 00:17:53,820
perceived to be a bit more superficial

482
00:17:53,820 --> 00:17:55,500
than others but they are nevertheless

483
00:17:55,500 --> 00:17:58,380
interesting I am again very sorry if you

484
00:17:58,380 --> 00:18:01,200
cannot read these slides they seem

485
00:18:01,200 --> 00:18:02,460
really clear when I look at them at a

486
00:18:02,460 --> 00:18:03,660
laptop but when you're staring when

487
00:18:03,660 --> 00:18:04,740
you're at the back of the room it's it's

488
00:18:04,740 --> 00:18:06,720
a lot more tricky but I've kind of tried

489
00:18:06,720 --> 00:18:08,340
to use black boxes to make it a little

490
00:18:08,340 --> 00:18:11,340
bit easier so you can see here that the

491
00:18:11,340 --> 00:18:14,039
threat actor decides initially weirdly

492
00:18:14,039 --> 00:18:16,919
to go for just the executable they hide

493
00:18:16,919 --> 00:18:20,940
the dll in in the system and you can

494
00:18:20,940 --> 00:18:22,559
easily unhide it but if you don't have

495
00:18:22,559 --> 00:18:24,600
that if you don't untick it as it is

496
00:18:24,600 --> 00:18:27,480
defaulted you won't ever see it and then

497
00:18:27,480 --> 00:18:29,580
weirdly so this is from 2021 and this is

498
00:18:29,580 --> 00:18:32,400
from February 2022. um I don't know why

499
00:18:32,400 --> 00:18:33,960
they've decided to do this thing again

500
00:18:33,960 --> 00:18:36,539
where they've added the dll back in I

501
00:18:36,539 --> 00:18:37,620
assess it's because it's called

502
00:18:37,620 --> 00:18:39,960
acrobat.dll and because this has an

503
00:18:39,960 --> 00:18:43,140
acrobat logo they they assume that the

504
00:18:43,140 --> 00:18:45,539
the target needs the target believes

505
00:18:45,539 --> 00:18:48,240
they need acrobat.dll

506
00:18:48,240 --> 00:18:50,100
um no idea but that's an interesting

507
00:18:50,100 --> 00:18:53,460
change I have seen them now go back to

508
00:18:53,460 --> 00:18:56,039
the method of not only having a dll and

509
00:18:56,039 --> 00:18:58,260
a DOT XE but also an Extended resource

510
00:18:58,260 --> 00:19:01,320
which is the word document that is

511
00:19:01,320 --> 00:19:03,539
loaded to the Target as a benign kind of

512
00:19:03,539 --> 00:19:06,240
hey it's all it's all fine when it's not

513
00:19:06,240 --> 00:19:09,720
really and then again some of these

514
00:19:09,720 --> 00:19:11,340
changes make no sense to me but they are

515
00:19:11,340 --> 00:19:13,080
changes so I have to mention them this

516
00:19:13,080 --> 00:19:15,780
is a binary this is from 2019 the threat

517
00:19:15,780 --> 00:19:18,660
actor has two exports

518
00:19:18,660 --> 00:19:21,000
um and then they go for this this method

519
00:19:21,000 --> 00:19:24,120
of having up to 302 there is this one

520
00:19:24,120 --> 00:19:26,039
really weird binary that again if people

521
00:19:26,039 --> 00:19:27,240
want to do more research on I would

522
00:19:27,240 --> 00:19:28,799
highly recommend doing it and then tell

523
00:19:28,799 --> 00:19:30,419
me how you did it because there is one

524
00:19:30,419 --> 00:19:32,400
binary that is a bit of an outlier in

525
00:19:32,400 --> 00:19:35,220
the rest it has so usually they're about

526
00:19:35,220 --> 00:19:37,799
20 to 35 exports sometimes they spoof

527
00:19:37,799 --> 00:19:40,080
legitimate dll exports but this in this

528
00:19:40,080 --> 00:19:42,840
individual case they had 302 and the

529
00:19:42,840 --> 00:19:44,820
sample runs nothing like I'd expect from

530
00:19:44,820 --> 00:19:47,100
shelf loader um so there is again more

531
00:19:47,100 --> 00:19:49,200
work to be done there is it that there

532
00:19:49,200 --> 00:19:51,419
is another actor using this code base

533
00:19:51,419 --> 00:19:53,400
no idea but it's interesting and that's

534
00:19:53,400 --> 00:19:55,320
cool we like interesting we like more

535
00:19:55,320 --> 00:19:57,660
research to be done

536
00:19:57,660 --> 00:19:59,880
uh I have nothing more to say about that

537
00:19:59,880 --> 00:20:01,799
except for the fact that you will see

538
00:20:01,799 --> 00:20:03,480
when you look at shelf loader the threat

539
00:20:03,480 --> 00:20:05,840
actor becomes more

540
00:20:05,840 --> 00:20:08,760
aggressive in their naming of exports

541
00:20:08,760 --> 00:20:10,799
I'm not going to use the swear word but

542
00:20:10,799 --> 00:20:12,780
there is like a consistent Square where

543
00:20:12,780 --> 00:20:15,179
they use for their dlls or their sorry

544
00:20:15,179 --> 00:20:16,919
their exports rather which is

545
00:20:16,919 --> 00:20:18,660
interesting

546
00:20:18,660 --> 00:20:20,340
um it seems to me and we'll talk about

547
00:20:20,340 --> 00:20:21,480
this actually in the next couple of

548
00:20:21,480 --> 00:20:23,340
slides but over time

549
00:20:23,340 --> 00:20:25,260
the threat actor starts making these

550
00:20:25,260 --> 00:20:27,660
really weird choices for their binaries

551
00:20:27,660 --> 00:20:29,220
and this is stuff that doesn't impact

552
00:20:29,220 --> 00:20:31,559
the functionality it doesn't change the

553
00:20:31,559 --> 00:20:33,960
way the malware functions or operates it

554
00:20:33,960 --> 00:20:35,880
is literally just for the analysts to

555
00:20:35,880 --> 00:20:36,660
see

556
00:20:36,660 --> 00:20:39,000
so we start off here with using font

557
00:20:39,000 --> 00:20:40,860
support as an open event

558
00:20:40,860 --> 00:20:44,340
it's fairly benign however in 2019 there

559
00:20:44,340 --> 00:20:46,440
was none of this they actually used none

560
00:20:46,440 --> 00:20:47,640
of this they didn't create an event they

561
00:20:47,640 --> 00:20:50,240
didn't do any of this there was no

562
00:20:50,240 --> 00:20:53,400
storage size for INT there was none of

563
00:20:53,400 --> 00:20:56,039
this it was just very plain and we'll

564
00:20:56,039 --> 00:20:58,980
see it in the next slide it was very

565
00:20:58,980 --> 00:21:01,320
very efficient in its code base so we

566
00:21:01,320 --> 00:21:03,179
already begin to see in 2021 the thrag

567
00:21:03,179 --> 00:21:05,160
to start to go

568
00:21:05,160 --> 00:21:07,559
I can probably get away with this we

569
00:21:07,559 --> 00:21:09,480
then start to go into a bit weird

570
00:21:09,480 --> 00:21:13,380
territory with like I work in JP uh new

571
00:21:13,380 --> 00:21:16,320
line calling the create event MTV USA

572
00:21:16,320 --> 00:21:17,760
which again I don't know how many people

573
00:21:17,760 --> 00:21:20,220
have an MTV application on their laptop

574
00:21:20,220 --> 00:21:22,559
but it's a cool create like a cool an

575
00:21:22,559 --> 00:21:25,919
event MTV USA makes no sense to me and

576
00:21:25,919 --> 00:21:27,660
then I still don't know who what Bryce

577
00:21:27,660 --> 00:21:29,940
team 11 is the rest of the like

578
00:21:29,940 --> 00:21:33,179
the rest of the shout outs if you will

579
00:21:33,179 --> 00:21:35,760
on red dive twenties from Red Dev 26

580
00:21:35,760 --> 00:21:37,440
malware makes sense to me this one

581
00:21:37,440 --> 00:21:39,000
doesn't so if anyone after this talk has

582
00:21:39,000 --> 00:21:40,980
any indication of what Bryce team 11 is

583
00:21:40,980 --> 00:21:43,679
more than happy to hear that

584
00:21:43,679 --> 00:21:45,600
then we get into the really weird

585
00:21:45,600 --> 00:21:47,760
territory where like my dream is to make

586
00:21:47,760 --> 00:21:51,179
money to support my touch okay and I'm a

587
00:21:51,179 --> 00:21:52,260
programmer that lives at the bottom

588
00:21:52,260 --> 00:21:54,780
again it's just printf it doesn't do

589
00:21:54,780 --> 00:21:56,700
anything it is literally just for the

590
00:21:56,700 --> 00:21:58,260
developer I don't really understand

591
00:21:58,260 --> 00:22:02,520
again why then we see stuff like this uh

592
00:22:02,520 --> 00:22:05,340
hyphae lee who is a he's actually on

593
00:22:05,340 --> 00:22:07,020
Twitter he's a kind of reverse engineer

594
00:22:07,020 --> 00:22:08,280
malware analyst I don't know who he

595
00:22:08,280 --> 00:22:11,159
works for but hi if you're watching uh

596
00:22:11,159 --> 00:22:14,460
we also saw Moto Sato was also copied in

597
00:22:14,460 --> 00:22:17,460
as a create event as well who is also a

598
00:22:17,460 --> 00:22:19,260
researcher who works in Japan

599
00:22:19,260 --> 00:22:20,940
and this is where things get really

600
00:22:20,940 --> 00:22:24,059
interesting because this is May or April

601
00:22:24,059 --> 00:22:26,400
to May 2022

602
00:22:26,400 --> 00:22:31,740
a a u u a r u s is Mustang panned yes

603
00:22:31,740 --> 00:22:33,840
uh I mentioned before that Mustang Panda

604
00:22:33,840 --> 00:22:36,000
was mentioned in attribution

605
00:22:36,000 --> 00:22:38,720
it was never

606
00:22:38,820 --> 00:22:41,220
it was never put in open source outside

607
00:22:41,220 --> 00:22:42,659
of

608
00:22:42,659 --> 00:22:44,760
um some VT rules that hit in the

609
00:22:44,760 --> 00:22:47,520
community section of VT the only way you

610
00:22:47,520 --> 00:22:49,080
would ever know that Mustang powder been

611
00:22:49,080 --> 00:22:50,460
attributed would be if you had a VT

612
00:22:50,460 --> 00:22:51,720
account and you could see the comments

613
00:22:51,720 --> 00:22:55,020
now in may 2022 after this binary was

614
00:22:55,020 --> 00:22:57,360
posted a threat Intel Outlet did a

615
00:22:57,360 --> 00:22:59,400
report that aligned Red Dot 26 with

616
00:22:59,400 --> 00:23:00,539
Mustang panda

617
00:23:00,539 --> 00:23:02,940
there is I do understand why they've

618
00:23:02,940 --> 00:23:05,159
done that because there is some overlap

619
00:23:05,159 --> 00:23:07,440
in the benign executables but at PWC we

620
00:23:07,440 --> 00:23:10,500
we just haven't done that yet and again

621
00:23:10,500 --> 00:23:12,600
I will talk about this in the takeaways

622
00:23:12,600 --> 00:23:15,419
attribution is fine as long as you are

623
00:23:15,419 --> 00:23:17,340
confident we're talking about why you

624
00:23:17,340 --> 00:23:19,440
attribute X is y whether that be with

625
00:23:19,440 --> 00:23:21,000
external third parties or within your

626
00:23:21,000 --> 00:23:23,400
own internal team it does not matter how

627
00:23:23,400 --> 00:23:24,840
you attribute as long as you're just

628
00:23:24,840 --> 00:23:27,480
doing it with confidence and with some

629
00:23:27,480 --> 00:23:30,600
form of evidence but this is weird and I

630
00:23:30,600 --> 00:23:31,799
thought this was very strange they begin

631
00:23:31,799 --> 00:23:33,720
to get more sweary

632
00:23:33,720 --> 00:23:35,280
and a bit more

633
00:23:35,280 --> 00:23:38,159
it's it's clear by April 2022 they know

634
00:23:38,159 --> 00:23:39,360
they're being watched

635
00:23:39,360 --> 00:23:41,520
or they know that they're being

636
00:23:41,520 --> 00:23:43,559
um analyzed and yet they still don't

637
00:23:43,559 --> 00:23:45,059
change any of the malware they don't

638
00:23:45,059 --> 00:23:47,280
change anything just the strings within

639
00:23:47,280 --> 00:23:50,039
the binary which I found to be

640
00:23:50,039 --> 00:23:52,740
relatively uh well interesting it's not

641
00:23:52,740 --> 00:23:54,900
even useful it's just interesting and

642
00:23:54,900 --> 00:23:56,700
that's what threat Intel is all about

643
00:23:56,700 --> 00:23:57,900
really

644
00:23:57,900 --> 00:23:59,940
this is the less superficial stuff the

645
00:23:59,940 --> 00:24:02,400
stuff that is I found to be quite

646
00:24:02,400 --> 00:24:04,500
significant I actually said earlier that

647
00:24:04,500 --> 00:24:05,700
they don't change their code base they

648
00:24:05,700 --> 00:24:08,340
actually do change their code base

649
00:24:08,340 --> 00:24:10,500
um so you can see here this is the 2019

650
00:24:10,500 --> 00:24:12,120
binary you can see how clean it is

651
00:24:12,120 --> 00:24:13,980
there's no extra strings there's no

652
00:24:13,980 --> 00:24:17,159
extra fat or fluff it is just virtual

653
00:24:17,159 --> 00:24:19,260
Outlook do some memory virtual protect

654
00:24:19,260 --> 00:24:23,220
run it and here we have do persistence

655
00:24:23,220 --> 00:24:27,240
mechanisms then do some virtual alloc

656
00:24:27,240 --> 00:24:28,919
and then do create thread so we already

657
00:24:28,919 --> 00:24:31,980
see some some changes but not I would

658
00:24:31,980 --> 00:24:33,900
say in an efficient way it's just it's

659
00:24:33,900 --> 00:24:36,360
just bad or at least inefficient I

660
00:24:36,360 --> 00:24:38,220
shouldn't say bad because it works just

661
00:24:38,220 --> 00:24:39,780
inefficient and then

662
00:24:39,780 --> 00:24:41,820
the threat to really changes things up

663
00:24:41,820 --> 00:24:44,039
because they stop using Create thread

664
00:24:44,039 --> 00:24:46,980
and they stop using the start address as

665
00:24:46,980 --> 00:24:49,020
a way to Pivot into their their newly

666
00:24:49,020 --> 00:24:52,020
formed dll what they do is they use

667
00:24:52,020 --> 00:24:53,820
they use apis that have callback

668
00:24:53,820 --> 00:24:56,340
functions so graystring w is one if

669
00:24:56,340 --> 00:24:58,620
you've ever heard of it it just bitmaps

670
00:24:58,620 --> 00:25:01,559
like it Grays out a bitmap area and in

671
00:25:01,559 --> 00:25:03,480
update formats hey so what you do is you

672
00:25:03,480 --> 00:25:04,860
just basically use a callback function

673
00:25:04,860 --> 00:25:07,559
within the API to load the resources

674
00:25:07,559 --> 00:25:09,360
it's not clever but it is interesting

675
00:25:09,360 --> 00:25:11,880
and it threw me for about 10 seconds

676
00:25:11,880 --> 00:25:13,860
where I was like where's create thread

677
00:25:13,860 --> 00:25:16,380
I'm lost so I found an undated format

678
00:25:16,380 --> 00:25:19,620
and said oh okay fair enough cool

679
00:25:19,620 --> 00:25:21,960
also the way that the malware loads the

680
00:25:21,960 --> 00:25:24,539
apis is interesting too

681
00:25:24,539 --> 00:25:27,600
not the apis the resource

682
00:25:27,600 --> 00:25:29,520
you can see here this is the technique

683
00:25:29,520 --> 00:25:32,460
the thracter uses for about 10 months

684
00:25:32,460 --> 00:25:36,059
from 2021 uh well from 2019 actually

685
00:25:36,059 --> 00:25:38,279
it's two years isn't it 2019 all the way

686
00:25:38,279 --> 00:25:40,200
to May 2021

687
00:25:40,200 --> 00:25:41,820
where they have a resource that's a big

688
00:25:41,820 --> 00:25:43,080
Clump in memory and then they just

689
00:25:43,080 --> 00:25:46,440
unwind it using an algorithm and here is

690
00:25:46,440 --> 00:25:48,659
what they do from about September 2019

691
00:25:48,659 --> 00:25:52,140
20 September 2021 all the way to now

692
00:25:52,140 --> 00:25:54,120
where they put the resource in these

693
00:25:54,120 --> 00:25:55,980
functions and they're about you'd see a

694
00:25:55,980 --> 00:25:58,919
chain of about 30 35 functions that have

695
00:25:58,919 --> 00:26:01,140
these encoded resources that are then

696
00:26:01,140 --> 00:26:04,140
put inside this function here that are

697
00:26:04,140 --> 00:26:06,500
then Unwound and appended to each other

698
00:26:06,500 --> 00:26:09,360
to eventually end up with the with the

699
00:26:09,360 --> 00:26:11,460
final stage kind of loader that calls

700
00:26:11,460 --> 00:26:13,740
the C2 that loads the the command shell

701
00:26:13,740 --> 00:26:16,380
the reverse shell which is interesting

702
00:26:16,380 --> 00:26:18,059
they also use these like weird Keys

703
00:26:18,059 --> 00:26:20,520
sometimes it's just as simple as being

704
00:26:20,520 --> 00:26:22,500
like an md5 hash of a key and sometimes

705
00:26:22,500 --> 00:26:25,080
it's Larry W cash dollar six again

706
00:26:25,080 --> 00:26:27,360
threat actors choice not mine

707
00:26:27,360 --> 00:26:30,360
and so I'm coming to the end

708
00:26:30,360 --> 00:26:32,640
um and I guess what I wanted from the

709
00:26:32,640 --> 00:26:34,860
from the end bit was what we found

710
00:26:34,860 --> 00:26:37,200
useful as a TI team

711
00:26:37,200 --> 00:26:39,320
um

712
00:26:39,600 --> 00:26:41,400
Espionage takes a long time to

713
00:26:41,400 --> 00:26:42,900
understand and ransomware service

714
00:26:42,900 --> 00:26:44,400
operators too having done research into

715
00:26:44,400 --> 00:26:46,679
Darkseid and black matter it takes a

716
00:26:46,679 --> 00:26:47,880
while to understand what the threat Act

717
00:26:47,880 --> 00:26:49,320
is all about and sometimes you won't

718
00:26:49,320 --> 00:26:50,820
have any ideas sometimes you're left

719
00:26:50,820 --> 00:26:52,679
with speculation which isn't

720
00:26:52,679 --> 00:26:54,419
intelligence it's it's just speculation

721
00:26:54,419 --> 00:26:56,220
and it's fun but it shouldn't go in

722
00:26:56,220 --> 00:26:58,620
reports as confidence assessment

723
00:26:58,620 --> 00:27:00,179
um so I would always advise threat Intel

724
00:27:00,179 --> 00:27:02,640
Outlets to take time analyzing stuff and

725
00:27:02,640 --> 00:27:05,400
that includes re like scrub it clean get

726
00:27:05,400 --> 00:27:08,520
as much done as possible really know the

727
00:27:08,520 --> 00:27:10,860
op codes in and out and with that comes

728
00:27:10,860 --> 00:27:12,600
the bottom Point Let's see if I can call

729
00:27:12,600 --> 00:27:14,760
the point there yeah documentation like

730
00:27:14,760 --> 00:27:16,320
even if you're not writing a report on a

731
00:27:16,320 --> 00:27:19,140
malware document it and I am so guilty

732
00:27:19,140 --> 00:27:21,000
of this I don't document anything if I'm

733
00:27:21,000 --> 00:27:22,860
not report I used to not document stuff

734
00:27:22,860 --> 00:27:24,539
if I wasn't reporting on it I would just

735
00:27:24,539 --> 00:27:26,039
kind of have it in my brain and go yeah

736
00:27:26,039 --> 00:27:27,539
if that comes up I'll I'll absolutely

737
00:27:27,539 --> 00:27:30,779
remember it I never do so please when

738
00:27:30,779 --> 00:27:32,400
you analyze document because your team

739
00:27:32,400 --> 00:27:34,200
when they pick it up will remember or

740
00:27:34,200 --> 00:27:35,460
rather have something to go off and

741
00:27:35,460 --> 00:27:37,740
won't have to start from base zero and

742
00:27:37,740 --> 00:27:38,940
then finally

743
00:27:38,940 --> 00:27:41,279
be comfortable with attribution like

744
00:27:41,279 --> 00:27:44,700
it's all good uh you can you it's not

745
00:27:44,700 --> 00:27:45,960
you can get things wrong but you can

746
00:27:45,960 --> 00:27:48,360
have competing hypotheses with other

747
00:27:48,360 --> 00:27:49,860
Intel Outlets or even within team

748
00:27:49,860 --> 00:27:51,659
members as long as you know why you

749
00:27:51,659 --> 00:27:54,120
attribute X is y and it isn't ridiculous

750
00:27:54,120 --> 00:27:56,880
then that's that's cool and that is

751
00:27:56,880 --> 00:27:58,559
actually everything I want to say so

752
00:27:58,559 --> 00:27:59,760
thank you so much guys I really

753
00:27:59,760 --> 00:28:02,100
appreciate it

754
00:28:02,100 --> 00:28:04,219
thank you

755
00:28:06,059 --> 00:28:08,400
well thank you jono uh we have time for

756
00:28:08,400 --> 00:28:12,240
one or two questions any questions

757
00:28:12,240 --> 00:28:14,039
or you all want to get a cup of tea or

758
00:28:14,039 --> 00:28:16,158
coffee

759
00:28:18,480 --> 00:28:20,760
well in that case uh well thank you for

760
00:28:20,760 --> 00:28:22,140
your presentation then please join me in

761
00:28:22,140 --> 00:28:23,090
thanking Yono

762
00:28:23,090 --> 00:28:27,480
[Applause]

