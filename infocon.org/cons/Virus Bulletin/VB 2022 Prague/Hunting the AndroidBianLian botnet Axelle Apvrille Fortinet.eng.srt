1
00:00:03,480 --> 00:00:05,520
thank you very much

2
00:00:05,520 --> 00:00:07,620
um indeed we're going to continue again

3
00:00:07,620 --> 00:00:10,380
a little bit more on Android

4
00:00:10,380 --> 00:00:13,139
um following the the next talk

5
00:00:13,139 --> 00:00:19,199
um so Android bianyan may it means face

6
00:00:19,199 --> 00:00:22,140
changing I think if I'm correct

7
00:00:22,140 --> 00:00:25,680
um it's um the banking Trojan for

8
00:00:25,680 --> 00:00:28,260
Android which means that it's after your

9
00:00:28,260 --> 00:00:30,720
banking uh credentials of course okay

10
00:00:30,720 --> 00:00:32,759
and

11
00:00:32,759 --> 00:00:36,800
um it was discovered in 2018

12
00:00:36,800 --> 00:00:40,320
we'll go back to the date a little bit

13
00:00:40,320 --> 00:00:43,980
afterwards and it is inspired mainly

14
00:00:43,980 --> 00:00:48,960
from bankbot and also Anubis

15
00:00:48,960 --> 00:00:50,760
but it's not exactly from the same

16
00:00:50,760 --> 00:00:52,260
lineage

17
00:00:52,260 --> 00:00:53,820
um the well-known lineage that we have

18
00:00:53,820 --> 00:00:59,039
is bankbot Anubis Cerberus and alien and

19
00:00:59,039 --> 00:01:01,980
um bianyan is from another part like I

20
00:01:01,980 --> 00:01:05,099
don't know cousin or something like that

21
00:01:05,099 --> 00:01:07,380
um one of it's uh some of its

22
00:01:07,380 --> 00:01:10,560
specificities is that well it's really

23
00:01:10,560 --> 00:01:15,299
let's say smartly coded uh we'll discuss

24
00:01:15,299 --> 00:01:19,020
this of course afterwards again

25
00:01:19,020 --> 00:01:21,000
so I said I wanted to say a little bit

26
00:01:21,000 --> 00:01:24,540
more about the date 2018 in terms of

27
00:01:24,540 --> 00:01:27,119
Androids that's like nearly prehistoric

28
00:01:27,119 --> 00:01:30,299
it's really um a long time ago for four

29
00:01:30,299 --> 00:01:32,460
years really counts in terms of Android

30
00:01:32,460 --> 00:01:35,939
so why are we talking about something

31
00:01:35,939 --> 00:01:39,240
which was out in 2018

32
00:01:39,240 --> 00:01:43,560
the first reason is this curve well it's

33
00:01:43,560 --> 00:01:45,540
particularly effective since the

34
00:01:45,540 --> 00:01:48,479
beginning of this year 2022 actually

35
00:01:48,479 --> 00:01:51,479
even more than what it was uh it's

36
00:01:51,479 --> 00:01:54,960
originally in 2018. okay so this is the

37
00:01:54,960 --> 00:01:56,700
first reason

38
00:01:56,700 --> 00:02:00,299
the other reason is

39
00:02:00,299 --> 00:02:03,780
um really actually because of the its

40
00:02:03,780 --> 00:02:04,500
age

41
00:02:04,500 --> 00:02:08,340
it is abnormally old okay

42
00:02:08,340 --> 00:02:10,380
um if we go back to the previous slide

43
00:02:10,380 --> 00:02:12,900
you'll notice for instance that bankbot

44
00:02:12,900 --> 00:02:17,220
lived a long life of two years annabis

45
00:02:17,220 --> 00:02:20,099
one-year Cerberus one year and most of

46
00:02:20,099 --> 00:02:22,739
the time those Android botnets they live

47
00:02:22,739 --> 00:02:26,040
one or two years at most this one is

48
00:02:26,040 --> 00:02:28,200
already four years old and it's still

49
00:02:28,200 --> 00:02:30,959
like you know just up and very very

50
00:02:30,959 --> 00:02:33,360
active so this is another point we're

51
00:02:33,360 --> 00:02:35,580
going to develop in the presentation and

52
00:02:35,580 --> 00:02:38,099
understand why

53
00:02:38,099 --> 00:02:40,319
so you've seen lots of flights so you're

54
00:02:40,319 --> 00:02:41,760
going to have a little bit of a movie

55
00:02:41,760 --> 00:02:44,879
part there I'm gonna show you first

56
00:02:44,879 --> 00:02:46,739
um the malware in action so that you can

57
00:02:46,739 --> 00:02:50,040
see uh what it is doing

58
00:02:50,040 --> 00:02:52,379
it will be better than slides I'm gonna

59
00:02:52,379 --> 00:02:54,360
put that and it goes a little bit too

60
00:02:54,360 --> 00:02:57,360
fast I'll go back here

61
00:02:57,360 --> 00:03:00,480
so this is an Android phone okay the

62
00:03:00,480 --> 00:03:03,420
malware is actually installed here on

63
00:03:03,420 --> 00:03:05,700
the video player which is here this is

64
00:03:05,700 --> 00:03:07,319
just an example it could have been

65
00:03:07,319 --> 00:03:09,180
installed on another application but

66
00:03:09,180 --> 00:03:11,760
most of the time it is installed on a

67
00:03:11,760 --> 00:03:15,180
well-known application okay

68
00:03:15,180 --> 00:03:17,180
um

69
00:03:17,280 --> 00:03:19,739
as soon as you launch the video player

70
00:03:19,739 --> 00:03:23,959
it's ax asks you sorry to activate

71
00:03:23,959 --> 00:03:27,480
accessibility Services now in this

72
00:03:27,480 --> 00:03:30,180
audience I'm sure that you would know

73
00:03:30,180 --> 00:03:33,300
that this is strange and probably you

74
00:03:33,300 --> 00:03:35,760
wouldn't click uh you've got to think

75
00:03:35,760 --> 00:03:38,580
again that this is for end users and end

76
00:03:38,580 --> 00:03:40,080
users I think that the term

77
00:03:40,080 --> 00:03:42,659
accessibility Services although it is

78
00:03:42,659 --> 00:03:45,540
actually actually for accessibility it

79
00:03:45,540 --> 00:03:47,879
might be a little bit misleading for

80
00:03:47,879 --> 00:03:50,700
instance could it be for a video player

81
00:03:50,700 --> 00:03:54,000
for remote control of the video player

82
00:03:54,000 --> 00:03:56,760
an end user might be a bit disturbed by

83
00:03:56,760 --> 00:04:00,180
this fact or is it to show subtitles for

84
00:04:00,180 --> 00:04:01,799
instance and get the speech and turn

85
00:04:01,799 --> 00:04:04,260
that into subtitles so there are plenty

86
00:04:04,260 --> 00:04:06,900
of reasons why this might not be totally

87
00:04:06,900 --> 00:04:10,379
clear to the to the end user

88
00:04:10,379 --> 00:04:12,599
so here in this video of course we'll

89
00:04:12,599 --> 00:04:15,780
play dumb and we'll click everywhere so

90
00:04:15,780 --> 00:04:18,478
that it works okay

91
00:04:18,478 --> 00:04:20,639
um you get another pop-up and this one

92
00:04:20,639 --> 00:04:22,260
is really kind of getting a little bit

93
00:04:22,260 --> 00:04:24,419
more alarming but once again let's say

94
00:04:24,419 --> 00:04:27,120
that we're kind of the random end user

95
00:04:27,120 --> 00:04:30,060
and we click yes and okay to everything

96
00:04:30,060 --> 00:04:32,820
so there it's installing you've got a

97
00:04:32,820 --> 00:04:35,220
few pop-ups and that's not exactly

98
00:04:35,220 --> 00:04:39,120
normal but it's how it behaves and then

99
00:04:39,120 --> 00:04:41,820
you see actually that the video player

100
00:04:41,820 --> 00:04:44,280
application has disappeared so they are

101
00:04:44,280 --> 00:04:46,560
probably the end user will think oh it

102
00:04:46,560 --> 00:04:48,360
crashed something is not working

103
00:04:48,360 --> 00:04:51,000
correctly actually the malware is

104
00:04:51,000 --> 00:04:53,160
running in background

105
00:04:53,160 --> 00:04:56,580
and it is listening for any mobile Bank

106
00:04:56,580 --> 00:04:59,540
application and when it will C1 it will

107
00:04:59,540 --> 00:05:03,479
do stuff there and here as an example

108
00:05:03,479 --> 00:05:06,479
on this Android smartphone we installed

109
00:05:06,479 --> 00:05:10,380
an application of PTT bank which is a

110
00:05:10,380 --> 00:05:13,320
Turkish Bank it is again just an example

111
00:05:13,320 --> 00:05:15,479
there are over 500 Banks which are

112
00:05:15,479 --> 00:05:17,280
targeted I just had to choose one I

113
00:05:17,280 --> 00:05:19,620
couldn't put 500 right

114
00:05:19,620 --> 00:05:20,280
um

115
00:05:20,280 --> 00:05:23,299
and we'll continue

116
00:05:23,820 --> 00:05:26,699
they're starting the application and

117
00:05:26,699 --> 00:05:31,320
this is the login page for the bank now

118
00:05:31,320 --> 00:05:35,240
see if you have already seen heard about

119
00:05:35,240 --> 00:05:37,680
overlays well this is exactly what is

120
00:05:37,680 --> 00:05:40,340
happening you've got the mobile

121
00:05:40,340 --> 00:05:43,320
application of the bank which is

122
00:05:43,320 --> 00:05:45,900
official and it's asking for a login

123
00:05:45,900 --> 00:05:49,380
page but the mobile the the malware so

124
00:05:49,380 --> 00:05:52,979
that the banking application was run and

125
00:05:52,979 --> 00:05:55,139
it says I'm going to put on top of that

126
00:05:55,139 --> 00:05:58,320
an overlay a window with exactly the

127
00:05:58,320 --> 00:06:00,960
same things it just looks like that this

128
00:06:00,960 --> 00:06:03,419
is um exactly what at the end you used

129
00:06:03,419 --> 00:06:06,660
to say sees and you've got it's going to

130
00:06:06,660 --> 00:06:09,479
ask the credentials and the end user is

131
00:06:09,479 --> 00:06:12,600
going to enter username and password on

132
00:06:12,600 --> 00:06:14,820
the top window which is actually going

133
00:06:14,820 --> 00:06:17,340
to the malware and not underneath to the

134
00:06:17,340 --> 00:06:21,440
real official application

135
00:06:21,660 --> 00:06:23,220
so that's

136
00:06:23,220 --> 00:06:25,740
you you some of you are I guess have

137
00:06:25,740 --> 00:06:28,080
already seen that it's pretty common uh

138
00:06:28,080 --> 00:06:30,780
but it's uh to be sure that you've seen

139
00:06:30,780 --> 00:06:32,580
it once uh working because it's pretty

140
00:06:32,580 --> 00:06:35,160
amazing

141
00:06:35,160 --> 00:06:38,160
so yeah key points it's really it has

142
00:06:38,160 --> 00:06:40,440
been out for really a long time and the

143
00:06:40,440 --> 00:06:42,139
other thing that I wanted to point out

144
00:06:42,139 --> 00:06:45,419
is that the banking app the mobile app

145
00:06:45,419 --> 00:06:48,180
of the bank is partly particularly fine

146
00:06:48,180 --> 00:06:50,759
okay there's nothing wrong with it

147
00:06:50,759 --> 00:06:53,280
um the malware is usually in another app

148
00:06:53,280 --> 00:06:56,840
uh somewhere on the system

149
00:06:57,060 --> 00:06:59,880
so now how does it sell

150
00:06:59,880 --> 00:07:01,740
um underground

151
00:07:01,740 --> 00:07:06,180
um how do the threat actors actually

152
00:07:06,180 --> 00:07:09,479
um sell this botnet to their customers

153
00:07:09,479 --> 00:07:11,699
so you've got of course the malware

154
00:07:11,699 --> 00:07:16,080
authors and in the case of danyan we

155
00:07:16,080 --> 00:07:19,020
think that there is only one malware

156
00:07:19,020 --> 00:07:21,360
author possibly two but a very

157
00:07:21,360 --> 00:07:23,780
restricted group

158
00:07:23,780 --> 00:07:27,000
malware authors usually don't sell

159
00:07:27,000 --> 00:07:31,020
directly to end users well cyber

160
00:07:31,020 --> 00:07:33,840
criminals in the end they usually refer

161
00:07:33,840 --> 00:07:34,800
to

162
00:07:34,800 --> 00:07:37,919
um sales team like in a real company to

163
00:07:37,919 --> 00:07:41,160
do the sales part okay

164
00:07:41,160 --> 00:07:45,120
um same we think that it is only like

165
00:07:45,120 --> 00:07:48,180
between 1 and 10 uh resellers there but

166
00:07:48,180 --> 00:07:51,060
not not a huge group

167
00:07:51,060 --> 00:07:52,819
and again

168
00:07:52,819 --> 00:07:56,220
the customers which are going to buy and

169
00:07:56,220 --> 00:07:59,099
rent the the botnet well it's not like

170
00:07:59,099 --> 00:08:00,720
in other botnets where you have

171
00:08:00,720 --> 00:08:03,900
thousands of people buying the botnet

172
00:08:03,900 --> 00:08:08,400
here it's always between 3 and 30 well

173
00:08:08,400 --> 00:08:11,160
it's big range okay but it's not that

174
00:08:11,160 --> 00:08:14,160
much uh it's well below the hundreds

175
00:08:14,160 --> 00:08:18,060
there and they install that on various

176
00:08:18,060 --> 00:08:21,360
come on and control centers

177
00:08:21,360 --> 00:08:24,060
um to um to to grab the the money and

178
00:08:24,060 --> 00:08:25,560
grab the credentials

179
00:08:25,560 --> 00:08:28,560
as for money well the Affiliates it's

180
00:08:28,560 --> 00:08:32,099
the usual scheme uh they are renting the

181
00:08:32,099 --> 00:08:35,099
botnet and they pay the sales team and

182
00:08:35,099 --> 00:08:36,839
in the end the malware author gets a

183
00:08:36,839 --> 00:08:39,779
little bit of money in okay

184
00:08:39,779 --> 00:08:41,099
now

185
00:08:41,099 --> 00:08:45,000
um how does this get advertised so that

186
00:08:45,000 --> 00:08:47,399
the Affiliates

187
00:08:47,399 --> 00:08:49,800
um rent The botnet Well of course you've

188
00:08:49,800 --> 00:08:52,820
got uh hacking forums

189
00:08:52,820 --> 00:08:56,580
uh very much instant messaging

190
00:08:56,580 --> 00:09:00,300
and also actually just simply videos on

191
00:09:00,300 --> 00:09:01,740
YouTube

192
00:09:01,740 --> 00:09:04,200
so I'm going to show you

193
00:09:04,200 --> 00:09:06,779
one video

194
00:09:06,779 --> 00:09:10,320
um it's pretty amazing to see that on on

195
00:09:10,320 --> 00:09:14,640
YouTube this one is an Android botnet

196
00:09:14,640 --> 00:09:19,320
uh from May 2022 as far as I know I

197
00:09:19,320 --> 00:09:22,140
haven't seen samples in the wild yet do

198
00:09:22,140 --> 00:09:24,180
you see it advertises just like you know

199
00:09:24,180 --> 00:09:26,399
a company would advertise a real product

200
00:09:26,399 --> 00:09:29,580
and then they are showing uh this or

201
00:09:29,580 --> 00:09:33,000
that feature of the C2 panel

202
00:09:33,000 --> 00:09:35,760
um to to show off what what it can do

203
00:09:35,760 --> 00:09:38,220
I'm gonna cut that because well we only

204
00:09:38,220 --> 00:09:40,560
have 30 minutes but you you have the

205
00:09:40,560 --> 00:09:42,899
link or you can just Google it and

206
00:09:42,899 --> 00:09:44,459
you'll find them

207
00:09:44,459 --> 00:09:47,880
you'll find the video on on YouTube

208
00:09:47,880 --> 00:09:49,200
yep

209
00:09:49,200 --> 00:09:51,620
we go

210
00:09:52,200 --> 00:09:55,740
so I actually had lots of issues finding

211
00:09:55,740 --> 00:09:58,980
references to bandland Underground

212
00:09:58,980 --> 00:10:01,200
why Wow

213
00:10:01,200 --> 00:10:03,600
the main reason is of course that it's

214
00:10:03,600 --> 00:10:06,000
not named pyandian underground that's

215
00:10:06,000 --> 00:10:08,459
the name that we antivirus vendors gave

216
00:10:08,459 --> 00:10:11,100
it but the real name underground is

217
00:10:11,100 --> 00:10:12,480
Hydra

218
00:10:12,480 --> 00:10:14,880
then there's another issue

219
00:10:14,880 --> 00:10:18,300
Hydra is a password cracker and a famous

220
00:10:18,300 --> 00:10:21,120
one so whenever we are searching for

221
00:10:21,120 --> 00:10:24,540
that underground or on Google or on any

222
00:10:24,540 --> 00:10:26,880
search engine well most of the time we

223
00:10:26,880 --> 00:10:28,920
end up with references to the password

224
00:10:28,920 --> 00:10:32,100
tracker and not to the botnet

225
00:10:32,100 --> 00:10:34,140
so that was kind of a little bit

226
00:10:34,140 --> 00:10:37,819
annoying but it's the way it is

227
00:10:38,100 --> 00:10:40,200
um a prior researcher managed to get

228
00:10:40,200 --> 00:10:44,339
access to one of the panels of Hydra and

229
00:10:44,339 --> 00:10:47,040
we see a screenshot there of what he saw

230
00:10:47,040 --> 00:10:49,860
so a nice thing you see that here

231
00:10:49,860 --> 00:10:52,740
there's the reference to the name Hydra

232
00:10:52,740 --> 00:10:55,620
Hydra panel and then probably it might

233
00:10:55,620 --> 00:10:58,320
be a little bit small for you but

234
00:10:58,320 --> 00:11:00,060
um that those are the various other

235
00:11:00,060 --> 00:11:03,540
features that the botnet can can do and

236
00:11:03,540 --> 00:11:06,140
unfortunately for us in terms of search

237
00:11:06,140 --> 00:11:08,160
searching things well there's no

238
00:11:08,160 --> 00:11:10,740
remarkable words again so it's going to

239
00:11:10,740 --> 00:11:13,980
be difficult to do search for it on on

240
00:11:13,980 --> 00:11:17,899
internet based on those on the panel

241
00:11:17,899 --> 00:11:22,079
so after seeing lots of advertisements

242
00:11:22,079 --> 00:11:23,519
to

243
00:11:23,519 --> 00:11:26,339
um to rent for instance cannabis annabis

244
00:11:26,339 --> 00:11:28,079
is supposed to be dead but I don't know

245
00:11:28,079 --> 00:11:31,260
I see it everywhere underground okay

246
00:11:31,260 --> 00:11:33,360
um Annabelle Cerberus and I think I

247
00:11:33,360 --> 00:11:35,940
thought well maybe actually those people

248
00:11:35,940 --> 00:11:38,459
are advertising

249
00:11:38,459 --> 00:11:41,940
um I don't know Cerberus but uh they're

250
00:11:41,940 --> 00:11:44,220
they're not the name is wrong and maybe

251
00:11:44,220 --> 00:11:47,579
this is actually bian well no

252
00:11:47,579 --> 00:11:50,760
uh we checked with what was being

253
00:11:50,760 --> 00:11:53,399
advertised the features and the feature

254
00:11:53,399 --> 00:11:55,740
do not features do not match the ones of

255
00:11:55,740 --> 00:12:00,060
yan yan one of um the the best thing to

256
00:12:00,060 --> 00:12:03,480
check is that Ghanaian for instance is

257
00:12:03,480 --> 00:12:05,959
using a remote control

258
00:12:05,959 --> 00:12:08,820
application which is known as TeamViewer

259
00:12:08,820 --> 00:12:11,040
okay it's an official one it's a

260
00:12:11,040 --> 00:12:13,320
absolutely legitimate

261
00:12:13,320 --> 00:12:16,860
and it uses that to remote control

262
00:12:16,860 --> 00:12:18,720
um the the infected phone

263
00:12:18,720 --> 00:12:21,180
whereas the other botnets most of them

264
00:12:21,180 --> 00:12:25,560
accept alien uh all the others are using

265
00:12:25,560 --> 00:12:30,240
a custom protocol VNC well named VNC but

266
00:12:30,240 --> 00:12:32,339
that's not the VNC tool that you might

267
00:12:32,339 --> 00:12:34,920
know which is doing the remote control

268
00:12:34,920 --> 00:12:36,000
thing

269
00:12:36,000 --> 00:12:39,600
so because of that we know that uh when

270
00:12:39,600 --> 00:12:42,540
we see an advertisement underground if

271
00:12:42,540 --> 00:12:47,240
it is really likely to be Hydra or not

272
00:12:47,820 --> 00:12:52,320
we managed finally to see a threat actor

273
00:12:52,320 --> 00:12:56,760
who was selling uh Hydra on Telegram

274
00:12:56,760 --> 00:13:00,000
this threat actor has been known to sell

275
00:13:00,000 --> 00:13:02,519
many different Android botnets and has

276
00:13:02,519 --> 00:13:04,920
actually now shifted since uh one year

277
00:13:04,920 --> 00:13:07,860
more to Android spyware

278
00:13:07,860 --> 00:13:12,380
and we saw in hacking forums another guy

279
00:13:12,380 --> 00:13:16,440
who was selling and then a private

280
00:13:16,440 --> 00:13:19,740
Android botnet he didn't name it but it

281
00:13:19,740 --> 00:13:23,160
this really could be a Hydra because

282
00:13:23,160 --> 00:13:25,800
well it's private which would explain

283
00:13:25,800 --> 00:13:29,220
why we don't have that many c2s or other

284
00:13:29,220 --> 00:13:32,579
time it's selling is saying sorry

285
00:13:32,579 --> 00:13:34,620
explicitly that it's selling it with

286
00:13:34,620 --> 00:13:36,540
limited slots which is also something

287
00:13:36,540 --> 00:13:39,920
which matches

288
00:13:40,740 --> 00:13:44,279
um no VNC as I told you it's the Biryani

289
00:13:44,279 --> 00:13:46,380
is using TeamViewer so it looks like

290
00:13:46,380 --> 00:13:49,500
that as well and it insists

291
00:13:49,500 --> 00:13:54,320
that it's not emoted or animus

292
00:13:57,980 --> 00:14:01,380
so this one could be could be Beyond

293
00:14:01,380 --> 00:14:03,920
indeed

294
00:14:04,320 --> 00:14:06,720
so the thing to remember there is that

295
00:14:06,720 --> 00:14:08,519
bellian is keeping a low profile

296
00:14:08,519 --> 00:14:09,779
Underground

297
00:14:09,779 --> 00:14:13,079
uh which might seem a little bit strange

298
00:14:13,079 --> 00:14:15,240
because if they want to make the most

299
00:14:15,240 --> 00:14:17,579
money maybe they might want to spread

300
00:14:17,579 --> 00:14:18,899
more

301
00:14:18,899 --> 00:14:21,779
but when you think that's this malware

302
00:14:21,779 --> 00:14:24,000
has been out for more than the others

303
00:14:24,000 --> 00:14:28,980
maybe actually it is the way to to live

304
00:14:28,980 --> 00:14:32,120
longer kind of

305
00:14:33,240 --> 00:14:35,880
so um I also developed

306
00:14:35,880 --> 00:14:38,700
um a script simple script to

307
00:14:38,700 --> 00:14:42,720
um to test and to find c2s which are

308
00:14:42,720 --> 00:14:44,760
available at any moment

309
00:14:44,760 --> 00:14:48,420
basically um given on the few features I

310
00:14:48,420 --> 00:14:50,639
know that this or that IP is likely to

311
00:14:50,639 --> 00:14:54,660
be a C2 of Afghan Yan and I send a

312
00:14:54,660 --> 00:14:57,540
command to it asking it for the list of

313
00:14:57,540 --> 00:14:59,339
targeted applications

314
00:14:59,339 --> 00:15:02,760
using ganyan's protocol and if it

315
00:15:02,760 --> 00:15:04,740
answers to that well it means that no

316
00:15:04,740 --> 00:15:08,160
scanlan's protocol so it is indeed a C2

317
00:15:08,160 --> 00:15:10,620
of that.net and then well if we don't

318
00:15:10,620 --> 00:15:12,720
know about it we can add it to our to

319
00:15:12,720 --> 00:15:16,320
our list so I'm going to demo that

320
00:15:16,320 --> 00:15:17,339
um

321
00:15:17,339 --> 00:15:20,220
it's a live demo so

322
00:15:20,220 --> 00:15:22,860
anything can happen

323
00:15:22,860 --> 00:15:24,980
um

324
00:15:26,160 --> 00:15:28,740
so

325
00:15:28,740 --> 00:15:31,399
there we go

326
00:15:34,800 --> 00:15:38,180
so that's one of it

327
00:15:40,079 --> 00:15:42,720
so it fits the screen so whenever you

328
00:15:42,720 --> 00:15:46,260
see new it means that it's a new C2

329
00:15:46,260 --> 00:15:49,560
which is on you means like I scanned on

330
00:15:49,560 --> 00:15:53,880
Friday so it has been up since it hasn't

331
00:15:53,880 --> 00:15:56,220
it's new since uh last Friday

332
00:15:56,220 --> 00:15:59,399
and up means that it is operational but

333
00:15:59,399 --> 00:16:03,000
I have already seen it last Friday

334
00:16:03,000 --> 00:16:06,420
and there so what you see will let it go

335
00:16:06,420 --> 00:16:08,399
is that well

336
00:16:08,399 --> 00:16:11,279
um which countries it is targeting most

337
00:16:11,279 --> 00:16:13,860
and the number of apps and you see for

338
00:16:13,860 --> 00:16:15,660
instance that some of them are targeting

339
00:16:15,660 --> 00:16:18,060
only very few apps and few countries

340
00:16:18,060 --> 00:16:20,699
turkey Germany Israel and then the

341
00:16:20,699 --> 00:16:24,180
Netherlands while some other c2s are

342
00:16:24,180 --> 00:16:26,220
targeting like you know this one for

343
00:16:26,220 --> 00:16:27,079
instance

344
00:16:27,079 --> 00:16:29,820
520 apps it's basically targeting

345
00:16:29,820 --> 00:16:32,279
everything it can everywhere okay so

346
00:16:32,279 --> 00:16:35,040
this pretty much depends on what we get

347
00:16:35,040 --> 00:16:37,199
so

348
00:16:37,199 --> 00:16:39,480
we'll see what we get in the end yeah

349
00:16:39,480 --> 00:16:42,959
this one also 15 only 15 apps

350
00:16:42,959 --> 00:16:48,439
Banks mostly uh in Austria and Germany

351
00:16:48,540 --> 00:16:50,220
now I think all the rest will be just

352
00:16:50,220 --> 00:16:52,519
down

353
00:16:54,360 --> 00:16:56,339
so the ones which are down can be false

354
00:16:56,339 --> 00:16:59,160
positives also because maybe you're the

355
00:16:59,160 --> 00:17:01,380
no longer

356
00:17:01,380 --> 00:17:05,519
or really actually twos

357
00:17:06,959 --> 00:17:09,959
so yeah we had um

358
00:17:09,959 --> 00:17:14,099
and we had 22 up and 22 down and five

359
00:17:14,099 --> 00:17:17,240
new okay

360
00:17:19,439 --> 00:17:21,839
pretty I score today we're happy with

361
00:17:21,839 --> 00:17:23,280
that

362
00:17:23,280 --> 00:17:27,199
well I shouldn't be of course but

363
00:17:27,720 --> 00:17:30,840
that's what I said though and yeah just

364
00:17:30,840 --> 00:17:33,720
wanted to highlight that probably it is

365
00:17:33,720 --> 00:17:36,360
the c2s are run by different threat

366
00:17:36,360 --> 00:17:38,280
actors because they are targeting

367
00:17:38,280 --> 00:17:39,960
different countries and a different

368
00:17:39,960 --> 00:17:42,360
number of country and of apps in those

369
00:17:42,360 --> 00:17:44,520
countries so it looks likely that it's

370
00:17:44,520 --> 00:17:46,080
probably different threat actors in the

371
00:17:46,080 --> 00:17:47,760
ends

372
00:17:47,760 --> 00:17:49,679
you won't be surprised too much to know

373
00:17:49,679 --> 00:17:52,200
that they are using internet service

374
00:17:52,200 --> 00:17:56,280
providers which are very often High

375
00:17:56,280 --> 00:17:59,100
fraud risk and that they prefer those

376
00:17:59,100 --> 00:18:00,780
where they can

377
00:18:00,780 --> 00:18:03,240
um purchase and pay uh using

378
00:18:03,240 --> 00:18:05,760
cryptocurrencies but it's not always the

379
00:18:05,760 --> 00:18:08,700
case Okay sometimes it's also very um

380
00:18:08,700 --> 00:18:12,360
low profile and low um

381
00:18:12,360 --> 00:18:16,939
yeah low risk isps

382
00:18:17,160 --> 00:18:19,440
on their smartphone the smartphone is

383
00:18:19,440 --> 00:18:22,919
not directly referencing the C2 it uses

384
00:18:22,919 --> 00:18:25,799
an intermediate URL

385
00:18:25,799 --> 00:18:29,160
and that intermediate URL is then

386
00:18:29,160 --> 00:18:31,860
serving a domain name which resolves to

387
00:18:31,860 --> 00:18:34,200
the IP address

388
00:18:34,200 --> 00:18:36,720
so this is what we have in the end and

389
00:18:36,720 --> 00:18:40,740
for each point in that change we have

390
00:18:40,740 --> 00:18:43,919
um well it's maintained okay so uh for

391
00:18:43,919 --> 00:18:46,020
instance the C2 I see that most of the

392
00:18:46,020 --> 00:18:48,200
time they live approximately one month

393
00:18:48,200 --> 00:18:51,480
sometimes two but not really more

394
00:18:51,480 --> 00:18:53,580
the domain names that's something that

395
00:18:53,580 --> 00:18:55,860
really is constantly changing every two

396
00:18:55,860 --> 00:18:58,080
days you've got a new domain name okay

397
00:18:58,080 --> 00:19:01,260
and then the intermediate one the one

398
00:19:01,260 --> 00:19:03,960
which is serving the the domain names

399
00:19:03,960 --> 00:19:07,260
this one really stays out pretty long

400
00:19:07,260 --> 00:19:08,580
actually

401
00:19:08,580 --> 00:19:12,080
um between two and six months

402
00:19:12,900 --> 00:19:15,900
as for the targeted applications this

403
00:19:15,900 --> 00:19:18,960
also is being maintained very much and

404
00:19:18,960 --> 00:19:19,919
it is

405
00:19:19,919 --> 00:19:23,520
um well it's gaining more and more apps

406
00:19:23,520 --> 00:19:26,400
um for instance well since the beginning

407
00:19:26,400 --> 00:19:29,400
of 2022

408
00:19:29,400 --> 00:19:31,500
um well I'm I'm based in France I know

409
00:19:31,500 --> 00:19:34,679
that started targeting French banks in

410
00:19:34,679 --> 00:19:35,640
May

411
00:19:35,640 --> 00:19:38,400
uh only okay

412
00:19:38,400 --> 00:19:39,059
um

413
00:19:39,059 --> 00:19:41,280
there are some new Spanish Banks which

414
00:19:41,280 --> 00:19:44,820
are targeted so we see those in here and

415
00:19:44,820 --> 00:19:46,500
that was just last week

416
00:19:46,500 --> 00:19:48,660
and then for the people who are local

417
00:19:48,660 --> 00:19:50,400
here

418
00:19:50,400 --> 00:19:51,419
um

419
00:19:51,419 --> 00:19:54,360
well you've got also some Czech Banks

420
00:19:54,360 --> 00:19:57,918
which are targeted of course

421
00:19:59,280 --> 00:20:01,559
um the profile of targeted applications

422
00:20:01,559 --> 00:20:05,640
well mostly banking applications 80 so

423
00:20:05,640 --> 00:20:08,520
we have roughly 600 applications which

424
00:20:08,520 --> 00:20:11,940
are targeted 80 of that are banks then

425
00:20:11,940 --> 00:20:15,660
in the 20 remaining percent 10 are still

426
00:20:15,660 --> 00:20:17,660
very much related to Banks it's

427
00:20:17,660 --> 00:20:20,220
cryptocurrency wallets and finance

428
00:20:20,220 --> 00:20:23,340
applications and then the remaining 10

429
00:20:23,340 --> 00:20:25,440
are usually

430
00:20:25,440 --> 00:20:27,419
um mail applications Security

431
00:20:27,419 --> 00:20:29,520
application or a second factor or

432
00:20:29,520 --> 00:20:31,679
authentication applications especially

433
00:20:31,679 --> 00:20:35,539
those which are used by Banks

434
00:20:36,059 --> 00:20:38,460
so yeah key points

435
00:20:38,460 --> 00:20:42,360
um we usually have approximately 20 c2s

436
00:20:42,360 --> 00:20:44,220
which are operational all the time today

437
00:20:44,220 --> 00:20:47,580
it was 22. okay depends

438
00:20:47,580 --> 00:20:49,860
um those c2s are maintained so it's just

439
00:20:49,860 --> 00:20:52,140
not like you know they are up and people

440
00:20:52,140 --> 00:20:54,360
seem to forget about it now we see

441
00:20:54,360 --> 00:20:56,580
changes sometimes even in the campaigns

442
00:20:56,580 --> 00:20:59,280
that they are serving

443
00:20:59,280 --> 00:21:00,840
um because they are targeting different

444
00:21:00,840 --> 00:21:03,960
banks uh probably it means that they are

445
00:21:03,960 --> 00:21:07,620
operated by different threat actors

446
00:21:07,620 --> 00:21:10,679
now we'll dig a little bit more into the

447
00:21:10,679 --> 00:21:12,660
code

448
00:21:12,660 --> 00:21:13,440
um

449
00:21:13,440 --> 00:21:16,620
I've been reversing a lot of

450
00:21:16,620 --> 00:21:19,799
um uh of botnets well Android's um

451
00:21:19,799 --> 00:21:23,880
malware now and um this one is really

452
00:21:23,880 --> 00:21:26,039
special in the way it is coded because

453
00:21:26,039 --> 00:21:28,740
we see very regularly when we look into

454
00:21:28,740 --> 00:21:31,020
malware samples

455
00:21:31,020 --> 00:21:35,280
um high-tech well kind of nice tricks of

456
00:21:35,280 --> 00:21:38,280
how to do this or that in the code this

457
00:21:38,280 --> 00:21:40,620
occurs pretty often and it's interesting

458
00:21:40,620 --> 00:21:42,659
for us as researchers to see how they're

459
00:21:42,659 --> 00:21:46,500
doing it but here it's different we see

460
00:21:46,500 --> 00:21:50,280
that the person who's coding this really

461
00:21:50,280 --> 00:21:52,140
is skilled in terms of developments

462
00:21:52,140 --> 00:21:55,620
knows how to architecture code knows how

463
00:21:55,620 --> 00:21:58,080
to make modules how to

464
00:21:58,080 --> 00:22:00,059
um to make sure that it will be

465
00:22:00,059 --> 00:22:02,340
extendable and things like that for

466
00:22:02,340 --> 00:22:03,299
instance

467
00:22:03,299 --> 00:22:03,900
um

468
00:22:03,900 --> 00:22:07,860
nearly all the code that was out in 2018

469
00:22:07,860 --> 00:22:12,539
is still used now in 2022 and what

470
00:22:12,539 --> 00:22:14,700
they've mainly add what they've mainly

471
00:22:14,700 --> 00:22:16,380
done is

472
00:22:16,380 --> 00:22:18,780
um you've got plugins to add new

473
00:22:18,780 --> 00:22:21,240
features and they did it so well that

474
00:22:21,240 --> 00:22:24,299
they're still using their plugin API to

475
00:22:24,299 --> 00:22:27,419
add a plug-in and do and add to this or

476
00:22:27,419 --> 00:22:28,559
that feature

477
00:22:28,559 --> 00:22:32,539
so this is really well done

478
00:22:32,760 --> 00:22:34,919
um then you'll have more details of

479
00:22:34,919 --> 00:22:38,280
course in in the paper but basically in

480
00:22:38,280 --> 00:22:40,100
terms of implementation

481
00:22:40,100 --> 00:22:43,500
It is Well Implement implemented

482
00:22:43,500 --> 00:22:45,780
uh for instance I don't know uh

483
00:22:45,780 --> 00:22:47,520
sometimes they want to disable play

484
00:22:47,520 --> 00:22:51,059
protect well what they do is they pop up

485
00:22:51,059 --> 00:22:53,340
the window where you can configure that

486
00:22:53,340 --> 00:22:55,860
and then they use the accessibility

487
00:22:55,860 --> 00:22:58,440
service API and they are basically

488
00:22:58,440 --> 00:23:01,559
clicking to disable it automatically

489
00:23:01,559 --> 00:23:04,799
without the user doing it

490
00:23:04,799 --> 00:23:07,080
honestly there's no best way to do that

491
00:23:07,080 --> 00:23:09,080
it's just perfect okay

492
00:23:09,080 --> 00:23:11,340
for now this is the best possible

493
00:23:11,340 --> 00:23:14,520
implementation and if we look at many of

494
00:23:14,520 --> 00:23:16,860
the things they are implementing it is

495
00:23:16,860 --> 00:23:18,960
really well well done

496
00:23:18,960 --> 00:23:20,760
of course there's a little bit room of

497
00:23:20,760 --> 00:23:23,240
improvement for instance the dose mode

498
00:23:23,240 --> 00:23:27,299
about battery optimizations well in

499
00:23:27,299 --> 00:23:29,820
another botnet which is named flu bot

500
00:23:29,820 --> 00:23:31,799
well they are doing it slightly better

501
00:23:31,799 --> 00:23:34,740
so yeah they they have a lot of work to

502
00:23:34,740 --> 00:23:38,640
do yes fortunately

503
00:23:40,679 --> 00:23:44,039
so then uh what I wanted to do is of

504
00:23:44,039 --> 00:23:46,320
course when when you're doing some

505
00:23:46,320 --> 00:23:48,960
research on it you often want to

506
00:23:48,960 --> 00:23:52,140
interact with um with a server but I

507
00:23:52,140 --> 00:23:54,059
don't want to keep on sending data to

508
00:23:54,059 --> 00:23:56,580
the real c2s so I created and

509
00:23:56,580 --> 00:23:58,799
implemented a fake C2

510
00:23:58,799 --> 00:24:01,500
uh and you've got the the code you can

511
00:24:01,500 --> 00:24:03,659
you can grab it and use it if you wish

512
00:24:03,659 --> 00:24:06,659
it's customers you can customize it or

513
00:24:06,659 --> 00:24:08,280
to to do what you want and I'm going to

514
00:24:08,280 --> 00:24:12,480
show you again uh how this is working

515
00:24:12,480 --> 00:24:14,600
um

516
00:24:16,200 --> 00:24:18,000
so yeah on the

517
00:24:18,000 --> 00:24:23,100
left hand side you've got the fake uh C2

518
00:24:23,100 --> 00:24:25,919
it's a flask application and on the the

519
00:24:25,919 --> 00:24:28,140
other side you've got my emulator which

520
00:24:28,140 --> 00:24:31,260
is infected with Pyongyang and as soon

521
00:24:31,260 --> 00:24:33,120
as you start the application well you

522
00:24:33,120 --> 00:24:35,880
see communication coming in to your fake

523
00:24:35,880 --> 00:24:38,460
CQ and as it's fake well you can print

524
00:24:38,460 --> 00:24:40,080
out everything which is happening and

525
00:24:40,080 --> 00:24:41,880
see what are the messages so this is

526
00:24:41,880 --> 00:24:44,700
really good then I tell it okay now

527
00:24:44,700 --> 00:24:47,159
you're going to monitor this or that

528
00:24:47,159 --> 00:24:48,059
bank

529
00:24:48,059 --> 00:24:49,440
and

530
00:24:49,440 --> 00:24:51,600
um this is what it does and I'm gonna

531
00:24:51,600 --> 00:24:54,659
speed a little bit so and we don't waste

532
00:24:54,659 --> 00:24:58,260
too much time I'm gonna ask my server

533
00:24:58,260 --> 00:25:01,620
to send screenshots

534
00:25:01,620 --> 00:25:04,740
all the time so it will take swing see

535
00:25:04,740 --> 00:25:07,620
sorry screenshots of

536
00:25:07,620 --> 00:25:10,860
um the Android emulator every second and

537
00:25:10,860 --> 00:25:13,320
send that back to the C2 and that's what

538
00:25:13,320 --> 00:25:15,120
it's doing we see the images which are

539
00:25:15,120 --> 00:25:16,980
piling up

540
00:25:16,980 --> 00:25:20,820
um on the fake service side and then we

541
00:25:20,820 --> 00:25:22,860
can even have a look at

542
00:25:22,860 --> 00:25:25,740
uh it's a little bit later yeah over

543
00:25:25,740 --> 00:25:28,980
here so here this is the emulator and

544
00:25:28,980 --> 00:25:31,500
this is the images that we got on the

545
00:25:31,500 --> 00:25:33,600
fake server side and you can see I'm

546
00:25:33,600 --> 00:25:36,799
scanning through all the images

547
00:25:38,820 --> 00:25:42,059
you can even see uh the different um the

548
00:25:42,059 --> 00:25:45,419
letters that's the the user is entering

549
00:25:45,419 --> 00:25:47,640
on on the mobile phone so that's another

550
00:25:47,640 --> 00:25:51,059
way to grab credentials of course

551
00:25:51,059 --> 00:25:53,940
okay so this is just helpful for malware

552
00:25:53,940 --> 00:25:56,340
analysts to understand how the features

553
00:25:56,340 --> 00:25:59,418
are are working

554
00:25:59,940 --> 00:26:02,520
and

555
00:26:02,520 --> 00:26:04,679
speed up

556
00:26:04,679 --> 00:26:06,179
um

557
00:26:06,179 --> 00:26:08,400
there are a few surprises and one of the

558
00:26:08,400 --> 00:26:11,400
surprises there is that we'd expect for

559
00:26:11,400 --> 00:26:13,320
instance the packing of the malware to

560
00:26:13,320 --> 00:26:15,179
be more and more difficult so it would

561
00:26:15,179 --> 00:26:16,500
be like you know

562
00:26:16,500 --> 00:26:20,039
line going steadily up that way and it's

563
00:26:20,039 --> 00:26:21,440
not the case

564
00:26:21,440 --> 00:26:25,320
uh quite strangely the first few samples

565
00:26:25,320 --> 00:26:29,100
of 2018 and 2019 were far more difficult

566
00:26:29,100 --> 00:26:31,559
to unpack than what we have now

567
00:26:31,559 --> 00:26:33,360
same thing that we noticed for the

568
00:26:33,360 --> 00:26:35,580
obfuscation

569
00:26:35,580 --> 00:26:37,080
other thing which is a little bit

570
00:26:37,080 --> 00:26:39,480
strange is that I told you that there's

571
00:26:39,480 --> 00:26:42,419
an intermediate website well uh that's

572
00:26:42,419 --> 00:26:44,760
actually most of the time a private

573
00:26:44,760 --> 00:26:46,380
guest URL

574
00:26:46,380 --> 00:26:48,960
and it's serving uh so the domain name

575
00:26:48,960 --> 00:26:51,840
for the the C2 and then suddenly in

576
00:26:51,840 --> 00:26:54,120
September 2021

577
00:26:54,120 --> 00:26:56,640
um it's uh we had the first sample where

578
00:26:56,640 --> 00:26:58,559
it was actually serving well the

579
00:26:58,559 --> 00:27:02,220
intermediate website was an onion URL

580
00:27:02,220 --> 00:27:04,440
so I thought oh well okay uh this is

581
00:27:04,440 --> 00:27:07,020
something new interesting uh probably

582
00:27:07,020 --> 00:27:08,880
they're gonna use that

583
00:27:08,880 --> 00:27:12,900
um now now on for the rest of um uh what

584
00:27:12,900 --> 00:27:15,299
is going on the new samples well not at

585
00:27:15,299 --> 00:27:18,179
all they kept on you know most of the

586
00:27:18,179 --> 00:27:20,760
time using both techniques the old one

587
00:27:20,760 --> 00:27:23,460
and sometimes uh the the new one the

588
00:27:23,460 --> 00:27:25,380
onion URL

589
00:27:25,380 --> 00:27:28,679
um although probably the the the new one

590
00:27:28,679 --> 00:27:31,559
was probably more difficult to catch I

591
00:27:31,559 --> 00:27:33,059
don't know exactly why

592
00:27:33,059 --> 00:27:35,159
and even worse than that

593
00:27:35,159 --> 00:27:38,760
last week I grabbed a sample and this

594
00:27:38,760 --> 00:27:42,360
one was doing a direct reference to the

595
00:27:42,360 --> 00:27:45,779
C2 so they were losing all the benefit

596
00:27:45,779 --> 00:27:48,000
of using an intermediate website and

597
00:27:48,000 --> 00:27:50,159
they decided okay we'll just directly

598
00:27:50,159 --> 00:27:52,320
reference to the C2 so whenever the C2

599
00:27:52,320 --> 00:27:54,179
is down where their malware is no longer

600
00:27:54,179 --> 00:27:57,059
working okay that's a decision which is

601
00:27:57,059 --> 00:27:59,159
uh from my point of view very strange

602
00:27:59,159 --> 00:28:02,000
okay

603
00:28:02,159 --> 00:28:04,620
um probably their reason for doing this

604
00:28:04,620 --> 00:28:06,720
is that it looks like you know the

605
00:28:06,720 --> 00:28:08,640
malware author is not really after

606
00:28:08,640 --> 00:28:11,640
things which are high tech all the time

607
00:28:11,640 --> 00:28:15,419
but wants to use only simple things that

608
00:28:15,419 --> 00:28:16,200
are

609
00:28:16,200 --> 00:28:19,320
proves to run and to work well

610
00:28:19,320 --> 00:28:22,140
and maybe this is the key to why it is

611
00:28:22,140 --> 00:28:24,360
resilient and why it has been out since

612
00:28:24,360 --> 00:28:28,919
2018 actually okay so maybe that's um

613
00:28:28,919 --> 00:28:30,659
something interesting for us to keep in

614
00:28:30,659 --> 00:28:32,840
mind

615
00:28:33,059 --> 00:28:35,880
now one of the last slides there of

616
00:28:35,880 --> 00:28:37,679
course uh is something that I'd love to

617
00:28:37,679 --> 00:28:39,960
discuss with some of you offline

618
00:28:39,960 --> 00:28:42,360
afterwards is if you have ideas how to

619
00:28:42,360 --> 00:28:46,020
stop this because it's pretty difficult

620
00:28:46,020 --> 00:28:49,380
um we can't sinkhole the c2s or I

621
00:28:49,380 --> 00:28:52,140
haven't found any ideas how to do that

622
00:28:52,140 --> 00:28:55,159
uh of course they are located everywhere

623
00:28:55,159 --> 00:29:00,240
worldwide so well by the time I ask one

624
00:29:00,240 --> 00:29:02,340
of the isps oh you know you were hosting

625
00:29:02,340 --> 00:29:04,919
a malware and if I'm lucky I get an

626
00:29:04,919 --> 00:29:07,799
answer of course they have moved off to

627
00:29:07,799 --> 00:29:10,200
another location long time ago

628
00:29:10,200 --> 00:29:11,400
so

629
00:29:11,400 --> 00:29:12,600
um this is kind of a little bit

630
00:29:12,600 --> 00:29:15,120
difficult we are asking as much as

631
00:29:15,120 --> 00:29:18,179
possible Banks to file complaints

632
00:29:18,179 --> 00:29:20,580
because if we have lots of complaints

633
00:29:20,580 --> 00:29:22,500
then we will have local authorities

634
00:29:22,500 --> 00:29:24,240
which will

635
00:29:24,240 --> 00:29:27,120
um you know get interested into that and

636
00:29:27,120 --> 00:29:29,220
want to do something and to to stop

637
00:29:29,220 --> 00:29:32,159
things but we've got to stop at botnet

638
00:29:32,159 --> 00:29:33,840
which has been working for four years I

639
00:29:33,840 --> 00:29:35,700
mean we can't just leave it out like

640
00:29:35,700 --> 00:29:37,260
that

641
00:29:37,260 --> 00:29:38,880
okay

642
00:29:38,880 --> 00:29:41,460
and that's about it I would just like to

643
00:29:41,460 --> 00:29:44,279
thank um two colleagues of mine who met

644
00:29:44,279 --> 00:29:46,679
Mali and Amir lakani who helped me very

645
00:29:46,679 --> 00:29:50,340
much to conduct This research and thank

646
00:29:50,340 --> 00:29:53,820
you for your attention I don't know if

647
00:29:53,820 --> 00:29:56,360
we've got time

648
00:29:59,460 --> 00:30:01,380
so so I think we have a couple of

649
00:30:01,380 --> 00:30:04,440
minutes for Q a does anybody have a

650
00:30:04,440 --> 00:30:06,620
question

651
00:30:07,140 --> 00:30:09,120
there's one kind of in the middle back

652
00:30:09,120 --> 00:30:12,380
wait for the microphone please

653
00:30:12,380 --> 00:30:17,220
hello I was wondering if um mobile anti

654
00:30:17,220 --> 00:30:20,159
antivirus applications can detect this

655
00:30:20,159 --> 00:30:22,260
kind of overlay attacks and my second

656
00:30:22,260 --> 00:30:25,020
question uh if I may what uh what can

657
00:30:25,020 --> 00:30:28,740
people do to to uh defend themselves

658
00:30:28,740 --> 00:30:32,820
against this kind of uh attack

659
00:30:32,820 --> 00:30:35,100
okay so for the the first part of the

660
00:30:35,100 --> 00:30:37,620
question is it detect if I understood

661
00:30:37,620 --> 00:30:40,740
well is it detected and caught by mobile

662
00:30:40,740 --> 00:30:43,860
antivirus says yes it is

663
00:30:43,860 --> 00:30:45,779
um it is detected all the all the

664
00:30:45,779 --> 00:30:47,940
samples are detected pretty easily well

665
00:30:47,940 --> 00:30:50,340
by Fortunate but but I owe all the other

666
00:30:50,340 --> 00:30:53,580
vendors actually because we have the

667
00:30:53,580 --> 00:30:57,120
samples okay that's not that much the

668
00:30:57,120 --> 00:31:00,480
issue the issue is rather that we'd like

669
00:31:00,480 --> 00:31:03,120
to no longer have any samples and to

670
00:31:03,120 --> 00:31:06,120
stop it all together right but from a

671
00:31:06,120 --> 00:31:07,860
detection point of view this is working

672
00:31:07,860 --> 00:31:10,679
well we we have all the elements to um

673
00:31:10,679 --> 00:31:15,000
to detect new samples really quickly

674
00:31:15,000 --> 00:31:17,340
um then I forgot the second part of the

675
00:31:17,340 --> 00:31:19,580
question

676
00:31:20,220 --> 00:31:23,399
oh yeah for the the end users

677
00:31:23,399 --> 00:31:24,120
um

678
00:31:24,120 --> 00:31:27,419
well for the end users um I think it

679
00:31:27,419 --> 00:31:29,820
will be a generic answer

680
00:31:29,820 --> 00:31:31,860
um as you saw at the beginning in the

681
00:31:31,860 --> 00:31:34,080
first video when

682
00:31:34,080 --> 00:31:36,380
um they are asked to activate

683
00:31:36,380 --> 00:31:40,260
accessibility Services well we need uh

684
00:31:40,260 --> 00:31:43,020
obviously to educate them on this and to

685
00:31:43,020 --> 00:31:45,360
explain that this is for people with

686
00:31:45,360 --> 00:31:47,640
disabilities if

687
00:31:47,640 --> 00:31:50,340
um uh that they're going to enable it

688
00:31:50,340 --> 00:31:52,919
when this is the case but not for a

689
00:31:52,919 --> 00:31:55,679
video player not for a flash player not

690
00:31:55,679 --> 00:31:59,279
for I don't know a fake uh Google Play

691
00:31:59,279 --> 00:32:00,840
application

692
00:32:00,840 --> 00:32:03,840
I think that will be the key to solving

693
00:32:03,840 --> 00:32:06,299
Ghanaian and many other cases because

694
00:32:06,299 --> 00:32:09,120
all the the malware that we see recently

695
00:32:09,120 --> 00:32:11,700
are nearly for Android are using this um

696
00:32:11,700 --> 00:32:13,279
this feature

697
00:32:13,279 --> 00:32:15,720
you're welcome

698
00:32:15,720 --> 00:32:18,480
um any other questions there's one over

699
00:32:18,480 --> 00:32:21,799
there wait for the mic

700
00:32:23,220 --> 00:32:26,159
for for the C2 servers uh is that

701
00:32:26,159 --> 00:32:28,200
through reversing the malware is that

702
00:32:28,200 --> 00:32:30,360
how we found them or are you just

703
00:32:30,360 --> 00:32:32,460
scanning for C2 servers on the Internet

704
00:32:32,460 --> 00:32:34,559
or how does that work

705
00:32:34,559 --> 00:32:36,659
um foreign

706
00:32:36,659 --> 00:32:39,600
okay so uh well

707
00:32:39,600 --> 00:32:41,279
I'll go back

708
00:32:41,279 --> 00:32:46,320
to this slide this one okay

709
00:32:46,320 --> 00:32:49,020
um when we reverse the sample

710
00:32:49,020 --> 00:32:52,140
we get this URL

711
00:32:52,140 --> 00:32:54,360
okay inside the code

712
00:32:54,360 --> 00:32:57,960
so this one then we can just do a w get

713
00:32:57,960 --> 00:33:01,380
or well we can just um uh ping it well

714
00:33:01,380 --> 00:33:05,720
not ping it uh call this URL and we get

715
00:33:05,720 --> 00:33:09,299
this response which is actually space 64

716
00:33:09,299 --> 00:33:12,059
encoded but base64 decoding is really

717
00:33:12,059 --> 00:33:14,820
not difficult you decode that and you

718
00:33:14,820 --> 00:33:17,760
get this one this URL and then you see

719
00:33:17,760 --> 00:33:20,519
that it rolls to an IP address so that's

720
00:33:20,519 --> 00:33:25,679
one way to get the IP addresses there

721
00:33:25,679 --> 00:33:29,279
then you proactively get all the IP

722
00:33:29,279 --> 00:33:33,059
addresses in my script uh where was that

723
00:33:33,059 --> 00:33:36,840
here it's a little bit different we've

724
00:33:36,840 --> 00:33:40,320
noticed a few particular things on the

725
00:33:40,320 --> 00:33:43,620
C2 panels I'd rather not say allowed

726
00:33:43,620 --> 00:33:47,840
what now okay but we can speak about it

727
00:33:47,840 --> 00:33:52,200
which help us notice uh if this is

728
00:33:52,200 --> 00:33:55,200
really very likely to be a C2 of yanyan

729
00:33:55,200 --> 00:33:56,340
or not

730
00:33:56,340 --> 00:33:58,559
and so we do a search on that on

731
00:33:58,559 --> 00:34:01,380
Showdown to to be honest and gives us a

732
00:34:01,380 --> 00:34:03,779
number of IP addresses and then we test

733
00:34:03,779 --> 00:34:06,840
I send a specific message to that host

734
00:34:06,840 --> 00:34:09,899
to see if it's still responding and if

735
00:34:09,899 --> 00:34:12,899
it understands uh yanyan's communication

736
00:34:12,899 --> 00:34:15,319
protocol

737
00:34:15,960 --> 00:34:19,440
does that answer your question yeah

738
00:34:19,440 --> 00:34:22,580
yeah any further questions

739
00:34:22,940 --> 00:34:26,480
there's one over there

740
00:34:29,820 --> 00:34:33,119
did you notice any departure in the

741
00:34:33,119 --> 00:34:36,599
group especially the group that has a

742
00:34:36,599 --> 00:34:40,080
high number of targets because the

743
00:34:40,080 --> 00:34:42,719
groups are well in the samples that I

744
00:34:42,719 --> 00:34:46,260
unpacked the groups that we're targeting

745
00:34:46,260 --> 00:34:49,199
turkey for example they had very

746
00:34:49,199 --> 00:34:52,139
specific web views for it

747
00:34:52,139 --> 00:34:54,119
but for example the ones that are

748
00:34:54,119 --> 00:34:56,699
targeting

749
00:34:56,699 --> 00:34:57,599
um

750
00:34:57,599 --> 00:35:01,020
a large list of banks they sometimes

751
00:35:01,020 --> 00:35:03,420
don't have web views for the countries

752
00:35:03,420 --> 00:35:04,920
they are targeting

753
00:35:04,920 --> 00:35:08,220
so did you notice any pattern on how on

754
00:35:08,220 --> 00:35:10,020
who they are really

755
00:35:10,020 --> 00:35:13,020
targeting these These are specific

756
00:35:13,020 --> 00:35:14,220
groups

757
00:35:14,220 --> 00:35:18,119
um so um for the one which are targeting

758
00:35:18,119 --> 00:35:19,920
like really number of numerous

759
00:35:19,920 --> 00:35:23,339
applications like over 300

760
00:35:23,339 --> 00:35:26,220
um I've I've put the the countries but

761
00:35:26,220 --> 00:35:30,240
no it seems like it's just large uh my

762
00:35:30,240 --> 00:35:32,099
opinions is that probably on the C2

763
00:35:32,099 --> 00:35:34,920
panel you know it very often happens in

764
00:35:34,920 --> 00:35:37,079
other botnets you've got kind of a list

765
00:35:37,079 --> 00:35:39,900
of uh application that you can Target

766
00:35:39,900 --> 00:35:43,320
and the um the Affiliates just clicked

767
00:35:43,320 --> 00:35:46,200
like everything they found in this or

768
00:35:46,200 --> 00:35:50,400
that region okay but I couldn't make any

769
00:35:50,400 --> 00:35:53,760
specificity out of that either from like

770
00:35:53,760 --> 00:35:56,700
you know their perspective of the domain

771
00:35:56,700 --> 00:35:59,579
in where because it's always Banks uh

772
00:35:59,579 --> 00:36:02,579
that's about it but indeed uh in The

773
00:36:02,579 --> 00:36:05,040
Limited ones then those for instance

774
00:36:05,040 --> 00:36:07,980
this one is only targeting Austria and

775
00:36:07,980 --> 00:36:10,680
Germany and no other other country you

776
00:36:10,680 --> 00:36:13,859
know other uh other Banks

777
00:36:13,859 --> 00:36:14,880
um

778
00:36:14,880 --> 00:36:17,339
uh in this

779
00:36:17,339 --> 00:36:17,350
um

780
00:36:17,350 --> 00:36:19,079
[Music]

781
00:36:19,079 --> 00:36:21,480
I can't see it any longer now I guess it

782
00:36:21,480 --> 00:36:23,220
is this one

783
00:36:23,220 --> 00:36:25,800
um this one is targeting Spain Colombia

784
00:36:25,800 --> 00:36:28,680
and Germany but if I remember well it's

785
00:36:28,680 --> 00:36:30,440
mostly Spain

786
00:36:30,440 --> 00:36:33,420
and I don't know if it's an error that

787
00:36:33,420 --> 00:36:35,940
they are targeting a few or other Banks

788
00:36:35,940 --> 00:36:39,359
or uh in there but it looks like I don't

789
00:36:39,359 --> 00:36:42,599
know 30 Spanish Banks and the rest there

790
00:36:42,599 --> 00:36:46,020
and that's about it the the ones with um

791
00:36:46,020 --> 00:36:49,320
Turkish banks are usually from older

792
00:36:49,320 --> 00:36:52,320
samples that we saw and indeed it's very

793
00:36:52,320 --> 00:36:57,500
specific uh targeting a few countries

794
00:36:57,900 --> 00:37:00,240
I think we've pretty much come up to our

795
00:37:00,240 --> 00:37:01,680
time at this point unless there's some

796
00:37:01,680 --> 00:37:03,000
really really desperate question there

797
00:37:03,000 --> 00:37:04,079
somewhere

798
00:37:04,079 --> 00:37:07,980
sir no okay then let's start anyway yeah

799
00:37:07,980 --> 00:37:10,079
yeah exactly uh let's thank Excel for

800
00:37:10,079 --> 00:37:11,440
this amazing presentation

801
00:37:11,440 --> 00:37:18,449
[Applause]

