1
00:00:03,600 --> 00:00:05,700
thank you Samir uh good morning everyone

2
00:00:05,700 --> 00:00:09,000
I'm Sandara damov I am founder of

3
00:00:09,000 --> 00:00:10,559
research laboratory called Niagara

4
00:00:10,559 --> 00:00:13,320
security lab where I and my students do

5
00:00:13,320 --> 00:00:15,360
malware research and I'm also teach

6
00:00:15,360 --> 00:00:17,760
cyber security in the universities in

7
00:00:17,760 --> 00:00:22,260
Ukraine and Sweden uh not so long ago I

8
00:00:22,260 --> 00:00:26,519
talked about not pizza at VB 2017 in

9
00:00:26,519 --> 00:00:29,699
Madrid and the destructive wiper not

10
00:00:29,699 --> 00:00:31,619
Pitch that was delivered through meddoc

11
00:00:31,619 --> 00:00:34,440
as a result of using supply chain attack

12
00:00:34,440 --> 00:00:35,460
through

13
00:00:35,460 --> 00:00:39,360
this tax accounting software uh same uh

14
00:00:39,360 --> 00:00:40,920
conference

15
00:00:40,920 --> 00:00:43,020
at the same time the researchers from

16
00:00:43,020 --> 00:00:46,379
asset Anton chirpana and Robert lipowsky

17
00:00:46,379 --> 00:00:49,500
they delivered a talk about industrial

18
00:00:49,500 --> 00:00:53,640
this is a another uh threat the

19
00:00:53,640 --> 00:00:55,379
structure threat industrial malware that

20
00:00:55,379 --> 00:00:58,559
we used to attempt to take down uh

21
00:00:58,559 --> 00:01:02,160
electricity in Ukraine

22
00:01:02,160 --> 00:01:06,600
this attack happened in December 2016.

23
00:01:06,600 --> 00:01:09,119
so uh both attacks were attributed to

24
00:01:09,119 --> 00:01:12,600
send one group this group according to

25
00:01:12,600 --> 00:01:16,860
like foreign us and UK and other

26
00:01:16,860 --> 00:01:21,080
researchers uh belong to jru unit uh

27
00:01:21,080 --> 00:01:25,439
74455 uh which is uh as you can see uh

28
00:01:25,439 --> 00:01:29,159
subordinated to uh jru this is a

29
00:01:29,159 --> 00:01:31,560
military intelligence and this group was

30
00:01:31,560 --> 00:01:35,040
responsible also for a chain of

31
00:01:35,040 --> 00:01:37,259
destructive attacks starting with black

32
00:01:37,259 --> 00:01:40,619
energy in December 2015 that caused

33
00:01:40,619 --> 00:01:42,060
blackout in the western part of the

34
00:01:42,060 --> 00:01:45,299
Ukraine uh industrial not pH Olympic

35
00:01:45,299 --> 00:01:47,579
destroyer and many others

36
00:01:47,579 --> 00:01:52,140
so this year I put the wipers and

37
00:01:52,140 --> 00:01:53,759
Industrial malware attacks on the

38
00:01:53,759 --> 00:01:55,920
timeline and as you can see the first

39
00:01:55,920 --> 00:01:59,280
attack happened uh at night from 13 to

40
00:01:59,280 --> 00:02:01,399
14th January

41
00:02:01,399 --> 00:02:04,920
2022 as you can see uh this is the time

42
00:02:04,920 --> 00:02:07,740
uh before The all-out Invasion started

43
00:02:07,740 --> 00:02:10,380
in Ukraine

44
00:02:10,380 --> 00:02:13,020
and uh whisper gained a whisper gate

45
00:02:13,020 --> 00:02:15,720
campaign and other hacks they were

46
00:02:15,720 --> 00:02:19,500
implemented in three uh mainstreams

47
00:02:19,500 --> 00:02:22,140
uh the first stream was the face you can

48
00:02:22,140 --> 00:02:24,180
see uh the picture

49
00:02:24,180 --> 00:02:26,580
that was published on the Hacked

50
00:02:26,580 --> 00:02:28,620
Government website it was like more than

51
00:02:28,620 --> 00:02:31,140
70 government uh and Ministry websites

52
00:02:31,140 --> 00:02:34,920
hacked uh that night and uh it tells

53
00:02:34,920 --> 00:02:37,800
like we are polish hackers I don't know

54
00:02:37,800 --> 00:02:40,800
why why polish but they say okay we uh

55
00:02:40,800 --> 00:02:42,720
hacked you our website and we stole your

56
00:02:42,720 --> 00:02:45,060
data and we're going to publish it on

57
00:02:45,060 --> 00:02:45,959
the internet

58
00:02:45,959 --> 00:02:49,080
uh second stream is data exfiltration so

59
00:02:49,080 --> 00:02:51,360
it was attempt to still

60
00:02:51,360 --> 00:02:53,700
data from government registers in

61
00:02:53,700 --> 00:02:56,459
particular driving licenses and also

62
00:02:56,459 --> 00:02:58,080
information from the idea is our

63
00:02:58,080 --> 00:03:01,560
Ukrainian government in smartphone so we

64
00:03:01,560 --> 00:03:03,959
have like this electronic ID in

65
00:03:03,959 --> 00:03:07,080
smartphone uh well uh Ukrainian

66
00:03:07,080 --> 00:03:09,900
officials uh do not confirmed this

67
00:03:09,900 --> 00:03:12,480
league however uh some data were

68
00:03:12,480 --> 00:03:15,000
published and uh like they have to

69
00:03:15,000 --> 00:03:17,940
discussed if they are real or not

70
00:03:17,940 --> 00:03:21,720
uh then a stream number two three is

71
00:03:21,720 --> 00:03:25,019
actually destructive Viper so as you can

72
00:03:25,019 --> 00:03:28,980
see uh the Viper were executed in two

73
00:03:28,980 --> 00:03:31,800
branches so here we have a stage one and

74
00:03:31,800 --> 00:03:35,640
stage two stage one uh targets MBR and

75
00:03:35,640 --> 00:03:39,180
put the 16-bit vibers code into MBR

76
00:03:39,180 --> 00:03:42,720
uh in order to wipe the disk space uh

77
00:03:42,720 --> 00:03:45,480
physical sectors on the on the disk the

78
00:03:45,480 --> 00:03:48,780
tricky part with why why targets MBR

79
00:03:48,780 --> 00:03:51,780
because uh as you know since Windows

80
00:03:51,780 --> 00:03:54,000
Server 20

81
00:03:54,000 --> 00:03:57,720
08 and Windows Vista it is not allowed

82
00:03:57,720 --> 00:04:00,840
to just write data in arbitrary physical

83
00:04:00,840 --> 00:04:02,940
sectors on the drive to speak in direct

84
00:04:02,940 --> 00:04:06,060
access it's possible only only if you

85
00:04:06,060 --> 00:04:09,180
write to boot sectors which are like for

86
00:04:09,180 --> 00:04:11,939
example if you have ntps entry fares

87
00:04:11,939 --> 00:04:13,620
formatted volumes then it's going to be

88
00:04:13,620 --> 00:04:17,279
first 16 sectors which is around four

89
00:04:17,279 --> 00:04:19,560
kilobytes which which is exactly four

90
00:04:19,560 --> 00:04:21,720
kilobytes and the first sector is a

91
00:04:21,720 --> 00:04:24,840
bootstrapping code uh but if you write

92
00:04:24,840 --> 00:04:27,900
this code uh if you wipe MBR

93
00:04:27,900 --> 00:04:31,440
then it will be merely easily to restore

94
00:04:31,440 --> 00:04:33,479
the server just you need to use like a

95
00:04:33,479 --> 00:04:36,060
recovery disk Live CD and restore MBR

96
00:04:36,060 --> 00:04:40,080
and bootloader uh however if you put the

97
00:04:40,080 --> 00:04:42,960
wiper that will be executed after reboot

98
00:04:42,960 --> 00:04:45,300
then the Viber will get access to like

99
00:04:45,300 --> 00:04:48,060
the whole uh partition and will be able

100
00:04:48,060 --> 00:04:52,020
to wipe the data Second Street stream is

101
00:04:52,020 --> 00:04:55,440
stage two uh it starts with Trojan

102
00:04:55,440 --> 00:04:58,380
downloader and torsion downloader

103
00:04:58,380 --> 00:05:01,520
downloads another.net dll from Discord

104
00:05:01,520 --> 00:05:04,860
CDN service so it was stored there as

105
00:05:04,860 --> 00:05:06,960
attachment and finally end up after

106
00:05:06,960 --> 00:05:10,139
several steps end up with running file

107
00:05:10,139 --> 00:05:12,540
Viper

108
00:05:12,540 --> 00:05:14,460
um so this is a distraction capabilities

109
00:05:14,460 --> 00:05:18,120
uh if we talk about a 60-bit MBR Viper

110
00:05:18,120 --> 00:05:21,479
it writes every 199 sector of physical

111
00:05:21,479 --> 00:05:25,020
disk uh and the files were written with

112
00:05:25,020 --> 00:05:27,259
uh like

113
00:05:27,259 --> 00:05:32,180
around one megabyte of CC bytes

114
00:05:32,340 --> 00:05:35,340
so uh downloading malware from a Discord

115
00:05:35,340 --> 00:05:37,800
and CDN attachment and I asked okay how

116
00:05:37,800 --> 00:05:39,960
it's possible because Discord has

117
00:05:39,960 --> 00:05:41,759
antivirus protection implemented like

118
00:05:41,759 --> 00:05:43,620
any other file sharing services like

119
00:05:43,620 --> 00:05:46,380
Google Drive Dropbox because this attack

120
00:05:46,380 --> 00:05:48,900
happened before like a long time before

121
00:05:48,900 --> 00:05:50,220
and

122
00:05:50,220 --> 00:05:52,979
I wanted okay how how did they manage to

123
00:05:52,979 --> 00:05:55,320
store our malware on Discord as

124
00:05:55,320 --> 00:05:56,820
attachment and then use it in this

125
00:05:56,820 --> 00:05:57,600
attack

126
00:05:57,600 --> 00:06:00,419
uh as you can see there is a link

127
00:06:00,419 --> 00:06:02,699
by the way it was not obfuscated and it

128
00:06:02,699 --> 00:06:06,000
can be easily found in the compiled.net

129
00:06:06,000 --> 00:06:07,440
application and there is a method but

130
00:06:07,440 --> 00:06:09,660
the name of the method it was uh

131
00:06:09,660 --> 00:06:12,060
obfuscated as you can see X letters

132
00:06:12,060 --> 00:06:15,320
added to the name of the method

133
00:06:16,259 --> 00:06:19,020
so

134
00:06:19,020 --> 00:06:22,800
I just added here a fragment of my

135
00:06:22,800 --> 00:06:25,020
lecture

136
00:06:25,020 --> 00:06:28,740
where I show so how they did manage to

137
00:06:28,740 --> 00:06:31,080
store the malware on Discord the file

138
00:06:31,080 --> 00:06:35,039
was called tbop BH GPX so it pretends to

139
00:06:35,039 --> 00:06:36,539
be like a picture

140
00:06:36,539 --> 00:06:39,600
but if you for example open this um

141
00:06:39,600 --> 00:06:42,780
file in HEX editor you can see that it

142
00:06:42,780 --> 00:06:44,940
starts from with zeros which is yeah

143
00:06:44,940 --> 00:06:47,460
quite weird usually you see like magic

144
00:06:47,460 --> 00:06:49,860
bytes which helps you identify the file

145
00:06:49,860 --> 00:06:53,220
but if you slide down

146
00:06:53,220 --> 00:06:56,880
um to file the content you will see that

147
00:06:56,880 --> 00:07:00,180
at the variant is reversed P header so

148
00:07:00,180 --> 00:07:02,400
they did just very simple trick they

149
00:07:02,400 --> 00:07:04,500
just reverse the order of the bytes in

150
00:07:04,500 --> 00:07:06,600
the file and just put it on the Discord

151
00:07:06,600 --> 00:07:08,940
and it was not detected as a malware

152
00:07:08,940 --> 00:07:11,520
I don't know if it's if it's efficient

153
00:07:11,520 --> 00:07:13,680
just reverse the byte so I believe it

154
00:07:13,680 --> 00:07:15,479
depends on the signature what kind of

155
00:07:15,479 --> 00:07:17,819
signature is used by the protective

156
00:07:17,819 --> 00:07:20,280
solution but that's that's how they they

157
00:07:20,280 --> 00:07:22,259
did it

158
00:07:22,259 --> 00:07:24,360
and

159
00:07:24,360 --> 00:07:28,139
then uh there is a another question okay

160
00:07:28,139 --> 00:07:30,539
why why reversing buys why why not

161
00:07:30,539 --> 00:07:33,479
soaring for example or uh sloping the

162
00:07:33,479 --> 00:07:35,340
buyer just using display with little

163
00:07:35,340 --> 00:07:37,500
engine big engine

164
00:07:37,500 --> 00:07:40,440
um the trick is when you load reverse

165
00:07:40,440 --> 00:07:44,180
bytes into the memory in.net application

166
00:07:44,180 --> 00:07:47,400
uh you can store uh represented as an

167
00:07:47,400 --> 00:07:49,860
array and then you can apply modifier

168
00:07:49,860 --> 00:07:51,060
reverse

169
00:07:51,060 --> 00:07:54,599
which means you can uh the data in this

170
00:07:54,599 --> 00:07:57,780
array will be read from Back to Front

171
00:07:57,780 --> 00:08:00,479
without changing the order bytes uh

172
00:08:00,479 --> 00:08:02,639
actually in the memory so you don't need

173
00:08:02,639 --> 00:08:04,099
to waste time

174
00:08:04,099 --> 00:08:06,479
reordering bytes they just apply

175
00:08:06,479 --> 00:08:08,819
modifier

176
00:08:08,819 --> 00:08:11,660
for the array

177
00:08:18,560 --> 00:08:20,099
then

178
00:08:20,099 --> 00:08:22,919
um it also use wireless execution so

179
00:08:22,919 --> 00:08:26,819
when this GPI file is downloaded and uh

180
00:08:26,819 --> 00:08:30,360
dropped uh uh it's it's not dropped to

181
00:08:30,360 --> 00:08:32,700
the disk but it's just stored in the

182
00:08:32,700 --> 00:08:36,140
memory in Array and then the First

183
00:08:36,140 --> 00:08:39,000
Resource section so this one

184
00:08:39,000 --> 00:08:43,020
contains encoded another.net dll and

185
00:08:43,020 --> 00:08:46,080
it's run using uh The entity.net Entity

186
00:08:46,080 --> 00:08:48,920
called runtime assembly that allows

187
00:08:48,920 --> 00:08:51,420
executing.net dlls uh in the memory

188
00:08:51,420 --> 00:08:53,399
without storing them on disk

189
00:08:53,399 --> 00:08:56,100
another trick that if you have this dll

190
00:08:56,100 --> 00:09:00,240
you cannot execute it because there is

191
00:09:00,240 --> 00:09:02,820
no export the method which is called it

192
00:09:02,820 --> 00:09:06,720
doesn't exist in export address table

193
00:09:06,720 --> 00:09:09,000
which means the only way to start it you

194
00:09:09,000 --> 00:09:11,100
need to use the same the same Q chain

195
00:09:11,100 --> 00:09:13,560
and that's why for example I applied I

196
00:09:13,560 --> 00:09:16,080
used a fake net and G to simulate to

197
00:09:16,080 --> 00:09:18,680
create fake Discord server and download

198
00:09:18,680 --> 00:09:20,940
this.net Library

199
00:09:20,940 --> 00:09:22,380
to the file

200
00:09:22,380 --> 00:09:25,740
then uh using MBR again just some

201
00:09:25,740 --> 00:09:27,540
fragment

202
00:09:27,540 --> 00:09:29,820
of the lecture

203
00:09:29,820 --> 00:09:33,060
showing uh debugging the MBR code so MBR

204
00:09:33,060 --> 00:09:36,060
code is 16 bit as you can see it's shown

205
00:09:36,060 --> 00:09:40,980
in the item uh I use virtualbox and I

206
00:09:40,980 --> 00:09:44,519
use virtualbox the debugger to uh debug

207
00:09:44,519 --> 00:09:47,120
this MBR and currently what you see is

208
00:09:47,120 --> 00:09:49,380
debugging the first function there are

209
00:09:49,380 --> 00:09:51,360
two function at all the first function

210
00:09:51,360 --> 00:09:53,760
prints The Ransom node message to

211
00:09:53,760 --> 00:09:55,019
console

212
00:09:55,019 --> 00:09:56,519
so very soon

213
00:09:56,519 --> 00:09:58,500
you will see like the characters is

214
00:09:58,500 --> 00:10:00,720
going to appear here it's hard to see

215
00:10:00,720 --> 00:10:03,060
but yeah it's gonna write like your

216
00:10:03,060 --> 00:10:05,220
drive is encrypted something like that

217
00:10:05,220 --> 00:10:08,700
and the second function in this Viper is

218
00:10:08,700 --> 00:10:13,320
uh enumerating physical disks from like

219
00:10:13,320 --> 00:10:16,920
a c to that and then I wiping every 199

220
00:10:16,920 --> 00:10:19,800
sector with CC bytes

221
00:10:19,800 --> 00:10:22,740
so and yeah just printing printing the

222
00:10:22,740 --> 00:10:24,720
rest of the string your hard drive has

223
00:10:24,720 --> 00:10:26,279
been corrupted in case you want to

224
00:10:26,279 --> 00:10:28,440
recover oil hard drives of your

225
00:10:28,440 --> 00:10:30,600
organization then contact like the

226
00:10:30,600 --> 00:10:33,800
following way

227
00:10:34,260 --> 00:10:36,839
so it pretend to be like you know like a

228
00:10:36,839 --> 00:10:39,839
ransomware

229
00:10:41,700 --> 00:10:45,140
so let's go for them

230
00:10:45,540 --> 00:10:48,360
and uh

231
00:10:48,360 --> 00:10:51,360
well then we have a hermetic uh hermetic

232
00:10:51,360 --> 00:10:53,940
family a Viper Wizard and Ransom so

233
00:10:53,940 --> 00:10:56,700
hermetic Ransom was uh supposedly used

234
00:10:56,700 --> 00:11:00,240
as a decoy and just to uh overflow

235
00:11:00,240 --> 00:11:02,279
Security Solutions like CM with the

236
00:11:02,279 --> 00:11:05,579
security events uh hermetic wizard is a

237
00:11:05,579 --> 00:11:07,860
vector that we use to establish

238
00:11:07,860 --> 00:11:11,100
persistence and deploy later hermetic

239
00:11:11,100 --> 00:11:13,980
Viper and wiper of course used

240
00:11:13,980 --> 00:11:16,920
to wipe the data so how they were

241
00:11:16,920 --> 00:11:18,360
delivered

242
00:11:18,360 --> 00:11:21,540
again according to our asset report so

243
00:11:21,540 --> 00:11:25,320
the hermetric visor delivered Viper via

244
00:11:25,320 --> 00:11:29,279
VMI and SMB also GPU Group Policy object

245
00:11:29,279 --> 00:11:32,160
was used by the way many wipers uh in

246
00:11:32,160 --> 00:11:33,240
this

247
00:11:33,240 --> 00:11:36,660
Russian Ukraine cyber War were deployed

248
00:11:36,660 --> 00:11:39,680
using GPU it means the attacker they had

249
00:11:39,680 --> 00:11:42,600
persistence on domain controllers on

250
00:11:42,600 --> 00:11:45,300
administrate on servers and then use

251
00:11:45,300 --> 00:11:48,360
this access to distribute malware using

252
00:11:48,360 --> 00:11:50,279
gpos

253
00:11:50,279 --> 00:11:52,800
then as for Destruction there is also

254
00:11:52,800 --> 00:11:55,320
quite interesting capability that they

255
00:11:55,320 --> 00:11:59,339
use is US disk management software like

256
00:11:59,339 --> 00:12:01,560
you they use legitimate driver from this

257
00:12:01,560 --> 00:12:03,720
software in order to get access direct

258
00:12:03,720 --> 00:12:08,100
access to uh the disk it wipes MBR mft

259
00:12:08,100 --> 00:12:12,180
backups of of mft as well registry

260
00:12:12,180 --> 00:12:14,640
bitmap log file for drives and even

261
00:12:14,640 --> 00:12:16,980
Windows events lock which means uh the

262
00:12:16,980 --> 00:12:19,500
attackers they wanted to just

263
00:12:19,500 --> 00:12:22,680
wipe the traces of the attack

264
00:12:22,680 --> 00:12:25,800
and it was attributed to send one by

265
00:12:25,800 --> 00:12:28,339
asset

266
00:12:29,519 --> 00:12:31,560
and yeah probably

267
00:12:31,560 --> 00:12:35,940
the thing I I would uh have started uh

268
00:12:35,940 --> 00:12:38,760
certificate uh is why it's called her

269
00:12:38,760 --> 00:12:40,560
magic because we have a certificate

270
00:12:40,560 --> 00:12:42,959
issued Mathematica digital Alpha there

271
00:12:42,959 --> 00:12:45,680
but according again to a search report

272
00:12:45,680 --> 00:12:49,079
this certificate uh was not issued to

273
00:12:49,079 --> 00:12:51,660
this company because it exists it's real

274
00:12:51,660 --> 00:12:55,079
one but supposedly uh the attackers they

275
00:12:55,079 --> 00:12:56,820
issue the certificate on behalf of this

276
00:12:56,820 --> 00:12:59,639
company so it was like original

277
00:12:59,639 --> 00:13:03,740
but the company has no relation to this

278
00:13:03,740 --> 00:13:07,380
hermetic uh family were executed just

279
00:13:07,380 --> 00:13:09,420
few hours before all out Invasion to

280
00:13:09,420 --> 00:13:12,480
Ukraine and this is a picture that shows

281
00:13:12,480 --> 00:13:14,100
like initial plan of the Russia

282
00:13:14,100 --> 00:13:17,940
according to foreign agencies uh how how

283
00:13:17,940 --> 00:13:19,800
the Russian army is going to take over

284
00:13:19,800 --> 00:13:21,720
Ukraine as you can see

285
00:13:21,720 --> 00:13:24,720
there were a couple of forces going to

286
00:13:24,720 --> 00:13:27,440
uh

287
00:13:27,440 --> 00:13:31,019
this is my home City just on the way so

288
00:13:31,019 --> 00:13:33,120
they planned just in one today to take

289
00:13:33,120 --> 00:13:35,100
over the city as well as Kiev as you

290
00:13:35,100 --> 00:13:37,440
probably know but of course failed

291
00:13:37,440 --> 00:13:39,959
and uh my family

292
00:13:39,959 --> 00:13:44,279
woke up uh this day at 5 00 am

293
00:13:44,279 --> 00:13:47,760
and we heard like explosions they were

294
00:13:47,760 --> 00:13:49,079
quite far

295
00:13:49,079 --> 00:13:54,199
but uh this is this is how it looks

296
00:13:55,920 --> 00:13:57,839
this is North East

297
00:13:57,839 --> 00:14:00,839
part of Harkin it's 50 kilometers to the

298
00:14:00,839 --> 00:14:02,700
Russian border

299
00:14:02,700 --> 00:14:04,440
and uh

300
00:14:04,440 --> 00:14:07,380
in day later the Russian troops they

301
00:14:07,380 --> 00:14:09,480
came to this line it was the front line

302
00:14:09,480 --> 00:14:12,120
it became a front line and they were

303
00:14:12,120 --> 00:14:14,220
styled by the Ukrainian Army and by the

304
00:14:14,220 --> 00:14:16,860
territorial defense and uh the Russian

305
00:14:16,860 --> 00:14:19,260
army couldn't couldn't go further by the

306
00:14:19,260 --> 00:14:19,860
way

307
00:14:19,860 --> 00:14:21,839
what you can see on this picture this is

308
00:14:21,839 --> 00:14:24,360
a hospital just right to the church this

309
00:14:24,360 --> 00:14:26,459
is where I was born

310
00:14:26,459 --> 00:14:28,980
and uh it was hit later by one of the

311
00:14:28,980 --> 00:14:31,139
Russian rocket and also this reservation

312
00:14:31,139 --> 00:14:34,519
buildings were also destroyed

313
00:14:38,579 --> 00:14:41,639
the same day acid rain attack happened

314
00:14:41,639 --> 00:14:44,160
acid rain was vipers that were used to

315
00:14:44,160 --> 00:14:46,380
break satellites modems that were used

316
00:14:46,380 --> 00:14:48,959
by Ukrainian militaries it was a company

317
00:14:48,959 --> 00:14:52,459
the Assad and the attackers

318
00:14:52,459 --> 00:14:56,040
they used a misconfigured VPN Appliance

319
00:14:56,040 --> 00:14:58,620
to deploy a firmware update to

320
00:14:58,620 --> 00:15:01,139
satellites modems but the trick the

321
00:15:01,139 --> 00:15:03,540
tricky part yes they break the modems

322
00:15:03,540 --> 00:15:04,320
they

323
00:15:04,320 --> 00:15:07,860
made them inoperable and for like a week

324
00:15:07,860 --> 00:15:10,980
probably or even more they were not able

325
00:15:10,980 --> 00:15:14,399
to uh it was not possible to to to use

326
00:15:14,399 --> 00:15:17,100
them fortunately later Elon Musk

327
00:15:17,100 --> 00:15:20,760
supplied us with uh starlink so now all

328
00:15:20,760 --> 00:15:22,500
military is use Sterling

329
00:15:22,500 --> 00:15:24,480
hopefully there will be no attack on

330
00:15:24,480 --> 00:15:26,279
Sterling in the future

331
00:15:26,279 --> 00:15:27,959
uh

332
00:15:27,959 --> 00:15:31,440
but the thing is it uh during uh due to

333
00:15:31,440 --> 00:15:35,399
the attack uh the the modems were brick

334
00:15:35,399 --> 00:15:37,740
not only in Ukraine but also in Europe

335
00:15:37,740 --> 00:15:40,440
so all all modems in Europe were also

336
00:15:40,440 --> 00:15:42,540
affected

337
00:15:42,540 --> 00:15:45,839
then Isaac Viper

338
00:15:45,839 --> 00:15:48,300
um targets some of the Ukrainian

339
00:15:48,300 --> 00:15:51,060
Enterprises uh detected by certainly

340
00:15:51,060 --> 00:15:56,579
said Microsoft and it wipes uh the first

341
00:15:56,579 --> 00:16:00,959
like around the 10th around

342
00:16:00,959 --> 00:16:05,220
uh 10 000 hex bytes of each disk and the

343
00:16:05,220 --> 00:16:06,779
name of this Viper

344
00:16:06,779 --> 00:16:08,639
um was

345
00:16:08,639 --> 00:16:10,440
taken from the name of the random

346
00:16:10,440 --> 00:16:12,959
generator is and isak is not someone's

347
00:16:12,959 --> 00:16:15,420
name but just abbreviation of the random

348
00:16:15,420 --> 00:16:18,839
generator and it stands for indirection

349
00:16:18,839 --> 00:16:19,740
um

350
00:16:19,740 --> 00:16:22,440
shift accumulate add and count but later

351
00:16:22,440 --> 00:16:25,320
they updated that uh it was like a

352
00:16:25,320 --> 00:16:27,360
different one so this is probably like

353
00:16:27,360 --> 00:16:31,620
the name that it could uh be given uh

354
00:16:31,620 --> 00:16:33,839
the interesting thing about isak Viper

355
00:16:33,839 --> 00:16:36,540
that it didn't work from the first time

356
00:16:36,540 --> 00:16:39,240
uh they couldn't get permission to uh

357
00:16:39,240 --> 00:16:42,120
direct permission to the uh disk to Vibe

358
00:16:42,120 --> 00:16:44,519
the data and that's why they released a

359
00:16:44,519 --> 00:16:45,480
new version

360
00:16:45,480 --> 00:16:47,699
on February 25

361
00:16:47,699 --> 00:16:51,920
with enabled the backlog capability

362
00:16:54,720 --> 00:16:56,820
then another attack there's another

363
00:16:56,820 --> 00:16:58,860
Viper attack detected by Microsoft I

364
00:16:58,860 --> 00:17:01,079
don't have uh any data about this attack

365
00:17:01,079 --> 00:17:03,300
it was reported by Microsoft but the

366
00:17:03,300 --> 00:17:05,099
interesting thing um

367
00:17:05,099 --> 00:17:07,919
as you can see it was written in Golan

368
00:17:07,919 --> 00:17:11,520
and uh analyzing all the samples I would

369
00:17:11,520 --> 00:17:14,459
say that like a big variety of platforms

370
00:17:14,459 --> 00:17:16,980
languages were using this attack so uh

371
00:17:16,980 --> 00:17:18,599
and I have

372
00:17:18,599 --> 00:17:21,000
an assumption that it might be like

373
00:17:21,000 --> 00:17:22,380
different people were working or

374
00:17:22,380 --> 00:17:23,880
different subunits were working on

375
00:17:23,880 --> 00:17:27,059
different vipers because it includes uh

376
00:17:27,059 --> 00:17:30,780
besides like regular Vin 32 in 64 and

377
00:17:30,780 --> 00:17:32,660
even 60-bit

378
00:17:32,660 --> 00:17:38,600
applications.net python VBS uh golang

379
00:17:40,020 --> 00:17:42,720
cardi Viper the attack was executed on

380
00:17:42,720 --> 00:17:45,419
14th of March attacking again a few

381
00:17:45,419 --> 00:17:48,059
dozens of Ukrainian organizations

382
00:17:48,059 --> 00:17:51,000
uh delivered through gpos again

383
00:17:51,000 --> 00:17:54,860
and as you can see it Vibes first

384
00:17:54,860 --> 00:17:58,799
1920 bytes of data using device IO

385
00:17:58,799 --> 00:18:00,840
control so they they haven't the

386
00:18:00,840 --> 00:18:02,700
administrative privileges

387
00:18:02,700 --> 00:18:04,799
you can get access to physical drives to

388
00:18:04,799 --> 00:18:07,020
get handled to the physical drives and

389
00:18:07,020 --> 00:18:10,440
wipes uh the first first uh sectors of

390
00:18:10,440 --> 00:18:15,179
the of the data and similarly to

391
00:18:15,179 --> 00:18:15,840
um

392
00:18:15,840 --> 00:18:18,600
whisper gate it has two streams one

393
00:18:18,600 --> 00:18:21,000
stream uh it's file file corruption

394
00:18:21,000 --> 00:18:22,980
stream so we target files Vibe the

395
00:18:22,980 --> 00:18:25,860
dating files second stream is a disk

396
00:18:25,860 --> 00:18:27,059
corruption

397
00:18:27,059 --> 00:18:30,679
and once they write this

398
00:18:30,679 --> 00:18:35,160
1920 bytes it replaces the MBR and after

399
00:18:35,160 --> 00:18:37,500
attributed the system it the boot is

400
00:18:37,500 --> 00:18:39,980
going to fail

401
00:18:40,620 --> 00:18:43,919
double zero discovered by 38

402
00:18:43,919 --> 00:18:46,380
and it was named because it used two uh

403
00:18:46,380 --> 00:18:47,820
wiping techniques

404
00:18:47,820 --> 00:18:51,780
uh the first one is like um used for uh

405
00:18:51,780 --> 00:18:54,600
performance issues for for performance

406
00:18:54,600 --> 00:18:55,440
um

407
00:18:55,440 --> 00:18:58,559
things NTS control file if you set the

408
00:18:58,559 --> 00:19:01,559
following uh parameter fctl set zero

409
00:19:01,559 --> 00:19:04,919
data then uh when you access the file

410
00:19:04,919 --> 00:19:07,080
all the data inside of the file is going

411
00:19:07,080 --> 00:19:10,380
to be zeroed so it's much faster this is

412
00:19:10,380 --> 00:19:12,840
a much faster way it's just regular uh

413
00:19:12,840 --> 00:19:13,980
regular

414
00:19:13,980 --> 00:19:16,200
iterative writing the files and the

415
00:19:16,200 --> 00:19:17,880
second is traditional one just using

416
00:19:17,880 --> 00:19:22,620
file stream right uh for the blocks are

417
00:19:22,620 --> 00:19:28,320
four thousand nine uh 96 bytes each

418
00:19:28,320 --> 00:19:31,320
it also did destroys system registry as

419
00:19:31,320 --> 00:19:32,880
you can see

420
00:19:32,880 --> 00:19:37,679
similar to uh hermetic

421
00:19:37,679 --> 00:19:40,620
final one is industrial accompanied with

422
00:19:40,620 --> 00:19:44,720
KD Viper by the way uh

423
00:19:44,720 --> 00:19:47,760
as for industrial to it was recently

424
00:19:47,760 --> 00:19:50,520
reported by a center Searchers again

425
00:19:50,520 --> 00:19:51,980
Robert

426
00:19:51,980 --> 00:19:56,039
blackhead U.S and uh

427
00:19:56,039 --> 00:19:58,980
it was scheduled to be executed on April

428
00:19:58,980 --> 00:20:00,120
8.

429
00:20:00,120 --> 00:20:03,660
and after this date uh the Viper Kitty

430
00:20:03,660 --> 00:20:06,600
Viper it's version two is going to be

431
00:20:06,600 --> 00:20:09,120
run so why two because this is a new

432
00:20:09,120 --> 00:20:11,880
variance new variance of the of the

433
00:20:11,880 --> 00:20:13,440
ransomware

434
00:20:13,440 --> 00:20:16,200
oh sorry or new new variants of malware

435
00:20:16,200 --> 00:20:18,660
uh industrial is just a new variants of

436
00:20:18,660 --> 00:20:20,640
industrial one which was executed in

437
00:20:20,640 --> 00:20:23,460
2016 and had the Viper we already uh

438
00:20:23,460 --> 00:20:27,240
seen them seen this Viper before so uh

439
00:20:27,240 --> 00:20:29,280
what's the trick with the kaiji Viper 2.

440
00:20:29,280 --> 00:20:31,799
so the purpose of this Viper was to hide

441
00:20:31,799 --> 00:20:33,539
the traces of the attack so it was

442
00:20:33,539 --> 00:20:35,460
scheduled to be executed after industry

443
00:20:35,460 --> 00:20:39,240
2. and what they did in order to execute

444
00:20:39,240 --> 00:20:41,940
uh like same same wiper again because as

445
00:20:41,940 --> 00:20:44,100
you know uh it's not good idea to

446
00:20:44,100 --> 00:20:45,720
execute the same malware two times

447
00:20:45,720 --> 00:20:47,640
because it will be detected

448
00:20:47,640 --> 00:20:50,940
and what they did they uh used parched

449
00:20:50,940 --> 00:20:55,799
win32 remote this is a idus win32 a

450
00:20:55,799 --> 00:20:57,780
remote debug server from hex race

451
00:20:57,780 --> 00:21:00,860
package they patch it and this this

452
00:21:00,860 --> 00:21:03,840
executable is used only to decode

453
00:21:03,840 --> 00:21:07,520
encoded KD Viper code which is

454
00:21:07,520 --> 00:21:10,559
pa1.pay and on the screen you can see

455
00:21:10,559 --> 00:21:11,940
this is the argument that should be

456
00:21:11,940 --> 00:21:16,080
given to this paramoga

457
00:21:17,539 --> 00:21:21,740
in Ukrainian it's victory

458
00:21:22,380 --> 00:21:24,840
and then

459
00:21:24,840 --> 00:21:27,360
this file was used to decode this one

460
00:21:27,360 --> 00:21:30,299
and to decode they use Simple store

461
00:21:30,299 --> 00:21:32,340
but as you can see there is like a

462
00:21:32,340 --> 00:21:34,919
multi-byte key it's a 16 byte key

463
00:21:34,919 --> 00:21:37,740
but but the interesting thing that uh it

464
00:21:37,740 --> 00:21:40,080
they didn't score like a 60 points of

465
00:21:40,080 --> 00:21:42,840
data and 60 byte of key like first byte

466
00:21:42,840 --> 00:21:44,520
of data first byte of key second date of

467
00:21:44,520 --> 00:21:46,440
data second byte of key like one time

468
00:21:46,440 --> 00:21:50,580
Pat works but instead they just sort the

469
00:21:50,580 --> 00:21:54,659
whole key with one byte with a one byte

470
00:21:54,659 --> 00:21:56,700
of the data which makes sense to have

471
00:21:56,700 --> 00:21:59,280
this 16 byte key which can be due to

472
00:21:59,280 --> 00:22:03,080
Association uh rule you can just

473
00:22:03,080 --> 00:22:07,919
uh roll in into one byte uh well that is

474
00:22:07,919 --> 00:22:09,780
this mistake is not crucial because it's

475
00:22:09,780 --> 00:22:12,780
just obfuscation but it uh gives us

476
00:22:12,780 --> 00:22:15,659
understanding that uh the developers of

477
00:22:15,659 --> 00:22:16,860
this

478
00:22:16,860 --> 00:22:18,419
Viper

479
00:22:18,419 --> 00:22:21,360
or one developer uh has no like

480
00:22:21,360 --> 00:22:24,360
traditional uh education that includes

481
00:22:24,360 --> 00:22:29,178
cryptography and uh related stuff

482
00:22:31,380 --> 00:22:33,539
attacks on Ukrainian Power Wheels so why

483
00:22:33,539 --> 00:22:36,600
why power grid actually is so important

484
00:22:36,600 --> 00:22:39,539
as you can see uh all started in 2015

485
00:22:39,539 --> 00:22:42,360
after the war with Ukraine as war with

486
00:22:42,360 --> 00:22:44,520
Ukraine started in 2014 when Russia

487
00:22:44,520 --> 00:22:47,039
occupied Crimea and danbas and a year

488
00:22:47,039 --> 00:22:48,659
later they executed blackhead successful

489
00:22:48,659 --> 00:22:50,940
executed black energy plus kill this

490
00:22:50,940 --> 00:22:55,260
Viper and uh cut off electricity then in

491
00:22:55,260 --> 00:22:57,539
Destroyer that I mentioned already then

492
00:22:57,539 --> 00:22:59,580
the new one that was discovered and

493
00:22:59,580 --> 00:23:01,740
failed to be executed

494
00:23:01,740 --> 00:23:05,220
and then they decided okay if it uh

495
00:23:05,220 --> 00:23:08,240
doesn't work okay let's switch to

496
00:23:08,240 --> 00:23:10,500
traditional kinetic weapons and that's

497
00:23:10,500 --> 00:23:13,740
why recently on September 11 they just

498
00:23:13,740 --> 00:23:16,320
hit the second biggest power and heat

499
00:23:16,320 --> 00:23:18,179
plant in Ukraine which is located close

500
00:23:18,179 --> 00:23:21,679
to hardif to my home city with a Caliber

501
00:23:21,679 --> 00:23:24,900
Caliber cruise missiles

502
00:23:24,900 --> 00:23:27,720
it was supposedly launched from a

503
00:23:27,720 --> 00:23:30,240
Russian Subaru in the Black Sea

504
00:23:30,240 --> 00:23:32,940
and here I can see this is a destruction

505
00:23:32,940 --> 00:23:35,340
of the two blocks out of three that

506
00:23:35,340 --> 00:23:37,799
cause like uh two or three days blackout

507
00:23:37,799 --> 00:23:41,820
in uh in eastern Ukraine like affecting

508
00:23:41,820 --> 00:23:45,139
more than five regions

509
00:23:45,240 --> 00:23:48,539
so a couple of uh thoughts regarding the

510
00:23:48,539 --> 00:23:52,260
Viper so first wipers are there can

511
00:23:52,260 --> 00:23:54,299
cause long-term distraction long-term

512
00:23:54,299 --> 00:23:56,820
denial of service

513
00:23:56,820 --> 00:23:59,820
attack and it may affect a critical

514
00:23:59,820 --> 00:24:01,159
structure

515
00:24:01,159 --> 00:24:03,960
specifically energy sector communication

516
00:24:03,960 --> 00:24:07,020
Financial government services that may

517
00:24:07,020 --> 00:24:11,340
uh like push the government to uh the

518
00:24:11,340 --> 00:24:12,780
age of existence

519
00:24:12,780 --> 00:24:15,120
if you don't have a government registers

520
00:24:15,120 --> 00:24:17,280
if you don't have communication you can

521
00:24:17,280 --> 00:24:19,740
not like uh send message to to your

522
00:24:19,740 --> 00:24:20,820
people

523
00:24:20,820 --> 00:24:23,760
and it was couple of information attacks

524
00:24:23,760 --> 00:24:25,159
when uh

525
00:24:25,159 --> 00:24:28,380
Russian hackers try to convince that um

526
00:24:28,380 --> 00:24:30,900
resilience gave up and the signed

527
00:24:30,900 --> 00:24:33,380
capitulation

528
00:24:34,159 --> 00:24:36,720
unselective so

529
00:24:36,720 --> 00:24:39,659
by the way this is so it's it's about

530
00:24:39,659 --> 00:24:40,860
precision

531
00:24:40,860 --> 00:24:43,740
so I give analogy with the tornado s

532
00:24:43,740 --> 00:24:48,480
ternada s it's uh mlrs it's new

533
00:24:48,480 --> 00:24:51,539
generation of mlrs and it was used to

534
00:24:51,539 --> 00:24:53,820
hit the city as you can see by the way

535
00:24:53,820 --> 00:24:56,400
this is my home University Park National

536
00:24:56,400 --> 00:24:59,940
University of Radio Electronics where I

537
00:24:59,940 --> 00:25:00,780
teach

538
00:25:00,780 --> 00:25:03,360
cyber security

539
00:25:03,360 --> 00:25:06,539
and as you can see this is smoke that's

540
00:25:06,539 --> 00:25:08,039
not barbecue

541
00:25:08,039 --> 00:25:11,039
that's just heat of alternator s it's

542
00:25:11,039 --> 00:25:14,039
multiple it was multiple launch of these

543
00:25:14,039 --> 00:25:17,340
rockets and uh after the Russian army

544
00:25:17,340 --> 00:25:19,620
was kicked back to the Border they were

545
00:25:19,620 --> 00:25:21,659
not able to reach us without traditional

546
00:25:21,659 --> 00:25:23,580
mlrs that's why they switched to New

547
00:25:23,580 --> 00:25:24,539
Generation

548
00:25:24,539 --> 00:25:26,880
which were capable attacking through

549
00:25:26,880 --> 00:25:29,039
from the distance 120 kilometers which

550
00:25:29,039 --> 00:25:30,960
means they could reach Harkey from

551
00:25:30,960 --> 00:25:33,720
Belgard this is the nearest biggest city

552
00:25:33,720 --> 00:25:37,140
in Russia but the pro the things that

553
00:25:37,140 --> 00:25:38,760
are according to specifications they

554
00:25:38,760 --> 00:25:41,279
claim that the distribution of Heats

555
00:25:41,279 --> 00:25:43,080
from this maximum distance is going to

556
00:25:43,080 --> 00:25:46,559
be not more than 0.3 percent which I

557
00:25:46,559 --> 00:25:49,200
calculated is going to be 360 hundred uh

558
00:25:49,200 --> 00:25:51,179
360 meters

559
00:25:51,179 --> 00:25:54,059
and as you can see on the picture it's

560
00:25:54,059 --> 00:25:58,440
twice or triple uh time bigger than this

561
00:25:58,440 --> 00:26:00,480
distance and it's not in general it's

562
00:26:00,480 --> 00:26:02,640
not a good idea to use mlrs because it's

563
00:26:02,640 --> 00:26:06,659
typically used to wipe out the square

564
00:26:06,659 --> 00:26:09,960
uh which is equal like 0.6 square

565
00:26:09,960 --> 00:26:12,419
kilometers and it's not a good idea to

566
00:26:12,419 --> 00:26:14,100
apply like at least a weaponer against

567
00:26:14,100 --> 00:26:18,799
uh the civilians and if we

568
00:26:20,539 --> 00:26:23,779
if we

569
00:26:25,080 --> 00:26:27,720
yeah and by the way uh as a result of

570
00:26:27,720 --> 00:26:29,580
this attack

571
00:26:29,580 --> 00:26:31,620
um again about precision

572
00:26:31,620 --> 00:26:35,520
they demilitarized actually destroyed my

573
00:26:35,520 --> 00:26:36,720
favorite Bakery

574
00:26:36,720 --> 00:26:39,299
one kindergarten a couple of residential

575
00:26:39,299 --> 00:26:42,240
blocks and swimming pool this cement

576
00:26:42,240 --> 00:26:44,580
pool was located just 40 meters from my

577
00:26:44,580 --> 00:26:47,100
apartment from my uh residential area

578
00:26:47,100 --> 00:26:49,380
this is where we used to go for a walk

579
00:26:49,380 --> 00:26:53,400
but the the trick is I don't think they

580
00:26:53,400 --> 00:26:55,799
actually Target the swimming pool

581
00:26:55,799 --> 00:26:57,779
I think there was like another another

582
00:26:57,779 --> 00:26:59,820
Target here

583
00:26:59,820 --> 00:27:02,039
and similar happened with notepadia when

584
00:27:02,039 --> 00:27:03,600
they executed on pages from the dock it

585
00:27:03,600 --> 00:27:05,820
was not guided it was not controlled and

586
00:27:05,820 --> 00:27:09,000
it went out of control and infected also

587
00:27:09,000 --> 00:27:10,860
Mars for example chip and gent in

588
00:27:10,860 --> 00:27:13,919
Denmark as for acid rain they bricked

589
00:27:13,919 --> 00:27:16,620
satellite model not only in Ukraine but

590
00:27:16,620 --> 00:27:20,959
also in Germany and in in the EU

591
00:27:21,600 --> 00:27:23,820
a misfire

592
00:27:23,820 --> 00:27:27,000
well as isak Viper

593
00:27:27,000 --> 00:27:31,940
sometimes Russian weapon doesn't work

594
00:27:34,200 --> 00:27:36,120
and

595
00:27:36,120 --> 00:27:36,840
um

596
00:27:36,840 --> 00:27:40,679
s 300 versus new beta and hermetic Viper

597
00:27:40,679 --> 00:27:43,860
so uh please raise your hand who knows

598
00:27:43,860 --> 00:27:47,000
what s300

599
00:27:47,120 --> 00:27:51,480
so uh and you will be wondering but this

600
00:27:51,480 --> 00:27:53,940
is the heat of s300

601
00:27:53,940 --> 00:27:57,240
and what's weird is s300 is air defense

602
00:27:57,240 --> 00:27:57,960
system

603
00:27:57,960 --> 00:28:00,720
which means it was designed to hit our

604
00:28:00,720 --> 00:28:02,279
fine objects

605
00:28:02,279 --> 00:28:05,700
not objects on on Earth

606
00:28:05,700 --> 00:28:08,600
but it was after the war started in 2014

607
00:28:08,600 --> 00:28:13,559
it was redesigned to uh from Earth's air

608
00:28:13,559 --> 00:28:16,380
they were redesigned to Earth to Earth

609
00:28:16,380 --> 00:28:18,779
and now when they have lack of extenders

610
00:28:18,779 --> 00:28:23,880
that I like uh Next Generation missiles

611
00:28:23,880 --> 00:28:27,179
they started using s300 against Earth's

612
00:28:27,179 --> 00:28:29,460
Target and as you can see this it's also

613
00:28:29,460 --> 00:28:33,000
not very precise and the message what

614
00:28:33,000 --> 00:28:36,080
I'm going to tell that if you

615
00:28:36,080 --> 00:28:40,320
ah and this is a typical technique that

616
00:28:40,320 --> 00:28:43,380
were used by

617
00:28:43,380 --> 00:28:47,220
by the Russian army both on land and in

618
00:28:47,220 --> 00:28:49,980
kinetic war and in cyber War just to

619
00:28:49,980 --> 00:28:52,980
patch some existing malware

620
00:28:52,980 --> 00:28:55,559
to uh be used in in this in cyber

621
00:28:55,559 --> 00:28:57,840
operations and the reason of that is of

622
00:28:57,840 --> 00:28:59,340
course the lack of resources to deliver

623
00:28:59,340 --> 00:29:02,100
to develop your own Weaponry from

624
00:29:02,100 --> 00:29:04,399
scratch

625
00:29:04,799 --> 00:29:07,919
same cardi wiper too I think they fail

626
00:29:07,919 --> 00:29:10,679
one of the reasons they they might fail

627
00:29:10,679 --> 00:29:12,900
is that they just reuse already known

628
00:29:12,900 --> 00:29:15,440
malware

629
00:29:15,480 --> 00:29:18,240
and yeah the magic Viper

630
00:29:18,240 --> 00:29:23,880
using is e eus drivers so to sum up

631
00:29:23,880 --> 00:29:26,159
if you do a cyber weapon please do it

632
00:29:26,159 --> 00:29:28,820
well because if it goes out of control

633
00:29:28,820 --> 00:29:31,740
it may affect our critical instructions

634
00:29:31,740 --> 00:29:34,260
that you don't uh that you don't intend

635
00:29:34,260 --> 00:29:37,559
to to destroy as you know in Ukraine we

636
00:29:37,559 --> 00:29:39,600
have six power plants

637
00:29:39,600 --> 00:29:43,320
and many of them run out of time yeah

638
00:29:43,320 --> 00:29:46,860
I'm afraid so sorry about that uh please

639
00:29:46,860 --> 00:29:48,840
join me in thanking Alexander for a

640
00:29:48,840 --> 00:29:51,139
great talk

