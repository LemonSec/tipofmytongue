1
00:00:03,580 --> 00:00:05,500
all right so this is watching the

2
00:00:05,500 --> 00:00:09,160
Watchers I like like Patrick said I do a

3
00:00:09,160 --> 00:00:11,980
lot forensic analysis so I get that

4
00:00:11,980 --> 00:00:13,840
boxes I'm not really doing it much that

5
00:00:13,840 --> 00:00:15,820
at scale doing load you have to pry

6
00:00:15,820 --> 00:00:18,699
stuff but I dig deep and I look for

7
00:00:18,699 --> 00:00:21,220
really ups care stuff so if you went to

8
00:00:21,220 --> 00:00:24,579
the conference in November in Maui 20

9
00:00:24,579 --> 00:00:26,739
was fantastic I love these companies has

10
00:00:26,739 --> 00:00:28,419
been easily my favorite conference by

11
00:00:28,419 --> 00:00:31,060
far I went through and talked about my

12
00:00:31,060 --> 00:00:33,250
Apollo tool which went really in-depth

13
00:00:33,250 --> 00:00:35,530
with iOS devices literally everything

14
00:00:35,530 --> 00:00:38,109
that those things crack which is super

15
00:00:38,109 --> 00:00:40,780
creepy that's what I do I may be small

16
00:00:40,780 --> 00:00:43,750
and unassuming and very quiet I want to

17
00:00:43,750 --> 00:00:44,800
get access scare beta

18
00:00:44,800 --> 00:00:47,019
I'm going next nobody gives me the

19
00:00:47,019 --> 00:00:49,300
computers and phones anymore which is

20
00:00:49,300 --> 00:00:52,210
kind of strange don't know why so

21
00:00:52,210 --> 00:00:54,309
contact information is up there I'm by

22
00:00:54,309 --> 00:00:56,969
far the most available on Twitter

23
00:00:56,969 --> 00:00:59,620
website is also there Mac forensics the

24
00:00:59,620 --> 00:01:01,179
presentation will be uploaded to that a

25
00:01:01,179 --> 00:01:04,120
little bit later on and one like class

26
00:01:04,120 --> 00:01:05,890
information that is part of private team

27
00:01:05,890 --> 00:01:09,240
calm that's what we work two jobs I do

28
00:01:09,240 --> 00:01:12,100
basically two dollars like a day job I'm

29
00:01:12,100 --> 00:01:16,180
a government contractor for people and

30
00:01:16,180 --> 00:01:19,120
things doing mobile device forensic

31
00:01:19,120 --> 00:01:21,670
analysis and research and then my other

32
00:01:21,670 --> 00:01:24,340
job is teaching for Sam's so it's may

33
00:01:24,340 --> 00:01:26,020
have to be traveling it's meeting places

34
00:01:26,020 --> 00:01:29,070
like this is a really good preciate that

35
00:01:29,070 --> 00:01:32,440
so this is kind of presentation of

36
00:01:32,440 --> 00:01:35,580
digging into all these third-party

37
00:01:35,580 --> 00:01:38,320
monitoring utilities so when I talk

38
00:01:38,320 --> 00:01:40,360
about the iOS stuff the last time this

39
00:01:40,360 --> 00:01:41,950
is a lot of the stuff that's being

40
00:01:41,950 --> 00:01:44,430
tracked by the operating system itself

41
00:01:44,430 --> 00:01:47,050
sometimes that stuff breaks or doesn't

42
00:01:47,050 --> 00:01:48,340
track what you want to track it

43
00:01:48,340 --> 00:01:49,660
sometimes you could dig a little bit

44
00:01:49,660 --> 00:01:52,180
deeper and third-party apps are

45
00:01:52,180 --> 00:01:54,160
sometimes missed for a lot of that same

46
00:01:54,160 --> 00:01:56,290
sort of information so I'm going to go

47
00:01:56,290 --> 00:01:59,200
through some of that as we go along now

48
00:01:59,200 --> 00:02:01,090
specifically the applications that I'm

49
00:02:01,090 --> 00:02:02,680
going to talk about of course I'm going

50
00:02:02,680 --> 00:02:04,210
to hit the objective-c sup who uses

51
00:02:04,210 --> 00:02:07,420
objective-c any any tools you want to

52
00:02:07,420 --> 00:02:09,038
surprise everybody in this room should

53
00:02:09,038 --> 00:02:13,120
be using nails Little Snitch okay

54
00:02:13,120 --> 00:02:16,540
so folks or any AV let's just go

55
00:02:16,540 --> 00:02:21,489
any for this one minute right and then I

56
00:02:21,489 --> 00:02:25,569
stat menus so I kind of gave it a little

57
00:02:25,569 --> 00:02:28,239
variety here I think this is a different

58
00:02:28,239 --> 00:02:30,159
room here security professionals in here

59
00:02:30,159 --> 00:02:31,599
so we probably do that quite a bit of

60
00:02:31,599 --> 00:02:33,940
monitoring software I know my mother is

61
00:02:33,940 --> 00:02:35,890
not going to have objective C and Little

62
00:02:35,890 --> 00:02:37,890
Snitch and saw my first system Marshall

63
00:02:37,890 --> 00:02:40,030
like I kind of wish it would be but I

64
00:02:40,030 --> 00:02:41,980
don't think she'd like the popups so

65
00:02:41,980 --> 00:02:44,230
much but I also threw in there things

66
00:02:44,230 --> 00:02:46,840
like that on you know I stat an AV which

67
00:02:46,840 --> 00:02:48,310
is a little bit more broad you know

68
00:02:48,310 --> 00:02:49,840
those might be pre-installed on some

69
00:02:49,840 --> 00:02:53,579
systems I stat is is a very popular

70
00:02:53,579 --> 00:02:56,260
command center Center as well so I want

71
00:02:56,260 --> 00:02:58,389
to kind of open it up just a little bit

72
00:02:58,389 --> 00:03:00,280
now what I'm looking for with these

73
00:03:00,280 --> 00:03:02,530
particular applications is what is it

74
00:03:02,530 --> 00:03:04,209
logging and sometimes it's logging at

75
00:03:04,209 --> 00:03:06,180
plain text files in terms of the gzip

76
00:03:06,180 --> 00:03:08,560
maybe it's logging into a database

77
00:03:08,560 --> 00:03:10,299
somewhere so I'm looking into these

78
00:03:10,299 --> 00:03:11,829
files that it creates

79
00:03:11,829 --> 00:03:14,290
normally I don't call any of these

80
00:03:14,290 --> 00:03:16,239
things bugs I'm just using them for

81
00:03:16,239 --> 00:03:18,909
forensic analysis and looking at what

82
00:03:18,909 --> 00:03:20,769
it's tracking so sometimes it doesn't in

83
00:03:20,769 --> 00:03:23,440
its own application files and sometimes

84
00:03:23,440 --> 00:03:25,329
it's just using the normal log service

85
00:03:25,329 --> 00:03:27,819
biorobot the system log specifically

86
00:03:27,819 --> 00:03:30,459
unified logs to send a lot of those

87
00:03:30,459 --> 00:03:34,090
events to now as far as investigated

88
00:03:34,090 --> 00:03:36,099
uses we talked a lot about security

89
00:03:36,099 --> 00:03:39,609
today I will of course be doing a lot of

90
00:03:39,609 --> 00:03:42,250
a lot of investigations into how a

91
00:03:42,250 --> 00:03:44,530
system that compromise was in our region

92
00:03:44,530 --> 00:03:47,079
did the user click on something was

93
00:03:47,079 --> 00:03:48,669
something inserted into the system so

94
00:03:48,669 --> 00:03:50,470
things like that questions like that

95
00:03:50,470 --> 00:03:52,449
that I need to answer a lot of the stuff

96
00:03:52,449 --> 00:03:54,280
can help with that but I'm also going

97
00:03:54,280 --> 00:03:56,349
from a different perspective maybe more

98
00:03:56,349 --> 00:03:57,819
of a criminal investigation

99
00:03:57,819 --> 00:04:01,090
you know what was the user doing more

100
00:04:01,090 --> 00:04:02,949
than particular location were they using

101
00:04:02,949 --> 00:04:05,199
a certain application you know something

102
00:04:05,199 --> 00:04:06,970
to that effect so a couple of different

103
00:04:06,970 --> 00:04:08,590
things that I want to talk about there

104
00:04:08,590 --> 00:04:10,480
and all the stuff that I'm gonna be

105
00:04:10,480 --> 00:04:12,040
talking that is all on that right hand

106
00:04:12,040 --> 00:04:14,049
side there everything from getting these

107
00:04:14,049 --> 00:04:16,108
relation to what they're downloading

108
00:04:16,108 --> 00:04:17,798
potentially what they're installing

109
00:04:17,798 --> 00:04:19,690
what's running in the system could all

110
00:04:19,690 --> 00:04:21,220
be used in a variety of different

111
00:04:21,220 --> 00:04:23,169
investigations so no matter what you are

112
00:04:23,169 --> 00:04:27,729
actually looking for so let's start with

113
00:04:27,729 --> 00:04:29,860
the objective-c tools might as well as

114
00:04:29,860 --> 00:04:30,490
is like hot

115
00:04:30,490 --> 00:04:32,380
that's what kind of all brought us here

116
00:04:32,380 --> 00:04:35,500
so do not disturb this is basically you

117
00:04:35,500 --> 00:04:37,600
know keeping track of the evil needs in

118
00:04:37,600 --> 00:04:39,069
our world so traffic to start with that

119
00:04:39,069 --> 00:04:40,599
there is less I think we're staying at

120
00:04:40,599 --> 00:04:43,330
hotels right now so I've had this one

121
00:04:43,330 --> 00:04:46,389
running so whenever my laptop lid gets

122
00:04:46,389 --> 00:04:48,310
opened up it sends me a little alert and

123
00:04:48,310 --> 00:04:50,169
I got the little alert that goes to my

124
00:04:50,169 --> 00:04:52,360
phone and it goes to my watch I want to

125
00:04:52,360 --> 00:04:54,220
know when somebody's mucking around with

126
00:04:54,220 --> 00:04:57,120
my system so I do like objective-c

127
00:04:57,120 --> 00:05:00,160
appreciates to that so first thing I

128
00:05:00,160 --> 00:05:01,810
might want to look at if I know that

129
00:05:01,810 --> 00:05:04,509
this user has these tools on here is it

130
00:05:04,509 --> 00:05:06,610
enabled or not you know might have

131
00:05:06,610 --> 00:05:08,530
installed but may not necessarily be

132
00:05:08,530 --> 00:05:10,960
enabled so I'm gonna just do a quick

133
00:05:10,960 --> 00:05:11,560
search

134
00:05:11,560 --> 00:05:14,560
this is using the log command to look at

135
00:05:14,560 --> 00:05:16,690
the unified logs and looking for the

136
00:05:16,690 --> 00:05:18,910
event that message contains D and E or

137
00:05:18,910 --> 00:05:21,250
Do Not Disturb well a lot of explain

138
00:05:21,250 --> 00:05:22,690
that the different applications you can

139
00:05:22,690 --> 00:05:24,220
search for things like Objective C you

140
00:05:24,220 --> 00:05:25,930
can search for Do Not Disturb ease can

141
00:05:25,930 --> 00:05:28,150
search the DMV every application will

142
00:05:28,150 --> 00:05:30,280
track a little bit differently so you

143
00:05:30,280 --> 00:05:32,169
just kinda have to get used to what

144
00:05:32,169 --> 00:05:34,449
you're looking for with that so this one

145
00:05:34,449 --> 00:05:36,009
is just simply printing out isn't

146
00:05:36,009 --> 00:05:38,590
enabled is it not enabled you know that

147
00:05:38,590 --> 00:05:40,960
is the first start if it's not tracking

148
00:05:40,960 --> 00:05:44,139
anything see if it not enabled then it's

149
00:05:44,139 --> 00:05:47,560
probably not tracking much at all next

150
00:05:47,560 --> 00:05:50,169
thing is the laptop lid see so I was

151
00:05:50,169 --> 00:05:51,789
doing a lot of this research on my own

152
00:05:51,789 --> 00:05:53,800
system for better for worse more on that

153
00:05:53,800 --> 00:05:56,320
a little bit later and I have the laptop

154
00:05:56,320 --> 00:05:57,969
so it whenever I open and close the

155
00:05:57,969 --> 00:06:00,759
laptop each one of those events is going

156
00:06:00,759 --> 00:06:02,800
to be recorded that's great you might

157
00:06:02,800 --> 00:06:04,300
not care about that but from an

158
00:06:04,300 --> 00:06:06,310
investigative standpoint this tells me

159
00:06:06,310 --> 00:06:08,349
that the user might be sitting in front

160
00:06:08,349 --> 00:06:10,539
of that computer by my table itself how

161
00:06:10,539 --> 00:06:12,430
long they were while using that system

162
00:06:12,430 --> 00:06:15,639
before or do they you know go to work

163
00:06:15,639 --> 00:06:17,530
they open up their laptop the first

164
00:06:17,530 --> 00:06:19,659
plant in the morning five o'clock rolls

165
00:06:19,659 --> 00:06:21,400
around it's not crappy hour they closed

166
00:06:21,400 --> 00:06:23,199
it down so frequency

167
00:06:23,199 --> 00:06:25,240
buglets that also be potentially useful

168
00:06:25,240 --> 00:06:27,580
and investigations was this gives them

169
00:06:27,580 --> 00:06:29,409
even up and running on any particular

170
00:06:29,409 --> 00:06:34,030
time next things are things like volumes

171
00:06:34,030 --> 00:06:36,669
or USBs that were connected to the

172
00:06:36,669 --> 00:06:39,219
device now do not disturb is great for

173
00:06:39,219 --> 00:06:42,219
this for the first three minutes and

174
00:06:42,219 --> 00:06:43,810
that's time one of the problems

175
00:06:43,810 --> 00:06:47,740
DND it's not problem I know I get like I

176
00:06:47,740 --> 00:06:50,110
shouldn't say that forensically

177
00:06:50,110 --> 00:06:51,760
it's a problem but it's not tracking

178
00:06:51,760 --> 00:06:54,220
every single USB that's dated collecting

179
00:06:54,220 --> 00:06:56,500
to the device so it's really tracking

180
00:06:56,500 --> 00:06:57,910
the first three minutes to see if

181
00:06:57,910 --> 00:07:00,669
anything is really being done unto the

182
00:07:00,669 --> 00:07:03,100
system so in these ones that I'm showing

183
00:07:03,100 --> 00:07:05,650
you you might have associations with

184
00:07:05,650 --> 00:07:08,350
volumes or amounted or amount of devices

185
00:07:08,350 --> 00:07:09,820
and things like that and that's great

186
00:07:09,820 --> 00:07:11,530
and that's something that we can use for

187
00:07:11,530 --> 00:07:13,990
you know weird malicious volume that

188
00:07:13,990 --> 00:07:15,130
might have been plugged into the system

189
00:07:15,130 --> 00:07:17,710
we can take that volume name and pick it

190
00:07:17,710 --> 00:07:19,330
off of that and look for it in other

191
00:07:19,330 --> 00:07:21,910
cleanest other system logs try to figure

192
00:07:21,910 --> 00:07:24,669
out more about that particular device so

193
00:07:24,669 --> 00:07:27,610
is kind of a nice thing to do that and

194
00:07:27,610 --> 00:07:29,169
also the timestamps are also going to

195
00:07:29,169 --> 00:07:31,750
make very important so accuracy explain

196
00:07:31,750 --> 00:07:33,370
stamps great especially they're trying

197
00:07:33,370 --> 00:07:36,190
to put a full intrusion together onto

198
00:07:36,190 --> 00:07:39,510
the system so in this one I know it's a

199
00:07:39,510 --> 00:07:43,710
little bit difficult to see here but

200
00:07:43,710 --> 00:07:46,360
we've seen next copy device so this is

201
00:07:46,360 --> 00:07:49,300
actually my classiest me for my for my

202
00:07:49,300 --> 00:07:51,610
science class and it's created by Conte

203
00:07:51,610 --> 00:07:53,140
called next copy so now I'm getting some

204
00:07:53,140 --> 00:07:55,210
kind of manufacturer type information

205
00:07:55,210 --> 00:07:55,900
too

206
00:07:55,900 --> 00:07:58,479
if I go down here you guys can see that

207
00:07:58,479 --> 00:08:02,740
right I seen forensics echo r51 8-8 this

208
00:08:02,740 --> 00:08:04,180
is a volume name so I'll take this

209
00:08:04,180 --> 00:08:06,820
volume name and maybe search keyword

210
00:08:06,820 --> 00:08:08,500
soared across the whole system see where

211
00:08:08,500 --> 00:08:10,630
else that pops up a one time insertion

212
00:08:10,630 --> 00:08:12,970
or is this something that the user uses

213
00:08:12,970 --> 00:08:15,370
all the time every single day that they

214
00:08:15,370 --> 00:08:20,340
use this particular device next thing

215
00:08:20,340 --> 00:08:23,800
application usage in different processes

216
00:08:23,800 --> 00:08:25,900
so this is to be potentially useful in

217
00:08:25,900 --> 00:08:27,610
investigations where I want to know is

218
00:08:27,610 --> 00:08:29,950
the user doing something or is the

219
00:08:29,950 --> 00:08:32,169
system doing something here that's why I

220
00:08:32,169 --> 00:08:32,919
want to know if there's a user

221
00:08:32,919 --> 00:08:36,070
interaction coming into play here so

222
00:08:36,070 --> 00:08:37,630
again this is trapping first three

223
00:08:37,630 --> 00:08:39,580
minutes so we have a small amount of

224
00:08:39,580 --> 00:08:40,839
time here I think this is more or less

225
00:08:40,839 --> 00:08:43,719
important against an intrusion stuff but

226
00:08:43,719 --> 00:08:45,640
in the first screenshot I have here is

227
00:08:45,640 --> 00:08:48,220
me opening the photos application so I

228
00:08:48,220 --> 00:08:50,680
open up my laptop lid I was looking for

229
00:08:50,680 --> 00:08:54,130
some sort open up photos and I can see

230
00:08:54,130 --> 00:08:57,130
that interacting with that now couple of

231
00:08:57,130 --> 00:08:57,579
other

232
00:08:57,579 --> 00:09:00,309
examples here this one showing loser

233
00:09:00,309 --> 00:09:03,160
been open I use the open command a lot

234
00:09:03,160 --> 00:09:04,899
to basically take something from the

235
00:09:04,899 --> 00:09:07,300
terminal and then open up a database or

236
00:09:07,300 --> 00:09:09,369
keyless to do some forensic analysis of

237
00:09:09,369 --> 00:09:11,170
it so I've actually done this one here

238
00:09:11,170 --> 00:09:13,329
where I'm using the open command to open

239
00:09:13,329 --> 00:09:16,209
up any software update and peanuts file

240
00:09:16,209 --> 00:09:18,069
to do whatever analysis I need to do

241
00:09:18,069 --> 00:09:21,399
with that one another one is using the

242
00:09:21,399 --> 00:09:23,800
fundament so I'm looking for a

243
00:09:23,800 --> 00:09:26,259
particular type of class so I'm looking

244
00:09:26,259 --> 00:09:29,259
for anything in my home directory with

245
00:09:29,259 --> 00:09:31,720
the path that contains software update

246
00:09:31,720 --> 00:09:34,569
so anything any file and database is

247
00:09:34,569 --> 00:09:36,579
associated with that 5-pack it's

248
00:09:36,579 --> 00:09:38,230
something potentially only be useful

249
00:09:38,230 --> 00:09:40,360
there too so you see not just a process

250
00:09:40,360 --> 00:09:42,429
with the full path to what could

251
00:09:42,429 --> 00:09:44,529
potentially be found on there so

252
00:09:44,529 --> 00:09:45,970
somebody's not my system and they're

253
00:09:45,970 --> 00:09:47,949
looking for some weird stuff like X in

254
00:09:47,949 --> 00:09:51,160
each password files or the Kerberos suck

255
00:09:51,160 --> 00:09:53,499
that he was just talking about you know

256
00:09:53,499 --> 00:09:54,939
this would not be a nice thing to care

257
00:09:54,939 --> 00:09:56,740
can you look for that kind of thing

258
00:09:56,740 --> 00:09:58,050
[Music]

259
00:09:58,050 --> 00:10:00,550
that needs our authentication so I open

260
00:10:00,550 --> 00:10:01,569
up my laptop in it

261
00:10:01,569 --> 00:10:04,119
and maybe I close it and I don't

262
00:10:04,119 --> 00:10:05,949
actually authenticate or I could see

263
00:10:05,949 --> 00:10:07,839
these these are cleanse occasion records

264
00:10:07,839 --> 00:10:08,980
in here ok

265
00:10:08,980 --> 00:10:11,290
it actually logged on to the system in

266
00:10:11,290 --> 00:10:13,689
some way and I can use these I can pull

267
00:10:13,689 --> 00:10:15,850
like these of system logs a couple of

268
00:10:15,850 --> 00:10:17,439
other different system logs as well and

269
00:10:17,439 --> 00:10:20,129
try to put that story together

270
00:10:20,129 --> 00:10:24,490
all right now downloaded files so this

271
00:10:24,490 --> 00:10:27,189
one is interesting that timestamps for

272
00:10:27,189 --> 00:10:29,019
this one or if it's spring and I'm not

273
00:10:29,019 --> 00:10:31,149
quite sure I mean to ask me about some

274
00:10:31,149 --> 00:10:32,559
of those time stamps a little bit later

275
00:10:32,559 --> 00:10:36,399
so these are showing downloaded files

276
00:10:36,399 --> 00:10:38,529
and it's not every single downloaded

277
00:10:38,529 --> 00:10:41,529
file again probably more or less the

278
00:10:41,529 --> 00:10:44,049
first three minutes or so of the

279
00:10:44,049 --> 00:10:45,759
particular device they opened up and

280
00:10:45,759 --> 00:10:47,949
authenticated to but this is going to

281
00:10:47,949 --> 00:10:49,990
show me potentially files that are being

282
00:10:49,990 --> 00:10:51,610
synced so when you open up your laptop

283
00:10:51,610 --> 00:10:53,350
for the first time and it has an

284
00:10:53,350 --> 00:10:54,160
internet connection

285
00:10:54,160 --> 00:10:57,759
it wants to sync everything I have some

286
00:10:57,759 --> 00:11:01,779
ICS files here and just through they do

287
00:11:01,779 --> 00:11:04,179
on here I got some ICS file these are my

288
00:11:04,179 --> 00:11:06,339
calendar events each one of these is a

289
00:11:06,339 --> 00:11:07,899
separate event we would like to be

290
00:11:07,899 --> 00:11:09,910
synced across devices to get iCloud

291
00:11:09,910 --> 00:11:10,720
turned on

292
00:11:10,720 --> 00:11:13,660
things are sinking all the time I got a

293
00:11:13,660 --> 00:11:16,000
few other things under message messages

294
00:11:16,000 --> 00:11:17,800
and attachments so I'm chatting back and

295
00:11:17,800 --> 00:11:20,320
forth maybe on my phone once I open up

296
00:11:20,320 --> 00:11:21,220
my laptop

297
00:11:21,220 --> 00:11:23,710
it wants to sync and bring down want to

298
00:11:23,710 --> 00:11:26,380
get files and picture files those will

299
00:11:26,380 --> 00:11:28,710
get synced and push down to the device

300
00:11:28,710 --> 00:11:32,050
what else like a man course mail wants

301
00:11:32,050 --> 00:11:33,760
to sync and pull down different

302
00:11:33,760 --> 00:11:35,620
attachments and things so if I'm looking

303
00:11:35,620 --> 00:11:37,990
for maybe malicious attachments look for

304
00:11:37,990 --> 00:11:39,640
those that are going to be stored in

305
00:11:39,640 --> 00:11:41,710
there when we have some more ICS file -

306
00:11:41,710 --> 00:11:43,480
right at the end they get a whole

307
00:11:43,480 --> 00:11:46,210
variety of different things but how the

308
00:11:46,210 --> 00:11:47,890
system works it's going to get first

309
00:11:47,890 --> 00:11:50,110
three minutes generally speaking of

310
00:11:50,110 --> 00:11:53,770
stuff being synced to it next one is

311
00:11:53,770 --> 00:11:56,560
block block block block is trying to

312
00:11:56,560 --> 00:11:59,310
block things imagine that oh well names

313
00:11:59,310 --> 00:12:03,520
so it's basically saying it's I can't

314
00:12:03,520 --> 00:12:05,050
believe should I get the screenshot here

315
00:12:05,050 --> 00:12:08,050
that this background tax management

316
00:12:08,050 --> 00:12:11,410
agent is kind of saying hey micro snitch

317
00:12:11,410 --> 00:12:14,470
wants to create a login helper labs or

318
00:12:14,470 --> 00:12:15,880
talk about persistence points we've

319
00:12:15,880 --> 00:12:19,300
talked about launch agents Damons exbc

320
00:12:19,300 --> 00:12:21,430
services login items all sorts of

321
00:12:21,430 --> 00:12:23,590
different persistence points block lock

322
00:12:23,590 --> 00:12:25,270
is going to tell me when each of those

323
00:12:25,270 --> 00:12:28,030
or attempting to be installed so

324
00:12:28,030 --> 00:12:29,770
certainly I want to get a record of that

325
00:12:29,770 --> 00:12:31,450
maybe I want to know when odd thing will

326
00:12:31,450 --> 00:12:34,810
install on that system yes login is

327
00:12:34,810 --> 00:12:37,570
logging is enabled it creates a

328
00:12:37,570 --> 00:12:39,940
beautiful law class that timestamps it

329
00:12:39,940 --> 00:12:42,430
shows me that words if a micro snitch

330
00:12:42,430 --> 00:12:44,200
app wanted to install this launched

331
00:12:44,200 --> 00:12:46,570
we're seeing this login item and it

332
00:12:46,570 --> 00:12:48,310
shows me whether the user clicked allow

333
00:12:48,310 --> 00:12:51,670
or deny in this case I click allow one

334
00:12:51,670 --> 00:12:53,440
to do a bit of research into that

335
00:12:53,440 --> 00:12:57,339
particular application however I don't

336
00:12:57,339 --> 00:12:59,850
believe logging is turned on by default

337
00:12:59,850 --> 00:13:02,380
fortunately it gets logged into the

338
00:13:02,380 --> 00:13:05,320
unified log so in case the user just

339
00:13:05,320 --> 00:13:07,390
ensuring that lead checkbox on that's

340
00:13:07,390 --> 00:13:09,310
fine I get all the unified logged

341
00:13:09,310 --> 00:13:11,080
versions of that as well

342
00:13:11,080 --> 00:13:13,839
okay kind of get a better historical

343
00:13:13,839 --> 00:13:16,120
view now unified nouns are not kept

344
00:13:16,120 --> 00:13:19,180
around forever may be anywhere from four

345
00:13:19,180 --> 00:13:22,240
to six weeks depending on the usage of

346
00:13:22,240 --> 00:13:23,440
the system but

347
00:13:23,440 --> 00:13:24,940
what amount of time to show me

348
00:13:24,940 --> 00:13:28,420
historical persistence mechanisms have

349
00:13:28,420 --> 00:13:31,089
been installed on the system and a

350
00:13:31,089 --> 00:13:32,889
little bit that the puppets key here but

351
00:13:32,889 --> 00:13:34,750
we have things like kernel extensions

352
00:13:34,750 --> 00:13:38,350
launch statements and we got the login

353
00:13:38,350 --> 00:13:41,290
icon from micro switch right at the end

354
00:13:41,290 --> 00:13:43,930
there so it's going to show me who is 20

355
00:13:43,930 --> 00:13:45,160
installers is it an installer

356
00:13:45,160 --> 00:13:48,459
application I have been CP here and

357
00:13:48,459 --> 00:13:50,620
installed launch date in its final for

358
00:13:50,620 --> 00:13:53,170
Microsoft auto updates I have some

359
00:13:53,170 --> 00:13:54,639
kernel extensions that are being

360
00:13:54,639 --> 00:13:57,310
installed by so folks installer so this

361
00:13:57,310 --> 00:13:58,720
has been strong with a variety of

362
00:13:58,720 --> 00:14:01,360
different antivirus products on my

363
00:14:01,360 --> 00:14:03,519
system and each one of those is way to

364
00:14:03,519 --> 00:14:06,370
install usually at least one different

365
00:14:06,370 --> 00:14:08,230
launch agent or persistence mechanisms

366
00:14:08,230 --> 00:14:09,550
fun fact

367
00:14:09,550 --> 00:14:11,439
and evil are running and I think I had

368
00:14:11,439 --> 00:14:12,939
five different evenings on my system

369
00:14:12,939 --> 00:14:16,120
right now if that system does not work

370
00:14:16,120 --> 00:14:18,759
really well I haven't ever had my system

371
00:14:18,759 --> 00:14:21,790
reboot more couple of weeks or so then

372
00:14:21,790 --> 00:14:23,319
when I had all those Asian products

373
00:14:23,319 --> 00:14:25,990
basically playing together that's like

374
00:14:25,990 --> 00:14:31,600
what recommended to run my movie next up

375
00:14:31,600 --> 00:14:33,850
we got the Lulu firewall so three

376
00:14:33,850 --> 00:14:37,089
firewall I love that it is free I love

377
00:14:37,089 --> 00:14:40,139
that it creates an extremely detailed

378
00:14:40,139 --> 00:14:43,569
firewall log we need that log so this

379
00:14:43,569 --> 00:14:45,189
one's going to keep track of not just

380
00:14:45,189 --> 00:14:46,930
the firewall status again I'm watching

381
00:14:46,930 --> 00:14:49,750
know if it's off if I'm noticing a lack

382
00:14:49,750 --> 00:14:52,779
of longing yeah yeah but it's just going

383
00:14:52,779 --> 00:14:54,009
to show me different software

384
00:14:54,009 --> 00:14:55,899
installations what's the user installing

385
00:14:55,899 --> 00:14:57,189
did you need to know that they're

386
00:14:57,189 --> 00:14:58,329
installing is it somebody else

387
00:14:58,329 --> 00:15:00,100
installing it for them

388
00:15:00,100 --> 00:15:03,430
which user is it under so I got user 501

389
00:15:03,430 --> 00:15:05,319
here if I have tried Oh two three four

390
00:15:05,319 --> 00:15:05,889
and so on

391
00:15:05,889 --> 00:15:07,660
now I can start figuring out which

392
00:15:07,660 --> 00:15:09,250
account is doing the software

393
00:15:09,250 --> 00:15:12,269
installations where it's installing from

394
00:15:12,269 --> 00:15:14,470
where it or it came from some IP

395
00:15:14,470 --> 00:15:17,050
addresses important information so this

396
00:15:17,050 --> 00:15:19,420
is B Eckstein is one of my favorites

397
00:15:19,420 --> 00:15:22,569
doing X forensic analysis tools I need

398
00:15:22,569 --> 00:15:24,759
it all the time and that one's coming

399
00:15:24,759 --> 00:15:29,139
down from github user content calm so I

400
00:15:29,139 --> 00:15:30,370
can start looking at things that are

401
00:15:30,370 --> 00:15:32,050
installed start seeing where they

402
00:15:32,050 --> 00:15:34,120
originating from are those malicious

403
00:15:34,120 --> 00:15:35,340
things are they

404
00:15:35,340 --> 00:15:38,070
or both sizes it's something that's I

405
00:15:38,070 --> 00:15:40,640
should potentially take a closer look at

406
00:15:40,640 --> 00:15:42,720
process information they also get some

407
00:15:42,720 --> 00:15:44,370
signing and some entitlement information

408
00:15:44,370 --> 00:15:46,529
that can give you an idea is this thing

409
00:15:46,529 --> 00:15:48,150
malicious or not depending on which

410
00:15:48,150 --> 00:15:50,400
entitlements it's requiring and then

411
00:15:50,400 --> 00:15:52,339
again we also have a bundle identifier

412
00:15:52,339 --> 00:15:54,630
okay one dollar identifier everything

413
00:15:54,630 --> 00:15:56,400
has a bundle identifier when we're

414
00:15:56,400 --> 00:15:58,020
talking about forensic analysis that

415
00:15:58,020 --> 00:16:00,930
bundle identifier is super useful I will

416
00:16:00,930 --> 00:16:02,490
take that and start to cross the whole

417
00:16:02,490 --> 00:16:04,140
system and it will just pop up

418
00:16:04,140 --> 00:16:06,390
everywhere different databases plist

419
00:16:06,390 --> 00:16:08,730
files log files it is the main

420
00:16:08,730 --> 00:16:11,160
identifier for that app so if it's

421
00:16:11,160 --> 00:16:12,150
something that I'm particularly

422
00:16:12,150 --> 00:16:15,029
interested in I can look for that and

423
00:16:15,029 --> 00:16:16,980
see what it was installed what user

424
00:16:16,980 --> 00:16:18,450
interaction they had with it they have

425
00:16:18,450 --> 00:16:20,400
it open all the time looking the token

426
00:16:20,400 --> 00:16:21,990
coming out and now it's the database to

427
00:16:21,990 --> 00:16:24,330
see how often they use a particular app

428
00:16:24,330 --> 00:16:25,500
was it a one-shot deal

429
00:16:25,500 --> 00:16:27,779
was it something they use every day that

430
00:16:27,779 --> 00:16:29,279
kind of powder and black information

431
00:16:29,279 --> 00:16:32,510
could also be very very useful

432
00:16:32,510 --> 00:16:37,020
my next one is oversight so oversight is

433
00:16:37,020 --> 00:16:39,089
going to keep track of your camera and

434
00:16:39,089 --> 00:16:40,470
your microphone they're being recorded

435
00:16:40,470 --> 00:16:41,400
or not

436
00:16:41,400 --> 00:16:42,870
most folks wouldn't want to know if

437
00:16:42,870 --> 00:16:45,510
they're being recorded lovely look

438
00:16:45,510 --> 00:16:47,370
little log file here called oversight

439
00:16:47,370 --> 00:16:49,500
blog so this one is keeping track of

440
00:16:49,500 --> 00:16:53,670
which thing is being used and this the

441
00:16:53,670 --> 00:16:55,860
first two entries here we're both seeing

442
00:16:55,860 --> 00:16:59,250
FaceTime HD camera which is the camera

443
00:16:59,250 --> 00:17:01,560
front casing on the laptop lid right

444
00:17:01,560 --> 00:17:04,650
here now I for some reason always click

445
00:17:04,650 --> 00:17:07,439
the face client like on every single

446
00:17:07,439 --> 00:17:08,760
time of course if you don't like a

447
00:17:08,760 --> 00:17:10,079
little blocker there and seen your

448
00:17:10,079 --> 00:17:11,790
double chin face and you're like oh I

449
00:17:11,790 --> 00:17:14,250
don't need to see that at all so each

450
00:17:14,250 --> 00:17:16,170
time I could use that one

451
00:17:16,170 --> 00:17:18,480
I clicked block because it's right next

452
00:17:18,480 --> 00:17:20,730
to another another application I use all

453
00:17:20,730 --> 00:17:22,890
the time I should just learn take that

454
00:17:22,890 --> 00:17:26,220
off my doc I never actually do but what

455
00:17:26,220 --> 00:17:28,439
I do want to use the camera things like

456
00:17:28,439 --> 00:17:29,730
GoToMeeting

457
00:17:29,730 --> 00:17:34,020
maybe I got them you know a presentation

458
00:17:34,020 --> 00:17:35,460
that I have to do for the stands or

459
00:17:35,460 --> 00:17:37,170
something they want to see my face

460
00:17:37,170 --> 00:17:38,940
I want to enable the camera so they can

461
00:17:38,940 --> 00:17:41,040
see my double chin and all that good

462
00:17:41,040 --> 00:17:43,800
stuff in great glorious detail so I've

463
00:17:43,800 --> 00:17:46,770
selected clicked allow for that one so

464
00:17:46,770 --> 00:17:48,060
it shows me that user in

465
00:17:48,060 --> 00:17:51,060
action it may be mistaken we use or was

466
00:17:51,060 --> 00:17:55,380
intentionally used next one so that is

467
00:17:55,380 --> 00:17:56,760
it could be objective-c tools Thank You

468
00:17:56,760 --> 00:17:59,220
Patrick for that love those Burnett

469
00:17:59,220 --> 00:18:02,250
artifacts next one is Little Snitch now

470
00:18:02,250 --> 00:18:03,330
Little Snitch

471
00:18:03,330 --> 00:18:05,490
is a big program there's a lot of stuff

472
00:18:05,490 --> 00:18:07,290
going on with that what I have found

473
00:18:07,290 --> 00:18:08,940
with a lot of these applications is that

474
00:18:08,940 --> 00:18:10,890
a lot of those databases are encrypted

475
00:18:10,890 --> 00:18:13,320
or office data this was one of them I

476
00:18:13,320 --> 00:18:15,240
was like oh that's really I mean it

477
00:18:15,240 --> 00:18:17,010
makes me quite sad that means I don't

478
00:18:17,010 --> 00:18:18,990
get the threads of artifacts but all the

479
00:18:18,990 --> 00:18:21,270
tracking that it actually does well I

480
00:18:21,270 --> 00:18:23,610
could they do a little bit more work but

481
00:18:23,610 --> 00:18:25,940
I'm looking for quick wins in this case

482
00:18:25,940 --> 00:18:28,230
so I'm looking specifically for the

483
00:18:28,230 --> 00:18:30,450
Network Monitor information so it's able

484
00:18:30,450 --> 00:18:33,300
to extract some of the information from

485
00:18:33,300 --> 00:18:35,760
that because it is keeping it in a nice

486
00:18:35,760 --> 00:18:38,580
plain text lock no decryption no can't

487
00:18:38,580 --> 00:18:40,860
see anything that needs to be showing

488
00:18:40,860 --> 00:18:43,200
there and when you just open this one up

489
00:18:43,200 --> 00:18:46,410
a little bit so this is logging with

490
00:18:46,410 --> 00:18:47,730
different versions of little snips you

491
00:18:47,730 --> 00:18:49,230
are running which is nice for versioning

492
00:18:49,230 --> 00:18:50,460
maybe there's some bugs or something

493
00:18:50,460 --> 00:18:52,230
that you need to take a look at but also

494
00:18:52,230 --> 00:18:54,120
network connections and network

495
00:18:54,120 --> 00:18:56,370
connections sometimes by an application

496
00:18:56,370 --> 00:18:58,530
by which is quite useful so I might

497
00:18:58,530 --> 00:19:00,330
peruse this list and see if anything

498
00:19:00,330 --> 00:19:03,900
looks malicious looks weird as far as I

499
00:19:03,900 --> 00:19:06,240
know that these are all clean as far as

500
00:19:06,240 --> 00:19:08,550
I know but things like that I'm looking

501
00:19:08,550 --> 00:19:10,440
for Safari it's going to Squarespace

502
00:19:10,440 --> 00:19:13,020
it's going to Dropbox okay that makes

503
00:19:13,020 --> 00:19:15,530
perfect sense but maybe I followed a

504
00:19:15,530 --> 00:19:18,180
Dropbox malicious Dropbox link or

505
00:19:18,180 --> 00:19:19,980
something like that and unintentionally

506
00:19:19,980 --> 00:19:21,360
installed some software that I would

507
00:19:21,360 --> 00:19:24,030
then watch it so I can always use these

508
00:19:24,030 --> 00:19:25,740
for different kind of pivot points

509
00:19:25,740 --> 00:19:27,600
looking here I want to look for more

510
00:19:27,600 --> 00:19:32,209
malicious factors a little bit later on

511
00:19:32,720 --> 00:19:35,520
now it's so close so I chose so close

512
00:19:35,520 --> 00:19:38,490
again I installed five different ones a

513
00:19:38,490 --> 00:19:40,200
lot of them or sponsors I basically

514
00:19:40,200 --> 00:19:42,300
looked at all the different AV companies

515
00:19:42,300 --> 00:19:44,220
that were either attending or speaking

516
00:19:44,220 --> 00:19:46,260
or sponsoring this conference United

517
00:19:46,260 --> 00:19:49,050
States or again it's one recommended

518
00:19:49,050 --> 00:19:51,720
some applications are better at logging

519
00:19:51,720 --> 00:19:53,610
than others some of them are better at

520
00:19:53,610 --> 00:19:56,340
logging encrypted versus on encrypted so

521
00:19:56,340 --> 00:19:57,960
every app is maybe different you just

522
00:19:57,960 --> 00:19:59,970
don't know until you take a look at it

523
00:19:59,970 --> 00:20:01,400
so I chose one

524
00:20:01,400 --> 00:20:03,950
and so this was the lucky winner of this

525
00:20:03,950 --> 00:20:07,340
one so so post likes to store a lot of

526
00:20:07,340 --> 00:20:10,040
XP vents and simply a sequel like

527
00:20:10,040 --> 00:20:12,710
database called events got me be like

528
00:20:12,710 --> 00:20:14,990
that sequel like databases they're

529
00:20:14,990 --> 00:20:16,910
they're great for now Cynthia you open

530
00:20:16,910 --> 00:20:18,890
it up there's a bunch of tables some

531
00:20:18,890 --> 00:20:21,620
condition be more useful to others so

532
00:20:21,620 --> 00:20:23,660
this one is pretty much keeping track of

533
00:20:23,660 --> 00:20:26,059
what's being found on the system what's

534
00:20:26,059 --> 00:20:27,590
being quarantined what's being flagged

535
00:20:27,590 --> 00:20:30,470
as a potential problem so I got my

536
00:20:30,470 --> 00:20:32,780
little query here and Z detection path

537
00:20:32,780 --> 00:20:35,240
is keeping track of where this

538
00:20:35,240 --> 00:20:38,210
particular malicious file was and this

539
00:20:38,210 --> 00:20:40,070
is useful for me I don't care if it's

540
00:20:40,070 --> 00:20:41,510
cleaned up or actually infected the

541
00:20:41,510 --> 00:20:44,920
device but it might show me where files

542
00:20:44,920 --> 00:20:47,660
action work so maybe if I'm looking for

543
00:20:47,660 --> 00:20:49,820
anime attack that that was sent there

544
00:20:49,820 --> 00:20:52,190
months ago it might be gone now and let

545
00:20:52,190 --> 00:20:54,230
cleaned up but I still have record of a

546
00:20:54,230 --> 00:20:56,000
lot of that within these log files so I

547
00:20:56,000 --> 00:20:58,820
will look for you know historic evidence

548
00:20:58,820 --> 00:21:02,660
in some cases other things here you know

549
00:21:02,660 --> 00:21:04,040
downloads directory that's going to be

550
00:21:04,040 --> 00:21:06,320
an easily target targeting directory

551
00:21:06,320 --> 00:21:09,200
quilty some malware only because users

552
00:21:09,200 --> 00:21:10,670
like to click things and where does it

553
00:21:10,670 --> 00:21:13,340
go by default generally to the Downloads

554
00:21:13,340 --> 00:21:15,140
directory select a nice button right

555
00:21:15,140 --> 00:21:15,440
there

556
00:21:15,440 --> 00:21:18,559
we have example of Glasser as' and then

557
00:21:18,559 --> 00:21:20,929
you have things like volumes and so if

558
00:21:20,929 --> 00:21:23,059
things that are plugged in so if so

559
00:21:23,059 --> 00:21:24,590
close in this particular case and wants

560
00:21:24,590 --> 00:21:26,929
to scan everything on that volume that's

561
00:21:26,929 --> 00:21:28,520
great it wants to protect me

562
00:21:28,520 --> 00:21:30,620
so this volume artist was for our

563
00:21:30,620 --> 00:21:32,960
Ethernet works as a sans kind of

564
00:21:32,960 --> 00:21:36,110
gamification of forensic analysis we

565
00:21:36,110 --> 00:21:37,730
have a lot of tools on there you can see

566
00:21:37,730 --> 00:21:39,740
it's picking out some windows specific

567
00:21:39,740 --> 00:21:42,020
tools saying yep that's a that's not

568
00:21:42,020 --> 00:21:43,640
something that you want on your system

569
00:21:43,640 --> 00:21:46,190
there but what this shows me is that is

570
00:21:46,190 --> 00:21:47,660
that thumb drive of potential

571
00:21:47,660 --> 00:21:49,190
investigative view so if that's

572
00:21:49,190 --> 00:21:51,890
something I'm tears of Marcy I might

573
00:21:51,890 --> 00:21:53,390
look to do a keyword search for D for

574
00:21:53,390 --> 00:21:56,030
networks across the whole system and see

575
00:21:56,030 --> 00:21:58,160
how often is them plugged in and use on

576
00:21:58,160 --> 00:22:02,630
that particular device for the record

577
00:22:02,630 --> 00:22:05,530
all this is known malware on my system

578
00:22:05,530 --> 00:22:08,270
yes I take a lot of malware on my system

579
00:22:08,270 --> 00:22:10,429
yeah for fun

580
00:22:10,429 --> 00:22:13,030
all right next one network connections

581
00:22:13,030 --> 00:22:15,710
so a library

582
00:22:15,710 --> 00:22:18,200
you're gonna be so close diagnostic some

583
00:22:18,200 --> 00:22:21,590
numbered genes Eli's a play over they

584
00:22:21,590 --> 00:22:23,600
roll over those logon and archive them

585
00:22:23,600 --> 00:22:25,399
quite a bit so you actually get a pretty

586
00:22:25,399 --> 00:22:28,190
decent historical view of a lot of stuff

587
00:22:28,190 --> 00:22:30,619
that cellphones is logging one of those

588
00:22:30,619 --> 00:22:33,200
is network connections just to zoom in

589
00:22:33,200 --> 00:22:36,080
there a little bit network connections

590
00:22:36,080 --> 00:22:39,080
that's very useful now this is keeping

591
00:22:39,080 --> 00:22:41,389
track of all network connections not

592
00:22:41,389 --> 00:22:43,369
just browser requests not just users

593
00:22:43,369 --> 00:22:45,499
browsing and doing whatever but also

594
00:22:45,499 --> 00:22:47,779
applications and what access they want

595
00:22:47,779 --> 00:22:50,330
through that so I see user and system

596
00:22:50,330 --> 00:22:52,850
level stuff in here so just as an

597
00:22:52,850 --> 00:22:56,570
example I like an arrow a be another

598
00:22:56,570 --> 00:22:58,100
neat me that I have installed in my

599
00:22:58,100 --> 00:22:58,639
system

600
00:22:58,639 --> 00:23:00,200
I can't wait to install most of these

601
00:23:00,200 --> 00:23:02,539
particularly I'm honest with you to keep

602
00:23:02,539 --> 00:23:05,299
my system from rebooting right now so I

603
00:23:05,299 --> 00:23:07,909
got United comp so the time stamps for

604
00:23:07,909 --> 00:23:09,590
this one were on the previous slide so

605
00:23:09,590 --> 00:23:11,450
this was me that's the checking flights

606
00:23:11,450 --> 00:23:14,570
for this trip so I'm on United calm I'm

607
00:23:14,570 --> 00:23:16,429
looking at my seat I'm you know seeing

608
00:23:16,429 --> 00:23:17,869
if I got an upgrade or anything like

609
00:23:17,869 --> 00:23:21,109
that then I got some other stuff going

610
00:23:21,109 --> 00:23:23,149
on the background so for Django here

611
00:23:23,149 --> 00:23:26,299
this is icecap menus so all the meantime

612
00:23:26,299 --> 00:23:28,669
talks that menus it's doing some sort of

613
00:23:28,669 --> 00:23:31,249
communication I'm not telling you what

614
00:23:31,249 --> 00:23:34,059
it is but hopefully it's clearly legit

615
00:23:34,059 --> 00:23:37,489
iCloud that Tom that's good be something

616
00:23:37,489 --> 00:23:39,109
that you're probably gonna find pretty

617
00:23:39,109 --> 00:23:41,899
quickly frequently on Mac devices so I

618
00:23:41,899 --> 00:23:44,779
didn't go explicitly to icloud.com but I

619
00:23:44,779 --> 00:23:46,789
have everything syncing all the time

620
00:23:46,789 --> 00:23:49,129
- oh it's gonna constantly pinging out -

621
00:23:49,129 --> 00:23:51,940
just it's a gateway that icloud.com area

622
00:23:51,940 --> 00:23:54,799
wasn't so post up going on there I was

623
00:23:54,799 --> 00:23:56,980
sending all my data back that's cool

624
00:23:56,980 --> 00:23:59,539
what else we got

625
00:23:59,539 --> 00:24:02,389
iTunes so at the time that I was doing

626
00:24:02,389 --> 00:24:05,779
my flight stuff I was also playing a

627
00:24:05,779 --> 00:24:08,960
playlist I was using Apple music to play

628
00:24:08,960 --> 00:24:10,820
one of my class playlists I want the

629
00:24:10,820 --> 00:24:12,619
students were doing some work so you'll

630
00:24:12,619 --> 00:24:14,749
see that played at iTunes at apple.com

631
00:24:14,749 --> 00:24:16,669
now just knowing what's normal what's

632
00:24:16,669 --> 00:24:18,980
not is gonna be quite useful to figure

633
00:24:18,980 --> 00:24:21,139
out if this news or browsing activity or

634
00:24:21,139 --> 00:24:23,109
is this - maybe the applications

635
00:24:23,109 --> 00:24:25,580
doing some stuff not the best one is

636
00:24:25,580 --> 00:24:28,249
definitely the application so after you

637
00:24:28,249 --> 00:24:28,580
night

638
00:24:28,580 --> 00:24:31,490
I might soon be a accom it's all for

639
00:24:31,490 --> 00:24:33,350
different tours so I spent the last few

640
00:24:33,350 --> 00:24:34,760
days before coming up here to go to

641
00:24:34,760 --> 00:24:37,310
meets I wanted to potentially go on a

642
00:24:37,310 --> 00:24:39,200
wine tour or something like that so I

643
00:24:39,200 --> 00:24:41,450
just doing some research there of course

644
00:24:41,450 --> 00:24:42,830
I can correlate all this would have

645
00:24:42,830 --> 00:24:44,600
things like the browser history the

646
00:24:44,600 --> 00:24:48,100
Safari Safari Chrome whatever these are

647
00:24:48,100 --> 00:24:50,480
not the only places I'm going to find

648
00:24:50,480 --> 00:24:52,850
evidence of this type but the thing that

649
00:24:52,850 --> 00:24:55,460
I really like is having multiple sources

650
00:24:55,460 --> 00:24:57,560
of this data so I can go clear my

651
00:24:57,560 --> 00:25:00,290
browser history it's very very easy to

652
00:25:00,290 --> 00:25:02,000
do users a lot to do that as I'm

653
00:25:02,000 --> 00:25:04,550
contract forensics procedure but they

654
00:25:04,550 --> 00:25:06,110
don't necessarily know this being the

655
00:25:06,110 --> 00:25:08,540
coordinator in other places so it's

656
00:25:08,540 --> 00:25:10,490
being corrected or wipe that will remove

657
00:25:10,490 --> 00:25:13,070
or just overwritten maybe turned out or

658
00:25:13,070 --> 00:25:14,390
something like that I want to have a

659
00:25:14,390 --> 00:25:16,060
backup source or some way to collaborate

660
00:25:16,060 --> 00:25:18,620
all the different types of things going

661
00:25:18,620 --> 00:25:20,090
on which is where the third-party access

662
00:25:20,090 --> 00:25:24,650
is very very useful now it also stores

663
00:25:24,650 --> 00:25:27,350
specific web visits so before it was

664
00:25:27,350 --> 00:25:30,020
just any network connection this one is

665
00:25:30,020 --> 00:25:33,020
specifically browsing information so I

666
00:25:33,020 --> 00:25:34,970
still took this one down I was looking

667
00:25:34,970 --> 00:25:37,850
up Marriott so I was looking up this

668
00:25:37,850 --> 00:25:39,980
hotel like I'm saying right now I wanted

669
00:25:39,980 --> 00:25:42,200
to get all the details I wanted to try

670
00:25:42,200 --> 00:25:44,060
to make the room I want to see what

671
00:25:44,060 --> 00:25:46,040
restaurants they have how expensive the

672
00:25:46,040 --> 00:25:49,490
field is the beach party that we're

673
00:25:49,490 --> 00:25:51,650
rocking out to right now now I want to

674
00:25:51,650 --> 00:25:54,650
find all of that information so this is

675
00:25:54,650 --> 00:25:57,530
me basically going to marry out looking

676
00:25:57,530 --> 00:25:59,690
at the hotel and it's capturing a lot of

677
00:25:59,690 --> 00:26:01,310
the different files that are being

678
00:26:01,310 --> 00:26:04,310
downloaded on there and see some edge

679
00:26:04,310 --> 00:26:06,590
sweet stuff in here so over here we put

680
00:26:06,590 --> 00:26:09,440
some of JPEGs of pictures I think

681
00:26:09,440 --> 00:26:12,710
there's a walk file for some gun font

682
00:26:12,710 --> 00:26:14,810
information in there so you can see all

683
00:26:14,810 --> 00:26:15,890
the different files that are being

684
00:26:15,890 --> 00:26:17,630
stored on there this would be

685
00:26:17,630 --> 00:26:18,890
potentially useful in a drive-by

686
00:26:18,890 --> 00:26:20,900
download if it's got some weird file

687
00:26:20,900 --> 00:26:23,900
that drops down doing whatever exploit

688
00:26:23,900 --> 00:26:26,900
that it's going to do that could be very

689
00:26:26,900 --> 00:26:28,880
useful tweedle to see every little bit

690
00:26:28,880 --> 00:26:31,070
and Bob that's in there it may not

691
00:26:31,070 --> 00:26:35,470
necessarily be cached on the device and

692
00:26:35,470 --> 00:26:38,090
this one so this one is different

693
00:26:38,090 --> 00:26:39,860
processes and I'm going to zoom in again

694
00:26:39,860 --> 00:26:41,300
and what

695
00:26:41,300 --> 00:26:43,010
hurt to see I see a lot of log files I

696
00:26:43,010 --> 00:26:44,360
feel like I'm going to blind a little

697
00:26:44,360 --> 00:26:47,120
bit earlier than than some people by

698
00:26:47,120 --> 00:26:49,130
looking at some of the Sega but we're

699
00:26:49,130 --> 00:26:51,320
looking at some process information here

700
00:26:51,320 --> 00:26:56,390
so this one's an indica an example of me

701
00:26:56,390 --> 00:26:58,850
opening up the terminal application so

702
00:26:58,850 --> 00:27:01,100
applications utilities terminal just

703
00:27:01,100 --> 00:27:03,080
opening that up and then all this other

704
00:27:03,080 --> 00:27:05,120
stuff follows so it's amazing how much

705
00:27:05,120 --> 00:27:07,280
stuff actually happens when you do

706
00:27:07,280 --> 00:27:09,680
something as simple as opening up one

707
00:27:09,680 --> 00:27:12,350
application so showing user bin log in

708
00:27:12,350 --> 00:27:17,000
bash so make there anaconda stuff from

709
00:27:17,000 --> 00:27:19,040
some data analytics so you making stuff

710
00:27:19,040 --> 00:27:21,200
all sorts of different things go on so

711
00:27:21,200 --> 00:27:22,640
seeing that interact and all the

712
00:27:22,640 --> 00:27:25,130
different processes means fun it's quite

713
00:27:25,130 --> 00:27:27,380
quite useful once to see something on

714
00:27:27,380 --> 00:27:29,540
the bundle IDs which is again something

715
00:27:29,540 --> 00:27:30,830
that I'm going to look up it's it's

716
00:27:30,830 --> 00:27:32,990
signed as its you know truly Apple is

717
00:27:32,990 --> 00:27:36,050
it's something that's not signed by

718
00:27:36,050 --> 00:27:39,310
Apple maybe take a closer look at that

719
00:27:39,310 --> 00:27:42,920
and then finally the last app ice that

720
00:27:42,920 --> 00:27:45,050
menus so I don't know if you saw before

721
00:27:45,050 --> 00:27:47,990
but I have a boatload those little icons

722
00:27:47,990 --> 00:27:50,600
right at the top there kappa the marui

723
00:27:50,600 --> 00:27:54,530
the other half are ice at menus so got a

724
00:27:54,530 --> 00:27:56,660
system monitor here now this one is

725
00:27:56,660 --> 00:27:59,000
certainly keeping track of system level

726
00:27:59,000 --> 00:28:02,210
stuff first thing we're talking about is

727
00:28:02,210 --> 00:28:04,700
sleep and shutdown status yeah okay

728
00:28:04,700 --> 00:28:07,400
sleeps chuck guys not super interesting

729
00:28:07,400 --> 00:28:09,500
but this shows me when the user was

730
00:28:09,500 --> 00:28:11,240
potentially active I want to know when

731
00:28:11,240 --> 00:28:13,340
they are hands on keyboard in front of

732
00:28:13,340 --> 00:28:15,770
it doing stuff or if it's just idle

733
00:28:15,770 --> 00:28:18,140
sleeping if it's and they're doing its

734
00:28:18,140 --> 00:28:20,240
own thing so in left hand side we've got

735
00:28:20,240 --> 00:28:23,990
the end that is a sleep table within

736
00:28:23,990 --> 00:28:26,450
this uptime database and it's keeping

737
00:28:26,450 --> 00:28:28,310
track of like sleeping early start and

738
00:28:28,310 --> 00:28:30,860
there's an end and I did the calculation

739
00:28:30,860 --> 00:28:32,720
to figure out how long it's seeking for

740
00:28:32,720 --> 00:28:34,940
so I can get a good idea when this is

741
00:28:34,940 --> 00:28:37,250
some was in use when writing inside

742
00:28:37,250 --> 00:28:39,080
same kind of thing I'm in the uptime

743
00:28:39,080 --> 00:28:42,170
table keeping track of upside so boots

744
00:28:42,170 --> 00:28:43,400
and shutdowns

745
00:28:43,400 --> 00:28:44,750
those are going to be potentially

746
00:28:44,750 --> 00:28:47,450
significant to again I can pull a lot of

747
00:28:47,450 --> 00:28:49,370
the same information for army Unified

748
00:28:49,370 --> 00:28:51,590
logs but again it may not necessarily

749
00:28:51,590 --> 00:28:55,070
stick around so it could be corrupted

750
00:28:55,070 --> 00:28:57,320
but plenty of chocolate log files in the

751
00:28:57,320 --> 00:29:01,940
past now in this one so this is the

752
00:29:01,940 --> 00:29:04,910
bandwidth database we're going to keep

753
00:29:04,910 --> 00:29:06,860
on track a lot of network type of

754
00:29:06,860 --> 00:29:09,170
information here so this one's showing a

755
00:29:09,170 --> 00:29:12,140
different network usage so I have this

756
00:29:12,140 --> 00:29:15,200
it's not the most complex it's a sequel

757
00:29:15,200 --> 00:29:17,540
query but I am pulling together what

758
00:29:17,540 --> 00:29:19,730
three different tables here to correlate

759
00:29:19,730 --> 00:29:21,920
this information so I got starts I got

760
00:29:21,920 --> 00:29:23,810
ends I got the specific interface in

761
00:29:23,810 --> 00:29:26,060
play and I have the name of the access

762
00:29:26,060 --> 00:29:28,010
point that I'm connected to what you're

763
00:29:28,010 --> 00:29:29,780
seeing right here is basically sampling

764
00:29:29,780 --> 00:29:31,970
of me sitting in Zurich Airport waiting

765
00:29:31,970 --> 00:29:34,520
to fly to nice so you know when in

766
00:29:34,520 --> 00:29:36,860
Zurich finish the presentation basically

767
00:29:36,860 --> 00:29:39,290
what happens and then you see right

768
00:29:39,290 --> 00:29:41,750
after I kind of I get to my hotel and I

769
00:29:41,750 --> 00:29:44,180
connect to the Wi-Fi there poor hotel's

770
00:29:44,180 --> 00:29:46,760
guests so we'll show you potentially

771
00:29:46,760 --> 00:29:49,580
locations now conveniently enough they

772
00:29:49,580 --> 00:29:51,590
sort of the SSID there let me take that

773
00:29:51,590 --> 00:29:53,630
I can throw that into the peg leg wiggle

774
00:29:53,630 --> 00:29:56,300
and get the actual location you know is

775
00:29:56,300 --> 00:29:59,450
that the Accord hotels in meats or is it

776
00:29:59,450 --> 00:30:02,240
in Monaco or is it in somewhere else now

777
00:30:02,240 --> 00:30:04,400
I can get a little bit more specific if

778
00:30:04,400 --> 00:30:06,560
that's what I'm looking for let me get

779
00:30:06,560 --> 00:30:08,570
upload and download so it's showing me

780
00:30:08,570 --> 00:30:11,360
how much traffic is then being pushed in

781
00:30:11,360 --> 00:30:13,490
and out of the device at that time if

782
00:30:13,490 --> 00:30:15,320
I'm looking for things like exfiltration

783
00:30:15,320 --> 00:30:17,420
over the network and I see it pick up a

784
00:30:17,420 --> 00:30:19,370
little bit higher than maybe in normal

785
00:30:19,370 --> 00:30:21,110
activity that's going to show me

786
00:30:21,110 --> 00:30:23,420
potentially some access to that also

787
00:30:23,420 --> 00:30:28,190
quite useful Wow next up sleeps and

788
00:30:28,190 --> 00:30:30,980
waits again you know different logs all

789
00:30:30,980 --> 00:30:33,590
August in different ways so they have a

790
00:30:33,590 --> 00:30:35,870
database now we have just the ice that

791
00:30:35,870 --> 00:30:38,690
when you do that log those are just

792
00:30:38,690 --> 00:30:40,310
keeping track of things like

793
00:30:40,310 --> 00:30:42,800
restarts so whenever the system restarts

794
00:30:42,800 --> 00:30:46,570
it starts doing this preparatory up

795
00:30:46,570 --> 00:30:51,410
padding right yeah for padding and then

796
00:30:51,410 --> 00:30:53,030
for padding is preparing

797
00:30:53,030 --> 00:30:54,710
it's smelling like there that knows that

798
00:30:54,710 --> 00:30:57,230
one before but things like the SMC the

799
00:30:57,230 --> 00:30:59,540
network whatever else those log entries

800
00:30:59,540 --> 00:31:01,280
will start upon when we start up a

801
00:31:01,280 --> 00:31:03,230
system and then you have the sleeps in

802
00:31:03,230 --> 00:31:04,970
the wakes and get some time information

803
00:31:04,970 --> 00:31:06,500
associated like that so it's going to

804
00:31:06,500 --> 00:31:07,640
show it to me in a fairly good

805
00:31:07,640 --> 00:31:08,850
historical

806
00:31:08,850 --> 00:31:13,289
Manor all that kind of information and

807
00:31:13,289 --> 00:31:15,360
then we have power status so whether or

808
00:31:15,360 --> 00:31:18,029
not the system is plugged in or not so

809
00:31:18,029 --> 00:31:20,759
mobile devices their mobile not plugged

810
00:31:20,759 --> 00:31:23,580
in right now so I am in unplug status

811
00:31:23,580 --> 00:31:25,110
this is going to show me potentially the

812
00:31:25,110 --> 00:31:27,389
user on the move or they tether to some

813
00:31:27,389 --> 00:31:29,880
sort of power source so use this one for

814
00:31:29,880 --> 00:31:32,429
iOS quite a lot same thing for Mac

815
00:31:32,429 --> 00:31:34,769
devices I want to know what is the power

816
00:31:34,769 --> 00:31:36,750
status of this you know hutchins folks

817
00:31:36,750 --> 00:31:39,029
basically say that device was dead and a

818
00:31:39,029 --> 00:31:40,830
given point in time I'm going to go back

819
00:31:40,830 --> 00:31:42,210
here I'm going to look at the timing in

820
00:31:42,210 --> 00:31:45,330
question and see was this plugged in or

821
00:31:45,330 --> 00:31:47,549
not are they lying to me or not

822
00:31:47,549 --> 00:31:49,289
now a lot of the different stuff stored

823
00:31:49,289 --> 00:31:51,690
for I stats is keep being keep tracking

824
00:31:51,690 --> 00:31:54,509
to a variety of different tables sorted

825
00:31:54,509 --> 00:31:57,750
by hour day week and month so it's

826
00:31:57,750 --> 00:32:00,299
basically giving statistics for all that

827
00:32:00,299 --> 00:32:01,080
information

828
00:32:01,080 --> 00:32:03,269
meaning it's storing the data for all

829
00:32:03,269 --> 00:32:04,980
that information so we do have about a

830
00:32:04,980 --> 00:32:07,950
month's worth max for a lot of that type

831
00:32:07,950 --> 00:32:13,289
of data then we have discs as this one I

832
00:32:13,289 --> 00:32:16,320
really like maybe this status yeah it

833
00:32:16,320 --> 00:32:18,029
doesn't seem that interesting but this

834
00:32:18,029 --> 00:32:20,009
hasn't shown me if the vices had been

835
00:32:20,009 --> 00:32:21,690
plugged into the system I don't know

836
00:32:21,690 --> 00:32:22,830
what devices I'm gonna have to do

837
00:32:22,830 --> 00:32:25,080
additional analysis but the two that are

838
00:32:25,080 --> 00:32:27,659
highlighted here are two thumb drives

839
00:32:27,659 --> 00:32:29,730
that connect it doesn't show me the

840
00:32:29,730 --> 00:32:33,899
volume name but this b14 goods here have

841
00:32:33,899 --> 00:32:35,909
scattered throughout this is my home

842
00:32:35,909 --> 00:32:37,889
system this is the internal drive of my

843
00:32:37,889 --> 00:32:40,049
systems and I think with the volume of

844
00:32:40,049 --> 00:32:42,960
the UID my internal drive now many of

845
00:32:42,960 --> 00:32:44,759
these two other ones and they're two

846
00:32:44,759 --> 00:32:48,480
different devices we have size use space

847
00:32:48,480 --> 00:32:50,850
and free space now I can see how big

848
00:32:50,850 --> 00:32:52,500
with the thumb drive when I plugged in

849
00:32:52,500 --> 00:32:55,139
these are 264 big thumb drives they're

850
00:32:55,139 --> 00:32:57,480
both two different 64 big thumb drives

851
00:32:57,480 --> 00:32:59,549
well I can also look at how much that of

852
00:32:59,549 --> 00:33:02,039
that drive is used if I look at the

853
00:33:02,039 --> 00:33:04,620
space in there so useful for things like

854
00:33:04,620 --> 00:33:07,350
exfil rows a thumb where I plugged in

855
00:33:07,350 --> 00:33:09,269
that's completely empty and then maybe

856
00:33:09,269 --> 00:33:10,950
out the Sun useful about depositing

857
00:33:10,950 --> 00:33:13,019
moved over things like that could be

858
00:33:13,019 --> 00:33:17,909
potentially even investigate abuse and

859
00:33:17,909 --> 00:33:19,620
then we have the weather I do like the

860
00:33:19,620 --> 00:33:22,230
weather anyone so I do maybe

861
00:33:22,230 --> 00:33:25,200
the extra couple dollars I think for the

862
00:33:25,200 --> 00:33:26,910
wet weather service because I don't know

863
00:33:26,910 --> 00:33:28,650
it's gonna be sunny you know I don't

864
00:33:28,650 --> 00:33:31,320
think I see the outside very much more

865
00:33:31,320 --> 00:33:33,650
so this past week than any week before

866
00:33:33,650 --> 00:33:36,510
so go to the weather there it's going to

867
00:33:36,510 --> 00:33:38,490
show me what the local weather is it's

868
00:33:38,490 --> 00:33:40,860
automatically looking for wherever I am

869
00:33:40,860 --> 00:33:42,840
it's basically you know clearing what

870
00:33:42,840 --> 00:33:45,000
location I'm currently at and it's

871
00:33:45,000 --> 00:33:47,310
keeping track of this for whatever

872
00:33:47,310 --> 00:33:49,200
reason it but I'm very happy that it

873
00:33:49,200 --> 00:33:51,000
keeps track of this getting user

874
00:33:51,000 --> 00:33:53,220
location and fairly accurate user

875
00:33:53,220 --> 00:33:55,590
location is not the easiest thing it's

876
00:33:55,590 --> 00:33:58,650
useful on iOS devices but I'm Mac OS not

877
00:33:58,650 --> 00:34:00,480
a lot of stuff is being stored in

878
00:34:00,480 --> 00:34:03,180
readable format so this one you can see

879
00:34:03,180 --> 00:34:06,660
it's fetching weather for the ocean and

880
00:34:06,660 --> 00:34:09,210
then we get some coordinates here now

881
00:34:09,210 --> 00:34:11,120
these coordinates are being saved as

882
00:34:11,120 --> 00:34:14,130
longitude and latitude you got to flip

883
00:34:14,130 --> 00:34:16,050
them around a little bit there most of

884
00:34:16,050 --> 00:34:17,370
the times you see coordinates latitude

885
00:34:17,370 --> 00:34:19,830
longitude you just have to know where

886
00:34:19,830 --> 00:34:21,360
they are if you just made the assumption

887
00:34:21,360 --> 00:34:24,000
that we're at seven point four and forty

888
00:34:24,000 --> 00:34:25,530
three it's gonna end up in the Indian

889
00:34:25,530 --> 00:34:26,940
Ocean or something like that

890
00:34:26,940 --> 00:34:30,989
one in fact we are right here so cook

891
00:34:30,989 --> 00:34:33,090
those map them in there not throw

892
00:34:33,090 --> 00:34:35,130
there's a Google Maps and it is this

893
00:34:35,130 --> 00:34:36,989
looks Alex me basically sitting out

894
00:34:36,989 --> 00:34:40,409
there finishing this presentation does

895
00:34:40,409 --> 00:34:42,300
anybody notice anything about the the

896
00:34:42,300 --> 00:34:47,520
coordinates here and the hotel what's

897
00:34:47,520 --> 00:34:50,730
the name of the bar yeah I was like

898
00:34:50,730 --> 00:34:53,340
perfect that makes the best screenshot

899
00:34:53,340 --> 00:34:55,889
as we get the seven degrees that that

900
00:34:55,889 --> 00:34:57,840
bar it's literally right out there right

901
00:34:57,840 --> 00:35:01,880
now so that's it for my presentation

902
00:35:01,880 --> 00:35:04,140
basically I want to look at different

903
00:35:04,140 --> 00:35:05,040
types of logs data

904
00:35:05,040 --> 00:35:06,870
I wanted a specifically third-party data

905
00:35:06,870 --> 00:35:08,760
it's not investigated as much as a lot

906
00:35:08,760 --> 00:35:10,410
of being internals in the native stuff

907
00:35:10,410 --> 00:35:12,630
is research but I'm looking for

908
00:35:12,630 --> 00:35:14,220
different pivot points maybe for

909
00:35:14,220 --> 00:35:15,660
criminal activity maybe form our

910
00:35:15,660 --> 00:35:17,970
intrusion type of activity I want to

911
00:35:17,970 --> 00:35:19,500
know you know where was the user how

912
00:35:19,500 --> 00:35:21,360
many honey volume did that have access

913
00:35:21,360 --> 00:35:23,790
to much data was storing said bodies did

914
00:35:23,790 --> 00:35:26,310
they download anything that they know it

915
00:35:26,310 --> 00:35:27,900
was malicious the day it's fallen anyway

916
00:35:27,900 --> 00:35:29,700
I don't know how many different rooted

917
00:35:29,700 --> 00:35:31,830
cases I've just looked at the ami logs

918
00:35:31,830 --> 00:35:33,960
or crash logs and found the malware and

919
00:35:33,960 --> 00:35:36,000
it just like yep that's all

920
00:35:36,000 --> 00:35:38,099
I didn't know what it meant though I'm

921
00:35:38,099 --> 00:35:39,900
like why did you keep installing it why

922
00:35:39,900 --> 00:35:41,190
don't you remove it from your system

923
00:35:41,190 --> 00:35:43,260
make me I got a little bit easier as an

924
00:35:43,260 --> 00:35:45,000
analyst but you know that's something

925
00:35:45,000 --> 00:35:48,030
that is also locked into the system so

926
00:35:48,030 --> 00:35:49,520
you could certainly find me on Twitter I

927
00:35:49,520 --> 00:35:52,980
have my Dan's open so feel free to say

928
00:35:52,980 --> 00:35:55,650
hi my blog in presentations as well as

929
00:35:55,650 --> 00:35:57,390
most of my friends at research that's

930
00:35:57,390 --> 00:35:58,950
already out there on my Mac forensics

931
00:35:58,950 --> 00:36:00,869
blog and if you'd like to take the class

932
00:36:00,869 --> 00:36:02,220
and kind of get into some in-depth

933
00:36:02,220 --> 00:36:04,320
forensic stuff when I make everybody use

934
00:36:04,320 --> 00:36:05,609
a command line class and have no

935
00:36:05,609 --> 00:36:07,770
apologies with that it's not just in a

936
00:36:07,770 --> 00:36:09,900
class in that class we get really

937
00:36:09,900 --> 00:36:12,390
in-depth in there you can find out more

938
00:36:12,390 --> 00:36:15,660
information on the x58 teen.com website

939
00:36:15,660 --> 00:36:18,210
so don't want to take up much more your

940
00:36:18,210 --> 00:36:19,890
time but I've run over a little bit but

941
00:36:19,890 --> 00:36:21,930
thanks for coming out and I'll be at the

942
00:36:21,930 --> 00:36:24,799
party later on tonight

