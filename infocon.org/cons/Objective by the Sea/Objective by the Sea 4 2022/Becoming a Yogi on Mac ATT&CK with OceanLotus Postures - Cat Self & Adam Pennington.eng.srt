1
00:00:04,319 --> 00:00:07,040
the content we had to attack today

2
00:00:07,040 --> 00:00:08,880
is coming from members of the community

3
00:00:08,880 --> 00:00:10,960
like you and the reporting that we're

4
00:00:10,960 --> 00:00:13,599
adding to attack and the information is

5
00:00:13,599 --> 00:00:15,759
especially and especially in the mac os

6
00:00:15,759 --> 00:00:17,840
space coming from

7
00:00:17,840 --> 00:00:20,720
people in this room

8
00:00:21,680 --> 00:00:24,080
so if you see an attack this eye chart

9
00:00:24,080 --> 00:00:26,560
is probably the shape that you've seen

10
00:00:26,560 --> 00:00:29,439
before looks like an excel spreadsheet

11
00:00:29,439 --> 00:00:31,279
and so this is the attack for enterprise

12
00:00:31,279 --> 00:00:33,680
matrix this is covering windows linux

13
00:00:33,680 --> 00:00:37,120
mac cloud containers network devices

14
00:00:37,120 --> 00:00:40,160
all sorts of stuff mashed together

15
00:00:40,160 --> 00:00:42,559
what we're really interested in today is

16
00:00:42,559 --> 00:00:44,640
attack for mac os

17
00:00:44,640 --> 00:00:46,160
uh so we actually saw some tweets come

18
00:00:46,160 --> 00:00:47,520
out some people are excited that we're

19
00:00:47,520 --> 00:00:50,879
finally releasing a mac os matrix

20
00:00:50,879 --> 00:00:54,800
this has actually been out since 2017.

21
00:00:54,800 --> 00:00:56,879
cody thomas who's here in the room

22
00:00:56,879 --> 00:00:58,719
actually led the original development of

23
00:00:58,719 --> 00:01:00,640
attack for macos

24
00:01:00,640 --> 00:01:03,039
but we haven't really focused in on it

25
00:01:03,039 --> 00:01:06,240
done so much until cat joined our team

26
00:01:06,240 --> 00:01:07,840
uh last year

27
00:01:07,840 --> 00:01:10,000
so we're really investing a lot more

28
00:01:10,000 --> 00:01:11,600
effort in trying to make it a first

29
00:01:11,600 --> 00:01:14,960
class citizen in attack

30
00:01:15,119 --> 00:01:16,960
continuing to zoom in

31
00:01:16,960 --> 00:01:18,880
the way attack is organized that it's

32
00:01:18,880 --> 00:01:20,640
broken up into tactics these are the

33
00:01:20,640 --> 00:01:22,720
adversaries technical goals so things

34
00:01:22,720 --> 00:01:24,479
like initial access the adversary is

35
00:01:24,479 --> 00:01:26,799
trying to get into your environment or

36
00:01:26,799 --> 00:01:28,560
persistence the adversary is trying to

37
00:01:28,560 --> 00:01:31,119
stay there

38
00:01:31,759 --> 00:01:33,600
continuing to zoom in

39
00:01:33,600 --> 00:01:35,600
under each of those tactics we have the

40
00:01:35,600 --> 00:01:38,640
core unit of attack which is techniques

41
00:01:38,640 --> 00:01:41,200
so instead of persistence we have hijack

42
00:01:41,200 --> 00:01:43,680
execution flow which is how the goals

43
00:01:43,680 --> 00:01:45,040
are achieved

44
00:01:45,040 --> 00:01:46,720
and about a year ago we added one more

45
00:01:46,720 --> 00:01:49,280
step to the process one layer deeper

46
00:01:49,280 --> 00:01:51,360
which is what we call sub techniques

47
00:01:51,360 --> 00:01:53,680
which is more specific techniques and

48
00:01:53,680 --> 00:01:55,200
this is where we get into a lot of the

49
00:01:55,200 --> 00:01:57,759
operating system specific space

50
00:01:57,759 --> 00:01:58,560
so

51
00:01:58,560 --> 00:02:00,719
a lot of the mac os specific pieces are

52
00:02:00,719 --> 00:02:03,280
found in sort of the sub techniques uh

53
00:02:03,280 --> 00:02:04,719
it also means if you're sort of looking

54
00:02:04,719 --> 00:02:06,479
at kind of the poster the flag of the

55
00:02:06,479 --> 00:02:08,878
matrix you might not see so many mac os

56
00:02:08,878 --> 00:02:11,360
terms but start digging into the sub

57
00:02:11,360 --> 00:02:13,120
techniques and that's that's where

58
00:02:13,120 --> 00:02:16,640
you'll really find the mac os bits and

59
00:02:16,640 --> 00:02:18,640
so instead of hijack execution flow we

60
00:02:18,640 --> 00:02:22,760
have something like dilup hijacking

61
00:02:23,440 --> 00:02:25,520
going behind each of the techniques we

62
00:02:25,520 --> 00:02:27,040
have a decent amount of information

63
00:02:27,040 --> 00:02:28,720
there

64
00:02:28,720 --> 00:02:31,760
we have a text description that is from

65
00:02:31,760 --> 00:02:34,239
an adversary's point of view

66
00:02:34,239 --> 00:02:36,160
of what's being done here so what are

67
00:02:36,160 --> 00:02:37,840
the technical steps that are actually

68
00:02:37,840 --> 00:02:39,040
being taken

69
00:02:39,040 --> 00:02:40,879
why might an adversary do this how might

70
00:02:40,879 --> 00:02:43,440
it be accomplished and so information

71
00:02:43,440 --> 00:02:46,160
that both red teams and defenders might

72
00:02:46,160 --> 00:02:49,040
be able to use to actually look for this

73
00:02:49,040 --> 00:02:52,720
or recreate the technique

74
00:02:53,599 --> 00:02:57,280
all this uses references extensively

75
00:02:57,280 --> 00:03:00,400
and in in the case of attack for mac os

76
00:03:00,400 --> 00:03:02,000
again a lot of the references are from

77
00:03:02,000 --> 00:03:05,840
some fairly familiar people

78
00:03:06,159 --> 00:03:08,319
each technique is metadata with it

79
00:03:08,319 --> 00:03:11,360
this technique id which is where i talk

80
00:03:11,360 --> 00:03:13,760
about attack as a common language this

81
00:03:13,760 --> 00:03:15,920
is a lot of reporting and other

82
00:03:15,920 --> 00:03:18,239
information coming out a lot of products

83
00:03:18,239 --> 00:03:20,400
are now using in order to talk about

84
00:03:20,400 --> 00:03:22,959
behaviors in a similar language

85
00:03:22,959 --> 00:03:25,280
uh what tactic or tactics an attack

86
00:03:25,280 --> 00:03:27,280
technique falls under

87
00:03:27,280 --> 00:03:29,440
what platforms and so this is the is it

88
00:03:29,440 --> 00:03:32,239
mac os is it windows is it linux in a

89
00:03:32,239 --> 00:03:34,560
lot of cases a technique can be done in

90
00:03:34,560 --> 00:03:37,120
multiple spaces

91
00:03:37,120 --> 00:03:38,879
what data sources would you need to

92
00:03:38,879 --> 00:03:40,959
gather as a defender to be able to see

93
00:03:40,959 --> 00:03:43,120
this technique

94
00:03:43,120 --> 00:03:45,040
and then various other

95
00:03:45,040 --> 00:03:49,359
fields based on which tactic it is

96
00:03:50,959 --> 00:03:52,400
wherever possible techniques are

97
00:03:52,400 --> 00:03:54,239
procedure examples these are examples of

98
00:03:54,239 --> 00:03:56,720
how real adversaries have used this

99
00:03:56,720 --> 00:03:57,920
technique

100
00:03:57,920 --> 00:04:00,159
so we won't add a technique to attack

101
00:04:00,159 --> 00:04:01,760
unless we've seen some evidence that

102
00:04:01,760 --> 00:04:03,840
it's been used in the wild but that

103
00:04:03,840 --> 00:04:06,400
evidence isn't always from places that

104
00:04:06,400 --> 00:04:08,080
we can publish sometimes it's somebody

105
00:04:08,080 --> 00:04:10,239
tapping us on the shoulder saying yes

106
00:04:10,239 --> 00:04:11,519
this is real

107
00:04:11,519 --> 00:04:13,120
but this is going back to where we've

108
00:04:13,120 --> 00:04:15,120
got open source publicly available

109
00:04:15,120 --> 00:04:17,440
threat intelligence where we can point

110
00:04:17,440 --> 00:04:19,918
at it and we can say you know this is an

111
00:04:19,918 --> 00:04:21,519
example of an adversary using a

112
00:04:21,519 --> 00:04:24,000
technique

113
00:04:26,560 --> 00:04:28,560
and again bringing it to defenders we

114
00:04:28,560 --> 00:04:31,280
give a series of detection ideas

115
00:04:31,280 --> 00:04:33,280
that you know giveaways that defenders

116
00:04:33,280 --> 00:04:34,960
might be able to actually see this

117
00:04:34,960 --> 00:04:37,600
technique being done on their network

118
00:04:37,600 --> 00:04:38,960
and again

119
00:04:38,960 --> 00:04:40,639
some of those detection ideas are coming

120
00:04:40,639 --> 00:04:44,400
from very familiar places

121
00:04:47,360 --> 00:04:49,280
and finally every technique has

122
00:04:49,280 --> 00:04:50,560
references

123
00:04:50,560 --> 00:04:52,400
so we actually picked out this

124
00:04:52,400 --> 00:04:54,720
particular technique before catching the

125
00:04:54,720 --> 00:04:57,520
references on it but

126
00:04:57,520 --> 00:04:59,520
they're patrick wardle patrick wordle

127
00:04:59,520 --> 00:05:02,560
wardle p wordle p patrick wardle patrick

128
00:05:02,560 --> 00:05:03,759
wardle

129
00:05:03,759 --> 00:05:06,720
um and so you start to see some trends

130
00:05:06,720 --> 00:05:08,800
in our mac os space

131
00:05:08,800 --> 00:05:11,759
but it's um you know what we're doing is

132
00:05:11,759 --> 00:05:13,840
trying to take the information that you

133
00:05:13,840 --> 00:05:14,720
all

134
00:05:14,720 --> 00:05:16,240
are are putting out and trying to

135
00:05:16,240 --> 00:05:18,000
distill it into

136
00:05:18,000 --> 00:05:20,080
a form that's that's usable hopefully

137
00:05:20,080 --> 00:05:24,280
for you and the broader community

138
00:05:24,320 --> 00:05:26,160
okay

139
00:05:26,160 --> 00:05:28,320
so this leads us into what is what makes

140
00:05:28,320 --> 00:05:31,039
mac os a special snowflake

141
00:05:31,039 --> 00:05:32,240
which by the way

142
00:05:32,240 --> 00:05:33,520
it's your own fault for having so many

143
00:05:33,520 --> 00:05:34,960
references after you have a book

144
00:05:34,960 --> 00:05:38,359
multiple blogs

145
00:05:40,720 --> 00:05:41,919
thank you

146
00:05:41,919 --> 00:05:43,600
if you haven't noticed thank you all for

147
00:05:43,600 --> 00:05:45,440
all of your contributions on this but

148
00:05:45,440 --> 00:05:47,520
for mac specifically the we've actually

149
00:05:47,520 --> 00:05:48,479
hit a lot of them throughout the

150
00:05:48,479 --> 00:05:49,919
presentations this morning right

151
00:05:49,919 --> 00:05:52,080
notarization gatekeeper these opt-in

152
00:05:52,080 --> 00:05:53,360
programs

153
00:05:53,360 --> 00:05:54,639
different developer tools that they can

154
00:05:54,639 --> 00:05:56,240
do

155
00:05:56,240 --> 00:05:58,080
i make a joke a lot of times about local

156
00:05:58,080 --> 00:06:00,560
admin for everyone because in a lot of

157
00:06:00,560 --> 00:06:03,199
enterprise environments its

158
00:06:03,199 --> 00:06:06,000
local admin tends to be a very common

159
00:06:06,000 --> 00:06:07,840
theme

160
00:06:07,840 --> 00:06:10,160
exploitation versus behavior over this

161
00:06:10,160 --> 00:06:11,919
last year that i've actually been going

162
00:06:11,919 --> 00:06:14,639
through the the framework it has been

163
00:06:14,639 --> 00:06:16,080
probably one of the

164
00:06:16,080 --> 00:06:18,240
key discussions that i've had with

165
00:06:18,240 --> 00:06:19,520
individuals in the community and

166
00:06:19,520 --> 00:06:21,440
individuals amongst my own team where

167
00:06:21,440 --> 00:06:24,000
it's is this an exploitation or is this

168
00:06:24,000 --> 00:06:25,440
a behavior

169
00:06:25,440 --> 00:06:27,039
and that's probably been the biggest

170
00:06:27,039 --> 00:06:28,560
challenge like as we've seen some of the

171
00:06:28,560 --> 00:06:30,000
presentations today it's okay what

172
00:06:30,000 --> 00:06:32,560
defines that example between the two

173
00:06:32,560 --> 00:06:34,800
the biggest thing about the mac os space

174
00:06:34,800 --> 00:06:37,120
the limited reporting it's a black hole

175
00:06:37,120 --> 00:06:39,120
not only in threat intelligence but also

176
00:06:39,120 --> 00:06:40,800
in the actual development documentation

177
00:06:40,800 --> 00:06:43,280
right like what do we logs like there's

178
00:06:43,280 --> 00:06:44,880
actually i definitely quote some of

179
00:06:44,880 --> 00:06:47,360
sarah edwards log or blogs because she

180
00:06:47,360 --> 00:06:49,039
does a great job of like showcasing

181
00:06:49,039 --> 00:06:50,800
those logs like there's different

182
00:06:50,800 --> 00:06:52,479
authors in here that i will

183
00:06:52,479 --> 00:06:53,919
heavily reference in the detection

184
00:06:53,919 --> 00:06:55,280
section because

185
00:06:55,280 --> 00:06:57,199
it's the community that's actually

186
00:06:57,199 --> 00:06:59,199
creating those resources for us to know

187
00:06:59,199 --> 00:07:02,639
what logs to even search for

188
00:07:02,639 --> 00:07:04,000
so a little bit about ocean lotus and

189
00:07:04,000 --> 00:07:05,599
why we picked it

190
00:07:05,599 --> 00:07:07,199
it is one of the threat actors that are

191
00:07:07,199 --> 00:07:08,800
operating inside of the mac os space

192
00:07:08,800 --> 00:07:11,440
that we have in attack

193
00:07:11,440 --> 00:07:15,280
they've been active since 2012 2012

194
00:07:15,280 --> 00:07:16,960
to present they're believed to be based

195
00:07:16,960 --> 00:07:18,479
on reporting on the vietnamese

196
00:07:18,479 --> 00:07:19,599
government

197
00:07:19,599 --> 00:07:21,120
they're very big in targeting macos

198
00:07:21,120 --> 00:07:22,800
windows and android

199
00:07:22,800 --> 00:07:25,680
they're very heavy in the spyware case

200
00:07:25,680 --> 00:07:27,440
ironically enough with our keynote

201
00:07:27,440 --> 00:07:28,400
speaker

202
00:07:28,400 --> 00:07:30,800
one of the key attacks that they had

203
00:07:30,800 --> 00:07:32,880
which was on the eff that was actually

204
00:07:32,880 --> 00:07:34,560
what linked

205
00:07:34,560 --> 00:07:37,120
fireeye and a chinese reporting to the

206
00:07:37,120 --> 00:07:39,199
same actual actor which is why you hear

207
00:07:39,199 --> 00:07:43,039
like ocean lotus and apt-20 or apt-32

208
00:07:43,039 --> 00:07:44,879
and then they also have a tendency to

209
00:07:44,879 --> 00:07:46,560
target things that are in the vietnamese

210
00:07:46,560 --> 00:07:49,919
interests um manufacturing hospitality

211
00:07:49,919 --> 00:07:52,800
and then also human rights or

212
00:07:52,800 --> 00:07:55,440
specifically

213
00:07:56,479 --> 00:07:58,720
there's a big word here that i must

214
00:07:58,720 --> 00:07:59,840
think of

215
00:07:59,840 --> 00:08:01,199
um

216
00:08:01,199 --> 00:08:03,199
on out speaking against the government

217
00:08:03,199 --> 00:08:04,479
so

218
00:08:04,479 --> 00:08:05,919
that was kind of the idea we wanted to

219
00:08:05,919 --> 00:08:07,120
be able to take a group that was

220
00:08:07,120 --> 00:08:08,879
represented and then walk through

221
00:08:08,879 --> 00:08:11,440
different use cases for this group

222
00:08:11,440 --> 00:08:12,960
so quick note on all the things that

223
00:08:12,960 --> 00:08:14,080
we're going to cover

224
00:08:14,080 --> 00:08:15,919
we have the different positions the

225
00:08:15,919 --> 00:08:19,280
different postures of ocean lotus first

226
00:08:19,280 --> 00:08:21,759
is the tree which is all about seeing

227
00:08:21,759 --> 00:08:23,680
things from a different perspective then

228
00:08:23,680 --> 00:08:25,680
you have the warrior of course for all

229
00:08:25,680 --> 00:08:27,520
of the threat hunters in the room then

230
00:08:27,520 --> 00:08:29,520
you have the dancer for adversary

231
00:08:29,520 --> 00:08:30,639
emulation

232
00:08:30,639 --> 00:08:32,080
and then you have engineering assessment

233
00:08:32,080 --> 00:08:33,599
where it's the lotus position where it's

234
00:08:33,599 --> 00:08:34,559
like

235
00:08:34,559 --> 00:08:35,679
um

236
00:08:35,679 --> 00:08:37,679
so um and adam will start us off with

237
00:08:37,679 --> 00:08:40,559
the next one

238
00:08:40,559 --> 00:08:42,559
yeah thank you cat and so in order to be

239
00:08:42,559 --> 00:08:44,640
allowed to talk about cyber threat

240
00:08:44,640 --> 00:08:46,959
intelligence i'm i'm supposed to

241
00:08:46,959 --> 00:08:50,160
i'm not quite sure um

242
00:08:50,160 --> 00:08:54,040
not fast enough for the cameras

243
00:09:05,600 --> 00:09:07,839
so since the people in the live stream

244
00:09:07,839 --> 00:09:09,279
aren't actually seeing video you'll have

245
00:09:09,279 --> 00:09:11,200
to imagine that was the best tree pose

246
00:09:11,200 --> 00:09:13,440
ever

247
00:09:14,560 --> 00:09:16,240
so i want to focus on three different

248
00:09:16,240 --> 00:09:18,399
areas pulling together a

249
00:09:18,399 --> 00:09:21,360
behavioral threat profile on ocean lotus

250
00:09:21,360 --> 00:09:23,440
out of attack information so i'm going

251
00:09:23,440 --> 00:09:24,640
to start off with talking about threat

252
00:09:24,640 --> 00:09:26,800
intelligence that's in attack itself so

253
00:09:26,800 --> 00:09:28,800
things that we've pulled together

254
00:09:28,800 --> 00:09:31,040
from existing open source public threat

255
00:09:31,040 --> 00:09:33,440
intelligence reporting compiled that you

256
00:09:33,440 --> 00:09:35,680
can directly use out of attack

257
00:09:35,680 --> 00:09:37,120
leveraging threat intelligence out of

258
00:09:37,120 --> 00:09:38,880
external reporting you might be paying

259
00:09:38,880 --> 00:09:41,440
for receiving from sharing partners

260
00:09:41,440 --> 00:09:43,279
and then especially in this group where

261
00:09:43,279 --> 00:09:45,200
a lot of people are looking at raw data

262
00:09:45,200 --> 00:09:48,000
analyzing actual actual up close

263
00:09:48,000 --> 00:09:49,839
personal threats a little bit about

264
00:09:49,839 --> 00:09:51,440
cyber threat intelligence from your own

265
00:09:51,440 --> 00:09:53,839
data

266
00:09:55,120 --> 00:09:57,040
so a piece of attack that we didn't

267
00:09:57,040 --> 00:10:00,240
mention before is our group and software

268
00:10:00,240 --> 00:10:03,680
pages so we now track over 100 different

269
00:10:03,680 --> 00:10:05,120
threat groups that have been mentioned

270
00:10:05,120 --> 00:10:07,200
in various public reporting

271
00:10:07,200 --> 00:10:09,200
and over 500 different pieces of

272
00:10:09,200 --> 00:10:11,040
software that people have talked about

273
00:10:11,040 --> 00:10:13,040
in the wild and that's across everything

274
00:10:13,040 --> 00:10:17,200
mac os specific is a much smaller subset

275
00:10:17,200 --> 00:10:20,240
so we we do call it apt-32 an attack

276
00:10:20,240 --> 00:10:22,399
that's because the first report we added

277
00:10:22,399 --> 00:10:24,320
to attack was was obviously a mandiant

278
00:10:24,320 --> 00:10:25,839
or fireeye report

279
00:10:25,839 --> 00:10:27,839
calling it apt-32

280
00:10:27,839 --> 00:10:30,320
over time if places are publishing

281
00:10:30,320 --> 00:10:33,440
reports that are using other other names

282
00:10:33,440 --> 00:10:36,320
that describe their view of activity

283
00:10:36,320 --> 00:10:38,399
that may be partially or completely

284
00:10:38,399 --> 00:10:40,959
overlapping will adopt those names into

285
00:10:40,959 --> 00:10:43,600
attacks or associated group descriptions

286
00:10:43,600 --> 00:10:45,600
so sea lotus and ocean lotus with

287
00:10:45,600 --> 00:10:47,360
references back to

288
00:10:47,360 --> 00:10:48,720
sources that are saying that these are

289
00:10:48,720 --> 00:10:52,480
the same or overlapping groups

290
00:10:53,279 --> 00:10:54,800
probably the important part though for

291
00:10:54,800 --> 00:10:57,120
for pulling intelligence from this is

292
00:10:57,120 --> 00:10:59,040
the techniques

293
00:10:59,040 --> 00:11:00,800
we've gone through a lot of these

294
00:11:00,800 --> 00:11:02,800
reports and

295
00:11:02,800 --> 00:11:04,320
extracted out

296
00:11:04,320 --> 00:11:06,800
what behaviors in attack have we seen

297
00:11:06,800 --> 00:11:08,880
from the specific group

298
00:11:08,880 --> 00:11:11,120
and so in the terms of a groups page

299
00:11:11,120 --> 00:11:12,800
it's what have we seen people reporting

300
00:11:12,800 --> 00:11:15,040
that an adversary has done hands on

301
00:11:15,040 --> 00:11:16,720
keyboard what has the actor actually

302
00:11:16,720 --> 00:11:18,800
done and the software pages what is

303
00:11:18,800 --> 00:11:21,200
their software capable of doing and

304
00:11:21,200 --> 00:11:23,120
especially in these pages everything is

305
00:11:23,120 --> 00:11:24,959
referenced back to publicly available

306
00:11:24,959 --> 00:11:26,240
open source threat intelligence

307
00:11:26,240 --> 00:11:28,560
reporting you can check our work here

308
00:11:28,560 --> 00:11:30,640
and you know see if you agree with us or

309
00:11:30,640 --> 00:11:32,959
not but we we definitely show our work

310
00:11:32,959 --> 00:11:34,480
in everything we're doing on the groups

311
00:11:34,480 --> 00:11:36,959
pages

312
00:11:38,240 --> 00:11:42,399
so backing up to our mac matrix again so

313
00:11:42,399 --> 00:11:44,720
we we do have some techniques that we

314
00:11:44,720 --> 00:11:47,519
have on the otis lotion group page that

315
00:11:47,519 --> 00:11:50,560
overlap with attack for mac

316
00:11:50,560 --> 00:11:51,440
now

317
00:11:51,440 --> 00:11:53,600
basically all the reporting we have out

318
00:11:53,600 --> 00:11:55,440
right now that we're able to use an

319
00:11:55,440 --> 00:11:56,959
attack that we've seen

320
00:11:56,959 --> 00:11:59,040
is talking about windows activities and

321
00:11:59,040 --> 00:12:01,360
so these are windows actions that are

322
00:12:01,360 --> 00:12:03,600
also possible on the mac

323
00:12:03,600 --> 00:12:05,680
and so i want to zoom out back to the

324
00:12:05,680 --> 00:12:07,600
full matrix to start building up the

325
00:12:07,600 --> 00:12:09,279
picture

326
00:12:09,279 --> 00:12:11,279
so again this is going back to

327
00:12:11,279 --> 00:12:13,040
definitely sort of the eye chart but you

328
00:12:13,040 --> 00:12:14,880
can at least see the shape

329
00:12:14,880 --> 00:12:16,880
of what we're able to gather

330
00:12:16,880 --> 00:12:19,279
so we do some areas and some types of

331
00:12:19,279 --> 00:12:21,200
tactics where we know a lot about what

332
00:12:21,200 --> 00:12:23,760
ocean lotus does and other places where

333
00:12:23,760 --> 00:12:25,839
we've we've got a bit less but this

334
00:12:25,839 --> 00:12:27,519
really doesn't do justice to the full

335
00:12:27,519 --> 00:12:30,240
amount of intelligence that is out there

336
00:12:30,240 --> 00:12:31,839
on ocean lotus

337
00:12:31,839 --> 00:12:33,839
a considerable amount of the reporting

338
00:12:33,839 --> 00:12:36,320
on them especially in the mac space

339
00:12:36,320 --> 00:12:38,639
is limited to malware analysis so we've

340
00:12:38,639 --> 00:12:41,440
seen the samples they probably used them

341
00:12:41,440 --> 00:12:43,200
in the wild or we wouldn't have them in

342
00:12:43,200 --> 00:12:45,200
virus total or wherever

343
00:12:45,200 --> 00:12:46,079
and

344
00:12:46,079 --> 00:12:47,760
we've been able to associate them back

345
00:12:47,760 --> 00:12:50,319
with the group

346
00:12:50,560 --> 00:12:53,519
so if you start taking a look at malware

347
00:12:53,519 --> 00:12:55,519
samples that we have

348
00:12:55,519 --> 00:12:56,639
and

349
00:12:56,639 --> 00:12:59,120
have just been used by ocean lotus

350
00:12:59,120 --> 00:13:02,000
reporting so they appear to be either

351
00:13:02,000 --> 00:13:04,880
written by them contracted by them

352
00:13:04,880 --> 00:13:06,880
in some ways unique so this isn't

353
00:13:06,880 --> 00:13:08,079
pulling in a few things that they're

354
00:13:08,079 --> 00:13:10,720
known to use like mummy cats

355
00:13:10,720 --> 00:13:13,519
but you know under the theory that

356
00:13:13,519 --> 00:13:15,279
if they've written it if they've

357
00:13:15,279 --> 00:13:17,440
contracted it probably most of the

358
00:13:17,440 --> 00:13:19,440
functionality in there is is something

359
00:13:19,440 --> 00:13:22,079
that they're likely to have used

360
00:13:22,079 --> 00:13:23,760
so we can add that to the picture that

361
00:13:23,760 --> 00:13:26,320
we're building up so where we see the

362
00:13:26,320 --> 00:13:27,440
techniques that we know that they've

363
00:13:27,440 --> 00:13:29,440
done in the wild techniques that we know

364
00:13:29,440 --> 00:13:31,680
their software is doing

365
00:13:31,680 --> 00:13:33,600
and just to give an idea of sort of what

366
00:13:33,600 --> 00:13:36,000
this is looking like building up in in

367
00:13:36,000 --> 00:13:37,760
the background of this eye chart you

368
00:13:37,760 --> 00:13:39,279
know we're starting to fill in a lot of

369
00:13:39,279 --> 00:13:40,880
these techniques

370
00:13:40,880 --> 00:13:43,199
with the black is ocean lotus did it

371
00:13:43,199 --> 00:13:44,720
hands on keyboard green is their

372
00:13:44,720 --> 00:13:46,880
software and purple is both

373
00:13:46,880 --> 00:13:49,040
and so we do sort of build up a much

374
00:13:49,040 --> 00:13:51,760
richer picture

375
00:13:51,760 --> 00:13:53,519
this still though

376
00:13:53,519 --> 00:13:56,079
is only getting at what attack is

377
00:13:56,079 --> 00:13:57,920
limited to use

378
00:13:57,920 --> 00:14:00,240
so like i keep saying we only use open

379
00:14:00,240 --> 00:14:01,440
source public threat intelligence

380
00:14:01,440 --> 00:14:03,600
reporting to go into this well there's a

381
00:14:03,600 --> 00:14:06,320
lot of biases in that data

382
00:14:06,320 --> 00:14:07,199
most

383
00:14:07,199 --> 00:14:09,680
so a lot of the people here blog

384
00:14:09,680 --> 00:14:11,279
out of the goodness of their heart but a

385
00:14:11,279 --> 00:14:12,639
lot of the intelligence reports we're

386
00:14:12,639 --> 00:14:14,800
able to use are frankly coming out of

387
00:14:14,800 --> 00:14:17,120
marketing budgets there are threats that

388
00:14:17,120 --> 00:14:19,360
are interesting for some reason

389
00:14:19,360 --> 00:14:21,600
in order to be reported on

390
00:14:21,600 --> 00:14:23,600
they include biases from whoever

391
00:14:23,600 --> 00:14:25,199
analyzed it and what techniques they're

392
00:14:25,199 --> 00:14:26,639
used to seeing

393
00:14:26,639 --> 00:14:28,560
where their visibility is

394
00:14:28,560 --> 00:14:30,800
and so there are limitations on what

395
00:14:30,800 --> 00:14:32,959
kind of data we actually get and are

396
00:14:32,959 --> 00:14:35,040
able to use here

397
00:14:35,040 --> 00:14:36,480
that's why it's important to start

398
00:14:36,480 --> 00:14:39,120
pulling in your own sources

399
00:14:39,120 --> 00:14:41,199
so a lot of you probably have access to

400
00:14:41,199 --> 00:14:43,279
commercial threat intelligence feeds or

401
00:14:43,279 --> 00:14:45,600
threat sharing groups that slack that

402
00:14:45,600 --> 00:14:47,040
you know people are tossing around

403
00:14:47,040 --> 00:14:48,880
information on

404
00:14:48,880 --> 00:14:50,720
and so there's a lot of reporting out

405
00:14:50,720 --> 00:14:52,959
there that we can't add to a tech that

406
00:14:52,959 --> 00:14:56,399
you probably want to analyze as well

407
00:14:56,399 --> 00:14:58,959
this is a trend micro malware report on

408
00:14:58,959 --> 00:15:00,639
ocean lotus malware from a couple years

409
00:15:00,639 --> 00:15:01,760
back

410
00:15:01,760 --> 00:15:04,560
and it's you know fairly small snippet

411
00:15:04,560 --> 00:15:06,160
but if we go through and start to look

412
00:15:06,160 --> 00:15:08,160
at the behaviors in just this little bit

413
00:15:08,160 --> 00:15:09,680
of a report

414
00:15:09,680 --> 00:15:11,519
with everything from their action with

415
00:15:11,519 --> 00:15:14,079
launch damon's launch agents

416
00:15:14,079 --> 00:15:16,240
getting its system data

417
00:15:16,240 --> 00:15:18,000
all these things actually map back to

418
00:15:18,000 --> 00:15:20,079
attack techniques and so we can go

419
00:15:20,079 --> 00:15:21,360
through

420
00:15:21,360 --> 00:15:24,160
and start to find one at a time

421
00:15:24,160 --> 00:15:26,160
the different activities in this that

422
00:15:26,160 --> 00:15:29,440
actually map back to attack

423
00:15:29,440 --> 00:15:32,320
so starting with launch agents we

424
00:15:32,320 --> 00:15:34,880
actually have a launch agent technique

425
00:15:34,880 --> 00:15:36,959
fairly straightforward

426
00:15:36,959 --> 00:15:39,440
similar story with launch daemon

427
00:15:39,440 --> 00:15:42,959
rinse wash repeat can go through and add

428
00:15:42,959 --> 00:15:46,399
the rest of the reporting here

429
00:15:49,040 --> 00:15:51,360
so how to do that so the process

430
00:15:51,360 --> 00:15:54,639
teaching that is its own course um

431
00:15:54,639 --> 00:15:56,720
in more time than we really have here

432
00:15:56,720 --> 00:15:57,680
today

433
00:15:57,680 --> 00:15:59,519
so i'm not going to really walk through

434
00:15:59,519 --> 00:16:02,240
the the full process on how to do that

435
00:16:02,240 --> 00:16:04,800
uh we've worked with dhs sysa to put out

436
00:16:04,800 --> 00:16:06,720
a guide fairly recently

437
00:16:06,720 --> 00:16:08,399
on how to do this

438
00:16:08,399 --> 00:16:10,079
as well as

439
00:16:10,079 --> 00:16:12,480
we've worked with a organization called

440
00:16:12,480 --> 00:16:14,240
mitre attack defender to put out

441
00:16:14,240 --> 00:16:15,920
completely free training

442
00:16:15,920 --> 00:16:17,839
on actually mapping to this kind of

443
00:16:17,839 --> 00:16:20,839
information

444
00:16:22,560 --> 00:16:24,160
but that's all working with finished

445
00:16:24,160 --> 00:16:25,279
reporting

446
00:16:25,279 --> 00:16:26,720
a lot of the people in this room are

447
00:16:26,720 --> 00:16:29,120
working with malware samples and seeing

448
00:16:29,120 --> 00:16:32,720
actual data raw data from adversaries

449
00:16:32,720 --> 00:16:33,600
that

450
00:16:33,600 --> 00:16:34,959
you know you might want to be able to

451
00:16:34,959 --> 00:16:36,880
add into this full picture so things

452
00:16:36,880 --> 00:16:38,880
like internal reporting

453
00:16:38,880 --> 00:16:40,880
pieces of malware on github a couple of

454
00:16:40,880 --> 00:16:43,120
references i had earlier were mac parts

455
00:16:43,120 --> 00:16:45,600
of empire

456
00:16:45,600 --> 00:16:48,160
in internal in-depth technical reports

457
00:16:48,160 --> 00:16:50,160
things from your honey pots and direct

458
00:16:50,160 --> 00:16:53,439
from binary analysis

459
00:16:54,880 --> 00:16:57,199
so instead of going all the way to

460
00:16:57,199 --> 00:16:59,040
gider land i decided to go with a shell

461
00:16:59,040 --> 00:17:00,320
script

462
00:17:00,320 --> 00:17:02,480
make it a little bit easier to read up

463
00:17:02,480 --> 00:17:04,240
on the screen

464
00:17:04,240 --> 00:17:06,400
probably this has been reported in a

465
00:17:06,400 --> 00:17:08,959
couple of places before but

466
00:17:08,959 --> 00:17:10,799
this actual example is grabbed directly

467
00:17:10,799 --> 00:17:13,760
at a virus total

468
00:17:13,919 --> 00:17:16,160
so again this may be familiar to a bunch

469
00:17:16,160 --> 00:17:17,679
of you given that it has been in

470
00:17:17,679 --> 00:17:19,119
reporting

471
00:17:19,119 --> 00:17:21,439
but you can similarly go through and

472
00:17:21,439 --> 00:17:23,520
analyze the pieces of this and turn it

473
00:17:23,520 --> 00:17:25,839
back into techniques

474
00:17:25,839 --> 00:17:28,240
starting at the very top where it is

475
00:17:28,240 --> 00:17:30,400
clearly a bash script based on the

476
00:17:30,400 --> 00:17:33,280
shebang at the top which is a unique

477
00:17:33,280 --> 00:17:35,679
shell script in attack

478
00:17:35,679 --> 00:17:39,919
there was a giant base 64 here that

479
00:17:39,919 --> 00:17:41,679
would have made this slide very very

480
00:17:41,679 --> 00:17:43,440
very small so that's been removed for

481
00:17:43,440 --> 00:17:45,520
readability but we would call that

482
00:17:45,520 --> 00:17:49,360
obfuscated files or information

483
00:17:49,440 --> 00:17:51,280
uh they're doing a classic gatekeeper

484
00:17:51,280 --> 00:17:54,720
bypass here with x adder

485
00:17:55,120 --> 00:17:57,520
as they go through and they're looking

486
00:17:57,520 --> 00:17:59,760
for their files that app translocation

487
00:17:59,760 --> 00:18:01,200
they're doing what we'd call file or

488
00:18:01,200 --> 00:18:04,160
directory discovery

489
00:18:04,160 --> 00:18:06,160
then they're pulling apart that base64

490
00:18:06,160 --> 00:18:07,919
blob with de-obfuscating files or

491
00:18:07,919 --> 00:18:09,760
information

492
00:18:09,760 --> 00:18:11,200
and finally they're deleting the

493
00:18:11,200 --> 00:18:12,799
evidence

494
00:18:12,799 --> 00:18:14,880
and so this is still just this little

495
00:18:14,880 --> 00:18:17,280
snippet kind of a rich place for

496
00:18:17,280 --> 00:18:20,320
behavioral threat intelligence

497
00:18:20,320 --> 00:18:21,840
i'm going to hand the step over to kat

498
00:18:21,840 --> 00:18:24,080
to talk a little bit about what you can

499
00:18:24,080 --> 00:18:27,879
do with some of this information

500
00:18:29,840 --> 00:18:31,600
back to our warriors pose for those of

501
00:18:31,600 --> 00:18:34,480
you that are threat hunter

502
00:18:35,120 --> 00:18:36,720
quick level setting on threat hunter or

503
00:18:36,720 --> 00:18:39,039
threat hunting in general is

504
00:18:39,039 --> 00:18:40,880
talking about the proactive approach to

505
00:18:40,880 --> 00:18:42,559
be able to catch what's already slipped

506
00:18:42,559 --> 00:18:44,000
through the cracks right these are

507
00:18:44,000 --> 00:18:45,440
things where it's a proactive not

508
00:18:45,440 --> 00:18:46,960
necessarily a reactive you're going to

509
00:18:46,960 --> 00:18:49,840
search for something that

510
00:18:49,840 --> 00:18:51,120
you don't know if it's there you're

511
00:18:51,120 --> 00:18:53,919
hypothesizing if it's there or not

512
00:18:53,919 --> 00:18:56,000
so our intel team came up with this

513
00:18:56,000 --> 00:18:57,679
amazing eye chart that we are going to

514
00:18:57,679 --> 00:19:01,919
leverage um specific to ocean lotus

515
00:19:02,240 --> 00:19:03,840
i was actually so here's kind of the

516
00:19:03,840 --> 00:19:06,080
power behind the community

517
00:19:06,080 --> 00:19:08,880
i was talking with one of um someone

518
00:19:08,880 --> 00:19:10,080
else is actually presenting at another

519
00:19:10,080 --> 00:19:11,600
conference and

520
00:19:11,600 --> 00:19:13,520
he was telling me about how like how he

521
00:19:13,520 --> 00:19:15,360
goes through and he actually finds ways

522
00:19:15,360 --> 00:19:17,520
to scope that data down like how does

523
00:19:17,520 --> 00:19:18,720
how does he pick out what he wants to

524
00:19:18,720 --> 00:19:19,760
hunt on

525
00:19:19,760 --> 00:19:22,960
and for him he chooses what does he have

526
00:19:22,960 --> 00:19:24,960
in data and the really cool thing about

527
00:19:24,960 --> 00:19:26,480
attack is that what we've done is we've

528
00:19:26,480 --> 00:19:28,559
added data sources to

529
00:19:28,559 --> 00:19:30,160
the different techniques what data

530
00:19:30,160 --> 00:19:32,320
sources would you find this behavior in

531
00:19:32,320 --> 00:19:34,000
and one way to be able to leverage that

532
00:19:34,000 --> 00:19:36,080
is by actually looking at

533
00:19:36,080 --> 00:19:37,600
what techniques are covered by what data

534
00:19:37,600 --> 00:19:39,840
source

535
00:19:40,160 --> 00:19:42,400
so scoping down using ocean lotus as our

536
00:19:42,400 --> 00:19:44,799
example um when i used to do hunting a

537
00:19:44,799 --> 00:19:48,160
lot i had a friend that he loved auto

538
00:19:48,160 --> 00:19:50,080
runs that was his go-to hunt it was

539
00:19:50,080 --> 00:19:52,160
always gave him the most hits so that's

540
00:19:52,160 --> 00:19:53,840
all he would do but if you asked him

541
00:19:53,840 --> 00:19:56,400
what that meant in mac os he'd have no

542
00:19:56,400 --> 00:19:58,559
idea and so

543
00:19:58,559 --> 00:20:00,960
essentially for us auto runs is aka

544
00:20:00,960 --> 00:20:03,039
knock knock but

545
00:20:03,039 --> 00:20:05,360
for our block block sorry um

546
00:20:05,360 --> 00:20:08,400
but in this case it's like we're looking

547
00:20:08,400 --> 00:20:10,240
at launch agents and launch demons right

548
00:20:10,240 --> 00:20:11,679
for ocean lotus that is what we have

549
00:20:11,679 --> 00:20:13,120
reporting on that they have actually

550
00:20:13,120 --> 00:20:15,600
leveraged

551
00:20:16,559 --> 00:20:19,120
so digging into this um the nice the way

552
00:20:19,120 --> 00:20:20,720
to you like at least the way that i've

553
00:20:20,720 --> 00:20:23,039
used attack as a threat hunter was that

554
00:20:23,039 --> 00:20:24,559
a lot of times you can't know everything

555
00:20:24,559 --> 00:20:26,320
about every single technique and quite

556
00:20:26,320 --> 00:20:28,000
frankly when i first started working at

557
00:20:28,000 --> 00:20:29,600
attack i thought i knew attack and i

558
00:20:29,600 --> 00:20:32,000
didn't realize like until you're asked

559
00:20:32,000 --> 00:20:34,400
to go and create the encyclopedia that

560
00:20:34,400 --> 00:20:37,360
everyone else uses as a reference like

561
00:20:37,360 --> 00:20:39,600
suddenly you'll realize how much you

562
00:20:39,600 --> 00:20:43,200
don't know and it's a very very humbling

563
00:20:43,200 --> 00:20:44,480
experience

564
00:20:44,480 --> 00:20:45,600
so

565
00:20:45,600 --> 00:20:47,919
as i've done dug into this and dug into

566
00:20:47,919 --> 00:20:50,880
each single sub technique there is so

567
00:20:50,880 --> 00:20:52,880
much that attack just scratches the

568
00:20:52,880 --> 00:20:54,480
surface so we try to do our best to kind

569
00:20:54,480 --> 00:20:56,559
of add to it but definitely

570
00:20:56,559 --> 00:21:00,000
there is more to be seen from it

571
00:21:00,000 --> 00:21:01,840
regarding the data sources um one

572
00:21:01,840 --> 00:21:03,440
project there was actually a project

573
00:21:03,440 --> 00:21:04,720
that i would wish would get taken back

574
00:21:04,720 --> 00:21:07,120
up again which i'll cite later but they

575
00:21:07,120 --> 00:21:08,640
actually go through and they map os

576
00:21:08,640 --> 00:21:11,520
query to the different attack techniques

577
00:21:11,520 --> 00:21:13,440
or sub techniques which is super helpful

578
00:21:13,440 --> 00:21:14,960
in being able to identify like where do

579
00:21:14,960 --> 00:21:17,039
i actually look for these behaviors

580
00:21:17,039 --> 00:21:18,640
and again like something that adam had

581
00:21:18,640 --> 00:21:20,480
talked about earlier so this is that

582
00:21:20,480 --> 00:21:22,159
common language right like if you're all

583
00:21:22,159 --> 00:21:23,120
sitting at the table and you're

584
00:21:23,120 --> 00:21:24,400
discussing something you want to make

585
00:21:24,400 --> 00:21:25,600
sure that you're actually talking about

586
00:21:25,600 --> 00:21:27,679
the same exact thing because being at

587
00:21:27,679 --> 00:21:29,679
that table and then not having then like

588
00:21:29,679 --> 00:21:31,520
at the end of the conversation realizing

589
00:21:31,520 --> 00:21:33,039
you both were referencing something

590
00:21:33,039 --> 00:21:34,480
completely different

591
00:21:34,480 --> 00:21:36,960
it's a very demoralizing

592
00:21:36,960 --> 00:21:39,280
time

593
00:21:39,600 --> 00:21:42,480
so one way to also leverage attack

594
00:21:42,480 --> 00:21:44,640
specifically for mac os is by the

595
00:21:44,640 --> 00:21:46,480
procedures that we mentioned before so

596
00:21:46,480 --> 00:21:48,159
these procedures are the actual ways

597
00:21:48,159 --> 00:21:50,000
that the malware or the threat actors

598
00:21:50,000 --> 00:21:52,480
have actually leveraged this technique

599
00:21:52,480 --> 00:21:53,919
you'll notice like the one that's for

600
00:21:53,919 --> 00:21:55,200
ocean lotus

601
00:21:55,200 --> 00:21:56,799
it has references right beside it but

602
00:21:56,799 --> 00:21:58,720
also below it for thief quest something

603
00:21:58,720 --> 00:21:59,679
that we've kind of been trying to go

604
00:21:59,679 --> 00:22:01,600
through and do is adding a bit more

605
00:22:01,600 --> 00:22:03,520
specifics into how these techniques are

606
00:22:03,520 --> 00:22:04,960
actually leveraged these procedures are

607
00:22:04,960 --> 00:22:07,039
done just to kind of allow defenders to

608
00:22:07,039 --> 00:22:09,280
have a little bit more meat so you'll

609
00:22:09,280 --> 00:22:10,720
kind of notice like it's not going to

610
00:22:10,720 --> 00:22:12,159
happen all at once but as we've been

611
00:22:12,159 --> 00:22:13,360
going through we've just been adding a

612
00:22:13,360 --> 00:22:15,520
little bit more meat to that

613
00:22:15,520 --> 00:22:17,360
but going off of those references if you

614
00:22:17,360 --> 00:22:19,200
wanted to add additional use cases

615
00:22:19,200 --> 00:22:20,480
that's really where that citing and

616
00:22:20,480 --> 00:22:22,400
those reportings come in

617
00:22:22,400 --> 00:22:25,120
so we have a report from unit 42 we have

618
00:22:25,120 --> 00:22:27,200
a report from trend micro um these are

619
00:22:27,200 --> 00:22:28,640
just the reports that we've been able to

620
00:22:28,640 --> 00:22:30,240
leverage and pull into attack to be able

621
00:22:30,240 --> 00:22:32,080
to actually showcase these behaviors up

622
00:22:32,080 --> 00:22:33,280
in the wild

623
00:22:33,280 --> 00:22:34,640
you'll actually be able to pull like

624
00:22:34,640 --> 00:22:36,559
okay for example

625
00:22:36,559 --> 00:22:38,559
um the unit 42 report like they're

626
00:22:38,559 --> 00:22:40,799
actually using the applications library

627
00:22:40,799 --> 00:22:42,640
to be able to install the pls whereas

628
00:22:42,640 --> 00:22:44,080
the trend micro one they're actually

629
00:22:44,080 --> 00:22:45,520
like mapping to a completely different

630
00:22:45,520 --> 00:22:48,720
location where they drop the binary um

631
00:22:48,720 --> 00:22:49,760
so they're just going to give you

632
00:22:49,760 --> 00:22:51,280
different use cases and insights to how

633
00:22:51,280 --> 00:22:52,480
they're leveraged

634
00:22:52,480 --> 00:22:55,360
some additional resources for hunting

635
00:22:55,360 --> 00:22:58,400
there is papers that are available for

636
00:22:58,400 --> 00:22:59,919
you to leverage they'll just kind of go

637
00:22:59,919 --> 00:23:02,320
more into different ways on techniques

638
00:23:02,320 --> 00:23:04,799
methodologies

639
00:23:04,799 --> 00:23:06,559
filipio is one of the ones that had

640
00:23:06,559 --> 00:23:09,600
worked on the mapping os query to attack

641
00:23:09,600 --> 00:23:11,520
which is super helpful

642
00:23:11,520 --> 00:23:13,520
cyberward dogs

643
00:23:13,520 --> 00:23:15,600
has the threat hunter playbook and then

644
00:23:15,600 --> 00:23:17,200
also david bianco's threat hunting

645
00:23:17,200 --> 00:23:18,640
project those are kind of some of my

646
00:23:18,640 --> 00:23:20,320
go-to resources for anything hunt

647
00:23:20,320 --> 00:23:22,799
related especially if you're trying to

648
00:23:22,799 --> 00:23:24,880
leverage attack because again it's one

649
00:23:24,880 --> 00:23:27,280
of those like it is that common language

650
00:23:27,280 --> 00:23:28,880
that kind of allows us to traverse all

651
00:23:28,880 --> 00:23:31,840
over all of the tools

652
00:23:31,840 --> 00:23:34,080
my favorite is the dancer

653
00:23:34,080 --> 00:23:36,320
which i can't do in like three inch

654
00:23:36,320 --> 00:23:37,360
wedges

655
00:23:37,360 --> 00:23:38,799
but

656
00:23:38,799 --> 00:23:40,960
as far as the red team goes um i thought

657
00:23:40,960 --> 00:23:44,240
this was the perfect image for it

658
00:23:44,240 --> 00:23:47,679
again going back to the eye chart

659
00:23:48,159 --> 00:23:50,080
adam made a reference earlier that i i

660
00:23:50,080 --> 00:23:52,159
think is really significant and that is

661
00:23:52,159 --> 00:23:55,600
kind of that gap analysis the thing that

662
00:23:55,600 --> 00:23:57,039
has been

663
00:23:57,039 --> 00:23:59,120
frustrating as going through all of

664
00:23:59,120 --> 00:24:00,480
these techniques

665
00:24:00,480 --> 00:24:02,240
has been

666
00:24:02,240 --> 00:24:04,559
we have this amazing incredible analysis

667
00:24:04,559 --> 00:24:06,559
that everyone's done on malware but the

668
00:24:06,559 --> 00:24:08,400
moment after that

669
00:24:08,400 --> 00:24:10,400
it's like this black hole it's like what

670
00:24:10,400 --> 00:24:13,279
did the actors actually do on the host

671
00:24:13,279 --> 00:24:14,559
what were the commands that were

672
00:24:14,559 --> 00:24:17,039
actually run on mac os like we don't

673
00:24:17,039 --> 00:24:18,559
have that information in open source

674
00:24:18,559 --> 00:24:20,559
reporting and like you all are really

675
00:24:20,559 --> 00:24:21,760
the only ones that we can kind of

676
00:24:21,760 --> 00:24:24,320
leverage on that so

677
00:24:24,320 --> 00:24:25,919
this is definitely like there's

678
00:24:25,919 --> 00:24:27,600
opportunities for calls to action here

679
00:24:27,600 --> 00:24:29,679
for sure but the nice thing about having

680
00:24:29,679 --> 00:24:31,120
these eye charts is that you can kind of

681
00:24:31,120 --> 00:24:33,120
start identifying like where are the

682
00:24:33,120 --> 00:24:35,039
gaps in the open source intelligence

683
00:24:35,039 --> 00:24:37,120
that i have what do i need to go and dig

684
00:24:37,120 --> 00:24:39,760
deeper into like and then starting from

685
00:24:39,760 --> 00:24:41,760
there

686
00:24:41,760 --> 00:24:43,360
there's a couple of resources available

687
00:24:43,360 --> 00:24:45,520
that are specifically mapped to attack

688
00:24:45,520 --> 00:24:47,120
to be able to kind of help you all like

689
00:24:47,120 --> 00:24:49,440
break like as far as

690
00:24:49,440 --> 00:24:52,960
using this as a resource for mac os

691
00:24:52,960 --> 00:24:54,720
one of them seated has come out with

692
00:24:54,720 --> 00:24:56,400
different emulation plans where

693
00:24:56,400 --> 00:24:57,919
basically they've worked through

694
00:24:57,919 --> 00:24:59,679
different thread actors and then these

695
00:24:59,679 --> 00:25:02,240
scenarios with map to attack to be able

696
00:25:02,240 --> 00:25:04,080
to execute on a host

697
00:25:04,080 --> 00:25:05,760
atomic red team has great resources

698
00:25:05,760 --> 00:25:06,960
where they've actually gone through

699
00:25:06,960 --> 00:25:09,200
these procedures and then added

700
00:25:09,200 --> 00:25:10,960
a test red team essentially red team

701
00:25:10,960 --> 00:25:12,640
test to be able to test those procedures

702
00:25:12,640 --> 00:25:16,320
if you have detection caldera is a also

703
00:25:16,320 --> 00:25:18,880
all these sources are free caldera is

704
00:25:18,880 --> 00:25:21,440
also a project that

705
00:25:21,440 --> 00:25:23,120
miners

706
00:25:23,120 --> 00:25:25,520
pushed out where you can actually use

707
00:25:25,520 --> 00:25:30,080
their oss os or mac os agent to be able

708
00:25:30,080 --> 00:25:31,600
to execute both of these different

709
00:25:31,600 --> 00:25:32,799
libraries on

710
00:25:32,799 --> 00:25:34,720
which is kind of nice to have that like

711
00:25:34,720 --> 00:25:36,559
kind of already baked in open free

712
00:25:36,559 --> 00:25:39,600
project for you to test things out

713
00:25:39,600 --> 00:25:41,600
so walking this through what adversary

714
00:25:41,600 --> 00:25:43,279
emulation can like

715
00:25:43,279 --> 00:25:45,039
basically how to leverage mac os attack

716
00:25:45,039 --> 00:25:47,600
for adversary emulation

717
00:25:47,600 --> 00:25:49,360
there's a scenario right that's a story

718
00:25:49,360 --> 00:25:52,000
line like whodunit where the candlestick

719
00:25:52,000 --> 00:25:53,679
in the library

720
00:25:53,679 --> 00:25:54,960
that guy

721
00:25:54,960 --> 00:25:56,480
the step where it's going to be the

722
00:25:56,480 --> 00:25:57,360
tactic

723
00:25:57,360 --> 00:25:58,640
the sub second procedure which is

724
00:25:58,640 --> 00:26:00,480
actually what actually happened and then

725
00:26:00,480 --> 00:26:04,159
the objective what was the overall goal

726
00:26:04,400 --> 00:26:06,320
the way this kind of fits in to the

727
00:26:06,320 --> 00:26:08,559
adversary emulations plan which is what

728
00:26:08,559 --> 00:26:10,320
this kind of pretty black and white

729
00:26:10,320 --> 00:26:11,760
graphic is of because that's how they

730
00:26:11,760 --> 00:26:14,159
let's see ted has structured their plans

731
00:26:14,159 --> 00:26:14,960
is

732
00:26:14,960 --> 00:26:18,000
inside of one step you have a ton of

733
00:26:18,000 --> 00:26:19,120
tactics

734
00:26:19,120 --> 00:26:20,880
and the thing that i didn't realize

735
00:26:20,880 --> 00:26:23,279
until i started working at mitre or at a

736
00:26:23,279 --> 00:26:25,360
time or on the attack team i should say

737
00:26:25,360 --> 00:26:26,400
was

738
00:26:26,400 --> 00:26:28,480
we have all these other models for

739
00:26:28,480 --> 00:26:31,039
adversary emulation but the real beauty

740
00:26:31,039 --> 00:26:33,120
in attack is that it's like ping pong

741
00:26:33,120 --> 00:26:35,120
you do all like you want to do defensive

742
00:26:35,120 --> 00:26:36,720
asian in addition to execution in

743
00:26:36,720 --> 00:26:38,880
addition like it kind of goes all over

744
00:26:38,880 --> 00:26:40,080
the place it's not this linear

745
00:26:40,080 --> 00:26:41,760
progression only

746
00:26:41,760 --> 00:26:43,279
so that's kind of part of the power

747
00:26:43,279 --> 00:26:45,039
right like there'll be initial access

748
00:26:45,039 --> 00:26:47,520
execution and defensive asian all inside

749
00:26:47,520 --> 00:26:49,679
of one step

750
00:26:49,679 --> 00:26:52,080
so again taking from our wonderful cti

751
00:26:52,080 --> 00:26:53,200
team

752
00:26:53,200 --> 00:26:54,960
where we have this great script that's

753
00:26:54,960 --> 00:26:56,320
already laid out for us that we can

754
00:26:56,320 --> 00:26:58,559
implement that into

755
00:26:58,559 --> 00:27:01,120
our emulation

756
00:27:01,120 --> 00:27:03,039
we can also go further and break it down

757
00:27:03,039 --> 00:27:04,960
so because that's just one chunk of it

758
00:27:04,960 --> 00:27:06,480
right like there's a whole bunch of

759
00:27:06,480 --> 00:27:07,679
other chunks

760
00:27:07,679 --> 00:27:09,360
i was on a

761
00:27:09,360 --> 00:27:10,960
for def con's blue team village i got

762
00:27:10,960 --> 00:27:12,400
the opportunity to serve with like five

763
00:27:12,400 --> 00:27:14,159
other researchers where we did this mac

764
00:27:14,159 --> 00:27:16,080
os thread hunting workshop on ocean

765
00:27:16,080 --> 00:27:18,159
lotus and one of the things that we

766
00:27:18,159 --> 00:27:19,039
found

767
00:27:19,039 --> 00:27:21,120
was it was really hard to come up with

768
00:27:21,120 --> 00:27:23,440
that full picture and it was kind of

769
00:27:23,440 --> 00:27:24,880
neat because working with a whole bunch

770
00:27:24,880 --> 00:27:26,720
of other researchers that do everything

771
00:27:26,720 --> 00:27:28,080
a different way than you do and we all

772
00:27:28,080 --> 00:27:29,919
think we're right right like that's

773
00:27:29,919 --> 00:27:32,159
that's always a fun barrel of laughs

774
00:27:32,159 --> 00:27:33,600
but one of the cool things that kind of

775
00:27:33,600 --> 00:27:36,320
came from it was that

776
00:27:36,320 --> 00:27:38,720
like we all learned a different ways to

777
00:27:38,720 --> 00:27:40,080
apply attack

778
00:27:40,080 --> 00:27:42,640
and that was amazing like and this was

779
00:27:42,640 --> 00:27:44,000
one of those ways where it was like oh

780
00:27:44,000 --> 00:27:45,919
we all had this common name for it and

781
00:27:45,919 --> 00:27:47,840
this is the technique that it was and i

782
00:27:47,840 --> 00:27:49,279
know this is super

783
00:27:49,279 --> 00:27:50,720
tiny print so that's why i'm explaining

784
00:27:50,720 --> 00:27:51,520
this

785
00:27:51,520 --> 00:27:53,440
and then we had the reporting that was

786
00:27:53,440 --> 00:27:55,039
mapped to that technique that we were

787
00:27:55,039 --> 00:27:56,640
actually specifically leveraging for the

788
00:27:56,640 --> 00:27:58,640
emulation so it was just a really cool

789
00:27:58,640 --> 00:28:00,159
way to be able to like gather our

790
00:28:00,159 --> 00:28:01,679
resources know we're talking about the

791
00:28:01,679 --> 00:28:04,880
same thing and then build out that plan

792
00:28:04,880 --> 00:28:06,240
and then this is kind of how it came

793
00:28:06,240 --> 00:28:08,159
together right for ocean lotus they used

794
00:28:08,159 --> 00:28:10,480
a spear phishing attempt

795
00:28:10,480 --> 00:28:12,080
to launch the document which definitely

796
00:28:12,080 --> 00:28:15,279
masqueraded by using the utf-8 to flip

797
00:28:15,279 --> 00:28:17,360
the the dot to make it look like it was

798
00:28:17,360 --> 00:28:19,200
a document when it was actually an app

799
00:28:19,200 --> 00:28:21,919
and then it would launch the script that

800
00:28:21,919 --> 00:28:23,760
adam pulled down earlier and then broke

801
00:28:23,760 --> 00:28:25,760
down into the techniques

802
00:28:25,760 --> 00:28:27,039
and then i left the link up there for

803
00:28:27,039 --> 00:28:28,480
the ocean lotus

804
00:28:28,480 --> 00:28:30,399
our hunt we will eventually release all

805
00:28:30,399 --> 00:28:32,880
of that open source um

806
00:28:32,880 --> 00:28:34,640
but we're polishing

807
00:28:34,640 --> 00:28:35,440
so

808
00:28:35,440 --> 00:28:37,440
if you don't have all of those things or

809
00:28:37,440 --> 00:28:39,840
if you're one of those one-man intel

810
00:28:39,840 --> 00:28:42,240
thread hunting red teaming

811
00:28:42,240 --> 00:28:45,039
magic magician shops um

812
00:28:45,039 --> 00:28:46,720
one of the other ways is by using those

813
00:28:46,720 --> 00:28:48,559
resources those citations right those

814
00:28:48,559 --> 00:28:50,240
little blue numbers

815
00:28:50,240 --> 00:28:52,240
we really try to actually go through all

816
00:28:52,240 --> 00:28:54,000
of the descriptions and then actually

817
00:28:54,000 --> 00:28:56,000
like provide citations that show you

818
00:28:56,000 --> 00:28:58,399
those full commands um this is just one

819
00:28:58,399 --> 00:29:00,320
example of sentinel one's report where

820
00:29:00,320 --> 00:29:02,080
they've kind of gone down and thank you

821
00:29:02,080 --> 00:29:03,840
very much for being like in the wild

822
00:29:03,840 --> 00:29:05,919
examples so we've been able to go and

823
00:29:05,919 --> 00:29:07,200
like pull all of those different

824
00:29:07,200 --> 00:29:09,360
commands and then map them to the right

825
00:29:09,360 --> 00:29:11,200
procedures for that actual software

826
00:29:11,200 --> 00:29:14,320
which has been super helpful

827
00:29:14,320 --> 00:29:15,760
um other things that we've also been

828
00:29:15,760 --> 00:29:17,200
able to load is as we've gone through

829
00:29:17,200 --> 00:29:18,399
and kind of updated things like

830
00:29:18,399 --> 00:29:20,480
gatekeeper right there's this great

831
00:29:20,480 --> 00:29:23,279
article that the evil bit produced and

832
00:29:23,279 --> 00:29:26,640
it went over how to use

833
00:29:26,640 --> 00:29:29,840
specifically ns create object file image

834
00:29:29,840 --> 00:29:32,240
from memory which actually was leveraged

835
00:29:32,240 --> 00:29:34,159
by the lazarus group

836
00:29:34,159 --> 00:29:36,880
for the fireless injection so

837
00:29:36,880 --> 00:29:38,399
it's been kind of cool being able to

838
00:29:38,399 --> 00:29:39,919
pull all these resources and see how

839
00:29:39,919 --> 00:29:41,919
they've all kind of touched each other

840
00:29:41,919 --> 00:29:43,760
and that it's actually execution but it

841
00:29:43,760 --> 00:29:45,600
also provides you the benefit of

842
00:29:45,600 --> 00:29:49,360
bypassing gatekeeper in addition to it

843
00:29:53,600 --> 00:29:55,760
so finally wanted to take one step back

844
00:29:55,760 --> 00:29:58,320
out of the rabbit hole and start pulling

845
00:29:58,320 --> 00:30:00,399
all these pieces together

846
00:30:00,399 --> 00:30:02,080
talk a little bit about leveraging these

847
00:30:02,080 --> 00:30:03,919
bits for doing assessment and

848
00:30:03,919 --> 00:30:07,679
engineering on an environment

849
00:30:07,679 --> 00:30:09,440
this is where we have our opportunity to

850
00:30:09,440 --> 00:30:11,279
actually connect teams so to take the

851
00:30:11,279 --> 00:30:14,159
information that our threat intelligence

852
00:30:14,159 --> 00:30:15,520
our threat hunting or adversary

853
00:30:15,520 --> 00:30:17,840
emulation teams are actually gathering

854
00:30:17,840 --> 00:30:19,679
as they look at threats and look at our

855
00:30:19,679 --> 00:30:21,840
own environment and pull them together

856
00:30:21,840 --> 00:30:23,919
into a bigger picture

857
00:30:23,919 --> 00:30:25,440
this is where we're going to be

858
00:30:25,440 --> 00:30:27,840
examining our tools our documentation

859
00:30:27,840 --> 00:30:29,919
analytics our processes

860
00:30:29,919 --> 00:30:32,159
and so looking at what is it we're doing

861
00:30:32,159 --> 00:30:36,159
today and what are we able to do

862
00:30:36,159 --> 00:30:38,320
so taking a look at our tools what data

863
00:30:38,320 --> 00:30:40,799
sources can we collect and so what have

864
00:30:40,799 --> 00:30:42,240
we already implemented out in our

865
00:30:42,240 --> 00:30:43,760
environment and what are we pulling

866
00:30:43,760 --> 00:30:46,720
together that it might enable for us

867
00:30:46,720 --> 00:30:48,640
what does our documentation say what is

868
00:30:48,640 --> 00:30:50,399
it that we are saying that we're going

869
00:30:50,399 --> 00:30:53,039
to do in response to an adversary

870
00:30:53,039 --> 00:30:54,880
and what do we have for analytics what

871
00:30:54,880 --> 00:30:56,159
is it that we've baked into our

872
00:30:56,159 --> 00:30:58,480
different systems for being able to see

873
00:30:58,480 --> 00:31:00,880
and can we see each of these adversary

874
00:31:00,880 --> 00:31:02,720
specific procedures that we know we

875
00:31:02,720 --> 00:31:05,840
might need to care about

876
00:31:08,080 --> 00:31:10,240
so starting back with our thread intel

877
00:31:10,240 --> 00:31:12,240
picture and this is just the mac os part

878
00:31:12,240 --> 00:31:13,600
of attack

879
00:31:13,600 --> 00:31:15,440
bringing it in a little bit tighter and

880
00:31:15,440 --> 00:31:18,799
this is both the groups and the software

881
00:31:18,799 --> 00:31:20,799
so it's our threat intelligence

882
00:31:20,799 --> 00:31:22,480
techniques are something we might use as

883
00:31:22,480 --> 00:31:24,000
a prioritization

884
00:31:24,000 --> 00:31:24,799
for

885
00:31:24,799 --> 00:31:26,880
where we really care about adversaries

886
00:31:26,880 --> 00:31:28,399
these are things that we know an

887
00:31:28,399 --> 00:31:30,399
adversary we care about is doing

888
00:31:30,399 --> 00:31:34,239
and so make for a good starting point

889
00:31:34,799 --> 00:31:37,039
we can add in the pieces that our threat

890
00:31:37,039 --> 00:31:38,880
hunting team has given us

891
00:31:38,880 --> 00:31:41,679
so what is it that our threat hunting

892
00:31:41,679 --> 00:31:43,600
team has been able to see invisibility

893
00:31:43,600 --> 00:31:45,760
what are they able to look into it's a

894
00:31:45,760 --> 00:31:49,200
notional diagram this is not a specific

895
00:31:49,200 --> 00:31:51,200
network

896
00:31:51,200 --> 00:31:52,640
and we can start to look at where the

897
00:31:52,640 --> 00:31:55,120
overlap is between them what is it that

898
00:31:55,120 --> 00:31:57,760
we already detect today

899
00:31:57,760 --> 00:32:00,159
that adversaries are doing and we're

900
00:32:00,159 --> 00:32:03,039
actually able to hunt for

901
00:32:03,039 --> 00:32:04,640
and something that's really important

902
00:32:04,640 --> 00:32:06,960
here is to validate it

903
00:32:06,960 --> 00:32:09,200
so don't just trust

904
00:32:09,200 --> 00:32:11,200
but this becomes a place where the

905
00:32:11,200 --> 00:32:13,120
results from our adversary emulation red

906
00:32:13,120 --> 00:32:15,279
team are really important so we said

907
00:32:15,279 --> 00:32:17,200
that we see this we said that it's

908
00:32:17,200 --> 00:32:18,480
important

909
00:32:18,480 --> 00:32:21,279
does the detection actually work

910
00:32:21,279 --> 00:32:23,120
and so it's important to go that one

911
00:32:23,120 --> 00:32:24,399
farther step

912
00:32:24,399 --> 00:32:26,000
and make sure that you know what we

913
00:32:26,000 --> 00:32:27,919
think we can see matches what we really

914
00:32:27,919 --> 00:32:30,399
can see

915
00:32:30,960 --> 00:32:32,799
and so it starts to give us

916
00:32:32,799 --> 00:32:35,039
some decisions to make

917
00:32:35,039 --> 00:32:37,039
you know we've got these gaps we can see

918
00:32:37,039 --> 00:32:39,120
these gaps maybe our red team told us we

919
00:32:39,120 --> 00:32:41,360
weren't able to see some of these things

920
00:32:41,360 --> 00:32:45,039
so where is it we want to improve

921
00:32:45,919 --> 00:32:48,320
so especially as we look across mac os

922
00:32:48,320 --> 00:32:49,600
malware

923
00:32:49,600 --> 00:32:52,080
there's some very um there's some things

924
00:32:52,080 --> 00:32:54,159
we see over and over and over again you

925
00:32:54,159 --> 00:32:55,519
know things like command and scripting

926
00:32:55,519 --> 00:32:57,200
interpret a lot of bash scripts out

927
00:32:57,200 --> 00:32:59,760
there um you know os credential dumping

928
00:32:59,760 --> 00:33:01,360
tends to be important and a lot of

929
00:33:01,360 --> 00:33:03,519
different types of operations

930
00:33:03,519 --> 00:33:05,440
and you know seeing things with the

931
00:33:05,440 --> 00:33:07,840
gatekeeper bypass and so seeing those

932
00:33:07,840 --> 00:33:10,159
from a threat actor we've prioritized

933
00:33:10,159 --> 00:33:12,159
maybe that's a place that we really want

934
00:33:12,159 --> 00:33:13,360
to start and it's something that we're

935
00:33:13,360 --> 00:33:16,080
concerned about

936
00:33:17,519 --> 00:33:19,360
maybe we look at what we've already got

937
00:33:19,360 --> 00:33:21,360
so we've already got specific types of

938
00:33:21,360 --> 00:33:23,840
collection on our end systems the logs

939
00:33:23,840 --> 00:33:25,919
were already pulling in today

940
00:33:25,919 --> 00:33:27,679
you know maybe we're watching stuff with

941
00:33:27,679 --> 00:33:30,000
file system activity such that we can

942
00:33:30,000 --> 00:33:32,000
see file and directory discovery or

943
00:33:32,000 --> 00:33:33,360
watching things we're able to see

944
00:33:33,360 --> 00:33:35,600
browser extensions so that we can pull

945
00:33:35,600 --> 00:33:37,600
those in to just add an analytic to use

946
00:33:37,600 --> 00:33:40,799
the data we already have

947
00:33:41,120 --> 00:33:42,559
and finally going back to popular

948
00:33:42,559 --> 00:33:45,039
techniques that we see over and over and

949
00:33:45,039 --> 00:33:47,039
over again on mac

950
00:33:47,039 --> 00:33:49,200
launch agent and launch daemon and you

951
00:33:49,200 --> 00:33:50,880
know sort of watching all things launch

952
00:33:50,880 --> 00:33:53,360
d and maybe there's a lot of bang for

953
00:33:53,360 --> 00:33:55,760
our buck there because they're popular

954
00:33:55,760 --> 00:33:57,039
techniques

955
00:33:57,039 --> 00:33:59,600
we can get across a lot of bang for our

956
00:33:59,600 --> 00:34:02,158
investment

957
00:34:04,159 --> 00:34:05,519
finally there might just be things that

958
00:34:05,519 --> 00:34:07,440
scare us or scare our board scare our

959
00:34:07,440 --> 00:34:08,560
cisso

960
00:34:08,560 --> 00:34:11,119
that you know we we have to focus on uh

961
00:34:11,119 --> 00:34:13,440
just because of the business impact so

962
00:34:13,440 --> 00:34:15,040
you know everyone's afraid of ransomware

963
00:34:15,040 --> 00:34:17,199
today for for good reasons the data

964
00:34:17,199 --> 00:34:18,960
encrypted for impact might be something

965
00:34:18,960 --> 00:34:20,480
we need to focus on

966
00:34:20,480 --> 00:34:22,560
or exploitation of remote services just

967
00:34:22,560 --> 00:34:24,079
because somebody hacking into us from

968
00:34:24,079 --> 00:34:27,440
the outside is going to hurt

969
00:34:29,440 --> 00:34:31,199
and then finally thinking about how to

970
00:34:31,199 --> 00:34:33,520
actually fix these issues need to be

971
00:34:33,520 --> 00:34:36,399
really intentional about improvements

972
00:34:36,399 --> 00:34:38,000
and so the obvious solution you know

973
00:34:38,000 --> 00:34:40,239
most of us are defenders most of us have

974
00:34:40,239 --> 00:34:42,320
worked elbows deep in different sorts of

975
00:34:42,320 --> 00:34:43,918
technical spaces

976
00:34:43,918 --> 00:34:46,239
technical solution is is often the

977
00:34:46,239 --> 00:34:48,639
easiest go-to is often the logical place

978
00:34:48,639 --> 00:34:49,839
for us

979
00:34:49,839 --> 00:34:52,719
but it's not always the right answer

980
00:34:52,719 --> 00:34:54,960
so maybe it is a new detection or a new

981
00:34:54,960 --> 00:34:56,560
data source maybe we need to collect a

982
00:34:56,560 --> 00:34:58,640
new log we were missing before

983
00:34:58,640 --> 00:35:00,320
maybe it's making it so that something's

984
00:35:00,320 --> 00:35:02,400
not possible on in an environment

985
00:35:02,400 --> 00:35:04,800
through a configuration change

986
00:35:04,800 --> 00:35:07,119
but there's also a chance that maybe

987
00:35:07,119 --> 00:35:08,400
it's not something that we're going to

988
00:35:08,400 --> 00:35:10,160
be able to do anything about it's a risk

989
00:35:10,160 --> 00:35:12,640
that we just need to accept

990
00:35:12,640 --> 00:35:13,920
and of course going through and trying

991
00:35:13,920 --> 00:35:15,599
to validate anything we're doing with

992
00:35:15,599 --> 00:35:18,720
adversary emulation

993
00:35:19,119 --> 00:35:20,960
so what do i mean about sort of

994
00:35:20,960 --> 00:35:24,160
different sorts of improvements

995
00:35:24,160 --> 00:35:26,400
so instead of just looking at technical

996
00:35:26,400 --> 00:35:28,800
improvements something that i think is

997
00:35:28,800 --> 00:35:31,040
probably boring for a lot of us but

998
00:35:31,040 --> 00:35:33,200
maybe phishing and user execution so

999
00:35:33,200 --> 00:35:35,200
people clicking on things

1000
00:35:35,200 --> 00:35:39,200
the answer might be more user training

1001
00:35:40,560 --> 00:35:42,079
or you know if we've got something like

1002
00:35:42,079 --> 00:35:44,880
hijack execution flow where our dilib

1003
00:35:44,880 --> 00:35:46,560
stuff was earlier

1004
00:35:46,560 --> 00:35:48,079
you know maybe we actually need to buy a

1005
00:35:48,079 --> 00:35:50,880
new tool to do something see something

1006
00:35:50,880 --> 00:35:53,119
new

1007
00:35:53,839 --> 00:35:56,079
and finally there may be spaces that we

1008
00:35:56,079 --> 00:35:58,800
just mark as off limits

1009
00:35:58,800 --> 00:36:00,480
so something like supply chain

1010
00:36:00,480 --> 00:36:02,320
compromise someone actually inserting

1011
00:36:02,320 --> 00:36:03,520
hardware

1012
00:36:03,520 --> 00:36:05,760
into our devices or being able to

1013
00:36:05,760 --> 00:36:07,760
corrupt our firmware

1014
00:36:07,760 --> 00:36:08,880
may be

1015
00:36:08,880 --> 00:36:12,000
too much for us to really consider and

1016
00:36:12,000 --> 00:36:14,160
so we may need to actually just

1017
00:36:14,160 --> 00:36:18,160
accept that risk and move on

1018
00:36:21,839 --> 00:36:23,440
so the key takeaways that we wanted you

1019
00:36:23,440 --> 00:36:25,760
all to have were this we wanted you all

1020
00:36:25,760 --> 00:36:27,359
to be able to kind of have a common

1021
00:36:27,359 --> 00:36:29,200
language to be able to talk about all of

1022
00:36:29,200 --> 00:36:30,240
these

1023
00:36:30,240 --> 00:36:32,320
honestly like typically perceived as

1024
00:36:32,320 --> 00:36:35,119
very siloed expertise subject matter

1025
00:36:35,119 --> 00:36:37,359
expert areas and then be able to have

1026
00:36:37,359 --> 00:36:38,960
something to be able to commune across

1027
00:36:38,960 --> 00:36:41,920
all of them regarding mac os

1028
00:36:41,920 --> 00:36:43,280
there was actually i was having a

1029
00:36:43,280 --> 00:36:45,680
conversation with a friend at lunch and

1030
00:36:45,680 --> 00:36:48,400
i think half of my job this year has

1031
00:36:48,400 --> 00:36:50,320
been finding ways to integrate myself in

1032
00:36:50,320 --> 00:36:52,320
an intelligence community and integrate

1033
00:36:52,320 --> 00:36:54,960
myself into the like bloggers and red

1034
00:36:54,960 --> 00:36:55,920
teamers

1035
00:36:55,920 --> 00:36:58,400
and and bringing kind of those together

1036
00:36:58,400 --> 00:36:59,920
where they're just trying to have

1037
00:36:59,920 --> 00:37:01,599
conversations

1038
00:37:01,599 --> 00:37:02,720
and

1039
00:37:02,720 --> 00:37:04,720
like the key comes from like the real

1040
00:37:04,720 --> 00:37:06,720
takeaway from that is like this is a

1041
00:37:06,720 --> 00:37:08,720
community driven resource right like

1042
00:37:08,720 --> 00:37:10,960
it's it's all of the people that have

1043
00:37:10,960 --> 00:37:13,119
been like explaining exploits here and

1044
00:37:13,119 --> 00:37:14,320
then going over these incredible

1045
00:37:14,320 --> 00:37:16,880
bypasses like you guys are the ones that

1046
00:37:16,880 --> 00:37:19,040
like let us know like what we need to be

1047
00:37:19,040 --> 00:37:20,880
aware to start updating for it like what

1048
00:37:20,880 --> 00:37:22,480
we need to start targeting like the

1049
00:37:22,480 --> 00:37:23,680
people that are in the intelligence

1050
00:37:23,680 --> 00:37:25,280
community specialize in mac os space

1051
00:37:25,280 --> 00:37:26,640
like you guys are the ones that let us

1052
00:37:26,640 --> 00:37:28,960
know is this actually in the wild and do

1053
00:37:28,960 --> 00:37:30,640
we need to let other people know about

1054
00:37:30,640 --> 00:37:32,160
it right because we're going to use your

1055
00:37:32,160 --> 00:37:33,520
blogs and then we're going to use your

1056
00:37:33,520 --> 00:37:35,119
knowledge of it being actually actively

1057
00:37:35,119 --> 00:37:36,880
used in the wild and then combining that

1058
00:37:36,880 --> 00:37:38,640
so that way we can raise the tide for

1059
00:37:38,640 --> 00:37:39,839
everybody

1060
00:37:39,839 --> 00:37:42,160
and so we're stewards like first and

1061
00:37:42,160 --> 00:37:43,599
foremost right we're not putting out

1062
00:37:43,599 --> 00:37:45,040
like the latest exploit what we're

1063
00:37:45,040 --> 00:37:46,480
trying to put out is

1064
00:37:46,480 --> 00:37:47,440
what

1065
00:37:47,440 --> 00:37:49,599
what's really happening out there and

1066
00:37:49,599 --> 00:37:51,119
providing the resources that you guys

1067
00:37:51,119 --> 00:37:53,200
create to be able to showcase that

1068
00:37:53,200 --> 00:37:55,200
and then just be that relevant resource

1069
00:37:55,200 --> 00:37:58,000
for mac os so like really only good as

1070
00:37:58,000 --> 00:38:00,320
you guys kind of make us so i would

1071
00:38:00,320 --> 00:38:01,599
almost like throw out there like a

1072
00:38:01,599 --> 00:38:04,000
little bit of a call to action does

1073
00:38:04,000 --> 00:38:05,119
like for those of you that have

1074
00:38:05,119 --> 00:38:06,480
definitely been like presenting these

1075
00:38:06,480 --> 00:38:08,800
incredible stories about how you found

1076
00:38:08,800 --> 00:38:10,240
all of these different ways to like

1077
00:38:10,240 --> 00:38:12,400
leverage these behaviors like let us

1078
00:38:12,400 --> 00:38:14,560
know on attack and then like we'll try

1079
00:38:14,560 --> 00:38:16,240
to like to be there for you and rally

1080
00:38:16,240 --> 00:38:18,800
and like find the if it's in the wild or

1081
00:38:18,800 --> 00:38:21,040
not and then so you're not alone out

1082
00:38:21,040 --> 00:38:22,880
there right like we can definitely start

1083
00:38:22,880 --> 00:38:25,760
that conversation if you guys reach out

1084
00:38:25,760 --> 00:38:27,760
but no matter what when it comes down to

1085
00:38:27,760 --> 00:38:30,400
it like we really want attack to be a

1086
00:38:30,400 --> 00:38:31,920
place for you to start if you're getting

1087
00:38:31,920 --> 00:38:33,760
into security in mac os or if you're

1088
00:38:33,760 --> 00:38:35,839
trying to break into a different type of

1089
00:38:35,839 --> 00:38:37,200
technique or you're trying to understand

1090
00:38:37,200 --> 00:38:38,160
something that you really don't know

1091
00:38:38,160 --> 00:38:39,680
that much about but you're just gaining

1092
00:38:39,680 --> 00:38:41,359
insight like we want that to be a

1093
00:38:41,359 --> 00:38:42,960
relevant source for you all no matter

1094
00:38:42,960 --> 00:38:45,960
what

1095
00:38:46,640 --> 00:38:49,040
so some helpful resources um there's

1096
00:38:49,040 --> 00:38:50,320
medium blogs that we put out pretty much

1097
00:38:50,320 --> 00:38:51,760
all the stuff that we publish out we try

1098
00:38:51,760 --> 00:38:53,200
to always do a blog about it especially

1099
00:38:53,200 --> 00:38:54,720
with the release notes you'll notice

1100
00:38:54,720 --> 00:38:55,839
that the release notes for this time

1101
00:38:55,839 --> 00:38:57,839
with mac os will have lots of

1102
00:38:57,839 --> 00:39:00,079
lots of um all the updates and changes

1103
00:39:00,079 --> 00:39:01,920
that we've made to all the techniques

1104
00:39:01,920 --> 00:39:03,920
um there's other resources that i've

1105
00:39:03,920 --> 00:39:05,599
already cited before like david bianco's

1106
00:39:05,599 --> 00:39:07,680
threat hunting blog the open threat

1107
00:39:07,680 --> 00:39:09,599
research forge

1108
00:39:09,599 --> 00:39:12,000
katie nichols did amazing blogs on

1109
00:39:12,000 --> 00:39:13,680
mapping to attack and getting started

1110
00:39:13,680 --> 00:39:14,640
with it

1111
00:39:14,640 --> 00:39:16,240
for those of you that are not familiar

1112
00:39:16,240 --> 00:39:17,280
with it

1113
00:39:17,280 --> 00:39:18,560
and so

1114
00:39:18,560 --> 00:39:21,200
that brings us to our questions

1115
00:39:21,200 --> 00:39:25,439
we actually have time for questions

1116
00:39:27,119 --> 00:39:28,400
we did such a good job you guys are

1117
00:39:28,400 --> 00:39:30,160
silent you're welcome

1118
00:39:30,160 --> 00:39:32,240
yeah um how much

1119
00:39:32,240 --> 00:39:34,800
effort is spent keeping like all the

1120
00:39:34,800 --> 00:39:36,720
frameworks aligned with each other do

1121
00:39:36,720 --> 00:39:38,240
they sort of start to diverge the

1122
00:39:38,240 --> 00:39:40,160
windows

1123
00:39:40,160 --> 00:39:42,480
you know or do you all sort of convene

1124
00:39:42,480 --> 00:39:43,839
and make sure like if you're gonna add a

1125
00:39:43,839 --> 00:39:45,440
new technique that there's sort of a

1126
00:39:45,440 --> 00:39:48,480
windows equivalent or vice versa

1127
00:39:48,480 --> 00:39:49,920
can you take your question for the live

1128
00:39:49,920 --> 00:39:51,359
stream

1129
00:39:51,359 --> 00:39:54,839
take the questions for the livestream

1130
00:39:54,839 --> 00:39:56,480
yeah

1131
00:39:56,480 --> 00:39:58,240
make let me yeah let me make sure i got

1132
00:39:58,240 --> 00:40:00,640
this right so

1133
00:40:00,640 --> 00:40:01,920
how do we basically wrangle all the

1134
00:40:01,920 --> 00:40:03,440
techniques like is there going to be a

1135
00:40:03,440 --> 00:40:04,720
tech when we come up with a new

1136
00:40:04,720 --> 00:40:05,920
technique is there going to be a windows

1137
00:40:05,920 --> 00:40:08,720
equivalent a mac one linux one right is

1138
00:40:08,720 --> 00:40:11,200
that basic question um what we found for

1139
00:40:11,200 --> 00:40:13,760
mac os specifically right like we found

1140
00:40:13,760 --> 00:40:15,680
that there's techniques that only really

1141
00:40:15,680 --> 00:40:19,359
apply to mac os same with windows

1142
00:40:19,359 --> 00:40:21,920
what we do is we all have a conversation

1143
00:40:21,920 --> 00:40:23,200
often together

1144
00:40:23,200 --> 00:40:25,440
we all

1145
00:40:25,440 --> 00:40:27,359
every single week actually all of the

1146
00:40:27,359 --> 00:40:29,520
leads meet and then we go over is this a

1147
00:40:29,520 --> 00:40:31,680
technique is this an exploit is this a

1148
00:40:31,680 --> 00:40:33,520
windows equivalent of this does this

1149
00:40:33,520 --> 00:40:34,960
need to be like underneath the parent

1150
00:40:34,960 --> 00:40:36,880
technique or is this its own special

1151
00:40:36,880 --> 00:40:38,560
snowflake that we really need to call

1152
00:40:38,560 --> 00:40:41,440
out and identify as only mac os

1153
00:40:41,440 --> 00:40:43,280
so that's kind of how we try to handle

1154
00:40:43,280 --> 00:40:45,440
it like for every technique that's put

1155
00:40:45,440 --> 00:40:47,440
out there we do do we

1156
00:40:47,440 --> 00:40:49,440
provide a lot of due diligence to make

1157
00:40:49,440 --> 00:40:51,440
sure that it's

1158
00:40:51,440 --> 00:40:53,040
that the research has been done so you

1159
00:40:53,040 --> 00:40:56,079
can use it as a resource

1160
00:41:04,880 --> 00:41:06,400
yeah so the question is have we done any

1161
00:41:06,400 --> 00:41:08,400
work into automating uh unstructured

1162
00:41:08,400 --> 00:41:10,960
data into a attack

1163
00:41:10,960 --> 00:41:12,880
so um

1164
00:41:12,880 --> 00:41:14,960
there was actually some work released a

1165
00:41:14,960 --> 00:41:16,800
couple hours ago

1166
00:41:16,800 --> 00:41:19,440
from another part of mitre working on

1167
00:41:19,440 --> 00:41:21,920
analyzing unstructured data into attack

1168
00:41:21,920 --> 00:41:23,680
called tram

1169
00:41:23,680 --> 00:41:25,119
so it's a

1170
00:41:25,119 --> 00:41:27,520
tool that is meant to be a natural

1171
00:41:27,520 --> 00:41:30,560
language processor to look at

1172
00:41:30,560 --> 00:41:32,880
processing reports looking at trying to

1173
00:41:32,880 --> 00:41:34,480
match up techniques

1174
00:41:34,480 --> 00:41:37,359
and turn that into attack techniques

1175
00:41:37,359 --> 00:41:39,599
and it is absolutely a research space

1176
00:41:39,599 --> 00:41:40,480
today

1177
00:41:40,480 --> 00:41:42,079
so it's you know natural language

1178
00:41:42,079 --> 00:41:44,480
processing by itself is still a fairly

1179
00:41:44,480 --> 00:41:45,920
nascent field

1180
00:41:45,920 --> 00:41:48,160
uh it turns out a lot of this work ends

1181
00:41:48,160 --> 00:41:50,720
up being really intelligence analysis

1182
00:41:50,720 --> 00:41:53,119
so you know first understanding what it

1183
00:41:53,119 --> 00:41:55,680
is that the report is is talking about

1184
00:41:55,680 --> 00:41:58,000
under the hood turning that sort of back

1185
00:41:58,000 --> 00:41:59,599
into a technical

1186
00:41:59,599 --> 00:42:01,520
technique might have a lot of flowery

1187
00:42:01,520 --> 00:42:03,440
language around it

1188
00:42:03,440 --> 00:42:05,839
and it that's that's still a really hard

1189
00:42:05,839 --> 00:42:08,800
problem for automated analysis so we're

1190
00:42:08,800 --> 00:42:10,240
trying to put out the tools for people

1191
00:42:10,240 --> 00:42:11,680
to be able to test with it build up

1192
00:42:11,680 --> 00:42:13,119
training sets

1193
00:42:13,119 --> 00:42:15,599
and and start to be able to do that but

1194
00:42:15,599 --> 00:42:17,920
we haven't really seen a lot of success

1195
00:42:17,920 --> 00:42:20,079
in the space and there are actually a

1196
00:42:20,079 --> 00:42:21,920
number of academic papers out at this

1197
00:42:21,920 --> 00:42:24,160
point where people have worked on

1198
00:42:24,160 --> 00:42:27,760
doing analysis into attack techniques

1199
00:42:27,760 --> 00:42:29,839
but the recall and precision rates that

1200
00:42:29,839 --> 00:42:32,319
we've seen so far are not

1201
00:42:32,319 --> 00:42:36,720
useful in a production environment

1202
00:42:38,240 --> 00:42:40,960
i will say we as often as we use our own

1203
00:42:40,960 --> 00:42:43,280
product you guys will always use it in a

1204
00:42:43,280 --> 00:42:45,599
way that we do not expect

1205
00:42:45,599 --> 00:42:47,040
okay so

1206
00:42:47,040 --> 00:42:48,720
if there is a way that you're using it

1207
00:42:48,720 --> 00:42:50,960
and you're like this is killing me like

1208
00:42:50,960 --> 00:42:53,280
email us and let us know because we want

1209
00:42:53,280 --> 00:42:55,440
it to be something that like is easy for

1210
00:42:55,440 --> 00:42:57,920
you to use like that's kind of the point

1211
00:42:57,920 --> 00:42:59,440
behind it like if you guys aren't like

1212
00:42:59,440 --> 00:43:01,119
if you guys are causing having more

1213
00:43:01,119 --> 00:43:04,560
frustration then you are like and

1214
00:43:04,560 --> 00:43:06,480
i mean enjoyment's not the best word

1215
00:43:06,480 --> 00:43:08,240
maybe for it but we're gonna go that

1216
00:43:08,240 --> 00:43:09,920
route then like that's something that we

1217
00:43:09,920 --> 00:43:10,800
definitely want to know about like

1218
00:43:10,800 --> 00:43:11,839
someone just told me the other day they

1219
00:43:11,839 --> 00:43:14,720
were like i wish you could just download

1220
00:43:14,720 --> 00:43:17,440
from the matrix page like

1221
00:43:17,440 --> 00:43:19,280
essentially a screenshot or a pdf of

1222
00:43:19,280 --> 00:43:22,400
just the matrix and like i had no idea

1223
00:43:22,400 --> 00:43:24,880
that that was even a thing so like we

1224
00:43:24,880 --> 00:43:26,640
don't know that unless you guys tell us

1225
00:43:26,640 --> 00:43:27,920
same with techniques like if you guys

1226
00:43:27,920 --> 00:43:29,599
want to like add a technique or like

1227
00:43:29,599 --> 00:43:31,440
have like hey there's this behavior like

1228
00:43:31,440 --> 00:43:32,800
email that blurb and start the

1229
00:43:32,800 --> 00:43:35,800
conversation

1230
00:43:47,359 --> 00:43:51,400
i'm actually not familiar with the work

1231
00:44:01,520 --> 00:44:03,119
that sounds like something definitely to

1232
00:44:03,119 --> 00:44:05,040
look into i mean i'm familiar with oasis

1233
00:44:05,040 --> 00:44:08,000
and those organizations certainly

1234
00:44:08,000 --> 00:44:10,240
sam

1235
00:44:10,240 --> 00:44:12,400
all right well thank you guys so much

1236
00:44:12,400 --> 00:44:13,359
and

1237
00:44:13,359 --> 00:44:15,040
yeah we can't be here oh yeah we do have

1238
00:44:15,040 --> 00:44:16,560
one thing

1239
00:44:16,560 --> 00:44:17,680
so

1240
00:44:17,680 --> 00:44:20,960
if any of you want to do a tree pose

1241
00:44:20,960 --> 00:44:22,960
we have to take a picture of it but we

1242
00:44:22,960 --> 00:44:26,240
will give you a flag an attack flag

1243
00:44:26,240 --> 00:44:30,000
which is kind of a hot commodity i hear

1244
00:44:30,000 --> 00:44:31,760
yeah you volunteer

1245
00:44:31,760 --> 00:44:34,240
yeah oh my god i love you yes

1246
00:44:34,240 --> 00:44:37,200
yes that's awesome

1247
00:44:37,200 --> 00:44:38,880
yeah anyone that wants to come up like

1248
00:44:38,880 --> 00:44:40,960
don't be shy

1249
00:44:40,960 --> 00:44:42,720
oh no there's more than one flag oh my

1250
00:44:42,720 --> 00:44:44,400
god people are doing it you guys are

1251
00:44:44,400 --> 00:44:45,510
amazing

1252
00:44:45,510 --> 00:44:48,160
[Music]

1253
00:44:48,160 --> 00:44:50,319
we're gonna have to do uh first in first

1254
00:44:50,319 --> 00:44:51,920
uh

1255
00:44:51,920 --> 00:44:54,720
all right yes

1256
00:44:54,720 --> 00:44:56,079
this is so great

1257
00:44:56,079 --> 00:44:57,839
back to a tree pose

1258
00:44:57,839 --> 00:44:58,720
oh

1259
00:44:58,720 --> 00:45:00,000
if you guys want to know what a tree

1260
00:45:00,000 --> 00:45:03,640
pose looks like

1261
00:45:04,079 --> 00:45:07,280
yes i love it

1262
00:45:14,400 --> 00:45:16,319
you guys are awesome

1263
00:45:16,319 --> 00:45:19,839
such great sports

