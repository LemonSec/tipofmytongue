1
00:00:04,400 --> 00:00:07,279
next up we have sarah

2
00:00:07,279 --> 00:00:08,960
i'm always slightly terrified by her

3
00:00:08,960 --> 00:00:11,519
talks but like in a in a good way um she

4
00:00:11,519 --> 00:00:12,880
always makes me want to go home and like

5
00:00:12,880 --> 00:00:14,880
burn my phone and i

6
00:00:14,880 --> 00:00:16,480
i think this talk's gonna leave me with

7
00:00:16,480 --> 00:00:18,400
the same feeling so let's give a round

8
00:00:18,400 --> 00:00:20,800
of applause for sarah

9
00:00:20,800 --> 00:00:22,960
all right hi i'm i'm sarah edwards uh

10
00:00:22,960 --> 00:00:25,840
and yes i uh do kind of specialize my mo

11
00:00:25,840 --> 00:00:27,439
for these conferences are what can i

12
00:00:27,439 --> 00:00:28,960
find on your devices that it's super

13
00:00:28,960 --> 00:00:31,920
creepy i try to be nice about it but i

14
00:00:31,920 --> 00:00:33,680
think it's something that folks should

15
00:00:33,680 --> 00:00:35,440
know that's on their devices so this

16
00:00:35,440 --> 00:00:37,760
year's talk is going to be all about

17
00:00:37,760 --> 00:00:39,040
apple wallet

18
00:00:39,040 --> 00:00:40,719
and i picked this one specifically

19
00:00:40,719 --> 00:00:42,559
because i think during the last you know

20
00:00:42,559 --> 00:00:44,640
year and a half or so a lot of people

21
00:00:44,640 --> 00:00:46,000
are going a little bit more on the

22
00:00:46,000 --> 00:00:47,280
digital side for a lot of their

23
00:00:47,280 --> 00:00:49,520
financial gain so you know touchless

24
00:00:49,520 --> 00:00:51,920
cashless that whole thing so i thought

25
00:00:51,920 --> 00:00:53,920
apple apple wallet was going to be a

26
00:00:53,920 --> 00:00:57,039
pretty good topic to go through

27
00:00:57,039 --> 00:00:59,440
so as my details are up here i'll have

28
00:00:59,440 --> 00:01:01,120
them at the end as well i did put out

29
00:01:01,120 --> 00:01:03,440
all the slides on the um the talks

30
00:01:03,440 --> 00:01:05,840
discord channel so you can download them

31
00:01:05,840 --> 00:01:07,280
i've specifically put those out there

32
00:01:07,280 --> 00:01:08,400
because i am going to have some

33
00:01:08,400 --> 00:01:11,040
screenshots i do a lot of databases

34
00:01:11,040 --> 00:01:12,720
there's a lot of data and said databases

35
00:01:12,720 --> 00:01:14,320
so it might be a little tricky to see on

36
00:01:14,320 --> 00:01:16,080
the screens here but you do have a copy

37
00:01:16,080 --> 00:01:18,960
of it and if you are on the discord

38
00:01:18,960 --> 00:01:20,560
whether this is a live stream or not

39
00:01:20,560 --> 00:01:22,479
they will be posted to my website as i

40
00:01:22,479 --> 00:01:25,840
usually do for all of my talks later on

41
00:01:25,840 --> 00:01:28,560
uh just a little bit about me um i do uh

42
00:01:28,560 --> 00:01:30,479
by day i am celebrite a digital

43
00:01:30,479 --> 00:01:32,240
forensics researcher at celebrate i do

44
00:01:32,240 --> 00:01:34,400
not do the exploity stuff i do the

45
00:01:34,400 --> 00:01:36,000
forensics stuff

46
00:01:36,000 --> 00:01:37,840
i think some uh someone chat into the

47
00:01:37,840 --> 00:01:39,520
discord channel is like oh are you gonna

48
00:01:39,520 --> 00:01:41,040
you know throw all those new exploits in

49
00:01:41,040 --> 00:01:42,560
there i'm like i have no idea how to do

50
00:01:42,560 --> 00:01:44,960
that that is not me i am not dropping

51
00:01:44,960 --> 00:01:47,200
any exploits or cbes or anything like

52
00:01:47,200 --> 00:01:50,399
that i'm just a weird creepy person

53
00:01:50,399 --> 00:01:51,360
um

54
00:01:51,360 --> 00:01:53,920
so that's my day job and night job is

55
00:01:53,920 --> 00:01:56,159
doing sans instructing so i got the 518

56
00:01:56,159 --> 00:01:57,920
class it's more or less the only mac

57
00:01:57,920 --> 00:01:59,759
class in his hands right now

58
00:01:59,759 --> 00:02:02,399
and that's ios and mac forensic analysis

59
00:02:02,399 --> 00:02:04,000
and incident response so i keep pretty

60
00:02:04,000 --> 00:02:05,759
busy other than that i'm just

61
00:02:05,759 --> 00:02:07,920
researching all the things and maybe

62
00:02:07,920 --> 00:02:11,119
maybe getting some sleep

63
00:02:11,280 --> 00:02:13,200
alright so there's a lot of terms that

64
00:02:13,200 --> 00:02:15,760
get flown around about apple wallet we

65
00:02:15,760 --> 00:02:17,520
have apple wallet we have apple pay we

66
00:02:17,520 --> 00:02:19,760
have apple card we have apple cash

67
00:02:19,760 --> 00:02:21,360
what's the actual difference because

68
00:02:21,360 --> 00:02:23,120
everybody sort of calls it something a

69
00:02:23,120 --> 00:02:25,200
little bit different so i kind of just

70
00:02:25,200 --> 00:02:27,200
sort of distilled it down a little bit

71
00:02:27,200 --> 00:02:30,319
here so apple wallet is the app now you

72
00:02:30,319 --> 00:02:32,400
sometimes may not necessarily see the

73
00:02:32,400 --> 00:02:35,200
app as it's an app self on things like

74
00:02:35,200 --> 00:02:36,319
mac os

75
00:02:36,319 --> 00:02:38,000
but it is still kind of integrated

76
00:02:38,000 --> 00:02:40,480
behind the scenes so we'll call that one

77
00:02:40,480 --> 00:02:42,160
apple wallet

78
00:02:42,160 --> 00:02:44,800
a few other things like apple pay this

79
00:02:44,800 --> 00:02:46,239
i'm going to go with more or less the

80
00:02:46,239 --> 00:02:48,080
technology so there's a lot of the a lot

81
00:02:48,080 --> 00:02:49,519
of behind the scenes stuff with apple

82
00:02:49,519 --> 00:02:51,760
pay we also have things like apple cash

83
00:02:51,760 --> 00:02:54,000
which is sort of the digital debit card

84
00:02:54,000 --> 00:02:55,920
version of that as well

85
00:02:55,920 --> 00:02:59,280
and if you are lucky and cool enough

86
00:02:59,280 --> 00:03:01,519
you get the apple card

87
00:03:01,519 --> 00:03:03,840
titanium

88
00:03:03,840 --> 00:03:05,920
sounds cool and when you give it to

89
00:03:05,920 --> 00:03:07,200
everybody they think you're the coolest

90
00:03:07,200 --> 00:03:08,959
person ever but then they're always

91
00:03:08,959 --> 00:03:10,480
looking at it like where's the number

92
00:03:10,480 --> 00:03:12,319
and all the things on it

93
00:03:12,319 --> 00:03:14,400
so that is the apple card so you can

94
00:03:14,400 --> 00:03:16,720
actually have the titanium version or of

95
00:03:16,720 --> 00:03:18,400
course the digital version on your

96
00:03:18,400 --> 00:03:21,120
mobile devices

97
00:03:21,120 --> 00:03:22,239
all right so we're going to start here

98
00:03:22,239 --> 00:03:24,480
with just the ios app i think this is

99
00:03:24,480 --> 00:03:25,440
where

100
00:03:25,440 --> 00:03:27,760
most people will use apple wallet uh

101
00:03:27,760 --> 00:03:30,239
within the application themselves i have

102
00:03:30,239 --> 00:03:32,319
certainly been using this for not just

103
00:03:32,319 --> 00:03:34,159
in the last few months or so but for

104
00:03:34,159 --> 00:03:36,319
quite a long time i do find it really

105
00:03:36,319 --> 00:03:38,560
nice to just have all of this stuff

106
00:03:38,560 --> 00:03:41,519
accessible on my ios device but now

107
00:03:41,519 --> 00:03:43,280
coming from a security standpoint you're

108
00:03:43,280 --> 00:03:44,480
like well it's got to store this

109
00:03:44,480 --> 00:03:46,400
information somewhere how does it store

110
00:03:46,400 --> 00:03:49,040
it does it get synced what can i pull

111
00:03:49,040 --> 00:03:51,440
off as a forensic analyst to you know do

112
00:03:51,440 --> 00:03:53,120
all the creepy cool stuff that i like to

113
00:03:53,120 --> 00:03:54,159
do

114
00:03:54,159 --> 00:03:56,000
so a little bit about the ios app there

115
00:03:56,000 --> 00:03:57,920
are two primary sections and i want to

116
00:03:57,920 --> 00:03:59,599
point this out because this is how the

117
00:03:59,599 --> 00:04:01,760
data is actually being stored on the

118
00:04:01,760 --> 00:04:04,640
device so you have the top section

119
00:04:04,640 --> 00:04:05,760
this is where your credit cards are

120
00:04:05,760 --> 00:04:06,720
going to be

121
00:04:06,720 --> 00:04:08,480
you're also going to notice and this is

122
00:04:08,480 --> 00:04:10,959
my actual one i try not to put too much

123
00:04:10,959 --> 00:04:13,280
personal data in here but yeah there's

124
00:04:13,280 --> 00:04:15,200
there's going to be some personal data

125
00:04:15,200 --> 00:04:17,440
um i live in dc so i have us a transit

126
00:04:17,440 --> 00:04:19,680
card in here as well so as wamata smart

127
00:04:19,680 --> 00:04:21,759
trip card got a bunch of credit cards in

128
00:04:21,759 --> 00:04:24,560
here yes i fly united everywhere

129
00:04:24,560 --> 00:04:26,880
i got a boatload of apple cash

130
00:04:26,880 --> 00:04:28,960
i always forget to use apple cash so

131
00:04:28,960 --> 00:04:31,280
yeah i kind of racked that up and of

132
00:04:31,280 --> 00:04:33,680
course the fancy digital version of the

133
00:04:33,680 --> 00:04:34,880
apple car

134
00:04:34,880 --> 00:04:37,759
so that's kind of the first section

135
00:04:37,759 --> 00:04:39,600
now right down below here you see that

136
00:04:39,600 --> 00:04:41,600
little spacer this is where everything

137
00:04:41,600 --> 00:04:42,960
else is going to be stored if you buy

138
00:04:42,960 --> 00:04:45,120
movie tickets if you buy your boarding

139
00:04:45,120 --> 00:04:47,919
or you get your boarding passes you

140
00:04:47,919 --> 00:04:49,680
have some loyalty cards you can see i

141
00:04:49,680 --> 00:04:52,240
have my insurance cards in here um your

142
00:04:52,240 --> 00:04:54,320
covid vaccination cards might be in here

143
00:04:54,320 --> 00:04:56,560
if your state approves things like that

144
00:04:56,560 --> 00:04:58,000
so you never know quite what you're

145
00:04:58,000 --> 00:04:59,919
going to find in there and if you

146
00:04:59,919 --> 00:05:01,199
actually look on my device i haven't

147
00:05:01,199 --> 00:05:02,240
scrolled down in this particular

148
00:05:02,240 --> 00:05:04,720
screenshot here but now with ios 15 they

149
00:05:04,720 --> 00:05:07,120
actually hide all of your old passes

150
00:05:07,120 --> 00:05:09,520
that are no longer relevant i have about

151
00:05:09,520 --> 00:05:11,440
200 something

152
00:05:11,440 --> 00:05:13,199
yeah i keep i keep that as digital

153
00:05:13,199 --> 00:05:15,440
litter mostly just for testing purposes

154
00:05:15,440 --> 00:05:18,000
for a lot of my forensic analysis

155
00:05:18,000 --> 00:05:20,000
yeah i'm sort of a digital hoarder if

156
00:05:20,000 --> 00:05:20,880
you will

157
00:05:20,880 --> 00:05:22,400
it's it's great from a forensics

158
00:05:22,400 --> 00:05:23,680
perspective

159
00:05:23,680 --> 00:05:25,039
now a few other things that i do want to

160
00:05:25,039 --> 00:05:27,520
point out here things like file paths so

161
00:05:27,520 --> 00:05:28,800
i'm going to mention a couple of file

162
00:05:28,800 --> 00:05:30,720
paths of course in forensics

163
00:05:30,720 --> 00:05:32,080
actually knowing where this data is

164
00:05:32,080 --> 00:05:34,000
going to be stored is going to be pretty

165
00:05:34,000 --> 00:05:36,080
critical now i'm going to go a little

166
00:05:36,080 --> 00:05:37,600
bit a little bit later on in the

167
00:05:37,600 --> 00:05:40,160
presentation on how easy is it to access

168
00:05:40,160 --> 00:05:42,560
these files and directories and

169
00:05:42,560 --> 00:05:44,880
databases because it's not always the

170
00:05:44,880 --> 00:05:46,080
same and it's going to be a little bit

171
00:05:46,080 --> 00:05:47,520
different depending on what level of

172
00:05:47,520 --> 00:05:49,759
access do i have and specifically with

173
00:05:49,759 --> 00:05:51,520
ios access

174
00:05:51,520 --> 00:05:53,440
so just that heads up with that

175
00:05:53,440 --> 00:05:56,000
you'll see passes here and i will talk

176
00:05:56,000 --> 00:05:58,720
about icloud syncing of different passes

177
00:05:58,720 --> 00:06:00,080
you're going to go find those under the

178
00:06:00,080 --> 00:06:03,600
ubiquitous cards so ubiquitous ubiquity

179
00:06:03,600 --> 00:06:05,520
a term that is often used when apple is

180
00:06:05,520 --> 00:06:08,160
talking about things all things icloud

181
00:06:08,160 --> 00:06:10,560
and where'd you put old passes

182
00:06:10,560 --> 00:06:12,160
i always thought this was cute

183
00:06:12,160 --> 00:06:13,759
in your shoebox

184
00:06:13,759 --> 00:06:14,960
right

185
00:06:14,960 --> 00:06:17,360
so com tilde apple tilde shoebox those

186
00:06:17,360 --> 00:06:19,039
tilde directories that's going to be in

187
00:06:19,039 --> 00:06:20,560
your mobile documents the mobile

188
00:06:20,560 --> 00:06:22,720
documents is what all your icloud stuff

189
00:06:22,720 --> 00:06:24,160
is syncing to

190
00:06:24,160 --> 00:06:26,479
so if you do have icloud syncing turned

191
00:06:26,479 --> 00:06:28,800
on don't be surprised if you're seeing a

192
00:06:28,800 --> 00:06:31,759
bunch of different passes and tickets

193
00:06:31,759 --> 00:06:34,880
being stored in there

194
00:06:34,880 --> 00:06:36,560
all right so let's talk about the passes

195
00:06:36,560 --> 00:06:38,720
first uh so i like to go over this one

196
00:06:38,720 --> 00:06:40,479
because this one i think is one that

197
00:06:40,479 --> 00:06:41,840
most folks if you're kind of looking at

198
00:06:41,840 --> 00:06:43,680
your own devices right now you're

199
00:06:43,680 --> 00:06:45,440
probably going to find on your devices

200
00:06:45,440 --> 00:06:47,600
it's one of the easier things to find

201
00:06:47,600 --> 00:06:50,080
they're also available in ios backups

202
00:06:50,080 --> 00:06:52,240
encrypted or unencrypted of course full

203
00:06:52,240 --> 00:06:54,400
file system dumps your gray keys your

204
00:06:54,400 --> 00:06:56,639
celebrites gotta mention the tools at

205
00:06:56,639 --> 00:06:58,160
some point as well

206
00:06:58,160 --> 00:06:59,919
so these are some pretty interesting

207
00:06:59,919 --> 00:07:02,639
pieces now like i said i keep all of my

208
00:07:02,639 --> 00:07:05,440
cards digital clutter now i know that

209
00:07:05,440 --> 00:07:06,720
there's going to be some folks in here

210
00:07:06,720 --> 00:07:09,520
who are as soon as they land that ticket

211
00:07:09,520 --> 00:07:11,360
is gone from their device so these

212
00:07:11,360 --> 00:07:12,800
things are not going to stick around

213
00:07:12,800 --> 00:07:14,240
persistently

214
00:07:14,240 --> 00:07:15,919
but you might find that they are synced

215
00:07:15,919 --> 00:07:17,680
between different devices assuming that

216
00:07:17,680 --> 00:07:20,080
icloud services is turned on so you're

217
00:07:20,080 --> 00:07:21,280
going to have a boatload of different

218
00:07:21,280 --> 00:07:22,720
past types

219
00:07:22,720 --> 00:07:24,240
i have of course a bunch of united

220
00:07:24,240 --> 00:07:26,720
tickets i have hotel stays i have

221
00:07:26,720 --> 00:07:29,440
insurance cards loyalty cards starbucks

222
00:07:29,440 --> 00:07:30,400
cards

223
00:07:30,400 --> 00:07:32,240
a ton of different things being stored

224
00:07:32,240 --> 00:07:34,080
in there so when you go find these in

225
00:07:34,080 --> 00:07:35,919
the directories and i'm using the

226
00:07:35,919 --> 00:07:38,160
ubiquitous one here from my own this is

227
00:07:38,160 --> 00:07:40,000
from my own mac system here you're going

228
00:07:40,000 --> 00:07:42,319
to notice that there's these pk pass

229
00:07:42,319 --> 00:07:44,400
package directories so they look like

230
00:07:44,400 --> 00:07:46,000
directories to me but they are actually

231
00:07:46,000 --> 00:07:47,840
in a package format

232
00:07:47,840 --> 00:07:50,000
and they have this really strange number

233
00:07:50,000 --> 00:07:52,319
you know just a base64 number i haven't

234
00:07:52,319 --> 00:07:54,720
found any reason to on base64 of that

235
00:07:54,720 --> 00:07:56,720
but that's how it's going to be located

236
00:07:56,720 --> 00:07:58,560
in the database so that's just a heads

237
00:07:58,560 --> 00:07:59,919
up there they all kind of look a little

238
00:07:59,919 --> 00:08:01,919
bit strange with that one now if we

239
00:08:01,919 --> 00:08:03,680
actually go into

240
00:08:03,680 --> 00:08:06,000
one of these pk pass directories or

241
00:08:06,000 --> 00:08:07,759
packages you're going to find something

242
00:08:07,759 --> 00:08:09,360
that looks like this there's a lot of

243
00:08:09,360 --> 00:08:11,039
logos in there you know you're not

244
00:08:11,039 --> 00:08:13,120
united logos your progressive logos

245
00:08:13,120 --> 00:08:15,280
whatever the ticket is actually for

246
00:08:15,280 --> 00:08:16,800
the juicy bits

247
00:08:16,800 --> 00:08:19,199
are in that pass.json

248
00:08:19,199 --> 00:08:21,520
so for once it's not a plist file it's

249
00:08:21,520 --> 00:08:23,919
actually a json file now whenever you

250
00:08:23,919 --> 00:08:26,639
kind of it's called ingesting a ticket

251
00:08:26,639 --> 00:08:28,639
so you check in for your flight 24 hours

252
00:08:28,639 --> 00:08:30,479
ahead of time there's that little add to

253
00:08:30,479 --> 00:08:31,919
apple wallet

254
00:08:31,919 --> 00:08:33,919
number or a little button there that's

255
00:08:33,919 --> 00:08:35,599
the ingestion you're actually in taking

256
00:08:35,599 --> 00:08:37,360
that pk pass

257
00:08:37,360 --> 00:08:39,599
file directory package structure and

258
00:08:39,599 --> 00:08:41,919
importing it into your device

259
00:08:41,919 --> 00:08:43,839
so it is uh reading all the information

260
00:08:43,839 --> 00:08:45,760
from past.json

261
00:08:45,760 --> 00:08:47,680
so a few other directories in there but

262
00:08:47,680 --> 00:08:49,360
i will get into some more of the details

263
00:08:49,360 --> 00:08:51,120
associated with those so every ticket is

264
00:08:51,120 --> 00:08:53,440
going to be a little bit different

265
00:08:53,440 --> 00:08:55,200
depending on what type of data the

266
00:08:55,200 --> 00:08:58,880
provider actually wants to put in there

267
00:09:00,399 --> 00:09:02,399
so pk pass package

268
00:09:02,399 --> 00:09:04,240
again it's just it's just a package it's

269
00:09:04,240 --> 00:09:05,760
just a directory when i'm looking at it

270
00:09:05,760 --> 00:09:08,080
from a forensics tool i'm going to open

271
00:09:08,080 --> 00:09:10,240
up pas.json now what you're going to

272
00:09:10,240 --> 00:09:12,240
find is that the json is kind of a

273
00:09:12,240 --> 00:09:13,680
little bit all over the place it really

274
00:09:13,680 --> 00:09:15,519
depends on the provider sometimes

275
00:09:15,519 --> 00:09:16,720
there's white space sometimes there's

276
00:09:16,720 --> 00:09:18,080
not so for this one i'm actually

277
00:09:18,080 --> 00:09:19,920
throwing it to jq

278
00:09:19,920 --> 00:09:21,360
just so you can see some of the

279
00:09:21,360 --> 00:09:22,880
different details that are going to be

280
00:09:22,880 --> 00:09:24,240
stored in there you're going to have

281
00:09:24,240 --> 00:09:25,920
things like the identifiers for that

282
00:09:25,920 --> 00:09:28,959
this one is just an e-tix ticket

283
00:09:28,959 --> 00:09:30,640
so just an example of what you might see

284
00:09:30,640 --> 00:09:33,279
in the gui versus what the pass.json

285
00:09:33,279 --> 00:09:35,040
format actually looks like

286
00:09:35,040 --> 00:09:36,720
i took the opportunity during the

287
00:09:36,720 --> 00:09:38,640
pandemic to actually go to a lot of the

288
00:09:38,640 --> 00:09:41,360
smithsonian museums in dc when there's

289
00:09:41,360 --> 00:09:43,519
absolutely no tourists

290
00:09:43,519 --> 00:09:45,440
it's amazing

291
00:09:45,440 --> 00:09:47,279
but i would highly recommend doing that

292
00:09:47,279 --> 00:09:48,640
but of course right now you do have to

293
00:09:48,640 --> 00:09:51,040
get timed tickets so this is one of

294
00:09:51,040 --> 00:09:52,959
those tickets so this one's going to

295
00:09:52,959 --> 00:09:54,399
keep track of

296
00:09:54,399 --> 00:09:56,080
you know some fairly simple things just

297
00:09:56,080 --> 00:09:57,920
general admission you got order numbers

298
00:09:57,920 --> 00:10:00,160
in here so different order numbers

299
00:10:00,160 --> 00:10:02,240
general emission some time stamping some

300
00:10:02,240 --> 00:10:04,880
description items in here but just know

301
00:10:04,880 --> 00:10:07,360
that other tickets may have a lot more

302
00:10:07,360 --> 00:10:09,440
detailed information specifically

303
00:10:09,440 --> 00:10:11,120
boarding passes you can tell you know

304
00:10:11,120 --> 00:10:12,560
what seat you're in

305
00:10:12,560 --> 00:10:14,800
what your mileage number is

306
00:10:14,800 --> 00:10:16,399
other you know are you sitting in

307
00:10:16,399 --> 00:10:18,000
business class do you have an exit row

308
00:10:18,000 --> 00:10:20,160
seat there's a lot of different bits of

309
00:10:20,160 --> 00:10:22,079
details that are actually being stored

310
00:10:22,079 --> 00:10:22,959
in these

311
00:10:22,959 --> 00:10:26,239
pk pass files

312
00:10:27,360 --> 00:10:28,880
all right next up now let's get to the

313
00:10:28,880 --> 00:10:30,079
juicy stuff

314
00:10:30,079 --> 00:10:33,200
what is sarah buying what can i look to

315
00:10:33,200 --> 00:10:35,760
see what cars does she have uh is she

316
00:10:35,760 --> 00:10:37,920
sending apple cash back and forth to her

317
00:10:37,920 --> 00:10:40,240
friends uh does she use the apple card

318
00:10:40,240 --> 00:10:42,720
what other credit cards does she use uh

319
00:10:42,720 --> 00:10:44,399
does she use the transit card where is

320
00:10:44,399 --> 00:10:46,480
she going when is she going

321
00:10:46,480 --> 00:10:48,720
and just going to talk all about the

322
00:10:48,720 --> 00:10:50,640
main database here and this is going to

323
00:10:50,640 --> 00:10:53,680
be the passes23.sqlite

324
00:10:53,680 --> 00:10:55,279
so this database has been around for

325
00:10:55,279 --> 00:10:56,880
quite a few years

326
00:10:56,880 --> 00:10:58,640
one thing though is if you look at this

327
00:10:58,640 --> 00:11:01,360
database maybe let's say five years ago

328
00:11:01,360 --> 00:11:02,800
versus today

329
00:11:02,800 --> 00:11:04,480
it's one of the databases that i have

330
00:11:04,480 --> 00:11:07,120
found that has drastically changed over

331
00:11:07,120 --> 00:11:09,440
time now apple changes their database

332
00:11:09,440 --> 00:11:12,000
formats and schemas all the time drives

333
00:11:12,000 --> 00:11:14,079
me absolutely crazy because i'm always

334
00:11:14,079 --> 00:11:15,920
having to change my queries to pull out

335
00:11:15,920 --> 00:11:17,760
the information that i want

336
00:11:17,760 --> 00:11:19,839
this one in particular has been

337
00:11:19,839 --> 00:11:22,480
absolutely maddening for a whole

338
00:11:22,480 --> 00:11:25,279
different reason

339
00:11:25,680 --> 00:11:28,720
it's the weirdest schema i have ever

340
00:11:28,720 --> 00:11:30,000
ever seen

341
00:11:30,000 --> 00:11:31,040
it's just

342
00:11:31,040 --> 00:11:32,720
i don't know what they're smoking when

343
00:11:32,720 --> 00:11:33,920
they were building this what the

344
00:11:33,920 --> 00:11:35,839
developer was actually thinking

345
00:11:35,839 --> 00:11:37,200
but just looking at these different

346
00:11:37,200 --> 00:11:40,640
tables first off we're looking at 166

347
00:11:40,640 --> 00:11:44,079
tables that's an insane amount i know

348
00:11:44,079 --> 00:11:46,000
what some of these are containing some

349
00:11:46,000 --> 00:11:48,560
of them i have absolutely no freaking

350
00:11:48,560 --> 00:11:50,880
clue what's going to be stored in there

351
00:11:50,880 --> 00:11:52,240
so we have

352
00:11:52,240 --> 00:11:53,920
some interesting things here you know if

353
00:11:53,920 --> 00:11:55,920
you ever look for you know some obscure

354
00:11:55,920 --> 00:11:58,399
fruits

355
00:11:58,800 --> 00:12:00,160
they're gonna be in here you've got your

356
00:12:00,160 --> 00:12:02,000
good old durian in here

357
00:12:02,000 --> 00:12:04,480
your your keith

358
00:12:04,480 --> 00:12:05,680
i'd like to think that maybe one of the

359
00:12:05,680 --> 00:12:07,279
developers is called keith and like yeah

360
00:12:07,279 --> 00:12:08,639
i'm totally gonna put a table with my

361
00:12:08,639 --> 00:12:10,880
own stuff in there i actually think it's

362
00:12:10,880 --> 00:12:13,519
empty but i do think it's

363
00:12:13,519 --> 00:12:16,320
quite an interesting schema so it keeps

364
00:12:16,320 --> 00:12:18,320
going

365
00:12:18,320 --> 00:12:20,079
and keeps going and keeps going since

366
00:12:20,079 --> 00:12:22,800
you know 166 tables and whatnot but once

367
00:12:22,800 --> 00:12:24,800
you start looking into the actual

368
00:12:24,800 --> 00:12:26,880
structure of some of these tables what

369
00:12:26,880 --> 00:12:28,480
you're going to find

370
00:12:28,480 --> 00:12:30,399
is that it's again that security through

371
00:12:30,399 --> 00:12:32,480
obscurity there are not these table

372
00:12:32,480 --> 00:12:34,800
names these row names these column names

373
00:12:34,800 --> 00:12:37,200
are not very helpful what the heck is an

374
00:12:37,200 --> 00:12:39,920
abcde i i don't know i actually have to

375
00:12:39,920 --> 00:12:42,000
go in there and figure that out which

376
00:12:42,000 --> 00:12:43,760
means from a forensics perspective when

377
00:12:43,760 --> 00:12:45,600
i'm trying to figure out a query to pull

378
00:12:45,600 --> 00:12:48,399
this information out it takes absolutely

379
00:12:48,399 --> 00:12:50,639
forever i can't just assume that the

380
00:12:50,639 --> 00:12:53,120
column number or the column name is

381
00:12:53,120 --> 00:12:55,760
actually what it is like what's an e

382
00:12:55,760 --> 00:12:57,519
versus a m

383
00:12:57,519 --> 00:12:59,200
i don't know i got to kind of experiment

384
00:12:59,200 --> 00:13:01,120
i got to do a lot of testing with this

385
00:13:01,120 --> 00:13:01,920
one

386
00:13:01,920 --> 00:13:04,800
so this database in particular

387
00:13:04,800 --> 00:13:06,880
giant pain in the butt uh but it's got

388
00:13:06,880 --> 00:13:09,120
some really interesting pieces of

389
00:13:09,120 --> 00:13:12,079
information in here

390
00:13:12,720 --> 00:13:14,959
all right so let's uh first extract the

391
00:13:14,959 --> 00:13:17,040
cards and passes so maybe you just want

392
00:13:17,040 --> 00:13:18,480
a quick listing you know what kind of

393
00:13:18,480 --> 00:13:19,920
passes are in here what kind of credit

394
00:13:19,920 --> 00:13:21,920
cards are associated in here

395
00:13:21,920 --> 00:13:23,040
so what you're going to find with a lot

396
00:13:23,040 --> 00:13:24,480
of these screenshots is that i kind of

397
00:13:24,480 --> 00:13:26,399
go back and forth between a test device

398
00:13:26,399 --> 00:13:27,920
and my own device

399
00:13:27,920 --> 00:13:29,680
so for the sake of trying to keep some

400
00:13:29,680 --> 00:13:31,839
of my personal information still private

401
00:13:31,839 --> 00:13:33,360
you'll notice that some of this is still

402
00:13:33,360 --> 00:13:35,040
test data so if you're like oh my god i

403
00:13:35,040 --> 00:13:36,320
can't believe she's showing this kind of

404
00:13:36,320 --> 00:13:37,360
information

405
00:13:37,360 --> 00:13:39,040
i'm pretty sure i rejected whatever i

406
00:13:39,040 --> 00:13:40,880
wanted to redact but you never know you

407
00:13:40,880 --> 00:13:42,959
might get some some useful information

408
00:13:42,959 --> 00:13:44,079
out of it

409
00:13:44,079 --> 00:13:45,519
but this one is definitely one of my

410
00:13:45,519 --> 00:13:47,519
test devices

411
00:13:47,519 --> 00:13:49,360
and we can see that i am i got the query

412
00:13:49,360 --> 00:13:50,560
here i'm not going to show you the sql

413
00:13:50,560 --> 00:13:52,560
query for each of them uh some of the

414
00:13:52,560 --> 00:13:54,560
other transactional information is quite

415
00:13:54,560 --> 00:13:57,279
a bit larger i am going to release these

416
00:13:57,279 --> 00:13:59,519
queries as part of my apollo project a

417
00:13:59,519 --> 00:14:01,199
little bit later on once i kind of

418
00:14:01,199 --> 00:14:03,279
polish it up just a little bit

419
00:14:03,279 --> 00:14:05,120
but i do want to show you that

420
00:14:05,120 --> 00:14:06,959
there is some structure to this you know

421
00:14:06,959 --> 00:14:09,120
i am joining a few different tables here

422
00:14:09,120 --> 00:14:10,480
none of the fruit tables in this

423
00:14:10,480 --> 00:14:12,639
particular query those come out in other

424
00:14:12,639 --> 00:14:14,800
places but this is just going to show me

425
00:14:14,800 --> 00:14:17,519
things like when was this ticket or when

426
00:14:17,519 --> 00:14:20,320
was this credit card actually added to

427
00:14:20,320 --> 00:14:22,639
the person's apple wallet so we had this

428
00:14:22,639 --> 00:14:24,720
ingested date here this is going to tell

429
00:14:24,720 --> 00:14:27,199
me when this was ingested

430
00:14:27,199 --> 00:14:29,040
versus a modification date so this is

431
00:14:29,040 --> 00:14:30,639
going to tell me

432
00:14:30,639 --> 00:14:34,560
say if i ingest a airline boarding pass

433
00:14:34,560 --> 00:14:36,160
if i get a seat upgrade or something

434
00:14:36,160 --> 00:14:38,320
like that it wants to update the pass it

435
00:14:38,320 --> 00:14:40,639
wants to change that or maybe it's the

436
00:14:40,639 --> 00:14:43,600
gate has changed whatever reason it gets

437
00:14:43,600 --> 00:14:44,480
modified

438
00:14:44,480 --> 00:14:46,160
that timestamp is also going to be

439
00:14:46,160 --> 00:14:47,920
pretty useful to me to start putting

440
00:14:47,920 --> 00:14:49,920
context to this so i'm using all this

441
00:14:49,920 --> 00:14:51,760
data to figure out

442
00:14:51,760 --> 00:14:54,000
what was the user doing at a particular

443
00:14:54,000 --> 00:14:56,480
time period if i'm used to trying to

444
00:14:56,480 --> 00:14:58,399
take this information and maybe pivot

445
00:14:58,399 --> 00:15:00,320
off of it you know maybe look for other

446
00:15:00,320 --> 00:15:02,959
applications other data files

447
00:15:02,959 --> 00:15:04,320
you know maybe i'm interested of when

448
00:15:04,320 --> 00:15:06,000
they were doing some traveling and

449
00:15:06,000 --> 00:15:07,519
things like that

450
00:15:07,519 --> 00:15:09,199
so i have these time stamps i have

451
00:15:09,199 --> 00:15:11,680
either if it's a card or a pass you're

452
00:15:11,680 --> 00:15:13,920
going to notice that the cards here

453
00:15:13,920 --> 00:15:15,440
you'll notice that they are

454
00:15:15,440 --> 00:15:16,720
they do sound like credit cards it's

455
00:15:16,720 --> 00:15:18,639
apple american express this one's just a

456
00:15:18,639 --> 00:15:19,760
gift card

457
00:15:19,760 --> 00:15:21,600
uh the wamada the

458
00:15:21,600 --> 00:15:24,560
washington metro transit card is in here

459
00:15:24,560 --> 00:15:26,320
and they all have the bundle id here of

460
00:15:26,320 --> 00:15:28,279
the past type

461
00:15:28,279 --> 00:15:30,079
paymentpass.com.apple so that's a really

462
00:15:30,079 --> 00:15:32,480
big kind of identifier say this one is

463
00:15:32,480 --> 00:15:35,199
more financially based versus say an

464
00:15:35,199 --> 00:15:37,920
eventbrite ticket for a movie or a you

465
00:15:37,920 --> 00:15:40,800
know an event or my starbucks gift card

466
00:15:40,800 --> 00:15:43,199
but this pass type here does provide a

467
00:15:43,199 --> 00:15:44,880
little bit of context if i really need

468
00:15:44,880 --> 00:15:47,120
to know for whatever reason when was the

469
00:15:47,120 --> 00:15:49,360
last time that they changed or updated

470
00:15:49,360 --> 00:15:51,120
their starbucks

471
00:15:51,120 --> 00:15:52,480
you know maybe that is part of an

472
00:15:52,480 --> 00:15:54,399
investigation somewhere i'm probably

473
00:15:54,399 --> 00:15:56,320
going to go take a closer look at that

474
00:15:56,320 --> 00:15:58,639
card now with that one i'm probably not

475
00:15:58,639 --> 00:16:00,720
going to find too much information

476
00:16:00,720 --> 00:16:02,320
further things like their starbucks

477
00:16:02,320 --> 00:16:04,000
order and things like that but that's

478
00:16:04,000 --> 00:16:05,279
going to give me some information to

479
00:16:05,279 --> 00:16:07,040
maybe go to the starbucks application

480
00:16:07,040 --> 00:16:10,639
itself or maybe you get emailed receipts

481
00:16:10,639 --> 00:16:12,480
so i might go to email to provide a

482
00:16:12,480 --> 00:16:14,800
little bit more context surrounding that

483
00:16:14,800 --> 00:16:16,800
particular event

484
00:16:16,800 --> 00:16:18,240
other things in here

485
00:16:18,240 --> 00:16:19,440
and i'm not showing you all the

486
00:16:19,440 --> 00:16:20,320
different things that are going to be

487
00:16:20,320 --> 00:16:22,240
stored in these databases because you

488
00:16:22,240 --> 00:16:24,000
will never see all the different pieces

489
00:16:24,000 --> 00:16:25,600
on these screenshots

490
00:16:25,600 --> 00:16:27,279
like you know the order how do they have

491
00:16:27,279 --> 00:16:30,240
these ordered uh the different accounts

492
00:16:30,240 --> 00:16:32,399
numbers here so not the full account

493
00:16:32,399 --> 00:16:34,000
you'll be very happy to know that the

494
00:16:34,000 --> 00:16:36,079
full credit card numbers are not stored

495
00:16:36,079 --> 00:16:38,320
in here so that has been verified i

496
00:16:38,320 --> 00:16:39,680
would be very surprised if somebody

497
00:16:39,680 --> 00:16:41,759
hadn't caught that anyway

498
00:16:41,759 --> 00:16:44,480
and country code information as well so

499
00:16:44,480 --> 00:16:45,839
if you've got a variety of different

500
00:16:45,839 --> 00:16:47,519
credit cards from different countries

501
00:16:47,519 --> 00:16:49,360
that would certainly be of investigative

502
00:16:49,360 --> 00:16:51,839
value

503
00:16:53,120 --> 00:16:55,519
all right now how about apple cash so

504
00:16:55,519 --> 00:16:57,680
you got the apple card you get apple

505
00:16:57,680 --> 00:17:00,639
cash as well so apple cash is more or

506
00:17:00,639 --> 00:17:03,440
less just debit it's just digital cash

507
00:17:03,440 --> 00:17:06,079
if i need to send um you know patrick 20

508
00:17:06,079 --> 00:17:08,079
bucks for whatever

509
00:17:08,079 --> 00:17:09,280
you'll take it

510
00:17:09,280 --> 00:17:10,799
okay

511
00:17:10,799 --> 00:17:12,959
you take 40. all right you're driving a

512
00:17:12,959 --> 00:17:14,799
hard bargain here so i'll send him a

513
00:17:14,799 --> 00:17:16,480
message i'll go through the little

514
00:17:16,480 --> 00:17:17,919
little applet that they have in the

515
00:17:17,919 --> 00:17:20,319
messages application say hey here's 40

516
00:17:20,319 --> 00:17:23,439
bucks and uh thanks for you know

517
00:17:23,439 --> 00:17:24,799
i don't know putting on an awesome

518
00:17:24,799 --> 00:17:27,439
conference in maui of all things so

519
00:17:27,439 --> 00:17:29,280
super happy to be here totally worth 40

520
00:17:29,280 --> 00:17:30,480
bucks right

521
00:17:30,480 --> 00:17:34,080
yes excellent um maybe maybe more than

522
00:17:34,080 --> 00:17:35,760
that um

523
00:17:35,760 --> 00:17:37,840
but yeah so i'm going to see these uh

524
00:17:37,840 --> 00:17:40,240
these are called peer payments so i know

525
00:17:40,240 --> 00:17:42,799
it's not really an interesting term but

526
00:17:42,799 --> 00:17:45,360
we are peers and i am paying them i

527
00:17:45,360 --> 00:17:47,760
don't know uh send and receive so i can

528
00:17:47,760 --> 00:17:50,320
sort of uh take this database here i can

529
00:17:50,320 --> 00:17:52,640
see the transaction date the amount uh

530
00:17:52,640 --> 00:17:54,400
how how many um

531
00:17:54,400 --> 00:17:56,160
how many bucks uh what currency it's

532
00:17:56,160 --> 00:17:58,480
actually in sent received uh

533
00:17:58,480 --> 00:18:00,720
interestingly uh the peer payment handle

534
00:18:00,720 --> 00:18:02,880
which is going to be their apple id

535
00:18:02,880 --> 00:18:05,280
and a memo so if i say you know hey this

536
00:18:05,280 --> 00:18:07,280
is 15 bucks for groceries that's going

537
00:18:07,280 --> 00:18:08,960
to be added in there provides a little

538
00:18:08,960 --> 00:18:11,280
bit more context all right so cool so

539
00:18:11,280 --> 00:18:13,360
what can i do with this information well

540
00:18:13,360 --> 00:18:15,360
if i really want to know for groceries

541
00:18:15,360 --> 00:18:17,039
you know maybe that's a code word for

542
00:18:17,039 --> 00:18:18,559
something a little bit more interesting

543
00:18:18,559 --> 00:18:20,240
maybe i'm doing a drug investigation or

544
00:18:20,240 --> 00:18:21,679
something like that

545
00:18:21,679 --> 00:18:23,039
i'm going to take a look at that maybe

546
00:18:23,039 --> 00:18:25,600
that time frame is of interest to me and

547
00:18:25,600 --> 00:18:27,360
i'm going to go into things like the

548
00:18:27,360 --> 00:18:30,000
messages application so sms.db or

549
00:18:30,000 --> 00:18:32,240
chat.db depending on which platform you

550
00:18:32,240 --> 00:18:35,120
are on i want to get more context so i

551
00:18:35,120 --> 00:18:36,880
only see that one message but what were

552
00:18:36,880 --> 00:18:39,039
they talking about a little bit before a

553
00:18:39,039 --> 00:18:41,039
little bit after so i'm going to kind of

554
00:18:41,039 --> 00:18:43,440
move over there just to get a little bit

555
00:18:43,440 --> 00:18:45,760
more information maybe it truly actually

556
00:18:45,760 --> 00:18:47,840
is just groceries you know you never

557
00:18:47,840 --> 00:18:49,440
know sometimes this stuff is kind of

558
00:18:49,440 --> 00:18:50,880
boring

559
00:18:50,880 --> 00:18:53,200
so i could do that so that is one way

560
00:18:53,200 --> 00:18:54,640
that i could use this in different

561
00:18:54,640 --> 00:18:57,440
investigations

562
00:18:57,440 --> 00:18:59,679
next thing in here you got apple cash

563
00:18:59,679 --> 00:19:01,919
you get daily cash with your apple card

564
00:19:01,919 --> 00:19:03,520
so they do have those percentages that

565
00:19:03,520 --> 00:19:05,840
come back you know one two three percent

566
00:19:05,840 --> 00:19:07,360
you'll notice that i have a boatload of

567
00:19:07,360 --> 00:19:09,919
apple cash because i completely forget

568
00:19:09,919 --> 00:19:12,160
to use it every single time it just

569
00:19:12,160 --> 00:19:13,919
starts adding up and adding up and

570
00:19:13,919 --> 00:19:15,760
adding up so maybe at some point i'll

571
00:19:15,760 --> 00:19:17,760
buy myself something real nice with my

572
00:19:17,760 --> 00:19:19,280
apple cash but they're also going to

573
00:19:19,280 --> 00:19:21,280
show that within the database and it's

574
00:19:21,280 --> 00:19:22,320
also going to show that it's being

575
00:19:22,320 --> 00:19:24,320
adjusted back and forth so if i get a

576
00:19:24,320 --> 00:19:26,480
refund for something or if i

577
00:19:26,480 --> 00:19:28,880
you know the the payment got cancelled

578
00:19:28,880 --> 00:19:30,400
or declined you know they're going to

579
00:19:30,400 --> 00:19:31,919
adjust this

580
00:19:31,919 --> 00:19:33,520
every single day depending on what you

581
00:19:33,520 --> 00:19:34,799
get and you're going to see those little

582
00:19:34,799 --> 00:19:39,559
messages within the application itself

583
00:19:39,679 --> 00:19:42,160
now the transit card so transit card is

584
00:19:42,160 --> 00:19:43,600
a relatively

585
00:19:43,600 --> 00:19:45,200
new you know in the last maybe a year or

586
00:19:45,200 --> 00:19:47,520
two depending on what city you are in

587
00:19:47,520 --> 00:19:49,760
but dc finally got it during the

588
00:19:49,760 --> 00:19:51,679
pandemic so i was able to actually

589
00:19:51,679 --> 00:19:53,120
research this without you know having to

590
00:19:53,120 --> 00:19:55,440
go anywhere which is kind of nice

591
00:19:55,440 --> 00:19:57,440
so it's kind of interesting to see some

592
00:19:57,440 --> 00:19:59,440
of the location stuff being brought out

593
00:19:59,440 --> 00:20:01,600
here so it's keeping track of and you

594
00:20:01,600 --> 00:20:03,440
see the map in here once you go into

595
00:20:03,440 --> 00:20:06,000
some of the screenshots of which start

596
00:20:06,000 --> 00:20:08,559
and stop station that i that i use this

597
00:20:08,559 --> 00:20:10,400
uh this information at

598
00:20:10,400 --> 00:20:12,159
so it's keeping all of those different

599
00:20:12,159 --> 00:20:14,080
transactions in there

600
00:20:14,080 --> 00:20:15,679
i know this one's a little bit tricky to

601
00:20:15,679 --> 00:20:18,720
see but we do see things like the latin

602
00:20:18,720 --> 00:20:20,240
longs for these stations so of course

603
00:20:20,240 --> 00:20:21,520
you can always just do a google search

604
00:20:21,520 --> 00:20:23,440
for say clarendon station in arlington

605
00:20:23,440 --> 00:20:24,559
virginia

606
00:20:24,559 --> 00:20:26,159
and you're going to be able to see that

607
00:20:26,159 --> 00:20:27,840
so again this provides a little bit more

608
00:20:27,840 --> 00:20:29,440
context so now

609
00:20:29,440 --> 00:20:30,799
i can see okay they were traveling on

610
00:20:30,799 --> 00:20:32,799
the metro from here to here

611
00:20:32,799 --> 00:20:34,240
you know i can use this you know they

612
00:20:34,240 --> 00:20:36,159
couldn't possibly have done that murder

613
00:20:36,159 --> 00:20:38,559
in the next state over but that doesn't

614
00:20:38,559 --> 00:20:40,159
mean somebody else had their device so

615
00:20:40,159 --> 00:20:42,159
you know you know use that within reason

616
00:20:42,159 --> 00:20:43,360
obviously

617
00:20:43,360 --> 00:20:44,960
so but it does provide again a little

618
00:20:44,960 --> 00:20:47,840
bit more context into the timeline into

619
00:20:47,840 --> 00:20:52,000
the device usage of this system

620
00:20:52,880 --> 00:20:53,840
next up

621
00:20:53,840 --> 00:20:56,480
the good old apple card transactions so

622
00:20:56,480 --> 00:20:58,559
i just quite literally right before i

623
00:20:58,559 --> 00:21:00,320
posted these slides into the slack or

624
00:21:00,320 --> 00:21:02,080
the slack the discord sorry that's the

625
00:21:02,080 --> 00:21:03,200
fancy one

626
00:21:03,200 --> 00:21:05,679
uh these are my recent transactions so

627
00:21:05,679 --> 00:21:06,960
this does get a little bit personal but

628
00:21:06,960 --> 00:21:07,840
these are all the things that i've been

629
00:21:07,840 --> 00:21:10,159
doing in hawaii uh so we can see a

630
00:21:10,159 --> 00:21:13,919
couple things here my card got declined

631
00:21:13,919 --> 00:21:15,760
darn right

632
00:21:15,760 --> 00:21:17,919
for whatever reason apple card they do

633
00:21:17,919 --> 00:21:20,080
not have really high credit limits so

634
00:21:20,080 --> 00:21:22,400
with the you know airlines and

635
00:21:22,400 --> 00:21:24,000
all the fancy flights and cabanas that

636
00:21:24,000 --> 00:21:26,159
i've been buying

637
00:21:26,159 --> 00:21:27,919
oh well it actually is a really good

638
00:21:27,919 --> 00:21:30,080
example you'll also notice somewhere

639
00:21:30,080 --> 00:21:31,360
well in the next screenshot that i

640
00:21:31,360 --> 00:21:33,039
actually do pay off my credit card as

641
00:21:33,039 --> 00:21:33,840
well

642
00:21:33,840 --> 00:21:35,440
so it actually shows some really quite

643
00:21:35,440 --> 00:21:37,520
useful information so i went to tommy

644
00:21:37,520 --> 00:21:39,520
bahama had a couple drinks there some of

645
00:21:39,520 --> 00:21:42,240
the abc stores i bought some new shoes

646
00:21:42,240 --> 00:21:44,240
some new sandals because you know one in

647
00:21:44,240 --> 00:21:45,679
maui

648
00:21:45,679 --> 00:21:47,600
i took a couple of lifts i went to the

649
00:21:47,600 --> 00:21:49,919
clarendon apple store so all the

650
00:21:49,919 --> 00:21:51,600
different details that you're looking at

651
00:21:51,600 --> 00:21:53,679
within the application itself

652
00:21:53,679 --> 00:21:56,400
the the merchant information the amount

653
00:21:56,400 --> 00:21:59,520
the percentage back how it was used so

654
00:21:59,520 --> 00:22:02,000
sometimes it'll say like a credit

655
00:22:02,000 --> 00:22:03,520
number was used i don't think i have an

656
00:22:03,520 --> 00:22:05,679
example of that one in here all of these

657
00:22:05,679 --> 00:22:07,919
little different pieces of information

658
00:22:07,919 --> 00:22:10,320
could be part of an investigation all of

659
00:22:10,320 --> 00:22:11,679
that's going to be stored in the

660
00:22:11,679 --> 00:22:14,240
database somewhere it may not be

661
00:22:14,240 --> 00:22:16,159
completely obvious but it's going to be

662
00:22:16,159 --> 00:22:18,000
stored in there somewhere because it has

663
00:22:18,000 --> 00:22:19,919
to be stored so it can be displayed in

664
00:22:19,919 --> 00:22:20,880
here

665
00:22:20,880 --> 00:22:22,320
another thing that i'd like to point out

666
00:22:22,320 --> 00:22:23,919
here is that a lot of these different

667
00:22:23,919 --> 00:22:26,000
entries a lot of these transactions will

668
00:22:26,000 --> 00:22:28,720
also include very useful location

669
00:22:28,720 --> 00:22:31,120
information so i got a couple of abc

670
00:22:31,120 --> 00:22:32,880
stores maybe not in the screenshot here

671
00:22:32,880 --> 00:22:34,960
but i went to two i went to one in

672
00:22:34,960 --> 00:22:36,960
lahaina and i went to one the one that's

673
00:22:36,960 --> 00:22:39,120
right over here in whalers village now

674
00:22:39,120 --> 00:22:40,159
if that's going to be part of my

675
00:22:40,159 --> 00:22:42,000
investigation i want to be darn sure of

676
00:22:42,000 --> 00:22:44,320
which one that transaction actually was

677
00:22:44,320 --> 00:22:47,120
at so that can actually put a device at

678
00:22:47,120 --> 00:22:49,200
a particular location so there is a

679
00:22:49,200 --> 00:22:50,720
whole other table with just

680
00:22:50,720 --> 00:22:52,960
location-based information all of this

681
00:22:52,960 --> 00:22:54,559
lovely map information

682
00:22:54,559 --> 00:22:58,480
all built into this same database

683
00:22:58,880 --> 00:23:01,039
now here's the database output so it

684
00:23:01,039 --> 00:23:02,960
looks really nice in the gui

685
00:23:02,960 --> 00:23:06,240
in the database maybe not as nice to see

686
00:23:06,240 --> 00:23:07,919
so i'm extracting a few different things

687
00:23:07,919 --> 00:23:09,360
here again there's quite a bit more

688
00:23:09,360 --> 00:23:12,000
information but just the status was it

689
00:23:12,000 --> 00:23:15,280
actually completed was it a declined uh

690
00:23:15,280 --> 00:23:17,840
transaction is it still pending you're

691
00:23:17,840 --> 00:23:19,280
going to notice that some transactions

692
00:23:19,280 --> 00:23:21,039
do end up pending for a while before

693
00:23:21,039 --> 00:23:22,799
they actually go through

694
00:23:22,799 --> 00:23:24,400
so whether it was purchased whether it

695
00:23:24,400 --> 00:23:27,280
was a payment whether it was a refund

696
00:23:27,280 --> 00:23:28,400
all these different types of

697
00:23:28,400 --> 00:23:30,480
transactions can really add to some

698
00:23:30,480 --> 00:23:32,720
useful information so yes i did pay off

699
00:23:32,720 --> 00:23:34,480
my credit card

700
00:23:34,480 --> 00:23:37,200
u.s dollars card type payment type all

701
00:23:37,200 --> 00:23:39,200
your standard stuff name merchant name

702
00:23:39,200 --> 00:23:41,039
merchant category there's actually quite

703
00:23:41,039 --> 00:23:43,520
a bit of more merchant information and

704
00:23:43,520 --> 00:23:45,360
again that just puts provides more

705
00:23:45,360 --> 00:23:47,840
context okay which abc store did she go

706
00:23:47,840 --> 00:23:50,240
to at a particular time now one thing

707
00:23:50,240 --> 00:23:52,400
it's not going to tell you is

708
00:23:52,400 --> 00:23:54,000
you know what did i buy it said abc

709
00:23:54,000 --> 00:23:56,720
store you have absolutely no idea

710
00:23:56,720 --> 00:23:59,360
now one thing especially with lyft lyft

711
00:23:59,360 --> 00:24:01,200
is great because okay i'm doing an

712
00:24:01,200 --> 00:24:03,120
investigation i want to know where did

713
00:24:03,120 --> 00:24:06,400
they take a lift from you know i see 119

714
00:24:06,400 --> 00:24:08,159
here that must have been a heck of a

715
00:24:08,159 --> 00:24:09,440
trip

716
00:24:09,440 --> 00:24:10,720
for this one this is actually a

717
00:24:10,720 --> 00:24:13,200
combination of a couple of a couple of

718
00:24:13,200 --> 00:24:15,200
lifts so this is on 924 this is when i

719
00:24:15,200 --> 00:24:17,440
was flying out so i went from home to

720
00:24:17,440 --> 00:24:18,400
dallas

721
00:24:18,400 --> 00:24:20,320
and then from

722
00:24:20,320 --> 00:24:23,600
ogg to well lahaina actually so a couple

723
00:24:23,600 --> 00:24:25,440
of trips they get merged in together

724
00:24:25,440 --> 00:24:27,200
because they try to do those lift

725
00:24:27,200 --> 00:24:29,279
transactions at the end of the day so

726
00:24:29,279 --> 00:24:31,679
it's not just a single transaction or a

727
00:24:31,679 --> 00:24:33,840
single trip i can't tell that from this

728
00:24:33,840 --> 00:24:35,919
database so i do have to provide or get

729
00:24:35,919 --> 00:24:37,919
a little bit more context to start

730
00:24:37,919 --> 00:24:39,919
putting the story back together in this

731
00:24:39,919 --> 00:24:41,760
case if i was looking for lyft what does

732
00:24:41,760 --> 00:24:44,559
lyft email you the receipt the receipt

733
00:24:44,559 --> 00:24:46,720
also contains a little map the map has a

734
00:24:46,720 --> 00:24:48,720
start and end it has the time stamps it

735
00:24:48,720 --> 00:24:50,480
has the driver it has a lot of

736
00:24:50,480 --> 00:24:52,480
information being stored in there so

737
00:24:52,480 --> 00:24:54,240
this is a great database but i'm going

738
00:24:54,240 --> 00:24:56,640
to have to use this in some other

739
00:24:56,640 --> 00:25:01,320
application data as well

740
00:25:01,360 --> 00:25:03,679
all right now once you start uh actually

741
00:25:03,679 --> 00:25:04,799
looking at all the data i should

742
00:25:04,799 --> 00:25:06,559
actually mention uh this one is just

743
00:25:06,559 --> 00:25:08,480
synced on the mac so i pulled this off

744
00:25:08,480 --> 00:25:10,640
of this mac right here all of these

745
00:25:10,640 --> 00:25:12,400
transactions were just on the apple card

746
00:25:12,400 --> 00:25:15,840
either the physical card or my phone

747
00:25:15,840 --> 00:25:17,600
this was on my mac so once you start

748
00:25:17,600 --> 00:25:20,159
using apple card it wants to sync

749
00:25:20,159 --> 00:25:23,440
everything which for me is great for you

750
00:25:23,440 --> 00:25:25,520
you may not want that being synced in

751
00:25:25,520 --> 00:25:28,080
there so apple card is very particular

752
00:25:28,080 --> 00:25:29,600
it wants to be on all the different

753
00:25:29,600 --> 00:25:31,360
devices

754
00:25:31,360 --> 00:25:33,520
i will kind of do a tldr with all the

755
00:25:33,520 --> 00:25:36,000
syncing stuff in just a little bit

756
00:25:36,000 --> 00:25:37,760
now how about if i have multiple cards

757
00:25:37,760 --> 00:25:39,440
so you know my card got declined i'm

758
00:25:39,440 --> 00:25:40,880
going to use another credit card to buy

759
00:25:40,880 --> 00:25:42,640
whatever i was going to buy at that one

760
00:25:42,640 --> 00:25:44,480
store so i'm using a bunch of different

761
00:25:44,480 --> 00:25:46,720
credit cards i'm using transit cards i'm

762
00:25:46,720 --> 00:25:48,799
sending and receiving apple cash

763
00:25:48,799 --> 00:25:50,320
transactions from all my friends with

764
00:25:50,320 --> 00:25:51,440
all my

765
00:25:51,440 --> 00:25:53,120
all my different

766
00:25:53,120 --> 00:25:55,360
cabana rentals and things like that so

767
00:25:55,360 --> 00:25:56,720
you might see something that looks like

768
00:25:56,720 --> 00:25:58,799
this you see the cash pure payments the

769
00:25:58,799 --> 00:26:00,880
purchases going back and forth back and

770
00:26:00,880 --> 00:26:02,799
forth now i'm going to look at the whole

771
00:26:02,799 --> 00:26:04,880
database and start putting all these

772
00:26:04,880 --> 00:26:06,240
together so i'm not just going to focus

773
00:26:06,240 --> 00:26:08,480
on a single credit card i'm going to

774
00:26:08,480 --> 00:26:10,559
bring it all together so i can just go

775
00:26:10,559 --> 00:26:12,720
sort of sort by the transaction date and

776
00:26:12,720 --> 00:26:14,559
see where i'm at quite literally if you

777
00:26:14,559 --> 00:26:16,720
plot this out and start looking at all

778
00:26:16,720 --> 00:26:18,960
the merchant information you can plot

779
00:26:18,960 --> 00:26:21,120
this out on a map and see exactly where

780
00:26:21,120 --> 00:26:23,840
i was at any given point in time that is

781
00:26:23,840 --> 00:26:26,640
really useful investigative information

782
00:26:26,640 --> 00:26:29,120
now this one's just my test device

783
00:26:29,120 --> 00:26:30,240
you know we see a lot of different

784
00:26:30,240 --> 00:26:32,000
things in here but we see i do go to

785
00:26:32,000 --> 00:26:34,320
whole foods i go to starbucks i go to a

786
00:26:34,320 --> 00:26:36,559
bakery called bake shop it's a fantastic

787
00:26:36,559 --> 00:26:38,720
bake shop in arlington i go to phil's

788
00:26:38,720 --> 00:26:40,159
coffee you got to get some coffee in

789
00:26:40,159 --> 00:26:42,320
there as well so it's going to show me

790
00:26:42,320 --> 00:26:43,919
you know where does this person like to

791
00:26:43,919 --> 00:26:45,200
buy their groceries where do they get

792
00:26:45,200 --> 00:26:47,120
their coffee do they get coffee at the

793
00:26:47,120 --> 00:26:49,840
same time every morning that could be

794
00:26:49,840 --> 00:26:52,080
potentially useful we see patterns in

795
00:26:52,080 --> 00:26:55,039
this data as well

796
00:26:56,000 --> 00:26:57,919
a few other database goodies here

797
00:26:57,919 --> 00:26:59,360
because i know i'm running up on time

798
00:26:59,360 --> 00:27:00,320
here

799
00:27:00,320 --> 00:27:01,919
things like shipping information you get

800
00:27:01,919 --> 00:27:03,520
a lot of things like

801
00:27:03,520 --> 00:27:06,159
like the ups tracking codes being stored

802
00:27:06,159 --> 00:27:09,520
in there i've also put here the database

803
00:27:09,520 --> 00:27:10,960
table names because this is where the

804
00:27:10,960 --> 00:27:12,880
fruit comes into play apparently

805
00:27:12,880 --> 00:27:14,960
blackberries and passionfruit a lot of

806
00:27:14,960 --> 00:27:17,440
the credit limits things for for apple

807
00:27:17,440 --> 00:27:19,279
cars and oranges

808
00:27:19,279 --> 00:27:20,880
more details are in raspberries and

809
00:27:20,880 --> 00:27:22,640
strawberries

810
00:27:22,640 --> 00:27:24,559
again it's really weird why they use

811
00:27:24,559 --> 00:27:26,000
fruit names

812
00:27:26,000 --> 00:27:27,440
and then they use just you know normal

813
00:27:27,440 --> 00:27:29,840
table names like maps merchant that has

814
00:27:29,840 --> 00:27:31,520
all my location all those little maps

815
00:27:31,520 --> 00:27:34,080
associated so those latin longs all the

816
00:27:34,080 --> 00:27:35,840
the addresses the phone numbers that

817
00:27:35,840 --> 00:27:37,679
merchant information

818
00:27:37,679 --> 00:27:40,360
and a bunch more transaction stuff again

819
00:27:40,360 --> 00:27:42,799
166 different tables

820
00:27:42,799 --> 00:27:44,799
probably 90 percent of which i have

821
00:27:44,799 --> 00:27:46,399
absolutely no idea what it's storing but

822
00:27:46,399 --> 00:27:48,399
it looks like so cool information it's

823
00:27:48,399 --> 00:27:50,240
just not immediately obvious to me what

824
00:27:50,240 --> 00:27:53,440
the purpose of that is

825
00:27:53,440 --> 00:27:55,760
all right so a little bit of tldr where

826
00:27:55,760 --> 00:27:57,600
is the data going

827
00:27:57,600 --> 00:28:00,320
now as far as passes goes passes think

828
00:28:00,320 --> 00:28:01,600
of the movie tickets think of your

829
00:28:01,600 --> 00:28:03,679
airline tickets if you have icloud

830
00:28:03,679 --> 00:28:05,520
services those are pretty much going to

831
00:28:05,520 --> 00:28:08,080
be synced across devices even if you're

832
00:28:08,080 --> 00:28:10,080
not seeing them within the app or on

833
00:28:10,080 --> 00:28:12,480
your macs or your ipads they do like to

834
00:28:12,480 --> 00:28:15,039
hang out in the ubiquitous cards area so

835
00:28:15,039 --> 00:28:16,880
don't be surprised if you find those on

836
00:28:16,880 --> 00:28:18,960
there even if you're not seeing them

837
00:28:18,960 --> 00:28:20,799
within the gui themselves

838
00:28:20,799 --> 00:28:22,399
now these are pretty easy to get to from

839
00:28:22,399 --> 00:28:24,240
a forensics perspective i can do an ios

840
00:28:24,240 --> 00:28:25,760
backup i could do a full file system

841
00:28:25,760 --> 00:28:27,360
dump i can jailbreak see all the

842
00:28:27,360 --> 00:28:30,159
different things should be good to go

843
00:28:30,159 --> 00:28:32,960
now as far as the passes 23 database

844
00:28:32,960 --> 00:28:35,360
this one is a bit trickier and for the

845
00:28:35,360 --> 00:28:37,279
right reasons it contains a lot of

846
00:28:37,279 --> 00:28:39,600
personal financial information now one

847
00:28:39,600 --> 00:28:41,440
thing is you know i could do a subpoena

848
00:28:41,440 --> 00:28:43,600
to a bank i could subpoena the credit

849
00:28:43,600 --> 00:28:45,600
card information the one thing that this

850
00:28:45,600 --> 00:28:48,240
saves me as a forensics person it saves

851
00:28:48,240 --> 00:28:49,840
me all that extra paperwork it saves the

852
00:28:49,840 --> 00:28:51,360
investigator extra paperwork if it's

853
00:28:51,360 --> 00:28:53,360
right here i might as well get access to

854
00:28:53,360 --> 00:28:55,279
that so they do make it a little bit

855
00:28:55,279 --> 00:28:56,960
trickier to get to

856
00:28:56,960 --> 00:28:58,559
but we're going to be able to get those

857
00:28:58,559 --> 00:29:00,960
with full file system jailbreak dumps

858
00:29:00,960 --> 00:29:02,960
and assuming your mac is not encrypted

859
00:29:02,960 --> 00:29:04,559
or if the forensic investigator doesn't

860
00:29:04,559 --> 00:29:06,480
have you know passwords and and all that

861
00:29:06,480 --> 00:29:08,880
stuff you know it does it does get

862
00:29:08,880 --> 00:29:10,720
protected it's still quite available

863
00:29:10,720 --> 00:29:12,240
however

864
00:29:12,240 --> 00:29:14,480
other credit cards these are a little

865
00:29:14,480 --> 00:29:16,880
bit more interesting

866
00:29:16,880 --> 00:29:19,039
because they don't get synced apple card

867
00:29:19,039 --> 00:29:21,120
loves to sync all the things

868
00:29:21,120 --> 00:29:22,799
all the other credit cards it's pretty

869
00:29:22,799 --> 00:29:24,720
much only the transactions that were

870
00:29:24,720 --> 00:29:27,440
done on that device so if i only used

871
00:29:27,440 --> 00:29:29,520
one uh you know

872
00:29:29,520 --> 00:29:31,200
one of my credit cards the non-apple

873
00:29:31,200 --> 00:29:33,919
card on my phone those transactions

874
00:29:33,919 --> 00:29:36,240
pretty much stay on that phone it's not

875
00:29:36,240 --> 00:29:38,080
going to be synced across all the other

876
00:29:38,080 --> 00:29:39,919
ones and it's not going to know like i

877
00:29:39,919 --> 00:29:43,120
just used the other card there is no

878
00:29:43,120 --> 00:29:45,520
syncing between mastercard or visa

879
00:29:45,520 --> 00:29:47,760
themselves just the apple card does most

880
00:29:47,760 --> 00:29:49,039
of the syncing

881
00:29:49,039 --> 00:29:50,720
and then we have transit again this is

882
00:29:50,720 --> 00:29:53,200
on a per device basis so don't be

883
00:29:53,200 --> 00:29:54,480
surprised if you're not seeing it

884
00:29:54,480 --> 00:29:56,720
because you're looking at mac because

885
00:29:56,720 --> 00:29:58,480
there is no transit

886
00:29:58,480 --> 00:30:02,240
information on the mac itself

887
00:30:02,559 --> 00:30:05,120
all right so that is it a little i know

888
00:30:05,120 --> 00:30:07,360
quite quick but it's a big database so

889
00:30:07,360 --> 00:30:09,120
thank you very much there's a few other

890
00:30:09,120 --> 00:30:11,039
things i think folks should keep in mind

891
00:30:11,039 --> 00:30:12,320
and of course i'm going to try to do as

892
00:30:12,320 --> 00:30:14,159
much research as possible

893
00:30:14,159 --> 00:30:16,240
very interested in the car keys

894
00:30:16,240 --> 00:30:18,320
if someone wants to buy me a car that

895
00:30:18,320 --> 00:30:21,120
has the car keys i would very very happy

896
00:30:21,120 --> 00:30:22,799
to give that a go

897
00:30:22,799 --> 00:30:24,880
i'm interested in the identification if

898
00:30:24,880 --> 00:30:26,799
only from a legal perspective you know

899
00:30:26,799 --> 00:30:29,440
you get stopped by law enforcement you

900
00:30:29,440 --> 00:30:31,440
want to show them your id what's going

901
00:30:31,440 --> 00:30:33,919
to happen you just unlocked your device

902
00:30:33,919 --> 00:30:35,200
which makes things a heck of a lot

903
00:30:35,200 --> 00:30:37,200
easier from a forensic acquisition point

904
00:30:37,200 --> 00:30:38,799
of view so that is going to be certainly

905
00:30:38,799 --> 00:30:40,399
a very interesting thing to keep an eye

906
00:30:40,399 --> 00:30:41,440
on

907
00:30:41,440 --> 00:30:43,520
apple family cash i don't share my cash

908
00:30:43,520 --> 00:30:45,120
with my family so i have absolutely no

909
00:30:45,120 --> 00:30:46,080
idea

910
00:30:46,080 --> 00:30:47,679
and there's a bunch of other stuff so

911
00:30:47,679 --> 00:30:49,200
again this is one of the databases and

912
00:30:49,200 --> 00:30:51,200
apps that keeps adding more and more and

913
00:30:51,200 --> 00:30:53,200
more information probably more fruits in

914
00:30:53,200 --> 00:30:54,320
the future maybe they're going to add

915
00:30:54,320 --> 00:30:57,360
more vegetables i'm not entirely sure

916
00:30:57,360 --> 00:31:00,000
sql queries are going to be available

917
00:31:00,000 --> 00:31:02,159
on my apollo project so i've presented

918
00:31:02,159 --> 00:31:03,919
on apollo here before apple pattern of

919
00:31:03,919 --> 00:31:06,000
life lazy outputter or

920
00:31:06,000 --> 00:31:08,399
all the creepy stuff on your devices

921
00:31:08,399 --> 00:31:11,519
all nicely outputted for you my blog is

922
00:31:11,519 --> 00:31:13,120
here the um

923
00:31:13,120 --> 00:31:15,120
the slides are going to be uploaded to

924
00:31:15,120 --> 00:31:16,399
that but you already have them in the

925
00:31:16,399 --> 00:31:18,799
discord channel

926
00:31:18,799 --> 00:31:20,399
the forensics 518 class if you're

927
00:31:20,399 --> 00:31:22,159
interested in seeing all the other

928
00:31:22,159 --> 00:31:23,840
stuff that i teach about and of course

929
00:31:23,840 --> 00:31:25,840
my twitter information if you have any

930
00:31:25,840 --> 00:31:27,200
other questions

931
00:31:27,200 --> 00:31:30,399
so thank you and not surprising i still

932
00:31:30,399 --> 00:31:33,170
went over time

933
00:31:33,170 --> 00:31:39,049
[Applause]

