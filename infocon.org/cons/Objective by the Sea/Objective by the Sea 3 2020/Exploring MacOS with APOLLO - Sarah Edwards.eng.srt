1
00:00:15,360 --> 00:00:17,119
all right like patrick said i am one of

2
00:00:17,119 --> 00:00:20,800
the the original ogs of obts and the

3
00:00:20,800 --> 00:00:23,039
first time that we had this in maui um

4
00:00:23,039 --> 00:00:25,760
what like a month and a half ago or a

5
00:00:25,760 --> 00:00:27,840
year and a half ago give or take

6
00:00:27,840 --> 00:00:29,920
um i introduced a pattern of life

7
00:00:29,920 --> 00:00:32,159
utility called apollo uh so this is kind

8
00:00:32,159 --> 00:00:34,800
of a re-up on where it's gone and a

9
00:00:34,800 --> 00:00:36,800
little bit more of the mac support side

10
00:00:36,800 --> 00:00:37,920
of it

11
00:00:37,920 --> 00:00:39,040
for this one

12
00:00:39,040 --> 00:00:41,360
so this one is exploring mac os with

13
00:00:41,360 --> 00:00:43,760
apollo all my contact information is up

14
00:00:43,760 --> 00:00:45,680
there it's also going to be at the end

15
00:00:45,680 --> 00:00:46,399
so

16
00:00:46,399 --> 00:00:47,760
for this presentation you don't have to

17
00:00:47,760 --> 00:00:49,920
be the person to take a picture of every

18
00:00:49,920 --> 00:00:51,920
slide don't do that i will release all

19
00:00:51,920 --> 00:00:52,960
of this

20
00:00:52,960 --> 00:00:56,320
um i hate sitting back at those people

21
00:00:56,320 --> 00:00:58,239
click click every single time drives me

22
00:00:58,239 --> 00:00:59,760
absolutely crazy

23
00:00:59,760 --> 00:01:01,600
uh so all the contact information is up

24
00:01:01,600 --> 00:01:04,640
there as far as what i do i do a lot of

25
00:01:04,640 --> 00:01:06,320
things i have at least two full-time

26
00:01:06,320 --> 00:01:09,600
jobs uh so my uh just recently changed

27
00:01:09,600 --> 00:01:11,680
jobs i'm that black bag

28
00:01:11,680 --> 00:01:13,840
forensics company they do a forensics

29
00:01:13,840 --> 00:01:15,119
utility

30
00:01:15,119 --> 00:01:16,320
called black light i'm going to show an

31
00:01:16,320 --> 00:01:18,320
example of that a little bit

32
00:01:18,320 --> 00:01:20,320
and i also do sans instructing so i'm

33
00:01:20,320 --> 00:01:21,520
sure there's at least one or two

34
00:01:21,520 --> 00:01:23,680
students in here there always is for

35
00:01:23,680 --> 00:01:25,600
this particular class because i teach

36
00:01:25,600 --> 00:01:27,520
the mac and ios forensic and incident

37
00:01:27,520 --> 00:01:29,280
response class

38
00:01:29,280 --> 00:01:31,759
so all my contact information up there

39
00:01:31,759 --> 00:01:35,200
the slides will be

40
00:01:35,200 --> 00:01:38,400
uploaded to the mac forensics

41
00:01:38,400 --> 00:01:41,400
site

42
00:01:42,640 --> 00:01:44,159
all right so this one

43
00:01:44,159 --> 00:01:46,079
so this mac forensics right here so if

44
00:01:46,079 --> 00:01:47,600
you didn't see the word forensics in

45
00:01:47,600 --> 00:01:49,759
there a lot of people don't see that

46
00:01:49,759 --> 00:01:52,079
forensics community however we do

47
00:01:52,079 --> 00:01:56,639
everything with f and 6 in it

48
00:01:56,799 --> 00:01:58,000
all right so

49
00:01:58,000 --> 00:02:00,320
version 1.0 of opts i introduced this

50
00:02:00,320 --> 00:02:02,320
new tool it's a python script it's a

51
00:02:02,320 --> 00:02:04,799
relatively dumb script i make no bones

52
00:02:04,799 --> 00:02:06,560
about i'm not a

53
00:02:06,560 --> 00:02:08,878
a developer of sorts i do a lot of

54
00:02:08,878 --> 00:02:10,399
research but not a whole lot of

55
00:02:10,399 --> 00:02:12,160
development so i'm just kind of a

56
00:02:12,160 --> 00:02:14,560
programmer at best scripter not even a

57
00:02:14,560 --> 00:02:16,640
programmer i wouldn't call myself that

58
00:02:16,640 --> 00:02:19,200
so i released this one and i really kind

59
00:02:19,200 --> 00:02:20,959
of released it as a proof of concept

60
00:02:20,959 --> 00:02:23,280
utility since then so about a year and a

61
00:02:23,280 --> 00:02:24,080
half

62
00:02:24,080 --> 00:02:26,080
it's being used in commercial products

63
00:02:26,080 --> 00:02:27,680
it's being used across law enforcement

64
00:02:27,680 --> 00:02:30,400
across the world in

65
00:02:30,400 --> 00:02:33,280
you know security outlets a lot of folks

66
00:02:33,280 --> 00:02:36,000
are using this particular utility so i

67
00:02:36,000 --> 00:02:37,920
really built it out with ios and mine

68
00:02:37,920 --> 00:02:40,160
first uh so what i'm doing is i'm taking

69
00:02:40,160 --> 00:02:43,280
your ios devices not yours specifically

70
00:02:43,280 --> 00:02:46,160
you know legal authorization and whatnot

71
00:02:46,160 --> 00:02:47,920
i'm taking those devices and i'm

72
00:02:47,920 --> 00:02:50,640
extracting a lot of databases so you're

73
00:02:50,640 --> 00:02:52,560
probably familiar with sqlite databases

74
00:02:52,560 --> 00:02:55,280
mac and ios a lot of really useful data

75
00:02:55,280 --> 00:02:57,200
is going to be stored in these databases

76
00:02:57,200 --> 00:02:58,400
so one of the problems i was running

77
00:02:58,400 --> 00:03:00,000
into was

78
00:03:00,000 --> 00:03:02,239
looking at 20 different databases with

79
00:03:02,239 --> 00:03:03,200
maybe

80
00:03:03,200 --> 00:03:05,599
20 plus different sql queries to pull

81
00:03:05,599 --> 00:03:07,440
out and extract all the little bits and

82
00:03:07,440 --> 00:03:09,280
pieces of what you're doing with these

83
00:03:09,280 --> 00:03:10,800
particular devices

84
00:03:10,800 --> 00:03:12,480
so i created apollo to basically

85
00:03:12,480 --> 00:03:14,720
automate that process for me

86
00:03:14,720 --> 00:03:16,560
so i called it apollo because the apple

87
00:03:16,560 --> 00:03:19,120
pattern of life lazy outputter

88
00:03:19,120 --> 00:03:21,599
still very proud of that name um and

89
00:03:21,599 --> 00:03:23,440
it's not just apple stuff you know i

90
00:03:23,440 --> 00:03:24,799
talk about apple stuff all the time

91
00:03:24,799 --> 00:03:25,920
because that's kind of my bread and

92
00:03:25,920 --> 00:03:27,360
butter but this could also be used for

93
00:03:27,360 --> 00:03:28,879
android it could be used for windows it

94
00:03:28,879 --> 00:03:30,480
could be used for what other platforms

95
00:03:30,480 --> 00:03:33,040
out there it does not care as long as

96
00:03:33,040 --> 00:03:35,120
the sqlite database

97
00:03:35,120 --> 00:03:36,319
so if you want to create your own

98
00:03:36,319 --> 00:03:37,519
modules

99
00:03:37,519 --> 00:03:39,120
i will certainly do pull requests for

100
00:03:39,120 --> 00:03:40,720
those modules and if it needs to have

101
00:03:40,720 --> 00:03:42,799
some android or windows stuff built into

102
00:03:42,799 --> 00:03:44,640
the script quick and easy just let me

103
00:03:44,640 --> 00:03:46,640
know but all i need is a database file

104
00:03:46,640 --> 00:03:49,200
name a sql query and a correlation

105
00:03:49,200 --> 00:03:51,120
timestamp so i'm correlating all this

106
00:03:51,120 --> 00:03:52,640
information i'll give you a good example

107
00:03:52,640 --> 00:03:53,680
of that

108
00:03:53,680 --> 00:03:56,159
right at the end of the presentation

109
00:03:56,159 --> 00:03:59,439
so as we stand today there's 165 modules

110
00:03:59,439 --> 00:04:03,040
so there's 20 plus databases with 165

111
00:04:03,040 --> 00:04:05,040
different sql queries that i'm running

112
00:04:05,040 --> 00:04:07,120
once i release the mac stuff we're going

113
00:04:07,120 --> 00:04:09,519
to be looking at probably over well over

114
00:04:09,519 --> 00:04:12,239
200 different modules that's a lot of

115
00:04:12,239 --> 00:04:15,040
work and most of these pretty much 99.9

116
00:04:15,040 --> 00:04:17,519
percent of these scripts were created by

117
00:04:17,519 --> 00:04:19,358
me to basically support forensic

118
00:04:19,358 --> 00:04:21,839
investigations

119
00:04:21,839 --> 00:04:23,840
so as far as what's new since then uh

120
00:04:23,840 --> 00:04:25,600
upgrade the python 3.

121
00:04:25,600 --> 00:04:27,199
had to happen eventually kicking and

122
00:04:27,199 --> 00:04:29,040
screaming i finally did it

123
00:04:29,040 --> 00:04:31,520
i also do a lot of location stuff so ios

124
00:04:31,520 --> 00:04:33,840
notoriously stores a lot of extremely

125
00:04:33,840 --> 00:04:35,759
awesome location data

126
00:04:35,759 --> 00:04:37,360
it is protected don't freak out it is

127
00:04:37,360 --> 00:04:38,880
protected

128
00:04:38,880 --> 00:04:40,639
but i can extract that throw it into a

129
00:04:40,639 --> 00:04:43,680
kmz pop it into google earth and see you

130
00:04:43,680 --> 00:04:46,320
know where you've been for the last

131
00:04:46,320 --> 00:04:49,199
few years weeks days

132
00:04:49,199 --> 00:04:50,800
all sorts of good stuff like that

133
00:04:50,800 --> 00:04:52,080
particularly like the location

134
00:04:52,080 --> 00:04:53,520
information

135
00:04:53,520 --> 00:04:55,520
i've updated a lot of the ios modules i

136
00:04:55,520 --> 00:04:57,360
keep adding more and more and more

137
00:04:57,360 --> 00:05:00,160
there's really no lack of

138
00:05:00,160 --> 00:05:01,759
of data to be pulled out it's just a

139
00:05:01,759 --> 00:05:03,440
matter of building the query some of

140
00:05:03,440 --> 00:05:06,000
these queries take a minute to create

141
00:05:06,000 --> 00:05:08,160
some of them take weeks to create and

142
00:05:08,160 --> 00:05:09,919
make sure that you're doing the research

143
00:05:09,919 --> 00:05:11,520
uh one instance i was going to present

144
00:05:11,520 --> 00:05:13,440
on screen time today but when i was in

145
00:05:13,440 --> 00:05:15,199
the plane i was really looking at what i

146
00:05:15,199 --> 00:05:16,720
had i'm like this

147
00:05:16,720 --> 00:05:19,120
this isn't right you have to do testing

148
00:05:19,120 --> 00:05:21,360
so whatever my query was doing was not

149
00:05:21,360 --> 00:05:23,440
extracting the right information so i'm

150
00:05:23,440 --> 00:05:24,639
going to hold those back for a little

151
00:05:24,639 --> 00:05:26,639
bit so i can uh look at that a little

152
00:05:26,639 --> 00:05:28,240
bit closer on

153
00:05:28,240 --> 00:05:29,919
and now i did mention also

154
00:05:29,919 --> 00:05:31,600
commercial tool support so this is all

155
00:05:31,600 --> 00:05:33,680
open source you can go in here grab them

156
00:05:33,680 --> 00:05:35,520
today the mac os stuff will hopefully be

157
00:05:35,520 --> 00:05:39,280
released soon i'm hoping for next week

158
00:05:39,280 --> 00:05:40,720
and

159
00:05:40,720 --> 00:05:42,000
that's great i put them out into the

160
00:05:42,000 --> 00:05:44,320
community so the forensics folks can use

161
00:05:44,320 --> 00:05:45,919
them you know it does take a lot of time

162
00:05:45,919 --> 00:05:47,600
to build some of these queries

163
00:05:47,600 --> 00:05:49,520
i am fortunate to do a lot of research

164
00:05:49,520 --> 00:05:51,360
so i want to provide those to the

165
00:05:51,360 --> 00:05:53,360
community themselves it's a lot of

166
00:05:53,360 --> 00:05:55,120
commercial tools some with permission

167
00:05:55,120 --> 00:05:57,039
some have not so much permission my

168
00:05:57,039 --> 00:06:00,000
license is very lenient for the record

169
00:06:00,000 --> 00:06:02,960
um have built them into their tools so i

170
00:06:02,960 --> 00:06:04,880
don't work for a black bag

171
00:06:04,880 --> 00:06:07,520
and we have a whole

172
00:06:07,520 --> 00:06:09,759
basically plug-in that they built around

173
00:06:09,759 --> 00:06:11,440
apollo there's really only one plug-in

174
00:06:11,440 --> 00:06:13,280
and it's apollo so they really built it

175
00:06:13,280 --> 00:06:14,880
around what i had released and this was

176
00:06:14,880 --> 00:06:17,440
before i even worked there now i truly

177
00:06:17,440 --> 00:06:18,880
work there and i have to keep it updated

178
00:06:18,880 --> 00:06:20,800
which is excellent

179
00:06:20,800 --> 00:06:22,560
axion is also another one so if you do

180
00:06:22,560 --> 00:06:24,479
know these forensic utilities magnet

181
00:06:24,479 --> 00:06:26,880
axiom also takes some of the modules not

182
00:06:26,880 --> 00:06:28,800
nearly as many as black light

183
00:06:28,800 --> 00:06:30,960
but you will see some apollo stuff being

184
00:06:30,960 --> 00:06:32,479
stored in there as well

185
00:06:32,479 --> 00:06:34,400
so just as an example

186
00:06:34,400 --> 00:06:36,160
we have here uh this is black light

187
00:06:36,160 --> 00:06:37,600
black back so this is the company that i

188
00:06:37,600 --> 00:06:39,120
do work for gotta give a little shout

189
00:06:39,120 --> 00:06:42,560
out because they built this whole piece

190
00:06:42,560 --> 00:06:45,280
just for my apollo stuff uh so plugins

191
00:06:45,280 --> 00:06:46,880
it basically it doesn't worry about my

192
00:06:46,880 --> 00:06:48,560
crappy python script

193
00:06:48,560 --> 00:06:50,800
which is a good thing it basically takes

194
00:06:50,800 --> 00:06:53,599
all the modules all 165 modules and

195
00:06:53,599 --> 00:06:55,680
throws them into the different tables

196
00:06:55,680 --> 00:06:57,280
that you see here

197
00:06:57,280 --> 00:06:59,759
so this means you know forensic

198
00:06:59,759 --> 00:07:01,039
investigators who are already using

199
00:07:01,039 --> 00:07:03,039
blacklight can already go in there and

200
00:07:03,039 --> 00:07:04,319
see all these different tables they

201
00:07:04,319 --> 00:07:06,319
don't have to do anything special it's

202
00:07:06,319 --> 00:07:08,240
built right in you might want to update

203
00:07:08,240 --> 00:07:10,160
it because i update these modules very

204
00:07:10,160 --> 00:07:12,800
often uh that's it so it's pre-built in

205
00:07:12,800 --> 00:07:14,720
as soon as i release the mac ones again

206
00:07:14,720 --> 00:07:16,720
hopefully next week boom automatic

207
00:07:16,720 --> 00:07:18,160
support for all the mac ones that i'm

208
00:07:18,160 --> 00:07:20,080
going to show you today

209
00:07:20,080 --> 00:07:21,599
so i will do demos of this i am doing

210
00:07:21,599 --> 00:07:23,199
the arsenal

211
00:07:23,199 --> 00:07:25,759
today yeah so today so if you want to

212
00:07:25,759 --> 00:07:28,240
see a little demo blacklight happy to

213
00:07:28,240 --> 00:07:29,440
provide that

214
00:07:29,440 --> 00:07:31,599
as well as the script

215
00:07:31,599 --> 00:07:34,240
so as far as new modules so i am

216
00:07:34,240 --> 00:07:36,960
specifically focusing on the mac os side

217
00:07:36,960 --> 00:07:38,960
here i already did ios i got that pretty

218
00:07:38,960 --> 00:07:41,280
well covered but i'm looking at the mac

219
00:07:41,280 --> 00:07:42,960
side here so i'm going to go over a few

220
00:07:42,960 --> 00:07:45,039
of the different databases that you see

221
00:07:45,039 --> 00:07:47,360
up on the screen here but this is only a

222
00:07:47,360 --> 00:07:49,199
fraction of all the modules i'm going to

223
00:07:49,199 --> 00:07:52,000
be releasing next week maybe 10

224
00:07:52,000 --> 00:07:54,319
or so there's a lot more i just don't

225
00:07:54,319 --> 00:07:56,080
have the time to talk about each one of

226
00:07:56,080 --> 00:07:58,080
them

227
00:07:58,080 --> 00:08:00,479
so the first one i love knowledge c this

228
00:08:00,479 --> 00:08:02,639
is not mac this is on ios it's one of my

229
00:08:02,639 --> 00:08:04,720
favorite databases it's weird right i

230
00:08:04,720 --> 00:08:07,120
have favorite databases i favor p list

231
00:08:07,120 --> 00:08:08,479
files

232
00:08:08,479 --> 00:08:09,280
it's

233
00:08:09,280 --> 00:08:12,560
forensics people are strange people um

234
00:08:12,560 --> 00:08:15,199
so knowledge c this one's really keeping

235
00:08:15,199 --> 00:08:17,840
track of user activity so i focus most

236
00:08:17,840 --> 00:08:20,240
of this on ios i want to focus a little

237
00:08:20,240 --> 00:08:22,560
bit on the mac side as well what is the

238
00:08:22,560 --> 00:08:24,800
user doing can i track what they're

239
00:08:24,800 --> 00:08:26,479
doing you know pattern of life it's

240
00:08:26,479 --> 00:08:28,800
really just detailing what is happening

241
00:08:28,800 --> 00:08:30,479
with the user interaction what are they

242
00:08:30,479 --> 00:08:33,039
doing what is the system doing on as a

243
00:08:33,039 --> 00:08:35,279
whole and i can get very very specific

244
00:08:35,279 --> 00:08:37,360
information and a lot of different

245
00:08:37,360 --> 00:08:39,200
fragments correlate those together to

246
00:08:39,200 --> 00:08:41,120
really tell the story of what happened

247
00:08:41,120 --> 00:08:42,958
on a particular device

248
00:08:42,958 --> 00:08:44,800
so first things first

249
00:08:44,800 --> 00:08:46,880
what applications being used

250
00:08:46,880 --> 00:08:49,200
from a particular user so i have a few

251
00:08:49,200 --> 00:08:51,120
examples here i actually want to make

252
00:08:51,120 --> 00:08:52,160
this

253
00:08:52,160 --> 00:08:53,600
a little bit

254
00:08:53,600 --> 00:08:55,839
larger

255
00:09:01,920 --> 00:09:03,279
give me one second i hope i don't screw

256
00:09:03,279 --> 00:09:05,360
things up perfect all right i couldn't

257
00:09:05,360 --> 00:09:06,880
see it on my screen but you can see it

258
00:09:06,880 --> 00:09:10,320
up here so what you're seeing here is

259
00:09:10,320 --> 00:09:12,080
the query output so this is not the raw

260
00:09:12,080 --> 00:09:14,640
databases the apollo module that's being

261
00:09:14,640 --> 00:09:16,240
run against the database that's why it

262
00:09:16,240 --> 00:09:18,560
might look you know sort of standardized

263
00:09:18,560 --> 00:09:20,640
across a few other screenshots

264
00:09:20,640 --> 00:09:22,720
that you might see here

265
00:09:22,720 --> 00:09:24,480
so what i'm seeing here is the bundle id

266
00:09:24,480 --> 00:09:26,240
so everything on mac and ios

267
00:09:26,240 --> 00:09:28,480
application-wise service-wise has a

268
00:09:28,480 --> 00:09:30,480
bundle id associated with it so if i'm

269
00:09:30,480 --> 00:09:32,080
looking for a specific service a

270
00:09:32,080 --> 00:09:33,760
specific application

271
00:09:33,760 --> 00:09:35,760
very likely going to be looking across

272
00:09:35,760 --> 00:09:38,080
all different databases p lists

273
00:09:38,080 --> 00:09:40,320
what have you for a particular bundle id

274
00:09:40,320 --> 00:09:42,160
so this shows me which applications are

275
00:09:42,160 --> 00:09:44,000
being used on this mac at this

276
00:09:44,000 --> 00:09:45,360
particular time

277
00:09:45,360 --> 00:09:47,760
now a little bit different than ios

278
00:09:47,760 --> 00:09:50,399
ios you might have multiple applications

279
00:09:50,399 --> 00:09:51,600
running and you have to flip through

280
00:09:51,600 --> 00:09:52,399
them

281
00:09:52,399 --> 00:09:54,160
mac os you might have multiple

282
00:09:54,160 --> 00:09:56,480
applications and they're all storing the

283
00:09:56,480 --> 00:09:58,320
same sort of timing information the

284
00:09:58,320 --> 00:10:00,720
start and end times so knowledge see

285
00:10:00,720 --> 00:10:02,000
across these two

286
00:10:02,000 --> 00:10:04,160
platforms a little bit different that's

287
00:10:04,160 --> 00:10:05,920
why you see this usage in seconds and

288
00:10:05,920 --> 00:10:07,920
minutes here about five minutes or so

289
00:10:07,920 --> 00:10:09,440
for all of these applications because

290
00:10:09,440 --> 00:10:11,040
they're all running and they might be on

291
00:10:11,040 --> 00:10:13,040
multiple desktops we're going to look at

292
00:10:13,040 --> 00:10:14,399
another query a little bit later on that

293
00:10:14,399 --> 00:10:16,640
shows which one is in focus at a

294
00:10:16,640 --> 00:10:18,800
specific time or the front most app if

295
00:10:18,800 --> 00:10:20,320
you will so you can see more specific

296
00:10:20,320 --> 00:10:22,480
user activity with that

297
00:10:22,480 --> 00:10:24,079
now the items that i have highlighted

298
00:10:24,079 --> 00:10:25,200
here

299
00:10:25,200 --> 00:10:27,680
these are all from an ios device so

300
00:10:27,680 --> 00:10:29,839
specifically with knowledge c if you

301
00:10:29,839 --> 00:10:31,760
have icloud set up and all services

302
00:10:31,760 --> 00:10:33,279
turned on and whatnot a lot of this

303
00:10:33,279 --> 00:10:34,880
stuff is going to be synced across

304
00:10:34,880 --> 00:10:36,000
devices

305
00:10:36,000 --> 00:10:39,279
forensically speaking this is a bonus if

306
00:10:39,279 --> 00:10:40,800
i only have the user's desktop

307
00:10:40,800 --> 00:10:42,880
information but i can't get into their

308
00:10:42,880 --> 00:10:44,640
phone or i can't access their phone i

309
00:10:44,640 --> 00:10:46,079
don't have legal authorities who access

310
00:10:46,079 --> 00:10:48,079
their phone i can still see a lot of

311
00:10:48,079 --> 00:10:49,839
that activity that's being synced back

312
00:10:49,839 --> 00:10:52,800
to the mac that is fantastic so what

313
00:10:52,800 --> 00:10:54,880
you're seeing highlighted here is my

314
00:10:54,880 --> 00:10:57,279
activity on my iphone

315
00:10:57,279 --> 00:11:00,079
device the one i have right here so i'm

316
00:11:00,079 --> 00:11:02,240
on twitter because i'm always on twitter

317
00:11:02,240 --> 00:11:04,800
camera waze all of that good stuff so i

318
00:11:04,800 --> 00:11:05,920
will see the

319
00:11:05,920 --> 00:11:08,640
uh the combination of both mac and ios

320
00:11:08,640 --> 00:11:11,760
devices within the knowledge c database

321
00:11:11,760 --> 00:11:13,519
other things within knowledge c this is

322
00:11:13,519 --> 00:11:15,360
going to be pretty standard across all

323
00:11:15,360 --> 00:11:16,959
these other queries you get the day of

324
00:11:16,959 --> 00:11:19,040
the week gmt offset which is useful

325
00:11:19,040 --> 00:11:20,480
especially if you're traveling back and

326
00:11:20,480 --> 00:11:23,200
forth and start and end times for that

327
00:11:23,200 --> 00:11:26,160
particular app usage notice the ones for

328
00:11:26,160 --> 00:11:27,600
the mac side they're all pretty much the

329
00:11:27,600 --> 00:11:28,399
same

330
00:11:28,399 --> 00:11:31,279
on the ios side you use one app at a

331
00:11:31,279 --> 00:11:35,120
time that's the major difference

332
00:11:35,120 --> 00:11:36,959
next one still knowledge see we're

333
00:11:36,959 --> 00:11:38,959
looking at a completely different query

334
00:11:38,959 --> 00:11:40,839
this one's going to be application

335
00:11:40,839 --> 00:11:42,959
intense so this one's going to give me a

336
00:11:42,959 --> 00:11:44,800
little bit more context so i know what

337
00:11:44,800 --> 00:11:46,800
application the users are using but what

338
00:11:46,800 --> 00:11:49,200
are they doing with that application

339
00:11:49,200 --> 00:11:50,959
so in this case i

340
00:11:50,959 --> 00:11:53,440
really see quite a bit more ios related

341
00:11:53,440 --> 00:11:55,760
stuff than mac os related stuff and this

342
00:11:55,760 --> 00:11:57,600
is pulled on the mac what we're looking

343
00:11:57,600 --> 00:12:00,000
at today was not pulled off of an ios

344
00:12:00,000 --> 00:12:02,320
device at all this is all just synced to

345
00:12:02,320 --> 00:12:03,839
the mac itself

346
00:12:03,839 --> 00:12:05,519
so we have the application name bundle

347
00:12:05,519 --> 00:12:06,560
id

348
00:12:06,560 --> 00:12:08,000
intent class is going to give you an

349
00:12:08,000 --> 00:12:09,360
idea of what you're doing with the

350
00:12:09,360 --> 00:12:10,399
application

351
00:12:10,399 --> 00:12:13,440
mobile sms i'm sending a message

352
00:12:13,440 --> 00:12:15,839
uh com eight bits tweety two compose

353
00:12:15,839 --> 00:12:18,480
message so i'm sending a direct message

354
00:12:18,480 --> 00:12:20,639
to someone i believe is for that one

355
00:12:20,639 --> 00:12:23,040
uh looking at trends search you kind of

356
00:12:23,040 --> 00:12:25,200
get an idea of what's being stored in

357
00:12:25,200 --> 00:12:26,480
there and same thing with the intent

358
00:12:26,480 --> 00:12:28,320
verb i'm doing send message

359
00:12:28,320 --> 00:12:29,839
something like that

360
00:12:29,839 --> 00:12:31,360
and then i have this other highlighted

361
00:12:31,360 --> 00:12:34,560
section this year serialized interaction

362
00:12:34,560 --> 00:12:35,839
we're just talking about ns key to

363
00:12:35,839 --> 00:12:37,920
archive or p-list files if you ever want

364
00:12:37,920 --> 00:12:39,600
to know more about those talk to me

365
00:12:39,600 --> 00:12:42,160
because i swim in them all day long

366
00:12:42,160 --> 00:12:44,320
forensics people come to

367
00:12:44,320 --> 00:12:46,639
hate them because they're serialized

368
00:12:46,639 --> 00:12:47,839
there's not a whole lot of context you

369
00:12:47,839 --> 00:12:50,320
have to rebuild uh that context to that

370
00:12:50,320 --> 00:12:52,160
so if you're looking for examples call

371
00:12:52,160 --> 00:12:54,399
me i know where they all are more or

372
00:12:54,399 --> 00:12:55,839
less so we'll take a closer look at that

373
00:12:55,839 --> 00:12:58,079
one just a little bit

374
00:12:58,079 --> 00:13:00,000
next thing we have and it's very

375
00:13:00,000 --> 00:13:02,399
application specific is this group id

376
00:13:02,399 --> 00:13:04,079
here it's going to tell you what chat

377
00:13:04,079 --> 00:13:06,399
maybe some contact information in there

378
00:13:06,399 --> 00:13:09,440
and a few other items

379
00:13:09,440 --> 00:13:11,360
now same thing i'm just kind of zooming

380
00:13:11,360 --> 00:13:13,040
in and showing you some other examples

381
00:13:13,040 --> 00:13:15,920
here so i got some music intense if i'm

382
00:13:15,920 --> 00:13:18,320
searching or selecting specific artists

383
00:13:18,320 --> 00:13:20,880
to uh to listen to i can open those up

384
00:13:20,880 --> 00:13:23,360
and see you know which artist i selected

385
00:13:23,360 --> 00:13:24,320
um

386
00:13:24,320 --> 00:13:26,959
assistant service siri uh type of stuff

387
00:13:26,959 --> 00:13:29,440
so maybe navigation items here and i

388
00:13:29,440 --> 00:13:31,440
specifically picked this one com apple

389
00:13:31,440 --> 00:13:33,120
find mine

390
00:13:33,120 --> 00:13:34,639
because i was

391
00:13:34,639 --> 00:13:36,079
on my phone

392
00:13:36,079 --> 00:13:37,760
and i was waiting for a friend of mine

393
00:13:37,760 --> 00:13:39,760
so i have her find my information on my

394
00:13:39,760 --> 00:13:40,560
phone

395
00:13:40,560 --> 00:13:42,399
um and i was basically stalking her

396
00:13:42,399 --> 00:13:43,760
you're supposed to meet up in new york

397
00:13:43,760 --> 00:13:45,440
i'm like where the heck is she and she's

398
00:13:45,440 --> 00:13:46,480
basically just

399
00:13:46,480 --> 00:13:48,720
trapped in traffic more or less i could

400
00:13:48,720 --> 00:13:50,800
see her going on broadway and stuff like

401
00:13:50,800 --> 00:13:53,519
that so i was constantly

402
00:13:53,519 --> 00:13:55,120
digitally stalking her at that

403
00:13:55,120 --> 00:13:57,279
particular time so i can actually see

404
00:13:57,279 --> 00:13:58,399
that

405
00:13:58,399 --> 00:14:00,240
stalking if you will i use the term very

406
00:14:00,240 --> 00:14:02,639
lightly for good friends she knows that

407
00:14:02,639 --> 00:14:04,959
i have room i find mine so i extracted

408
00:14:04,959 --> 00:14:07,279
this serialized interaction this nsp

409
00:14:07,279 --> 00:14:09,760
archiver plist file and i'm able to see

410
00:14:09,760 --> 00:14:11,680
who i was trying to look up and if i

411
00:14:11,680 --> 00:14:14,000
have you know 10 other friends in here

412
00:14:14,000 --> 00:14:16,079
maybe i'm looking at one versus another

413
00:14:16,079 --> 00:14:18,000
so you get a little bit more context on

414
00:14:18,000 --> 00:14:19,920
what the user is doing

415
00:14:19,920 --> 00:14:21,920
uh just another mention

416
00:14:21,920 --> 00:14:24,320
these blobs here i don't do anything

417
00:14:24,320 --> 00:14:26,880
with these blobs for apollo it is lazy

418
00:14:26,880 --> 00:14:28,720
after all but i do bring them out to hex

419
00:14:28,720 --> 00:14:30,720
so you can bring them in save them and

420
00:14:30,720 --> 00:14:32,639
save them as p-list files do whatever

421
00:14:32,639 --> 00:14:34,480
you want to do and i certainly could

422
00:14:34,480 --> 00:14:36,000
have done that with this one but this

423
00:14:36,000 --> 00:14:38,160
one's very very special this is nsk to

424
00:14:38,160 --> 00:14:40,560
archive a binary p-list but it has

425
00:14:40,560 --> 00:14:41,760
multiple

426
00:14:41,760 --> 00:14:43,920
nsket archiver binary keyless embedded

427
00:14:43,920 --> 00:14:46,399
into it so you have multiple levels of a

428
00:14:46,399 --> 00:14:48,079
b-list inception

429
00:14:48,079 --> 00:14:49,680
uh going on here so i was lazy i just

430
00:14:49,680 --> 00:14:52,000
threw into a hex editor so you can see

431
00:14:52,000 --> 00:14:53,920
kind of what the contents of that are

432
00:14:53,920 --> 00:14:57,680
it's not pretty to look at

433
00:14:57,680 --> 00:15:00,480
next one we have here web browsing uh so

434
00:15:00,480 --> 00:15:02,399
web browsing i can extract from a few

435
00:15:02,399 --> 00:15:03,920
different places i have the safari

436
00:15:03,920 --> 00:15:05,440
history database

437
00:15:05,440 --> 00:15:07,600
uh this one's mostly going to be only

438
00:15:07,600 --> 00:15:09,519
safari specific it's not going to do

439
00:15:09,519 --> 00:15:11,600
anything with chrome or firefox or any

440
00:15:11,600 --> 00:15:12,959
non-apple

441
00:15:12,959 --> 00:15:14,880
browser service here

442
00:15:14,880 --> 00:15:16,560
so this knowledge c is also keeping

443
00:15:16,560 --> 00:15:19,440
track of uh browsing information

444
00:15:19,440 --> 00:15:21,040
not private browsing that's the

445
00:15:21,040 --> 00:15:22,800
unfortunate piece here that does not get

446
00:15:22,800 --> 00:15:25,040
recorded into this database which is a

447
00:15:25,040 --> 00:15:27,519
good thing i do believe

448
00:15:27,519 --> 00:15:29,199
so we see it bouncing back and forth

449
00:15:29,199 --> 00:15:31,120
with the app name or the bundle id we

450
00:15:31,120 --> 00:15:33,600
have com apple safari that's the mac os

451
00:15:33,600 --> 00:15:36,480
safari bundle id bouncing to com apple

452
00:15:36,480 --> 00:15:38,320
mobile safari so it's me bouncing back

453
00:15:38,320 --> 00:15:41,600
and forth between mac and ios devices

454
00:15:41,600 --> 00:15:43,759
also i have highlighted here

455
00:15:43,759 --> 00:15:46,399
multiple device ids this is where using

456
00:15:46,399 --> 00:15:48,720
this for web browsing forensic analysis

457
00:15:48,720 --> 00:15:50,800
is actually a little bit more useful if

458
00:15:50,800 --> 00:15:52,560
i'm looking at the history db the one

459
00:15:52,560 --> 00:15:54,240
that's under safari specifically

460
00:15:54,240 --> 00:15:56,160
collecting all your visits and urls and

461
00:15:56,160 --> 00:15:57,279
all that good

462
00:15:57,279 --> 00:16:00,800
stuff it does not tell me which device

463
00:16:00,800 --> 00:16:02,639
it tells me it was this device or

464
00:16:02,639 --> 00:16:05,279
another icloud connected device so if

465
00:16:05,279 --> 00:16:07,839
i'm curious i need to expand my options

466
00:16:07,839 --> 00:16:10,720
i might go to knowledge c uh database

467
00:16:10,720 --> 00:16:12,320
and see which device so this is the

468
00:16:12,320 --> 00:16:14,000
hardware uuid

469
00:16:14,000 --> 00:16:16,079
this two two eight zero one this is my

470
00:16:16,079 --> 00:16:17,279
iphone

471
00:16:17,279 --> 00:16:19,360
it's five five two zero one this is my

472
00:16:19,360 --> 00:16:22,320
ipad so i can see myself browsing across

473
00:16:22,320 --> 00:16:24,560
different devices so i get a little bit

474
00:16:24,560 --> 00:16:26,880
of bonus extra information in knowledge

475
00:16:26,880 --> 00:16:30,240
c which is fantastic

476
00:16:30,240 --> 00:16:32,399
all right what else

477
00:16:32,399 --> 00:16:34,000
other than that we see the browsing the

478
00:16:34,000 --> 00:16:36,800
time stamps the urls all that good stuff

479
00:16:36,800 --> 00:16:38,240
stuff that i would expect to find in

480
00:16:38,240 --> 00:16:40,720
other databases as well

481
00:16:40,720 --> 00:16:42,320
all right next up application

482
00:16:42,320 --> 00:16:44,880
notifications so if samuel was pointing

483
00:16:44,880 --> 00:16:46,639
my phone

484
00:16:46,639 --> 00:16:48,000
and it's sending all those different

485
00:16:48,000 --> 00:16:49,199
messages

486
00:16:49,199 --> 00:16:52,639
if i have the the message syncing being

487
00:16:52,639 --> 00:16:54,240
turned on probably going to get those

488
00:16:54,240 --> 00:16:56,320
messages on mac os as well so you'll be

489
00:16:56,320 --> 00:16:58,240
able to see a lot of the notifications

490
00:16:58,240 --> 00:16:59,279
coming in

491
00:16:59,279 --> 00:17:01,600
across the devices as well

492
00:17:01,600 --> 00:17:03,360
so again we have the bundle id a couple

493
00:17:03,360 --> 00:17:05,359
little shout outs i used of course dnd

494
00:17:05,359 --> 00:17:07,039
from digital

495
00:17:07,039 --> 00:17:09,599
so this one is doing a notification so

496
00:17:09,599 --> 00:17:12,880
open up my laptop right shout out right

497
00:17:12,880 --> 00:17:14,799
open up my laptop gives me the dnd

498
00:17:14,799 --> 00:17:17,199
notification on my phone it's also

499
00:17:17,199 --> 00:17:19,919
syncing that to this particular database

500
00:17:19,919 --> 00:17:21,520
so i can see

501
00:17:21,520 --> 00:17:23,760
when people are you know doing with the

502
00:17:23,760 --> 00:17:25,359
different devices

503
00:17:25,359 --> 00:17:27,439
and then we have system center com apple

504
00:17:27,439 --> 00:17:29,600
software update notification probably

505
00:17:29,600 --> 00:17:31,600
very familiar with this one

506
00:17:31,600 --> 00:17:33,679
please update please update please

507
00:17:33,679 --> 00:17:36,240
update and you keep saying no not today

508
00:17:36,240 --> 00:17:39,280
not today not today right yeah so i can

509
00:17:39,280 --> 00:17:40,320
see

510
00:17:40,320 --> 00:17:42,240
that you are not installing your updates

511
00:17:42,240 --> 00:17:44,080
on a timely basis

512
00:17:44,080 --> 00:17:46,000
um other ones in here i have things like

513
00:17:46,000 --> 00:17:48,000
news and email and messaging and all the

514
00:17:48,000 --> 00:17:49,840
other ones for notifications that you

515
00:17:49,840 --> 00:17:51,600
would expect to see here so there's

516
00:17:51,600 --> 00:17:52,960
different types

517
00:17:52,960 --> 00:17:55,600
the hardware information again it's

518
00:17:55,600 --> 00:17:57,200
basically combining them from both

519
00:17:57,200 --> 00:17:59,120
platforms and a little bit more

520
00:17:59,120 --> 00:18:01,039
information things like messages and i

521
00:18:01,039 --> 00:18:02,640
can use a lot of these different goods

522
00:18:02,640 --> 00:18:05,760
and uuids and things like that to target

523
00:18:05,760 --> 00:18:07,600
you know which email

524
00:18:07,600 --> 00:18:09,840
was notified at a specific time so

525
00:18:09,840 --> 00:18:11,520
everything in the apple echo system will

526
00:18:11,520 --> 00:18:14,080
be tied together very often with some

527
00:18:14,080 --> 00:18:16,720
sort of good or kind of tag with that

528
00:18:16,720 --> 00:18:18,880
one

529
00:18:19,039 --> 00:18:21,440
a few other app notifications so same

530
00:18:21,440 --> 00:18:22,880
one that i was just talking about just

531
00:18:22,880 --> 00:18:24,640
on a per app basis

532
00:18:24,640 --> 00:18:26,240
we have little snitch so i got little

533
00:18:26,240 --> 00:18:27,760
snitch installed i got all the things

534
00:18:27,760 --> 00:18:30,240
installed a little stitch installed it

535
00:18:30,240 --> 00:18:32,559
wants to open up a new process

536
00:18:32,559 --> 00:18:34,640
i received that notification

537
00:18:34,640 --> 00:18:37,919
can't tell here what application or what

538
00:18:37,919 --> 00:18:40,000
process or any other information but

539
00:18:40,000 --> 00:18:42,000
we'll be able to see that in another

540
00:18:42,000 --> 00:18:43,840
database this is another reason why i

541
00:18:43,840 --> 00:18:46,480
created apollo if i'm just only looking

542
00:18:46,480 --> 00:18:49,200
at one database at a time i lose the

543
00:18:49,200 --> 00:18:51,120
context of what might be happening in

544
00:18:51,120 --> 00:18:53,360
other places on the file system

545
00:18:53,360 --> 00:18:54,559
so we're going to see little snitch a

546
00:18:54,559 --> 00:18:56,640
little bit later on uh we got

547
00:18:56,640 --> 00:18:59,039
notification center ask permissions you

548
00:18:59,039 --> 00:19:00,559
might install some application and of

549
00:19:00,559 --> 00:19:01,840
course it's going to ask you hey can i

550
00:19:01,840 --> 00:19:03,200
get access to

551
00:19:03,200 --> 00:19:05,760
whatever microphone pictures

552
00:19:05,760 --> 00:19:07,120
what have you we're going to take a look

553
00:19:07,120 --> 00:19:09,600
at the tcc database in a little bit

554
00:19:09,600 --> 00:19:12,320
uh sharing d what's sharing d associated

555
00:19:12,320 --> 00:19:14,559
with

556
00:19:14,640 --> 00:19:16,320
say that again

557
00:19:16,320 --> 00:19:17,440
airplay

558
00:19:17,440 --> 00:19:19,440
airdrop you're thinking airdrop right

559
00:19:19,440 --> 00:19:21,280
yeah airdrop in reality it's all

560
00:19:21,280 --> 00:19:23,039
continuity based services but

561
00:19:23,039 --> 00:19:24,880
specifically for this one this one is

562
00:19:24,880 --> 00:19:26,400
airdrop we're going to see that one a

563
00:19:26,400 --> 00:19:28,000
little bit so if i get something

564
00:19:28,000 --> 00:19:30,559
airdropped little notification pops up i

565
00:19:30,559 --> 00:19:33,360
can see that and then finally

566
00:19:33,360 --> 00:19:35,360
these are coming these are notifications

567
00:19:35,360 --> 00:19:37,440
from my ios device so i don't have

568
00:19:37,440 --> 00:19:39,360
signal installed on my desktop yes i

569
00:19:39,360 --> 00:19:41,440
don't think so no don't have it

570
00:19:41,440 --> 00:19:43,360
installed on my desktop right now but i

571
00:19:43,360 --> 00:19:45,200
do have it installed on my phone so

572
00:19:45,200 --> 00:19:47,280
somebody sends me a signal message i get

573
00:19:47,280 --> 00:19:48,880
a notification

574
00:19:48,880 --> 00:19:50,640
and then i see it also getting synced

575
00:19:50,640 --> 00:19:52,320
into this database so again you have

576
00:19:52,320 --> 00:19:55,120
that cross contamination piece i hate to

577
00:19:55,120 --> 00:19:57,039
use that word right now

578
00:19:57,039 --> 00:19:58,880
but you see that being synced across the

579
00:19:58,880 --> 00:20:00,960
different devices awesome from a

580
00:20:00,960 --> 00:20:04,600
forensics perspective

581
00:20:08,400 --> 00:20:10,480
all right and one more for knowledge c

582
00:20:10,480 --> 00:20:12,320
now playing

583
00:20:12,320 --> 00:20:14,240
this is what's playing honestly this is

584
00:20:14,240 --> 00:20:16,400
i'm either rocking out to apple music

585
00:20:16,400 --> 00:20:17,280
i'm

586
00:20:17,280 --> 00:20:19,200
maybe watching some videos playing some

587
00:20:19,200 --> 00:20:22,000
videos or if you are looking at my

588
00:20:22,000 --> 00:20:24,240
device you're going to see a lot of com

589
00:20:24,240 --> 00:20:27,600
apple webkit web content

590
00:20:27,600 --> 00:20:28,720
for twitter

591
00:20:28,720 --> 00:20:30,880
specifically this is me scrolling

592
00:20:30,880 --> 00:20:33,600
twitter on my ios device

593
00:20:33,600 --> 00:20:35,760
over and over and over every little gif

594
00:20:35,760 --> 00:20:38,480
every little video has another entry in

595
00:20:38,480 --> 00:20:39,440
there

596
00:20:39,440 --> 00:20:41,600
i have a lot of these entries on my own

597
00:20:41,600 --> 00:20:43,679
particular device and you'll notice the

598
00:20:43,679 --> 00:20:45,919
usage in seconds over here they're you

599
00:20:45,919 --> 00:20:48,400
know zero one two three seconds so i'm

600
00:20:48,400 --> 00:20:50,799
really honestly just scrolling scrolling

601
00:20:50,799 --> 00:20:51,840
scrolling

602
00:20:51,840 --> 00:20:54,559
kind of just to to peruse whatever is on

603
00:20:54,559 --> 00:20:56,559
twitter

604
00:20:56,559 --> 00:20:58,559
oh and the new grimes album

605
00:20:58,559 --> 00:21:01,879
pretty awesome

606
00:21:02,320 --> 00:21:04,240
all right next database so that was all

607
00:21:04,240 --> 00:21:06,640
knowledge c knowledge c has a lot of

608
00:21:06,640 --> 00:21:08,320
different items in there it is again one

609
00:21:08,320 --> 00:21:10,559
of my favorite databases

610
00:21:10,559 --> 00:21:12,760
so next up network usage or net

611
00:21:12,760 --> 00:21:14,640
usage.sqlite

612
00:21:14,640 --> 00:21:16,480
this one is uh

613
00:21:16,480 --> 00:21:18,000
more or less keeping track of all the

614
00:21:18,000 --> 00:21:19,840
different processes and application and

615
00:21:19,840 --> 00:21:22,480
the data that's being transferred across

616
00:21:22,480 --> 00:21:23,919
different networks

617
00:21:23,919 --> 00:21:25,600
to get the time stamps in there some

618
00:21:25,600 --> 00:21:28,000
bundle ids and process names and i have

619
00:21:28,000 --> 00:21:29,760
highlighted here three different

620
00:21:29,760 --> 00:21:31,200
sections

621
00:21:31,200 --> 00:21:33,120
wi-fi in out

622
00:21:33,120 --> 00:21:37,840
wn in out and wired in out

623
00:21:37,840 --> 00:21:40,640
these two are interesting wi-fi cool i

624
00:21:40,640 --> 00:21:42,320
have a macbook air here of course i'm

625
00:21:42,320 --> 00:21:43,520
going to connect to the network over

626
00:21:43,520 --> 00:21:44,880
wifi

627
00:21:44,880 --> 00:21:47,039
wm

628
00:21:47,039 --> 00:21:48,720
okay

629
00:21:48,720 --> 00:21:50,400
not quite sure what i have for this one

630
00:21:50,400 --> 00:21:52,320
but i do find that it's a lot of mac

631
00:21:52,320 --> 00:21:54,320
specific processes so i don't know if

632
00:21:54,320 --> 00:21:57,360
it's kind of internal processing or

633
00:21:57,360 --> 00:21:59,039
maybe bluetooth or something like that

634
00:21:59,039 --> 00:22:00,640
so i'm going to have to investigate that

635
00:22:00,640 --> 00:22:02,480
one a little closer on

636
00:22:02,480 --> 00:22:04,400
and then we have wire

637
00:22:04,400 --> 00:22:06,320
i have never had a wired connection on

638
00:22:06,320 --> 00:22:08,960
this laptop before because you know i'm

639
00:22:08,960 --> 00:22:11,039
a mac user who does that right

640
00:22:11,039 --> 00:22:12,400
uh but yet

641
00:22:12,400 --> 00:22:14,960
i still see data being stored in here

642
00:22:14,960 --> 00:22:16,880
for that one so i have a little bit of

643
00:22:16,880 --> 00:22:18,640
investigation that i have to do there's

644
00:22:18,640 --> 00:22:20,000
actually quite a few different modules

645
00:22:20,000 --> 00:22:21,120
that i have yet to do some

646
00:22:21,120 --> 00:22:22,880
investigations of how can they be useful

647
00:22:22,880 --> 00:22:24,559
why do they get populated

648
00:22:24,559 --> 00:22:25,919
the whole reason again why i created

649
00:22:25,919 --> 00:22:27,600
apollo is so i can make that testing a

650
00:22:27,600 --> 00:22:29,120
little bit easier so i can run these

651
00:22:29,120 --> 00:22:31,840
live in my system and say if i do this

652
00:22:31,840 --> 00:22:33,679
what does it look like in the databases

653
00:22:33,679 --> 00:22:36,159
themselves so for net usage this one i'm

654
00:22:36,159 --> 00:22:38,640
going to look into in particular try to

655
00:22:38,640 --> 00:22:40,400
figure out why is it being stored in one

656
00:22:40,400 --> 00:22:44,320
place uh for say a wired versus wi-fi

657
00:22:44,320 --> 00:22:46,240
what is the internal processing of why

658
00:22:46,240 --> 00:22:49,360
that's being stored in there

659
00:22:49,520 --> 00:22:52,000
next database interaction c uh so this

660
00:22:52,000 --> 00:22:53,760
is also kind of under the knowledge c

661
00:22:53,760 --> 00:22:55,840
area it's all under core duet

662
00:22:55,840 --> 00:22:57,679
this one is great for contact

663
00:22:57,679 --> 00:22:59,120
information

664
00:22:59,120 --> 00:23:01,679
so who's talking to who all that kind of

665
00:23:01,679 --> 00:23:03,200
context

666
00:23:03,200 --> 00:23:04,799
so i've got start information in here

667
00:23:04,799 --> 00:23:06,799
bundle ids for which application is in

668
00:23:06,799 --> 00:23:09,200
use at that time the display name so who

669
00:23:09,200 --> 00:23:10,880
this is who i'm talking with obviously

670
00:23:10,880 --> 00:23:13,760
i'm in here uh and i'm chatting uh going

671
00:23:13,760 --> 00:23:17,120
back and forth through ichat messages

672
00:23:17,120 --> 00:23:19,679
uh with with heather maholick

673
00:23:19,679 --> 00:23:21,200
and every once in a while i get one free

674
00:23:21,200 --> 00:23:22,799
email in here

675
00:23:22,799 --> 00:23:24,720
this one with brayden's my cat sitter

676
00:23:24,720 --> 00:23:26,720
whenever i travel and i travel a lot

677
00:23:26,720 --> 00:23:28,080
talk to him he sends me cute cat

678
00:23:28,080 --> 00:23:29,360
pictures

679
00:23:29,360 --> 00:23:30,960
anybody can send me cat pictures doesn't

680
00:23:30,960 --> 00:23:32,799
even have to be my cat i would highly

681
00:23:32,799 --> 00:23:34,480
appreciate it

682
00:23:34,480 --> 00:23:36,799
um talking through email with another

683
00:23:36,799 --> 00:23:38,880
friend of mine jessica hyde so we see

684
00:23:38,880 --> 00:23:40,720
the interactions with that so it gives a

685
00:23:40,720 --> 00:23:43,120
little bit more context uh to the data

686
00:23:43,120 --> 00:23:45,520
that's being presented here uh apologies

687
00:23:45,520 --> 00:23:47,600
for the uh redaction but i'm pretty sure

688
00:23:47,600 --> 00:23:49,919
nobody wants their emails and i and

689
00:23:49,919 --> 00:23:51,919
numbers being presented at these

690
00:23:51,919 --> 00:23:53,520
conferences so i got to do a little bit

691
00:23:53,520 --> 00:23:55,039
of redaction here

692
00:23:55,039 --> 00:23:57,200
and then we have this person id

693
00:23:57,200 --> 00:23:58,799
and again this is where the apple echo

694
00:23:58,799 --> 00:24:01,520
system ties everything together whenever

695
00:24:01,520 --> 00:24:03,840
you see these av person records this

696
00:24:03,840 --> 00:24:06,640
means this particular contact is in my

697
00:24:06,640 --> 00:24:09,279
contacts database i knowingly put that

698
00:24:09,279 --> 00:24:10,320
in there

699
00:24:10,320 --> 00:24:12,400
so i have one course for heather maholic

700
00:24:12,400 --> 00:24:14,400
everybody gets a unique id associated

701
00:24:14,400 --> 00:24:17,120
with that and i can go to the contacts

702
00:24:17,120 --> 00:24:20,159
data area to find pictures associated

703
00:24:20,159 --> 00:24:22,400
other metadata other contact information

704
00:24:22,400 --> 00:24:24,400
associated with that contact

705
00:24:24,400 --> 00:24:28,320
everything is being tied together

706
00:24:28,320 --> 00:24:30,080
and then we have another notifications

707
00:24:30,080 --> 00:24:31,600
so we don't just have one notifications

708
00:24:31,600 --> 00:24:33,360
we have actually a few different ones

709
00:24:33,360 --> 00:24:35,039
this is what's commonly known as the

710
00:24:35,039 --> 00:24:37,039
notifications database com apple

711
00:24:37,039 --> 00:24:38,640
notification center

712
00:24:38,640 --> 00:24:39,919
file name is

713
00:24:39,919 --> 00:24:42,880
db or excuse me file path is db2 and the

714
00:24:42,880 --> 00:24:47,200
actual database is just called db cool

715
00:24:47,200 --> 00:24:48,880
nothing else in the world could possibly

716
00:24:48,880 --> 00:24:50,640
be called db yeah there's actually two

717
00:24:50,640 --> 00:24:52,000
databases that i'm going to talk about

718
00:24:52,000 --> 00:24:54,000
both called db

719
00:24:54,000 --> 00:24:55,520
uh so this one's keeping track of more

720
00:24:55,520 --> 00:24:58,080
notifications uh the bundle id so this

721
00:24:58,080 --> 00:25:01,440
me being you know notifica notification

722
00:25:01,440 --> 00:25:03,279
harassed by slack

723
00:25:03,279 --> 00:25:04,960
you know all of a sudden some

724
00:25:04,960 --> 00:25:06,799
slack conversation really gets heated to

725
00:25:06,799 --> 00:25:09,120
get bam bam bam bam bam slack slack

726
00:25:09,120 --> 00:25:10,159
slack

727
00:25:10,159 --> 00:25:11,679
um

728
00:25:11,679 --> 00:25:13,760
down here i got my little snitch so i

729
00:25:13,760 --> 00:25:16,400
either ran a program or opened something

730
00:25:16,400 --> 00:25:19,039
and was calling out to some place this

731
00:25:19,039 --> 00:25:20,320
is where i can get a little bit more

732
00:25:20,320 --> 00:25:22,640
information about what's happening with

733
00:25:22,640 --> 00:25:24,559
that little snitch connection

734
00:25:24,559 --> 00:25:26,480
because i have another

735
00:25:26,480 --> 00:25:29,120
blob here and this is another p list i

736
00:25:29,120 --> 00:25:30,799
don't believe this one is an ns key dark

737
00:25:30,799 --> 00:25:32,640
hyper p list i think this is just a good

738
00:25:32,640 --> 00:25:35,919
old binary key list and forensics people

739
00:25:35,919 --> 00:25:38,240
will often find six two seven zero

740
00:25:38,240 --> 00:25:40,720
thirty thirty vp list zero zero the

741
00:25:40,720 --> 00:25:42,400
header once you start seeing that over

742
00:25:42,400 --> 00:25:44,080
and over a lot of the blobs are going to

743
00:25:44,080 --> 00:25:46,799
be stored as binary p lists of some sort

744
00:25:46,799 --> 00:25:49,600
in some of these databases

745
00:25:49,600 --> 00:25:51,440
so if i open up one of those this one's

746
00:25:51,440 --> 00:25:54,000
just a nice little keyless not too big

747
00:25:54,000 --> 00:25:56,400
to handle here shows me of course the

748
00:25:56,400 --> 00:25:58,960
app little snitch bundle id uh so this

749
00:25:58,960 --> 00:26:01,039
is google earth pro so i just opened up

750
00:26:01,039 --> 00:26:03,200
executed uh google pro

751
00:26:03,200 --> 00:26:04,880
and wanted to make a new silent mode

752
00:26:04,880 --> 00:26:05,840
connection

753
00:26:05,840 --> 00:26:07,360
very much the same text that you're

754
00:26:07,360 --> 00:26:08,320
going to see in that little little

755
00:26:08,320 --> 00:26:10,400
snitch pop-up in your upper right hand

756
00:26:10,400 --> 00:26:15,120
corner but it gives me that more context

757
00:26:15,120 --> 00:26:17,120
all right now let's go to current power

758
00:26:17,120 --> 00:26:17,919
log

759
00:26:17,919 --> 00:26:20,640
this is the bane of my existence current

760
00:26:20,640 --> 00:26:24,080
power log plsql database

761
00:26:24,080 --> 00:26:25,760
has approximately

762
00:26:25,760 --> 00:26:28,480
120 different tables in there so there's

763
00:26:28,480 --> 00:26:30,559
small databases and there are extremely

764
00:26:30,559 --> 00:26:32,480
large databases and power log is

765
00:26:32,480 --> 00:26:34,240
probably one of the more

766
00:26:34,240 --> 00:26:36,720
extensive databases out there the other

767
00:26:36,720 --> 00:26:38,400
thing with power log is that it likes to

768
00:26:38,400 --> 00:26:39,440
store

769
00:26:39,440 --> 00:26:42,960
time stamps with an offset

770
00:26:43,520 --> 00:26:45,679
don't know why i honestly have no clue

771
00:26:45,679 --> 00:26:46,960
why and i would love to know it's

772
00:26:46,960 --> 00:26:49,200
probably the dumbest reason in the world

773
00:26:49,200 --> 00:26:51,200
but this is why you're seeing adjusted

774
00:26:51,200 --> 00:26:53,600
timestamp here so there's another table

775
00:26:53,600 --> 00:26:55,360
in this database that has all the

776
00:26:55,360 --> 00:26:57,919
offsets by second so in this case the

777
00:26:57,919 --> 00:26:59,520
offset for this one

778
00:26:59,520 --> 00:27:02,320
is a lot of seconds ios i've seen

779
00:27:02,320 --> 00:27:03,760
anywhere from

780
00:27:03,760 --> 00:27:06,559
20 seconds off 12 minutes off if you do

781
00:27:06,559 --> 00:27:08,720
this calculation we're looking at about

782
00:27:08,720 --> 00:27:11,039
a month off and if you're not used to

783
00:27:11,039 --> 00:27:13,520
doing forensics on power log database

784
00:27:13,520 --> 00:27:14,880
you just see a time stamp you're saying

785
00:27:14,880 --> 00:27:16,880
oh okay this is obviously

786
00:27:16,880 --> 00:27:20,720
uh february 6 2020. that is absolutely

787
00:27:20,720 --> 00:27:22,399
incorrect from a forensics perspective

788
00:27:22,399 --> 00:27:24,399
you want to be as accurate down to the

789
00:27:24,399 --> 00:27:27,760
second as possible in many cases

790
00:27:27,760 --> 00:27:29,440
you know this stuff is going to court

791
00:27:29,440 --> 00:27:30,960
you don't want to say that this specific

792
00:27:30,960 --> 00:27:33,760
event happened a month prior because

793
00:27:33,760 --> 00:27:35,760
you're interpreting the timestamp wrong

794
00:27:35,760 --> 00:27:38,080
so this is why i always always always do

795
00:27:38,080 --> 00:27:39,760
testing i have not seen this issue

796
00:27:39,760 --> 00:27:41,039
anywhere else

797
00:27:41,039 --> 00:27:42,799
other than specifically the power log

798
00:27:42,799 --> 00:27:43,919
database

799
00:27:43,919 --> 00:27:46,080
so i have this extremely weird

800
00:27:46,080 --> 00:27:48,720
multi-select sql query

801
00:27:48,720 --> 00:27:51,520
uh to basically interpret uh that offset

802
00:27:51,520 --> 00:27:53,440
table now it might be one or two seconds

803
00:27:53,440 --> 00:27:54,880
off just because i can only do so much

804
00:27:54,880 --> 00:27:56,480
within the sqlite

805
00:27:56,480 --> 00:27:58,559
uh if you did this programmatically it

806
00:27:58,559 --> 00:28:00,000
would absolutely be a little bit more

807
00:28:00,000 --> 00:28:01,600
accurate but we're looking at one to two

808
00:28:01,600 --> 00:28:03,600
seconds and i let people know that

809
00:28:03,600 --> 00:28:05,440
because that one two seconds could come

810
00:28:05,440 --> 00:28:07,360
into play at some point

811
00:28:07,360 --> 00:28:09,520
so this one we have the front most app

812
00:28:09,520 --> 00:28:11,279
knowledge c we saw the applications

813
00:28:11,279 --> 00:28:12,880
being used this one's going to say

814
00:28:12,880 --> 00:28:15,520
what's being used right now what is the

815
00:28:15,520 --> 00:28:17,919
user looking at at this particular time

816
00:28:17,919 --> 00:28:19,760
again by bundle id

817
00:28:19,760 --> 00:28:22,240
there's the asm the apple system number

818
00:28:22,240 --> 00:28:23,360
in there

819
00:28:23,360 --> 00:28:25,760
as well as an application type usually

820
00:28:25,760 --> 00:28:28,720
system versus third party or whatnot so

821
00:28:28,720 --> 00:28:30,559
it gives me a little bit more

822
00:28:30,559 --> 00:28:32,960
specific information now another kicker

823
00:28:32,960 --> 00:28:34,240
with power log

824
00:28:34,240 --> 00:28:36,559
is really only keeping this information

825
00:28:36,559 --> 00:28:38,399
for about three days

826
00:28:38,399 --> 00:28:40,159
knowledge c we're looking at about a

827
00:28:40,159 --> 00:28:42,559
month worth of data retention power log

828
00:28:42,559 --> 00:28:44,880
three days but there's also power log

829
00:28:44,880 --> 00:28:47,600
archives and i've seen a bunch of those

830
00:28:47,600 --> 00:28:49,360
so you might have

831
00:28:49,360 --> 00:28:52,000
i don't know give or take two weeks

832
00:28:52,000 --> 00:28:54,720
if you look at the archive files

833
00:28:54,720 --> 00:28:56,240
with the power logs

834
00:28:56,240 --> 00:28:59,279
so data retention is big you can't just

835
00:28:59,279 --> 00:29:01,679
you know get an image of the device um

836
00:29:01,679 --> 00:29:02,640
or just

837
00:29:02,640 --> 00:29:04,399
rip a database out of the device and

838
00:29:04,399 --> 00:29:06,799
hope that it sticks around um

839
00:29:06,799 --> 00:29:08,159
if you don't have it within three days

840
00:29:08,159 --> 00:29:09,440
you don't have it

841
00:29:09,440 --> 00:29:10,840
it's not going to hang around for too

842
00:29:10,840 --> 00:29:14,880
long another current power log app info

843
00:29:14,880 --> 00:29:16,559
so this is keeping track of more or less

844
00:29:16,559 --> 00:29:18,320
applications that were being used again

845
00:29:18,320 --> 00:29:20,640
the last three days or so

846
00:29:20,640 --> 00:29:22,000
it's going to keep track of name

847
00:29:22,000 --> 00:29:24,559
executable names

848
00:29:24,559 --> 00:29:26,480
a lot of different display names in here

849
00:29:26,480 --> 00:29:28,320
the bundle id as well as a lot of the

850
00:29:28,320 --> 00:29:29,840
versioning information so if i'm

851
00:29:29,840 --> 00:29:32,080
constantly updating things within three

852
00:29:32,080 --> 00:29:34,880
days i can see that versioning uh get

853
00:29:34,880 --> 00:29:37,200
updated in there so this is not every

854
00:29:37,200 --> 00:29:39,039
application on the device i can

855
00:29:39,039 --> 00:29:40,880
certainly go to a lot of the info p list

856
00:29:40,880 --> 00:29:42,159
and extract a lot of the same

857
00:29:42,159 --> 00:29:45,120
information from these but it's the last

858
00:29:45,120 --> 00:29:47,360
three so i get some user interaction for

859
00:29:47,360 --> 00:29:51,120
the last three days worth of data

860
00:29:51,120 --> 00:29:53,600
a couple other ones as far as user

861
00:29:53,600 --> 00:29:55,360
users are involved with uh with current

862
00:29:55,360 --> 00:29:57,600
power log clamshell state

863
00:29:57,600 --> 00:30:00,080
we all have laptops pretty much in here

864
00:30:00,080 --> 00:30:02,480
open close you know sometimes as a

865
00:30:02,480 --> 00:30:04,640
forensic person i want to say

866
00:30:04,640 --> 00:30:06,880
is the user actually using this and i

867
00:30:06,880 --> 00:30:08,559
can look at a lot of data a lot of

868
00:30:08,559 --> 00:30:10,640
activity in these databases i want to

869
00:30:10,640 --> 00:30:13,120
see is the laptop open can the is the

870
00:30:13,120 --> 00:30:14,399
person actually

871
00:30:14,399 --> 00:30:15,600
you know assuming that they're standing

872
00:30:15,600 --> 00:30:17,919
there actually see stuff and is actually

873
00:30:17,919 --> 00:30:20,240
interacting with the system itself first

874
00:30:20,240 --> 00:30:23,039
things first is laptop closed or is it

875
00:30:23,039 --> 00:30:25,120
open so pretty simple this one's one of

876
00:30:25,120 --> 00:30:27,039
the easier ones in the current power log

877
00:30:27,039 --> 00:30:29,919
database you know one is closed zero is

878
00:30:29,919 --> 00:30:31,039
open

879
00:30:31,039 --> 00:30:34,159
and you get all that great information

880
00:30:34,159 --> 00:30:36,080
and then this one this one is kind of

881
00:30:36,080 --> 00:30:39,840
specific to mac itself idleness so user

882
00:30:39,840 --> 00:30:41,279
may be there

883
00:30:41,279 --> 00:30:42,880
or they might you know

884
00:30:42,880 --> 00:30:44,480
go walk away from their systems for a

885
00:30:44,480 --> 00:30:45,440
while

886
00:30:45,440 --> 00:30:47,200
so i'm pretty sure it's configurable but

887
00:30:47,200 --> 00:30:49,200
mine is set to timeout for about five

888
00:30:49,200 --> 00:30:51,679
minutes and that's when these timestamps

889
00:30:51,679 --> 00:30:53,520
uh tend to

890
00:30:53,520 --> 00:30:55,840
you know change back and forth so user

891
00:30:55,840 --> 00:30:57,840
is active and a timer starts as soon as

892
00:30:57,840 --> 00:30:59,440
they're not active timer starts for

893
00:30:59,440 --> 00:31:00,960
about five minutes if it hits that five

894
00:31:00,960 --> 00:31:02,000
minutes

895
00:31:02,000 --> 00:31:04,000
an entry is written into this database

896
00:31:04,000 --> 00:31:05,919
they come back another entry is written

897
00:31:05,919 --> 00:31:08,480
into this database so just being able to

898
00:31:08,480 --> 00:31:11,200
put a person or hands-on keyboard

899
00:31:11,200 --> 00:31:12,480
can be quite useful in many

900
00:31:12,480 --> 00:31:15,360
investigations

901
00:31:15,360 --> 00:31:16,399
all right so let's talk a little bit

902
00:31:16,399 --> 00:31:18,240
more about the security aspect so i can

903
00:31:18,240 --> 00:31:20,799
do user activity all day long but i also

904
00:31:20,799 --> 00:31:22,880
specifically on the mac side want to

905
00:31:22,880 --> 00:31:25,039
look at the security aspects of the

906
00:31:25,039 --> 00:31:26,960
system maybe i'm doing a you know

907
00:31:26,960 --> 00:31:28,960
examination post compromise i want to

908
00:31:28,960 --> 00:31:31,200
see what happened with that

909
00:31:31,200 --> 00:31:34,480
so nice little database tcc.db

910
00:31:34,480 --> 00:31:36,720
transparency consent control you install

911
00:31:36,720 --> 00:31:38,159
an application it's asking you which

912
00:31:38,159 --> 00:31:40,240
permissions you want to allow it this is

913
00:31:40,240 --> 00:31:43,039
what keeping track of those selections

914
00:31:43,039 --> 00:31:44,559
get the bundle id the service here is

915
00:31:44,559 --> 00:31:46,240
going to tell you what type of

916
00:31:46,240 --> 00:31:48,000
permissions it is cameras camera

917
00:31:48,000 --> 00:31:49,679
microphones microphone

918
00:31:49,679 --> 00:31:51,519
no one seems to know what liverpool does

919
00:31:51,519 --> 00:31:54,399
and i'm very very i have an

920
00:31:54,399 --> 00:31:56,559
idea of what it might be for but you

921
00:31:56,559 --> 00:31:57,760
know we'd love to have that discussion

922
00:31:57,760 --> 00:31:59,440
later on especially if somebody actually

923
00:31:59,440 --> 00:32:01,360
really knows not guessing but like

924
00:32:01,360 --> 00:32:02,880
actually knows because you cannot find

925
00:32:02,880 --> 00:32:05,200
any documentation on that other than a

926
00:32:05,200 --> 00:32:07,440
few articles that i think howard oakley

927
00:32:07,440 --> 00:32:08,880
has written about

928
00:32:08,880 --> 00:32:09,679
us

929
00:32:09,679 --> 00:32:11,200
so we'll talk about that a little bit

930
00:32:11,200 --> 00:32:12,640
later on

931
00:32:12,640 --> 00:32:14,880
um bundle id for the client and whether

932
00:32:14,880 --> 00:32:17,200
it's been allowed or not so whether the

933
00:32:17,200 --> 00:32:19,120
user says yes it can use the camera or

934
00:32:19,120 --> 00:32:20,880
not use the camera

935
00:32:20,880 --> 00:32:23,519
and on the newer devices 1015

936
00:32:23,519 --> 00:32:26,159
uh we do have a last modified so tcc did

937
00:32:26,159 --> 00:32:27,440
not always used to have this last

938
00:32:27,440 --> 00:32:29,200
modified timestamp this is the other

939
00:32:29,200 --> 00:32:31,679
thing with databases the schema changes

940
00:32:31,679 --> 00:32:34,240
all the time so one version from another

941
00:32:34,240 --> 00:32:36,000
is not necessarily going to be even

942
00:32:36,000 --> 00:32:38,880
close to being this uh to being the same

943
00:32:38,880 --> 00:32:40,880
so last modified if i changed this

944
00:32:40,880 --> 00:32:43,600
permission recently or some malicious

945
00:32:43,600 --> 00:32:45,519
user changed this permission

946
00:32:45,519 --> 00:32:47,600
recently i can put this into my timeline

947
00:32:47,600 --> 00:32:49,679
say okay it's doing something you know

948
00:32:49,679 --> 00:32:51,360
with this particular camera or

949
00:32:51,360 --> 00:32:55,039
microphone uh permission

950
00:32:55,039 --> 00:32:56,399
so there are

951
00:32:56,399 --> 00:32:59,039
two of these tcc one for user which is

952
00:32:59,039 --> 00:33:01,600
more of course user specific and one for

953
00:33:01,600 --> 00:33:02,960
system level stuff and this is where

954
00:33:02,960 --> 00:33:04,960
you're going to find these policy all

955
00:33:04,960 --> 00:33:07,760
files or give full file system access to

956
00:33:07,760 --> 00:33:09,440
whatever application

957
00:33:09,440 --> 00:33:10,559
so make sure that you're not just

958
00:33:10,559 --> 00:33:12,640
looking at the one database but all the

959
00:33:12,640 --> 00:33:15,679
databases they're called tcc.db across

960
00:33:15,679 --> 00:33:17,600
all the platforms as well

961
00:33:17,600 --> 00:33:20,720
so it's nice got one table that's useful

962
00:33:20,720 --> 00:33:22,559
nice little database

963
00:33:22,559 --> 00:33:23,840
i really appreciate it when these

964
00:33:23,840 --> 00:33:26,399
databases are simple

965
00:33:26,399 --> 00:33:28,000
and then we have this one launch

966
00:33:28,000 --> 00:33:30,240
services quarantine i think we all are

967
00:33:30,240 --> 00:33:31,919
probably pretty familiar with quarantine

968
00:33:31,919 --> 00:33:34,080
in here if i airdrop something if i

969
00:33:34,080 --> 00:33:36,000
download something and that application

970
00:33:36,000 --> 00:33:38,399
or service supports quarantining it gets

971
00:33:38,399 --> 00:33:39,760
an extended attribute there's some

972
00:33:39,760 --> 00:33:42,000
spotlight metadata i launch it it's

973
00:33:42,000 --> 00:33:43,440
going to be checked against the expert

974
00:33:43,440 --> 00:33:45,840
signatures all that good stuff so there

975
00:33:45,840 --> 00:33:47,840
are databases keeping track of some of

976
00:33:47,840 --> 00:33:49,919
this quarantining information certainly

977
00:33:49,919 --> 00:33:52,240
going to be useful in a compromise

978
00:33:52,240 --> 00:33:54,000
so got timestamps

979
00:33:54,000 --> 00:33:55,600
we got the bundle ids associated with

980
00:33:55,600 --> 00:33:57,600
the application quarantining again

981
00:33:57,600 --> 00:33:59,840
what's sharing the

982
00:33:59,840 --> 00:34:02,320
in this case airdrop

983
00:34:02,320 --> 00:34:04,320
so i airdrop something myself so we do

984
00:34:04,320 --> 00:34:05,840
get to see a little bit of external

985
00:34:05,840 --> 00:34:08,239
information i did it you know if

986
00:34:08,239 --> 00:34:09,679
somebody else does it their information

987
00:34:09,679 --> 00:34:12,000
will probably be in here as well uh if i

988
00:34:12,000 --> 00:34:13,119
download something through an

989
00:34:13,119 --> 00:34:14,800
application in this case i have a chrome

990
00:34:14,800 --> 00:34:16,320
one it's going to give me some urls

991
00:34:16,320 --> 00:34:18,239
associated with that where the original

992
00:34:18,239 --> 00:34:21,520
data came from and the referring url

993
00:34:21,520 --> 00:34:23,760
and all these ichat ones

994
00:34:23,760 --> 00:34:26,480
this is simply people sending pictures

995
00:34:26,480 --> 00:34:27,599
to me

996
00:34:27,599 --> 00:34:29,359
so every picture that comes in through

997
00:34:29,359 --> 00:34:31,520
messages does get quarantined and saves

998
00:34:31,520 --> 00:34:33,040
all that information

999
00:34:33,040 --> 00:34:35,679
this event id here this is the one piece

1000
00:34:35,679 --> 00:34:38,480
that i can use to find what file what

1001
00:34:38,480 --> 00:34:39,599
image what

1002
00:34:39,599 --> 00:34:42,399
uh executable was sent to me or got onto

1003
00:34:42,399 --> 00:34:44,639
this device assuming that the quarantine

1004
00:34:44,639 --> 00:34:46,159
extended attribute still has that

1005
00:34:46,159 --> 00:34:47,839
information in there sometimes it

1006
00:34:47,839 --> 00:34:49,839
disappears and you just don't get access

1007
00:34:49,839 --> 00:34:51,760
to that so we can pair that up with

1008
00:34:51,760 --> 00:34:53,760
specific file system based information

1009
00:34:53,760 --> 00:34:56,480
and metadata

1010
00:34:56,800 --> 00:34:58,960
and a few other databases so two more

1011
00:34:58,960 --> 00:35:00,640
and this is in the system policy

1012
00:35:00,640 --> 00:35:02,800
configuration kind of uh deep down to

1013
00:35:02,800 --> 00:35:04,560
the file system here is called exec

1014
00:35:04,560 --> 00:35:05,760
policy

1015
00:35:05,760 --> 00:35:06,800
this one i'm still certainly

1016
00:35:06,800 --> 00:35:09,280
investigating but i see a lot of signing

1017
00:35:09,280 --> 00:35:11,119
information i see applications being

1018
00:35:11,119 --> 00:35:12,880
used in here and the timestamps usually

1019
00:35:12,880 --> 00:35:14,839
map up with the usage of these

1020
00:35:14,839 --> 00:35:16,880
applications whether this bundle is

1021
00:35:16,880 --> 00:35:18,480
signed or not whether it's actually a

1022
00:35:18,480 --> 00:35:20,800
bundle id or not versioning team

1023
00:35:20,800 --> 00:35:23,599
identifiers signing identifiers

1024
00:35:23,599 --> 00:35:26,000
cd hash information this is only the

1025
00:35:26,000 --> 00:35:27,599
first part of the query it's a lot of

1026
00:35:27,599 --> 00:35:29,760
stuff being stored in here

1027
00:35:29,760 --> 00:35:31,040
second piece

1028
00:35:31,040 --> 00:35:34,079
executable hashes those sha-256

1029
00:35:34,079 --> 00:35:36,240
of the executable itself time stamps

1030
00:35:36,240 --> 00:35:37,680
from the executable

1031
00:35:37,680 --> 00:35:41,200
file sizes library is used um

1032
00:35:41,200 --> 00:35:42,960
responsible identifiers basically what

1033
00:35:42,960 --> 00:35:46,079
kind of uh prompted uh to install this

1034
00:35:46,079 --> 00:35:47,520
or use this

1035
00:35:47,520 --> 00:35:50,880
is valid and is quarantined so a lot of

1036
00:35:50,880 --> 00:35:53,040
different executable information being

1037
00:35:53,040 --> 00:35:54,400
stored in here so if you're looking for

1038
00:35:54,400 --> 00:35:56,720
something in particular this could very

1039
00:35:56,720 --> 00:35:59,520
much be a a good one to look at so this

1040
00:35:59,520 --> 00:36:01,680
is exact policy and it's called

1041
00:36:01,680 --> 00:36:03,440
executive measurements version two as

1042
00:36:03,440 --> 00:36:06,480
the table name is called

1043
00:36:06,560 --> 00:36:08,800
next one is exec policy scan same

1044
00:36:08,800 --> 00:36:11,200
database different table this one we're

1045
00:36:11,200 --> 00:36:13,359
going to see some volume information

1046
00:36:13,359 --> 00:36:15,119
what volume

1047
00:36:15,119 --> 00:36:16,960
was this file or executable or a bundle

1048
00:36:16,960 --> 00:36:18,400
being stored on

1049
00:36:18,400 --> 00:36:21,040
most of mine are apfs we can see right

1050
00:36:21,040 --> 00:36:23,040
here with the object id is likely the

1051
00:36:23,040 --> 00:36:24,480
inode number for this particular

1052
00:36:24,480 --> 00:36:26,880
executable and we have a little random

1053
00:36:26,880 --> 00:36:29,680
hfs one here folks are still using hfs

1054
00:36:29,680 --> 00:36:31,119
just

1055
00:36:31,119 --> 00:36:33,760
not completely gone just yet

1056
00:36:33,760 --> 00:36:37,040
so again bundle ids hashes identifiers

1057
00:36:37,040 --> 00:36:38,640
all that good stuff

1058
00:36:38,640 --> 00:36:40,160
but i do want to take a look at this

1059
00:36:40,160 --> 00:36:43,760
malware result one does one mean yes i

1060
00:36:43,760 --> 00:36:44,720
don't know

1061
00:36:44,720 --> 00:36:46,400
pretty sure it's not because otherwise i

1062
00:36:46,400 --> 00:36:49,040
have a lot of malware on my system

1063
00:36:49,040 --> 00:36:51,200
um kind of one of those things like i'm

1064
00:36:51,200 --> 00:36:53,119
sure it's uh you know was it was it

1065
00:36:53,119 --> 00:36:54,720
checked against x-protect or something

1066
00:36:54,720 --> 00:36:56,320
like that i don't know that for sure i'm

1067
00:36:56,320 --> 00:36:58,400
still investigating that but would love

1068
00:36:58,400 --> 00:37:00,320
to hear people's opinions so still

1069
00:37:00,320 --> 00:37:03,440
testing quite a lot of these

1070
00:37:03,440 --> 00:37:06,079
then we have exec policy scan targets

1071
00:37:06,079 --> 00:37:07,440
very similar to kind of what we saw

1072
00:37:07,440 --> 00:37:10,400
before we get the path of the executable

1073
00:37:10,400 --> 00:37:12,240
and the responsible path

1074
00:37:12,240 --> 00:37:13,599
i think this one's particularly

1075
00:37:13,599 --> 00:37:15,839
interesting because if i'm in terminal

1076
00:37:15,839 --> 00:37:17,599
apple terminal and i'm running certain

1077
00:37:17,599 --> 00:37:20,079
things uh so of course i'm running check

1078
00:37:20,079 --> 00:37:21,760
range shout out to the the jailbreakers

1079
00:37:21,760 --> 00:37:24,079
and exploit developers thank you i

1080
00:37:24,079 --> 00:37:26,480
cannot do my job without you doing your

1081
00:37:26,480 --> 00:37:28,880
job so i really really really appreciate

1082
00:37:28,880 --> 00:37:30,240
it

1083
00:37:30,240 --> 00:37:32,560
thank you

1084
00:37:32,720 --> 00:37:35,680
i owe you all a beer just just

1085
00:37:35,680 --> 00:37:37,680
honestly i can't thank you enough i

1086
00:37:37,680 --> 00:37:39,200
would hug you but that would be weird

1087
00:37:39,200 --> 00:37:41,440
and also contaminated

1088
00:37:41,440 --> 00:37:43,280
also i don't really hug and that's not

1089
00:37:43,280 --> 00:37:44,480
what i do

1090
00:37:44,480 --> 00:37:45,599
yeah

1091
00:37:45,599 --> 00:37:47,680
uh so i got check grain here

1092
00:37:47,680 --> 00:37:49,359
executed check green from my uh for

1093
00:37:49,359 --> 00:37:51,520
terminal application another one i have

1094
00:37:51,520 --> 00:37:53,280
here i've got open ssl because i

1095
00:37:53,280 --> 00:37:55,359
installed iproxy live my mobile device i

1096
00:37:55,359 --> 00:37:57,680
use little after research

1097
00:37:57,680 --> 00:37:59,280
a few other ones if i

1098
00:37:59,280 --> 00:38:01,440
download something it goes to my default

1099
00:38:01,440 --> 00:38:03,040
downloads directory i execute it it's

1100
00:38:03,040 --> 00:38:04,640
going to be located in here as well so

1101
00:38:04,640 --> 00:38:06,400
you could see that are the users

1102
00:38:06,400 --> 00:38:07,520
downloading things they shouldn't be

1103
00:38:07,520 --> 00:38:09,040
downloading and executing them just

1104
00:38:09,040 --> 00:38:10,800
being like gatekeeper whatever i don't

1105
00:38:10,800 --> 00:38:13,119
care keep going going going nobody's

1106
00:38:13,119 --> 00:38:15,200
ever done that right

1107
00:38:15,200 --> 00:38:16,880
yeah yeah well we can see that all in

1108
00:38:16,880 --> 00:38:19,200
these databases so i'll see the user

1109
00:38:19,200 --> 00:38:21,440
infecting themselves because that's what

1110
00:38:21,440 --> 00:38:24,000
people do

1111
00:38:24,320 --> 00:38:26,560
all right one more text policy so the

1112
00:38:26,560 --> 00:38:28,079
same directory

1113
00:38:28,079 --> 00:38:30,400
other one was exec policy this means

1114
00:38:30,400 --> 00:38:32,720
text policy maybe this is the last year

1115
00:38:32,720 --> 00:38:33,839
for this one

1116
00:38:33,839 --> 00:38:34,800
don't know

1117
00:38:34,800 --> 00:38:37,119
uh this one's called text load history

1118
00:38:37,119 --> 00:38:38,560
it shows some of the kernel extensions

1119
00:38:38,560 --> 00:38:40,400
that i have loaded not every single one

1120
00:38:40,400 --> 00:38:41,440
of them

1121
00:38:41,440 --> 00:38:43,440
but some of them are in here

1122
00:38:43,440 --> 00:38:45,760
quick shout out to lulu thank you very

1123
00:38:45,760 --> 00:38:46,480
much

1124
00:38:46,480 --> 00:38:47,920
always got all the things running in

1125
00:38:47,920 --> 00:38:50,480
here and then we have one for osx few so

1126
00:38:50,480 --> 00:38:52,480
just to kind of give you an example of

1127
00:38:52,480 --> 00:38:53,599
some of the ones in here so if you're

1128
00:38:53,599 --> 00:38:54,880
thinking you have a malicious kernel

1129
00:38:54,880 --> 00:38:57,200
extension and maybe take a look at this

1130
00:38:57,200 --> 00:38:59,839
particular table

1131
00:38:59,839 --> 00:39:00,960
right

1132
00:39:00,960 --> 00:39:02,240
so i know i only have a couple minutes

1133
00:39:02,240 --> 00:39:04,400
oh i'm over time

1134
00:39:04,400 --> 00:39:07,359
that's fine two minutes uh so why apollo

1135
00:39:07,359 --> 00:39:09,520
i have all these different databases

1136
00:39:09,520 --> 00:39:11,680
i want to put them all together

1137
00:39:11,680 --> 00:39:13,599
so the whole point of it is correlating

1138
00:39:13,599 --> 00:39:16,560
this across different devices so i have

1139
00:39:16,560 --> 00:39:18,560
this little contrived example here i'm

1140
00:39:18,560 --> 00:39:20,160
doing all the assurance research into

1141
00:39:20,160 --> 00:39:21,520
syncs

1142
00:39:21,520 --> 00:39:22,640
not really

1143
00:39:22,640 --> 00:39:25,200
i need a video for a presentation i am

1144
00:39:25,200 --> 00:39:26,960
in the bathroom i'm doing qa on this

1145
00:39:26,960 --> 00:39:29,119
thing got a great one i send it over to

1146
00:39:29,119 --> 00:39:31,520
my mac via airdrop and then i open it

1147
00:39:31,520 --> 00:39:33,760
execute it open it up watch it before

1148
00:39:33,760 --> 00:39:36,000
putting it into my super exciting sync

1149
00:39:36,000 --> 00:39:39,040
qa presentation

1150
00:39:40,960 --> 00:39:42,560
this is a real bathroom that i went to

1151
00:39:42,560 --> 00:39:44,640
down in uh brisbane australia

1152
00:39:44,640 --> 00:39:46,560
if you'll notice that when i turn that

1153
00:39:46,560 --> 00:39:49,759
all the sinks turn on

1154
00:39:51,359 --> 00:39:54,000
oh look i could turn it off

1155
00:39:54,000 --> 00:39:57,839
mysterious ghost sinks

1156
00:39:57,920 --> 00:39:59,599
yeah all right so that's a 20 second

1157
00:39:59,599 --> 00:40:01,200
video

1158
00:40:01,200 --> 00:40:04,240
love it so what do i see when i actually

1159
00:40:04,240 --> 00:40:06,480
correlate all the apollo stuff

1160
00:40:06,480 --> 00:40:08,400
so i'm making it real quick all right

1161
00:40:08,400 --> 00:40:10,400
application usage front most app i'm

1162
00:40:10,400 --> 00:40:12,560
using sublime here so different

1163
00:40:12,560 --> 00:40:14,000
databases will record the same

1164
00:40:14,000 --> 00:40:16,000
information so one's calling coming from

1165
00:40:16,000 --> 00:40:18,079
knowledge c one of these is coming from

1166
00:40:18,079 --> 00:40:19,680
power log

1167
00:40:19,680 --> 00:40:23,119
so doing my sync qa i'm using sublime

1168
00:40:23,119 --> 00:40:24,800
it's because i'm writing apollo modules

1169
00:40:24,800 --> 00:40:26,079
right now

1170
00:40:26,079 --> 00:40:28,480
so notification i want to send that

1171
00:40:28,480 --> 00:40:30,880
video to myself when i do airdrop it

1172
00:40:30,880 --> 00:40:32,560
gives me a notification sarah wants to

1173
00:40:32,560 --> 00:40:34,560
send you this sync video

1174
00:40:34,560 --> 00:40:35,680
cool

1175
00:40:35,680 --> 00:40:38,240
it downloads it gets quarantined because

1176
00:40:38,240 --> 00:40:40,160
airdrop and sharing d supports the

1177
00:40:40,160 --> 00:40:42,000
quarantine functionality so i can see

1178
00:40:42,000 --> 00:40:44,400
that in here as well with sharing d and

1179
00:40:44,400 --> 00:40:46,160
it's from me

1180
00:40:46,160 --> 00:40:47,920
more notifications

1181
00:40:47,920 --> 00:40:49,440
switch to the applications i want to

1182
00:40:49,440 --> 00:40:52,720
play it com apple quicktime player

1183
00:40:52,720 --> 00:40:54,480
uh more app usage there's a lot of app

1184
00:40:54,480 --> 00:40:55,839
usage in here

1185
00:40:55,839 --> 00:40:58,079
we got video ones i didn't go over these

1186
00:40:58,079 --> 00:40:59,680
specifically but there's a lot ones that

1187
00:40:59,680 --> 00:41:01,359
show different video aspects of what's

1188
00:41:01,359 --> 00:41:02,560
being played

1189
00:41:02,560 --> 00:41:04,319
this one's showing me that uh that i'm

1190
00:41:04,319 --> 00:41:06,800
playing one here a few more down here

1191
00:41:06,800 --> 00:41:08,240
this one's showing specifically i'm

1192
00:41:08,240 --> 00:41:10,560
playing it with quicktime player x

1193
00:41:10,560 --> 00:41:12,480
state of zero state of one

1194
00:41:12,480 --> 00:41:14,319
more or less just pressing the play

1195
00:41:14,319 --> 00:41:15,520
button

1196
00:41:15,520 --> 00:41:17,040
and then now playing here these are

1197
00:41:17,040 --> 00:41:18,640
coming from the knowledge c notice that

1198
00:41:18,640 --> 00:41:20,720
the time stamps are the same these two

1199
00:41:20,720 --> 00:41:22,079
entries really actually need to be

1200
00:41:22,079 --> 00:41:23,119
flipped

1201
00:41:23,119 --> 00:41:25,520
uh because i was

1202
00:41:25,520 --> 00:41:27,920
watching this one where is it yeah

1203
00:41:27,920 --> 00:41:30,400
duration here is 19 seconds

1204
00:41:30,400 --> 00:41:32,000
and this is my quick time so this is my

1205
00:41:32,000 --> 00:41:33,359
sync video

1206
00:41:33,359 --> 00:41:34,720
while i was doing this i was listening

1207
00:41:34,720 --> 00:41:37,040
to music before come apple music my

1208
00:41:37,040 --> 00:41:39,119
music application and it switched back

1209
00:41:39,119 --> 00:41:40,720
and forth so i stopped playing apple

1210
00:41:40,720 --> 00:41:42,720
music went to quicktime and then went

1211
00:41:42,720 --> 00:41:43,520
back

1212
00:41:43,520 --> 00:41:46,839
and i was listening to halsey at that

1213
00:41:46,839 --> 00:41:49,440
time and that's that so this is about

1214
00:41:49,440 --> 00:41:51,040
what minute and a half to two minutes

1215
00:41:51,040 --> 00:41:53,119
worth of activity uh you can imagine

1216
00:41:53,119 --> 00:41:55,599
combining all this on a whole system for

1217
00:41:55,599 --> 00:41:56,880
you know

1218
00:41:56,880 --> 00:41:59,280
maybe four mo four months

1219
00:41:59,280 --> 00:42:01,359
four weeks plus some other information

1220
00:42:01,359 --> 00:42:02,640
every database is different you're going

1221
00:42:02,640 --> 00:42:04,160
to get thousands and thousands of

1222
00:42:04,160 --> 00:42:06,079
entries i believe on my max system when

1223
00:42:06,079 --> 00:42:08,720
i ran apollo last it was probably about

1224
00:42:08,720 --> 00:42:11,119
i think it was 200 or 300 000 different

1225
00:42:11,119 --> 00:42:14,240
events which is very small compared to

1226
00:42:14,240 --> 00:42:16,880
ios devices which can be in the millions

1227
00:42:16,880 --> 00:42:18,560
so you really want to target what you're

1228
00:42:18,560 --> 00:42:19,920
looking for maybe you're only looking

1229
00:42:19,920 --> 00:42:22,079
for a specific process id you've got

1230
00:42:22,079 --> 00:42:23,839
some weird things going on there this

1231
00:42:23,839 --> 00:42:25,200
can also help out because you'll find

1232
00:42:25,200 --> 00:42:27,280
that in a lot of places being recorded

1233
00:42:27,280 --> 00:42:29,680
in these different databases

1234
00:42:29,680 --> 00:42:31,119
all right that's it for me

1235
00:42:31,119 --> 00:42:32,319
as usual

1236
00:42:32,319 --> 00:42:34,160
i always go long

1237
00:42:34,160 --> 00:42:34,960
so

1238
00:42:34,960 --> 00:42:36,160
if you want to play around with github

1239
00:42:36,160 --> 00:42:37,520
it's up there the mac stuff is going to

1240
00:42:37,520 --> 00:42:40,000
be hopefully released very soon i also

1241
00:42:40,000 --> 00:42:41,520
have to regress it back to a couple of

1242
00:42:41,520 --> 00:42:42,880
mac versions

1243
00:42:42,880 --> 00:42:44,880
so i have 1015 support now i might go

1244
00:42:44,880 --> 00:42:47,119
back to at least 10 13. if you want to

1245
00:42:47,119 --> 00:42:49,280
write some android or windows modules

1246
00:42:49,280 --> 00:42:50,480
please do

1247
00:42:50,480 --> 00:42:52,480
i am not going to do that i am not that

1248
00:42:52,480 --> 00:42:53,359
person

1249
00:42:53,359 --> 00:42:55,119
but apollo will support all of that as

1250
00:42:55,119 --> 00:42:57,440
long as it's in a sqlite file

1251
00:42:57,440 --> 00:42:59,200
it doesn't really matter i have a few

1252
00:42:59,200 --> 00:43:01,280
more support things like the gzip power

1253
00:43:01,280 --> 00:43:03,359
log archives i have to deal with i want

1254
00:43:03,359 --> 00:43:06,240
to make more modules improve some output

1255
00:43:06,240 --> 00:43:08,079
other than that that's all my contact

1256
00:43:08,079 --> 00:43:09,920
information and i will be doing a demo

1257
00:43:09,920 --> 00:43:11,839
this afternoon so if you want if you

1258
00:43:11,839 --> 00:43:14,160
have a particular scenario i love doing

1259
00:43:14,160 --> 00:43:15,839
that so if i can do it run it and show

1260
00:43:15,839 --> 00:43:17,680
it to you that's the best way that i can

1261
00:43:17,680 --> 00:43:20,000
at least demo uh this particular tool so

1262
00:43:20,000 --> 00:43:21,920
think about it over lunch and get back

1263
00:43:21,920 --> 00:43:24,740
with me so thank you very much

1264
00:43:24,740 --> 00:43:27,959
[Applause]

1265
00:43:36,240 --> 00:43:38,319
you

