1
00:00:00,030 --> 00:00:02,790
next up we have Sarah Sarah is a

2
00:00:02,790 --> 00:00:06,629
well-known forensics expert she works a

3
00:00:06,629 --> 00:00:10,050
lot with the government doing all sorts

4
00:00:10,050 --> 00:00:11,429
of super interesting stuff that she

5
00:00:11,429 --> 00:00:14,040
probably can't talk a lot about I'm very

6
00:00:14,040 --> 00:00:17,100
interested in her talk today so let's

7
00:00:17,100 --> 00:00:20,190
give a round of applause for Sarah

8
00:00:20,190 --> 00:00:29,690
[Applause]

9
00:00:43,240 --> 00:00:49,469
[Music]

10
00:01:12,289 --> 00:01:16,800
all right thank you so I'm thrilled to

11
00:01:16,800 --> 00:01:19,410
be the second speaker at the event I

12
00:01:19,410 --> 00:01:21,420
don't know if that's first loser or what

13
00:01:21,420 --> 00:01:22,950
but I'll take it

14
00:01:22,950 --> 00:01:25,890
so I'm Sara Edwards like Patrick said

15
00:01:25,890 --> 00:01:28,080
I'm a forensics analyst I like to call

16
00:01:28,080 --> 00:01:30,600
myself a forensics nerd I may look sweet

17
00:01:30,600 --> 00:01:32,939
and innocent that's all fake I'm pure

18
00:01:32,939 --> 00:01:36,659
evil actually so by day I do government

19
00:01:36,659 --> 00:01:39,119
contracting for Parsons corporation in

20
00:01:39,119 --> 00:01:41,520
the evening and a bunch of weeks

21
00:01:41,520 --> 00:01:42,720
throughout the year I'm a sans

22
00:01:42,720 --> 00:01:45,570
instructor author of forensics 518 Mac

23
00:01:45,570 --> 00:01:48,060
forensics Mac and iOS forensic analysis

24
00:01:48,060 --> 00:01:50,880
an incident response so pretty much what

25
00:01:50,880 --> 00:01:52,560
that means is I have no free time and I

26
00:01:52,560 --> 00:01:54,360
spend a lot of time on computers mostly

27
00:01:54,360 --> 00:01:58,310
Apple computers but I'm mobile analyst

28
00:01:58,310 --> 00:02:01,049
by day and then anything with a Mac logo

29
00:02:01,049 --> 00:02:04,530
at night so this is my talk it's from

30
00:02:04,530 --> 00:02:06,509
apple seeds to apple pie

31
00:02:06,509 --> 00:02:09,889
it's pretty much a pattern of life talk

32
00:02:09,889 --> 00:02:13,049
so when I'm doing analysis and I'm gonna

33
00:02:13,049 --> 00:02:14,430
go back and forth from Mac to iOS

34
00:02:14,430 --> 00:02:16,739
probably focusing more or less on iOS

35
00:02:16,739 --> 00:02:18,570
because it's so intimate to our personal

36
00:02:18,570 --> 00:02:20,940
lives I am looking for a lot of

37
00:02:20,940 --> 00:02:22,799
different things anything from certain

38
00:02:22,799 --> 00:02:24,840
applications the person uses to a time

39
00:02:24,840 --> 00:02:27,840
frame sometimes device usage battery

40
00:02:27,840 --> 00:02:30,150
level network usage whether it's locked

41
00:02:30,150 --> 00:02:31,410
whether it's unlocked

42
00:02:31,410 --> 00:02:33,660
whether carplay is being used or not you

43
00:02:33,660 --> 00:02:34,860
know really depends on the type of

44
00:02:34,860 --> 00:02:35,819
investigations

45
00:02:35,819 --> 00:02:39,060
so Apple thank you Apple for collecting

46
00:02:39,060 --> 00:02:41,010
an incredible amount of data I frankly

47
00:02:41,010 --> 00:02:42,480
don't know why you're collecting this I

48
00:02:42,480 --> 00:02:44,790
don't care as a forensic analyst because

49
00:02:44,790 --> 00:02:47,480
I'm going to use it to my advantage so

50
00:02:47,480 --> 00:02:49,800
we're gonna be looking at quite a few

51
00:02:49,800 --> 00:02:52,709
different things here so for this

52
00:02:52,709 --> 00:02:56,130
particular talk in the description for

53
00:02:56,130 --> 00:02:57,450
the talk I did not say that I was going

54
00:02:57,450 --> 00:02:58,620
to do a tool release because I honestly

55
00:02:58,620 --> 00:03:01,440
wasn't sure if I was or not but one of

56
00:03:01,440 --> 00:03:03,330
my problems is actually doing the

57
00:03:03,330 --> 00:03:04,950
pattern of life analysis because there

58
00:03:04,950 --> 00:03:07,980
are so many different databases it's so

59
00:03:07,980 --> 00:03:09,420
hard to get to some of these databases

60
00:03:09,420 --> 00:03:10,920
so I'm gonna kind of describe the

61
00:03:10,920 --> 00:03:12,290
problems that I've gone through first

62
00:03:12,290 --> 00:03:15,269
and at the kind of the midway between

63
00:03:15,269 --> 00:03:17,430
the talk I'll show you what I've come up

64
00:03:17,430 --> 00:03:20,550
with a script and a couple modules to

65
00:03:20,550 --> 00:03:21,989
actually automate some of this analysis

66
00:03:21,989 --> 00:03:23,910
because it will take a very long time to

67
00:03:23,910 --> 00:03:26,280
do so the first problem is actually

68
00:03:26,280 --> 00:03:28,230
getting to the data itself especially

69
00:03:28,230 --> 00:03:30,540
with iOS devices these things are pretty

70
00:03:30,540 --> 00:03:31,830
locked down I know we have a few

71
00:03:31,830 --> 00:03:34,019
jailbreakers in here and I thank every

72
00:03:34,019 --> 00:03:35,760
one of you I could not do any of my

73
00:03:35,760 --> 00:03:37,650
research on from a physical level

74
00:03:37,650 --> 00:03:39,900
standpoint of these devices without

75
00:03:39,900 --> 00:03:42,630
those jail breaks so I'm not gonna try

76
00:03:42,630 --> 00:03:45,840
to when II tau and anytime soon but I do

77
00:03:45,840 --> 00:03:53,910
appreciate the jail breaks what's with

78
00:03:53,910 --> 00:04:01,890
the weird aliens I can't actually see

79
00:04:01,890 --> 00:04:07,578
that monitor that's less than useful

80
00:04:11,209 --> 00:04:14,510
computers are hard

81
00:04:27,900 --> 00:04:31,090
okay just flag me because I honestly I

82
00:04:31,090 --> 00:04:32,350
can't see the screen because I'm too

83
00:04:32,350 --> 00:04:35,650
short to view over the podium so I'll

84
00:04:35,650 --> 00:04:37,510
try to peek every once in a while make

85
00:04:37,510 --> 00:04:40,300
sure it's there all right so the first

86
00:04:40,300 --> 00:04:42,880
part is getting access to the data so

87
00:04:42,880 --> 00:04:44,710
I'm going to assume you have full

88
00:04:44,710 --> 00:04:45,850
physical access and I don't mean

89
00:04:45,850 --> 00:04:47,590
physically on the device but you know

90
00:04:47,590 --> 00:04:49,389
however you get on to the device you

91
00:04:49,389 --> 00:04:50,950
have full physical access you can access

92
00:04:50,950 --> 00:04:53,740
any files you want it's not a backup and

93
00:04:53,740 --> 00:04:55,510
I'm talking about you know different

94
00:04:55,510 --> 00:04:57,460
encryption things so bypassing all of

95
00:04:57,460 --> 00:04:59,890
that so I already assume a few steps

96
00:04:59,890 --> 00:05:02,050
into the process from a forensic

97
00:05:02,050 --> 00:05:03,430
standpoint I'm talking about using

98
00:05:03,430 --> 00:05:05,919
jailbreaks and for my data I do what's

99
00:05:05,919 --> 00:05:07,960
called what I kind of term as a physical

100
00:05:07,960 --> 00:05:09,790
logical dump so I'm on the device in the

101
00:05:09,790 --> 00:05:11,979
shell and I'm basically tar bundling all

102
00:05:11,979 --> 00:05:14,919
the files on there other services are

103
00:05:14,919 --> 00:05:16,690
cellebrite case service was pretty

104
00:05:16,690 --> 00:05:19,270
popular and the new hot thing is great

105
00:05:19,270 --> 00:05:22,479
ships great key I notice a huge influx

106
00:05:22,479 --> 00:05:24,729
of investigators and people emailing me

107
00:05:24,729 --> 00:05:27,010
asking me how to look at this physical

108
00:05:27,010 --> 00:05:28,840
access based databases

109
00:05:28,840 --> 00:05:30,479
once that great key came out you know

110
00:05:30,479 --> 00:05:32,890
for a lot of law enforcement it is fair

111
00:05:32,890 --> 00:05:34,960
game now to get access to a lot of these

112
00:05:34,960 --> 00:05:37,300
lovely databases that are usually

113
00:05:37,300 --> 00:05:40,690
protected from the iOS Sandpoint so

114
00:05:40,690 --> 00:05:43,660
great key is a big thing a big good

115
00:05:43,660 --> 00:05:45,669
thing from a forensics perspective maybe

116
00:05:45,669 --> 00:05:47,169
not so much from a personal security

117
00:05:47,169 --> 00:05:50,370
perspective I kind of flipped both hats

118
00:05:50,370 --> 00:05:52,570
so yeah we can talk about that a little

119
00:05:52,570 --> 00:05:55,630
bit later on the next problem is the

120
00:05:55,630 --> 00:05:58,300
amount of data and correlating it all so

121
00:05:58,300 --> 00:05:59,680
what I've gone through and I will talk

122
00:05:59,680 --> 00:06:01,630
about a few few of these databases here

123
00:06:01,630 --> 00:06:02,979
and there are some in more detail some

124
00:06:02,979 --> 00:06:05,229
in less detail but this is just a very

125
00:06:05,229 --> 00:06:07,300
small sampling of all the databases that

126
00:06:07,300 --> 00:06:09,789
are very forensically useful and some of

127
00:06:09,789 --> 00:06:11,979
these can contains thousands millions of

128
00:06:11,979 --> 00:06:14,410
different records some of them contain

129
00:06:14,410 --> 00:06:16,180
hundreds of different tables I'm calling

130
00:06:16,180 --> 00:06:18,970
up power log here which has 250 some

131
00:06:18,970 --> 00:06:21,340
tables all tracking a very specific

132
00:06:21,340 --> 00:06:23,650
thing my new favorite database the

133
00:06:23,650 --> 00:06:25,900
knowledge C database tracking every

134
00:06:25,900 --> 00:06:28,090
single thing that the user opens every

135
00:06:28,090 --> 00:06:30,610
single app every single you know some

136
00:06:30,610 --> 00:06:33,169
little email thing there's a ton of to

137
00:06:33,169 --> 00:06:35,090
and things that is recording so just

138
00:06:35,090 --> 00:06:37,460
extracting all of these different things

139
00:06:37,460 --> 00:06:40,159
and then putting them together is kind

140
00:06:40,159 --> 00:06:41,930
of where I'm going with with this talk

141
00:06:41,930 --> 00:06:44,240
otherwise I'm opening each one of these

142
00:06:44,240 --> 00:06:46,099
in a sequel Lite browser running

143
00:06:46,099 --> 00:06:47,810
separate queries and then using that

144
00:06:47,810 --> 00:06:50,659
information and that is extremely

145
00:06:50,659 --> 00:06:55,999
extremely time intensive so the next

146
00:06:55,999 --> 00:06:58,249
thing is building the queries so it's

147
00:06:58,249 --> 00:06:59,360
great if I already have pre-built

148
00:06:59,360 --> 00:07:01,340
queries I think every forensic analyst

149
00:07:01,340 --> 00:07:03,349
probably has some queries on their

150
00:07:03,349 --> 00:07:05,060
desktop and a text file somewhere that

151
00:07:05,060 --> 00:07:06,830
they use all the time looking for very

152
00:07:06,830 --> 00:07:09,080
specific items in any number of these

153
00:07:09,080 --> 00:07:10,069
different databases

154
00:07:10,069 --> 00:07:12,589
I certainly have plenty of my own I've

155
00:07:12,589 --> 00:07:14,180
released a lot of them either through my

156
00:07:14,180 --> 00:07:16,939
class and through through some github

157
00:07:16,939 --> 00:07:18,949
websites and things like that

158
00:07:18,949 --> 00:07:21,379
but doing the research and doing some of

159
00:07:21,379 --> 00:07:22,639
the correlation between some of these

160
00:07:22,639 --> 00:07:25,749
queries is extremely time time-intensive

161
00:07:25,749 --> 00:07:28,909
some are very clear-cut the table has a

162
00:07:28,909 --> 00:07:31,099
0 it's a 1 it says locked or unlocked

163
00:07:31,099 --> 00:07:33,770
you know that's pretty clear but other

164
00:07:33,770 --> 00:07:35,960
ones you have to correlate across three

165
00:07:35,960 --> 00:07:38,060
four five six different tables to

166
00:07:38,060 --> 00:07:40,069
actually make sense of that data and I'm

167
00:07:40,069 --> 00:07:41,449
going to call out the health database

168
00:07:41,449 --> 00:07:44,509
here because it's pretty can get pretty

169
00:07:44,509 --> 00:07:46,159
complex with the amount of data being

170
00:07:46,159 --> 00:07:48,830
stored in there another problem that

171
00:07:48,830 --> 00:07:50,569
we're having is query validation and

172
00:07:50,569 --> 00:07:52,339
testing so I can test things all day

173
00:07:52,339 --> 00:07:54,379
long but I only have a certain amount of

174
00:07:54,379 --> 00:07:56,270
devices at my disposal and a certain

175
00:07:56,270 --> 00:07:58,669
amount of test data you're going to find

176
00:07:58,669 --> 00:08:03,020
that with different devices older

177
00:08:03,020 --> 00:08:04,879
devices newer devices point releases

178
00:08:04,879 --> 00:08:06,169
things like that that everything's gonna

179
00:08:06,169 --> 00:08:07,819
be a little bit different you know

180
00:08:07,819 --> 00:08:10,370
databases change the schemas certainly

181
00:08:10,370 --> 00:08:12,199
change over time Apple loves to go ahead

182
00:08:12,199 --> 00:08:14,419
and rename some columns so one query

183
00:08:14,419 --> 00:08:16,159
that was working for years all of a

184
00:08:16,159 --> 00:08:17,419
sudden a point release comes out and

185
00:08:17,419 --> 00:08:19,159
boom everything's broken you got to go

186
00:08:19,159 --> 00:08:21,939
figure out what has changed so devices

187
00:08:21,939 --> 00:08:24,759
not necessarily equal as well as

188
00:08:24,759 --> 00:08:27,499
platforms so Mac and iOS while they are

189
00:08:27,499 --> 00:08:29,899
so extremely close together from a

190
00:08:29,899 --> 00:08:31,939
forensics perspective sometimes the

191
00:08:31,939 --> 00:08:33,469
database schemas are completely

192
00:08:33,469 --> 00:08:35,089
different they're very similar but

193
00:08:35,089 --> 00:08:37,899
they're still very different and then

194
00:08:37,899 --> 00:08:40,159
I'd like to just point out some query

195
00:08:40,159 --> 00:08:44,720
sharing so I have created upwards of I

196
00:08:44,720 --> 00:08:46,400
think I'm

197
00:08:46,400 --> 00:08:48,350
about 90 different queries from my

198
00:08:48,350 --> 00:08:51,260
particular script and I'm going to share

199
00:08:51,260 --> 00:08:52,760
all of those I'm still in the middle of

200
00:08:52,760 --> 00:08:55,280
testing some of those but being able to

201
00:08:55,280 --> 00:08:56,510
share some of these queries with the

202
00:08:56,510 --> 00:08:58,790
community is really gonna help different

203
00:08:58,790 --> 00:09:01,040
folks out I've been testing some of that

204
00:09:01,040 --> 00:09:02,720
is also going to be part of the thing so

205
00:09:02,720 --> 00:09:04,040
if a query works for me it's not

206
00:09:04,040 --> 00:09:05,780
necessarily going to work for 10 other

207
00:09:05,780 --> 00:09:07,670
people so we can kind of work together

208
00:09:07,670 --> 00:09:09,410
to make sure that we're pulling out the

209
00:09:09,410 --> 00:09:11,180
right appropriate data and then that

210
00:09:11,180 --> 00:09:12,980
data means what we think it actually

211
00:09:12,980 --> 00:09:14,750
means and this is where the testing and

212
00:09:14,750 --> 00:09:17,990
validation comes into play I also like

213
00:09:17,990 --> 00:09:20,540
to point out that's a Alex for Peugeot

214
00:09:20,540 --> 00:09:23,180
Nene just started to get hub page maybe

215
00:09:23,180 --> 00:09:25,430
a couple weeks ago to share a bunch of

216
00:09:25,430 --> 00:09:26,930
these queries so as soon as I published

217
00:09:26,930 --> 00:09:28,610
my queries I hopefully they'll either be

218
00:09:28,610 --> 00:09:31,160
linked or ported over to his github and

219
00:09:31,160 --> 00:09:32,810
then we as a community can actually use

220
00:09:32,810 --> 00:09:37,730
these things to further our analysis the

221
00:09:37,730 --> 00:09:39,200
next thing that's a problem is

222
00:09:39,200 --> 00:09:40,460
single-use scripts and I've written

223
00:09:40,460 --> 00:09:42,410
plenty of these myself you have a

224
00:09:42,410 --> 00:09:44,660
problem you write a crappy Python script

225
00:09:44,660 --> 00:09:46,670
and it solves it it's not efficient it's

226
00:09:46,670 --> 00:09:49,250
not great sometimes it get updated

227
00:09:49,250 --> 00:09:52,340
sometimes it does not so it's kind of

228
00:09:52,340 --> 00:09:53,690
one of those things where yeah it's

229
00:09:53,690 --> 00:09:55,580
great if it works and if it doesn't and

230
00:09:55,580 --> 00:09:57,790
the analyst doesn't know how to python

231
00:09:57,790 --> 00:10:00,410
program in Python or to fix a variable

232
00:10:00,410 --> 00:10:02,720
or to fix a query or to do this that and

233
00:10:02,720 --> 00:10:04,370
the other thing it's not going to be

234
00:10:04,370 --> 00:10:07,760
exactly helpful to anybody so that's

235
00:10:07,760 --> 00:10:09,890
going to be another issue and I think my

236
00:10:09,890 --> 00:10:12,950
script might solve that issue but I'm

237
00:10:12,950 --> 00:10:14,660
kind of still in the testing phases so

238
00:10:14,660 --> 00:10:16,730
well let's see let's see how this kind

239
00:10:16,730 --> 00:10:20,630
of works out the next problem is we

240
00:10:20,630 --> 00:10:22,010
don't have time for this as forensic

241
00:10:22,010 --> 00:10:24,560
analysts and I'm different I do I'm very

242
00:10:24,560 --> 00:10:26,000
much a research development kind of

243
00:10:26,000 --> 00:10:28,550
forensic analyst which I have a lot of

244
00:10:28,550 --> 00:10:31,220
time to spend on things I know everyone

245
00:10:31,220 --> 00:10:32,870
else that I work with from law

246
00:10:32,870 --> 00:10:36,110
enforcement to government's to your your

247
00:10:36,110 --> 00:10:38,780
your big accounting firms everybody they

248
00:10:38,780 --> 00:10:40,760
have a backlog of devices they can't sit

249
00:10:40,760 --> 00:10:42,890
down there and build a query out that

250
00:10:42,890 --> 00:10:45,320
takes eight hours to correlate and test

251
00:10:45,320 --> 00:10:46,610
and do all this stuff

252
00:10:46,610 --> 00:10:50,690
it is extremely time intensive so if

253
00:10:50,690 --> 00:10:51,830
somebody gets a case and they get a

254
00:10:51,830 --> 00:10:53,840
great key dump they need to find the

255
00:10:53,840 --> 00:10:55,940
last 24 hours worth of locations on

256
00:10:55,940 --> 00:10:57,320
there they're not going to go ahead and

257
00:10:57,320 --> 00:10:59,070
build a query for that but if they can

258
00:10:59,070 --> 00:11:01,470
github website pull it down run it on

259
00:11:01,470 --> 00:11:03,779
that database and get that information

260
00:11:03,779 --> 00:11:05,070
that's already been tested and validated

261
00:11:05,070 --> 00:11:08,339
and whatnot that's going to help them so

262
00:11:08,339 --> 00:11:10,980
speed is a concern and many of these you

263
00:11:10,980 --> 00:11:12,779
know exigent circuits of circumstance

264
00:11:12,779 --> 00:11:16,079
and type cases also analysts they don't

265
00:11:16,079 --> 00:11:17,990
have been necessarily the expertise to

266
00:11:17,990 --> 00:11:20,399
create the sequel queries or create a

267
00:11:20,399 --> 00:11:23,100
Python script or to do any of that you

268
00:11:23,100 --> 00:11:24,329
know they just want to load it up with

269
00:11:24,329 --> 00:11:26,430
in black light or whatever forensic

270
00:11:26,430 --> 00:11:28,589
utility that they want click the buttons

271
00:11:28,589 --> 00:11:31,110
and make things work the problem with a

272
00:11:31,110 --> 00:11:32,610
lot of those forensic suites is that

273
00:11:32,610 --> 00:11:34,319
they don't get into this level of

274
00:11:34,319 --> 00:11:36,569
detailed analysis this is something that

275
00:11:36,569 --> 00:11:38,579
all those commercial products are pretty

276
00:11:38,579 --> 00:11:40,620
much losing so you can click buttons all

277
00:11:40,620 --> 00:11:41,850
day long but it's not going to show you

278
00:11:41,850 --> 00:11:43,500
what you want to do you have to do this

279
00:11:43,500 --> 00:11:46,110
manually and hopefully my script well at

280
00:11:46,110 --> 00:11:48,329
least automate some of that manual

281
00:11:48,329 --> 00:11:50,040
analysis so it can be a little bit

282
00:11:50,040 --> 00:11:53,790
quicker for you and the next problem

283
00:11:53,790 --> 00:11:56,250
time stamps and storage anybody who's

284
00:11:56,250 --> 00:11:57,750
worked with Apple data has probably

285
00:11:57,750 --> 00:12:00,540
experienced these same issues in the

286
00:12:00,540 --> 00:12:02,250
variety of databases that I showed you

287
00:12:02,250 --> 00:12:04,949
before there is a stupid amount of time

288
00:12:04,949 --> 00:12:06,630
stamps time stamps from a forensics

289
00:12:06,630 --> 00:12:09,209
perspective is great I live and die by

290
00:12:09,209 --> 00:12:11,490
time stamps but I also need to trust the

291
00:12:11,490 --> 00:12:13,560
time stamp you'll see a couple of

292
00:12:13,560 --> 00:12:15,060
different storage formats two most

293
00:12:15,060 --> 00:12:18,149
popular UNIX and Mac epoch sometimes

294
00:12:18,149 --> 00:12:20,010
right in the same database right in two

295
00:12:20,010 --> 00:12:21,290
columns right next to each other

296
00:12:21,290 --> 00:12:24,389
consistency not really a thing here and

297
00:12:24,389 --> 00:12:27,540
then timestamps from the future

298
00:12:27,540 --> 00:12:30,209
thank you power log you probably have

299
00:12:30,209 --> 00:12:32,130
seen power log timestamps before and if

300
00:12:32,130 --> 00:12:33,750
you've not looked on the actual device

301
00:12:33,750 --> 00:12:34,860
and tested it

302
00:12:34,860 --> 00:12:36,779
they have been stored in the future

303
00:12:36,779 --> 00:12:38,940
sometimes they are stored in the past so

304
00:12:38,940 --> 00:12:40,319
I'll show you a couple of examples of

305
00:12:40,319 --> 00:12:42,449
that anywhere from 13 seconds in the

306
00:12:42,449 --> 00:12:44,910
past to up to 12 minutes in the future

307
00:12:44,910 --> 00:12:47,279
from a forensics perspective 12 minutes

308
00:12:47,279 --> 00:12:50,160
is huge amount of time you want to be

309
00:12:50,160 --> 00:12:52,290
extremely precise when you're doing some

310
00:12:52,290 --> 00:12:54,449
timeline analysis to determine where a

311
00:12:54,449 --> 00:12:56,399
user was you can get a pretty far

312
00:12:56,399 --> 00:12:59,790
distance within 12 minutes or so so that

313
00:12:59,790 --> 00:13:01,110
is something that I had to figure out

314
00:13:01,110 --> 00:13:02,430
it's something that I'm still currently

315
00:13:02,430 --> 00:13:06,149
testing and power log is the main main

316
00:13:06,149 --> 00:13:08,250
offender of that future time stamp thing

317
00:13:08,250 --> 00:13:10,079
and then we have different databases

318
00:13:10,079 --> 00:13:12,259
like the aggregate dictionary ins

319
00:13:12,259 --> 00:13:14,119
other ones that store time stamps on a

320
00:13:14,119 --> 00:13:16,069
weird way either they're collecting data

321
00:13:16,069 --> 00:13:18,109
for an hour so you have a per day a per

322
00:13:18,109 --> 00:13:20,049
hour kind of thing or it's just

323
00:13:20,049 --> 00:13:23,239
aggregating data on a per day basis like

324
00:13:23,239 --> 00:13:25,609
the aggregation dictionary a database so

325
00:13:25,609 --> 00:13:27,169
time stamps are great but they're just

326
00:13:27,169 --> 00:13:28,850
not as granular as they think they are

327
00:13:28,850 --> 00:13:31,009
because they aren't being used in that

328
00:13:31,009 --> 00:13:33,709
type of format and then we have data

329
00:13:33,709 --> 00:13:35,689
storage so every database is going to be

330
00:13:35,689 --> 00:13:36,649
a little bit different

331
00:13:36,649 --> 00:13:38,269
there's embedded blobs there's blobs

332
00:13:38,269 --> 00:13:41,209
everywhere usually blobs are full of

333
00:13:41,209 --> 00:13:45,379
just undocumented data formats so we can

334
00:13:45,379 --> 00:13:47,419
kind of work our best to do that Apple

335
00:13:47,419 --> 00:13:49,189
is not the best at documenting those

336
00:13:49,189 --> 00:13:51,919
formats unfortunately we'll see that in

337
00:13:51,919 --> 00:13:54,439
a little bit of the location data we

338
00:13:54,439 --> 00:13:55,999
also get a bunch of embedded p lists

339
00:13:55,999 --> 00:13:58,009
sometimes peel is embedded with more P

340
00:13:58,009 --> 00:13:59,329
less than better with more P less

341
00:13:59,329 --> 00:14:01,549
embedded with more P lists Thank You

342
00:14:01,549 --> 00:14:03,739
Apple that makes the forensic analyst

343
00:14:03,739 --> 00:14:05,569
absolutely crazy because you have to

344
00:14:05,569 --> 00:14:08,059
keep parsing parsing parsing to get down

345
00:14:08,059 --> 00:14:10,489
to that particular data and then we get

346
00:14:10,489 --> 00:14:12,049
into weird things like the power log has

347
00:14:12,049 --> 00:14:14,059
gzipped archive files you'll have to

348
00:14:14,059 --> 00:14:16,339
unpack some of those too to take a look

349
00:14:16,339 --> 00:14:19,069
at and then just generally aggregated

350
00:14:19,069 --> 00:14:19,519
data

351
00:14:19,519 --> 00:14:21,350
it's weird format it's not on a per

352
00:14:21,350 --> 00:14:25,129
record Perl per timestamp kind of thing

353
00:14:25,129 --> 00:14:30,559
so just strangely store data and then

354
00:14:30,559 --> 00:14:32,529
finally the next problem is the unknown

355
00:14:32,529 --> 00:14:35,569
half the time it's data retention so

356
00:14:35,569 --> 00:14:37,519
some of these are stored for 24 hours

357
00:14:37,519 --> 00:14:38,899
sometimes they're stored for 2 weeks

358
00:14:38,899 --> 00:14:40,100
sometimes they're stored for

359
00:14:40,100 --> 00:14:43,999
indefinitely so I always like to say for

360
00:14:43,999 --> 00:14:45,619
a forensic analysis get to that device

361
00:14:45,619 --> 00:14:47,209
get to that dump as soon as humanly

362
00:14:47,209 --> 00:14:49,279
possible otherwise that date is going to

363
00:14:49,279 --> 00:14:51,470
be flushed out of the system if you need

364
00:14:51,470 --> 00:14:53,929
that last 24 hours of location data you

365
00:14:53,929 --> 00:14:55,939
have to get to that within that 24 hour

366
00:14:55,939 --> 00:14:57,859
time span otherwise it's going to be

367
00:14:57,859 --> 00:15:01,399
lost and gone forever so it's really

368
00:15:01,399 --> 00:15:03,230
dependent on the type of data and which

369
00:15:03,230 --> 00:15:06,199
database that you're looking at another

370
00:15:06,199 --> 00:15:07,939
unknown thing is columns

371
00:15:07,939 --> 00:15:10,249
sometimes you see columns in there and

372
00:15:10,249 --> 00:15:12,289
you think they might you might know what

373
00:15:12,289 --> 00:15:16,549
they mean a 0 is false or no but

374
00:15:16,549 --> 00:15:17,809
sometimes in the world of Apple is

375
00:15:17,809 --> 00:15:20,389
opposite or sometimes you'll see a 0 and

376
00:15:20,389 --> 00:15:23,269
a 4 what happened to two and three don't

377
00:15:23,269 --> 00:15:24,919
know but Apple pulls that crap

378
00:15:24,919 --> 00:15:26,569
all the time

379
00:15:26,569 --> 00:15:28,730
just one of those things to be aware of

380
00:15:28,730 --> 00:15:30,499
so this is we're testing on a live

381
00:15:30,499 --> 00:15:32,180
device comes into play you can sanity

382
00:15:32,180 --> 00:15:33,649
check yourself because I click this box

383
00:15:33,649 --> 00:15:36,079
it shows up like this in the database so

384
00:15:36,079 --> 00:15:37,579
different flags will certainly mean

385
00:15:37,579 --> 00:15:39,259
different things and it's not exactly

386
00:15:39,259 --> 00:15:42,589
the most logical and then finally be

387
00:15:42,589 --> 00:15:44,779
units a measure again different

388
00:15:44,779 --> 00:15:47,269
databases is it seconds is it bytes is

389
00:15:47,269 --> 00:15:49,839
it miles as it meters is a kilometers

390
00:15:49,839 --> 00:15:51,889
sometimes I don't even know what their

391
00:15:51,889 --> 00:15:53,990
their their actual unit of measure is

392
00:15:53,990 --> 00:15:56,480
sometimes it calls it out sometimes it

393
00:15:56,480 --> 00:15:59,029
doesn't and then half the time I don't

394
00:15:59,029 --> 00:16:02,180
know what Apple is doing I try to

395
00:16:02,180 --> 00:16:04,339
explain what Apple is doing and I can't

396
00:16:04,339 --> 00:16:06,079
I don't know why they're collecting it I

397
00:16:06,079 --> 00:16:07,519
don't know what's being used for why are

398
00:16:07,519 --> 00:16:08,930
these time stamps stored in the future

399
00:16:08,930 --> 00:16:11,389
makes no sense to me is it's a tracking

400
00:16:11,389 --> 00:16:13,639
database but I still love you and thank

401
00:16:13,639 --> 00:16:15,139
you for tracking and doing all the

402
00:16:15,139 --> 00:16:16,999
things that you're doing so forensics

403
00:16:16,999 --> 00:16:21,439
people we do love Apple so a couple of

404
00:16:21,439 --> 00:16:23,180
examples of what I go through on a

405
00:16:23,180 --> 00:16:25,879
fairly daily basis I bring up a database

406
00:16:25,879 --> 00:16:28,339
I run a query and I get outputted data

407
00:16:28,339 --> 00:16:30,920
so a few examples I'm gonna go through

408
00:16:30,920 --> 00:16:31,970
in a variety of these different

409
00:16:31,970 --> 00:16:36,290
databases so first one is location

410
00:16:36,290 --> 00:16:37,999
I like being creepy I like stalking

411
00:16:37,999 --> 00:16:40,519
people through their location it's very

412
00:16:40,519 --> 00:16:43,100
useful and Apple does a ton of location

413
00:16:43,100 --> 00:16:46,189
tracking to various levels so we can get

414
00:16:46,189 --> 00:16:47,689
into a lot of those different databases

415
00:16:47,689 --> 00:16:50,959
so the newest one is came out with iOS

416
00:16:50,959 --> 00:16:53,329
11 called significant locations you can

417
00:16:53,329 --> 00:16:55,819
actually look at it in your on your

418
00:16:55,819 --> 00:16:57,860
phone in your um your locate location

419
00:16:57,860 --> 00:16:59,509
services settings and if you've never

420
00:16:59,509 --> 00:17:01,339
done so I highly recommend doing it

421
00:17:01,339 --> 00:17:04,159
because it's extremely creepy so of

422
00:17:04,159 --> 00:17:05,630
course that all of that has to be stored

423
00:17:05,630 --> 00:17:07,789
in a database somewhere so significant

424
00:17:07,789 --> 00:17:09,648
locations has a set of three different

425
00:17:09,648 --> 00:17:12,619
databases and it's stored amongst those

426
00:17:12,619 --> 00:17:14,809
so it's got the cloud that's equal light

427
00:17:14,809 --> 00:17:16,309
local that's equal light and this one

428
00:17:16,309 --> 00:17:18,829
which is cached a sequel light so this

429
00:17:18,829 --> 00:17:20,720
cached our sequel Lite is storing the

430
00:17:20,720 --> 00:17:23,059
most granular of all the location data

431
00:17:23,059 --> 00:17:25,220
that I have found so far so in my

432
00:17:25,220 --> 00:17:26,720
testing I have seen this one to be

433
00:17:26,720 --> 00:17:28,610
storing about seven days one week worth

434
00:17:28,610 --> 00:17:31,640
of extremely granular data that is very

435
00:17:31,640 --> 00:17:33,649
useful from a forensics perspective as

436
00:17:33,649 --> 00:17:35,690
long as I can get to this data within

437
00:17:35,690 --> 00:17:37,850
that seven days so I have a query here

438
00:17:37,850 --> 00:17:38,750
and I've

439
00:17:38,750 --> 00:17:41,090
doing some of these some of these pieces

440
00:17:41,090 --> 00:17:43,190
out at my time stamp again very

441
00:17:43,190 --> 00:17:46,280
important coordinates I've nice made it

442
00:17:46,280 --> 00:17:47,480
nice so you can copy and paste it into

443
00:17:47,480 --> 00:17:50,420
Google Maps altitude course speed all

444
00:17:50,420 --> 00:17:52,280
that good stuff so I can actually see if

445
00:17:52,280 --> 00:17:54,200
I'm moving or not through here as well

446
00:17:54,200 --> 00:17:56,570
or if I'm just statically standing in

447
00:17:56,570 --> 00:17:59,840
place so for this one I am missus all my

448
00:17:59,840 --> 00:18:02,300
own data so I know my own data pretty

449
00:18:02,300 --> 00:18:04,340
well so I try to use it as examples as

450
00:18:04,340 --> 00:18:07,040
best as I can for this particular output

451
00:18:07,040 --> 00:18:09,950
I got about 40,000 data points for about

452
00:18:09,950 --> 00:18:11,990
a week's worth of location data that's

453
00:18:11,990 --> 00:18:13,520
creepy

454
00:18:13,520 --> 00:18:15,590
that is a lot of stuff so of course

455
00:18:15,590 --> 00:18:17,240
Apple is collecting this so it can help

456
00:18:17,240 --> 00:18:19,160
you determine are you going to work you

457
00:18:19,160 --> 00:18:19,880
going home

458
00:18:19,880 --> 00:18:22,730
traffic all that good stuff and it is

459
00:18:22,730 --> 00:18:26,270
being saved on the device I love that

460
00:18:26,270 --> 00:18:29,030
database another one which is kind of

461
00:18:29,030 --> 00:18:30,920
odd is parking history at least that's

462
00:18:30,920 --> 00:18:32,540
kind of what I've come up coming up with

463
00:18:32,540 --> 00:18:35,090
on this one this one's stored in the

464
00:18:35,090 --> 00:18:36,470
local sequel light this one's kept for

465
00:18:36,470 --> 00:18:38,780
about three months or so so it's trying

466
00:18:38,780 --> 00:18:40,700
to determine where you last park so if

467
00:18:40,700 --> 00:18:42,020
you forget where you parked your car in

468
00:18:42,020 --> 00:18:44,240
a big mall or something like that you

469
00:18:44,240 --> 00:18:46,100
can go find it so it's actually storing

470
00:18:46,100 --> 00:18:48,530
it historically which not entirely sure

471
00:18:48,530 --> 00:18:50,660
why but I'm sure they have a great

472
00:18:50,660 --> 00:18:52,970
reason to do that so I can figure out

473
00:18:52,970 --> 00:18:54,440
where I parked my car three months ago

474
00:18:54,440 --> 00:18:59,690
if I truly needed that information next

475
00:18:59,690 --> 00:19:02,390
one is more significant locations this

476
00:19:02,390 --> 00:19:04,220
one is being more kind of called out

477
00:19:04,220 --> 00:19:07,700
from a user standpoint so significant

478
00:19:07,700 --> 00:19:09,110
locations if you're looking through that

479
00:19:09,110 --> 00:19:11,990
list it's gonna try to put a human name

480
00:19:11,990 --> 00:19:14,420
to a particular location a local

481
00:19:14,420 --> 00:19:16,640
business a street things like that so a

482
00:19:16,640 --> 00:19:18,140
lot of that type of information is gonna

483
00:19:18,140 --> 00:19:20,660
be stored in this cloud dot sequel light

484
00:19:20,660 --> 00:19:23,690
so I have a few examples here got

485
00:19:23,690 --> 00:19:26,150
inbound outbound kind of traffic up so

486
00:19:26,150 --> 00:19:27,230
you can see when you're going into the

487
00:19:27,230 --> 00:19:28,670
location when you're when you're exiting

488
00:19:28,670 --> 00:19:31,790
the location and this particular example

489
00:19:31,790 --> 00:19:33,980
is actually one query it's just very

490
00:19:33,980 --> 00:19:35,630
long so I had to screenshot it and put

491
00:19:35,630 --> 00:19:38,210
it into two different screenshots so I

492
00:19:38,210 --> 00:19:40,160
have inbound I have the coordinates the

493
00:19:40,160 --> 00:19:42,170
place ID and the data points so every

494
00:19:42,170 --> 00:19:44,480
place has an ID associated with it so

495
00:19:44,480 --> 00:19:46,520
you know actually the first one is my

496
00:19:46,520 --> 00:19:48,380
house the second one is where I work and

497
00:19:48,380 --> 00:19:50,300
so on so forth so I have you know over

498
00:19:50,300 --> 00:19:51,820
200 different

499
00:19:51,820 --> 00:19:54,789
data plays or data locations place IDs

500
00:19:54,789 --> 00:19:57,580
on my particular device and the data

501
00:19:57,580 --> 00:19:59,769
point count is how many times has it

502
00:19:59,769 --> 00:20:01,960
seen it so the more popular it kind of

503
00:20:01,960 --> 00:20:04,029
gets shifted up the list a little bit in

504
00:20:04,029 --> 00:20:07,960
there so visits incoming outgoing it's

505
00:20:07,960 --> 00:20:09,970
also showing you what's recording that

506
00:20:09,970 --> 00:20:11,979
information so I have it this this is

507
00:20:11,979 --> 00:20:14,409
all data from my iPhone 10 you can see

508
00:20:14,409 --> 00:20:16,269
that the device class the device model

509
00:20:16,269 --> 00:20:19,059
when it learned of this location and all

510
00:20:19,059 --> 00:20:21,129
these different time stamps I can use to

511
00:20:21,129 --> 00:20:22,989
start correlating when a user was at a

512
00:20:22,989 --> 00:20:25,450
certain location it's not perfect but

513
00:20:25,450 --> 00:20:27,789
this particular database actually goes

514
00:20:27,789 --> 00:20:31,720
back quite a few months so I think when

515
00:20:31,720 --> 00:20:33,580
I last look at this I can see about the

516
00:20:33,580 --> 00:20:35,739
last eight months or so of different

517
00:20:35,739 --> 00:20:37,389
locations now it's not every single

518
00:20:37,389 --> 00:20:39,970
location I was but it's the significant

519
00:20:39,970 --> 00:20:42,489
locations so places that I've traveled

520
00:20:42,489 --> 00:20:45,519
to quite a bit now another thing I want

521
00:20:45,519 --> 00:20:47,919
to mention is that data blog so the

522
00:20:47,919 --> 00:20:49,779
place name blob and the place geo blob

523
00:20:49,779 --> 00:20:51,700
place name blob actually give you that

524
00:20:51,700 --> 00:20:54,220
human name this is an example when I was

525
00:20:54,220 --> 00:20:57,009
down in Virginia Beach taking one of the

526
00:20:57,009 --> 00:20:59,019
sands classes so we have these kind of

527
00:20:59,019 --> 00:21:00,789
proprietary blobs and they're a little

528
00:21:00,789 --> 00:21:02,499
hard to parse out from a sequel query

529
00:21:02,499 --> 00:21:05,259
perspective so my script actually will

530
00:21:05,259 --> 00:21:06,700
fail on a lot of this stuff and I

531
00:21:06,700 --> 00:21:08,799
actually output it into a hex blob so I

532
00:21:08,799 --> 00:21:11,139
can throw it into a hex editor if need

533
00:21:11,139 --> 00:21:13,570
be now the place geo blob it's actually

534
00:21:13,570 --> 00:21:14,889
very large so I'm not going to show you

535
00:21:14,889 --> 00:21:16,599
an example of this but you're gonna see

536
00:21:16,599 --> 00:21:19,090
the reverse geo location information for

537
00:21:19,090 --> 00:21:20,889
that particular area all the Yelp

538
00:21:20,889 --> 00:21:23,769
reviews mapping information and all that

539
00:21:23,769 --> 00:21:25,330
stuff so I can certainly show you some

540
00:21:25,330 --> 00:21:27,070
examples a little bit later on if you

541
00:21:27,070 --> 00:21:29,070
come talk to me during the conference

542
00:21:29,070 --> 00:21:31,539
but I can only fit so much on a

543
00:21:31,539 --> 00:21:39,700
particular screenshot so the next one I

544
00:21:39,700 --> 00:21:42,190
want to talk about is not location but

545
00:21:42,190 --> 00:21:44,019
application usage so it's really

546
00:21:44,019 --> 00:21:45,849
important to me on a especially an

547
00:21:45,849 --> 00:21:48,429
iPhone device what applications are

548
00:21:48,429 --> 00:21:50,529
being used and when and the knowledge

549
00:21:50,529 --> 00:21:52,599
see database is actually really useful

550
00:21:52,599 --> 00:21:54,460
for this again it's one of my favorite

551
00:21:54,460 --> 00:21:56,979
databases my new favorite database yes

552
00:21:56,979 --> 00:21:59,739
that's a thing that I do it's weird but

553
00:21:59,739 --> 00:22:01,450
I'm a forensics nerd what can I say

554
00:22:01,450 --> 00:22:04,460
so knowledge cdb is storing every

555
00:22:04,460 --> 00:22:06,770
the app that I used for the last four

556
00:22:06,770 --> 00:22:09,230
weeks every single thing that came on to

557
00:22:09,230 --> 00:22:11,450
that screen it's storing the bundle ID

558
00:22:11,450 --> 00:22:13,670
information it's actually keeping the

559
00:22:13,670 --> 00:22:16,070
day of the week and the GMT offset so I

560
00:22:16,070 --> 00:22:17,660
can actually see some locational

561
00:22:17,660 --> 00:22:19,250
information here different time zones

562
00:22:19,250 --> 00:22:21,440
being traveled and they start and end

563
00:22:21,440 --> 00:22:23,210
time and I did a little calculation to

564
00:22:23,210 --> 00:22:25,250
determine how long I was using that for

565
00:22:25,250 --> 00:22:28,550
so this is extremely granular data you

566
00:22:28,550 --> 00:22:30,440
know can you remember what application

567
00:22:30,440 --> 00:22:32,540
you used three and a half weeks ago at

568
00:22:32,540 --> 00:22:36,230
noon no I can tell you because I could

569
00:22:36,230 --> 00:22:38,300
just have to run this query so pretty

570
00:22:38,300 --> 00:22:39,920
useful information and I can just

571
00:22:39,920 --> 00:22:41,930
timeline this and get a good idea of how

572
00:22:41,930 --> 00:22:43,730
the user is using that device what

573
00:22:43,730 --> 00:22:44,990
applications are they using the most

574
00:22:44,990 --> 00:22:47,030
often do they check Twitter in the

575
00:22:47,030 --> 00:22:48,920
morning Facebook at night you know I can

576
00:22:48,920 --> 00:22:51,290
run pattern analysis all day long on

577
00:22:51,290 --> 00:22:54,980
this type of data for me and I think it

578
00:22:54,980 --> 00:22:57,020
probably shows it here yeah the 489

579
00:22:57,020 --> 00:22:59,270
seconds of course that's Twitter I'm on

580
00:22:59,270 --> 00:23:01,610
Twitter all day long and my data

581
00:23:01,610 --> 00:23:05,900
actually shows that so another one is in

582
00:23:05,900 --> 00:23:07,550
the power log so it's actually kind of

583
00:23:07,550 --> 00:23:09,320
amazing to me to see redundant data

584
00:23:09,320 --> 00:23:11,750
being stored in multiple places not

585
00:23:11,750 --> 00:23:13,070
gonna complain though more data is

586
00:23:13,070 --> 00:23:15,830
better I can filter it out so it's very

587
00:23:15,830 --> 00:23:17,450
similar but it's not being stored as

588
00:23:17,450 --> 00:23:20,300
long for current power log the app usage

589
00:23:20,300 --> 00:23:22,310
is being stored for about three days or

590
00:23:22,310 --> 00:23:25,300
so from what I've seen in my particular

591
00:23:25,300 --> 00:23:28,190
data set so this is where those

592
00:23:28,190 --> 00:23:30,980
timestamps get really funky so there's a

593
00:23:30,980 --> 00:23:34,370
time offset table in the power log one

594
00:23:34,370 --> 00:23:36,920
of the 250 tables within the power log

595
00:23:36,920 --> 00:23:40,190
pl/sql database so I've taken a query

596
00:23:40,190 --> 00:23:42,130
I'm still testing to make sure it works

597
00:23:42,130 --> 00:23:44,630
but I'm basically saying hey I have this

598
00:23:44,630 --> 00:23:46,430
set of timestamps I have these offsets

599
00:23:46,430 --> 00:23:48,500
and kind of marrying them up to make it

600
00:23:48,500 --> 00:23:50,660
a more realistic time frame because like

601
00:23:50,660 --> 00:23:53,270
I said before 13 seconds okay maybe

602
00:23:53,270 --> 00:23:56,510
whatever 13 seconds but 12 minutes on

603
00:23:56,510 --> 00:23:58,490
some of my other older phones that's

604
00:23:58,490 --> 00:24:00,770
gonna be really significant from a you

605
00:24:00,770 --> 00:24:02,030
know a Criminal Investigation

606
00:24:02,030 --> 00:24:04,070
perspective 12 minutes is a extremely

607
00:24:04,070 --> 00:24:06,590
long time so I want to make sure that I

608
00:24:06,590 --> 00:24:09,080
deal with those offsets in there and

609
00:24:09,080 --> 00:24:10,340
this will you'll see in a few different

610
00:24:10,340 --> 00:24:13,250
different power log table examples so I

611
00:24:13,250 --> 00:24:15,650
got the bundle ID I pull out a few other

612
00:24:15,650 --> 00:24:17,840
different things like the orientation

613
00:24:17,840 --> 00:24:20,690
orientation of one is portrait and four

614
00:24:20,690 --> 00:24:24,340
is landscape what's two and three I

615
00:24:24,340 --> 00:24:27,429
don't know I have absolutely no idea

616
00:24:27,429 --> 00:24:29,720
some of these other things I just don't

617
00:24:29,720 --> 00:24:31,190
know what they mean but I've extracted

618
00:24:31,190 --> 00:24:33,110
them anyway just in case maybe the data

619
00:24:33,110 --> 00:24:36,470
can tell me what these things mean so I

620
00:24:36,470 --> 00:24:38,630
have some adjusted timestamps and the

621
00:24:38,630 --> 00:24:43,250
originals in there as well now apps

622
00:24:43,250 --> 00:24:46,100
being used this one's going to be a

623
00:24:46,100 --> 00:24:47,299
little bit different just another

624
00:24:47,299 --> 00:24:50,240
example of the previous screenshot but

625
00:24:50,240 --> 00:24:51,950
instead if you look at the orientation

626
00:24:51,950 --> 00:24:53,990
column so the first one starts off at a

627
00:24:53,990 --> 00:24:56,029
one socom Apple lock screen that's

628
00:24:56,029 --> 00:24:57,890
obviously the lock screen and then it

629
00:24:57,890 --> 00:25:00,529
just starts doing nulls where would I

630
00:25:00,529 --> 00:25:04,789
not be using the screen if you take a

631
00:25:04,789 --> 00:25:06,679
look at some of the the different bundle

632
00:25:06,679 --> 00:25:07,399
IDs in there

633
00:25:07,399 --> 00:25:10,010
springboard homescreen music com apple

634
00:25:10,010 --> 00:25:10,610
carplay

635
00:25:10,610 --> 00:25:13,130
Oh am I've plugged it into my car and

636
00:25:13,130 --> 00:25:15,590
now I'm using car play so it's a nice

637
00:25:15,590 --> 00:25:17,690
little indicator that I can tell was the

638
00:25:17,690 --> 00:25:20,120
user using this as the actual device or

639
00:25:20,120 --> 00:25:22,220
were they using it through their car so

640
00:25:22,220 --> 00:25:24,380
I get I've I've gotten a few people

641
00:25:24,380 --> 00:25:26,080
since I published my knowledge see

642
00:25:26,080 --> 00:25:29,809
database blog that are doing accident

643
00:25:29,809 --> 00:25:31,220
reconstruction so they want to see if

644
00:25:31,220 --> 00:25:33,049
this was a distracted driver they can go

645
00:25:33,049 --> 00:25:34,730
to the knowledge C database and see if

646
00:25:34,730 --> 00:25:37,029
they were doing you know Facebook stuff

647
00:25:37,029 --> 00:25:39,110
you know while there while they're in

648
00:25:39,110 --> 00:25:41,330
their car you layer that location and

649
00:25:41,330 --> 00:25:42,770
stuff on top of it they can see if they

650
00:25:42,770 --> 00:25:45,200
were moving or not so I've had a lot of

651
00:25:45,200 --> 00:25:46,340
folks say thank you for that because

652
00:25:46,340 --> 00:25:47,870
they were able to say yeah this person

653
00:25:47,870 --> 00:25:49,340
was distracted or they were tweeting or

654
00:25:49,340 --> 00:25:50,899
they were doing something inappropriate

655
00:25:50,899 --> 00:25:52,940
while they were driving and the data is

656
00:25:52,940 --> 00:25:57,409
basically leading them to this so the

657
00:25:57,409 --> 00:25:59,690
next one is health data I like to show

658
00:25:59,690 --> 00:26:01,159
this one again this is my own personal

659
00:26:01,159 --> 00:26:05,179
data so I can track heart rate why would

660
00:26:05,179 --> 00:26:07,700
I want to track heart rate well it can

661
00:26:07,700 --> 00:26:09,799
get again really creepy but I want to

662
00:26:09,799 --> 00:26:13,520
see if they're exerting some energy

663
00:26:13,520 --> 00:26:15,830
let's say so I did a talk at the de sans

664
00:26:15,830 --> 00:26:17,630
d4 summit all about the health database

665
00:26:17,630 --> 00:26:20,510
we had one testing example where my

666
00:26:20,510 --> 00:26:23,210
colleague Heather mahalik actually drug

667
00:26:23,210 --> 00:26:25,490
dragged a body across her lawn it was

668
00:26:25,490 --> 00:26:27,500
her husband her husband's a pretty big

669
00:26:27,500 --> 00:26:28,789
guy she actually got physically hurt

670
00:26:28,789 --> 00:26:30,190
during this

671
00:26:30,190 --> 00:26:33,250
all for science but she could see her

672
00:26:33,250 --> 00:26:35,019
heart rate go up well but she was

673
00:26:35,019 --> 00:26:36,429
dragging it so this you know can come

674
00:26:36,429 --> 00:26:37,929
into play some criminal circumstances

675
00:26:37,929 --> 00:26:39,460
where you know something bad is

676
00:26:39,460 --> 00:26:41,429
happening or if the heart rate goes down

677
00:26:41,429 --> 00:26:44,190
to zero what does that mean

678
00:26:44,190 --> 00:26:47,980
you kicked it right so you can kind of

679
00:26:47,980 --> 00:26:50,169
see the different differences in there

680
00:26:50,169 --> 00:26:53,409
so I have an example of my data here for

681
00:26:53,409 --> 00:26:55,990
a very small time stamp time frame that

682
00:26:55,990 --> 00:26:58,600
original quality was my heart rate at

683
00:26:58,600 --> 00:27:00,039
the time and you see it's in the high

684
00:27:00,039 --> 00:27:03,009
180s this is I'm doing Orangetheory I

685
00:27:03,009 --> 00:27:04,029
love my Orangetheory

686
00:27:04,029 --> 00:27:06,429
this is at the end of class basically

687
00:27:06,429 --> 00:27:08,169
running full-out on a treadmill I feel

688
00:27:08,169 --> 00:27:10,690
like I'm going to die at this point so

689
00:27:10,690 --> 00:27:12,509
this is not my heart resting heart rate

690
00:27:12,509 --> 00:27:14,590
this is me about to fall off the

691
00:27:14,590 --> 00:27:16,120
treadmill because I'm not gonna pass out

692
00:27:16,120 --> 00:27:18,940
really soon so just a good example of

693
00:27:18,940 --> 00:27:20,559
that and then you can if you correlate

694
00:27:20,559 --> 00:27:22,870
this over the hour so you can see it

695
00:27:22,870 --> 00:27:24,669
raised and then go back down and it's

696
00:27:24,669 --> 00:27:26,679
actually pretty accurate especially

697
00:27:26,679 --> 00:27:28,480
accurate if you have the Apple watch of

698
00:27:28,480 --> 00:27:31,120
course you know the the phone of course

699
00:27:31,120 --> 00:27:33,029
could not track heart rate so much

700
00:27:33,029 --> 00:27:36,340
because when you turn on a workout on

701
00:27:36,340 --> 00:27:38,289
your watch it's actually doing more

702
00:27:38,289 --> 00:27:44,350
heartrate what's it called say that

703
00:27:44,350 --> 00:27:44,679
again

704
00:27:44,679 --> 00:27:46,629
yeah it turns the scanner on so you get

705
00:27:46,629 --> 00:27:48,429
the the green blinky light it's doing

706
00:27:48,429 --> 00:27:51,279
more sampling so a normal day no workout

707
00:27:51,279 --> 00:27:53,440
it maybe does a sample every minute or

708
00:27:53,440 --> 00:27:55,690
so while during the workout it's about

709
00:27:55,690 --> 00:27:57,429
every second or so so you get a quite a

710
00:27:57,429 --> 00:28:01,289
bit more data during that workout space

711
00:28:01,289 --> 00:28:04,240
next thing is just steps and distance so

712
00:28:04,240 --> 00:28:06,220
if I'm not wearing a workout I just want

713
00:28:06,220 --> 00:28:07,840
to see if they're walking or if they're

714
00:28:07,840 --> 00:28:09,730
running or if they're traveling between

715
00:28:09,730 --> 00:28:11,830
different places and I have steps on the

716
00:28:11,830 --> 00:28:13,299
left and distance on the right and

717
00:28:13,299 --> 00:28:14,950
they're pretty much being correlated at

718
00:28:14,950 --> 00:28:16,990
the same time so you can see how many

719
00:28:16,990 --> 00:28:19,120
steps Apple think I took sometimes I see

720
00:28:19,120 --> 00:28:20,769
steps when I'm driving in my car so

721
00:28:20,769 --> 00:28:24,220
again maybe not the most accurate but

722
00:28:24,220 --> 00:28:26,139
again something I would like to test a

723
00:28:26,139 --> 00:28:27,820
little bit more actually see how many

724
00:28:27,820 --> 00:28:29,919
steps it takes and what Apple is

725
00:28:29,919 --> 00:28:32,049
actually recording that as as far as

726
00:28:32,049 --> 00:28:33,639
health data generally from an Apple

727
00:28:33,639 --> 00:28:35,490
perspective it's pretty darn accurate

728
00:28:35,490 --> 00:28:37,480
it's just when I'm driving maybe I'm

729
00:28:37,480 --> 00:28:39,460
driving too fast and it's getting

730
00:28:39,460 --> 00:28:40,990
recorded as steps I'm a very aggressive

731
00:28:40,990 --> 00:28:41,779
driver

732
00:28:41,779 --> 00:28:44,119
I probably cut a few of you off in the

733
00:28:44,119 --> 00:28:48,499
in the DC area so next thing is device

734
00:28:48,499 --> 00:28:50,690
status so what's going on with the

735
00:28:50,690 --> 00:28:52,820
particular device maybe not necessarily

736
00:28:52,820 --> 00:28:55,700
user base stuff but is it charging is it

737
00:28:55,700 --> 00:28:58,849
is it back draining the battery you know

738
00:28:58,849 --> 00:29:00,590
I can overlay this on a lot of different

739
00:29:00,590 --> 00:29:03,679
things there sorry that was the next

740
00:29:03,679 --> 00:29:05,330
thing that I want to talk about so this

741
00:29:05,330 --> 00:29:08,570
is what's playing so when I'm in my car

742
00:29:08,570 --> 00:29:11,389
I have a car play going on I want to

743
00:29:11,389 --> 00:29:13,099
listen to music I want to listen to a

744
00:29:13,099 --> 00:29:16,489
podcast audiobook whatever for some

745
00:29:16,489 --> 00:29:18,529
reason knowledge C likes to see what's

746
00:29:18,529 --> 00:29:20,269
playing and it's literally the the

747
00:29:20,269 --> 00:29:23,299
string name is now playing so it's very

748
00:29:23,299 --> 00:29:25,399
accurate um so you can see on this one

749
00:29:25,399 --> 00:29:28,369
I'm kind of bouncing back from Apple

750
00:29:28,369 --> 00:29:31,879
music to NPR news I am an NPR public

751
00:29:31,879 --> 00:29:34,219
radio fan and you can see back and forth

752
00:29:34,219 --> 00:29:36,109
what I'm listening to listening to at

753
00:29:36,109 --> 00:29:38,839
any given point in time one thing I do

754
00:29:38,839 --> 00:29:41,330
want to point out here and this again is

755
00:29:41,330 --> 00:29:42,830
my own music don't judge me for my music

756
00:29:42,830 --> 00:29:45,489
tastes we all have our guilty pleasures

757
00:29:45,489 --> 00:29:48,019
so this one right here can you see that

758
00:29:48,019 --> 00:29:52,159
okay good so this thirty thousand

759
00:29:52,159 --> 00:29:54,559
whatever seconds I'm listening to one

760
00:29:54,559 --> 00:29:56,929
song that's actually really misleading

761
00:29:56,929 --> 00:29:58,159
it's not that I'm listening to that same

762
00:29:58,159 --> 00:29:59,960
song it's because I plugged it in my car

763
00:29:59,960 --> 00:30:02,389
listen to a song unplugged it went to

764
00:30:02,389 --> 00:30:04,339
work for a while and then went back into

765
00:30:04,339 --> 00:30:06,619
my car and it's still calculating that

766
00:30:06,619 --> 00:30:08,989
usage time so this is where you do have

767
00:30:08,989 --> 00:30:10,580
to do some testing you can't just make

768
00:30:10,580 --> 00:30:11,869
the assumptions that I was playing the

769
00:30:11,869 --> 00:30:15,559
same song over and over and over again I

770
00:30:15,559 --> 00:30:18,969
might do that for some but it does show

771
00:30:18,969 --> 00:30:21,649
that it looks a little bit different so

772
00:30:21,649 --> 00:30:26,029
play around with that if you can so next

773
00:30:26,029 --> 00:30:27,919
one is the device status so I want to

774
00:30:27,919 --> 00:30:29,509
see when the thing was locked when it

775
00:30:29,509 --> 00:30:32,119
was plugged in and all the different

776
00:30:32,119 --> 00:30:34,460
device things about that so that might

777
00:30:34,460 --> 00:30:35,960
come into play whether you know

778
00:30:35,960 --> 00:30:37,849
application was being used by the users

779
00:30:37,849 --> 00:30:39,259
or was it just sitting on a desk

780
00:30:39,259 --> 00:30:41,629
somewhere so the top one is showing me

781
00:30:41,629 --> 00:30:43,369
whether it was locked or unlocked and

782
00:30:43,369 --> 00:30:45,499
the bottom one's showing me if it was

783
00:30:45,499 --> 00:30:47,749
plugged in or not and I can overlay this

784
00:30:47,749 --> 00:30:50,239
one on battery life to see the charging

785
00:30:50,239 --> 00:30:52,279
go up and down along with the plug and

786
00:30:52,279 --> 00:30:53,460
unplug

787
00:30:53,460 --> 00:30:59,149
us in there now another device status is

788
00:30:59,149 --> 00:31:03,090
passcode unlocks our face ID unlocks so

789
00:31:03,090 --> 00:31:05,399
on the left-hand side here this is just

790
00:31:05,399 --> 00:31:07,080
another example of the aggregated

791
00:31:07,080 --> 00:31:08,669
dictionary one this is the one that

792
00:31:08,669 --> 00:31:11,909
stores information on a per day basis so

793
00:31:11,909 --> 00:31:13,529
it's showing me how many times I

794
00:31:13,529 --> 00:31:16,470
unlocked my device with a pin code so

795
00:31:16,470 --> 00:31:18,809
this is coming from an iPhone 10 no

796
00:31:18,809 --> 00:31:21,539
touch ID so every once in a while of

797
00:31:21,539 --> 00:31:23,549
course it doesn't recognize my face or

798
00:31:23,549 --> 00:31:24,870
I'm yawning while I'm looking at my

799
00:31:24,870 --> 00:31:26,010
phone I don't know how it doesn't

800
00:31:26,010 --> 00:31:27,659
recognize me at that point because I'm

801
00:31:27,659 --> 00:31:28,919
always yawning when I'm looking at my

802
00:31:28,919 --> 00:31:30,720
phone but it'll show me how many

803
00:31:30,720 --> 00:31:32,520
different times I've unlocked that from

804
00:31:32,520 --> 00:31:35,309
a particular from a passcode had an

805
00:31:35,309 --> 00:31:37,710
investigator asked me about this one you

806
00:31:37,710 --> 00:31:39,480
know send me an email is like hey is the

807
00:31:39,480 --> 00:31:42,840
passcode stored anywhere it's changing

808
00:31:42,840 --> 00:31:44,610
of the passcode stored anywhere and it

809
00:31:44,610 --> 00:31:46,830
is stored in the aggregate dictionary so

810
00:31:46,830 --> 00:31:48,929
I can see what type of passcode it's

811
00:31:48,929 --> 00:31:51,570
using for six complex alphanumeric

812
00:31:51,570 --> 00:31:53,340
whatever it's each one is tagged with a

813
00:31:53,340 --> 00:31:55,350
different number but I can also see how

814
00:31:55,350 --> 00:31:57,539
many times that passcode was used so

815
00:31:57,539 --> 00:32:00,299
this particular investigator had a had

816
00:32:00,299 --> 00:32:03,390
an instance where a person got killed

817
00:32:03,390 --> 00:32:05,220
was on her phone

818
00:32:05,220 --> 00:32:07,289
removing pictures and then set up a

819
00:32:07,289 --> 00:32:10,649
passcode to probably try to disable the

820
00:32:10,649 --> 00:32:12,659
criminal criminal analysis of that

821
00:32:12,659 --> 00:32:14,700
particular device but they got into the

822
00:32:14,700 --> 00:32:15,960
device they wanted to see when that

823
00:32:15,960 --> 00:32:18,600
passcode was changed from nothing to for

824
00:32:18,600 --> 00:32:20,970
six digits or whatever and you can see

825
00:32:20,970 --> 00:32:23,399
that within the aggregate dictionary now

826
00:32:23,399 --> 00:32:25,860
on the right-hand side I'm looking for

827
00:32:25,860 --> 00:32:27,630
different scalars with fingerprint now

828
00:32:27,630 --> 00:32:30,360
remember I'm on an iPhone 10 nothing's

829
00:32:30,360 --> 00:32:31,799
gonna come back with fingerprint there

830
00:32:31,799 --> 00:32:33,960
is no fingerprint capability there is no

831
00:32:33,960 --> 00:32:36,299
touch ID capability so this is where the

832
00:32:36,299 --> 00:32:39,240
device comes into play so testing

833
00:32:39,240 --> 00:32:40,409
different devices you're gonna have

834
00:32:40,409 --> 00:32:42,450
different data because of just different

835
00:32:42,450 --> 00:32:45,029
security aspects of that device so I've

836
00:32:45,029 --> 00:32:46,169
done a lot of the fingerprint analysis

837
00:32:46,169 --> 00:32:48,480
stuff before but that's not going to

838
00:32:48,480 --> 00:32:50,730
come into play for this one now I did do

839
00:32:50,730 --> 00:32:52,980
a search for face ID to see if it would

840
00:32:52,980 --> 00:32:54,990
recognize how many times I had a face ID

841
00:32:54,990 --> 00:32:57,570
in there and just doing a face ID search

842
00:32:57,570 --> 00:32:58,980
within this does not come up with

843
00:32:58,980 --> 00:33:00,450
anything so it might be named something

844
00:33:00,450 --> 00:33:03,270
else again ongoing research it truly

845
00:33:03,270 --> 00:33:04,980
never ends I just need to be

846
00:33:04,980 --> 00:33:06,680
specifically looking for it and

847
00:33:06,680 --> 00:33:11,270
thing for it now next up is the battery

848
00:33:11,270 --> 00:33:13,370
level so when I did the locked the

849
00:33:13,370 --> 00:33:16,280
unlocked plugged in not plugged in of

850
00:33:16,280 --> 00:33:18,440
course I can overlay the battery level

851
00:33:18,440 --> 00:33:20,630
of that and see it going up and down and

852
00:33:20,630 --> 00:33:22,400
battery level is going to be stored in a

853
00:33:22,400 --> 00:33:24,350
few different places it's stored in the

854
00:33:24,350 --> 00:33:25,850
current power log that's the example I'm

855
00:33:25,850 --> 00:33:27,620
giving you here but it's also being

856
00:33:27,620 --> 00:33:29,300
stored in the knowledge SI database and

857
00:33:29,300 --> 00:33:31,610
amongst a few other places as well so I

858
00:33:31,610 --> 00:33:33,500
can kind of correlate that between

859
00:33:33,500 --> 00:33:36,080
multiple databases this is one of the

860
00:33:36,080 --> 00:33:37,910
easier tables to look at it's just very

861
00:33:37,910 --> 00:33:41,630
simple so that's a lot of data that's a

862
00:33:41,630 --> 00:33:43,430
lot of queries that's a lot of databases

863
00:33:43,430 --> 00:33:45,170
that's a lot of testing that's a lot of

864
00:33:45,170 --> 00:33:48,530
sequel query building it takes time to

865
00:33:48,530 --> 00:33:50,780
do all that so one of the things that I

866
00:33:50,780 --> 00:33:52,250
did and I said this specifically for

867
00:33:52,250 --> 00:33:54,790
myself though I will be releasing it to

868
00:33:54,790 --> 00:33:57,620
out into the world at some point is I

869
00:33:57,620 --> 00:33:59,570
created a script to parse through all

870
00:33:59,570 --> 00:34:01,520
these databases and I'm calling it

871
00:34:01,520 --> 00:34:03,710
Apollo the Apple pattern of life lazy

872
00:34:03,710 --> 00:34:06,560
output er I think the name is fantastic

873
00:34:06,560 --> 00:34:08,870
I created it because I wanted it to be a

874
00:34:08,870 --> 00:34:11,330
low bar to entry so it's a stupid script

875
00:34:11,330 --> 00:34:13,790
it really just takes a query a database

876
00:34:13,790 --> 00:34:16,429
matches them up and dumps the output to

877
00:34:16,429 --> 00:34:18,670
either a CSV or a sequel Lite database

878
00:34:18,670 --> 00:34:21,110
so I hope other forensic investigators

879
00:34:21,110 --> 00:34:22,730
they have my favorite queries you can

880
00:34:22,730 --> 00:34:25,280
add modules and we can kind of work with

881
00:34:25,280 --> 00:34:28,040
it there so it's very useful for quick

882
00:34:28,040 --> 00:34:30,080
correlation it's not pretty it's not

883
00:34:30,080 --> 00:34:33,260
perfect but it's easy to update and keep

884
00:34:33,260 --> 00:34:35,420
those queries up-to-date as well so if

885
00:34:35,420 --> 00:34:36,560
you find something else that's useful

886
00:34:36,560 --> 00:34:39,560
throw a module in there and everything

887
00:34:39,560 --> 00:34:41,620
is good to go

888
00:34:41,620 --> 00:34:44,000
sum-sum so I guess I'd say that it's a

889
00:34:44,000 --> 00:34:45,440
dumb script it's really not doing much

890
00:34:45,440 --> 00:34:47,330
there's a few additional kind of

891
00:34:47,330 --> 00:34:48,980
analytic stuff that I like to throw in

892
00:34:48,980 --> 00:34:51,050
there but there's really not done yet

893
00:34:51,050 --> 00:34:53,090
it's really just based upon the sequel

894
00:34:53,090 --> 00:34:55,969
query modules and I'll show you an

895
00:34:55,969 --> 00:34:57,400
example of one of those in just a bit

896
00:34:57,400 --> 00:34:59,870
while I do call it the Apple pattern of

897
00:34:59,870 --> 00:35:00,350
life

898
00:35:00,350 --> 00:35:02,540
lazy output her it's just just the

899
00:35:02,540 --> 00:35:05,060
database it's sequel so if it's you've

900
00:35:05,060 --> 00:35:06,290
got an Android a bunch of Android

901
00:35:06,290 --> 00:35:08,240
databases those windows use sequel

902
00:35:08,240 --> 00:35:09,620
databases I honestly don't know I don't

903
00:35:09,620 --> 00:35:11,390
touch Windows but it really doesn't

904
00:35:11,390 --> 00:35:13,460
matter what platform it is as long as

905
00:35:13,460 --> 00:35:15,620
it's a sequel database secret database

906
00:35:15,620 --> 00:35:18,290
and you have a query associated with it

907
00:35:18,290 --> 00:35:20,180
so you can create modules for literally

908
00:35:20,180 --> 00:35:23,359
anything and just run it through now the

909
00:35:23,359 --> 00:35:25,400
modules directory is just a directory

910
00:35:25,400 --> 00:35:26,839
full of little text files I tried to

911
00:35:26,839 --> 00:35:28,250
make this thing as simple as possible

912
00:35:28,250 --> 00:35:30,380
there's no really reason to over

913
00:35:30,380 --> 00:35:33,829
complicate things so I already have 70

914
00:35:33,829 --> 00:35:35,359
created so I'll probably release about

915
00:35:35,359 --> 00:35:39,710
70 later this week maybe but I have

916
00:35:39,710 --> 00:35:42,829
another 20 and 10 more in mind so I'm

917
00:35:42,829 --> 00:35:43,849
probably gonna have about a hundred

918
00:35:43,849 --> 00:35:46,430
different queries once all is said and

919
00:35:46,430 --> 00:35:48,440
done I'm gonna continuously update these

920
00:35:48,440 --> 00:35:52,099
as I do my research as far as running it

921
00:35:52,099 --> 00:35:54,559
is just a Python script not really that

922
00:35:54,559 --> 00:35:56,210
difficult to run it you just have to

923
00:35:56,210 --> 00:35:58,490
figure out which output you want so CSV

924
00:35:58,490 --> 00:36:01,220
sequel sequel if you have another output

925
00:36:01,220 --> 00:36:02,630
that you want just let me know it should

926
00:36:02,630 --> 00:36:07,040
be fairly easy to integrate into it so

927
00:36:07,040 --> 00:36:09,829
an example of one of the configuration

928
00:36:09,829 --> 00:36:11,869
files so it's just a text file I'm using

929
00:36:11,869 --> 00:36:13,849
what is a config parser to actually

930
00:36:13,849 --> 00:36:15,589
parse this stuff out it gives it a

931
00:36:15,589 --> 00:36:17,180
little bit of metadata information who

932
00:36:17,180 --> 00:36:19,309
created it a little bit about what it

933
00:36:19,309 --> 00:36:22,010
does or what it's extracting points it

934
00:36:22,010 --> 00:36:24,140
to a specific database so for this one

935
00:36:24,140 --> 00:36:26,420
we've got the knowledge C database what

936
00:36:26,420 --> 00:36:28,040
platform so it's gonna be very dependent

937
00:36:28,040 --> 00:36:30,470
on platform so knowledge C on Mac is not

938
00:36:30,470 --> 00:36:32,329
necessarily the same as knowledge C on

939
00:36:32,329 --> 00:36:35,480
iOS it's very close but not exactly the

940
00:36:35,480 --> 00:36:38,450
same and it's giving you some activity

941
00:36:38,450 --> 00:36:39,619
information so when you're quickly

942
00:36:39,619 --> 00:36:41,210
scanning you can see okay this is the

943
00:36:41,210 --> 00:36:45,589
application in focus and a key timestamp

944
00:36:45,589 --> 00:36:47,030
so this is all based upon a single

945
00:36:47,030 --> 00:36:48,799
timestamp so whichever timestamp you'll

946
00:36:48,799 --> 00:36:50,960
prefer to kind of correlate all your

947
00:36:50,960 --> 00:36:53,390
data on there so for this one I did the

948
00:36:53,390 --> 00:36:55,520
start of the application of focus or

949
00:36:55,520 --> 00:36:57,829
when that application became in focus

950
00:36:57,829 --> 00:36:59,089
there's a few other timestamps there's

951
00:36:59,089 --> 00:37:01,400
an end timestamp there's a entry

952
00:37:01,400 --> 00:37:02,930
creation timestamp but those are not

953
00:37:02,930 --> 00:37:04,910
accurate to what the user was doing so

954
00:37:04,910 --> 00:37:07,099
this is where testing certainly comes

955
00:37:07,099 --> 00:37:12,319
into play so running Apollo and I'm

956
00:37:12,319 --> 00:37:14,299
sorry for the the white on black Here I

957
00:37:14,299 --> 00:37:17,510
am using dark mode on Mojave still not

958
00:37:17,510 --> 00:37:19,010
entirely sure I like it but it makes me

959
00:37:19,010 --> 00:37:22,849
feel like more of a hacker so I got my

960
00:37:22,849 --> 00:37:24,200
script running here and it's really just

961
00:37:24,200 --> 00:37:25,790
it's going through all the different

962
00:37:25,790 --> 00:37:27,740
text files every single one if it

963
00:37:27,740 --> 00:37:29,599
doesn't find it great if it doesn't have

964
00:37:29,599 --> 00:37:31,760
the same database structure it skips

965
00:37:31,760 --> 00:37:32,829
over and it

966
00:37:32,829 --> 00:37:34,299
again it's dumb it's literally going

967
00:37:34,299 --> 00:37:37,089
through doing just a recursive review

968
00:37:37,089 --> 00:37:39,009
looking for that database name and doing

969
00:37:39,009 --> 00:37:40,630
it over and over and over again which

970
00:37:40,630 --> 00:37:42,849
means it's extremely inefficient and I

971
00:37:42,849 --> 00:37:46,029
don't care but just just an example once

972
00:37:46,029 --> 00:37:48,309
it's done is as lazily outputted sequel

973
00:37:48,309 --> 00:37:50,739
file Apollo DB so I do the sequel

974
00:37:50,739 --> 00:37:53,529
database output so I did this one on the

975
00:37:53,529 --> 00:37:55,329
plane yesterday and I was actually we

976
00:37:55,329 --> 00:37:57,609
were landing very close to the time

977
00:37:57,609 --> 00:37:59,799
where this thing was supposed to finish

978
00:37:59,799 --> 00:38:00,849
I was like finished finished finished

979
00:38:00,849 --> 00:38:02,079
finished before they make me put my

980
00:38:02,079 --> 00:38:05,309
laptop away so this one on a full

981
00:38:05,309 --> 00:38:08,140
physical logical dump of my iPhone 10

982
00:38:08,140 --> 00:38:10,359
full dump system data partition

983
00:38:10,359 --> 00:38:14,880
everything it took 87 minutes to run

984
00:38:14,880 --> 00:38:17,529
really really not efficient

985
00:38:17,529 --> 00:38:19,959
so what I usually do is I'll just go and

986
00:38:19,959 --> 00:38:22,089
seek out those databases that I want the

987
00:38:22,089 --> 00:38:23,709
knowledge the power log this that the

988
00:38:23,709 --> 00:38:25,450
other thing and dump those into another

989
00:38:25,450 --> 00:38:26,859
directory and it takes under five

990
00:38:26,859 --> 00:38:29,410
minutes to run so this is where the file

991
00:38:29,410 --> 00:38:31,479
structure comes into play I could say

992
00:38:31,479 --> 00:38:32,469
that I'm going to fix that but I

993
00:38:32,469 --> 00:38:34,630
probably won't I'll be perfectly honest

994
00:38:34,630 --> 00:38:36,849
with that I'd rather write more sequel

995
00:38:36,849 --> 00:38:39,130
sequel like modules for folks to run and

996
00:38:39,130 --> 00:38:41,170
then they can you know run this at night

997
00:38:41,170 --> 00:38:42,940
if they don't want to take the time to

998
00:38:42,940 --> 00:38:47,109
extract all the databases I'm all about

999
00:38:47,109 --> 00:38:50,019
no promises here so an example of the

1000
00:38:50,019 --> 00:38:52,749
output I got a few different screenshots

1001
00:38:52,749 --> 00:38:53,079
here

1002
00:38:53,079 --> 00:38:55,660
I know it's ugly to look at and it looks

1003
00:38:55,660 --> 00:38:57,609
terrible in a presentation format so if

1004
00:38:57,609 --> 00:38:59,049
you actually want to sit down with me

1005
00:38:59,049 --> 00:39:00,309
and kind of go through some of the data

1006
00:39:00,309 --> 00:39:02,349
there's only a certain amount that I can

1007
00:39:02,349 --> 00:39:04,390
fit on here so what you actually need is

1008
00:39:04,390 --> 00:39:07,029
about three thirty inch monitors pegged

1009
00:39:07,029 --> 00:39:08,769
together with the sequel Lite database

1010
00:39:08,769 --> 00:39:10,660
browser across all three because the

1011
00:39:10,660 --> 00:39:14,890
data is just that long as an example so

1012
00:39:14,890 --> 00:39:16,269
it's really not meant for very small

1013
00:39:16,269 --> 00:39:18,969
screens so I have an example of this one

1014
00:39:18,969 --> 00:39:21,400
here so I took a day in my life on my

1015
00:39:21,400 --> 00:39:25,660
iPhone and that's what September 16th or

1016
00:39:25,660 --> 00:39:27,880
yeah it looks like September 16th and

1017
00:39:27,880 --> 00:39:30,609
just sort of scrolled throughout the

1018
00:39:30,609 --> 00:39:32,979
whole day so I'm starting at midnight so

1019
00:39:32,979 --> 00:39:34,449
we get the zero hundred hours up there

1020
00:39:34,449 --> 00:39:37,749
and at this point this is a Sunday so

1021
00:39:37,749 --> 00:39:39,489
it's a Saturday going into a Sunday at

1022
00:39:39,489 --> 00:39:41,769
midnight on the East Coast so I was

1023
00:39:41,769 --> 00:39:43,569
leaving a friend's birthday party up in

1024
00:39:43,569 --> 00:39:44,680
Maryland

1025
00:39:44,680 --> 00:39:46,360
so if you kind of look at the different

1026
00:39:46,360 --> 00:39:48,610
application usage you can see calm

1027
00:39:48,610 --> 00:39:50,650
8-bits 22 which is Twitter of course

1028
00:39:50,650 --> 00:39:53,650
you'll often see Twitter in my logs so I

1029
00:39:53,650 --> 00:39:55,690
was checking Twitter then I hooked up

1030
00:39:55,690 --> 00:39:59,380
the phone to carplay so a couple other

1031
00:39:59,380 --> 00:40:01,510
items in here you see the network usage

1032
00:40:01,510 --> 00:40:03,610
so you can see Twitter basically sending

1033
00:40:03,610 --> 00:40:05,380
receiving traffic back and forth that

1034
00:40:05,380 --> 00:40:07,330
could be very useful but you also see

1035
00:40:07,330 --> 00:40:08,890
the location information so the

1036
00:40:08,890 --> 00:40:10,510
different coordinates i've redacted this

1037
00:40:10,510 --> 00:40:12,730
because well it's my buddy's house I

1038
00:40:12,730 --> 00:40:13,810
don't know exactly want to put that out

1039
00:40:13,810 --> 00:40:16,390
to the world but if anybody recognizes

1040
00:40:16,390 --> 00:40:18,400
these coordinates what 39 negative 76

1041
00:40:18,400 --> 00:40:22,920
what state is that give or take

1042
00:40:22,920 --> 00:40:24,940
everybody knows their own coordinates

1043
00:40:24,940 --> 00:40:29,680
right 38 negative 77 no okay so I am a

1044
00:40:29,680 --> 00:40:30,700
nerd

1045
00:40:30,700 --> 00:40:33,610
this is Maryland so it's right right

1046
00:40:33,610 --> 00:40:36,130
next door and if you follow through you

1047
00:40:36,130 --> 00:40:37,570
can actually see where I'm driving and

1048
00:40:37,570 --> 00:40:39,850
how to get home back to Arlington in the

1049
00:40:39,850 --> 00:40:42,610
DC area a few other things in device

1050
00:40:42,610 --> 00:40:45,940
status I see comical private alloy

1051
00:40:45,940 --> 00:40:48,190
that's a lot of the continuity stuff

1052
00:40:48,190 --> 00:40:51,160
going back and forth messages receiving

1053
00:40:51,160 --> 00:40:53,020
all that kind of thing so notifications

1054
00:40:53,020 --> 00:40:56,770
more location and then finally over here

1055
00:40:56,770 --> 00:40:58,300
I see some more application activity

1056
00:40:58,300 --> 00:40:59,500
this is coming from the knowledge C

1057
00:40:59,500 --> 00:41:00,130
database

1058
00:41:00,130 --> 00:41:04,210
I get comm Apple Maps dropped pin and

1059
00:41:04,210 --> 00:41:06,520
then directions from wherever wherever

1060
00:41:06,520 --> 00:41:08,620
this is me in Apple maps basically

1061
00:41:08,620 --> 00:41:11,080
saying send me home send me to wherever

1062
00:41:11,080 --> 00:41:13,090
so I'm in car play in the Maps

1063
00:41:13,090 --> 00:41:17,520
application doing that kind of thing so

1064
00:41:17,550 --> 00:41:20,290
another example this one you could see

1065
00:41:20,290 --> 00:41:22,420
if it was distracted driving or not so

1066
00:41:22,420 --> 00:41:24,220
while I'm traveling and you can see if

1067
00:41:24,220 --> 00:41:25,510
I'm moving or not by looking at the

1068
00:41:25,510 --> 00:41:28,300
location and specifically the speed this

1069
00:41:28,300 --> 00:41:29,770
is one thing that I'm actually curious

1070
00:41:29,770 --> 00:41:31,870
about if anybody can answer this that

1071
00:41:31,870 --> 00:41:33,250
would help me out quite a bit I don't

1072
00:41:33,250 --> 00:41:35,290
know what the unit of measure of this is

1073
00:41:35,290 --> 00:41:38,380
so I know just from my normal driving

1074
00:41:38,380 --> 00:41:40,260
that this is highway speeds give or take

1075
00:41:40,260 --> 00:41:43,420
what 15 is it doesn't seem to be

1076
00:41:43,420 --> 00:41:46,120
kilometres it's not anything that I can

1077
00:41:46,120 --> 00:41:48,880
come up with but it is highway level

1078
00:41:48,880 --> 00:41:51,850
speeds here so trying to take a closer

1079
00:41:51,850 --> 00:41:53,500
look at that and then you start seeing

1080
00:41:53,500 --> 00:41:56,230
some app usage here comm Apple assistant

1081
00:41:56,230 --> 00:41:58,450
service comm Apple mobile SMS

1082
00:41:58,450 --> 00:42:01,510
so assistant service this is Siri so I

1083
00:42:01,510 --> 00:42:03,760
have my phone hooked up into carplay and

1084
00:42:03,760 --> 00:42:06,010
I'm sending messages back and forth so

1085
00:42:06,010 --> 00:42:07,809
Siri is dictating my messages and

1086
00:42:07,809 --> 00:42:10,150
sending them and doing all that kind of

1087
00:42:10,150 --> 00:42:11,890
thing so I can see if I was actually on

1088
00:42:11,890 --> 00:42:14,049
the device itself or what was I doing

1089
00:42:14,049 --> 00:42:16,299
the proper hands-free thing and using

1090
00:42:16,299 --> 00:42:19,480
Siri a few other things in here

1091
00:42:19,480 --> 00:42:21,160
application activity I know it's

1092
00:42:21,160 --> 00:42:22,930
probably a little difficult to read we

1093
00:42:22,930 --> 00:42:24,880
have the app name as messages and a

1094
00:42:24,880 --> 00:42:26,680
bunch of intense and if I keep going

1095
00:42:26,680 --> 00:42:28,030
through and looking at the rest of the

1096
00:42:28,030 --> 00:42:30,130
data on this line you can see that I'm

1097
00:42:30,130 --> 00:42:31,900
sending a message so I'm using Siri to

1098
00:42:31,900 --> 00:42:33,700
dictate it but you can also see who I'm

1099
00:42:33,700 --> 00:42:35,559
sending it to how long it took and all

1100
00:42:35,559 --> 00:42:37,000
that additional metadata based

1101
00:42:37,000 --> 00:42:39,369
information again I just can't fit it

1102
00:42:39,369 --> 00:42:42,069
all on the same screen here and then if

1103
00:42:42,069 --> 00:42:44,170
I keep going more location more

1104
00:42:44,170 --> 00:42:47,680
activities listening to music so comm

1105
00:42:47,680 --> 00:42:49,750
Apple music that now playing so you can

1106
00:42:49,750 --> 00:42:51,520
see what songs I'm listening to you can

1107
00:42:51,520 --> 00:42:52,690
actually see it bounce back and forth

1108
00:42:52,690 --> 00:42:55,569
between Siri and playing music so you

1109
00:42:55,569 --> 00:42:57,250
can see how many different messages I'm

1110
00:42:57,250 --> 00:42:59,260
going back and forth and then I'm

1111
00:42:59,260 --> 00:43:02,500
rocking out during my late-night drive a

1112
00:43:02,500 --> 00:43:04,420
few other things that might be useful in

1113
00:43:04,420 --> 00:43:06,609
here is this assistant decom battle

1114
00:43:06,609 --> 00:43:08,440
music and I think somewhere it says

1115
00:43:08,440 --> 00:43:10,809
Syria or maybe I cut that off but the

1116
00:43:10,809 --> 00:43:13,059
comm Apple audio information there as

1117
00:43:13,059 --> 00:43:15,880
well so no distracted driving I was

1118
00:43:15,880 --> 00:43:17,890
doing it all through carplay at this

1119
00:43:17,890 --> 00:43:22,450
point next thing is device status so a

1120
00:43:22,450 --> 00:43:25,059
few couple of examples of that one so a

1121
00:43:25,059 --> 00:43:28,569
little bit later in the day I'm looking

1122
00:43:28,569 --> 00:43:30,760
at the battery life I have different

1123
00:43:30,760 --> 00:43:32,829
springboard things up on here so I can

1124
00:43:32,829 --> 00:43:34,540
see which screen I'm on flipping back

1125
00:43:34,540 --> 00:43:37,900
and forth different Wi-Fi information so

1126
00:43:37,900 --> 00:43:39,750
it's currently getting location from

1127
00:43:39,750 --> 00:43:42,099
variety of different sources so I can

1128
00:43:42,099 --> 00:43:43,780
tell what sources it's getting that

1129
00:43:43,780 --> 00:43:45,880
location data from whether it's cellular

1130
00:43:45,880 --> 00:43:48,160
whether it's the GPS chip whether it's

1131
00:43:48,160 --> 00:43:50,380
Wi-Fi and so on so that might gives you

1132
00:43:50,380 --> 00:43:52,059
a little hint on how accurate that

1133
00:43:52,059 --> 00:43:55,030
location actually is keep going down

1134
00:43:55,030 --> 00:43:57,520
there's button types in here literally a

1135
00:43:57,520 --> 00:44:00,790
lot of buttons are tracked in here why I

1136
00:44:00,790 --> 00:44:02,200
don't know but you'll see a lot of

1137
00:44:02,200 --> 00:44:04,660
button events and everything happening I

1138
00:44:04,660 --> 00:44:06,579
honestly don't know what I was doing at

1139
00:44:06,579 --> 00:44:09,010
that point I can't remember the screen

1140
00:44:09,010 --> 00:44:10,720
brightness so screen brightness going up

1141
00:44:10,720 --> 00:44:12,250
volume going up

1142
00:44:12,250 --> 00:44:14,920
down a lot of different variables

1143
00:44:14,920 --> 00:44:17,110
associated with a particular device are

1144
00:44:17,110 --> 00:44:18,970
getting tracked here and I'm not showing

1145
00:44:18,970 --> 00:44:20,380
it to you here just because just

1146
00:44:20,380 --> 00:44:21,820
different screen shots will just show

1147
00:44:21,820 --> 00:44:25,060
different data I think I'm not sure if I

1148
00:44:25,060 --> 00:44:26,620
have written anywhere but for a day in

1149
00:44:26,620 --> 00:44:29,040
the life of my phone I'm looking at oh

1150
00:44:29,040 --> 00:44:30,520
it's broke again

1151
00:44:30,520 --> 00:44:33,010
oh it's like it's going to sleep or

1152
00:44:33,010 --> 00:44:37,360
something all right so this whole day is

1153
00:44:37,360 --> 00:44:41,800
about 25,000 data points for a single

1154
00:44:41,800 --> 00:44:44,800
day that's a lot that's a lot of

1155
00:44:44,800 --> 00:44:47,230
scrolling within you know your sequel

1156
00:44:47,230 --> 00:44:49,750
Lite database browser this Apollo DB

1157
00:44:49,750 --> 00:44:51,640
file when I ran all my modules on it is

1158
00:44:51,640 --> 00:44:57,940
come on is about five to six hundred

1159
00:44:57,940 --> 00:45:00,130
Meg's or so so it's not a small database

1160
00:45:00,130 --> 00:45:03,520
so this data is it get pretty large very

1161
00:45:03,520 --> 00:45:06,190
quickly does it keep going out all right

1162
00:45:06,190 --> 00:45:07,140
standby

1163
00:45:07,140 --> 00:45:09,160
we were having a good run there for a

1164
00:45:09,160 --> 00:45:11,520
second

1165
00:45:24,150 --> 00:45:26,790
do you see it oh I don't see it anymore

1166
00:45:26,790 --> 00:45:29,700
oh there it is okay so a lot of

1167
00:45:29,700 --> 00:45:31,410
different things having to do with what

1168
00:45:31,410 --> 00:45:34,680
the device is currently doing another

1169
00:45:34,680 --> 00:45:37,650
one is app usage and browsing so this is

1170
00:45:37,650 --> 00:45:39,750
where power log app usage or knowledge

1171
00:45:39,750 --> 00:45:41,760
see app you to come into play so I can

1172
00:45:41,760 --> 00:45:43,800
see what the user was doing how long

1173
00:45:43,800 --> 00:45:45,060
they were doing it and in what order

1174
00:45:45,060 --> 00:45:48,120
they were doing it so this one I seek

1175
00:45:48,120 --> 00:45:50,520
I'm Apple lockscreen moving to

1176
00:45:50,520 --> 00:45:53,090
springboard homescreen to mobile mail

1177
00:45:53,090 --> 00:45:57,300
more mobile mail springboard it's very

1178
00:45:57,300 --> 00:45:59,700
hard to read more device status stuff

1179
00:45:59,700 --> 00:46:02,490
mobile SMS mobile safari more mobile

1180
00:46:02,490 --> 00:46:04,290
safari so one thing that I didn't

1181
00:46:04,290 --> 00:46:05,730
mentioned before is in the knowledge sea

1182
00:46:05,730 --> 00:46:07,470
it's also keeping track of my browsing

1183
00:46:07,470 --> 00:46:10,230
history now this is separate from the

1184
00:46:10,230 --> 00:46:12,120
Safari browsing history the history DB

1185
00:46:12,120 --> 00:46:14,220
stored elsewhere could I write a query

1186
00:46:14,220 --> 00:46:15,990
for that absolutely I already have a

1187
00:46:15,990 --> 00:46:17,040
query for that I just haven't

1188
00:46:17,040 --> 00:46:20,400
implemented in in into this script

1189
00:46:20,400 --> 00:46:23,160
framework yet but I can grab that from

1190
00:46:23,160 --> 00:46:26,040
the knowledge SI database as well so

1191
00:46:26,040 --> 00:46:28,440
thank you for being able to store that

1192
00:46:28,440 --> 00:46:31,290
in multiple locations very useful from

1193
00:46:31,290 --> 00:46:33,330
my standpoint so I can see them doing

1194
00:46:33,330 --> 00:46:34,440
different things with different

1195
00:46:34,440 --> 00:46:36,360
application activities and application

1196
00:46:36,360 --> 00:46:38,340
intents from specifically than knowledge

1197
00:46:38,340 --> 00:46:40,830
C database very very useful to put

1198
00:46:40,830 --> 00:46:42,750
context to what the user was actually

1199
00:46:42,750 --> 00:46:44,520
doing were they reading an email were

1200
00:46:44,520 --> 00:46:46,170
they sending a message were they

1201
00:46:46,170 --> 00:46:48,900
browsing Safari all sorts of useful

1202
00:46:48,900 --> 00:46:53,460
information so next up is more context

1203
00:46:53,460 --> 00:46:55,650
so there's specifically under cor duet

1204
00:46:55,650 --> 00:46:59,250
this interaction C database and this is

1205
00:46:59,250 --> 00:47:00,900
gonna give you a little bit more context

1206
00:47:00,900 --> 00:47:03,000
on who I'm interacting with so it's very

1207
00:47:03,000 --> 00:47:04,860
much specific to things like

1208
00:47:04,860 --> 00:47:07,170
communication or email or messaging and

1209
00:47:07,170 --> 00:47:09,900
items like that so with this one I have

1210
00:47:09,900 --> 00:47:11,670
a lot of examples of comm Apple mobile

1211
00:47:11,670 --> 00:47:14,520
mail I just happened to get an email

1212
00:47:14,520 --> 00:47:16,440
sync at this particular time so you can

1213
00:47:16,440 --> 00:47:18,030
see a lot of the different emails that

1214
00:47:18,030 --> 00:47:20,220
I've just received on my device and a

1215
00:47:20,220 --> 00:47:22,590
lot of us just crap emails from Redfin

1216
00:47:22,590 --> 00:47:24,900
outtie whatever else Container Store so

1217
00:47:24,900 --> 00:47:26,580
it's a lot of junk mail except for that

1218
00:47:26,580 --> 00:47:27,960
one particular message that I were

1219
00:47:27,960 --> 00:47:29,940
directed because I'm certain that person

1220
00:47:29,940 --> 00:47:31,710
wouldn't want their name on the screen

1221
00:47:31,710 --> 00:47:34,530
here so I can see interactions with that

1222
00:47:34,530 --> 00:47:37,200
particular type of data

1223
00:47:37,200 --> 00:47:40,530
next one is the heart rate so going back

1224
00:47:40,530 --> 00:47:43,829
to my workout you can see with

1225
00:47:43,829 --> 00:47:46,049
overlaying that location type of data

1226
00:47:46,049 --> 00:47:48,480
and the workout information of where I

1227
00:47:48,480 --> 00:47:49,619
workout

1228
00:47:49,619 --> 00:47:51,569
maybe I'm running on a trail somewhere I

1229
00:47:51,569 --> 00:47:54,319
try not to run but sometimes you have to

1230
00:47:54,319 --> 00:47:58,970
gosh this thing is being beast so I got

1231
00:47:58,970 --> 00:48:01,440
some Twitter stuff in here and finally I

1232
00:48:01,440 --> 00:48:02,970
get some location information so if you

1233
00:48:02,970 --> 00:48:04,079
look up these coordinates

1234
00:48:04,079 --> 00:48:05,910
it's going to show you the location to

1235
00:48:05,910 --> 00:48:07,680
Orangetheory in Boston Virginia so if

1236
00:48:07,680 --> 00:48:09,119
anybody wants to work out together I

1237
00:48:09,119 --> 00:48:12,990
mean I'm there it's a 11:30 on the

1238
00:48:12,990 --> 00:48:15,540
weekends because I like to sleep in so I

1239
00:48:15,540 --> 00:48:16,829
can see all the different heart rate

1240
00:48:16,829 --> 00:48:19,049
things so I can go to see when I go to

1241
00:48:19,049 --> 00:48:21,210
class see when the class starts and see

1242
00:48:21,210 --> 00:48:23,790
the heart rate go up look like I'm about

1243
00:48:23,790 --> 00:48:25,859
to die and then at the end of the class

1244
00:48:25,859 --> 00:48:28,440
finally it kind of levels out I'm not

1245
00:48:28,440 --> 00:48:30,480
going to die but I feel like I had a

1246
00:48:30,480 --> 00:48:32,790
really good workout so again thousands

1247
00:48:32,790 --> 00:48:34,589
of different data points for that so

1248
00:48:34,589 --> 00:48:35,880
you're really scrolling I'm only giving

1249
00:48:35,880 --> 00:48:38,400
you a small fraction of the particular

1250
00:48:38,400 --> 00:48:43,260
data in here now as far as improvements

1251
00:48:43,260 --> 00:48:45,450
go so I really wrote this script as

1252
00:48:45,450 --> 00:48:47,849
something for myself because I want to

1253
00:48:47,849 --> 00:48:49,799
automate this process it actually takes

1254
00:48:49,799 --> 00:48:52,920
again a long time to do this of course I

1255
00:48:52,920 --> 00:48:54,359
release try to raise as much as I can

1256
00:48:54,359 --> 00:48:57,660
publicly research blogs crappy Python

1257
00:48:57,660 --> 00:48:59,339
scripts because I want to help other

1258
00:48:59,339 --> 00:49:01,740
investigators out there so what I'm

1259
00:49:01,740 --> 00:49:04,020
going to do is one I'll actually release

1260
00:49:04,020 --> 00:49:07,980
it hopefully this weeks maybe no

1261
00:49:07,980 --> 00:49:09,119
promises

1262
00:49:09,119 --> 00:49:11,520
I want to write more queries for it I

1263
00:49:11,520 --> 00:49:13,650
can write just there's just an unlimited

1264
00:49:13,650 --> 00:49:15,119
amount of queries that you can write for

1265
00:49:15,119 --> 00:49:18,660
different aspects of Mac and iOS data so

1266
00:49:18,660 --> 00:49:21,059
more iOS stuff for sure but I also want

1267
00:49:21,059 --> 00:49:22,799
to parse some of the Mac OS stuff so I

1268
00:49:22,799 --> 00:49:24,359
really focused on iOS for this

1269
00:49:24,359 --> 00:49:26,309
presentation but a lot of this stuff is

1270
00:49:26,309 --> 00:49:28,589
also being tracked on Mac OS not as much

1271
00:49:28,589 --> 00:49:30,480
but it's still useful from an

1272
00:49:30,480 --> 00:49:33,809
investigative standpoint I want to do

1273
00:49:33,809 --> 00:49:35,520
more pattern of life stuff I want to

1274
00:49:35,520 --> 00:49:37,020
throw in more config files for a

1275
00:49:37,020 --> 00:49:39,030
different OS version so I want to try to

1276
00:49:39,030 --> 00:49:41,099
get backwards compatibility at some

1277
00:49:41,099 --> 00:49:43,770
point thank you so I want to get

1278
00:49:43,770 --> 00:49:46,440
backwards compatibility kind of updates

1279
00:49:46,440 --> 00:49:48,000
on my old stuff so I have some few older

1280
00:49:48,000 --> 00:49:50,210
data sets I can't do so much testing on

1281
00:49:50,210 --> 00:49:52,150
because I've updated those devices now

1282
00:49:52,150 --> 00:49:54,619
but I really want to get that out there

1283
00:49:54,619 --> 00:49:56,330
just in case anybody else comes across

1284
00:49:56,330 --> 00:50:00,770
it so more testing more efficiency at

1285
00:50:00,770 --> 00:50:02,690
maybe doing the full filesystem dump

1286
00:50:02,690 --> 00:50:06,650
maybe not gonna promise that one better

1287
00:50:06,650 --> 00:50:08,750
blob display so the location blobs I

1288
00:50:08,750 --> 00:50:09,589
think are going to be particularly

1289
00:50:09,589 --> 00:50:11,960
useful to just be quickly able to see

1290
00:50:11,960 --> 00:50:14,210
what the contents of them are so I might

1291
00:50:14,210 --> 00:50:16,220
write a random string this kind of thing

1292
00:50:16,220 --> 00:50:18,440
within my Python script to dump that out

1293
00:50:18,440 --> 00:50:21,050
into the output and since there doesn't

1294
00:50:21,050 --> 00:50:22,550
seem to be a strings function within

1295
00:50:22,550 --> 00:50:25,580
sequel light proper at least not a good

1296
00:50:25,580 --> 00:50:26,839
one

1297
00:50:26,839 --> 00:50:28,790
embedded plist file extraction on

1298
00:50:28,790 --> 00:50:30,710
archiving gzip file so I want to start

1299
00:50:30,710 --> 00:50:32,660
automating this so some investigators

1300
00:50:32,660 --> 00:50:34,400
can just throw it at a dump let it do

1301
00:50:34,400 --> 00:50:36,880
its thing and then get back all the data

1302
00:50:36,880 --> 00:50:39,380
multiple database file names so if the

1303
00:50:39,380 --> 00:50:41,810
queries similar across platforms I might

1304
00:50:41,810 --> 00:50:43,670
try to merge that so it's less redundant

1305
00:50:43,670 --> 00:50:46,280
still trying to figure that out and then

1306
00:50:46,280 --> 00:50:48,290
one problem I have is automatic database

1307
00:50:48,290 --> 00:50:50,570
coalescing so a lot of the times when

1308
00:50:50,570 --> 00:50:52,490
we're dealing with forensic stuff we

1309
00:50:52,490 --> 00:50:54,170
have a shim we have a wall a lot of the

1310
00:50:54,170 --> 00:50:55,849
transactions are being stored in those

1311
00:50:55,849 --> 00:50:58,310
sequel light wall files but I can't use

1312
00:50:58,310 --> 00:50:59,990
that script to really do that so if

1313
00:50:59,990 --> 00:51:01,670
anybody has a good solution for that I

1314
00:51:01,670 --> 00:51:04,369
would really like to know because from a

1315
00:51:04,369 --> 00:51:06,080
forensics perspective that's a lot of

1316
00:51:06,080 --> 00:51:08,119
data that I'm missing being stored in

1317
00:51:08,119 --> 00:51:10,880
those wall files and finally I want to

1318
00:51:10,880 --> 00:51:12,410
get some sort of visualization so

1319
00:51:12,410 --> 00:51:14,420
pattern of life we need to have patterns

1320
00:51:14,420 --> 00:51:16,220
of some sort we need to be able to see

1321
00:51:16,220 --> 00:51:18,800
what's going on across this so this is a

1322
00:51:18,800 --> 00:51:21,020
lot of data I'm sure to break a lot of

1323
00:51:21,020 --> 00:51:23,240
current visualization products so it

1324
00:51:23,240 --> 00:51:24,410
might be something I might have to write

1325
00:51:24,410 --> 00:51:27,020
custom I haven't thrown it into Splunk

1326
00:51:27,020 --> 00:51:28,849
yet to see how that in takes it but

1327
00:51:28,849 --> 00:51:30,830
honestly it should be possible at some

1328
00:51:30,830 --> 00:51:33,589
point and if everybody else wants to do

1329
00:51:33,589 --> 00:51:35,420
that feel free visualizations not really

1330
00:51:35,420 --> 00:51:35,920
my thing

1331
00:51:35,920 --> 00:51:39,589
so this is not a perfect solution but

1332
00:51:39,589 --> 00:51:42,500
it's the solution that I came up with it

1333
00:51:42,500 --> 00:51:45,109
needs a lot of testing Jesus needs a lot

1334
00:51:45,109 --> 00:51:47,089
of testing it's certainly not pretty it

1335
00:51:47,089 --> 00:51:48,710
doesn't work well for screenshots on

1336
00:51:48,710 --> 00:51:50,540
here it doesn't work well on laptop

1337
00:51:50,540 --> 00:51:52,880
sized screens just because the amount of

1338
00:51:52,880 --> 00:51:54,710
data that's being outputted to the

1339
00:51:54,710 --> 00:51:57,890
screen it's not fast and it only works

1340
00:51:57,890 --> 00:52:00,190
on sequel databases fortunately for me

1341
00:52:00,190 --> 00:52:02,839
Mac and mobile devices are all sequel

1342
00:52:02,839 --> 00:52:04,040
eight databases for the

1343
00:52:04,040 --> 00:52:06,230
most part so I am not I'm not capturing

1344
00:52:06,230 --> 00:52:07,820
some of the other data pieces in there

1345
00:52:07,820 --> 00:52:10,610
so I can't automate everything but I can

1346
00:52:10,610 --> 00:52:12,650
automate a big piece of what I have to

1347
00:52:12,650 --> 00:52:15,800
go through and then finally mode a demo

1348
00:52:15,800 --> 00:52:18,260
problems when I'm looking at some of

1349
00:52:18,260 --> 00:52:20,180
this there's I think a million and a

1350
00:52:20,180 --> 00:52:23,090
half entries in my particular data set

1351
00:52:23,090 --> 00:52:25,190
that's a lot of stuff to go through no

1352
00:52:25,190 --> 00:52:27,350
forensic analyst is going to scroll

1353
00:52:27,350 --> 00:52:28,430
through that they're gonna start

1354
00:52:28,430 --> 00:52:32,480
filtering so I put a bunch of sequel

1355
00:52:32,480 --> 00:52:35,690
databases into a sequel database which

1356
00:52:35,690 --> 00:52:38,030
maybe not makes the most sense but it's

1357
00:52:38,030 --> 00:52:39,470
the most efficient way that I come up

1358
00:52:39,470 --> 00:52:41,450
with so now I can rate additional

1359
00:52:41,450 --> 00:52:42,680
queries to kind of filter this

1360
00:52:42,680 --> 00:52:44,810
information or look through a time scope

1361
00:52:44,810 --> 00:52:47,360
so some event happened on this day what

1362
00:52:47,360 --> 00:52:49,010
are those actions so I'm not gonna go

1363
00:52:49,010 --> 00:52:51,260
through the whole host of different data

1364
00:52:51,260 --> 00:52:53,060
or I'm looking for activity for a

1365
00:52:53,060 --> 00:52:55,010
certain app I can filter on a bundle ID

1366
00:52:55,010 --> 00:52:57,170
fortunately Apple does is pretty

1367
00:52:57,170 --> 00:52:59,210
consistent on looking at application

1368
00:52:59,210 --> 00:53:00,950
names or a bundle IDs so I can find

1369
00:53:00,950 --> 00:53:03,470
every single time I open Twitter on my

1370
00:53:03,470 --> 00:53:05,870
particular device and finally time

1371
00:53:05,870 --> 00:53:08,840
stamps I actually fixed a time stamp at

1372
00:53:08,840 --> 00:53:10,310
3:30 this morning because I was up

1373
00:53:10,310 --> 00:53:12,290
because in my mind that's 9:30 on the

1374
00:53:12,290 --> 00:53:14,750
East Coast so you'll notice a lot of my

1375
00:53:14,750 --> 00:53:16,780
queries have this weird date and time

1376
00:53:16,780 --> 00:53:19,760
format it's actually wrong so I'm gonna

1377
00:53:19,760 --> 00:53:21,890
clean up this presentation rescreen shot

1378
00:53:21,890 --> 00:53:23,570
a lot of that because I was getting

1379
00:53:23,570 --> 00:53:25,490
everything off by 4 hours like what is

1380
00:53:25,490 --> 00:53:27,200
going on here is it my laptop time

1381
00:53:27,200 --> 00:53:28,790
that's off I was trying to figure that

1382
00:53:28,790 --> 00:53:31,100
out and I figured it out at 3:30 this

1383
00:53:31,100 --> 00:53:33,980
morning wide awake so I fixed that I've

1384
00:53:33,980 --> 00:53:35,810
changed a lot of the modules for it and

1385
00:53:35,810 --> 00:53:37,880
I've decided to out put everything into

1386
00:53:37,880 --> 00:53:40,040
UTC because it makes the most sense

1387
00:53:40,040 --> 00:53:41,990
so taking everything from UTC if you

1388
00:53:41,990 --> 00:53:43,400
want to bring it into local time on your

1389
00:53:43,400 --> 00:53:44,570
own systems to do a little bit better

1390
00:53:44,570 --> 00:53:47,180
analysis you can certainly do that as

1391
00:53:47,180 --> 00:53:49,130
well so I can always have that time

1392
00:53:49,130 --> 00:53:51,710
stamp fight at the bar a little bit

1393
00:53:51,710 --> 00:53:55,850
later on but UTC or gtfo so thank you I

1394
00:53:55,850 --> 00:53:57,320
hope that wasn't too much data for

1395
00:53:57,320 --> 00:53:59,180
everybody I hope I didn't scare anybody

1396
00:53:59,180 --> 00:54:00,400
actually I do hope I scared everybody

1397
00:54:00,400 --> 00:54:02,420
it's kind of what I'm known for

1398
00:54:02,420 --> 00:54:04,460
and if anybody would like to deposit

1399
00:54:04,460 --> 00:54:07,490
their iOS devices or Mac devices into my

1400
00:54:07,490 --> 00:54:09,950
testing purposes I will gladly take that

1401
00:54:09,950 --> 00:54:12,610
I always I'm looking for realistic data

1402
00:54:12,610 --> 00:54:14,510
so hopefully it'll be released

1403
00:54:14,510 --> 00:54:16,310
eventually I'm gonna hang out at the

1404
00:54:16,310 --> 00:54:17,450
pool for a little bit

1405
00:54:17,450 --> 00:54:19,609
and do try to do absolutely nothing and

1406
00:54:19,609 --> 00:54:21,470
then I have a really long flight to

1407
00:54:21,470 --> 00:54:23,660
Sydney right after this so that's 15

1408
00:54:23,660 --> 00:54:25,400
hours I think I could clean up the code

1409
00:54:25,400 --> 00:54:26,299
and then release it

1410
00:54:26,299 --> 00:54:29,329
hopefully that next week if you want to

1411
00:54:29,329 --> 00:54:31,089
contact me you can find me on Twitter

1412
00:54:31,089 --> 00:54:33,170
certainly the easiest way is to find men

1413
00:54:33,170 --> 00:54:34,579
Twitter you can email me too but I won't

1414
00:54:34,579 --> 00:54:36,890
respond usually I'm really bad at that

1415
00:54:36,890 --> 00:54:38,900
or you can find me on my website Mac

1416
00:54:38,900 --> 00:54:41,809
forensics comm and if you like looking

1417
00:54:41,809 --> 00:54:44,329
at math data take a class with me I'm

1418
00:54:44,329 --> 00:54:46,220
teaching in a bunch of places all over

1419
00:54:46,220 --> 00:54:49,280
the world I actually have a few students

1420
00:54:49,280 --> 00:54:50,990
old students here quite a few more than

1421
00:54:50,990 --> 00:54:53,329
I expected to see so it's good to see

1422
00:54:53,329 --> 00:54:55,160
everybody here and hang out we can talk

1423
00:54:55,160 --> 00:54:56,839
Mac stuff because I love it

1424
00:54:56,839 --> 00:54:59,089
I hope it came across it I love it it's

1425
00:54:59,089 --> 00:55:01,130
truly my life so thank you very much

1426
00:55:01,130 --> 00:55:03,940
questions

1427
00:55:09,910 --> 00:55:13,910
and don't use my hdmi adapter apparently

1428
00:55:13,910 --> 00:55:17,559
was good for everything except this

1429
00:55:17,559 --> 00:55:21,880
questions yeah

1430
00:55:30,610 --> 00:55:32,830
so the question is have I seen any

1431
00:55:32,830 --> 00:55:36,220
threat actors or assuming like anybody

1432
00:55:36,220 --> 00:55:38,110
trying to change the logs to make it

1433
00:55:38,110 --> 00:55:39,490
look like they're not doing something so

1434
00:55:39,490 --> 00:55:40,690
it could be the user themselves or

1435
00:55:40,690 --> 00:55:42,940
threat actors or whomever it's not

1436
00:55:42,940 --> 00:55:44,020
something that I've actually looked at

1437
00:55:44,020 --> 00:55:46,930
as to be perfectly honest with you my

1438
00:55:46,930 --> 00:55:48,550
guess is that because there are sequel

1439
00:55:48,550 --> 00:55:50,500
databases you could go in there you

1440
00:55:50,500 --> 00:55:51,520
could actually go ahead and delete

1441
00:55:51,520 --> 00:55:54,430
entries I'm not sure what that would

1442
00:55:54,430 --> 00:55:56,190
look like from a forensics perspective

1443
00:55:56,190 --> 00:55:58,840
certainly worth taking a closer look at

1444
00:55:58,840 --> 00:56:01,240
and giving it a try but a lot of the

1445
00:56:01,240 --> 00:56:03,610
times this is where the kind of sequel

1446
00:56:03,610 --> 00:56:05,050
like database comes into play is where

1447
00:56:05,050 --> 00:56:07,180
you can extract those records from

1448
00:56:07,180 --> 00:56:09,130
within the deleted pages of the sequel

1449
00:56:09,130 --> 00:56:13,450
Lite database so if something kind of

1450
00:56:13,450 --> 00:56:15,190
hinted at that hey this something was

1451
00:56:15,190 --> 00:56:16,690
cleaned up here or something is weird

1452
00:56:16,690 --> 00:56:18,280
that's the only reason I would start

1453
00:56:18,280 --> 00:56:20,110
doing sequel at forensics or if I see a

1454
00:56:20,110 --> 00:56:21,730
certain string or something like that to

1455
00:56:21,730 --> 00:56:23,380
do that otherwise I'm already dealing

1456
00:56:23,380 --> 00:56:25,360
with a whole host of data I can't do

1457
00:56:25,360 --> 00:56:27,070
sequel Lite based forensics for every

1458
00:56:27,070 --> 00:56:28,120
single database because it is

1459
00:56:28,120 --> 00:56:30,760
particularly hard Sanderson has of

1460
00:56:30,760 --> 00:56:32,560
course a somewhat automated tool that I

1461
00:56:32,560 --> 00:56:34,240
hear really good things about but from

1462
00:56:34,240 --> 00:56:35,950
my perspective it's gonna take some time

1463
00:56:35,950 --> 00:56:38,110
to actually to get that done so it's not

1464
00:56:38,110 --> 00:56:42,160
something I've actually looked into you

1465
00:56:42,160 --> 00:56:43,960
need okay so he says you needed an

1466
00:56:43,960 --> 00:56:45,490
entitlement to go ahead and delete

1467
00:56:45,490 --> 00:56:50,380
things from the system yeah yeah yeah I

1468
00:56:50,380 --> 00:56:51,910
figured you need some sort of privileges

1469
00:56:51,910 --> 00:56:56,730
to do that yes

1470
00:57:02,890 --> 00:57:04,010
meters-per-second

1471
00:57:04,010 --> 00:57:06,650
okay do not try that one so core

1472
00:57:06,650 --> 00:57:09,350
location core location and speeds are

1473
00:57:09,350 --> 00:57:11,300
meters per second that is very good to

1474
00:57:11,300 --> 00:57:14,060
know thank you sir I know it seemed too

1475
00:57:14,060 --> 00:57:16,060
small I was certainly not driving slow

1476
00:57:16,060 --> 00:57:27,290
no I'm an efficient driver oh that

1477
00:57:27,290 --> 00:57:29,240
depends okay so the question was have I

1478
00:57:29,240 --> 00:57:31,930
ever encountered a jailbroken device

1479
00:57:31,930 --> 00:57:35,690
through investigations so the stuff that

1480
00:57:35,690 --> 00:57:38,060
I do for work is not I'm not getting

1481
00:57:38,060 --> 00:57:40,520
devices in I'm not getting that so from

1482
00:57:40,520 --> 00:57:42,470
all my students that I've talked to yeah

1483
00:57:42,470 --> 00:57:43,850
some of them do get jailbroken devices

1484
00:57:43,850 --> 00:57:46,040
some of them do not so it is fairly rare

1485
00:57:46,040 --> 00:57:49,010
from what I've kind of come across but

1486
00:57:49,010 --> 00:57:49,910
it certainly is something to be

1487
00:57:49,910 --> 00:57:51,110
concerned about it actually could

1488
00:57:51,110 --> 00:57:52,610
actually save you quite a lot of work

1489
00:57:52,610 --> 00:57:53,960
from a forensics perspective you don't

1490
00:57:53,960 --> 00:57:55,610
the jailbreak it yourself and you can

1491
00:57:55,610 --> 00:57:57,650
just get in there with any luck they

1492
00:57:57,650 --> 00:57:59,300
didn't change the Alpine password so

1493
00:57:59,300 --> 00:58:02,390
boom in so it's actually could be a

1494
00:58:02,390 --> 00:58:05,030
benefit as well but that also means they

1495
00:58:05,030 --> 00:58:06,590
could have gone in themselves and

1496
00:58:06,590 --> 00:58:08,720
changed things and done stuff and done

1497
00:58:08,720 --> 00:58:11,620
whatever the heck they wanted right so

1498
00:58:11,620 --> 00:58:15,220
any other questions yeah

1499
00:58:22,740 --> 00:58:25,269
so question is how do you deal with

1500
00:58:25,269 --> 00:58:29,920
nskeyedarchiver P lists suck it up

1501
00:58:29,920 --> 00:58:32,140
nskeyedarchiver P lists are the main of

1502
00:58:32,140 --> 00:58:34,509
my forensic existence so it's the

1503
00:58:34,509 --> 00:58:37,349
serialized version of the binary P list

1504
00:58:37,349 --> 00:58:40,029
not super analyst friendly you kind of

1505
00:58:40,029 --> 00:58:41,259
have to parse them I have a whole blog

1506
00:58:41,259 --> 00:58:43,869
on how to parse these things and for the

1507
00:58:43,869 --> 00:58:45,759
most part it's a manual process unless a

1508
00:58:45,759 --> 00:58:47,740
lot of the tools have automatically done

1509
00:58:47,740 --> 00:58:51,660
that I haven't seen any scripts or yeah

1510
00:58:51,660 --> 00:58:54,130
yeah so I haven't seen anything come out

1511
00:58:54,130 --> 00:58:55,599
from a forensics perspective on how to

1512
00:58:55,599 --> 00:58:57,609
pull those out but I've not looked into

1513
00:58:57,609 --> 00:59:03,009
it but yeah yeah asta has been

1514
00:59:03,009 --> 00:59:04,569
objective-c developer to make it as cute

1515
00:59:04,569 --> 00:59:10,630
archiver plist parser yeah yeah there's

1516
00:59:10,630 --> 00:59:12,039
some of the Python scripts that I have

1517
00:59:12,039 --> 00:59:13,839
played around with don't work for all of

1518
00:59:13,839 --> 00:59:15,490
them though so I've seen a few of them

1519
00:59:15,490 --> 00:59:23,038
be broken yeah

1520
00:59:25,250 --> 00:59:32,910
Yeah right yeah I usually go in there

1521
00:59:32,910 --> 00:59:34,200
and manually take a look at it

1522
00:59:34,200 --> 00:59:35,519
you could write a script for each one

1523
00:59:35,519 --> 00:59:37,259
but each one is a little bit different

1524
00:59:37,259 --> 00:59:39,000
so there's got to be a better method to

1525
00:59:39,000 --> 00:59:48,809
do that I would think that's way too

1526
00:59:48,809 --> 00:59:50,940
smart so the question was does Apollo

1527
00:59:50,940 --> 00:59:53,849
have any any intelligence on whether it

1528
00:59:53,849 --> 00:59:55,230
could figure out what version of the iOS

1529
00:59:55,230 --> 00:59:58,140
or Mac OS it's using and it does not I'm

1530
00:59:58,140 --> 00:59:59,789
not I'm not kidding when I say it's dumb

1531
00:59:59,789 --> 01:00:07,500
it's seriously dumb I'm sure I could put

1532
01:00:07,500 --> 01:00:08,880
a lot more analysis into that to make it

1533
01:00:08,880 --> 01:00:10,799
a lot smarter but I want to do a proof

1534
01:00:10,799 --> 01:00:11,940
of concept to make sure that I could

1535
01:00:11,940 --> 01:00:14,099
actually use the data that's the next

1536
01:00:14,099 --> 01:00:20,519
step the next few steps for sure well

1537
01:00:20,519 --> 01:00:21,569
thank you very much and I hope you all

1538
01:00:21,569 --> 01:00:24,019
have a good lunch

1539
01:00:28,610 --> 01:00:31,200
awesome Thank You Sara that was a really

1540
01:00:31,200 --> 01:00:33,840
excellent talk I'm kind of paranoid to

1541
01:00:33,840 --> 01:00:35,670
even stand this close to with my phone

1542
01:00:35,670 --> 01:00:38,160
in my pocket so keep your phones away

1543
01:00:38,160 --> 01:00:41,070
okay this is Sara we were going to have

1544
01:00:41,070 --> 01:00:42,240
a lunch break now there's a bunch of

1545
01:00:42,240 --> 01:00:44,100
restaurants in the hotel places to grab

1546
01:00:44,100 --> 01:00:45,480
snacks there's a mall right next door

1547
01:00:45,480 --> 01:00:47,490
that has some options as well we will be

1548
01:00:47,490 --> 01:00:50,880
back at 1:00 p.m. for Ritchie's talk so

1549
01:00:50,880 --> 01:00:52,860
I know that's not the most amount of

1550
01:00:52,860 --> 01:00:55,040
time so try not to be late

1551
01:00:55,040 --> 01:00:58,250
enjoy lunch

