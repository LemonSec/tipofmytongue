1
00:00:00,659 --> 00:00:03,559
bye

2
00:00:08,000 --> 00:00:11,280
my name is Kat self I work for miter for

3
00:00:11,280 --> 00:00:12,240
those of you that have heard of attack

4
00:00:12,240 --> 00:00:14,340
who has heard of attack in here

5
00:00:14,340 --> 00:00:16,619
ah that makes my heart happy thank you

6
00:00:16,619 --> 00:00:19,440
all right so a little bit about me

7
00:00:19,440 --> 00:00:21,720
I used to be a former artist that

8
00:00:21,720 --> 00:00:23,400
obviously did really well

9
00:00:23,400 --> 00:00:24,660
I'm here

10
00:00:24,660 --> 00:00:27,180
so um now I basically just find

11
00:00:27,180 --> 00:00:28,859
Opportunities to present where I can

12
00:00:28,859 --> 00:00:31,140
support other artists so a lot of the

13
00:00:31,140 --> 00:00:32,340
artwork that you'll see in this

14
00:00:32,340 --> 00:00:34,380
presentation is going to be by Miss

15
00:00:34,380 --> 00:00:37,020
grants Chris Fleming specifically is the

16
00:00:37,020 --> 00:00:38,880
artist so definitely give props to him I

17
00:00:38,880 --> 00:00:41,640
already sent a tweet out to them but I

18
00:00:41,640 --> 00:00:43,620
also have been I'm Military Intelligence

19
00:00:43,620 --> 00:00:46,500
veteran even though it's an oxymoron I

20
00:00:46,500 --> 00:00:47,640
was able to get a computer science

21
00:00:47,640 --> 00:00:48,920
degree after I got out of the military

22
00:00:48,920 --> 00:00:51,660
went and hired on a Target where I was

23
00:00:51,660 --> 00:00:53,219
able to learn how to be an internal red

24
00:00:53,219 --> 00:00:55,559
teamer threat Hunter and software

25
00:00:55,559 --> 00:00:57,360
developer and now I get the great

26
00:00:57,360 --> 00:00:59,699
opportunity to be at attack where I am

27
00:00:59,699 --> 00:01:01,739
the Mac OS lead and for those of you

28
00:01:01,739 --> 00:01:04,199
that are part of the vendor stack and

29
00:01:04,199 --> 00:01:06,180
have gone through the painful process of

30
00:01:06,180 --> 00:01:08,100
attack evaluate or yeah Tech evaluations

31
00:01:08,100 --> 00:01:09,720
I'm the person you get to blame for the

32
00:01:09,720 --> 00:01:11,640
adversaries

33
00:01:11,640 --> 00:01:13,560
um and so yeah a little bit about me

34
00:01:13,560 --> 00:01:15,180
so what we're going to cover um I really

35
00:01:15,180 --> 00:01:16,619
wanted to make this accessible for you

36
00:01:16,619 --> 00:01:19,200
all last year Adam Pennington and I had

37
00:01:19,200 --> 00:01:20,759
did a talk on Attack where it was the

38
00:01:20,759 --> 00:01:22,200
different ways to use attack whether

39
00:01:22,200 --> 00:01:23,700
you're a Defender whether you're

40
00:01:23,700 --> 00:01:25,080
apparently an adversary that was

41
00:01:25,080 --> 00:01:27,240
discovered in a leak that they're using

42
00:01:27,240 --> 00:01:29,880
a tattoo or you're an actual like red

43
00:01:29,880 --> 00:01:31,920
teamer that wants to do true adversary

44
00:01:31,920 --> 00:01:34,200
emulation so this talk what I'm going to

45
00:01:34,200 --> 00:01:35,880
kind of try to cover is a fun analogy

46
00:01:35,880 --> 00:01:37,560
kind of at a high level to procedure

47
00:01:37,560 --> 00:01:40,380
level on different ways to kind of use

48
00:01:40,380 --> 00:01:42,240
attack or like find those techniques in

49
00:01:42,240 --> 00:01:43,920
the wild most of the techniques that

50
00:01:43,920 --> 00:01:45,299
we're going to be talking about are ones

51
00:01:45,299 --> 00:01:50,420
that I just updated so thank you to opts

52
00:01:50,700 --> 00:01:52,619
um basically a lot of the community here

53
00:01:52,619 --> 00:01:54,420
has really been incredibly supportive

54
00:01:54,420 --> 00:01:56,820
and you guys can definitely like Pat

55
00:01:56,820 --> 00:01:59,159
yourselves on the back because attack is

56
00:01:59,159 --> 00:02:00,780
for sure better as a result of you all

57
00:02:00,780 --> 00:02:02,220
all the researchers in this room we have

58
00:02:02,220 --> 00:02:03,540
a lot of Twitter and slack conversations

59
00:02:03,540 --> 00:02:05,159
you guys review a lot of these

60
00:02:05,159 --> 00:02:06,960
techniques some of you in here are like

61
00:02:06,960 --> 00:02:08,818
going to see these draft States

62
00:02:08,818 --> 00:02:11,340
um disclaimer the names of these

63
00:02:11,340 --> 00:02:13,560
techniques some of these at the end they

64
00:02:13,560 --> 00:02:15,420
might change because they are in draft

65
00:02:15,420 --> 00:02:16,739
State we'll be releasing them on the

66
00:02:16,739 --> 00:02:18,120
25th of this month

67
00:02:18,120 --> 00:02:21,360
so what is attack for the three hands

68
00:02:21,360 --> 00:02:24,060
that did not raise their hand attack is

69
00:02:24,060 --> 00:02:26,940
an open source common knowledge base

70
00:02:26,940 --> 00:02:29,520
it's based on real world right so only

71
00:02:29,520 --> 00:02:31,620
when an adversary has not only done it

72
00:02:31,620 --> 00:02:33,599
but it has been published now to give

73
00:02:33,599 --> 00:02:34,980
you guys an idea of that timeline when

74
00:02:34,980 --> 00:02:36,420
something is done in the wild like we're

75
00:02:36,420 --> 00:02:37,620
talking about a lot of these exploits

76
00:02:37,620 --> 00:02:39,840
the timeline between when that export is

77
00:02:39,840 --> 00:02:41,879
actually used in the Wild versus when

78
00:02:41,879 --> 00:02:44,760
that exploit is then reported by a

79
00:02:44,760 --> 00:02:47,580
company in a published report like that

80
00:02:47,580 --> 00:02:49,680
everyone can access is a pretty good

81
00:02:49,680 --> 00:02:51,360
amount of time most companies have a

82
00:02:51,360 --> 00:02:53,040
policy where they don't really report

83
00:02:53,040 --> 00:02:54,900
anything in as far as Behavior sort of

84
00:02:54,900 --> 00:02:56,519
adversaries until it's been compromised

85
00:02:56,519 --> 00:02:57,720
by multiple different ones of their

86
00:02:57,720 --> 00:02:58,980
clients so they don't give anything away

87
00:02:58,980 --> 00:03:01,080
so there's a good amount of time so if

88
00:03:01,080 --> 00:03:03,840
it's in attack you should for sure care

89
00:03:03,840 --> 00:03:06,120
about it another big portion of attack

90
00:03:06,120 --> 00:03:08,340
is that it's free it's open it's

91
00:03:08,340 --> 00:03:09,959
globally accessible we even try to make

92
00:03:09,959 --> 00:03:12,420
it in a level of the English language

93
00:03:12,420 --> 00:03:15,180
that it's easily translatable but it's

94
00:03:15,180 --> 00:03:16,980
also a Common Language so the way

95
00:03:16,980 --> 00:03:19,680
attacks started was you had a red team

96
00:03:19,680 --> 00:03:20,819
and a blue team and they were like how

97
00:03:20,819 --> 00:03:23,040
do we talk about this how do we have the

98
00:03:23,040 --> 00:03:24,420
same language on these different

99
00:03:24,420 --> 00:03:26,819
techniques like is Spirit like is a

100
00:03:26,819 --> 00:03:28,319
malicious binary the same thing in the

101
00:03:28,319 --> 00:03:30,480
studio me is an embedded payload the

102
00:03:30,480 --> 00:03:31,620
same thing

103
00:03:31,620 --> 00:03:33,180
um or do you just think an embedded

104
00:03:33,180 --> 00:03:35,459
playload is a mock-ofile inside of an

105
00:03:35,459 --> 00:03:37,379
application bundle right so we all have

106
00:03:37,379 --> 00:03:39,000
these different ideas in our head so

107
00:03:39,000 --> 00:03:40,680
it's a Common Language

108
00:03:40,680 --> 00:03:43,260
it's also Community Driven so

109
00:03:43,260 --> 00:03:44,819
I'm going to go through this super fast

110
00:03:44,819 --> 00:03:47,459
since I already did this last year but

111
00:03:47,459 --> 00:03:50,760
to level set procedure or so tactics in

112
00:03:50,760 --> 00:03:52,620
attack I took this off of the Navigator

113
00:03:52,620 --> 00:03:54,360
it has this great picture option in the

114
00:03:54,360 --> 00:03:55,620
Navigator so for those of you that hate

115
00:03:55,620 --> 00:03:56,819
the eye chart

116
00:03:56,819 --> 00:03:59,519
use the camera option on the Navigator

117
00:03:59,519 --> 00:04:01,319
but these are the tactics right like

118
00:04:01,319 --> 00:04:03,540
this is the overall goal is I want to go

119
00:04:03,540 --> 00:04:05,760
to a burger right or go grab a burger to

120
00:04:05,760 --> 00:04:07,500
eat like that mean that that is my

121
00:04:07,500 --> 00:04:09,000
ultimate goal right I want to move

122
00:04:09,000 --> 00:04:11,519
laterally ultimate goal um the way in

123
00:04:11,519 --> 00:04:13,379
which I do that is going to be the

124
00:04:13,379 --> 00:04:15,599
technique do I take a car do I walk what

125
00:04:15,599 --> 00:04:17,160
does that look like

126
00:04:17,160 --> 00:04:18,540
um and then when you get down to the sub

127
00:04:18,540 --> 00:04:19,738
technique in this case we're talking

128
00:04:19,738 --> 00:04:20,579
about

129
00:04:20,579 --> 00:04:23,160
an auto start right at login

130
00:04:23,160 --> 00:04:24,600
um the sub technique is going to be like

131
00:04:24,600 --> 00:04:26,100
login items

132
00:04:26,100 --> 00:04:28,560
um and that'll be like I took this route

133
00:04:28,560 --> 00:04:30,780
and that is how I got there

134
00:04:30,780 --> 00:04:31,979
um just kind of give you a really high

135
00:04:31,979 --> 00:04:34,680
level overview of what that means so the

136
00:04:34,680 --> 00:04:36,540
way this translates to procedure

137
00:04:36,540 --> 00:04:39,000
examples is thank you obts last year

138
00:04:39,000 --> 00:04:40,919
they went over green Lambert Runa and

139
00:04:40,919 --> 00:04:43,020
Patrick did which then made it into

140
00:04:43,020 --> 00:04:46,080
attack just a couple months later and so

141
00:04:46,080 --> 00:04:47,160
those procedures are going to be like

142
00:04:47,160 --> 00:04:48,479
okay this is the way in which they did

143
00:04:48,479 --> 00:04:50,400
this this is the software so that's kind

144
00:04:50,400 --> 00:04:52,860
of where we'll be today now

145
00:04:52,860 --> 00:04:54,600
come the artwork

146
00:04:54,600 --> 00:04:56,460
um the kind of premise of this this

147
00:04:56,460 --> 00:04:58,080
comic book story that came up for you

148
00:04:58,080 --> 00:05:01,680
guys with is basically you have pandas

149
00:05:01,680 --> 00:05:03,720
General adversary then you have the Mac

150
00:05:03,720 --> 00:05:05,280
OS operating system and the servers

151
00:05:05,280 --> 00:05:06,780
that's going to be your kung fu Masters

152
00:05:06,780 --> 00:05:08,759
and then you have the unicorn and just

153
00:05:08,759 --> 00:05:10,139
like in Harry Potter it's going to be

154
00:05:10,139 --> 00:05:12,780
your pure app that's not malicious and

155
00:05:12,780 --> 00:05:14,520
then you have your helper demons right

156
00:05:14,520 --> 00:05:15,479
so

157
00:05:15,479 --> 00:05:17,460
just to set the premise the overall

158
00:05:17,460 --> 00:05:19,259
story is basically like panda is going

159
00:05:19,259 --> 00:05:21,840
to try to take the Jade tally for those

160
00:05:21,840 --> 00:05:23,280
of you that don't know and are not super

161
00:05:23,280 --> 00:05:25,259
into kung fu movies like I am it's okay

162
00:05:25,259 --> 00:05:27,720
there's still hope for you but

163
00:05:27,720 --> 00:05:30,000
the tallies are kind of like think about

164
00:05:30,000 --> 00:05:32,400
it like as a certificate right like if

165
00:05:32,400 --> 00:05:34,080
you have that you can then have all the

166
00:05:34,080 --> 00:05:37,020
power to do all the things so the panda

167
00:05:37,020 --> 00:05:38,639
wants to tally

168
00:05:38,639 --> 00:05:40,500
so there was a conversation on Twitter

169
00:05:40,500 --> 00:05:42,360
and I want to like I'm calling this out

170
00:05:42,360 --> 00:05:43,860
because I want you guys to know that we

171
00:05:43,860 --> 00:05:45,960
do listen all right if you guys tweeted

172
00:05:45,960 --> 00:05:48,780
us we probably will respond

173
00:05:48,780 --> 00:05:51,060
um so please be kind because nothing but

174
00:05:51,060 --> 00:05:52,199
love here

175
00:05:52,199 --> 00:05:53,940
um but also it's gonna spark other

176
00:05:53,940 --> 00:05:55,979
questions so

177
00:05:55,979 --> 00:05:57,900
um the question was basically JBL was

178
00:05:57,900 --> 00:05:58,800
like

179
00:05:58,800 --> 00:06:01,560
gatekeeper bypass is not file quarantine

180
00:06:01,560 --> 00:06:03,960
like why are you going over this and I

181
00:06:03,960 --> 00:06:06,360
was like oh you might be right let me

182
00:06:06,360 --> 00:06:08,340
look deeper into it so we've already

183
00:06:08,340 --> 00:06:09,660
talked a little bit about gatekeeper

184
00:06:09,660 --> 00:06:10,740
right

185
00:06:10,740 --> 00:06:12,120
um so let's look at the way gatekeeper

186
00:06:12,120 --> 00:06:13,740
is supposed to work

187
00:06:13,740 --> 00:06:15,300
so you have your your pure little

188
00:06:15,300 --> 00:06:17,699
unicorn goes to the gate right

189
00:06:17,699 --> 00:06:19,979
Drunken Monkey Master checks the

190
00:06:19,979 --> 00:06:21,539
attribute right do you have your

191
00:06:21,539 --> 00:06:23,220
attribute great you have your attribute

192
00:06:23,220 --> 00:06:24,720
now we're going to go into code signing

193
00:06:24,720 --> 00:06:26,039
like let's look in the saddlebags like

194
00:06:26,039 --> 00:06:27,720
make sure your entitlements are correct

195
00:06:27,720 --> 00:06:29,280
let's go and make sure you have your

196
00:06:29,280 --> 00:06:31,860
developer ID

197
00:06:31,860 --> 00:06:33,120
et cetera et cetera

198
00:06:33,120 --> 00:06:34,020
and then we're gonna go through

199
00:06:34,020 --> 00:06:35,400
notarization and that's essentially

200
00:06:35,400 --> 00:06:37,919
where it uses the Apple API Cloud kit

201
00:06:37,919 --> 00:06:40,020
it's going to call phone home it's gonna

202
00:06:40,020 --> 00:06:41,520
be like hey are you notarized and if it

203
00:06:41,520 --> 00:06:42,780
doesn't have a ticket it's going to

204
00:06:42,780 --> 00:06:44,600
download one off the Apple servers right

205
00:06:44,600 --> 00:06:47,940
then you have expertise X protect is not

206
00:06:47,940 --> 00:06:50,759
a part of gatekeeper but it does happen

207
00:06:50,759 --> 00:06:53,160
inside of the static analysis process

208
00:06:53,160 --> 00:06:54,479
and that's essentially just a bunch of

209
00:06:54,479 --> 00:06:56,340
Jar signatures right do you look like a

210
00:06:56,340 --> 00:06:58,020
panda yes or no

211
00:06:58,020 --> 00:07:00,240
so and then

212
00:07:00,240 --> 00:07:03,120
good to go right so um below this

213
00:07:03,120 --> 00:07:05,280
there's going to be your quarantine

214
00:07:05,280 --> 00:07:08,400
process or to all of the references a

215
00:07:08,400 --> 00:07:10,560
huge thank you to Howard Oakley because

216
00:07:10,560 --> 00:07:12,120
I think he's probably one of the most

217
00:07:12,120 --> 00:07:14,340
well-documented blogs that I've found as

218
00:07:14,340 --> 00:07:16,259
far as the eclectic light company where

219
00:07:16,259 --> 00:07:18,720
it actually does legitimate breakdowns

220
00:07:18,720 --> 00:07:21,479
of what happens upon execution for

221
00:07:21,479 --> 00:07:22,979
gatekeeper then also what happens as far

222
00:07:22,979 --> 00:07:25,500
as notarization what checks are actually

223
00:07:25,500 --> 00:07:29,099
done on execution for code signing I

224
00:07:29,099 --> 00:07:30,360
mean he's got some really great decision

225
00:07:30,360 --> 00:07:32,220
flow charts there those are all actually

226
00:07:32,220 --> 00:07:33,360
linked in these links and I'll

227
00:07:33,360 --> 00:07:35,880
definitely release the slides afterwards

228
00:07:35,880 --> 00:07:39,000
so we looked at our file quarantine this

229
00:07:39,000 --> 00:07:40,380
is essentially the only process that

230
00:07:40,380 --> 00:07:42,479
we've really had covered in gatekeeper

231
00:07:42,479 --> 00:07:44,599
and so we're like we should probably

232
00:07:44,599 --> 00:07:48,479
probably update that so now we have a

233
00:07:48,479 --> 00:07:50,160
much more focus on components so we kind

234
00:07:50,160 --> 00:07:51,900
of went and re-routed that right where

235
00:07:51,900 --> 00:07:54,000
it's much more of an ordered list the

236
00:07:54,000 --> 00:07:55,380
reason why this is significant right

237
00:07:55,380 --> 00:07:57,120
just because as we love our community

238
00:07:57,120 --> 00:08:00,780
engagement but we started as

239
00:08:00,780 --> 00:08:03,060
when you're maintaining attack the

240
00:08:03,060 --> 00:08:04,740
difference of perspective is what is the

241
00:08:04,740 --> 00:08:06,720
attacker really trying to do like what

242
00:08:06,720 --> 00:08:09,120
will live past Apple's random updates

243
00:08:09,120 --> 00:08:11,340
and Hardware changes right to where we

244
00:08:11,340 --> 00:08:12,840
can keep talking the same language and

245
00:08:12,840 --> 00:08:13,800
we're not having to update the

246
00:08:13,800 --> 00:08:15,240
dictionary changing words all the time

247
00:08:15,240 --> 00:08:16,440
because then it's then it becomes

248
00:08:16,440 --> 00:08:19,259
useless and on this one we realized the

249
00:08:19,259 --> 00:08:21,539
adversary is just trying to get it's

250
00:08:21,539 --> 00:08:23,400
just trying to bypass Gatekeepers so we

251
00:08:23,400 --> 00:08:25,199
kind of put it all together

252
00:08:25,199 --> 00:08:26,280
um and then just made a much more

253
00:08:26,280 --> 00:08:28,199
holistic picture of it so as far as

254
00:08:28,199 --> 00:08:30,180
Apple goes would really love it if you

255
00:08:30,180 --> 00:08:31,620
guys actually had a road map of some of

256
00:08:31,620 --> 00:08:33,839
these things that'd be great

257
00:08:33,839 --> 00:08:37,080
um so how do pandas evade this right

258
00:08:37,080 --> 00:08:39,120
uh

259
00:08:39,120 --> 00:08:42,120
I just love the artwork uh so Panda

260
00:08:42,120 --> 00:08:44,159
tries to get in the gate right he's got

261
00:08:44,159 --> 00:08:46,020
the file quarantine attribute right well

262
00:08:46,020 --> 00:08:47,820
if you're ocean Lotus which is not

263
00:08:47,820 --> 00:08:49,140
Chinese but definitely does attack

264
00:08:49,140 --> 00:08:52,140
Chinese they just remove this attribute

265
00:08:52,140 --> 00:08:55,560
and then as far as code signing goes

266
00:08:55,560 --> 00:08:58,260
if you're Slayer you just get your app

267
00:08:58,260 --> 00:09:00,600
signed and notarized that's just how you

268
00:09:00,600 --> 00:09:02,040
bypass it there's also other things

269
00:09:02,040 --> 00:09:03,300
right like you take someone else's

270
00:09:03,300 --> 00:09:05,880
certificates or sorry developer yeah

271
00:09:05,880 --> 00:09:07,260
um but for the most part that's

272
00:09:07,260 --> 00:09:09,660
definitely been like a One-Stop shop

273
00:09:09,660 --> 00:09:10,980
so

274
00:09:10,980 --> 00:09:12,600
then you have your yard checks these are

275
00:09:12,600 --> 00:09:13,560
going to be

276
00:09:13,560 --> 00:09:15,839
um again those jar rules what was

277
00:09:15,839 --> 00:09:18,480
interesting is that Erica who is here

278
00:09:18,480 --> 00:09:21,120
um and Phil both had a report that came

279
00:09:21,120 --> 00:09:24,000
out where they were going over a really

280
00:09:24,000 --> 00:09:26,100
neat method that schlayer used and I

281
00:09:26,100 --> 00:09:28,040
call out schlayer because the reality is

282
00:09:28,040 --> 00:09:31,500
once something gets on to your Mac OS

283
00:09:31,500 --> 00:09:34,680
it's kind of like open field for

284
00:09:34,680 --> 00:09:36,480
whatever else it wants to download right

285
00:09:36,480 --> 00:09:38,220
so a lot of times we see a lot of

286
00:09:38,220 --> 00:09:40,860
novelty and adware which is annoying for

287
00:09:40,860 --> 00:09:42,000
most of us that are looking at the

288
00:09:42,000 --> 00:09:45,120
analysis of it but because it's like the

289
00:09:45,120 --> 00:09:46,380
Gateway

290
00:09:46,380 --> 00:09:48,320
malware

291
00:09:48,320 --> 00:09:50,399
you kind of once you get that execution

292
00:09:50,399 --> 00:09:51,720
you can kind of download whatever you

293
00:09:51,720 --> 00:09:54,060
want it can be a loaded for anything so

294
00:09:54,060 --> 00:09:55,440
for this one specifically we actually

295
00:09:55,440 --> 00:09:57,600
added resource forking resource forking

296
00:09:57,600 --> 00:09:59,339
is actually very old technology for

297
00:09:59,339 --> 00:10:01,200
those of you that don't know it's an

298
00:10:01,200 --> 00:10:03,660
extended attribute we used to put like

299
00:10:03,660 --> 00:10:06,120
thumbnail images in it but you can

300
00:10:06,120 --> 00:10:07,620
actually put whatever you want in it to

301
00:10:07,620 --> 00:10:10,019
include executable code which is what

302
00:10:10,019 --> 00:10:13,200
Slayer did they piped executable code at

303
00:10:13,200 --> 00:10:15,540
the end of inside of our resource work

304
00:10:15,540 --> 00:10:19,140
so then the belief is that it would

305
00:10:19,140 --> 00:10:20,880
bypass signatures

306
00:10:20,880 --> 00:10:23,580
so and your Panda gets through now the

307
00:10:23,580 --> 00:10:25,740
one thing that kind of Trumps all this

308
00:10:25,740 --> 00:10:26,940
um and we did a lot of double checking

309
00:10:26,940 --> 00:10:28,200
so it was really reaffirming when I

310
00:10:28,200 --> 00:10:30,779
heard the presentation earlier uh that

311
00:10:30,779 --> 00:10:31,980
just confirmed this because you get to

312
00:10:31,980 --> 00:10:33,420
this point when you get so down in these

313
00:10:33,420 --> 00:10:34,980
research rabbit holes you're like but

314
00:10:34,980 --> 00:10:37,320
did I miss something did I miss one like

315
00:10:37,320 --> 00:10:39,180
data entry or the database or if it's in

316
00:10:39,180 --> 00:10:40,320
this database if it's not in this

317
00:10:40,320 --> 00:10:43,980
database check and uh turns out one

318
00:10:43,980 --> 00:10:46,200
malware that's really popular

319
00:10:46,200 --> 00:10:49,500
is Essex right it's continued to evolve

320
00:10:49,500 --> 00:10:51,000
but the reason why this is significant

321
00:10:51,000 --> 00:10:53,579
is because once it gains execution which

322
00:10:53,579 --> 00:10:54,899
it usually comes in through a GitHub

323
00:10:54,899 --> 00:10:57,779
project or another method what it does

324
00:10:57,779 --> 00:11:00,899
is it specifically puts its executable

325
00:11:00,899 --> 00:11:03,779
inside of apps that have already run and

326
00:11:03,779 --> 00:11:05,279
the reason why that's significant is

327
00:11:05,279 --> 00:11:06,720
because gatekeeper is a first check

328
00:11:06,720 --> 00:11:08,459
thing and there was actually this whole

329
00:11:08,459 --> 00:11:10,040
Twitter thread actually on how

330
00:11:10,040 --> 00:11:13,440
Gatekeepers great so long as it's never

331
00:11:13,440 --> 00:11:15,300
run before the moment that app is

332
00:11:15,300 --> 00:11:16,860
already run it's already inside of the

333
00:11:16,860 --> 00:11:18,180
database and it doesn't go through a lot

334
00:11:18,180 --> 00:11:20,399
of these checks that we assume that it's

335
00:11:20,399 --> 00:11:22,200
supposed to go to there's a whole lot of

336
00:11:22,200 --> 00:11:24,779
misunderstanding based on our favorite

337
00:11:24,779 --> 00:11:27,240
feature of all companies marketing

338
00:11:27,240 --> 00:11:30,120
so Discovery what does this look like on

339
00:11:30,120 --> 00:11:32,040
Mac OS right so now that our pen is

340
00:11:32,040 --> 00:11:34,980
inside what does Discovery look like

341
00:11:34,980 --> 00:11:35,579
um

342
00:11:35,579 --> 00:11:38,339
Jaren who is fantastic uh released one

343
00:11:38,339 --> 00:11:41,279
of his old talks and he put it back in a

344
00:11:41,279 --> 00:11:43,079
blog format so we could actually cited

345
00:11:43,079 --> 00:11:44,160
an attack

346
00:11:44,160 --> 00:11:47,160
thank you where it was Mac back doored

347
00:11:47,160 --> 00:11:48,959
and it really specifically went over

348
00:11:48,959 --> 00:11:51,180
bonjour right so bonjour's this

349
00:11:51,180 --> 00:11:53,240
fantastic zero configuration

350
00:11:53,240 --> 00:11:56,220
that Apple uses what's really nice about

351
00:11:56,220 --> 00:11:58,140
it like if you have AirPlay right your

352
00:11:58,140 --> 00:11:59,880
device just works it just clicks right

353
00:11:59,880 --> 00:12:01,980
like that's the whole point of it and

354
00:12:01,980 --> 00:12:04,560
that is thank you bonjour so the thing

355
00:12:04,560 --> 00:12:05,880
about it though is you can also do a

356
00:12:05,880 --> 00:12:08,579
query if you want to find other Mac os's

357
00:12:08,579 --> 00:12:10,019
that also have those services so think

358
00:12:10,019 --> 00:12:11,820
of it like going up to a board and be

359
00:12:11,820 --> 00:12:13,740
like hey what services are available for

360
00:12:13,740 --> 00:12:15,720
me like and you just kind of see like

361
00:12:15,720 --> 00:12:17,519
all of these guys are here ready for you

362
00:12:17,519 --> 00:12:19,260
if you want them

363
00:12:19,260 --> 00:12:20,940
um so we added that to the network

364
00:12:20,940 --> 00:12:23,700
discovery so if you just do an mdns

365
00:12:23,700 --> 00:12:24,720
query you'll be able to see what

366
00:12:24,720 --> 00:12:25,920
services are available other MAC

367
00:12:25,920 --> 00:12:27,600
machines that are also advertising SSH

368
00:12:27,600 --> 00:12:29,820
or whatever that might be

369
00:12:29,820 --> 00:12:32,579
so but let's say that's not your goal

370
00:12:32,579 --> 00:12:34,140
maybe your goal is not lateral movement

371
00:12:34,140 --> 00:12:36,180
maybe your goal is just to be able to be

372
00:12:36,180 --> 00:12:38,640
like Essex like and you want to find

373
00:12:38,640 --> 00:12:42,060
other other things or dial-up hijacking

374
00:12:42,060 --> 00:12:46,320
um Chris Ross and uh Patrick uh both did

375
00:12:46,320 --> 00:12:49,680
a dial-up hijacker scanner

376
00:12:49,680 --> 00:12:51,360
um I believe that's right

377
00:12:51,360 --> 00:12:53,579
and basically what I was doing was

378
00:12:53,579 --> 00:12:55,019
looking for entitlements right so that

379
00:12:55,019 --> 00:12:57,899
is Discovery and in essence and so

380
00:12:57,899 --> 00:12:59,519
what you do is you essentially send out

381
00:12:59,519 --> 00:13:01,019
a query and then you pull back

382
00:13:01,019 --> 00:13:02,940
information that you want the way that

383
00:13:02,940 --> 00:13:04,740
we that Essex does this is what they're

384
00:13:04,740 --> 00:13:07,260
looking for is very specifically apps

385
00:13:07,260 --> 00:13:09,720
that have sharing TCC permissions

386
00:13:09,720 --> 00:13:11,639
already enabled and so if they have

387
00:13:11,639 --> 00:13:12,720
these permissions already enabled

388
00:13:12,720 --> 00:13:14,220
they're not going to ask again they

389
00:13:14,220 --> 00:13:16,320
already have it so they'll take their

390
00:13:16,320 --> 00:13:18,060
malicious application and drop it in

391
00:13:18,060 --> 00:13:19,440
there and then they'll be able to launch

392
00:13:19,440 --> 00:13:21,060
it without requesting any of these

393
00:13:21,060 --> 00:13:23,579
permissions again

394
00:13:23,579 --> 00:13:27,120
so then it's inside the app

395
00:13:27,120 --> 00:13:28,740
and then there's a whole other story

396
00:13:28,740 --> 00:13:30,899
about taking over demons and assuming

397
00:13:30,899 --> 00:13:32,339
their identity and then getting in the

398
00:13:32,339 --> 00:13:35,459
gate so for Another Story Another

399
00:13:35,459 --> 00:13:37,560
conversation that um I was able to have

400
00:13:37,560 --> 00:13:40,139
throughout this year that obts from last

401
00:13:40,139 --> 00:13:43,260
year kind of brought up was with Brandon

402
00:13:43,260 --> 00:13:45,899
Dalton so we had this like Cedric Owens

403
00:13:45,899 --> 00:13:48,839
uh Patrick and Jaron did a great talk

404
00:13:48,839 --> 00:13:50,040
last year and it was all about

405
00:13:50,040 --> 00:13:52,200
application bundle manipulation and so

406
00:13:52,200 --> 00:13:54,120
we really want to unpack that like how

407
00:13:54,120 --> 00:13:57,300
do we turn what is an exploit into a

408
00:13:57,300 --> 00:13:59,279
repeatable adversary behavior and then

409
00:13:59,279 --> 00:14:01,019
verify that that's been done in the wild

410
00:14:01,019 --> 00:14:02,700
right because that's the power of attack

411
00:14:02,700 --> 00:14:05,399
it's done in the wild like adversaries

412
00:14:05,399 --> 00:14:07,320
are using this so how do we capture this

413
00:14:07,320 --> 00:14:09,000
reframe it so now we can talk about it

414
00:14:09,000 --> 00:14:09,899
clearly

415
00:14:09,899 --> 00:14:12,899
and that was basically from his blog he

416
00:14:12,899 --> 00:14:14,279
did this whole bundle of nerves where he

417
00:14:14,279 --> 00:14:15,720
took a couple of different malwares

418
00:14:15,720 --> 00:14:17,160
analyzed them and then kind of broke

419
00:14:17,160 --> 00:14:18,839
those out into how it's thwarting

420
00:14:18,839 --> 00:14:20,220
different security controls and

421
00:14:20,220 --> 00:14:21,240
mechanisms

422
00:14:21,240 --> 00:14:23,820
and so you have your Panda he wants to

423
00:14:23,820 --> 00:14:27,360
get the Jade tally right so

424
00:14:27,360 --> 00:14:28,740
how does he do this well first he's

425
00:14:28,740 --> 00:14:30,240
going to unpack his other little pandas

426
00:14:30,240 --> 00:14:32,940
AKA threads and they all have their own

427
00:14:32,940 --> 00:14:35,820
tasks so the one technique that we added

428
00:14:35,820 --> 00:14:37,500
was which I was actually shocked it's

429
00:14:37,500 --> 00:14:38,639
almost one of those things when you're

430
00:14:38,639 --> 00:14:40,980
doing this you're like I thought we had

431
00:14:40,980 --> 00:14:42,540
that until you realize you didn't have

432
00:14:42,540 --> 00:14:43,560
that and then you had to go and create

433
00:14:43,560 --> 00:14:44,940
it and they're like okay now we have

434
00:14:44,940 --> 00:14:46,800
that and this is one of those where it's

435
00:14:46,800 --> 00:14:48,899
basically an embedded binary right like

436
00:14:48,899 --> 00:14:50,579
totally thought we had this we did not

437
00:14:50,579 --> 00:14:52,320
have this in attack we do now have this

438
00:14:52,320 --> 00:14:54,899
in attack as of the 25th but these names

439
00:14:54,899 --> 00:14:56,160
might change because we're kind of going

440
00:14:56,160 --> 00:14:58,440
back and forth on like binaries payloads

441
00:14:58,440 --> 00:15:00,360
so

442
00:15:00,360 --> 00:15:02,160
embedded binaries that can be the

443
00:15:02,160 --> 00:15:04,500
resource work that can be beam only

444
00:15:04,500 --> 00:15:07,260
packet at certain different points uh if

445
00:15:07,260 --> 00:15:09,060
you want to talk about stripped payloads

446
00:15:09,060 --> 00:15:10,560
which is where you basically Have Made

447
00:15:10,560 --> 00:15:13,019
It by code that's where you basically

448
00:15:13,019 --> 00:15:15,180
take away any type of understanding what

449
00:15:15,180 --> 00:15:16,620
the functionality or the program logic

450
00:15:16,620 --> 00:15:18,540
of it is so some people have mentioned

451
00:15:18,540 --> 00:15:19,860
like they have a reverse analysis right

452
00:15:19,860 --> 00:15:21,660
where all you get is essentially your

453
00:15:21,660 --> 00:15:23,519
byte code that's it you don't have

454
00:15:23,519 --> 00:15:24,899
nothing that's human readable that would

455
00:15:24,899 --> 00:15:27,540
be a stripped payload so and the reason

456
00:15:27,540 --> 00:15:30,860
why it's significant is because Mac OS

457
00:15:30,860 --> 00:15:33,600
Osa Miner which I know it's a minor but

458
00:15:33,600 --> 00:15:35,279
what's interesting about this one is it

459
00:15:35,279 --> 00:15:39,779
was found I want to say like 2018

460
00:15:39,779 --> 00:15:42,180
um but they actually once they once they

461
00:15:42,180 --> 00:15:43,680
started doing the analysis on it they

462
00:15:43,680 --> 00:15:44,940
actually realized it was in circulation

463
00:15:44,940 --> 00:15:47,639
since 2015. but they weren't even unable

464
00:15:47,639 --> 00:15:49,800
to understand the logic of it until 2020

465
00:15:49,800 --> 00:15:52,320
and the reason was is because they had

466
00:15:52,320 --> 00:15:55,320
the Apple script disassembler but they

467
00:15:55,320 --> 00:15:57,420
didn't have a decompiler to be able to

468
00:15:57,420 --> 00:15:59,699
translate the apple of encodes so what

469
00:15:59,699 --> 00:16:00,779
happens a lot of times are these

470
00:16:00,779 --> 00:16:02,160
scripting languages is if it's a new

471
00:16:02,160 --> 00:16:04,500
scripting language there has to be some

472
00:16:04,500 --> 00:16:06,060
type of like dictionary to be able to

473
00:16:06,060 --> 00:16:07,260
understand what's going on at this lower

474
00:16:07,260 --> 00:16:09,860
level that if it's a brand new scripting

475
00:16:09,860 --> 00:16:12,240
language it's probably not going to have

476
00:16:12,240 --> 00:16:16,139
that for applescript they had the one

477
00:16:16,139 --> 00:16:18,240
part but they didn't have the other and

478
00:16:18,240 --> 00:16:19,380
there's actually a whole lot of Chinese

479
00:16:19,380 --> 00:16:21,240
articles that if you actually read down

480
00:16:21,240 --> 00:16:23,339
they were like yeah we can't analyze

481
00:16:23,339 --> 00:16:24,660
this anymore because they basically made

482
00:16:24,660 --> 00:16:27,060
a run only Apple script and I have no

483
00:16:27,060 --> 00:16:29,699
way to actually do the analysis on this

484
00:16:29,699 --> 00:16:32,160
so the investigation stops here and so

485
00:16:32,160 --> 00:16:34,339
Sentinel Labs actually released a

486
00:16:34,339 --> 00:16:36,360
decompiler that mapped everything to the

487
00:16:36,360 --> 00:16:38,399
Apple event codes and so they were

488
00:16:38,399 --> 00:16:39,660
actually able to do some more analysis

489
00:16:39,660 --> 00:16:42,300
which is fantastic but because of that

490
00:16:42,300 --> 00:16:43,980
that's kind of what drove these two

491
00:16:43,980 --> 00:16:46,019
techniques because it was justification

492
00:16:46,019 --> 00:16:47,759
for like those run only Apple scripts

493
00:16:47,759 --> 00:16:50,279
which is those stripped binaries and

494
00:16:50,279 --> 00:16:51,600
then also the embedded payloads because

495
00:16:51,600 --> 00:16:53,220
what Osa Miner did was that they would

496
00:16:53,220 --> 00:16:55,320
embed applescript or run only Apple

497
00:16:55,320 --> 00:16:57,060
scripts inside of other run only Apple

498
00:16:57,060 --> 00:16:58,980
scripts which just made it really hard

499
00:16:58,980 --> 00:17:00,240
for people to decompile and understand

500
00:17:00,240 --> 00:17:03,480
what was actually happening

501
00:17:03,480 --> 00:17:04,980
so

502
00:17:04,980 --> 00:17:07,140
the next one is installer scripts the

503
00:17:07,140 --> 00:17:08,280
reason why this is significant is

504
00:17:08,280 --> 00:17:09,419
because we were actually previously

505
00:17:09,419 --> 00:17:14,040
mapping this to uh applescript which is

506
00:17:14,040 --> 00:17:15,660
a really really broad topic and for

507
00:17:15,660 --> 00:17:16,919
those of you that get really frustrated

508
00:17:16,919 --> 00:17:18,540
with mapping things to attack from Mac

509
00:17:18,540 --> 00:17:21,480
OS it's understandable now because like

510
00:17:21,480 --> 00:17:24,119
pre like the way an installer works is

511
00:17:24,119 --> 00:17:25,699
actually really

512
00:17:25,699 --> 00:17:27,780
cross-platform related it's not just Mac

513
00:17:27,780 --> 00:17:30,120
OS it's Linux it's GCC it's all of these

514
00:17:30,120 --> 00:17:31,620
different methods to be able to deliver

515
00:17:31,620 --> 00:17:34,200
an application then have it installed

516
00:17:34,200 --> 00:17:35,039
and there's a lot of different

517
00:17:35,039 --> 00:17:37,020
intricacies that go with this from Mac

518
00:17:37,020 --> 00:17:39,299
OS specifically

519
00:17:39,299 --> 00:17:41,640
um it's going to be your pre and post

520
00:17:41,640 --> 00:17:44,340
installers so back a couple years ago at

521
00:17:44,340 --> 00:17:45,840
macadamins they had this really great

522
00:17:45,840 --> 00:17:48,120
presentation that's linked in here where

523
00:17:48,120 --> 00:17:49,500
he was like

524
00:17:49,500 --> 00:17:51,780
the way that Mac OS does installers is

525
00:17:51,780 --> 00:17:53,400
fantastic and the reason why is because

526
00:17:53,400 --> 00:17:54,900
you can have a script that can prepare

527
00:17:54,900 --> 00:17:57,000
your environment and then you can have a

528
00:17:57,000 --> 00:17:58,679
script maybe like to move your installer

529
00:17:58,679 --> 00:18:00,840
to the trash so you literally have this

530
00:18:00,840 --> 00:18:02,940
entire nice process flow right are you

531
00:18:02,940 --> 00:18:04,260
in the right environment what

532
00:18:04,260 --> 00:18:06,299
dependencies do I need to download and

533
00:18:06,299 --> 00:18:07,080
then you can have your actual

534
00:18:07,080 --> 00:18:08,820
application it made it really portable

535
00:18:08,820 --> 00:18:11,280
right but then when you're an adversary

536
00:18:11,280 --> 00:18:12,720
you're like how do I use this portable

537
00:18:12,720 --> 00:18:15,360
to my advantage well it's also very

538
00:18:15,360 --> 00:18:17,160
normal to be able to when you're

539
00:18:17,160 --> 00:18:18,240
installing something right you're going

540
00:18:18,240 --> 00:18:20,760
to prompt for user credentials now mind

541
00:18:20,760 --> 00:18:23,280
you none of these are new things like

542
00:18:23,280 --> 00:18:26,220
apple juice is really old so we're clear

543
00:18:26,220 --> 00:18:28,260
but apple juice was doing these post

544
00:18:28,260 --> 00:18:29,940
installer scripts where basically it was

545
00:18:29,940 --> 00:18:31,320
already going to prompt you for your

546
00:18:31,320 --> 00:18:33,240
credentials to be able to download the

547
00:18:33,240 --> 00:18:34,980
splash player um but then it was going

548
00:18:34,980 --> 00:18:37,020
to use a post install script to be able

549
00:18:37,020 --> 00:18:39,000
to move its malicious binary into the

550
00:18:39,000 --> 00:18:40,260
launch demons which had already had the

551
00:18:40,260 --> 00:18:41,820
permissions for because you already gave

552
00:18:41,820 --> 00:18:42,840
your credentials to be able to install

553
00:18:42,840 --> 00:18:44,760
the application in the first place and

554
00:18:44,760 --> 00:18:45,900
then it was going to be able to execute

555
00:18:45,900 --> 00:18:47,820
that and so now you've got elevated

556
00:18:47,820 --> 00:18:49,860
privileges and you've also got execution

557
00:18:49,860 --> 00:18:52,320
on your host so we just started

558
00:18:52,320 --> 00:18:54,179
remapping that to be able to be a part

559
00:18:54,179 --> 00:18:55,559
of the installer packages and the more

560
00:18:55,559 --> 00:18:57,419
we unpacked this the more we kind of

561
00:18:57,419 --> 00:18:59,220
realized like how much of a broad thing

562
00:18:59,220 --> 00:19:01,020
this is it's not scripts it does use

563
00:19:01,020 --> 00:19:02,360
applescript

564
00:19:02,360 --> 00:19:05,700
but it can use any scripts so it's just

565
00:19:05,700 --> 00:19:07,500
the functionality of an actual installer

566
00:19:07,500 --> 00:19:10,140
package so

567
00:19:10,140 --> 00:19:10,980
um

568
00:19:10,980 --> 00:19:13,559
some big things that we had I'll

569
00:19:13,559 --> 00:19:14,700
actually go over this because it's not

570
00:19:14,700 --> 00:19:15,660
in the slides because I didn't think I

571
00:19:15,660 --> 00:19:16,860
was going to have time with all the the

572
00:19:16,860 --> 00:19:18,780
comics but uh there's another more

573
00:19:18,780 --> 00:19:20,100
technique that we're really excited

574
00:19:20,100 --> 00:19:23,940
about and that's going to be your socket

575
00:19:23,940 --> 00:19:26,160
listeners uh turns out you can actually

576
00:19:26,160 --> 00:19:28,220
do this on Mac OS as well

577
00:19:28,220 --> 00:19:30,720
where if you look at different threat

578
00:19:30,720 --> 00:19:32,760
actors specifically

579
00:19:32,760 --> 00:19:37,440
your BPF backdoor which is a Linux based

580
00:19:37,440 --> 00:19:40,020
malware that came out what it does is

581
00:19:40,020 --> 00:19:43,860
actually sets up a BPF filter using lib

582
00:19:43,860 --> 00:19:47,160
pcap right and the significance of this

583
00:19:47,160 --> 00:19:49,799
specific technique is that by you don't

584
00:19:49,799 --> 00:19:51,299
actually do a full installation all

585
00:19:51,299 --> 00:19:54,840
you're doing is adding a filter and the

586
00:19:54,840 --> 00:19:56,340
way that they activate these are more

587
00:19:56,340 --> 00:19:57,960
for like long-term backdoors so if

588
00:19:57,960 --> 00:19:59,460
you're like I want to come in in nine

589
00:19:59,460 --> 00:20:00,600
months and I don't want anyone to know

590
00:20:00,600 --> 00:20:02,760
about me you can go in you already have

591
00:20:02,760 --> 00:20:04,200
execution on the box you're leaving

592
00:20:04,200 --> 00:20:06,120
persistence for a longer time then you

593
00:20:06,120 --> 00:20:08,880
install your filter using your lib pcap

594
00:20:08,880 --> 00:20:11,520
library and then you will send a crafted

595
00:20:11,520 --> 00:20:13,320
packet later which is traffic signaling

596
00:20:13,320 --> 00:20:15,539
technique for attack and then that'll

597
00:20:15,539 --> 00:20:17,280
activate the actual installation so it's

598
00:20:17,280 --> 00:20:20,100
like a really slick long term backdoor

599
00:20:20,100 --> 00:20:21,600
activation

600
00:20:21,600 --> 00:20:24,900
but uh we have we just put that Tech

601
00:20:24,900 --> 00:20:26,640
technique in for Linux and then I was

602
00:20:26,640 --> 00:20:27,840
verifying it with some other different

603
00:20:27,840 --> 00:20:29,039
research developers and you can

604
00:20:29,039 --> 00:20:30,539
absolutely do the same thing on Mac OS

605
00:20:30,539 --> 00:20:33,240
if you install that Library

606
00:20:33,240 --> 00:20:34,320
um and the only reason why you'd have to

607
00:20:34,320 --> 00:20:35,400
install the libraries just because the

608
00:20:35,400 --> 00:20:37,200
mock Services run a little differently

609
00:20:37,200 --> 00:20:39,660
um in the sockets so fun new technique

610
00:20:39,660 --> 00:20:41,340
but

611
00:20:41,340 --> 00:20:43,260
kind of key takeaways for this is attack

612
00:20:43,260 --> 00:20:45,000
is hands down Community Driven so if you

613
00:20:45,000 --> 00:20:46,200
guys can pick anything from this talk

614
00:20:46,200 --> 00:20:47,520
know that all the changes that are

615
00:20:47,520 --> 00:20:48,780
happening in attack that you guys now

616
00:20:48,780 --> 00:20:50,760
can talk about are honestly a direct

617
00:20:50,760 --> 00:20:52,919
relation to any conversations that we've

618
00:20:52,919 --> 00:20:55,020
had together any passion points that you

619
00:20:55,020 --> 00:20:56,640
all have talked about they've been

620
00:20:56,640 --> 00:20:58,500
really really helpful and it's really

621
00:20:58,500 --> 00:20:59,880
helpful to know where we've gone right

622
00:20:59,880 --> 00:21:01,440
but also where we've gone wrong and

623
00:21:01,440 --> 00:21:04,140
where we had opportunities go better if

624
00:21:04,140 --> 00:21:05,580
it's not an attack it does not mean it's

625
00:21:05,580 --> 00:21:08,760
in the wild there is absolutely a gap

626
00:21:08,760 --> 00:21:12,000
between reporting and

627
00:21:12,000 --> 00:21:14,160
actually getting published in attack so

628
00:21:14,160 --> 00:21:16,440
I would say for those of you that have

629
00:21:16,440 --> 00:21:17,880
seen anything in the wild there was like

630
00:21:17,880 --> 00:21:19,620
I think we've all brought it up lately

631
00:21:19,620 --> 00:21:20,700
where it's like there's just not a lot

632
00:21:20,700 --> 00:21:22,200
of documentation

633
00:21:22,200 --> 00:21:23,460
um it'd be great if you guys publish

634
00:21:23,460 --> 00:21:26,220
that I have no fear that it's not going

635
00:21:26,220 --> 00:21:27,299
to be good enough

636
00:21:27,299 --> 00:21:28,799
um because it will be helpful to

637
00:21:28,799 --> 00:21:30,539
somebody and if you reach out to me we

638
00:21:30,539 --> 00:21:32,400
can definitely work on it

639
00:21:32,400 --> 00:21:34,200
um there's also been this pattern where

640
00:21:34,200 --> 00:21:35,539
everything's becoming really really

641
00:21:35,539 --> 00:21:38,159
cross-platform so most of the malware

642
00:21:38,159 --> 00:21:39,480
that scene oh it's also portable on

643
00:21:39,480 --> 00:21:42,360
Linux oh it's also portable on Mac OS my

644
00:21:42,360 --> 00:21:43,980
favorite one was one analysis report

645
00:21:43,980 --> 00:21:46,380
where it was like yeah this is uh this

646
00:21:46,380 --> 00:21:49,500
is on Mac OS but we're going to do the

647
00:21:49,500 --> 00:21:51,900
windows analysis and it was just like

648
00:21:51,900 --> 00:21:53,580
really

649
00:21:53,580 --> 00:21:54,120
um

650
00:21:54,120 --> 00:21:55,980
but yeah as I said earlier a road map

651
00:21:55,980 --> 00:21:58,140
for gatekeeper would be great honestly

652
00:21:58,140 --> 00:21:59,880
anything as far as security controls

653
00:21:59,880 --> 00:22:02,100
would be great but just also a big call

654
00:22:02,100 --> 00:22:04,740
out to Howard and Phil I use a lot of

655
00:22:04,740 --> 00:22:06,720
your reporting to verify and cross-check

656
00:22:06,720 --> 00:22:08,820
things and so I just really appreciate

657
00:22:08,820 --> 00:22:10,740
the amount of time that you all have put

658
00:22:10,740 --> 00:22:13,620
into a lot of your reporting uh

659
00:22:13,620 --> 00:22:15,900
there's others but for the most part

660
00:22:15,900 --> 00:22:20,419
that is that any questions

661
00:22:21,840 --> 00:22:25,090
crickets foreign

662
00:22:25,090 --> 00:22:33,740
[Applause]

663
00:23:17,720 --> 00:23:20,760
on the operating system itself and we've

664
00:23:20,760 --> 00:23:22,440
bucketed those two because there's no

665
00:23:22,440 --> 00:23:25,380
way like there's a reason why cves is

666
00:23:25,380 --> 00:23:27,299
separate from Attack techniques right

667
00:23:27,299 --> 00:23:28,799
like we really wanted to capture like

668
00:23:28,799 --> 00:23:31,080
what can Defenders defend against that's

669
00:23:31,080 --> 00:23:32,580
repeatable like there's nothing wrong

670
00:23:32,580 --> 00:23:35,039
with Law changes large agents is great

671
00:23:35,039 --> 00:23:36,179
there's nothing wrong with apple scripts

672
00:23:36,179 --> 00:23:39,000
or run only Apple scripts the real power

673
00:23:39,000 --> 00:23:40,559
behind that is because there's nothing

674
00:23:40,559 --> 00:23:42,179
wrong with it so how do you use

675
00:23:42,179 --> 00:23:43,740
something that's actually supposed to be

676
00:23:43,740 --> 00:23:45,539
there against the operating system

677
00:23:45,539 --> 00:23:48,020
itself

678
00:23:48,179 --> 00:23:50,760
so no the answer is yes and no so

679
00:23:50,760 --> 00:23:53,520
nothing specifically but yes there is

680
00:23:53,520 --> 00:23:54,900
one technique that kind of we bucket

681
00:23:54,900 --> 00:23:57,080
into

682
00:23:57,720 --> 00:24:00,020
yeah

683
00:24:03,260 --> 00:24:06,480
cyber art kind of company and uh Chris

684
00:24:06,480 --> 00:24:09,620
Fleming is the artist

685
00:24:11,580 --> 00:24:13,500
okay this is kind of random question

686
00:24:13,500 --> 00:24:16,500
um what malware would you say has like

687
00:24:16,500 --> 00:24:20,159
mapped the most or influenced the most

688
00:24:20,159 --> 00:24:22,440
your favorite maybe I mean honestly

689
00:24:22,440 --> 00:24:23,760
right now it's going to be us just

690
00:24:23,760 --> 00:24:25,140
because like that has been the most

691
00:24:25,140 --> 00:24:27,600
recent one it does the GitHub projects I

692
00:24:27,600 --> 00:24:29,700
really like I don't want to compliment

693
00:24:29,700 --> 00:24:31,799
malware but it's this slightly conflict

694
00:24:31,799 --> 00:24:33,539
is going on right here

695
00:24:33,539 --> 00:24:35,520
um between the way it's actually used a

696
00:24:35,520 --> 00:24:37,080
lot of novel ideas the application

697
00:24:37,080 --> 00:24:38,700
bundle manipulation they're just really

698
00:24:38,700 --> 00:24:40,200
ahead of the curve as far as like

699
00:24:40,200 --> 00:24:41,400
understanding how the application

700
00:24:41,400 --> 00:24:43,980
bundles work and then how to subvert

701
00:24:43,980 --> 00:24:45,900
that trust relationship because that's

702
00:24:45,900 --> 00:24:47,340
really what it is right it's a trust

703
00:24:47,340 --> 00:24:50,159
relationship your operating system wants

704
00:24:50,159 --> 00:24:51,960
to execute its app that's like why

705
00:24:51,960 --> 00:24:55,020
Apple's so fantastic is because they're

706
00:24:55,020 --> 00:24:57,240
really focused on that user interaction

707
00:24:57,240 --> 00:24:59,039
and that seamless like it just works

708
00:24:59,039 --> 00:25:00,600
like it's a very common quote that

709
00:25:00,600 --> 00:25:04,020
you'll hear with apple unlike windows so

710
00:25:04,020 --> 00:25:05,880
um and Essex absolutely abuses that

711
00:25:05,880 --> 00:25:07,679
relationship repeatedly in really neat

712
00:25:07,679 --> 00:25:09,059
novel ways

713
00:25:09,059 --> 00:25:12,539
and so that's probably my favorite one

714
00:25:12,539 --> 00:25:14,220
all right well thank you guys so much oh

715
00:25:14,220 --> 00:25:16,330
what's up no please

716
00:25:16,330 --> 00:25:19,560
[Applause]

717
00:25:32,460 --> 00:25:34,580
thank you

718
00:25:37,580 --> 00:25:39,960
right now

719
00:25:39,960 --> 00:25:41,640
um the question was are we having any

720
00:25:41,640 --> 00:25:43,140
plans to be able to add red teaming

721
00:25:43,140 --> 00:25:44,640
techniques

722
00:25:44,640 --> 00:25:46,620
um basically to attack

723
00:25:46,620 --> 00:25:48,900
um I know a lot of companies what they

724
00:25:48,900 --> 00:25:51,000
have done is they've actually taken

725
00:25:51,000 --> 00:25:52,620
attack Matrix and they've built their

726
00:25:52,620 --> 00:25:55,799
own red teaming Matrix on top of attack

727
00:25:55,799 --> 00:25:56,460
um

728
00:25:56,460 --> 00:25:58,860
I like will probably never do red

729
00:25:58,860 --> 00:26:01,679
teaming techniques for attack purely for

730
00:26:01,679 --> 00:26:02,880
one reason only

731
00:26:02,880 --> 00:26:04,980
like the power of attack is that it's

732
00:26:04,980 --> 00:26:06,539
already been seen in the wild

733
00:26:06,539 --> 00:26:08,640
and so there's a reason why companies

734
00:26:08,640 --> 00:26:10,740
invest so heavily in incredibly smart

735
00:26:10,740 --> 00:26:12,419
people that do red teaming and it's

736
00:26:12,419 --> 00:26:14,220
because you guys are ahead of the curve

737
00:26:14,220 --> 00:26:16,140
for a very good reason like those

738
00:26:16,140 --> 00:26:18,659
researcher roles that understanding of

739
00:26:18,659 --> 00:26:21,779
the Mac OS Hardware at that that bite

740
00:26:21,779 --> 00:26:23,039
level

741
00:26:23,039 --> 00:26:25,559
um is not necessarily common so most

742
00:26:25,559 --> 00:26:27,240
average Series have the mentality of

743
00:26:27,240 --> 00:26:29,159
well if it works

744
00:26:29,159 --> 00:26:31,080
do I really care

745
00:26:31,080 --> 00:26:32,880
um whereas a lot of researchers are like

746
00:26:32,880 --> 00:26:34,740
but what's the coolest way I could do

747
00:26:34,740 --> 00:26:36,360
this right like I've got I've got a pone

748
00:26:36,360 --> 00:26:37,620
at all

749
00:26:37,620 --> 00:26:39,059
um so it's just a different mentality

750
00:26:39,059 --> 00:26:41,279
but nothing for red teaming right now

751
00:26:41,279 --> 00:26:42,840
but I would love to see that as a

752
00:26:42,840 --> 00:26:44,580
separate miter project maybe where it's

753
00:26:44,580 --> 00:26:45,900
like red teaming techniques but it's

754
00:26:45,900 --> 00:26:47,700
also slightly terrifying to even publish

755
00:26:47,700 --> 00:26:49,200
that

756
00:26:49,200 --> 00:26:50,640
Sam

757
00:26:50,640 --> 00:26:52,500
any other questions

758
00:26:52,500 --> 00:26:54,419
all right you guys have an amazing happy

759
00:26:54,419 --> 00:26:55,320
hour

760
00:26:55,320 --> 00:26:58,460
and thank you so much

761
00:26:59,150 --> 00:27:02,779
[Applause]

