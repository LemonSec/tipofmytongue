1
00:00:00,110 --> 00:00:05,609
hello everyone<font color="#CCCCCC"> and my name</font><font color="#E5E5E5"> is Alex</font>

2
00:00:03,990 --> 00:00:08,068
Morozov and today I will<font color="#CCCCCC"> be presenting</font>

3
00:00:05,609 --> 00:00:11,639
<font color="#E5E5E5">at</font><font color="#CCCCCC"> ICANN hardware root of</font><font color="#E5E5E5"> trust from the</font>

4
00:00:08,069 --> 00:00:14,309
<font color="#E5E5E5">u5 firmware and I will be discussing</font>

5
00:00:11,639 --> 00:00:16,230
<font color="#CCCCCC">some of</font><font color="#E5E5E5"> the problems when</font><font color="#CCCCCC"> basically the</font>

6
00:00:14,309 --> 00:00:18,600
hardware root of trust<font color="#E5E5E5"> not really in</font>

7
00:00:16,230 --> 00:00:20,850
hardware and some software take care of

8
00:00:18,600 --> 00:00:23,490
it and it became some of<font color="#CCCCCC"> the security</font>

9
00:00:20,850 --> 00:00:26,820
<font color="#CCCCCC">problems</font><font color="#E5E5E5"> so actually I will skip an</font>

10
00:00:23,490 --> 00:00:29,640
intro so<font color="#E5E5E5"> disclaimer</font><font color="#CCCCCC"> I'm working for</font>

11
00:00:26,820 --> 00:00:32,668
<font color="#CCCCCC">Nvidia but this talk it's</font><font color="#E5E5E5"> not for my</font>

12
00:00:29,640 --> 00:00:34,530
employer<font color="#E5E5E5"> all my opinion since</font><font color="#CCCCCC"> my no</font>

13
00:00:32,668 --> 00:00:40,430
responsibilities<font color="#E5E5E5"> as mine all the</font><font color="#CCCCCC"> zero</font>

14
00:00:34,530 --> 00:00:43,700
days is mine and<font color="#CCCCCC"> projected so yep</font>

15
00:00:40,430 --> 00:00:47,460
<font color="#CCCCCC">actually I switch from easy targets like</font>

16
00:00:43,700 --> 00:00:51,000
gigabyte<font color="#E5E5E5"> and</font><font color="#CCCCCC"> Asus which</font><font color="#E5E5E5"> I presented last</font>

17
00:00:47,460 --> 00:00:52,949
<font color="#CCCCCC">year on the offensive comm so I focus it</font>

18
00:00:51,000 --> 00:00:54,719
on my Lenovo<font color="#CCCCCC"> P 50 which is more</font>

19
00:00:52,949 --> 00:00:56,730
<font color="#E5E5E5">interesting</font><font color="#CCCCCC"> target and</font><font color="#E5E5E5"> actually not</font>

20
00:00:54,719 --> 00:00:58,800
based on american megatrends<font color="#CCCCCC"> which is</font>

21
00:00:56,730 --> 00:01:01,230
more fun for me<font color="#CCCCCC"> because phoenix bias i</font>

22
00:00:58,800 --> 00:01:04,768
not touch<font color="#CCCCCC"> it a lot and</font><font color="#E5E5E5"> be in a lot</font><font color="#CCCCCC"> of</font>

23
00:01:01,230 --> 00:01:07,649
<font color="#E5E5E5">surprises for</font><font color="#CCCCCC"> me</font><font color="#E5E5E5"> so actually it's agenda</font>

24
00:01:04,769 --> 00:01:09,090
for my talk<font color="#CCCCCC"> and we will be start from</font>

25
00:01:07,650 --> 00:01:11,040
some of the discussion what is<font color="#CCCCCC"> the</font>

26
00:01:09,090 --> 00:01:14,010
problem<font color="#CCCCCC"> actually</font><font color="#E5E5E5"> on</font><font color="#CCCCCC"> overall</font><font color="#E5E5E5"> this</font>

27
00:01:11,040 --> 00:01:16,200
hardware root of<font color="#CCCCCC"> trust and then actually</font>

28
00:01:14,010 --> 00:01:18,600
will<font color="#CCCCCC"> be discussed some interesting stuff</font>

29
00:01:16,200 --> 00:01:21,270
because lenovo laptops<font color="#E5E5E5"> do have like a</font>

30
00:01:18,600 --> 00:01:25,020
computer<font color="#E5E5E5"> ace which is kind of anti-theft</font>

31
00:01:21,270 --> 00:01:27,179
<font color="#E5E5E5">feature and they say it's possible to</font>

32
00:01:25,020 --> 00:01:30,298
permanent disable and bios setup options

33
00:01:27,180 --> 00:01:33,420
<font color="#E5E5E5">but it's not really true</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> i will be</font>

34
00:01:30,299 --> 00:01:35,579
show you why and actually compute<font color="#CCCCCC"> rays</font>

35
00:01:33,420 --> 00:01:38,280
can<font color="#CCCCCC"> be disabled</font><font color="#E5E5E5"> and enabled from the</font>

36
00:01:35,579 --> 00:01:40,860
operating<font color="#CCCCCC"> system and it's also quite</font>

37
00:01:38,280 --> 00:01:42,899
interesting because basically<font color="#E5E5E5"> even if</font>

38
00:01:40,860 --> 00:01:47,310
<font color="#E5E5E5">it's permanently disabled</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> can</font><font color="#CCCCCC"> read</font>

39
00:01:42,899 --> 00:01:49,560
<font color="#CCCCCC">about code and i'm doing</font><font color="#E5E5E5"> some firmware</font>

40
00:01:47,310 --> 00:01:51,450
research quite a while and<font color="#E5E5E5"> actually it's</font>

41
00:01:49,560 --> 00:01:53,820
my handlers<font color="#E5E5E5"> it's kind of like a callback</font>

42
00:01:51,450 --> 00:01:56,640
<font color="#E5E5E5">functions from the</font><font color="#CCCCCC"> BIOS to</font><font color="#E5E5E5"> the operating</font>

43
00:01:53,820 --> 00:01:59,850
<font color="#CCCCCC">system</font><font color="#E5E5E5"> level always been a security</font>

44
00:01:56,640 --> 00:02:01,710
<font color="#E5E5E5">concern for me and</font><font color="#CCCCCC"> actually I discover</font>

45
00:01:59,850 --> 00:02:04,320
some cool stuff which is<font color="#E5E5E5"> use it on</font>

46
00:02:01,710 --> 00:02:07,649
<font color="#E5E5E5">enterprise level laptops for automating</font>

47
00:02:04,320 --> 00:02:10,378
<font color="#CCCCCC">some stuff for configuration even</font><font color="#E5E5E5"> for</font>

48
00:02:07,649 --> 00:02:12,360
security<font color="#E5E5E5"> to over windows</font><font color="#CCCCCC"> management</font>

49
00:02:10,378 --> 00:02:13,750
interface which is<font color="#E5E5E5"> cool you now on don't</font>

50
00:02:12,360 --> 00:02:16,630
need actually

51
00:02:13,750 --> 00:02:22,450
<font color="#E5E5E5">I mean</font><font color="#CCCCCC"> zero driver to Co SMI handler</font><font color="#E5E5E5"> yep</font>

52
00:02:16,630 --> 00:02:24,579
<font color="#CCCCCC">and it will be some boot guard bypass</font>

53
00:02:22,450 --> 00:02:26,709
<font color="#CCCCCC">waist of course an implementation of</font>

54
00:02:24,580 --> 00:02:28,810
Phoenix by especially<font color="#CCCCCC"> for Lenovo or its</font>

55
00:02:26,710 --> 00:02:32,860
<font color="#CCCCCC">lean</font><font color="#E5E5E5"> over</font><font color="#CCCCCC"> engineers</font><font color="#E5E5E5"> make a mistake</font><font color="#CCCCCC"> I</font>

56
00:02:28,810 --> 00:02:37,510
<font color="#E5E5E5">don't know so and yep it's a agenda for</font>

57
00:02:32,860 --> 00:02:41,850
my talk<font color="#CCCCCC"> that started so hard we root of</font>

58
00:02:37,510 --> 00:02:44,739
trust<font color="#CCCCCC"> it's hard because</font><font color="#E5E5E5"> it's actually</font>

59
00:02:41,850 --> 00:02:46,600
<font color="#E5E5E5">really hard</font><font color="#CCCCCC"> to support after the</font><font color="#E5E5E5"> vendor</font>

60
00:02:44,740 --> 00:02:50,710
break it in<font color="#E5E5E5"> silicon or</font><font color="#CCCCCC"> RTL</font>

61
00:02:46,600 --> 00:02:53,890
so it's not<font color="#E5E5E5"> be can be a can't be updated</font>

62
00:02:50,710 --> 00:02:56,110
and<font color="#E5E5E5"> for OEMs</font><font color="#CCCCCC"> it's very very hard</font><font color="#E5E5E5"> to</font>

63
00:02:53,890 --> 00:02:59,140
<font color="#E5E5E5">support in the</font><font color="#CCCCCC"> field the devices not</font>

64
00:02:56,110 --> 00:03:03,790
<font color="#E5E5E5">only actually x86 devices</font><font color="#CCCCCC"> any</font><font color="#E5E5E5"> devices</font>

65
00:02:59,140 --> 00:03:07,149
and usually<font color="#E5E5E5"> vendors try to basically</font>

66
00:03:03,790 --> 00:03:09,489
make some I would<font color="#E5E5E5"> say</font><font color="#CCCCCC"> not a backdoor</font><font color="#E5E5E5"> but</font>

67
00:03:07,150 --> 00:03:11,710
the way to basically<font color="#E5E5E5"> communicate and</font>

68
00:03:09,490 --> 00:03:14,260
reconfigure<font color="#CCCCCC"> eight the system or just</font>

69
00:03:11,710 --> 00:03:15,820
basically bypass<font color="#E5E5E5"> if something</font><font color="#CCCCCC"> go</font><font color="#E5E5E5"> wrong</font>

70
00:03:14,260 --> 00:03:17,739
<font color="#E5E5E5">with this hardware</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> root of root of</font>

71
00:03:15,820 --> 00:03:23,320
<font color="#CCCCCC">trust</font><font color="#E5E5E5"> and we will see some of</font><font color="#CCCCCC"> the</font>

72
00:03:17,739 --> 00:03:25,870
examples<font color="#CCCCCC"> today and also this</font><font color="#E5E5E5"> kind of</font>

73
00:03:23,320 --> 00:03:28,239
things as a<font color="#CCCCCC"> carver root of trust it's</font>

74
00:03:25,870 --> 00:03:31,420
very hard<font color="#E5E5E5"> to update which I mentioned</font>

75
00:03:28,239 --> 00:03:35,290
<font color="#E5E5E5">and actually it's also hard to</font><font color="#CCCCCC"> implement</font>

76
00:03:31,420 --> 00:03:36,880
and secure way because you have<font color="#CCCCCC"> a as</font>

77
00:03:35,290 --> 00:03:39,760
example in secure boot you have<font color="#CCCCCC"> a</font>

78
00:03:36,880 --> 00:03:42,519
<font color="#E5E5E5">transition state between chain of trust</font>

79
00:03:39,760 --> 00:03:44,260
<font color="#CCCCCC">States</font><font color="#E5E5E5"> and then you</font><font color="#CCCCCC"> needed basically</font>

80
00:03:42,520 --> 00:03:46,989
secure<font color="#E5E5E5"> transit all the secrets between</font>

81
00:03:44,260 --> 00:03:49,149
<font color="#E5E5E5">the stages</font><font color="#CCCCCC"> and usually performance</font>

82
00:03:46,989 --> 00:03:53,040
became its most<font color="#CCCCCC"> important and security</font>

83
00:03:49,150 --> 00:03:55,750
<font color="#E5E5E5">and yes it's some fun stuff</font><font color="#CCCCCC"> there's</font><font color="#E5E5E5"> so</font>

84
00:03:53,040 --> 00:03:57,970
in the most of<font color="#E5E5E5"> the cases basically</font><font color="#CCCCCC"> the</font>

85
00:03:55,750 --> 00:04:00,370
root of trust<font color="#CCCCCC"> its mix between firmware</font>

86
00:03:57,970 --> 00:04:01,780
and hardware it's not always in<font color="#CCCCCC"> hardware</font>

87
00:04:00,370 --> 00:04:04,000
because<font color="#E5E5E5"> it's no way how you can</font>

88
00:04:01,780 --> 00:04:07,930
<font color="#E5E5E5">basically put</font><font color="#CCCCCC"> everything in the hardware</font>

89
00:04:04,000 --> 00:04:10,600
and also<font color="#E5E5E5"> most of the cases it</font><font color="#CCCCCC"> just like</font>

90
00:04:07,930 --> 00:04:12,459
some<font color="#CCCCCC"> fuse which</font><font color="#E5E5E5"> is just a storage which</font>

91
00:04:10,600 --> 00:04:15,850
<font color="#CCCCCC">is locked some of the value inside the</font>

92
00:04:12,459 --> 00:04:18,010
<font color="#E5E5E5">hardware or it can be some specific bit</font>

93
00:04:15,850 --> 00:04:20,680
<font color="#E5E5E5">which is just lock some of the memory</font>

94
00:04:18,010 --> 00:04:24,630
region or whatever make a signal for

95
00:04:20,680 --> 00:04:27,220
<font color="#E5E5E5">firmware</font><font color="#CCCCCC"> to do something specific</font><font color="#E5E5E5"> and</font>

96
00:04:24,630 --> 00:04:29,950
yep secure state transition

97
00:04:27,220 --> 00:04:31,810
is very<font color="#E5E5E5"> hard and we will see so I will</font>

98
00:04:29,950 --> 00:04:33,760
start<font color="#E5E5E5"> with</font><font color="#CCCCCC"> some of</font><font color="#E5E5E5"> the picture because</font>

99
00:04:31,810 --> 00:04:35,590
it's always people asking<font color="#CCCCCC"> me the</font>

100
00:04:33,760 --> 00:04:37,539
question what<font color="#CCCCCC"> is the reason of</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> five</font>

101
00:04:35,590 --> 00:04:41,260
farmers<font color="#E5E5E5"> because you need a lot</font><font color="#CCCCCC"> of levels</font>

102
00:04:37,540 --> 00:04:43,270
of bypass as example you need our<font color="#CCCCCC"> C's</font>

103
00:04:41,260 --> 00:04:45,159
<font color="#E5E5E5">and privilege escalation and then you</font>

104
00:04:43,270 --> 00:04:47,740
basically<font color="#E5E5E5"> can't go from the operating</font>

105
00:04:45,160 --> 00:04:50,680
<font color="#E5E5E5">system</font><font color="#CCCCCC"> level to firmware</font><font color="#E5E5E5"> but look on</font>

106
00:04:47,740 --> 00:04:53,230
this<font color="#E5E5E5"> crucification which</font><font color="#CCCCCC"> I actually</font>

107
00:04:50,680 --> 00:04:56,290
released recently in my blog<font color="#CCCCCC"> post</font><font color="#E5E5E5"> so and</font>

108
00:04:53,230 --> 00:04:58,750
it's a lot of stuff can<font color="#E5E5E5"> be very very</font>

109
00:04:56,290 --> 00:05:02,230
<font color="#E5E5E5">sensitive specially for the data centers</font>

110
00:04:58,750 --> 00:05:06,520
for enterprise networks and other things

111
00:05:02,230 --> 00:05:09,580
and most of the<font color="#E5E5E5"> things as example</font>

112
00:05:06,520 --> 00:05:13,240
configuration<font color="#E5E5E5"> secure</font><font color="#CCCCCC"> configuration it's</font>

113
00:05:09,580 --> 00:05:15,159
even not considered about like<font color="#E5E5E5"> security</font>

114
00:05:13,240 --> 00:05:19,630
problem<font color="#E5E5E5"> some of</font><font color="#CCCCCC"> the vendors</font><font color="#E5E5E5"> like a</font>

115
00:05:15,160 --> 00:05:27,390
gigabyte<font color="#E5E5E5"> MSI and</font><font color="#CCCCCC"> ISO stack</font><font color="#E5E5E5"> even God sign</font>

116
00:05:19,630 --> 00:05:30,610
their updates properly<font color="#CCCCCC"> and actually</font>

117
00:05:27,390 --> 00:05:32,919
these pictures of<font color="#CCCCCC"> from from my blog</font><font color="#E5E5E5"> from</font>

118
00:05:30,610 --> 00:05:34,900
<font color="#CCCCCC">my previous blog post it's about how</font>

119
00:05:32,919 --> 00:05:37,599
<font color="#E5E5E5">many things you</font><font color="#CCCCCC"> need to get in the</font>

120
00:05:34,900 --> 00:05:42,640
firmware<font color="#CCCCCC"> yeah I will skip it</font><font color="#E5E5E5"> just</font><font color="#CCCCCC"> as a</font>

121
00:05:37,600 --> 00:05:45,520
reference<font color="#CCCCCC"> and yep if you think you have</font>

122
00:05:42,640 --> 00:05:48,219
<font color="#CCCCCC">2 p.m. on your platform</font><font color="#E5E5E5"> yes you do but</font>

123
00:05:45,520 --> 00:05:51,039
think<font color="#CCCCCC"> about physical access for this</font>

124
00:05:48,220 --> 00:05:53,680
piece of TCG being not even<font color="#E5E5E5"> considered</font>

125
00:05:51,040 --> 00:05:57,610
as a threat model in a trade<font color="#CCCCCC"> model</font><font color="#E5E5E5"> so</font>

126
00:05:53,680 --> 00:05:59,919
and actually<font color="#CCCCCC"> Jeremy boon</font><font color="#E5E5E5"> being show a</font>

127
00:05:57,610 --> 00:06:02,260
lot of<font color="#CCCCCC"> issues when they can make man in</font>

128
00:05:59,919 --> 00:06:04,390
<font color="#E5E5E5">the middle between TPM and firmware</font>

129
00:06:02,260 --> 00:06:06,760
<font color="#E5E5E5">which is communicating</font><font color="#CCCCCC"> forgetting some</font>

130
00:06:04,390 --> 00:06:09,340
of the secrets and other picture<font color="#E5E5E5"> it's</font>

131
00:06:06,760 --> 00:06:11,979
actually<font color="#E5E5E5"> thermal Hudson make some fun of</font>

132
00:06:09,340 --> 00:06:16,090
it to<font color="#CCCCCC"> basically interception directly to</font>

133
00:06:11,979 --> 00:06:18,219
<font color="#E5E5E5">solve it some wires and it's a scheme of</font>

134
00:06:16,090 --> 00:06:20,380
<font color="#E5E5E5">the boot guard boot flow which been</font>

135
00:06:18,220 --> 00:06:23,280
actually in details<font color="#CCCCCC"> discuss it last year</font>

136
00:06:20,380 --> 00:06:25,570
I will not<font color="#CCCCCC"> go really deep but Fink is</font>

137
00:06:23,280 --> 00:06:28,780
<font color="#E5E5E5">everything is locked it's a perfect</font>

138
00:06:25,570 --> 00:06:31,450
world we have some root of<font color="#E5E5E5"> trust which</font>

139
00:06:28,780 --> 00:06:33,609
is<font color="#E5E5E5"> baked in</font><font color="#CCCCCC"> the hardware we have other</font>

140
00:06:31,450 --> 00:06:36,370
<font color="#CCCCCC">things which</font><font color="#E5E5E5"> is have a secure transition</font>

141
00:06:33,610 --> 00:06:40,680
way and yeah<font color="#E5E5E5"> so it's good looks good</font>

142
00:06:36,370 --> 00:06:45,539
<font color="#CCCCCC">right so but think about we</font>

143
00:06:40,680 --> 00:06:46,800
have a not perfect<font color="#CCCCCC"> world and</font><font color="#E5E5E5"> microcode</font>

144
00:06:45,539 --> 00:06:48,870
and<font color="#E5E5E5"> ACMs</font>

145
00:06:46,800 --> 00:06:51,120
which is actually stirred in<font color="#E5E5E5"> wedding</font>

146
00:06:48,870 --> 00:06:53,789
<font color="#E5E5E5">which is highlighted on the picture from</font>

147
00:06:51,120 --> 00:06:56,370
<font color="#CCCCCC">ufi to and I released last year</font><font color="#E5E5E5"> update</font>

148
00:06:53,789 --> 00:06:59,190
<font color="#CCCCCC">for you fi two</font><font color="#E5E5E5"> witches can parse all the</font>

149
00:06:56,370 --> 00:07:01,650
<font color="#CCCCCC">buyers</font><font color="#E5E5E5"> guard</font><font color="#CCCCCC"> Oh boot guard information</font>

150
00:06:59,190 --> 00:07:05,969
<font color="#E5E5E5">so and it's not covered actually what</font>

151
00:07:01,650 --> 00:07:10,580
Boogaard<font color="#E5E5E5"> you know why because</font><font color="#CCCCCC"> you need</font>

152
00:07:05,970 --> 00:07:13,380
to<font color="#CCCCCC"> execute all</font><font color="#E5E5E5"> the stuff before</font><font color="#CCCCCC"> on</font>

153
00:07:10,580 --> 00:07:15,479
initial stage<font color="#E5E5E5"> actually of verification</font>

154
00:07:13,380 --> 00:07:17,699
and<font color="#CCCCCC"> it's can't be covered</font><font color="#E5E5E5"> because who</font>

155
00:07:15,479 --> 00:07:21,780
will be basically checks all<font color="#CCCCCC"> the stuff</font>

156
00:07:17,699 --> 00:07:24,900
and think is<font color="#E5E5E5"> also you can't downgrade</font>

157
00:07:21,780 --> 00:07:26,909
the microcode<font color="#E5E5E5"> and</font><font color="#CCCCCC"> the ACMs at least on</font>

158
00:07:24,900 --> 00:07:29,940
my<font color="#E5E5E5"> laptop which</font><font color="#CCCCCC"> i try all</font><font color="#E5E5E5"> the car</font><font color="#CCCCCC"> 'get</font>

159
00:07:26,910 --> 00:07:31,710
<font color="#E5E5E5">on this research which</font><font color="#CCCCCC"> is also fun my</font>

160
00:07:29,940 --> 00:07:34,919
<font color="#E5E5E5">previous</font><font color="#CCCCCC"> here research</font><font color="#E5E5E5"> i've been talking</font>

161
00:07:31,710 --> 00:07:36,870
<font color="#CCCCCC">about being different a sims</font><font color="#E5E5E5"> and they do</font>

162
00:07:34,919 --> 00:07:38,940
have<font color="#CCCCCC"> a lot of stuff</font><font color="#E5E5E5"> most of the</font>

163
00:07:36,870 --> 00:07:41,970
vulnerabilities which is in to<font color="#E5E5E5"> fix it</font>

164
00:07:38,940 --> 00:07:44,280
there it's not<font color="#E5E5E5"> all of them really easy</font>

165
00:07:41,970 --> 00:07:46,260
to exploit or really straight fully

166
00:07:44,280 --> 00:07:48,570
exploitable<font color="#E5E5E5"> but</font><font color="#CCCCCC"> it's has some stuff</font>

167
00:07:46,260 --> 00:07:52,650
there<font color="#E5E5E5"> and I would suggest to</font><font color="#CCCCCC"> look if you</font>

168
00:07:48,570 --> 00:07:54,719
interested so yep<font color="#E5E5E5"> and in this case we</font>

169
00:07:52,650 --> 00:07:56,609
<font color="#E5E5E5">basically missing</font><font color="#CCCCCC"> two pieces of the root</font>

170
00:07:54,720 --> 00:07:59,159
of<font color="#E5E5E5"> trust which is basically not locked</font>

171
00:07:56,610 --> 00:08:01,139
<font color="#CCCCCC">and can be downgraded I would say of</font>

172
00:07:59,159 --> 00:08:04,020
course<font color="#E5E5E5"> you can't</font><font color="#CCCCCC"> really find the issues</font>

173
00:08:01,139 --> 00:08:06,500
with<font color="#CCCCCC"> micro cut but</font><font color="#E5E5E5"> you can but it's</font>

174
00:08:04,020 --> 00:08:09,240
really<font color="#E5E5E5"> really hard and I didn't seal</font>

175
00:08:06,500 --> 00:08:10,139
<font color="#E5E5E5">only if you find some</font><font color="#CCCCCC"> of the issues not</font>

176
00:08:09,240 --> 00:08:12,120
exactly

177
00:08:10,139 --> 00:08:14,460
<font color="#E5E5E5">basically</font><font color="#CCCCCC"> it's break it and microcode</font>

178
00:08:12,120 --> 00:08:16,770
<font color="#E5E5E5">and</font><font color="#CCCCCC"> antonio updated but it's not</font>

179
00:08:14,460 --> 00:08:18,419
<font color="#E5E5E5">basically related to boot guard because</font>

180
00:08:16,770 --> 00:08:20,669
<font color="#CCCCCC">i didn't seen</font><font color="#E5E5E5"> before because it's</font>

181
00:08:18,419 --> 00:08:24,419
actually<font color="#E5E5E5"> just verified the signature for</font>

182
00:08:20,669 --> 00:08:26,310
<font color="#CCCCCC">a cm and actually ischium</font><font color="#E5E5E5"> is quite</font>

183
00:08:24,419 --> 00:08:29,070
interesting place<font color="#CCCCCC"> to look because it's</font>

184
00:08:26,310 --> 00:08:31,139
one of<font color="#CCCCCC"> the</font><font color="#E5E5E5"> its second stage to verify</font>

185
00:08:29,070 --> 00:08:33,620
<font color="#CCCCCC">its even executed before reset vector</font>

186
00:08:31,139 --> 00:08:38,940
<font color="#E5E5E5">it's one of the points why it's actually</font>

187
00:08:33,620 --> 00:08:41,429
<font color="#E5E5E5">get not covered by boot guard</font><font color="#CCCCCC"> okay so</font>

188
00:08:38,940 --> 00:08:45,600
hard work<font color="#E5E5E5"> it's not flexible</font><font color="#CCCCCC"> it's</font>

189
00:08:41,429 --> 00:08:47,729
expensive<font color="#E5E5E5"> ions ions don't like like how</font>

190
00:08:45,600 --> 00:08:50,760
can secret there because supply<font color="#E5E5E5"> chain is</font>

191
00:08:47,730 --> 00:08:52,680
very very<font color="#CCCCCC"> very difficult</font><font color="#E5E5E5"> for</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> the</font>

192
00:08:50,760 --> 00:08:54,689
cost for<font color="#CCCCCC"> summoner</font><font color="#E5E5E5"> abilities is very high</font>

193
00:08:52,680 --> 00:08:57,000
<font color="#E5E5E5">no updates right so Rick</font>

194
00:08:54,690 --> 00:08:58,740
or something like<font color="#E5E5E5"> that and all the</font>

195
00:08:57,000 --> 00:09:01,590
vendors reducing the<font color="#E5E5E5"> hardware</font><font color="#CCCCCC"> locket</font>

196
00:08:58,740 --> 00:09:03,420
secrets<font color="#CCCCCC"> they try</font><font color="#E5E5E5"> to basically lock in</font>

197
00:09:01,590 --> 00:09:06,300
the beads or something like<font color="#CCCCCC"> that</font><font color="#E5E5E5"> to make</font>

198
00:09:03,420 --> 00:09:09,089
<font color="#CCCCCC">its</font><font color="#E5E5E5"> more simple and mix mostly it's a</font>

199
00:09:06,300 --> 00:09:13,469
<font color="#CCCCCC">mix hardware was firmware</font><font color="#E5E5E5"> in</font><font color="#CCCCCC"> this common</font>

200
00:09:09,090 --> 00:09:16,710
and actual implementations so let's move

201
00:09:13,470 --> 00:09:19,530
a bit to<font color="#E5E5E5"> more interesting stuff which</font><font color="#CCCCCC"> is</font>

202
00:09:16,710 --> 00:09:21,330
will be covered<font color="#E5E5E5"> like we learn something</font>

203
00:09:19,530 --> 00:09:23,520
about the hardware root of trust<font color="#CCCCCC"> and now</font>

204
00:09:21,330 --> 00:09:26,910
we will<font color="#E5E5E5"> be see the examples how it can</font>

205
00:09:23,520 --> 00:09:28,230
be<font color="#CCCCCC"> basically broken yeah how this</font>

206
00:09:26,910 --> 00:09:30,480
<font color="#E5E5E5">research get started</font>

207
00:09:28,230 --> 00:09:35,370
you know like you<font color="#E5E5E5"> can get actually</font><font color="#CCCCCC"> some</font>

208
00:09:30,480 --> 00:09:38,910
<font color="#E5E5E5">vemma information over</font><font color="#CCCCCC"> spi which is</font>

209
00:09:35,370 --> 00:09:42,750
usually have some like<font color="#E5E5E5"> bios version some</font>

210
00:09:38,910 --> 00:09:45,270
simple<font color="#E5E5E5"> stuff but someday</font><font color="#CCCCCC"> I get this</font>

211
00:09:42,750 --> 00:09:48,540
message<font color="#E5E5E5"> when</font><font color="#CCCCCC"> been upgrading my Windows</font>

212
00:09:45,270 --> 00:09:51,120
10 and it<font color="#CCCCCC"> was running in action</font>

213
00:09:48,540 --> 00:09:55,110
disabling the boot guard cool right<font color="#E5E5E5"> so</font>

214
00:09:51,120 --> 00:09:56,970
<font color="#E5E5E5">but how come</font><font color="#CCCCCC"> how you</font><font color="#E5E5E5"> basically can't</font>

215
00:09:55,110 --> 00:09:59,280
disable the boot guard<font color="#E5E5E5"> which</font><font color="#CCCCCC"> is</font>

216
00:09:56,970 --> 00:10:01,950
basically have root of trust<font color="#E5E5E5"> in the</font>

217
00:09:59,280 --> 00:10:03,540
hardware from<font color="#E5E5E5"> the operating system level</font>

218
00:10:01,950 --> 00:10:04,200
<font color="#E5E5E5">even if you have</font><font color="#CCCCCC"> administrative</font>

219
00:10:03,540 --> 00:10:09,089
privileges

220
00:10:04,200 --> 00:10:11,760
hmm<font color="#E5E5E5"> it's kind of concerning me and I was</font>

221
00:10:09,090 --> 00:10:15,180
a bit good with more about enterprise

222
00:10:11,760 --> 00:10:18,740
features of lenovo laptops<font color="#E5E5E5"> and well they</font>

223
00:10:15,180 --> 00:10:20,790
do have<font color="#E5E5E5"> windows management interface</font>

224
00:10:18,740 --> 00:10:24,780
<font color="#CCCCCC">basically which is communicating</font>

225
00:10:20,790 --> 00:10:26,760
faithfully to to the firmware and it's

226
00:10:24,780 --> 00:10:30,600
accessible from<font color="#E5E5E5"> the operating system</font>

227
00:10:26,760 --> 00:10:33,390
level<font color="#E5E5E5"> hmm how they can change</font><font color="#CCCCCC"> some</font>

228
00:10:30,600 --> 00:10:35,700
configurations<font color="#CCCCCC"> how they</font><font color="#E5E5E5"> basically</font>

229
00:10:33,390 --> 00:10:38,310
communicate<font color="#E5E5E5"> really with the buyers just</font>

230
00:10:35,700 --> 00:10:41,580
<font color="#E5E5E5">a static data or they</font><font color="#CCCCCC"> really have</font>

231
00:10:38,310 --> 00:10:43,770
something<font color="#E5E5E5"> which can</font><font color="#CCCCCC"> be really</font>

232
00:10:41,580 --> 00:10:46,530
<font color="#E5E5E5">interesting haven't really interesting</font>

233
00:10:43,770 --> 00:10:49,020
attack surface and also like we do have

234
00:10:46,530 --> 00:10:50,459
access<font color="#E5E5E5"> over the network to this</font>

235
00:10:49,020 --> 00:10:52,439
interface<font color="#CCCCCC"> of course because</font><font color="#E5E5E5"> it's</font>

236
00:10:50,460 --> 00:10:55,050
enterprise and<font color="#E5E5E5"> you need to</font><font color="#CCCCCC"> basically</font>

237
00:10:52,440 --> 00:10:57,570
deliver some changes on<font color="#E5E5E5"> the</font>

238
00:10:55,050 --> 00:11:00,900
<font color="#E5E5E5">configuration</font><font color="#CCCCCC"> to many machines in your</font>

239
00:10:57,570 --> 00:11:03,270
network<font color="#CCCCCC"> and it's actually how many</font>

240
00:11:00,900 --> 00:11:07,740
options<font color="#CCCCCC"> you have</font><font color="#E5E5E5"> to change over this</font>

241
00:11:03,270 --> 00:11:08,610
interface<font color="#E5E5E5"> and yeah it's like a lot and I</font>

242
00:11:07,740 --> 00:11:11,129
was<font color="#CCCCCC"> ok</font>

243
00:11:08,610 --> 00:11:15,059
what is<font color="#E5E5E5"> most interesting</font><font color="#CCCCCC"> for me and look</font>

244
00:11:11,129 --> 00:11:18,179
on it<font color="#CCCCCC"> so it's you can</font><font color="#E5E5E5"> disable 60 or</font>

245
00:11:15,059 --> 00:11:21,209
enable you can disable or enable<font color="#E5E5E5"> BIOS</font>

246
00:11:18,179 --> 00:11:23,569
<font color="#E5E5E5">update by end users you can disable or</font>

247
00:11:21,209 --> 00:11:25,799
enable security rollback prevention

248
00:11:23,569 --> 00:11:28,529
<font color="#CCCCCC">downgrade and use one days</font>

249
00:11:25,799 --> 00:11:32,939
also cool<font color="#CCCCCC"> but I was thinking it's</font>

250
00:11:28,529 --> 00:11:34,889
<font color="#E5E5E5">something else can be there too so how</font>

251
00:11:32,939 --> 00:11:40,469
<font color="#E5E5E5">basically you can extract this</font>

252
00:11:34,889 --> 00:11:43,559
information<font color="#E5E5E5"> I've been</font><font color="#CCCCCC"> using just</font><font color="#E5E5E5"> read</font>

253
00:11:40,470 --> 00:11:46,889
<font color="#E5E5E5">write everything which is not open</font>

254
00:11:43,559 --> 00:11:49,738
<font color="#CCCCCC">source but it's free tool I would say</font>

255
00:11:46,889 --> 00:11:52,529
the driver<font color="#E5E5E5"> is</font><font color="#CCCCCC"> very weird and</font><font color="#E5E5E5"> I would not</font>

256
00:11:49,739 --> 00:11:59,189
<font color="#E5E5E5">suggest to run on your real machines but</font>

257
00:11:52,529 --> 00:12:02,069
yeah<font color="#E5E5E5"> for research it's</font><font color="#CCCCCC"> code and I've</font>

258
00:11:59,189 --> 00:12:04,319
been dumping<font color="#E5E5E5"> ACPI tables and this</font>

259
00:12:02,069 --> 00:12:08,759
actually the table<font color="#E5E5E5"> these</font><font color="#CCCCCC"> tea it's the</font>

260
00:12:04,319 --> 00:12:10,199
name you<font color="#E5E5E5"> can easy to just grab</font><font color="#CCCCCC"> vmi and</font>

261
00:12:08,759 --> 00:12:11,549
<font color="#E5E5E5">the search you</font><font color="#CCCCCC"> can fold a lot of</font>

262
00:12:10,199 --> 00:12:13,469
instances<font color="#CCCCCC"> and</font><font color="#E5E5E5"> there's a lot of</font>

263
00:12:11,549 --> 00:12:15,959
<font color="#E5E5E5">configuration data which is can</font>

264
00:12:13,470 --> 00:12:21,179
basically just treated by string and

265
00:12:15,959 --> 00:12:23,699
it's like wow and<font color="#E5E5E5"> lenovo being very nice</font>

266
00:12:21,179 --> 00:12:26,040
they provided<font color="#E5E5E5"> even</font><font color="#CCCCCC"> the visual</font><font color="#E5E5E5"> basic</font>

267
00:12:23,699 --> 00:12:31,919
script to change<font color="#E5E5E5"> a supervisor password</font>

268
00:12:26,040 --> 00:12:34,709
from<font color="#E5E5E5"> the operating system and it's not</font>

269
00:12:31,919 --> 00:12:37,319
my script<font color="#CCCCCC"> i just downloaded from</font><font color="#E5E5E5"> lenovo</font>

270
00:12:34,709 --> 00:12:44,790
website<font color="#E5E5E5"> so well welcome to brave new</font>

271
00:12:37,319 --> 00:12:47,399
world and I was<font color="#CCCCCC"> thinking ok it's</font><font color="#E5E5E5"> cool</font>

272
00:12:44,790 --> 00:12:50,579
right<font color="#CCCCCC"> so we read the mutation but what</font>

273
00:12:47,399 --> 00:12:52,619
kind of components it can be in actual

274
00:12:50,579 --> 00:12:56,099
bias<font color="#E5E5E5"> which is basically provides</font><font color="#CCCCCC"> this</font>

275
00:12:52,619 --> 00:12:59,160
<font color="#E5E5E5">interfaces and</font><font color="#CCCCCC"> lenovo</font><font color="#E5E5E5"> removed</font>

276
00:12:56,100 --> 00:13:02,129
configuration update<font color="#E5E5E5"> sounds cool</font>

277
00:12:59,160 --> 00:13:04,949
<font color="#E5E5E5">and also</font><font color="#CCCCCC"> setup automation</font><font color="#E5E5E5"> setup under</font>

278
00:13:02,129 --> 00:13:08,009
<font color="#E5E5E5">operating system also sounds like a good</font>

279
00:13:04,949 --> 00:13:11,219
example but<font color="#E5E5E5"> lenovo setup under operating</font>

280
00:13:08,009 --> 00:13:13,439
system<font color="#CCCCCC"> SMM sounds more cool because its</font>

281
00:13:11,220 --> 00:13:17,579
system management mode and that's kind

282
00:13:13,439 --> 00:13:20,730
of<font color="#E5E5E5"> really not like more</font><font color="#CCCCCC"> privileges than</font>

283
00:13:17,579 --> 00:13:22,140
management<font color="#E5E5E5"> interface I mean like</font><font color="#CCCCCC"> intoa</font>

284
00:13:20,730 --> 00:13:24,150
<font color="#E5E5E5">me but it</font>

285
00:13:22,140 --> 00:13:26,220
interesting in a lot<font color="#CCCCCC"> of cases</font><font color="#E5E5E5"> because</font>

286
00:13:24,150 --> 00:13:28,079
<font color="#CCCCCC">you can actually</font><font color="#E5E5E5"> if you collect the</font>

287
00:13:26,220 --> 00:13:30,890
privileges to assume<font color="#CCCCCC"> arm you can</font><font color="#E5E5E5"> get a</font>

288
00:13:28,080 --> 00:13:33,630
access to the physical<font color="#E5E5E5"> memory and it's</font>

289
00:13:30,890 --> 00:13:35,699
sensitive for multiple security<font color="#E5E5E5"> features</font>

290
00:13:33,630 --> 00:13:43,220
on the machine based on<font color="#E5E5E5"> the</font><font color="#CCCCCC"> vo2 is Asian</font>

291
00:13:35,700 --> 00:13:47,190
so<font color="#CCCCCC"> ok</font><font color="#E5E5E5"> need to dig into that and actually</font>

292
00:13:43,220 --> 00:13:49,170
<font color="#CCCCCC">Lenovo setup andreas</font><font color="#E5E5E5"> have like this kind</font>

293
00:13:47,190 --> 00:13:53,010
of functionality and for me been

294
00:13:49,170 --> 00:13:55,219
interesting to look more<font color="#E5E5E5"> on actually</font>

295
00:13:53,010 --> 00:13:57,270
<font color="#E5E5E5">computerized disable and enable feature</font>

296
00:13:55,220 --> 00:13:59,040
<font color="#E5E5E5">because I've been reverse-engineered</font>

297
00:13:57,270 --> 00:14:03,300
computer<font color="#E5E5E5"> ace in my previous research</font>

298
00:13:59,040 --> 00:14:06,839
<font color="#CCCCCC">back to 2016</font><font color="#E5E5E5"> when presented in blackhat</font>

299
00:14:03,300 --> 00:14:08,699
<font color="#E5E5E5">Asia</font><font color="#CCCCCC"> route kids and actually it's</font>

300
00:14:06,840 --> 00:14:11,480
different realities for you fire

301
00:14:08,700 --> 00:14:11,480
rootkits<font color="#E5E5E5"> yeah</font>

302
00:14:11,640 --> 00:14:17,100
and<font color="#E5E5E5"> it's was actually very cool stuff</font>

303
00:14:15,780 --> 00:14:19,020
<font color="#E5E5E5">there because</font><font color="#CCCCCC"> we've been</font>

304
00:14:17,100 --> 00:14:21,900
reverse-engineered with my colleague we

305
00:14:19,020 --> 00:14:25,230
have<font color="#CCCCCC"> eugene Rodion of some of the</font>

306
00:14:21,900 --> 00:14:29,010
configuration for compute race and but

307
00:14:25,230 --> 00:14:32,190
like<font color="#E5E5E5"> i always</font><font color="#CCCCCC"> been thinking</font><font color="#E5E5E5"> they using a</font>

308
00:14:29,010 --> 00:14:34,680
hardware fuse to basically permanently

309
00:14:32,190 --> 00:14:37,470
<font color="#E5E5E5">disable in it but not true</font>

310
00:14:34,680 --> 00:14:40,319
so they<font color="#E5E5E5"> just use really a byte value but</font>

311
00:14:37,470 --> 00:14:43,650
we will<font color="#E5E5E5"> discuss</font><font color="#CCCCCC"> weight</font><font color="#E5E5E5"> a bit later so</font>

312
00:14:40,320 --> 00:14:46,290
<font color="#E5E5E5">lenovo</font><font color="#CCCCCC"> set up under operating system as</font>

313
00:14:43,650 --> 00:14:49,439
a<font color="#CCCCCC"> mam they do have a 12</font><font color="#E5E5E5"> SMI handlers</font>

314
00:14:46,290 --> 00:14:53,180
which is basically can be communicated

315
00:14:49,440 --> 00:14:58,920
<font color="#E5E5E5">from the windows management interface to</font>

316
00:14:53,180 --> 00:15:02,550
<font color="#E5E5E5">to to the buyers and what is interesting</font>

317
00:14:58,920 --> 00:15:04,170
thing you don't<font color="#E5E5E5"> need a actual driver</font>

318
00:15:02,550 --> 00:15:06,540
because usually to<font color="#E5E5E5"> call</font><font color="#CCCCCC"> us on my</font>

319
00:15:04,170 --> 00:15:09,870
handlers you need<font color="#E5E5E5"> a kernel mode</font>

320
00:15:06,540 --> 00:15:12,300
privileges to do it or<font color="#CCCCCC"> reeling</font><font color="#E5E5E5"> 0 so and</font>

321
00:15:09,870 --> 00:15:15,030
these windows<font color="#CCCCCC"> management interface you</font>

322
00:15:12,300 --> 00:15:18,990
just need to have administrator

323
00:15:15,030 --> 00:15:21,510
privileges which is much hidden to

324
00:15:18,990 --> 00:15:23,190
basically communicate with if it's will

325
00:15:21,510 --> 00:15:25,380
<font color="#CCCCCC">be malicious</font><font color="#E5E5E5"> actor inside your bias</font>

326
00:15:23,190 --> 00:15:30,780
right so basically<font color="#CCCCCC"> it's one more thing</font>

327
00:15:25,380 --> 00:15:34,170
for forensics<font color="#E5E5E5"> people in their own to be</font>

328
00:15:30,780 --> 00:15:35,230
considered as<font color="#CCCCCC"> attack surfaced for hidden</font>

329
00:15:34,170 --> 00:15:38,589
<font color="#E5E5E5">stuff</font>

330
00:15:35,230 --> 00:15:40,990
and<font color="#E5E5E5"> okay so actually</font><font color="#CCCCCC"> setup automation is</font>

331
00:15:38,590 --> 00:15:43,680
my handlers<font color="#E5E5E5"> so I've been</font>

332
00:15:40,990 --> 00:15:47,020
reverse-engineered just four of<font color="#E5E5E5"> them and</font>

333
00:15:43,680 --> 00:15:50,410
it's really<font color="#E5E5E5"> more</font><font color="#CCCCCC"> so you can see the list</font>

334
00:15:47,020 --> 00:15:53,860
it's a lot of<font color="#CCCCCC"> them so you can just use</font>

335
00:15:50,410 --> 00:15:57,579
<font color="#E5E5E5">father from chip</font><font color="#CCCCCC"> sack and some of them</font>

336
00:15:53,860 --> 00:16:00,520
actually<font color="#E5E5E5"> have problems with</font><font color="#CCCCCC"> call out</font>

337
00:15:57,580 --> 00:16:02,380
vulnerabilities which is<font color="#E5E5E5"> nothing user</font><font color="#CCCCCC"> I</font>

338
00:16:00,520 --> 00:16:04,270
think it's a lot<font color="#CCCCCC"> of</font><font color="#E5E5E5"> information</font><font color="#CCCCCC"> on</font>

339
00:16:02,380 --> 00:16:06,550
public<font color="#E5E5E5"> even on my presentation how you</font>

340
00:16:04,270 --> 00:16:09,280
can exploit it so I will<font color="#CCCCCC"> not go digging</font>

341
00:16:06,550 --> 00:16:11,380
into that because<font color="#E5E5E5"> yeah it's like nothing</font>

342
00:16:09,280 --> 00:16:15,339
<font color="#CCCCCC">new because</font><font color="#E5E5E5"> basically developers I think</font>

343
00:16:11,380 --> 00:16:19,180
<font color="#E5E5E5">just uses old version on new biases and</font>

344
00:16:15,340 --> 00:16:23,920
like don't<font color="#E5E5E5"> care about updating it so yep</font>

345
00:16:19,180 --> 00:16:26,410
<font color="#E5E5E5">and actually honestly speaking most of</font>

346
00:16:23,920 --> 00:16:29,199
<font color="#E5E5E5">the BIOS vendors they try to reduce a</font>

347
00:16:26,410 --> 00:16:32,469
number<font color="#CCCCCC"> of semi handlers in their biases</font>

348
00:16:29,200 --> 00:16:34,180
<font color="#CCCCCC">because they try to reduce attack</font>

349
00:16:32,470 --> 00:16:35,800
surface because it's like callback

350
00:16:34,180 --> 00:16:39,300
functions directly<font color="#CCCCCC"> to the operating</font>

351
00:16:35,800 --> 00:16:41,770
<font color="#E5E5E5">system</font><font color="#CCCCCC"> is it a</font><font color="#E5E5E5"> fast easy to attack and</font>

352
00:16:39,300 --> 00:16:44,579
privilege escalation to<font color="#E5E5E5"> assume am</font><font color="#CCCCCC"> its</font>

353
00:16:41,770 --> 00:16:48,550
kind of not<font color="#CCCCCC"> a good thing for</font><font color="#E5E5E5"> security</font>

354
00:16:44,580 --> 00:16:52,300
even if you can't persistently modify

355
00:16:48,550 --> 00:16:53,949
spy flash<font color="#E5E5E5"> you can leave</font><font color="#CCCCCC"> sometimes there</font>

356
00:16:52,300 --> 00:16:55,870
<font color="#E5E5E5">and think</font><font color="#CCCCCC"> about the servers right so</font>

357
00:16:53,950 --> 00:16:58,300
especially for<font color="#CCCCCC"> virtualization you</font><font color="#E5E5E5"> can</font>

358
00:16:55,870 --> 00:17:02,140
basically go<font color="#E5E5E5"> to privilege escalation to</font>

359
00:16:58,300 --> 00:17:04,530
<font color="#CCCCCC">SMM</font><font color="#E5E5E5"> then do some stuff and it's quite</font>

360
00:17:02,140 --> 00:17:08,379
enough because<font color="#E5E5E5"> you can your shellcode</font>

361
00:17:04,530 --> 00:17:15,940
<font color="#E5E5E5">actually will</font><font color="#CCCCCC"> be equal to</font><font color="#E5E5E5"> downtime for</font>

362
00:17:08,380 --> 00:17:18,550
the system okay and<font color="#E5E5E5"> let's dig more about</font>

363
00:17:15,940 --> 00:17:21,579
the compute race<font color="#CCCCCC"> and looks</font><font color="#E5E5E5"> like computer</font>

364
00:17:18,550 --> 00:17:25,119
<font color="#E5E5E5">is now or dies because</font><font color="#CCCCCC"> you can't really</font>

365
00:17:21,579 --> 00:17:26,800
<font color="#E5E5E5">disable so why basically I get</font><font color="#CCCCCC"> to</font>

366
00:17:25,119 --> 00:17:27,879
<font color="#E5E5E5">interested more on compute</font><font color="#CCCCCC"> rates because</font>

367
00:17:26,800 --> 00:17:32,110
it's been very<font color="#CCCCCC"> good and</font><font color="#E5E5E5"> interesting</font>

368
00:17:27,880 --> 00:17:38,290
research from the ESET<font color="#CCCCCC"> and the</font><font color="#E5E5E5"> guys</font>

369
00:17:32,110 --> 00:17:41,790
<font color="#CCCCCC">basically find first-known in the wild</font>

370
00:17:38,290 --> 00:17:45,909
rootkit<font color="#CCCCCC"> logics so it's being cool and</font>

371
00:17:41,790 --> 00:17:47,889
but my talk not about this one so my

372
00:17:45,910 --> 00:17:48,730
talk<font color="#E5E5E5"> about</font><font color="#CCCCCC"> the legit rootkit which is</font>

373
00:17:47,890 --> 00:17:53,260
<font color="#CCCCCC">Lenore</font>

374
00:17:48,730 --> 00:17:55,560
<font color="#E5E5E5">systems</font><font color="#CCCCCC"> has so and actually how many</font>

375
00:17:53,260 --> 00:18:03,900
people in the room usually<font color="#CCCCCC"> novel laptops</font>

376
00:17:55,560 --> 00:18:09,700
but just for<font color="#CCCCCC"> research so and think about</font>

377
00:18:03,900 --> 00:18:13,590
here is<font color="#E5E5E5"> the list of actually components</font>

378
00:18:09,700 --> 00:18:16,870
which is related<font color="#CCCCCC"> to directly</font><font color="#E5E5E5"> to Lenovo</font>

379
00:18:13,590 --> 00:18:18,909
not Lenovo actually absolute software

380
00:18:16,870 --> 00:18:20,739
<font color="#CCCCCC">computerized component</font><font color="#E5E5E5"> think is</font><font color="#CCCCCC"> like</font>

381
00:18:18,910 --> 00:18:23,770
<font color="#CCCCCC">lean over</font><font color="#E5E5E5"> really using the old</font><font color="#CCCCCC"> version</font>

382
00:18:20,740 --> 00:18:26,350
of it and they just<font color="#E5E5E5"> reuse on the even in</font>

383
00:18:23,770 --> 00:18:29,110
some<font color="#E5E5E5"> of the new laptops and problem is</font>

384
00:18:26,350 --> 00:18:31,570
they not updated<font color="#E5E5E5"> I don't know why maybe</font>

385
00:18:29,110 --> 00:18:35,379
<font color="#CCCCCC">likes a license</font><font color="#E5E5E5"> expired for updating</font>

386
00:18:31,570 --> 00:18:39,179
from the vendor and all the old<font color="#E5E5E5"> box</font><font color="#CCCCCC"> it's</font>

387
00:18:35,380 --> 00:18:42,280
still<font color="#E5E5E5"> there and it's kind of like</font>

388
00:18:39,180 --> 00:18:43,750
concerning me to continue using these

389
00:18:42,280 --> 00:18:50,470
laptops<font color="#CCCCCC"> but I really like it the</font>

390
00:18:43,750 --> 00:18:55,000
<font color="#E5E5E5">keyboard can survive from this</font><font color="#CCCCCC"> out</font><font color="#E5E5E5"> okay</font>

391
00:18:50,470 --> 00:18:57,400
so it's actually<font color="#E5E5E5"> why I was sure it's</font>

392
00:18:55,000 --> 00:18:59,110
cool stuff<font color="#E5E5E5"> for presentation because I've</font>

393
00:18:57,400 --> 00:19:00,760
been<font color="#CCCCCC"> tweeting a few weeks ago</font><font color="#E5E5E5"> and it's</font>

394
00:18:59,110 --> 00:19:03,780
like getting<font color="#E5E5E5"> a lot of intentional</font><font color="#CCCCCC"> oh</font>

395
00:19:00,760 --> 00:19:08,530
<font color="#E5E5E5">quite cool so</font><font color="#CCCCCC"> I need to dig more and</font>

396
00:19:03,780 --> 00:19:12,670
it's a slide from<font color="#CCCCCC"> my blackhat Asia 2016</font>

397
00:19:08,530 --> 00:19:15,100
presentation and here is options<font color="#E5E5E5"> from</font>

398
00:19:12,670 --> 00:19:16,900
your<font color="#E5E5E5"> BIOS</font><font color="#CCCCCC"> set up specifically</font><font color="#E5E5E5"> on the</font>

399
00:19:15,100 --> 00:19:19,780
computer a screen<font color="#CCCCCC"> and</font><font color="#E5E5E5"> you can see</font>

400
00:19:16,900 --> 00:19:23,920
<font color="#CCCCCC">actually it is an option</font><font color="#E5E5E5"> to permanent</font>

401
00:19:19,780 --> 00:19:29,110
<font color="#CCCCCC">disabling it</font><font color="#E5E5E5"> and it's not true so yep</font>

402
00:19:23,920 --> 00:19:31,570
<font color="#E5E5E5">that's moved yeah it's actually no</font>

403
00:19:29,110 --> 00:19:34,090
possible to permanent disable it because

404
00:19:31,570 --> 00:19:36,100
it<font color="#E5E5E5"> just software waked byte value which</font>

405
00:19:34,090 --> 00:19:39,209
is third in the<font color="#E5E5E5"> configuration which is</font>

406
00:19:36,100 --> 00:19:46,379
<font color="#E5E5E5">named at very scary as a hidden settings</font>

407
00:19:39,210 --> 00:19:48,910
and so it's<font color="#E5E5E5"> just showing some</font>

408
00:19:46,380 --> 00:19:52,110
architectural information about<font color="#E5E5E5"> a</font>

409
00:19:48,910 --> 00:19:54,820
<font color="#E5E5E5">computer ace so we do have some like</font>

410
00:19:52,110 --> 00:19:57,520
configurational data in<font color="#CCCCCC"> to storages</font>

411
00:19:54,820 --> 00:20:01,210
which is named a security config<font color="#E5E5E5"> and</font>

412
00:19:57,520 --> 00:20:02,470
hidden setting so and actually compute

413
00:20:01,210 --> 00:20:05,590
<font color="#CCCCCC">rays have a SMI</font>

414
00:20:02,470 --> 00:20:08,220
service broker<font color="#E5E5E5"> which is managing</font><font color="#CCCCCC"> its</font><font color="#E5E5E5"> my</font>

415
00:20:05,590 --> 00:20:12,449
calls between different components<font color="#CCCCCC"> and</font>

416
00:20:08,220 --> 00:20:15,400
actually also have some secure way

417
00:20:12,450 --> 00:20:21,669
<font color="#E5E5E5">communicating</font><font color="#CCCCCC"> with sensitive components</font>

418
00:20:15,400 --> 00:20:24,309
over<font color="#CCCCCC"> a mailbox</font><font color="#E5E5E5"> in</font><font color="#CCCCCC"> SMM</font><font color="#E5E5E5"> but if you reverse</font>

419
00:20:21,669 --> 00:20:26,470
engineer<font color="#E5E5E5"> the interface not even the</font>

420
00:20:24,309 --> 00:20:28,570
mailbox<font color="#E5E5E5"> how basically you properly</font>

421
00:20:26,470 --> 00:20:32,460
communicating with SMI handlers<font color="#E5E5E5"> you</font>

422
00:20:28,570 --> 00:20:36,820
don't<font color="#E5E5E5"> even need to deep to</font><font color="#CCCCCC"> mailbox stuff</font>

423
00:20:32,460 --> 00:20:39,520
<font color="#E5E5E5">which is</font><font color="#CCCCCC"> also</font><font color="#E5E5E5"> quite scary because it's</font>

424
00:20:36,820 --> 00:20:40,720
<font color="#E5E5E5">really make things easier for</font><font color="#CCCCCC"> the</font>

425
00:20:39,520 --> 00:20:44,620
attacker to understand

426
00:20:40,720 --> 00:20:46,929
<font color="#E5E5E5">so it's record structure for</font><font color="#CCCCCC"> lanova</font>

427
00:20:44,620 --> 00:20:50,799
security conflicts<font color="#E5E5E5"> actually a lot of</font>

428
00:20:46,929 --> 00:20:55,659
values unknown<font color="#E5E5E5"> you can see last value</font>

429
00:20:50,799 --> 00:20:57,908
<font color="#E5E5E5">it's</font><font color="#CCCCCC"> 80</font><font color="#E5E5E5"> byte by its fields or I don't</font>

430
00:20:55,659 --> 00:21:01,600
<font color="#E5E5E5">know maybe some of them it's not really</font>

431
00:20:57,909 --> 00:21:04,240
<font color="#E5E5E5">bytes but I don't know what is it but I</font>

432
00:21:01,600 --> 00:21:06,340
recover a lot<font color="#E5E5E5"> of interesting stuff which</font>

433
00:21:04,240 --> 00:21:08,289
<font color="#E5E5E5">I</font><font color="#CCCCCC"> already discussed</font><font color="#E5E5E5"> and what of them</font>

434
00:21:06,340 --> 00:21:10,720
<font color="#E5E5E5">it's like</font><font color="#CCCCCC"> a secure boot which</font><font color="#E5E5E5"> is an</font>

435
00:21:08,289 --> 00:21:13,150
option in BIOS setup and it's tied to

436
00:21:10,720 --> 00:21:18,970
<font color="#CCCCCC">lean over</font><font color="#E5E5E5"> security</font><font color="#CCCCCC"> config</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> it's</font>

437
00:21:13,150 --> 00:21:21,940
<font color="#E5E5E5">actually can be changed over VMI but you</font>

438
00:21:18,970 --> 00:21:30,990
need a supervisor password which<font color="#CCCCCC"> is also</font>

439
00:21:21,940 --> 00:21:36,370
<font color="#CCCCCC">we'll be discussing</font><font color="#E5E5E5"> a bit later so</font>

440
00:21:30,990 --> 00:21:39,400
<font color="#E5E5E5">computer a services</font><font color="#CCCCCC"> it's yes so</font>

441
00:21:36,370 --> 00:21:42,219
<font color="#E5E5E5">basically my most interested it's been</font>

442
00:21:39,400 --> 00:21:47,140
SMI handlers table which is<font color="#E5E5E5"> has a tree</font>

443
00:21:42,220 --> 00:21:48,700
is my handlers and it's actually a staff

444
00:21:47,140 --> 00:21:51,789
been<font color="#E5E5E5"> reverse-engineered for block</font>

445
00:21:48,700 --> 00:21:54,490
<font color="#CCCCCC">artesia</font><font color="#E5E5E5"> for my talk and that time</font><font color="#CCCCCC"> i</font>

446
00:21:51,789 --> 00:21:58,150
actually<font color="#E5E5E5"> didn't know what</font><font color="#CCCCCC"> exactly is my</font>

447
00:21:54,490 --> 00:22:01,090
handlers doing and<font color="#E5E5E5"> I get more interested</font>

448
00:21:58,150 --> 00:22:03,610
<font color="#CCCCCC">actually for this particular research</font>

449
00:22:01,090 --> 00:22:06,459
when I discover it's no way how you can

450
00:22:03,610 --> 00:22:08,709
permanently disable or enable right so

451
00:22:06,460 --> 00:22:11,320
actually you have a<font color="#E5E5E5"> compute</font><font color="#CCCCCC"> raise</font><font color="#E5E5E5"> enable</font>

452
00:22:08,710 --> 00:22:13,690
<font color="#CCCCCC">disable and you can understand what kind</font>

453
00:22:11,320 --> 00:22:15,520
<font color="#CCCCCC">of configuration you currently have to</font>

454
00:22:13,690 --> 00:22:20,650
call a computer a state

455
00:22:15,520 --> 00:22:22,780
and also you need<font color="#CCCCCC"> to call some</font><font color="#E5E5E5"> of the</font>

456
00:22:20,650 --> 00:22:25,210
computer is enable action<font color="#E5E5E5"> or</font><font color="#CCCCCC"> disable</font>

457
00:22:22,780 --> 00:22:27,300
action from the windows<font color="#CCCCCC"> management</font>

458
00:22:25,210 --> 00:22:31,120
interface

459
00:22:27,300 --> 00:22:35,020
yes that's kind of like<font color="#E5E5E5"> interesting</font>

460
00:22:31,120 --> 00:22:38,050
information<font color="#E5E5E5"> to think</font><font color="#CCCCCC"> about</font><font color="#E5E5E5"> to basically</font>

461
00:22:35,020 --> 00:22:39,970
maybe you need just<font color="#E5E5E5"> switch your lovely</font>

462
00:22:38,050 --> 00:22:44,590
keyboard from Lenovo laptop something

463
00:22:39,970 --> 00:22:48,990
else but yeah<font color="#E5E5E5"> let's dig</font><font color="#CCCCCC"> in to</font><font color="#E5E5E5"> compute</font>

464
00:22:44,590 --> 00:22:54,970
<font color="#CCCCCC">ray services and actually I've been</font>

465
00:22:48,990 --> 00:22:57,720
<font color="#CCCCCC">looking on</font><font color="#E5E5E5"> how basically the</font><font color="#CCCCCC"> flow</font>

466
00:22:54,970 --> 00:23:02,500
<font color="#E5E5E5">working and I was discover interesting</font>

467
00:22:57,720 --> 00:23:04,960
value in in veeram environment which

468
00:23:02,500 --> 00:23:10,840
<font color="#CCCCCC">stores sums the</font><font color="#E5E5E5"> configurational data</font>

469
00:23:04,960 --> 00:23:14,920
which is known as as a you<font color="#CCCCCC"> five</font>

470
00:23:10,840 --> 00:23:16,870
variables so and yeah you can<font color="#CCCCCC"> just dump</font>

471
00:23:14,920 --> 00:23:20,260
<font color="#E5E5E5">it with some of the tools like</font><font color="#CCCCCC"> a cheap</font>

472
00:23:16,870 --> 00:23:22,810
<font color="#CCCCCC">sake</font><font color="#E5E5E5"> or you just can use if you have a</font>

473
00:23:20,260 --> 00:23:24,940
<font color="#E5E5E5">driver like reader</font><font color="#CCCCCC"> right everything</font><font color="#E5E5E5"> you</font>

474
00:23:22,810 --> 00:23:30,970
can just<font color="#E5E5E5"> browse some of specific memory</font>

475
00:23:24,940 --> 00:23:35,200
region to get<font color="#E5E5E5"> that and unfortunately</font><font color="#CCCCCC"> I</font>

476
00:23:30,970 --> 00:23:38,230
just reverse engineer<font color="#CCCCCC"> it one field but</font>

477
00:23:35,200 --> 00:23:40,510
it's you can<font color="#E5E5E5"> see it's more there so one</font>

478
00:23:38,230 --> 00:23:46,690
field which is basically tied to<font color="#CCCCCC"> compute</font>

479
00:23:40,510 --> 00:23:50,620
<font color="#CCCCCC">rate state and other thing as</font><font color="#E5E5E5"> I</font><font color="#CCCCCC"> already</font>

480
00:23:46,690 --> 00:23:53,080
mention its security config from<font color="#CCCCCC"> also</font>

481
00:23:50,620 --> 00:23:55,929
it's a variable<font color="#E5E5E5"> and it's like really a</font>

482
00:23:53,080 --> 00:23:59,500
bit<font color="#E5E5E5"> filled with some of the values which</font>

483
00:23:55,930 --> 00:24:04,780
is basically true or false<font color="#E5E5E5"> positional</font>

484
00:23:59,500 --> 00:24:06,760
and also here is a reconstructed<font color="#CCCCCC"> Lenovo</font>

485
00:24:04,780 --> 00:24:09,879
security config which is we<font color="#E5E5E5"> already</font>

486
00:24:06,760 --> 00:24:13,690
discussed and all these bit values it's

487
00:24:09,880 --> 00:24:16,360
actually about<font color="#E5E5E5"> byte</font><font color="#CCCCCC"> it's actually one</font>

488
00:24:13,690 --> 00:24:24,700
byte it's one<font color="#CCCCCC"> configuration data and it</font>

489
00:24:16,360 --> 00:24:28,990
has just<font color="#E5E5E5"> one for to be true and actually</font>

490
00:24:24,700 --> 00:24:33,340
here is reconstructed flow<font color="#CCCCCC"> to</font>

491
00:24:28,990 --> 00:24:36,160
<font color="#CCCCCC">security config and</font><font color="#E5E5E5"> changing the</font>

492
00:24:33,340 --> 00:24:38,530
different states<font color="#E5E5E5"> and it's quite complex</font>

493
00:24:36,160 --> 00:24:41,620
so<font color="#E5E5E5"> I will not dig into the assembly</font>

494
00:24:38,530 --> 00:24:43,840
because<font color="#E5E5E5"> it's no need for that and it's</font>

495
00:24:41,620 --> 00:24:46,919
ugly<font color="#CCCCCC"> when I've been reconstructed it I</font>

496
00:24:43,840 --> 00:24:49,720
mean like<font color="#E5E5E5"> not</font><font color="#CCCCCC"> assemblies ugly just like</font>

497
00:24:46,920 --> 00:24:55,059
the tool not providing a really<font color="#E5E5E5"> readable</font>

498
00:24:49,720 --> 00:24:59,130
code and<font color="#E5E5E5"> even after my try to beautify</font>

499
00:24:55,059 --> 00:25:02,170
the code manually<font color="#CCCCCC"> it looks not that good</font>

500
00:24:59,130 --> 00:25:05,500
unfortunately and yes<font color="#CCCCCC"> i</font><font color="#E5E5E5"> reconstructed</font>

501
00:25:02,170 --> 00:25:08,410
just basically put some most important

502
00:25:05,500 --> 00:25:14,050
<font color="#CCCCCC">information and and this zelda code</font>

503
00:25:08,410 --> 00:25:17,920
<font color="#CCCCCC">slide</font><font color="#E5E5E5"> so basically it's values which is</font>

504
00:25:14,050 --> 00:25:20,530
code to compute<font color="#CCCCCC"> race enable and then you</font>

505
00:25:17,920 --> 00:25:23,050
<font color="#CCCCCC">basically can switch the state between</font>

506
00:25:20,530 --> 00:25:26,428
<font color="#E5E5E5">false and true it's really</font><font color="#CCCCCC"> a to Eve's</font>

507
00:25:23,050 --> 00:25:30,580
<font color="#E5E5E5">and nothing else so it's checking first</font>

508
00:25:26,429 --> 00:25:36,700
compute race<font color="#E5E5E5"> state is supported then</font>

509
00:25:30,580 --> 00:25:38,949
<font color="#E5E5E5">basically change</font><font color="#CCCCCC"> the configuration but</font>

510
00:25:36,700 --> 00:25:42,610
most<font color="#E5E5E5"> interesting also</font><font color="#CCCCCC"> it's</font><font color="#E5E5E5"> it's my</font>

511
00:25:38,950 --> 00:25:47,740
compute race<font color="#E5E5E5"> disable it</font><font color="#CCCCCC"> and computer a</font>

512
00:25:42,610 --> 00:25:50,050
state have<font color="#CCCCCC"> three actually</font><font color="#E5E5E5"> four values</font>

513
00:25:47,740 --> 00:25:52,900
three boolean values which is enabled

514
00:25:50,050 --> 00:25:55,870
<font color="#CCCCCC">active and</font><font color="#E5E5E5"> disabled so you basically can</font>

515
00:25:52,900 --> 00:26:00,790
<font color="#E5E5E5">control the state and understand it's</font>

516
00:25:55,870 --> 00:26:04,330
active or not so and one of the things

517
00:26:00,790 --> 00:26:04,840
which was I been like wow that<font color="#E5E5E5"> sounds</font>

518
00:26:04,330 --> 00:26:07,178
interesting

519
00:26:04,840 --> 00:26:09,220
it was a<font color="#E5E5E5"> disabled secret key because I</font>

520
00:26:07,179 --> 00:26:12,760
was<font color="#CCCCCC"> discount</font><font color="#E5E5E5"> it's sending some white</font>

521
00:26:09,220 --> 00:26:15,929
value but<font color="#E5E5E5"> this value being derived by</font>

522
00:26:12,760 --> 00:26:17,830
something<font color="#E5E5E5"> bigger for the four bytes and</font>

523
00:26:15,929 --> 00:26:20,470
what deliberation

524
00:26:17,830 --> 00:26:22,659
it's like symmetric so you basically

525
00:26:20,470 --> 00:26:25,200
<font color="#E5E5E5">don't need no to know any secrets</font><font color="#CCCCCC"> you</font>

526
00:26:22,660 --> 00:26:29,440
<font color="#E5E5E5">just need to send</font><font color="#CCCCCC"> the correct byte value</font>

527
00:26:25,200 --> 00:26:31,900
so cool I not really to dig into<font color="#E5E5E5"> that</font>

528
00:26:29,440 --> 00:26:35,590
<font color="#E5E5E5">right so here is how it's matching the</font>

529
00:26:31,900 --> 00:26:41,350
<font color="#E5E5E5">keys and this key</font><font color="#CCCCCC"> you need</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> basically</font>

530
00:26:35,590 --> 00:26:42,730
permanent<font color="#E5E5E5"> disable the compute race or</font>

531
00:26:41,350 --> 00:26:49,320
enable from

532
00:26:42,730 --> 00:26:52,360
from the operating<font color="#E5E5E5"> system and</font><font color="#CCCCCC"> yeah</font><font color="#E5E5E5"> so</font>

533
00:26:49,320 --> 00:26:54,399
matching the key it's<font color="#CCCCCC"> not a constant</font>

534
00:26:52,360 --> 00:26:55,959
time cool right so<font color="#E5E5E5"> we</font><font color="#CCCCCC"> can brute force</font>

535
00:26:54,400 --> 00:26:58,780
because it<font color="#E5E5E5"> can be called</font><font color="#CCCCCC"> from the</font>

536
00:26:55,960 --> 00:27:03,220
operating<font color="#CCCCCC"> system level</font><font color="#E5E5E5"> and I was</font>

537
00:26:58,780 --> 00:27:08,530
<font color="#CCCCCC">thinking what kind of fuzzing ideas I</font>

538
00:27:03,220 --> 00:27:09,160
can implement and<font color="#E5E5E5"> okay one byte value</font>

539
00:27:08,530 --> 00:27:12,910
secret

540
00:27:09,160 --> 00:27:15,850
stir it in spy flash in the RAM and can

541
00:27:12,910 --> 00:27:24,340
be different by<font color="#E5E5E5"> laptop model yes</font><font color="#CCCCCC"> I have</font>

542
00:27:15,850 --> 00:27:28,719
also in my<font color="#E5E5E5"> lab</font><font color="#CCCCCC"> t oh yes t54 zero P which</font>

543
00:27:24,340 --> 00:27:31,179
is<font color="#E5E5E5"> have a different value but probably</font>

544
00:27:28,720 --> 00:27:32,980
<font color="#E5E5E5">means like it's kind of all the laptop</font>

545
00:27:31,180 --> 00:27:35,740
and P 50 it's more interesting<font color="#E5E5E5"> because</font>

546
00:27:32,980 --> 00:27:38,440
it's have a sky wake and actually<font color="#CCCCCC"> new</font>

547
00:27:35,740 --> 00:27:41,290
<font color="#CCCCCC">world wine</font><font color="#E5E5E5"> on</font><font color="#CCCCCC"> PS has</font><font color="#E5E5E5"> the same problems</font>

548
00:27:38,440 --> 00:27:43,480
as a mine<font color="#E5E5E5"> and</font><font color="#CCCCCC"> it's</font><font color="#E5E5E5"> fin</font><font color="#CCCCCC"> wet so it's</font><font color="#E5E5E5"> Fink</font>

549
00:27:41,290 --> 00:27:46,659
pets<font color="#CCCCCC"> as a mobile workstation have a like</font>

550
00:27:43,480 --> 00:27:49,570
<font color="#E5E5E5">zero on CPU on board so it's quite cool</font>

551
00:27:46,660 --> 00:27:55,540
laptop<font color="#E5E5E5"> I was like it but now just for</font>

552
00:27:49,570 --> 00:27:58,659
<font color="#CCCCCC">research so and basically</font><font color="#E5E5E5"> it's small</font>

553
00:27:55,540 --> 00:28:03,129
script on<font color="#E5E5E5"> Python like</font><font color="#CCCCCC"> it's zero code</font>

554
00:27:58,660 --> 00:28:05,230
mostly to<font color="#CCCCCC"> brute-force</font><font color="#E5E5E5"> with the</font><font color="#CCCCCC"> chips X</font>

555
00:28:03,130 --> 00:28:07,530
so you<font color="#E5E5E5"> can call this my handler</font><font color="#CCCCCC"> you can</font>

556
00:28:05,230 --> 00:28:10,810
just boot for this<font color="#CCCCCC"> SMI value because</font>

557
00:28:07,530 --> 00:28:14,740
actually they don't have a constant time

558
00:28:10,810 --> 00:28:17,020
<font color="#E5E5E5">so you can even make it brute-force even</font>

559
00:28:14,740 --> 00:28:19,150
faster than I do but<font color="#E5E5E5"> it was enough</font>

560
00:28:17,020 --> 00:28:22,389
because<font color="#CCCCCC"> byte value it's not too much too</font>

561
00:28:19,150 --> 00:28:28,060
fast<font color="#E5E5E5"> so fast check repeat profit the</font>

562
00:28:22,390 --> 00:28:29,890
<font color="#E5E5E5">same</font><font color="#CCCCCC"> okie is 57 by hex</font><font color="#E5E5E5"> and actually it</font>

563
00:28:28,060 --> 00:28:34,860
was<font color="#E5E5E5"> really fast it's</font><font color="#CCCCCC"> like less than</font><font color="#E5E5E5"> ten</font>

564
00:28:29,890 --> 00:28:34,860
<font color="#E5E5E5">minutes</font><font color="#CCCCCC"> to brute force</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> okay</font>

565
00:28:35,880 --> 00:28:41,710
my concerns on<font color="#E5E5E5"> compute rate so it's</font>

566
00:28:39,430 --> 00:28:46,050
actually<font color="#E5E5E5"> it's a good idea to have a</font>

567
00:28:41,710 --> 00:28:51,070
<font color="#E5E5E5">antes</font><font color="#CCCCCC"> air for enterprise but kind</font><font color="#E5E5E5"> of</font>

568
00:28:46,050 --> 00:28:55,060
like<font color="#E5E5E5"> its third party component and it's</font>

569
00:28:51,070 --> 00:28:56,439
not very well updated by vendor and it's

570
00:28:55,060 --> 00:28:58,120
<font color="#E5E5E5">also shows a problem</font>

571
00:28:56,440 --> 00:29:00,610
with a supply chain<font color="#CCCCCC"> because basically</font>

572
00:28:58,120 --> 00:29:03,429
the vendor<font color="#E5E5E5"> maybe they lose the license</font>

573
00:29:00,610 --> 00:29:08,580
or they not lose<font color="#E5E5E5"> like they just not</font>

574
00:29:03,430 --> 00:29:11,890
continue the license or they just don't

575
00:29:08,580 --> 00:29:15,100
don't want to<font color="#E5E5E5"> basically continue or they</font>

576
00:29:11,890 --> 00:29:17,770
<font color="#CCCCCC">just basically support the old version</font>

577
00:29:15,100 --> 00:29:22,270
whatever so supply chain<font color="#E5E5E5"> problem here is</font>

578
00:29:17,770 --> 00:29:25,750
<font color="#E5E5E5">pretty</font><font color="#CCCCCC"> clear and okay</font><font color="#E5E5E5"> you do have a</font>

579
00:29:22,270 --> 00:29:28,990
laptop<font color="#E5E5E5"> but you can't really disable this</font>

580
00:29:25,750 --> 00:29:32,440
feature for forever<font color="#CCCCCC"> so and all</font><font color="#E5E5E5"> these</font>

581
00:29:28,990 --> 00:29:34,540
drivers<font color="#E5E5E5"> on each boot it appears so</font><font color="#CCCCCC"> and</font>

582
00:29:32,440 --> 00:29:37,120
communicating from the operating<font color="#E5E5E5"> system</font>

583
00:29:34,540 --> 00:29:39,970
level it's possible and it's proven so

584
00:29:37,120 --> 00:29:41,739
you can see it works<font color="#CCCCCC"> just try on</font><font color="#E5E5E5"> the</font>

585
00:29:39,970 --> 00:29:45,670
script<font color="#E5E5E5"> and you can</font><font color="#CCCCCC"> brute-force your</font>

586
00:29:41,740 --> 00:29:50,710
value so on this<font color="#E5E5E5"> disabled key value on</font>

587
00:29:45,670 --> 00:29:53,350
your Lenovo<font color="#E5E5E5"> laptop so and yeah and</font>

588
00:29:50,710 --> 00:29:57,660
<font color="#E5E5E5">actually number of a semi handlers it's</font>

589
00:29:53,350 --> 00:30:00,280
huge so overall it's more than a<font color="#CCCCCC"> 20 and</font>

590
00:29:57,660 --> 00:30:02,680
currently modern biases they try to

591
00:30:00,280 --> 00:30:05,710
reduce actually have a less<font color="#CCCCCC"> than</font><font color="#E5E5E5"> 20</font>

592
00:30:02,680 --> 00:30:09,340
inside<font color="#E5E5E5"> like for all the is my services</font>

593
00:30:05,710 --> 00:30:14,380
which communicating from<font color="#CCCCCC"> SMM</font><font color="#E5E5E5"> to</font>

594
00:30:09,340 --> 00:30:20,020
operating<font color="#E5E5E5"> system and yeah it's quite</font>

595
00:30:14,380 --> 00:30:23,380
dangerous stuff so and one more thing

596
00:30:20,020 --> 00:30:25,750
I've been<font color="#E5E5E5"> try to research for this</font>

597
00:30:23,380 --> 00:30:28,170
research and actually<font color="#E5E5E5"> it's also</font>

598
00:30:25,750 --> 00:30:32,170
interesting<font color="#CCCCCC"> its embedded controller and</font>

599
00:30:28,170 --> 00:30:36,960
embedded controller historically<font color="#E5E5E5"> seats</font>

600
00:30:32,170 --> 00:30:41,950
on x86<font color="#E5E5E5"> platform very long time and</font>

601
00:30:36,960 --> 00:30:44,470
<font color="#E5E5E5">usually as a TPM on my first wise it's</font>

602
00:30:41,950 --> 00:30:46,750
not really<font color="#CCCCCC"> considered as a security</font>

603
00:30:44,470 --> 00:30:51,670
<font color="#E5E5E5">boundary because</font><font color="#CCCCCC"> basically if you get</font>

604
00:30:46,750 --> 00:30:54,100
into that<font color="#CCCCCC"> embedded controller has a DMA</font>

605
00:30:51,670 --> 00:30:56,500
access and a<font color="#CCCCCC"> lot</font><font color="#E5E5E5"> of other stuff which</font><font color="#CCCCCC"> is</font>

606
00:30:54,100 --> 00:31:00,969
<font color="#E5E5E5">can be basically attack other components</font>

607
00:30:56,500 --> 00:31:06,040
and multiple<font color="#CCCCCC"> stuff is just</font><font color="#E5E5E5"> not</font><font color="#CCCCCC"> a</font>

608
00:31:00,970 --> 00:31:08,320
considerate from going that way<font color="#CCCCCC"> so okay</font>

609
00:31:06,040 --> 00:31:10,420
it's basically<font color="#CCCCCC"> but the controller just</font>

610
00:31:08,320 --> 00:31:13,750
<font color="#CCCCCC">dump it from the</font><font color="#E5E5E5"> documentation of</font>

611
00:31:10,420 --> 00:31:17,680
my Lenovo p50<font color="#CCCCCC"> a vendor it's basically</font>

612
00:31:13,750 --> 00:31:20,770
microchip<font color="#E5E5E5"> so yeah it's quite</font><font color="#CCCCCC"> good so and</font>

613
00:31:17,680 --> 00:31:23,410
a lot<font color="#CCCCCC"> of</font><font color="#E5E5E5"> stuff there it's even support</font>

614
00:31:20,770 --> 00:31:26,800
the<font color="#CCCCCC"> BIOS guard features and we'll talk a</font>

615
00:31:23,410 --> 00:31:34,300
<font color="#E5E5E5">bit about that later</font>

616
00:31:26,800 --> 00:31:37,899
so actually<font color="#E5E5E5"> yeah it's interesting</font>

617
00:31:34,300 --> 00:31:40,470
because embedded controller<font color="#E5E5E5"> update tools</font>

618
00:31:37,900 --> 00:31:43,600
<font color="#E5E5E5">it's usually have a separate flow and</font>

619
00:31:40,470 --> 00:31:45,250
<font color="#E5E5E5">house works so you run the tool</font>

620
00:31:43,600 --> 00:31:47,590
the to communicate with embedded

621
00:31:45,250 --> 00:31:50,200
controller<font color="#E5E5E5"> say</font><font color="#CCCCCC"> ok we</font><font color="#E5E5E5"> switch to the</font>

622
00:31:47,590 --> 00:31:53,830
update mode<font color="#E5E5E5"> embedded controller took</font>

623
00:31:50,200 --> 00:31:56,290
this and update container inside the

624
00:31:53,830 --> 00:32:00,480
internal<font color="#CCCCCC"> memory and then verify</font><font color="#E5E5E5"> the</font>

625
00:31:56,290 --> 00:32:03,790
update it's in<font color="#CCCCCC"> perfect world</font><font color="#E5E5E5"> how its</font>

626
00:32:00,480 --> 00:32:06,970
works in the real world<font color="#CCCCCC"> so some of</font><font color="#E5E5E5"> the</font>

627
00:32:03,790 --> 00:32:09,010
<font color="#CCCCCC">vendors not microchip microchip actually</font>

628
00:32:06,970 --> 00:32:13,090
have a good verification<font color="#E5E5E5"> but some of the</font>

629
00:32:09,010 --> 00:32:17,860
<font color="#CCCCCC">vendors just don't verify properly</font>

630
00:32:13,090 --> 00:32:20,740
<font color="#CCCCCC">they're packaged for update and or even</font>

631
00:32:17,860 --> 00:32:23,830
<font color="#CCCCCC">dot</font><font color="#E5E5E5"> have zero verification just</font><font color="#CCCCCC"> coke</font>

632
00:32:20,740 --> 00:32:25,480
awaiting the<font color="#CCCCCC"> cash as a</font><font color="#E5E5E5"> series III 32</font>

633
00:32:23,830 --> 00:32:31,230
which is<font color="#E5E5E5"> not really a hash right so</font>

634
00:32:25,480 --> 00:32:33,460
checksum for container<font color="#E5E5E5"> being properly</font>

635
00:32:31,230 --> 00:32:38,820
delivered to the internal memory<font color="#E5E5E5"> and</font>

636
00:32:33,460 --> 00:32:40,270
<font color="#CCCCCC">just go into update okay and actually</font>

637
00:32:38,820 --> 00:32:43,360
one more<font color="#CCCCCC"> thing</font>

638
00:32:40,270 --> 00:32:46,060
I was basically try on this<font color="#E5E5E5"> part to</font>

639
00:32:43,360 --> 00:32:48,189
deliver one more<font color="#E5E5E5"> interesting bug but</font>

640
00:32:46,060 --> 00:32:50,320
it's still under responsible disclosure

641
00:32:48,190 --> 00:32:54,880
<font color="#CCCCCC">I will not drop the name of the</font><font color="#E5E5E5"> vendor</font>

642
00:32:50,320 --> 00:32:57,340
but<font color="#E5E5E5"> I can talk about the bug so</font><font color="#CCCCCC"> work is</font>

643
00:32:54,880 --> 00:32:59,530
<font color="#E5E5E5">very interesting because what one of the</font>

644
00:32:57,340 --> 00:33:02,620
vendors<font color="#CCCCCC"> of embedded controller does</font><font color="#E5E5E5"> so</font>

645
00:32:59,530 --> 00:33:06,490
they have<font color="#E5E5E5"> a update package</font><font color="#CCCCCC"> and has a</font>

646
00:33:02,620 --> 00:33:09,669
signature<font color="#E5E5E5"> like a public key on the on</font>

647
00:33:06,490 --> 00:33:15,460
the end<font color="#E5E5E5"> and</font><font color="#CCCCCC"> cash value actually</font><font color="#E5E5E5"> cash</font>

648
00:33:09,670 --> 00:33:17,680
value it's<font color="#E5E5E5"> not</font><font color="#CCCCCC"> crc32</font><font color="#E5E5E5"> it's</font><font color="#CCCCCC"> SH</font><font color="#E5E5E5"> 256 which</font>

649
00:33:15,460 --> 00:33:20,230
is good<font color="#CCCCCC"> I've</font><font color="#E5E5E5"> been wow that's cool but</font>

650
00:33:17,680 --> 00:33:24,010
let's<font color="#E5E5E5"> play with this update what if we</font>

651
00:33:20,230 --> 00:33:27,010
modify<font color="#E5E5E5"> the hash okay it's not</font>

652
00:33:24,010 --> 00:33:29,200
it's<font color="#CCCCCC"> return something</font><font color="#E5E5E5"> weird and not go</font>

653
00:33:27,010 --> 00:33:31,990
well for<font color="#E5E5E5"> update</font><font color="#CCCCCC"> okay there</font><font color="#E5E5E5"> they check</font>

654
00:33:29,200 --> 00:33:35,830
<font color="#E5E5E5">the hash okay let's modify one</font><font color="#CCCCCC"> bit</font><font color="#E5E5E5"> of</font>

655
00:33:31,990 --> 00:33:39,100
update actually<font color="#CCCCCC"> record itself or package</font>

656
00:33:35,830 --> 00:33:42,340
whatever<font color="#CCCCCC"> so boom it's been</font><font color="#E5E5E5"> delivered but</font>

657
00:33:39,100 --> 00:33:46,928
what firm<font color="#CCCCCC"> actually been not</font><font color="#E5E5E5"> booting okay</font>

658
00:33:42,340 --> 00:33:50,139
so it's<font color="#CCCCCC"> been a bad idea but anyway</font><font color="#E5E5E5"> so on</font>

659
00:33:46,929 --> 00:33:54,519
<font color="#E5E5E5">different platform is the same chip</font><font color="#CCCCCC"> I</font>

660
00:33:50,139 --> 00:33:57,279
was<font color="#CCCCCC"> okay let's actually try</font><font color="#E5E5E5"> to</font>

661
00:33:54,519 --> 00:34:00,580
reconstruct<font color="#E5E5E5"> the flow modify the update</font>

662
00:33:57,279 --> 00:34:04,059
but have the<font color="#CCCCCC"> same cache and it was fun</font>

663
00:34:00,580 --> 00:34:07,059
<font color="#E5E5E5">it's</font><font color="#CCCCCC"> work</font><font color="#E5E5E5"> so problem was actually the</font>

664
00:34:04,059 --> 00:34:11,109
<font color="#CCCCCC">vendor signed the cache but don't check</font>

665
00:34:07,059 --> 00:34:13,810
the cash versus update itself which is

666
00:34:11,109 --> 00:34:15,940
cool<font color="#CCCCCC"> right so</font><font color="#E5E5E5"> okay yeah it will be</font>

667
00:34:13,810 --> 00:34:20,770
<font color="#E5E5E5">faster right so why we need to check the</font>

668
00:34:15,940 --> 00:34:23,950
cache yeah<font color="#E5E5E5"> so probably a little bit</font>

669
00:34:20,770 --> 00:34:26,219
<font color="#E5E5E5">drops is in my</font><font color="#CCCCCC"> blog</font><font color="#E5E5E5"> a bit later but yeah</font>

670
00:34:23,949 --> 00:34:32,199
you<font color="#CCCCCC"> know all</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> details just</font><font color="#E5E5E5"> I actually</font>

671
00:34:26,219 --> 00:34:35,319
keep the vendor name<font color="#E5E5E5"> but yeah and into a</font>

672
00:34:32,199 --> 00:34:37,779
boot guard<font color="#E5E5E5"> so actually a cool feature as</font>

673
00:34:35,319 --> 00:34:40,949
we discussed and it's actually I really

674
00:34:37,780 --> 00:34:42,760
<font color="#CCCCCC">like</font><font color="#E5E5E5"> it so it's change the rules for</font>

675
00:34:40,949 --> 00:34:45,509
<font color="#E5E5E5">implementation of secure boot and</font>

676
00:34:42,760 --> 00:34:50,919
actually<font color="#CCCCCC"> attacks your face a lot but</font>

677
00:34:45,510 --> 00:34:54,669
always<font color="#CCCCCC"> it's some things coming from</font><font color="#E5E5E5"> the</font>

678
00:34:50,918 --> 00:34:56,679
vendors and actual implementation<font color="#CCCCCC"> so yep</font>

679
00:34:54,668 --> 00:34:58,660
I've been actually showing some bypasses

680
00:34:56,679 --> 00:35:02,010
of the boot guard last year<font color="#E5E5E5"> on the</font>

681
00:34:58,660 --> 00:35:09,759
offensive con and oops I did it again

682
00:35:02,010 --> 00:35:12,310
so yep so Carl actually<font color="#E5E5E5"> hardware based</font>

683
00:35:09,760 --> 00:35:16,089
root of trust became my software so

684
00:35:12,310 --> 00:35:18,549
recovery mode is evil<font color="#E5E5E5"> secure transition</font>

685
00:35:16,089 --> 00:35:22,810
of the chain<font color="#E5E5E5"> of trust on different</font>

686
00:35:18,550 --> 00:35:25,660
stages is hard and slow so always

687
00:35:22,810 --> 00:35:28,450
performance here is quite difficult

688
00:35:25,660 --> 00:35:30,819
because think<font color="#CCCCCC"> about so you have a sleep</font>

689
00:35:28,450 --> 00:35:33,700
or hibernate when you<font color="#CCCCCC"> closed your lead</font>

690
00:35:30,819 --> 00:35:35,500
from<font color="#E5E5E5"> the laptop you need really fast to</font>

691
00:35:33,700 --> 00:35:37,810
blink<font color="#E5E5E5"> your screen after</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> open it</font>

692
00:35:35,500 --> 00:35:41,080
<font color="#E5E5E5">because it's marketing feature right so</font>

693
00:35:37,810 --> 00:35:44,529
and<font color="#CCCCCC"> the lot</font><font color="#E5E5E5"> of</font><font color="#CCCCCC"> vendors basically try to</font>

694
00:35:41,080 --> 00:35:46,360
transit<font color="#CCCCCC"> make a transition some of the</font>

695
00:35:44,530 --> 00:35:48,310
secrets from<font color="#E5E5E5"> the hardware root of trust</font>

696
00:35:46,360 --> 00:35:49,990
<font color="#E5E5E5">not really leaving</font><font color="#CCCCCC"> the hardware root of</font>

697
00:35:48,310 --> 00:35:52,920
trust they just transition the state

698
00:35:49,990 --> 00:35:55,270
true or false<font color="#E5E5E5"> as example the supply</font>

699
00:35:52,920 --> 00:35:57,100
chain of trust<font color="#E5E5E5"> being very far all the</font>

700
00:35:55,270 --> 00:35:59,680
states been verified correctly<font color="#CCCCCC"> before</font>

701
00:35:57,100 --> 00:36:02,589
and then starting<font color="#CCCCCC"> from that point</font><font color="#E5E5E5"> and</font>

702
00:35:59,680 --> 00:36:07,600
it's<font color="#E5E5E5"> not really secure and I will show</font>

703
00:36:02,590 --> 00:36:09,610
<font color="#E5E5E5">you why in most the cases</font><font color="#CCCCCC"> basically</font>

704
00:36:07,600 --> 00:36:12,160
without<font color="#E5E5E5"> hardware</font><font color="#CCCCCC"> they said yeah it's</font>

705
00:36:09,610 --> 00:36:15,010
what I just discussed<font color="#E5E5E5"> it's really a pure</font>

706
00:36:12,160 --> 00:36:17,950
software performance<font color="#E5E5E5"> reasons</font><font color="#CCCCCC"> enterprise</font>

707
00:36:15,010 --> 00:36:20,560
<font color="#CCCCCC">hardware</font><font color="#E5E5E5"> need remote update tools right</font>

708
00:36:17,950 --> 00:36:24,009
so also<font color="#CCCCCC"> a lot</font><font color="#E5E5E5"> of things went in there</font>

709
00:36:20,560 --> 00:36:27,070
<font color="#E5E5E5">nobody use in Tobias guard which is like</font>

710
00:36:24,010 --> 00:36:29,470
<font color="#E5E5E5">okay</font><font color="#CCCCCC"> bias guard it's</font><font color="#E5E5E5"> different from</font><font color="#CCCCCC"> wood</font>

711
00:36:27,070 --> 00:36:31,540
guard its armoring the<font color="#E5E5E5"> update process</font><font color="#CCCCCC"> to</font>

712
00:36:29,470 --> 00:36:34,120
<font color="#E5E5E5">walking inside the hardware but how many</font>

713
00:36:31,540 --> 00:36:37,360
vendors really use it<font color="#E5E5E5"> it so I would say</font>

714
00:36:34,120 --> 00:36:39,490
<font color="#E5E5E5">not a lot at all because I just found a</font>

715
00:36:37,360 --> 00:36:43,120
<font color="#CCCCCC">few</font><font color="#E5E5E5"> of them will be not doing marketing</font>

716
00:36:39,490 --> 00:36:47,490
but<font color="#E5E5E5"> yep so one more stuff</font><font color="#CCCCCC"> its recovery</font>

717
00:36:43,120 --> 00:36:51,790
<font color="#E5E5E5">and actually it's from</font><font color="#CCCCCC"> winter Nook and</font>

718
00:36:47,490 --> 00:36:56,140
they flash in a recovery<font color="#E5E5E5"> block firmware</font>

719
00:36:51,790 --> 00:36:58,509
and it's cool right<font color="#E5E5E5"> so and it was just a</font>

720
00:36:56,140 --> 00:37:03,600
specific<font color="#CCCCCC"> value which is showing</font><font color="#E5E5E5"> the</font>

721
00:36:58,510 --> 00:37:05,770
state inside the paid driver<font color="#E5E5E5"> and in</font>

722
00:37:03,600 --> 00:37:07,750
specific<font color="#E5E5E5"> value actually which is</font>

723
00:37:05,770 --> 00:37:10,690
<font color="#CCCCCC">demonstrated which I</font><font color="#E5E5E5"> just got before so</font>

724
00:37:07,750 --> 00:37:13,810
yep<font color="#E5E5E5"> we do have this verification</font><font color="#CCCCCC"> result</font>

725
00:37:10,690 --> 00:37:17,290
<font color="#E5E5E5">there and this buck was found by</font>

726
00:37:13,810 --> 00:37:20,950
umbrella guys and yeah it's<font color="#E5E5E5"> very cool so</font>

727
00:37:17,290 --> 00:37:23,410
I really enjoyed the stuff and it was

728
00:37:20,950 --> 00:37:25,480
pointing me to different<font color="#E5E5E5"> direction from</font>

729
00:37:23,410 --> 00:37:27,990
american megatrends<font color="#CCCCCC"> bias to the phoenix</font>

730
00:37:25,480 --> 00:37:31,390
<font color="#E5E5E5">it's different black but it's also</font><font color="#CCCCCC"> i</font>

731
00:37:27,990 --> 00:37:34,419
white value<font color="#CCCCCC"> i will show you after</font><font color="#E5E5E5"> that</font>

732
00:37:31,390 --> 00:37:37,600
so<font color="#CCCCCC"> yep so the stored value</font><font color="#E5E5E5"> verification</font>

733
00:37:34,420 --> 00:37:39,550
result<font color="#E5E5E5"> it</font><font color="#CCCCCC"> is ignored and start in</font>

734
00:37:37,600 --> 00:37:42,580
recovery actually<font color="#E5E5E5"> before without</font><font color="#CCCCCC"> any</font>

735
00:37:39,550 --> 00:37:45,190
verification of it which is<font color="#E5E5E5"> cool so here</font>

736
00:37:42,580 --> 00:37:47,700
is<font color="#CCCCCC"> the bug yeah they make some credits</font>

737
00:37:45,190 --> 00:37:50,470
on my blog post because<font color="#E5E5E5"> it's pointing to</font>

738
00:37:47,700 --> 00:37:51,098
them to some<font color="#E5E5E5"> of the directions of this</font>

739
00:37:50,470 --> 00:37:53,799
research

740
00:37:51,099 --> 00:37:57,130
and actually<font color="#CCCCCC"> their research point in</font>

741
00:37:53,799 --> 00:37:59,200
another<font color="#E5E5E5"> way to actually</font><font color="#CCCCCC"> in the Phoenix</font>

742
00:37:57,130 --> 00:38:01,599
bias to find<font color="#E5E5E5"> the stuff yep</font>

743
00:37:59,200 --> 00:38:03,460
<font color="#E5E5E5">good guard</font><font color="#CCCCCC"> peas so who con z0 nice</font>

744
00:38:01,599 --> 00:38:06,329
<font color="#E5E5E5">presentations this year very cool stuff</font>

745
00:38:03,460 --> 00:38:09,329
really<font color="#CCCCCC"> like it and also</font><font color="#E5E5E5"> make me more</font>

746
00:38:06,329 --> 00:38:12,700
<font color="#E5E5E5">concerning about the</font><font color="#CCCCCC"> boot guard security</font>

747
00:38:09,329 --> 00:38:15,700
but actually a<font color="#E5E5E5"> cow good guard bypass</font>

748
00:38:12,700 --> 00:38:18,038
usually<font color="#E5E5E5"> works so you need screwed up the</font>

749
00:38:15,700 --> 00:38:20,379
hardware component because you can't

750
00:38:18,039 --> 00:38:23,049
really<font color="#CCCCCC"> change it if it's actually</font><font color="#E5E5E5"> burn</font>

751
00:38:20,380 --> 00:38:25,599
<font color="#E5E5E5">it in the fuse so if you've Burnett yes</font>

752
00:38:23,049 --> 00:38:26,799
about not<font color="#CCCCCC"> burn as fuses</font><font color="#E5E5E5"> it's been</font>

753
00:38:25,599 --> 00:38:29,229
discussed in my previous here

754
00:38:26,799 --> 00:38:31,630
presentation so I will not go this loop

755
00:38:29,229 --> 00:38:36,819
<font color="#E5E5E5">because I have just a bit of time and</font>

756
00:38:31,630 --> 00:38:40,839
want<font color="#CCCCCC"> to</font><font color="#E5E5E5"> discuss more stuff so yeah you</font>

757
00:38:36,819 --> 00:38:42,819
remember<font color="#CCCCCC"> the screen right and actually</font>

758
00:38:40,839 --> 00:38:45,880
<font color="#CCCCCC">lenovo</font><font color="#E5E5E5"> have a platform configuration</font>

759
00:38:42,819 --> 00:38:50,470
<font color="#E5E5E5">data in it which</font><font color="#CCCCCC"> is Lenovo PC do you</font>

760
00:38:45,880 --> 00:38:52,989
need driver inside<font color="#E5E5E5"> bias and this been</font>

761
00:38:50,470 --> 00:38:55,209
<font color="#E5E5E5">I've been working on it because platform</font>

762
00:38:52,989 --> 00:38:57,519
configuration<font color="#CCCCCC"> data it's always cool</font><font color="#E5E5E5"> and</font>

763
00:38:55,210 --> 00:38:59,170
I've been just<font color="#CCCCCC"> like brute force</font><font color="#E5E5E5"> and</font>

764
00:38:57,519 --> 00:39:03,308
different<font color="#E5E5E5"> values to understand what they</font>

765
00:38:59,170 --> 00:39:07,359
are<font color="#CCCCCC"> doing</font><font color="#E5E5E5"> so and I said</font><font color="#CCCCCC"> ok sad</font><font color="#E5E5E5"> PC d6 to</font>

766
00:39:03,309 --> 00:39:09,849
<font color="#E5E5E5">0 or 1 depending on bite as on this</font>

767
00:39:07,359 --> 00:39:13,180
specific physical physical memory

768
00:39:09,849 --> 00:39:17,319
address<font color="#E5E5E5"> so</font><font color="#CCCCCC"> ok</font><font color="#E5E5E5"> that's kind of like</font>

769
00:39:13,180 --> 00:39:21,129
<font color="#E5E5E5">interesting and it's the</font><font color="#CCCCCC"> ufi tool I just</font>

770
00:39:17,319 --> 00:39:25,058
<font color="#CCCCCC">open the pattern file</font><font color="#E5E5E5"> and it's of</font><font color="#CCCCCC"> course</font>

771
00:39:21,130 --> 00:39:29,019
<font color="#E5E5E5">not cover it by boot guard</font><font color="#CCCCCC"> and you can</font>

772
00:39:25,059 --> 00:39:31,059
actually change one<font color="#E5E5E5"> byte value which is</font>

773
00:39:29,019 --> 00:39:33,939
highlighted<font color="#CCCCCC"> on the screen and I will</font>

774
00:39:31,059 --> 00:39:36,099
<font color="#E5E5E5">share some details on my blog post in my</font>

775
00:39:33,940 --> 00:39:38,140
blog after<font color="#E5E5E5"> so just to the people more</font>

776
00:39:36,099 --> 00:39:40,509
understand details to reproduce it the

777
00:39:38,140 --> 00:39:43,118
<font color="#E5E5E5">stuff and I think</font><font color="#CCCCCC"> it's</font><font color="#E5E5E5"> kind</font><font color="#CCCCCC"> of like I'm</font>

778
00:39:40,509 --> 00:39:45,069
gonna<font color="#CCCCCC"> factory</font><font color="#E5E5E5"> in mood or something</font><font color="#CCCCCC"> else</font>

779
00:39:43,119 --> 00:39:49,390
when you need to<font color="#CCCCCC"> disable</font><font color="#E5E5E5"> the boot guard</font>

780
00:39:45,069 --> 00:39:50,920
<font color="#E5E5E5">to recover the</font><font color="#CCCCCC"> system or basically make</font>

781
00:39:49,390 --> 00:39:54,578
some<font color="#CCCCCC"> pre-production of things</font>

782
00:39:50,920 --> 00:39:57,999
<font color="#CCCCCC">oh actually</font><font color="#E5E5E5"> I forgot to mention</font><font color="#CCCCCC"> Lenovo</font>

783
00:39:54,579 --> 00:40:00,670
<font color="#E5E5E5">security config also can make a CPU</font>

784
00:39:57,999 --> 00:40:04,430
debug enable from the<font color="#E5E5E5"> operating system</font>

785
00:40:00,670 --> 00:40:14,360
<font color="#E5E5E5">level for</font><font color="#CCCCCC"> x86 platforms</font>

786
00:40:04,430 --> 00:40:16,160
especially on<font color="#CCCCCC"> in tow okay</font><font color="#E5E5E5"> so if you</font>

787
00:40:14,360 --> 00:40:19,460
change this<font color="#CCCCCC"> value and reboot your system</font>

788
00:40:16,160 --> 00:40:21,529
three times<font color="#E5E5E5"> so I really didn't know on</font>

789
00:40:19,460 --> 00:40:23,270
the beginning<font color="#E5E5E5"> this amount of</font><font color="#CCCCCC"> tries I</font>

790
00:40:21,530 --> 00:40:26,810
just brute force it<font color="#CCCCCC"> because oh it's not</font>

791
00:40:23,270 --> 00:40:29,830
<font color="#E5E5E5">working</font><font color="#CCCCCC"> that's</font><font color="#E5E5E5"> right let's try</font><font color="#CCCCCC"> again and</font>

792
00:40:26,810 --> 00:40:33,980
suddenly<font color="#E5E5E5"> been working after three tries</font>

793
00:40:29,830 --> 00:40:36,560
<font color="#E5E5E5">so and actually more</font><font color="#CCCCCC"> than</font><font color="#E5E5E5"> that</font>

794
00:40:33,980 --> 00:40:40,040
<font color="#CCCCCC">the Nova</font><font color="#E5E5E5"> security config have the value</font>

795
00:40:36,560 --> 00:40:41,570
which is being a tree and<font color="#CCCCCC"> even</font><font color="#E5E5E5"> okay it's</font>

796
00:40:40,040 --> 00:40:43,550
a number<font color="#E5E5E5"> of tries that's why it's</font>

797
00:40:41,570 --> 00:40:45,940
working<font color="#CCCCCC"> after</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> tried three times</font><font color="#E5E5E5"> and</font>

798
00:40:43,550 --> 00:40:47,930
it's been<font color="#E5E5E5"> I suppose it's been</font>

799
00:40:45,940 --> 00:40:51,320
manufacturing what or something like

800
00:40:47,930 --> 00:40:53,830
<font color="#E5E5E5">that</font><font color="#CCCCCC"> tied to that but what</font><font color="#E5E5E5"> is the</font>

801
00:40:51,320 --> 00:40:59,120
security concerned here think<font color="#E5E5E5"> about so</font>

802
00:40:53,830 --> 00:41:01,370
first of all if you<font color="#CCCCCC"> really think your</font>

803
00:40:59,120 --> 00:41:05,049
secure boot is secure<font color="#E5E5E5"> and have a</font>

804
00:41:01,370 --> 00:41:08,450
<font color="#E5E5E5">hardware</font><font color="#CCCCCC"> root of trust</font><font color="#E5E5E5"> not it is a</font>

805
00:41:05,050 --> 00:41:10,940
marketing proposal<font color="#E5E5E5"> but if you think on</font>

806
00:41:08,450 --> 00:41:13,759
the real<font color="#CCCCCC"> implementation it can't be not</font>

807
00:41:10,940 --> 00:41:20,870
truth so<font color="#E5E5E5"> trottin don't trust the vendors</font>

808
00:41:13,760 --> 00:41:23,660
always check<font color="#E5E5E5"> so the usability in</font>

809
00:41:20,870 --> 00:41:28,460
enterprise world<font color="#E5E5E5"> in many cases the main</font>

810
00:41:23,660 --> 00:41:31,279
enemy<font color="#E5E5E5"> of security so also just base a</font>

811
00:41:28,460 --> 00:41:34,970
lot<font color="#E5E5E5"> of times security feature especially</font>

812
00:41:31,280 --> 00:41:38,780
on boot flow can<font color="#E5E5E5"> be worn after updates</font>

813
00:41:34,970 --> 00:41:41,419
<font color="#E5E5E5">and I mean BIOS updates and for</font>

814
00:41:38,780 --> 00:41:43,790
<font color="#E5E5E5">recoveries that people live in the back</font>

815
00:41:41,420 --> 00:41:46,100
doors just basically when<font color="#CCCCCC"> people start</font>

816
00:41:43,790 --> 00:41:48,650
oh I have a<font color="#CCCCCC"> worn it he extended warranty</font>

817
00:41:46,100 --> 00:41:50,450
whatever so trying to communicate with

818
00:41:48,650 --> 00:41:53,060
<font color="#CCCCCC">the</font><font color="#E5E5E5"> vendor and of course vendor don't</font>

819
00:41:50,450 --> 00:41:57,350
try don't want to lose the money<font color="#E5E5E5"> so they</font>

820
00:41:53,060 --> 00:42:00,740
try<font color="#E5E5E5"> to leave some of the white values</font>

821
00:41:57,350 --> 00:42:06,350
whatever<font color="#E5E5E5"> for basically do some stuff to</font>

822
00:42:00,740 --> 00:42:09,200
recover your laptop<font color="#E5E5E5"> and they really</font>

823
00:42:06,350 --> 00:42:11,950
frequently<font color="#E5E5E5"> don't consider reverse</font>

824
00:42:09,200 --> 00:42:14,750
engineering<font color="#E5E5E5"> in their trade models and</font>

825
00:42:11,950 --> 00:42:16,310
software engineers<font color="#E5E5E5"> not security</font>

826
00:42:14,750 --> 00:42:17,370
<font color="#CCCCCC">engineers software engineers</font><font color="#E5E5E5"> always</font>

827
00:42:16,310 --> 00:42:19,620
think<font color="#CCCCCC"> too</font>

828
00:42:17,370 --> 00:42:22,920
<font color="#CCCCCC">who recovers</font><font color="#E5E5E5"> the stuff it's really</font>

829
00:42:19,620 --> 00:42:25,350
<font color="#CCCCCC">difficult and from what with the modern</font>

830
00:42:22,920 --> 00:42:29,010
tool<font color="#CCCCCC"> especially it's not actually that</font>

831
00:42:25,350 --> 00:42:31,020
difficult<font color="#E5E5E5"> and also for many people it's</font>

832
00:42:29,010 --> 00:42:36,840
fun and they just<font color="#CCCCCC"> will be do</font><font color="#E5E5E5"> it for free</font>

833
00:42:31,020 --> 00:42:39,960
time<font color="#E5E5E5"> as I do</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> also the</font><font color="#CCCCCC"> vendors</font>

834
00:42:36,840 --> 00:42:44,550
understand<font color="#E5E5E5"> permanent disabling option</font>

835
00:42:39,960 --> 00:42:46,980
differently so because think about<font color="#E5E5E5"> as</font>

836
00:42:44,550 --> 00:42:49,350
example reading<font color="#E5E5E5"> about that in the BIOS</font>

837
00:42:46,980 --> 00:42:52,050
settings<font color="#E5E5E5"> I was thinking about</font><font color="#CCCCCC"> compute</font>

838
00:42:49,350 --> 00:42:54,720
<font color="#E5E5E5">rates</font><font color="#CCCCCC"> it will</font><font color="#E5E5E5"> be disabled forever</font><font color="#CCCCCC"> so it</font>

839
00:42:52,050 --> 00:43:00,210
<font color="#E5E5E5">will be no way how it can be</font><font color="#CCCCCC"> Rene but</font>

840
00:42:54,720 --> 00:43:04,620
right but it can be and yeah it's make

841
00:43:00,210 --> 00:43:08,340
some concern about<font color="#E5E5E5"> security of the</font>

842
00:43:04,620 --> 00:43:10,470
<font color="#CCCCCC">firmware so one of</font><font color="#E5E5E5"> the options</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> some</font>

843
00:43:08,340 --> 00:43:12,510
of the lenovo laptops<font color="#E5E5E5"> it's fresh their</font>

844
00:43:10,470 --> 00:43:14,609
core boot but if you're<font color="#E5E5E5"> not really firm</font>

845
00:43:12,510 --> 00:43:17,010
or professional don't do that<font color="#E5E5E5"> because it</font>

846
00:43:14,610 --> 00:43:21,300
will<font color="#E5E5E5"> be even weaker than just use the</font>

847
00:43:17,010 --> 00:43:23,940
default<font color="#E5E5E5"> former because it's a lot of</font>

848
00:43:21,300 --> 00:43:25,800
configuration<font color="#CCCCCC"> if you just flash it</font><font color="#E5E5E5"> with</font>

849
00:43:23,940 --> 00:43:30,510
the default configurations or reduce

850
00:43:25,800 --> 00:43:32,970
some<font color="#CCCCCC"> open-sourced</font><font color="#E5E5E5"> biases leave it an</font>

851
00:43:30,510 --> 00:43:37,770
<font color="#CCCCCC">internet</font><font color="#E5E5E5"> you really don't know what is</font>

852
00:43:32,970 --> 00:43:40,649
there so yeah it's<font color="#E5E5E5"> not good idea</font><font color="#CCCCCC"> when</font>

853
00:43:37,770 --> 00:43:44,910
<font color="#CCCCCC">card web-based root of trust transfers</font>

854
00:43:40,650 --> 00:43:48,240
the<font color="#E5E5E5"> states so software takes care of it</font>

855
00:43:44,910 --> 00:43:52,770
and it's<font color="#CCCCCC"> not Hardware anymore so</font>

856
00:43:48,240 --> 00:43:56,640
basically think about<font color="#E5E5E5"> so it's no way how</font>

857
00:43:52,770 --> 00:43:58,740
<font color="#E5E5E5">you can always have secrets like you</font>

858
00:43:56,640 --> 00:44:02,129
can't have a keys inside hardware but

859
00:43:58,740 --> 00:44:05,430
also<font color="#CCCCCC"> if the key leaves the hardware</font><font color="#E5E5E5"> it's</font>

860
00:44:02,130 --> 00:44:13,440
not in the hardware locked anymore<font color="#E5E5E5"> so</font>

861
00:44:05,430 --> 00:44:15,690
yep and<font color="#CCCCCC"> I think that's it so thank</font><font color="#E5E5E5"> you</font>

862
00:44:13,440 --> 00:44:17,970
very<font color="#E5E5E5"> much for your attention</font><font color="#CCCCCC"> but I</font>

863
00:44:15,690 --> 00:44:19,340
expect some questions we have a bit of

864
00:44:17,970 --> 00:44:23,488
<font color="#E5E5E5">time thank you</font><font color="#CCCCCC"> very</font><font color="#E5E5E5"> much</font>

865
00:44:19,340 --> 00:44:23,489
[Applause]

866
00:44:24,430 --> 00:44:39,589
questions yes<font color="#E5E5E5"> please test oh thank you</font>

867
00:44:37,310 --> 00:44:41,060
<font color="#E5E5E5">very much</font><font color="#CCCCCC"> as a</font><font color="#E5E5E5"> question have</font><font color="#CCCCCC"> you tried</font>

868
00:44:39,590 --> 00:44:44,120
to get for example<font color="#CCCCCC"> that</font><font color="#E5E5E5"> something like</font>

869
00:44:41,060 --> 00:44:46,400
code running on your device when a guard

870
00:44:44,120 --> 00:44:48,680
is disabled<font color="#CCCCCC"> excuse me</font>

871
00:44:46,400 --> 00:44:50,900
you say coreboot yes<font color="#CCCCCC"> running on your</font>

872
00:44:48,680 --> 00:44:54,140
<font color="#E5E5E5">device</font><font color="#CCCCCC"> if the boot guard is disabled</font><font color="#E5E5E5"> yes</font>

873
00:44:50,900 --> 00:45:00,970
<font color="#E5E5E5">yes you can</font><font color="#CCCCCC"> but if it's enabled I would</font>

874
00:44:54,140 --> 00:45:04,549
say basically if you can't<font color="#E5E5E5"> disable and</font>

875
00:45:00,970 --> 00:45:06,620
firmware<font color="#E5E5E5"> basically will be</font><font color="#CCCCCC"> always</font><font color="#E5E5E5"> try to</font>

876
00:45:04,550 --> 00:45:10,250
verify<font color="#E5E5E5"> the chain of trust from this</font>

877
00:45:06,620 --> 00:45:13,520
point<font color="#E5E5E5"> so your platform will be not boot</font>

878
00:45:10,250 --> 00:45:15,290
<font color="#E5E5E5">so yeah it's really a</font><font color="#CCCCCC"> case-by-case</font><font color="#E5E5E5"> if</font>

879
00:45:13,520 --> 00:45:20,900
you show me<font color="#CCCCCC"> the laptop I will tell you</font>

880
00:45:15,290 --> 00:45:35,980
<font color="#CCCCCC">more and yeah let me just</font><font color="#E5E5E5"> update the</font>

881
00:45:20,900 --> 00:45:39,620
<font color="#E5E5E5">firmware sir that was an awesome</font><font color="#CCCCCC"> talk</font>

882
00:45:35,980 --> 00:45:42,230
thanks Bruce yeah<font color="#E5E5E5"> pleasure to get this</font>

883
00:45:39,620 --> 00:45:44,359
feedback from you<font color="#E5E5E5"> yeah so for the</font><font color="#CCCCCC"> Compu</font>

884
00:45:42,230 --> 00:45:45,710
<font color="#CCCCCC">trace</font><font color="#E5E5E5"> thing instead like would anova</font>

885
00:45:44,360 --> 00:45:47,240
take some feedback from you<font color="#CCCCCC"> where like</font>

886
00:45:45,710 --> 00:45:49,520
for<font color="#CCCCCC"> example inception</font><font color="#E5E5E5"> turning up a bit</font>

887
00:45:47,240 --> 00:45:50,870
<font color="#CCCCCC">they</font><font color="#E5E5E5"> just like disabled in the so you</font>

888
00:45:49,520 --> 00:45:53,030
<font color="#CCCCCC">caused this mic handler</font>

889
00:45:50,870 --> 00:45:55,759
yeah and in the<font color="#CCCCCC"> eix register you have</font>

890
00:45:53,030 --> 00:45:56,840
<font color="#E5E5E5">like a one yeah exactly yeah but</font>

891
00:45:55,760 --> 00:45:57,980
couldn't they just<font color="#E5E5E5"> like make</font><font color="#CCCCCC"> it so</font>

892
00:45:56,840 --> 00:46:01,040
that's like they just like remove the

893
00:45:57,980 --> 00:46:02,510
piece<font color="#CCCCCC"> of</font><font color="#E5E5E5"> code injects the WP</font><font color="#CCCCCC"> BT table so</font>

894
00:46:01,040 --> 00:46:04,520
<font color="#E5E5E5">that like calm you will never ever be</font>

895
00:46:02,510 --> 00:46:05,990
<font color="#E5E5E5">like I mean like literally like the the</font>

896
00:46:04,520 --> 00:46:07,610
binary would not even be<font color="#E5E5E5"> there anymore</font>

897
00:46:05,990 --> 00:46:09,799
I mean<font color="#CCCCCC"> would they do something like that</font>

898
00:46:07,610 --> 00:46:11,810
<font color="#E5E5E5">so</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> can necessarily</font><font color="#E5E5E5"> mean that</font>

899
00:46:09,800 --> 00:46:16,430
<font color="#E5E5E5">would</font><font color="#CCCCCC"> be a real removal right</font><font color="#E5E5E5"> not just</font>

900
00:46:11,810 --> 00:46:19,759
like<font color="#E5E5E5"> switching on some bits I see okay</font>

901
00:46:16,430 --> 00:46:22,190
screwed<font color="#CCCCCC"> yeah and the next one I guess</font>

902
00:46:19,760 --> 00:46:24,590
like to control like having a<font color="#CCCCCC"> WI driver</font>

903
00:46:22,190 --> 00:46:27,020
to control<font color="#CCCCCC"> via</font><font color="#E5E5E5"> a CPI to control</font><font color="#CCCCCC"> browser</font>

904
00:46:24,590 --> 00:46:29,120
<font color="#E5E5E5">so basically how it works you have a</font>

905
00:46:27,020 --> 00:46:31,160
<font color="#CCCCCC">Windows</font><font color="#E5E5E5"> management interface which is a</font>

906
00:46:29,120 --> 00:46:33,828
per agent with a CPI so you basically

907
00:46:31,160 --> 00:46:36,920
<font color="#E5E5E5">just modify specific data in the speed</font>

908
00:46:33,829 --> 00:46:41,749
cific table<font color="#E5E5E5"> yeah in</font><font color="#CCCCCC"> ACPI</font><font color="#E5E5E5"> and then some</font>

909
00:46:36,920 --> 00:46:45,680
like<font color="#E5E5E5"> it's my driver or like bias let's</font>

910
00:46:41,749 --> 00:46:48,109
say<font color="#CCCCCC"> bios SMM driver</font><font color="#E5E5E5"> try to read this</font>

911
00:46:45,680 --> 00:46:49,759
<font color="#CCCCCC">well</font><font color="#E5E5E5"> in the loop if it's get modified so</font>

912
00:46:48,109 --> 00:46:52,489
something change it in<font color="#E5E5E5"> the configuration</font>

913
00:46:49,759 --> 00:46:55,009
<font color="#E5E5E5">date it's cows work</font><font color="#CCCCCC"> okay</font><font color="#E5E5E5"> cool</font>

914
00:46:52,489 --> 00:46:56,839
but when you make<font color="#CCCCCC"> oh sorry no not like</font>

915
00:46:55,009 --> 00:46:59,359
that<font color="#E5E5E5"> it's about</font><font color="#CCCCCC"> the different stuff it's</font>

916
00:46:56,839 --> 00:47:01,640
<font color="#E5E5E5">about remote convict about particularly</font>

917
00:46:59,359 --> 00:47:05,058
<font color="#E5E5E5">about the compute race you need to</font>

918
00:47:01,640 --> 00:47:10,459
<font color="#CCCCCC">modify a</font><font color="#E5E5E5"> CPI value which is basically</font>

919
00:47:05,059 --> 00:47:12,680
<font color="#E5E5E5">will</font><font color="#CCCCCC"> be flag v my SMI calls then you</font>

920
00:47:10,459 --> 00:47:14,839
<font color="#CCCCCC">basically go there and then</font><font color="#E5E5E5"> like when</font>

921
00:47:12,680 --> 00:47:16,609
<font color="#CCCCCC">you install coffee trays</font><font color="#E5E5E5"> do they I mean</font>

922
00:47:14,839 --> 00:47:18,619
<font color="#E5E5E5">like they actually load a driver know</font>

923
00:47:16,609 --> 00:47:19,999
like when you download this when you go

924
00:47:18,619 --> 00:47:25,549
to when<font color="#E5E5E5"> you actually deploy the software</font>

925
00:47:19,999 --> 00:47:27,709
<font color="#CCCCCC">yeah yeah and they use HTTP in this old</font>

926
00:47:25,549 --> 00:47:30,619
<font color="#E5E5E5">version why I say they're even not wild</font>

927
00:47:27,709 --> 00:47:38,680
<font color="#E5E5E5">bugs because it's known for</font><font color="#CCCCCC"> years</font><font color="#E5E5E5"> yeah</font>

928
00:47:30,619 --> 00:47:41,180
cool awesome<font color="#E5E5E5"> yeah</font><font color="#CCCCCC"> let's wake Rafael</font>

929
00:47:38,680 --> 00:47:43,098
question and thank you for<font color="#E5E5E5"> your talk I</font>

930
00:47:41,180 --> 00:47:45,319
have a question regarding the WMI

931
00:47:43,099 --> 00:47:47,449
interface<font color="#CCCCCC"> it seems like it's sometimes</font>

932
00:47:45,319 --> 00:47:49,670
you need<font color="#E5E5E5"> to supply the supervisor</font>

933
00:47:47,449 --> 00:47:51,650
password to access some of<font color="#E5E5E5"> the features</font>

934
00:47:49,670 --> 00:47:56,180
<font color="#E5E5E5">you're right it's VP password</font><font color="#CCCCCC"> you need</font>

935
00:47:51,650 --> 00:47:58,219
sorry so I'm not<font color="#CCCCCC"> reassured</font><font color="#E5E5E5"> when the</font>

936
00:47:56,180 --> 00:47:59,749
stood like the computer<font color="#CCCCCC"> is interface you</font>

937
00:47:58,219 --> 00:48:01,579
<font color="#E5E5E5">can reach directly</font><font color="#CCCCCC"> without the</font>

938
00:47:59,749 --> 00:48:04,399
supervisor password or do you need<font color="#CCCCCC"> the</font>

939
00:48:01,579 --> 00:48:06,499
<font color="#CCCCCC">password to reach WMI anyway it's</font>

940
00:48:04,400 --> 00:48:09,079
interesting<font color="#CCCCCC"> I will tell you why if</font>

941
00:48:06,499 --> 00:48:12,348
you're not support<font color="#E5E5E5"> like set up your</font>

942
00:48:09,079 --> 00:48:14,269
supervisor password they transfer<font color="#E5E5E5"> from</font>

943
00:48:12,349 --> 00:48:17,269
the operating<font color="#E5E5E5"> system</font><font color="#CCCCCC"> from</font><font color="#E5E5E5"> a</font><font color="#CCCCCC"> supplies</font>

944
00:48:14,269 --> 00:48:20,598
<font color="#E5E5E5">value in the specific register it's not</font>

945
00:48:17,269 --> 00:48:22,249
<font color="#E5E5E5">supported so you can change it then it's</font>

946
00:48:20,599 --> 00:48:24,229
<font color="#CCCCCC">basically will not ask you supervisor</font>

947
00:48:22,249 --> 00:48:26,689
<font color="#CCCCCC">passport but it's hard to brute force</font>

948
00:48:24,229 --> 00:48:29,269
because they track number<font color="#CCCCCC"> of tries yes</font>

949
00:48:26,690 --> 00:48:31,130
yeah so if<font color="#E5E5E5"> you set up the supervisor</font>

950
00:48:29,269 --> 00:48:33,468
password and you didn't know<font color="#E5E5E5"> about this</font>

951
00:48:31,130 --> 00:48:36,019
trick and actually I not drop at<font color="#CCCCCC"> this</font>

952
00:48:33,469 --> 00:48:44,109
stuff<font color="#E5E5E5"> because yeah</font><font color="#CCCCCC"> you know ask it not</font>

953
00:48:36,019 --> 00:48:44,109
<font color="#E5E5E5">doing that okay thank</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> more questions</font>

954
00:48:44,809 --> 00:48:51,720
always at the opposite<font color="#E5E5E5"> side</font><font color="#CCCCCC"> of the room</font>

955
00:48:47,809 --> 00:48:53,730
but<font color="#E5E5E5"> yeah it's actually a really complex</font>

956
00:48:51,720 --> 00:48:56,308
attack surface there because I<font color="#E5E5E5"> would say</font>

957
00:48:53,730 --> 00:48:58,109
<font color="#CCCCCC">they bit over helmet the stuff</font><font color="#E5E5E5"> inside</font>

958
00:48:56,309 --> 00:49:00,089
<font color="#CCCCCC">surprise because</font><font color="#E5E5E5"> it's like a lot of</font>

959
00:48:58,109 --> 00:49:02,519
<font color="#CCCCCC">double-checks but in the same</font><font color="#E5E5E5"> way that</font>

960
00:49:00,089 --> 00:49:06,000
not<font color="#E5E5E5"> really sink it so if you basically</font>

961
00:49:02,519 --> 00:49:08,939
<font color="#E5E5E5">bypass one it will be no apply like all</font>

962
00:49:06,000 --> 00:49:11,880
of them<font color="#CCCCCC"> but</font><font color="#E5E5E5"> you bypass</font><font color="#CCCCCC"> a piece of trust</font>

963
00:49:08,940 --> 00:49:14,630
<font color="#CCCCCC">I have a question for</font><font color="#E5E5E5"> the computer</font><font color="#CCCCCC"> is a</font>

964
00:49:11,880 --> 00:49:16,980
feature<font color="#E5E5E5"> does it mean when it's been</font>

965
00:49:14,630 --> 00:49:20,519
disabled permanently that I could

966
00:49:16,980 --> 00:49:24,410
reflect the firmware<font color="#CCCCCC"> so that it would</font>

967
00:49:20,519 --> 00:49:28,348
reappear afterwards<font color="#E5E5E5"> if yes</font><font color="#CCCCCC"> first of</font><font color="#E5E5E5"> all</font>

968
00:49:24,410 --> 00:49:31,470
if you make it a physical<font color="#CCCCCC"> refresh</font><font color="#E5E5E5"> so</font>

969
00:49:28,349 --> 00:49:35,730
it's still have some hidden spy flash

970
00:49:31,470 --> 00:49:38,189
storage or like to have some bits so<font color="#E5E5E5"> you</font>

971
00:49:35,730 --> 00:49:40,319
know the security config have some

972
00:49:38,190 --> 00:49:43,019
specific<font color="#E5E5E5"> related stuff to that so</font>

973
00:49:40,319 --> 00:49:45,839
basically<font color="#CCCCCC"> they try to recover</font><font color="#E5E5E5"> this</font>

974
00:49:43,019 --> 00:49:48,269
permanent disabled features<font color="#E5E5E5"> as a bitmap</font>

975
00:49:45,839 --> 00:49:52,019
from<font color="#E5E5E5"> this hidden storage if you modify</font>

976
00:49:48,269 --> 00:49:53,819
it<font color="#E5E5E5"> there and</font><font color="#CCCCCC"> flash so yeah you</font><font color="#E5E5E5"> done do</font>

977
00:49:52,019 --> 00:49:55,799
you<font color="#E5E5E5"> have like a list of affected systems</font>

978
00:49:53,819 --> 00:49:59,099
are you share it and blog post<font color="#E5E5E5"> yeah</font>

979
00:49:55,799 --> 00:50:00,980
thank<font color="#E5E5E5"> you so much things I can today</font>

980
00:49:59,099 --> 00:50:06,059
<font color="#E5E5E5">because of the restrictions was</font>

981
00:50:00,980 --> 00:50:12,690
responsible<font color="#E5E5E5"> disclosure</font><font color="#CCCCCC"> its</font><font color="#E5E5E5"> stuff someone</font>

982
00:50:06,059 --> 00:50:16,339
at the other side<font color="#E5E5E5"> of the room</font><font color="#CCCCCC"> okay</font><font color="#E5E5E5"> I</font>

983
00:50:12,690 --> 00:50:18,660
have a<font color="#E5E5E5"> question left</font><font color="#CCCCCC"> I didn't really get</font>

984
00:50:16,339 --> 00:50:20,308
<font color="#E5E5E5">the whole part about the very</font>

985
00:50:18,660 --> 00:50:23,819
interesting integrity checking of<font color="#CCCCCC"> the</font>

986
00:50:20,309 --> 00:50:26,400
<font color="#CCCCCC">updates</font><font color="#E5E5E5"> did they really just check the</font>

987
00:50:23,819 --> 00:50:28,410
signature<font color="#CCCCCC"> of the hash</font><font color="#E5E5E5"> but you mean</font>

988
00:50:26,400 --> 00:50:32,220
embedded controller right so what they

989
00:50:28,410 --> 00:50:34,618
<font color="#CCCCCC">did so they basically have a the sign of</font>

990
00:50:32,220 --> 00:50:37,649
the<font color="#CCCCCC"> cache but they not verifies the hash</font>

991
00:50:34,619 --> 00:50:40,319
<font color="#CCCCCC">versus update yeah just</font><font color="#E5E5E5"> check yes</font>

992
00:50:37,650 --> 00:50:43,049
exactly so I would say maybe somebody

993
00:50:40,319 --> 00:50:45,299
forget to add the<font color="#CCCCCC"> code or it's basically</font>

994
00:50:43,049 --> 00:50:48,420
for performance<font color="#CCCCCC"> I don't know chip is</font>

995
00:50:45,299 --> 00:50:50,970
quite like simple and<font color="#E5E5E5"> it's like even not</font>

996
00:50:48,420 --> 00:50:54,720
<font color="#E5E5E5">armed so it's slow and in this case they</font>

997
00:50:50,970 --> 00:50:57,310
did you name and shame them or is it<font color="#CCCCCC"> I</font>

998
00:50:54,720 --> 00:51:03,129
can't not yet

999
00:50:57,310 --> 00:51:04,540
don't want to<font color="#CCCCCC"> be fired you can</font><font color="#E5E5E5"> even have</font>

1000
00:51:03,130 --> 00:51:06,890
a<font color="#E5E5E5"> micro maybe if you provide</font><font color="#CCCCCC"> me some</font>

1001
00:51:04,540 --> 00:51:08,310
shots of whiskey I will<font color="#E5E5E5"> reconsider that</font>

1002
00:51:06,890 --> 00:51:12,910
[Laughter]

1003
00:51:08,310 --> 00:51:15,100
hey one last<font color="#CCCCCC"> question on this topic did</font>

1004
00:51:12,910 --> 00:51:16,960
you actually<font color="#E5E5E5"> try to flip it like in</font>

1005
00:51:15,100 --> 00:51:19,690
<font color="#CCCCCC">different places of the</font><font color="#E5E5E5"> firmware</font><font color="#CCCCCC"> no no</font>

1006
00:51:16,960 --> 00:51:22,660
no<font color="#E5E5E5"> specifically I found this platform</font>

1007
00:51:19,690 --> 00:51:24,730
<font color="#CCCCCC">configuration data storage</font><font color="#E5E5E5"> so I you can</font>

1008
00:51:22,660 --> 00:51:27,700
clearly see it's a lot<font color="#CCCCCC"> of zeros in</font><font color="#E5E5E5"> just</font>

1009
00:51:24,730 --> 00:51:29,290
few<font color="#CCCCCC"> of them</font><font color="#E5E5E5"> basically have a data so I</font>

1010
00:51:27,700 --> 00:51:30,939
check the different storage<font color="#E5E5E5"> from the</font>

1011
00:51:29,290 --> 00:51:33,940
<font color="#CCCCCC">separator laptop and I see</font><font color="#E5E5E5"> oh it's a</font>

1012
00:51:30,940 --> 00:51:35,800
<font color="#CCCCCC">different value</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> okay it's something</font>

1013
00:51:33,940 --> 00:51:38,290
can be<font color="#E5E5E5"> changed there and also they have</font>

1014
00:51:35,800 --> 00:51:40,480
different bytes set it up and they play

1015
00:51:38,290 --> 00:51:42,759
it<font color="#E5E5E5"> yeah I basically have a possibility</font>

1016
00:51:40,480 --> 00:51:44,800
<font color="#E5E5E5">so</font><font color="#CCCCCC"> one possibility is maybe</font><font color="#E5E5E5"> they check</font>

1017
00:51:42,760 --> 00:51:46,780
certain part<font color="#E5E5E5"> but not other parts and you</font>

1018
00:51:44,800 --> 00:51:48,940
just found<font color="#E5E5E5"> a</font><font color="#CCCCCC"> part</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> I don't know so</font>

1019
00:51:46,780 --> 00:51:51,040
<font color="#E5E5E5">it's</font><font color="#CCCCCC"> refers to disable the boot guard</font>

1020
00:51:48,940 --> 00:51:52,930
<font color="#CCCCCC">yeah</font><font color="#E5E5E5"> but maybe it's work for disabling</font>

1021
00:51:51,040 --> 00:51:55,750
something else that I<font color="#E5E5E5"> don't know you're</font>

1022
00:51:52,930 --> 00:51:58,359
right so it can be more but I still

1023
00:51:55,750 --> 00:52:04,060
think<font color="#E5E5E5"> each byte value it just</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> one</font>

1024
00:51:58,360 --> 00:52:07,690
feature<font color="#E5E5E5"> but it can be a bitmap hello</font>

1025
00:52:04,060 --> 00:52:10,750
<font color="#E5E5E5">thank you</font><font color="#CCCCCC"> for the talk one</font><font color="#E5E5E5"> question how</font>

1026
00:52:07,690 --> 00:52:14,050
<font color="#CCCCCC">did you trace the actual value that you</font>

1027
00:52:10,750 --> 00:52:16,240
if he is<font color="#CCCCCC"> actually using</font><font color="#E5E5E5"> did you do that</font>

1028
00:52:14,050 --> 00:52:18,640
from the<font color="#E5E5E5"> phone system I don't what</font>

1029
00:52:16,240 --> 00:52:22,000
<font color="#E5E5E5">update for my laptop from the vendor</font>

1030
00:52:18,640 --> 00:52:23,980
website<font color="#CCCCCC"> so I use au fi true to open it</font>

1031
00:52:22,000 --> 00:52:28,630
and see what kind of the Dixie driver

1032
00:52:23,980 --> 00:52:31,420
does<font color="#E5E5E5"> what else so and and also so nickel</font>

1033
00:52:28,630 --> 00:52:33,820
<font color="#CCCCCC">Ashley</font><font color="#E5E5E5"> I developed the perfect tool for</font>

1034
00:52:31,420 --> 00:52:37,180
<font color="#E5E5E5">the forensics and also for the</font><font color="#CCCCCC"> rivet</font>

1035
00:52:33,820 --> 00:52:39,490
reverse<font color="#CCCCCC"> engineering ufi firmware my</font>

1036
00:52:37,180 --> 00:52:42,250
update<font color="#E5E5E5"> being just for the boot guard</font><font color="#CCCCCC"> all</font>

1037
00:52:39,490 --> 00:52:44,500
other stuff it's on him so he's

1038
00:52:42,250 --> 00:52:48,700
<font color="#CCCCCC">basically main contributor</font><font color="#E5E5E5"> a long time</font>

1039
00:52:44,500 --> 00:52:50,860
ago so and it<font color="#CCCCCC"> showed you</font><font color="#E5E5E5"> like the</font>

1040
00:52:48,700 --> 00:52:53,890
drivers you can<font color="#E5E5E5"> extract it and open an</font>

1041
00:52:50,860 --> 00:52:57,160
Ida Pro<font color="#E5E5E5"> because it's 686 based so yeah</font>

1042
00:52:53,890 --> 00:52:59,859
just go on it but honestly<font color="#CCCCCC"> reverse</font>

1043
00:52:57,160 --> 00:53:01,569
engineering the<font color="#CCCCCC"> ufi drivers inside the</font>

1044
00:52:59,860 --> 00:53:03,610
Ida Pro it's kind of tough<font color="#E5E5E5"> because if</font>

1045
00:53:01,570 --> 00:53:05,560
you don't recover some of<font color="#E5E5E5"> the internal</font>

1046
00:53:03,610 --> 00:53:08,290
structures so it will be like very<font color="#CCCCCC"> very</font>

1047
00:53:05,560 --> 00:53:09,970
difficult<font color="#E5E5E5"> to read code so even if you</font>

1048
00:53:08,290 --> 00:53:10,540
know<font color="#E5E5E5"> assembly pretty well and did</font><font color="#CCCCCC"> a lot</font>

1049
00:53:09,970 --> 00:53:19,839
<font color="#CCCCCC">of area</font>

1050
00:53:10,540 --> 00:53:20,350
for<font color="#CCCCCC"> yeah ok</font><font color="#E5E5E5"> then that was it thank you</font>

1051
00:53:19,840 --> 00:53:21,340
<font color="#E5E5E5">very much</font>

1052
00:53:20,350 --> 00:53:24,509
let's have a round of applause

1053
00:53:21,340 --> 00:53:24,510
[Applause]

