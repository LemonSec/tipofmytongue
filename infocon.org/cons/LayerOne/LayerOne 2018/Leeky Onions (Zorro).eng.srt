1
00:00:00,030 --> 00:00:09,420
<font color="#CCCCCC">oh nice to see everybody</font><font color="#E5E5E5"> yeah</font><font color="#CCCCCC"> there one</font>

2
00:00:04,640 --> 00:00:12,809
so the next<font color="#CCCCCC"> talk is by Zorro</font>

3
00:00:09,420 --> 00:00:15,980
it's<font color="#E5E5E5"> leaky onions</font><font color="#CCCCCC"> D anonymizing</font><font color="#E5E5E5"> live tor</font>

4
00:00:12,809 --> 00:00:34,079
hidden services which sounds awesome

5
00:00:15,980 --> 00:00:43,170
so everybody enjoy<font color="#CCCCCC"> all right</font><font color="#E5E5E5"> okay</font><font color="#CCCCCC"> no</font><font color="#E5E5E5"> how</font>

6
00:00:34,079 --> 00:00:46,020
about<font color="#E5E5E5"> now</font><font color="#CCCCCC"> good yeah there we go</font>

7
00:00:43,170 --> 00:00:47,760
<font color="#CCCCCC">yeah that's good all right so we're off</font>

8
00:00:46,020 --> 00:00:50,430
to a better start this<font color="#E5E5E5"> year last year</font>

9
00:00:47,760 --> 00:00:52,050
<font color="#E5E5E5">two laptops broke and I had</font><font color="#CCCCCC"> to borrow</font>

10
00:00:50,430 --> 00:00:54,210
<font color="#CCCCCC">one</font><font color="#E5E5E5"> to do my</font><font color="#CCCCCC"> presentation I couldn't see</font>

11
00:00:52,050 --> 00:00:58,500
my own screen so we're off<font color="#CCCCCC"> to a good</font>

12
00:00:54,210 --> 00:01:00,449
<font color="#CCCCCC">start so</font><font color="#E5E5E5"> far</font><font color="#CCCCCC"> before I</font><font color="#E5E5E5"> get started I just</font>

13
00:00:58,500 --> 00:01:03,539
<font color="#E5E5E5">want to see show of hands who</font><font color="#CCCCCC"> is</font>

14
00:01:00,449 --> 00:01:05,399
familiar with the<font color="#CCCCCC"> Tor</font><font color="#E5E5E5"> network and who is</font>

15
00:01:03,539 --> 00:01:08,909
never touched<font color="#E5E5E5"> before so show</font><font color="#CCCCCC"> hands used</font>

16
00:01:05,400 --> 00:01:10,890
it cool<font color="#CCCCCC"> all right so I won't spend</font><font color="#E5E5E5"> too</font>

17
00:01:08,909 --> 00:01:13,080
much time<font color="#E5E5E5"> and this talk really isn't any</font>

18
00:01:10,890 --> 00:01:14,880
kind<font color="#E5E5E5"> of low-level talk about the routing</font>

19
00:01:13,080 --> 00:01:16,920
protocols or anything<font color="#E5E5E5"> like that I'm</font>

20
00:01:14,880 --> 00:01:18,600
gonna<font color="#E5E5E5"> just</font><font color="#CCCCCC"> kind of recap on a very</font>

21
00:01:16,920 --> 00:01:21,119
<font color="#E5E5E5">high-level overview of how</font><font color="#CCCCCC"> it works and</font>

22
00:01:18,600 --> 00:01:23,119
how<font color="#CCCCCC"> the hidden services work as well</font>

23
00:01:21,119 --> 00:01:26,250
<font color="#E5E5E5">from a routing standpoint</font>

24
00:01:23,119 --> 00:01:28,979
everything is<font color="#CCCCCC"> very high</font><font color="#E5E5E5"> level so if</font>

25
00:01:26,250 --> 00:01:31,259
things<font color="#E5E5E5"> seem oversimplified or even</font>

26
00:01:28,979 --> 00:01:37,260
incorrect<font color="#E5E5E5"> due</font><font color="#CCCCCC"> to the simplification I</font>

27
00:01:31,259 --> 00:01:39,780
apologize<font color="#E5E5E5"> but yeah so here we go</font>

28
00:01:37,260 --> 00:01:42,690
so a<font color="#E5E5E5"> little bit about me well what I'm</font>

29
00:01:39,780 --> 00:01:45,020
not not a cryptographer<font color="#CCCCCC"> not a developer</font>

30
00:01:42,690 --> 00:01:46,530
<font color="#E5E5E5">I'm not a lawyer I'm not</font><font color="#CCCCCC"> a professional</font>

31
00:01:45,020 --> 00:01:49,350
<font color="#CCCCCC">Who am I</font>

32
00:01:46,530 --> 00:01:52,290
<font color="#E5E5E5">I'm a guy on stage</font><font color="#CCCCCC"> talking to you so I</font>

33
00:01:49,350 --> 00:01:53,880
need<font color="#E5E5E5"> to know outline what is</font><font color="#CCCCCC"> tor</font>

34
00:01:52,290 --> 00:01:56,400
how does it<font color="#CCCCCC"> work what are hidden</font>

35
00:01:53,880 --> 00:01:58,410
services<font color="#CCCCCC"> add</font><font color="#E5E5E5"> an a word some common ways</font>

36
00:01:56,400 --> 00:02:00,450
that<font color="#CCCCCC"> they could</font><font color="#E5E5E5"> be misconfigured and</font>

37
00:01:58,410 --> 00:02:05,100
then we're gonna go<font color="#CCCCCC"> into</font><font color="#E5E5E5"> some demos I'll</font>

38
00:02:00,450 --> 00:02:14,700
do<font color="#E5E5E5"> it live if the demo gods grant me the</font>

39
00:02:05,100 --> 00:02:17,070
ability to<font color="#E5E5E5"> do so all right so what</font><font color="#CCCCCC"> is</font>

40
00:02:14,700 --> 00:02:20,519
tor<font color="#E5E5E5"> sorry for people</font><font color="#CCCCCC"> hurting no this</font>

41
00:02:17,070 --> 00:02:23,640
tour is a network for an immunity<font color="#E5E5E5"> that</font>

42
00:02:20,520 --> 00:02:26,160
uses multiple nodes in<font color="#E5E5E5"> a network to</font>

43
00:02:23,640 --> 00:02:27,929
route your data<font color="#E5E5E5"> it uses what's called</font>

44
00:02:26,160 --> 00:02:30,420
<font color="#E5E5E5">Onion Routing to do that I'll get</font><font color="#CCCCCC"> into</font>

45
00:02:27,930 --> 00:02:31,890
that in<font color="#CCCCCC"> a little</font><font color="#E5E5E5"> bit the goal is</font><font color="#CCCCCC"> to</font>

46
00:02:30,420 --> 00:02:33,269
allow clients to remain anonymous to

47
00:02:31,890 --> 00:02:35,250
services that<font color="#CCCCCC"> they're reaching to</font>

48
00:02:33,270 --> 00:02:38,250
whether<font color="#E5E5E5"> that's inside of</font><font color="#CCCCCC"> tor outside on</font>

49
00:02:35,250 --> 00:02:39,750
the clear net<font color="#CCCCCC"> trying to use buzzwords as</font>

50
00:02:38,250 --> 00:02:42,300
much as<font color="#CCCCCC"> possible clear net stealing when</font>

51
00:02:39,750 --> 00:02:44,340
I kind of can't<font color="#E5E5E5"> get away from but also</font>

52
00:02:42,300 --> 00:02:45,720
hidden<font color="#E5E5E5"> services are now called onion</font>

53
00:02:44,340 --> 00:02:47,520
<font color="#E5E5E5">services I'm</font><font color="#CCCCCC"> going to keep</font><font color="#E5E5E5"> calling them</font>

54
00:02:45,720 --> 00:02:49,530
hidden<font color="#E5E5E5"> services that was a decision by</font>

55
00:02:47,520 --> 00:02:51,990
<font color="#E5E5E5">the Tor project because the media</font><font color="#CCCCCC"> was</font>

56
00:02:49,530 --> 00:02:54,560
making hidden services sound scary<font color="#E5E5E5"> so</font>

57
00:02:51,990 --> 00:02:57,780
but I keep calling<font color="#E5E5E5"> them in services and</font>

58
00:02:54,560 --> 00:02:59,310
<font color="#CCCCCC">then lastly there's also a goal to allow</font>

59
00:02:57,780 --> 00:03:00,780
an endpoint to remain anonymous<font color="#E5E5E5"> from a</font>

60
00:02:59,310 --> 00:03:03,120
client<font color="#E5E5E5"> meaning</font><font color="#CCCCCC"> that if you</font><font color="#E5E5E5"> wanted to run</font>

61
00:03:00,780 --> 00:03:04,590
a service<font color="#E5E5E5"> you could do so and nobody</font>

62
00:03:03,120 --> 00:03:10,410
theoretically would be able<font color="#E5E5E5"> to know</font>

63
00:03:04,590 --> 00:03:13,770
where that<font color="#CCCCCC"> service is hosted so tor</font>

64
00:03:10,410 --> 00:03:15,570
works with tor circuits<font color="#E5E5E5"> tor circuit is</font>

65
00:03:13,770 --> 00:03:17,430
basically a route that is built over<font color="#E5E5E5"> the</font>

66
00:03:15,570 --> 00:03:20,970
<font color="#CCCCCC">Tor network that allows you</font><font color="#E5E5E5"> to connect</font>

67
00:03:17,430 --> 00:03:23,370
<font color="#CCCCCC">to an endpoint or a hidden</font><font color="#E5E5E5"> service each</font>

68
00:03:20,970 --> 00:03:25,230
each tor circuit generally consists of

69
00:03:23,370 --> 00:03:26,430
three nodes so what happens is when<font color="#CCCCCC"> you</font>

70
00:03:25,230 --> 00:03:28,679
<font color="#E5E5E5">fire up tor and you want to make a</font>

71
00:03:26,430 --> 00:03:30,690
<font color="#CCCCCC">connection</font><font color="#E5E5E5"> to a hidden service or to a</font>

72
00:03:28,680 --> 00:03:33,120
clear net address<font color="#E5E5E5"> you'll go and you'll</font>

73
00:03:30,690 --> 00:03:34,020
pick<font color="#E5E5E5"> three nodes on the network I'm not</font>

74
00:03:33,120 --> 00:03:35,580
gonna get<font color="#E5E5E5"> into detail about the</font>

75
00:03:34,020 --> 00:03:37,350
<font color="#CCCCCC">different types of nodes</font><font color="#E5E5E5"> and guard nodes</font>

76
00:03:35,580 --> 00:03:38,910
<font color="#E5E5E5">and exit nodes but there are three nodes</font>

77
00:03:37,350 --> 00:03:41,489
that<font color="#CCCCCC"> are selected</font><font color="#E5E5E5"> generally you can</font>

78
00:03:38,910 --> 00:03:44,190
increase<font color="#E5E5E5"> or decrease this count each one</font>

79
00:03:41,489 --> 00:03:45,840
of these nodes has a public key

80
00:03:44,190 --> 00:03:47,220
you end up<font color="#E5E5E5"> doing</font><font color="#CCCCCC"> a handshake with</font><font color="#E5E5E5"> each</font>

81
00:03:45,840 --> 00:03:48,870
<font color="#E5E5E5">one of these to get a session key and</font>

82
00:03:47,220 --> 00:03:50,940
<font color="#E5E5E5">that session key is what's used to</font>

83
00:03:48,870 --> 00:03:52,290
encrypt<font color="#E5E5E5"> the data</font><font color="#CCCCCC"> when they say Onion</font>

84
00:03:50,940 --> 00:03:53,490
Routing the reason is called<font color="#E5E5E5"> Onion</font>

85
00:03:52,290 --> 00:03:56,549
Routing is because<font color="#CCCCCC"> it's done in</font><font color="#E5E5E5"> layers</font>

86
00:03:53,490 --> 00:03:58,530
<font color="#E5E5E5">so you take your initial TCP payload and</font>

87
00:03:56,550 --> 00:04:00,090
<font color="#E5E5E5">then you will take the key of the first</font>

88
00:03:58,530 --> 00:04:01,770
top<font color="#E5E5E5"> encrypt the payload key of the</font>

89
00:04:00,090 --> 00:04:03,390
second hop encrypt<font color="#E5E5E5"> that payload third</font>

90
00:04:01,770 --> 00:04:05,100
hop and<font color="#E5E5E5"> crypt that payload and then</font>

91
00:04:03,390 --> 00:04:06,660
you'll send it over<font color="#CCCCCC"> the wire and what</font>

92
00:04:05,100 --> 00:04:09,060
will<font color="#E5E5E5"> happen is actually reverse that I'm</font>

93
00:04:06,660 --> 00:04:10,620
<font color="#E5E5E5">sorry last last top first what will</font>

94
00:04:09,060 --> 00:04:12,870
<font color="#E5E5E5">happen is</font><font color="#CCCCCC"> that each hop along the way</font>

95
00:04:10,620 --> 00:04:14,700
that node<font color="#CCCCCC"> will remove</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> layer</font><font color="#E5E5E5"> of</font>

96
00:04:12,870 --> 00:04:17,489
<font color="#CCCCCC">encryption</font><font color="#E5E5E5"> and route</font><font color="#CCCCCC"> it to</font><font color="#E5E5E5"> the next node</font>

97
00:04:14,700 --> 00:04:19,320
<font color="#E5E5E5">in the circuit</font><font color="#CCCCCC"> the the</font><font color="#E5E5E5"> end result of</font>

98
00:04:17,488 --> 00:04:21,810
<font color="#E5E5E5">doing it in that manner</font><font color="#CCCCCC"> is when you send</font>

99
00:04:19,320 --> 00:04:25,170
your<font color="#E5E5E5"> initial data packet to that first</font>

100
00:04:21,810 --> 00:04:27,300
<font color="#E5E5E5">that first hop</font><font color="#CCCCCC"> they're</font><font color="#E5E5E5"> the only the</font><font color="#CCCCCC"> only</font>

101
00:04:25,170 --> 00:04:29,070
hop the only node and all of these that

102
00:04:27,300 --> 00:04:30,540
<font color="#E5E5E5">can actually decrypt the the data packet</font>

103
00:04:29,070 --> 00:04:31,920
is going<font color="#CCCCCC"> to be that first</font><font color="#E5E5E5"> one because it</font>

104
00:04:30,540 --> 00:04:33,870
was actually<font color="#E5E5E5"> encrypted with its session</font>

105
00:04:31,920 --> 00:04:35,430
key it will remove<font color="#CCCCCC"> that layer of</font>

106
00:04:33,870 --> 00:04:37,800
encryption<font color="#E5E5E5"> and</font><font color="#CCCCCC"> forwarded along</font><font color="#E5E5E5"> to the</font>

107
00:04:35,430 --> 00:04:39,660
second mode<font color="#E5E5E5"> and again now that</font><font color="#CCCCCC"> was now</font>

108
00:04:37,800 --> 00:04:41,070
that's left is the encrypted data that

109
00:04:39,660 --> 00:04:43,440
was encrypted<font color="#E5E5E5"> with the the key from that</font>

110
00:04:41,070 --> 00:04:45,060
second node<font color="#CCCCCC"> and so forth</font><font color="#E5E5E5"> and so on until</font>

111
00:04:43,440 --> 00:04:47,250
it hits the<font color="#E5E5E5"> in this case the exit mode</font>

112
00:04:45,060 --> 00:04:48,870
where it goes out to<font color="#CCCCCC"> the clear net</font><font color="#E5E5E5"> at</font>

113
00:04:47,250 --> 00:04:51,210
that point it's removed all layers of

114
00:04:48,870 --> 00:04:55,040
<font color="#CCCCCC">encryption</font><font color="#E5E5E5"> from the Tor network</font><font color="#CCCCCC"> and sent</font>

115
00:04:51,210 --> 00:04:55,039
the packet out along the along<font color="#E5E5E5"> the wire</font>

116
00:04:55,190 --> 00:04:59,850
it's important to note that this last

117
00:04:57,480 --> 00:05:01,200
<font color="#E5E5E5">hop and yellow or orange isn't</font>

118
00:04:59,850 --> 00:05:02,160
necessarily always<font color="#CCCCCC"> encrypted it's up to</font>

119
00:05:01,200 --> 00:05:04,830
you<font color="#E5E5E5"> that's where we're</font><font color="#CCCCCC"> talking about</font>

120
00:05:02,160 --> 00:05:08,340
using<font color="#CCCCCC"> HTTP or any kind of TLS connection</font>

121
00:05:04,830 --> 00:05:10,890
or encryption<font color="#E5E5E5"> there are bunches of talks</font>

122
00:05:08,340 --> 00:05:12,840
on<font color="#E5E5E5"> manipulating</font><font color="#CCCCCC"> that data flow from the</font>

123
00:05:10,890 --> 00:05:14,219
exit node<font color="#E5E5E5"> because you get to</font><font color="#CCCCCC"> see</font><font color="#E5E5E5"> that</font>

124
00:05:12,840 --> 00:05:18,229
data in<font color="#CCCCCC"> plaintext</font><font color="#E5E5E5"> form if it is</font>

125
00:05:14,220 --> 00:05:22,230
unencrypted but this is not about<font color="#E5E5E5"> that</font>

126
00:05:18,230 --> 00:05:24,900
so what<font color="#E5E5E5"> are hidden services and how</font><font color="#CCCCCC"> to</font>

127
00:05:22,230 --> 00:05:28,230
hidden services work so a hidden<font color="#E5E5E5"> service</font>

128
00:05:24,900 --> 00:05:31,109
is a TCP service unfortunately right now

129
00:05:28,230 --> 00:05:33,540
<font color="#E5E5E5">as it stands the Tor network only</font><font color="#CCCCCC"> can</font>

130
00:05:31,110 --> 00:05:35,669
route TCP<font color="#E5E5E5"> traffic</font><font color="#CCCCCC"> due to some</font>

131
00:05:33,540 --> 00:05:36,930
limitations of the infrastructure or not

132
00:05:35,669 --> 00:05:39,180
the<font color="#E5E5E5"> infrastructure but</font><font color="#CCCCCC"> the technology</font>

133
00:05:36,930 --> 00:05:41,850
<font color="#E5E5E5">that's being used</font><font color="#CCCCCC"> but a</font><font color="#E5E5E5"> hidden</font><font color="#CCCCCC"> surface</font>

134
00:05:39,180 --> 00:05:44,180
will<font color="#E5E5E5"> allow a host to expose a TCP</font>

135
00:05:41,850 --> 00:05:46,590
service to the Tor network

136
00:05:44,180 --> 00:05:48,270
it is only<font color="#E5E5E5"> reachable over the Tor</font>

137
00:05:46,590 --> 00:05:50,010
network<font color="#CCCCCC"> you cannot access that</font><font color="#E5E5E5"> hidden</font>

138
00:05:48,270 --> 00:05:52,330
service without having access<font color="#E5E5E5"> to the</font><font color="#CCCCCC"> Tor</font>

139
00:05:50,010 --> 00:05:55,240
network<font color="#E5E5E5"> there are some</font>

140
00:05:52,330 --> 00:05:57,039
sites for specifically HTTP<font color="#E5E5E5"> websites are</font>

141
00:05:55,240 --> 00:05:59,860
<font color="#E5E5E5">you</font><font color="#CCCCCC"> cpp websites where</font><font color="#E5E5E5"> you can actually</font>

142
00:05:57,039 --> 00:06:01,539
visit<font color="#CCCCCC"> dot onions</font><font color="#E5E5E5"> without using tor you</font>

143
00:05:59,860 --> 00:06:03,310
can go to any<font color="#E5E5E5"> dot onion and add a dot T</font>

144
00:06:01,539 --> 00:06:05,740
<font color="#E5E5E5">oh and whoever owns I guess that TLD</font>

145
00:06:03,310 --> 00:06:07,120
<font color="#CCCCCC">will go through and</font><font color="#E5E5E5"> basically proxy that</font>

146
00:06:05,740 --> 00:06:08,500
connection for you so if you do want to

147
00:06:07,120 --> 00:06:10,090
<font color="#E5E5E5">take a quick look into tor without</font>

148
00:06:08,500 --> 00:06:11,560
actually connecting<font color="#E5E5E5"> you can use one of</font>

149
00:06:10,090 --> 00:06:13,210
<font color="#E5E5E5">those many services out there again</font><font color="#CCCCCC"> that</font>

150
00:06:11,560 --> 00:06:15,039
is<font color="#CCCCCC"> just for web traffic but generally</font>

151
00:06:13,210 --> 00:06:17,229
speaking you<font color="#CCCCCC"> do need to be connected</font>

152
00:06:15,039 --> 00:06:20,110
<font color="#CCCCCC">into the tor network to connect to to</font>

153
00:06:17,229 --> 00:06:22,449
the<font color="#E5E5E5"> hidden service so let's</font><font color="#CCCCCC"> talk</font><font color="#E5E5E5"> very</font>

154
00:06:20,110 --> 00:06:24,550
quickly about<font color="#CCCCCC"> how the hidden</font><font color="#E5E5E5"> services</font>

155
00:06:22,449 --> 00:06:27,400
actually<font color="#E5E5E5"> set themselves up and how they</font>

156
00:06:24,550 --> 00:06:29,650
function<font color="#E5E5E5"> so when a hidden service starts</font>

157
00:06:27,400 --> 00:06:31,359
up it selects three relays<font color="#E5E5E5"> from the</font>

158
00:06:29,650 --> 00:06:33,250
network<font color="#E5E5E5"> and it builds circuits to that</font>

159
00:06:31,360 --> 00:06:35,590
relay<font color="#CCCCCC"> so again the circuit is the</font><font color="#E5E5E5"> three</font>

160
00:06:33,250 --> 00:06:37,720
hop<font color="#CCCCCC"> it builds three different circuits</font>

161
00:06:35,590 --> 00:06:39,219
and it takes those<font color="#E5E5E5"> endpoint relays and</font>

162
00:06:37,720 --> 00:06:41,470
it puts them in what's<font color="#E5E5E5"> called the</font>

163
00:06:39,220 --> 00:06:42,940
descriptor basically a ticket<font color="#E5E5E5"> inside</font><font color="#CCCCCC"> of</font>

164
00:06:41,470 --> 00:06:44,620
that descriptor says<font color="#E5E5E5"> these</font><font color="#CCCCCC"> are</font><font color="#E5E5E5"> the three</font>

165
00:06:42,940 --> 00:06:46,449
end points the three relays<font color="#CCCCCC"> that I have</font>

166
00:06:44,620 --> 00:06:48,039
circuits<font color="#CCCCCC"> two right now and if you would</font>

167
00:06:46,449 --> 00:06:49,630
like<font color="#E5E5E5"> to come talk to me go talk to</font><font color="#CCCCCC"> one</font>

168
00:06:48,039 --> 00:06:51,310
<font color="#CCCCCC">of these relays</font><font color="#E5E5E5"> so it takes those three</font>

169
00:06:49,630 --> 00:06:52,990
relays<font color="#E5E5E5"> that it's</font><font color="#CCCCCC"> chosen it puts it in a</font>

170
00:06:51,310 --> 00:06:54,759
descriptor puts its public key in there

171
00:06:52,990 --> 00:06:56,650
and then it signs that descriptor with

172
00:06:54,759 --> 00:06:58,780
the private key<font color="#CCCCCC"> once it does that it</font>

173
00:06:56,650 --> 00:07:00,909
sends<font color="#CCCCCC"> that data to the</font><font color="#E5E5E5"> distributed</font><font color="#CCCCCC"> hash</font>

174
00:06:58,780 --> 00:07:03,489
table the distributed<font color="#CCCCCC"> hash table</font><font color="#E5E5E5"> is a</font>

175
00:07:00,909 --> 00:07:07,419
way that the onion<font color="#CCCCCC"> addresses actually</font>

176
00:07:03,490 --> 00:07:08,710
get advertised or answered<font color="#CCCCCC"> when a</font><font color="#E5E5E5"> client</font>

177
00:07:07,419 --> 00:07:10,270
comes<font color="#E5E5E5"> in and says</font><font color="#CCCCCC"> hey how do I get to</font>

178
00:07:08,710 --> 00:07:11,859
<font color="#CCCCCC">this onion it does a query to</font><font color="#E5E5E5"> the</font>

179
00:07:10,270 --> 00:07:14,710
<font color="#E5E5E5">descriptive hash table the distributed</font>

180
00:07:11,860 --> 00:07:17,500
hash table is a<font color="#CCCCCC"> collection of tor nodes</font>

181
00:07:14,710 --> 00:07:21,180
that<font color="#CCCCCC"> are trusted in a sense and they</font>

182
00:07:17,500 --> 00:07:23,199
basically will hold chunks of dot onions

183
00:07:21,180 --> 00:07:24,669
descriptors so when a<font color="#E5E5E5"> client comes onto</font>

184
00:07:23,199 --> 00:07:27,219
<font color="#E5E5E5">the</font><font color="#CCCCCC"> network and it says hey how do I get</font>

185
00:07:24,669 --> 00:07:29,530
to<font color="#CCCCCC"> this this hidden service it's the job</font>

186
00:07:27,219 --> 00:07:31,539
<font color="#CCCCCC">of this</font><font color="#E5E5E5"> note on</font><font color="#CCCCCC"> the distributed hash</font>

187
00:07:29,530 --> 00:07:33,729
table to<font color="#E5E5E5"> look</font><font color="#CCCCCC"> up and respond to</font><font color="#E5E5E5"> that</font>

188
00:07:31,539 --> 00:07:36,270
it's kind of your<font color="#E5E5E5"> DNS of</font><font color="#CCCCCC"> torch how those</font>

189
00:07:33,729 --> 00:07:39,669
those those<font color="#E5E5E5"> hidden services are resolved</font>

190
00:07:36,270 --> 00:07:41,919
so kind of recap the hidden service

191
00:07:39,669 --> 00:07:43,930
starts up<font color="#E5E5E5"> it selects three nodes builds</font>

192
00:07:41,919 --> 00:07:45,219
circuits to them<font color="#E5E5E5"> takes those three nodes</font>

193
00:07:43,930 --> 00:07:47,020
puts<font color="#CCCCCC"> in a descriptor</font>

194
00:07:45,219 --> 00:07:48,729
signs it and<font color="#E5E5E5"> puts that and publishes</font>

195
00:07:47,020 --> 00:07:50,948
<font color="#CCCCCC">that to the scripted hash table so that</font>

196
00:07:48,729 --> 00:07:52,630
<font color="#E5E5E5">people can come in and look up those</font>

197
00:07:50,949 --> 00:07:55,229
three<font color="#CCCCCC"> nodes basically how to get</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> that</font>

198
00:07:52,630 --> 00:07:55,229
hidden service

199
00:07:55,780 --> 00:08:01,039
so when a client<font color="#CCCCCC"> comes along</font><font color="#E5E5E5"> and it</font>

200
00:07:58,340 --> 00:08:02,900
wants to access<font color="#E5E5E5"> that hidden service</font><font color="#CCCCCC"> it's</font>

201
00:08:01,040 --> 00:08:04,310
kind<font color="#CCCCCC"> of a dance that occurs and</font><font color="#E5E5E5"> it's a</font>

202
00:08:02,900 --> 00:08:06,799
<font color="#E5E5E5">little tricky I tried my best to</font>

203
00:08:04,310 --> 00:08:09,680
illustrate without just stripping other

204
00:08:06,800 --> 00:08:11,750
people's graphics off here<font color="#CCCCCC"> so I'll kind</font>

205
00:08:09,680 --> 00:08:13,700
<font color="#E5E5E5">of walk through it what will happen is</font>

206
00:08:11,750 --> 00:08:15,320
<font color="#E5E5E5">the client starts itself up and it's</font>

207
00:08:13,700 --> 00:08:17,570
<font color="#E5E5E5">goddess connection</font><font color="#CCCCCC"> already established</font>

208
00:08:15,320 --> 00:08:19,340
to<font color="#E5E5E5"> the Tor network so it goes and it</font>

209
00:08:17,570 --> 00:08:20,990
reaches out to the<font color="#CCCCCC"> two distributed hash</font>

210
00:08:19,340 --> 00:08:22,340
table we won't get into<font color="#CCCCCC"> how that</font>

211
00:08:20,990 --> 00:08:23,870
functions<font color="#E5E5E5"> but it reaches up to the</font>

212
00:08:22,340 --> 00:08:26,419
distributed<font color="#CCCCCC"> hash table and says hey can</font>

213
00:08:23,870 --> 00:08:28,040
<font color="#CCCCCC">I please have the</font><font color="#E5E5E5"> record for</font><font color="#CCCCCC"> ABC onion</font>

214
00:08:26,420 --> 00:08:30,530
<font color="#E5E5E5">in this case let's pretend that this</font>

215
00:08:28,040 --> 00:08:32,720
hidden service over there is ABC onion

216
00:08:30,530 --> 00:08:33,980
that service<font color="#CCCCCC"> has gone head and started</font>

217
00:08:32,720 --> 00:08:35,180
<font color="#CCCCCC">up and it's got</font><font color="#E5E5E5"> his descriptor</font>

218
00:08:33,980 --> 00:08:38,390
registered on the distributive hash

219
00:08:35,179 --> 00:08:40,429
table so the client says hey can I have

220
00:08:38,390 --> 00:08:42,020
the descriptor for that the the

221
00:08:40,429 --> 00:08:44,420
distributed hash table says sure here's

222
00:08:42,020 --> 00:08:45,800
the hidden service descriptor the client

223
00:08:44,420 --> 00:08:47,360
takes a<font color="#E5E5E5"> look at the descriptor and it</font>

224
00:08:45,800 --> 00:08:49,400
says<font color="#CCCCCC"> okay this hidden service has chosen</font>

225
00:08:47,360 --> 00:08:51,050
<font color="#E5E5E5">these</font><font color="#CCCCCC"> three nodes that is filty</font><font color="#E5E5E5"> circuit</font>

226
00:08:49,400 --> 00:08:54,170
so<font color="#CCCCCC"> -</font><font color="#E5E5E5"> I can go talk to it on one of those</font>

227
00:08:51,050 --> 00:08:56,240
nodes<font color="#E5E5E5"> so the client of that point goes</font>

228
00:08:54,170 --> 00:08:57,650
and it<font color="#E5E5E5"> builds a</font><font color="#CCCCCC"> tour</font><font color="#E5E5E5"> circuit to that</font>

229
00:08:56,240 --> 00:09:01,130
node that<font color="#E5E5E5"> introduction point in this</font>

230
00:08:57,650 --> 00:09:03,110
case<font color="#E5E5E5"> if we've got relay 1 2 & 3 in our</font>

231
00:09:01,130 --> 00:09:04,820
descriptor<font color="#E5E5E5"> the client needs</font><font color="#CCCCCC"> to select</font>

232
00:09:03,110 --> 00:09:06,800
any one<font color="#CCCCCC"> of</font><font color="#E5E5E5"> those relays</font><font color="#CCCCCC"> to build a tour</font>

233
00:09:04,820 --> 00:09:09,020
circuit out<font color="#CCCCCC"> - and that's called</font><font color="#E5E5E5"> the</font>

234
00:09:06,800 --> 00:09:10,880
introduction point so the client says<font color="#CCCCCC"> ok</font>

235
00:09:09,020 --> 00:09:12,949
I'm<font color="#CCCCCC"> going to pick number 2 and I'm gonna</font>

236
00:09:10,880 --> 00:09:14,390
<font color="#E5E5E5">build a tour circuit out to number 2 so</font>

237
00:09:12,950 --> 00:09:16,220
it's building a tour circuit out to

238
00:09:14,390 --> 00:09:19,460
number<font color="#E5E5E5"> 2 the hidden service already has</font>

239
00:09:16,220 --> 00:09:21,320
a<font color="#E5E5E5"> tour circuit built to number 2 now</font><font color="#CCCCCC"> the</font>

240
00:09:19,460 --> 00:09:23,570
hidden service keeps that<font color="#E5E5E5"> tor circuit</font>

241
00:09:21,320 --> 00:09:25,460
established<font color="#E5E5E5"> to that introduction point</font>

242
00:09:23,570 --> 00:09:26,690
and<font color="#CCCCCC"> just leaves</font><font color="#E5E5E5"> that link open and it</font>

243
00:09:25,460 --> 00:09:27,890
then<font color="#CCCCCC"> goes out</font><font color="#E5E5E5"> on the network</font><font color="#CCCCCC"> that's</font>

244
00:09:26,690 --> 00:09:29,540
<font color="#E5E5E5">where it gets</font><font color="#CCCCCC"> a little</font><font color="#E5E5E5"> complicated then</font>

245
00:09:27,890 --> 00:09:31,250
goes out<font color="#E5E5E5"> on the network</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> picture that</font>

246
00:09:29,540 --> 00:09:34,250
green line as this line right<font color="#E5E5E5"> here</font><font color="#CCCCCC"> so</font>

247
00:09:31,250 --> 00:09:36,200
<font color="#CCCCCC">that green line</font><font color="#E5E5E5"> hasn't changed the</font>

248
00:09:34,250 --> 00:09:38,060
client<font color="#E5E5E5"> then uses this red line and it</font>

249
00:09:36,200 --> 00:09:40,430
chooses<font color="#CCCCCC"> a completely random node on the</font>

250
00:09:38,060 --> 00:09:42,050
network<font color="#E5E5E5"> to use as a rendezvous</font><font color="#CCCCCC"> point</font><font color="#E5E5E5"> it</font>

251
00:09:40,430 --> 00:09:44,060
then builds a circuit to that rendezvous

252
00:09:42,050 --> 00:09:45,620
<font color="#E5E5E5">point and holds that circuit open so</font>

253
00:09:44,060 --> 00:09:47,119
another circuit<font color="#E5E5E5"> to a completely random</font>

254
00:09:45,620 --> 00:09:49,400
node on the network<font color="#CCCCCC"> that</font><font color="#E5E5E5"> it holds open</font>

255
00:09:47,120 --> 00:09:50,780
<font color="#E5E5E5">after</font><font color="#CCCCCC"> it's done that it</font><font color="#E5E5E5"> goes back to its</font>

256
00:09:49,400 --> 00:09:52,459
previous circuit that<font color="#E5E5E5"> it has to the</font>

257
00:09:50,780 --> 00:09:54,530
<font color="#E5E5E5">introduction point this green line</font><font color="#CCCCCC"> here</font>

258
00:09:52,460 --> 00:09:56,570
and it says to<font color="#CCCCCC"> the</font><font color="#E5E5E5"> hidden service who's</font>

259
00:09:54,530 --> 00:09:58,459
listening on<font color="#CCCCCC"> that</font><font color="#E5E5E5"> yellow line was built</font>

260
00:09:56,570 --> 00:09:59,840
<font color="#E5E5E5">that circuit out it says hey I would</font>

261
00:09:58,460 --> 00:10:01,340
really like to<font color="#E5E5E5"> talk to you can you</font><font color="#CCCCCC"> come</font>

262
00:09:59,840 --> 00:10:03,380
over<font color="#E5E5E5"> to this rendezvous point and we'll</font>

263
00:10:01,340 --> 00:10:05,210
talk over<font color="#E5E5E5"> there and at that point the</font>

264
00:10:03,380 --> 00:10:07,130
hidden service goes and it<font color="#E5E5E5"> builds a</font>

265
00:10:05,210 --> 00:10:09,800
<font color="#E5E5E5">story circuit to the rendezvous</font><font color="#CCCCCC"> point</font>

266
00:10:07,130 --> 00:10:11,300
now you've got the<font color="#E5E5E5"> client and the</font><font color="#CCCCCC"> server</font>

267
00:10:09,800 --> 00:10:13,280
both connecting to this randomly

268
00:10:11,300 --> 00:10:14,959
selected rendezvous point

269
00:10:13,280 --> 00:10:16,550
at which point<font color="#E5E5E5"> they can go ahead and</font>

270
00:10:14,960 --> 00:10:20,540
<font color="#E5E5E5">send</font><font color="#CCCCCC"> pictures of cats</font><font color="#E5E5E5"> because that's</font>

271
00:10:16,550 --> 00:10:22,010
what you do<font color="#CCCCCC"> so what are some</font><font color="#E5E5E5"> attacks on</font>

272
00:10:20,540 --> 00:10:22,939
<font color="#E5E5E5">hidden services</font><font color="#CCCCCC"> well real quick does</font>

273
00:10:22,010 --> 00:10:24,500
anyone have any questions<font color="#E5E5E5"> about that</font>

274
00:10:22,940 --> 00:10:30,050
routing I know it's kind of a convoluted

275
00:10:24,500 --> 00:10:31,850
<font color="#E5E5E5">dance</font><font color="#CCCCCC"> all right so attacks there are a</font>

276
00:10:30,050 --> 00:10:33,380
lot of attacks on hidden services<font color="#E5E5E5"> a lot</font>

277
00:10:31,850 --> 00:10:37,520
<font color="#CCCCCC">of the attacks</font><font color="#E5E5E5"> on hidden services have</font>

278
00:10:33,380 --> 00:10:39,260
to<font color="#CCCCCC"> do with the</font><font color="#E5E5E5"> with the routing not so</font>

279
00:10:37,520 --> 00:10:41,150
much what we're gonna talk<font color="#CCCCCC"> about</font><font color="#E5E5E5"> today I</font>

280
00:10:39,260 --> 00:10:43,220
want to be able<font color="#E5E5E5"> to come up on</font><font color="#CCCCCC"> stage and</font>

281
00:10:41,150 --> 00:10:44,720
show some<font color="#CCCCCC"> techniques that</font><font color="#E5E5E5"> wouldn't get</font>

282
00:10:43,220 --> 00:10:47,390
arrested<font color="#E5E5E5"> for so we're not going to do</font>

283
00:10:44,720 --> 00:10:49,820
that<font color="#CCCCCC"> but some of those attacks are</font>

284
00:10:47,390 --> 00:10:51,140
things like timing<font color="#E5E5E5"> attacks</font><font color="#CCCCCC"> so if you are</font>

285
00:10:49,820 --> 00:10:53,690
<font color="#E5E5E5">say big government and you have</font>

286
00:10:51,140 --> 00:10:56,390
<font color="#E5E5E5">visibility into the backbone</font><font color="#CCCCCC"> of networks</font>

287
00:10:53,690 --> 00:10:57,950
or<font color="#E5E5E5"> I up links to ISPs</font><font color="#CCCCCC"> you can watch</font>

288
00:10:56,390 --> 00:10:59,390
<font color="#E5E5E5">traffic correlation and you can say hey</font>

289
00:10:57,950 --> 00:11:01,010
when this user connects<font color="#E5E5E5"> into tor and</font>

290
00:10:59,390 --> 00:11:02,510
<font color="#E5E5E5">they send three packets three packets</font>

291
00:11:01,010 --> 00:11:03,620
goes to this hidden service over here

292
00:11:02,510 --> 00:11:05,150
and they can<font color="#E5E5E5"> just kind</font><font color="#CCCCCC"> of watch these</font>

293
00:11:03,620 --> 00:11:08,150
different<font color="#E5E5E5"> points along the network and</font>

294
00:11:05,150 --> 00:11:10,370
they can do timing correlations<font color="#E5E5E5"> uh one</font>

295
00:11:08,150 --> 00:11:12,560
of the<font color="#E5E5E5"> other taxes forced paths</font><font color="#CCCCCC"> so if</font>

296
00:11:10,370 --> 00:11:13,910
you have a bunch of rogue nodes on the

297
00:11:12,560 --> 00:11:15,260
network<font color="#CCCCCC"> that</font><font color="#E5E5E5"> you want someone to come</font><font color="#CCCCCC"> on</font>

298
00:11:13,910 --> 00:11:17,180
to you and<font color="#E5E5E5"> you want to analyze that</font>

299
00:11:15,260 --> 00:11:18,290
traffic<font color="#E5E5E5"> you can do denial the service</font>

300
00:11:17,180 --> 00:11:21,609
attacks<font color="#E5E5E5"> on other nodes on the network</font>

301
00:11:18,290 --> 00:11:23,959
<font color="#E5E5E5">and kind of force people into your nodes</font>

302
00:11:21,610 --> 00:11:26,600
<font color="#CCCCCC">service exploitation</font><font color="#E5E5E5"> it's one of the</font>

303
00:11:23,960 --> 00:11:28,070
main<font color="#E5E5E5"> ones just</font><font color="#CCCCCC"> like the Internet</font><font color="#E5E5E5"> these</font>

304
00:11:26,600 --> 00:11:31,670
are regular services a lot<font color="#E5E5E5"> of</font><font color="#CCCCCC"> them are</font>

305
00:11:28,070 --> 00:11:34,250
vulnerable you find a lot of IRC and web

306
00:11:31,670 --> 00:11:36,650
servers mostly on tour<font color="#E5E5E5"> a lot of the web</font>

307
00:11:34,250 --> 00:11:38,210
servers are poorly coded PHP code<font color="#E5E5E5"> a lot</font>

308
00:11:36,650 --> 00:11:42,560
of the<font color="#E5E5E5"> IRC servers run really bad</font>

309
00:11:38,210 --> 00:11:45,290
<font color="#E5E5E5">botnets</font><font color="#CCCCCC"> command injection around and</font>

310
00:11:42,560 --> 00:11:48,109
then<font color="#E5E5E5"> OPSEC so slip ups on the</font>

311
00:11:45,290 --> 00:11:50,089
<font color="#E5E5E5">administrators</font><font color="#CCCCCC"> we've seen this with Silk</font>

312
00:11:48,110 --> 00:11:51,590
<font color="#E5E5E5">Road</font><font color="#CCCCCC"> we've seen this with</font><font color="#E5E5E5"> quite a</font><font color="#CCCCCC"> few</font>

313
00:11:50,090 --> 00:11:56,570
folks<font color="#CCCCCC"> that have tried</font><font color="#E5E5E5"> to run hidden</font>

314
00:11:51,590 --> 00:11:57,950
services<font color="#CCCCCC"> the then you've got O'Day's as</font>

315
00:11:56,570 --> 00:11:59,810
well sorry that kind<font color="#CCCCCC"> of goes back</font><font color="#E5E5E5"> up</font><font color="#CCCCCC"> to</font>

316
00:11:57,950 --> 00:12:01,460
<font color="#E5E5E5">the to the service exploitation the</font>

317
00:11:59,810 --> 00:12:02,660
odious can affect either the services or

318
00:12:01,460 --> 00:12:05,120
<font color="#E5E5E5">the clients we've seen in the past</font>

319
00:12:02,660 --> 00:12:06,740
<font color="#CCCCCC">federal agencies use javascript</font><font color="#E5E5E5"> code a</font>

320
00:12:05,120 --> 00:12:08,210
to actually<font color="#CCCCCC"> break</font><font color="#E5E5E5"> out of client browsers</font>

321
00:12:06,740 --> 00:12:10,160
so they could do<font color="#CCCCCC"> non Amma's</font><font color="#E5E5E5"> clients you</font>

322
00:12:08,210 --> 00:12:12,020
went to<font color="#E5E5E5"> these hidden services so there's</font>

323
00:12:10,160 --> 00:12:13,939
a handful of attacks against hidden

324
00:12:12,020 --> 00:12:15,710
services but today we're<font color="#E5E5E5"> just</font><font color="#CCCCCC"> going to</font>

325
00:12:13,940 --> 00:12:16,360
<font color="#CCCCCC">focus on on the</font><font color="#E5E5E5"> Miss configuration</font>

326
00:12:15,710 --> 00:12:18,749
aspect

327
00:12:16,360 --> 00:12:21,579
an administrator has kind<font color="#E5E5E5"> of slipped up</font>

328
00:12:18,749 --> 00:12:23,230
so how do<font color="#E5E5E5"> you interface with tor</font><font color="#CCCCCC"> if you</font>

329
00:12:21,579 --> 00:12:25,089
want to play<font color="#E5E5E5"> around with this</font><font color="#CCCCCC"> stuff most</font>

330
00:12:23,230 --> 00:12:26,439
end users<font color="#CCCCCC"> will use the tor browser to</font>

331
00:12:25,089 --> 00:12:27,549
connect into tor it's probably<font color="#E5E5E5"> your</font>

332
00:12:26,439 --> 00:12:28,748
<font color="#E5E5E5">safest</font><font color="#CCCCCC"> bet if you're just</font><font color="#E5E5E5"> going</font><font color="#CCCCCC"> to</font>

333
00:12:27,549 --> 00:12:30,040
browse the<font color="#CCCCCC"> web they've got a</font><font color="#E5E5E5"> bunch of</font>

334
00:12:28,749 --> 00:12:32,350
cool<font color="#E5E5E5"> features in there for you to try to</font>

335
00:12:30,040 --> 00:12:34,868
<font color="#E5E5E5">help help these</font><font color="#CCCCCC"> D anonymization attacks</font>

336
00:12:32,350 --> 00:12:36,819
and fingerprint attacks<font color="#CCCCCC"> a lot of</font>

337
00:12:34,869 --> 00:12:38,230
services<font color="#CCCCCC"> and all services that straight</font>

338
00:12:36,819 --> 00:12:39,549
<font color="#E5E5E5">up we'll</font><font color="#CCCCCC"> just use the tour daemon</font>

339
00:12:38,230 --> 00:12:42,480
directly and I'll talk about what that

340
00:12:39,549 --> 00:12:45,100
<font color="#CCCCCC">looks like in a minute tor is exposed</font><font color="#E5E5E5"> to</font>

341
00:12:42,480 --> 00:12:46,389
the client in<font color="#E5E5E5"> the form of a socks proxy</font>

342
00:12:45,100 --> 00:12:48,249
so when you actually<font color="#E5E5E5"> start the tour</font>

343
00:12:46,389 --> 00:12:50,589
daemon you have this<font color="#E5E5E5"> Sox listener that's</font>

344
00:12:48,249 --> 00:12:53,170
just sitting<font color="#E5E5E5"> on localhost anything that</font>

345
00:12:50,589 --> 00:12:55,360
speaks<font color="#E5E5E5"> Sox can be configured to use that</font>

346
00:12:53,170 --> 00:12:57,429
socks proxy<font color="#CCCCCC"> and you can also use a</font>

347
00:12:55,360 --> 00:12:59,769
series of tools like proxy chains

348
00:12:57,429 --> 00:13:02,049
there's tor specific ones like tor<font color="#CCCCCC"> socks</font>

349
00:12:59,769 --> 00:13:04,209
and<font color="#CCCCCC"> tor if I that will actually</font><font color="#E5E5E5"> hook</font>

350
00:13:02,049 --> 00:13:06,189
that application<font color="#E5E5E5"> on an on launch and it</font>

351
00:13:04,209 --> 00:13:07,779
does something<font color="#E5E5E5"> similar</font><font color="#CCCCCC"> or may even</font><font color="#E5E5E5"> do LD</font>

352
00:13:06,189 --> 00:13:09,519
preload<font color="#CCCCCC"> where it actually</font><font color="#E5E5E5"> hooks all the</font>

353
00:13:07,779 --> 00:13:10,929
network calls so it<font color="#E5E5E5"> forces everything it</font>

354
00:13:09,519 --> 00:13:13,779
wraps it and it pushes<font color="#E5E5E5"> it</font><font color="#CCCCCC"> through that</font>

355
00:13:10,929 --> 00:13:15,730
socks proxy for you<font color="#CCCCCC"> again</font><font color="#E5E5E5"> this is we're</font>

356
00:13:13,779 --> 00:13:17,559
<font color="#CCCCCC">talking</font><font color="#E5E5E5"> TCP only there is some DNS</font>

357
00:13:15,730 --> 00:13:19,739
resolution that can occur but<font color="#CCCCCC"> we won't</font>

358
00:13:17,559 --> 00:13:22,929
get<font color="#E5E5E5"> into that</font>

359
00:13:19,739 --> 00:13:24,579
so servers<font color="#E5E5E5"> if they want</font><font color="#CCCCCC"> to expose a</font>

360
00:13:22,929 --> 00:13:26,110
service<font color="#CCCCCC"> they</font><font color="#E5E5E5"> can modify their tour</font>

361
00:13:24,579 --> 00:13:28,508
configuration<font color="#CCCCCC"> files so that</font><font color="#E5E5E5"> when torch</font>

362
00:13:26,110 --> 00:13:30,220
starts up it will<font color="#CCCCCC"> actually map a hidden</font>

363
00:13:28,509 --> 00:13:36,699
service<font color="#E5E5E5"> to a internal service that</font>

364
00:13:30,220 --> 00:13:38,980
they're running so there's<font color="#E5E5E5"> a few ways as</font>

365
00:13:36,699 --> 00:13:44,919
I as I mentioned<font color="#CCCCCC"> previously to</font><font color="#E5E5E5"> interface</font>

366
00:13:38,980 --> 00:13:48,220
<font color="#E5E5E5">with</font><font color="#CCCCCC"> the the Tor listener</font><font color="#E5E5E5"> the Tor socks</font>

367
00:13:44,919 --> 00:13:50,949
proxy<font color="#E5E5E5"> fires up on localhost only so that</font>

368
00:13:48,220 --> 00:13:53,679
you can't exist it from the<font color="#E5E5E5"> public</font>

369
00:13:50,949 --> 00:13:55,628
interface<font color="#E5E5E5"> so if you wanted to start</font>

370
00:13:53,679 --> 00:13:57,488
toward you can just you can install it

371
00:13:55,629 --> 00:13:58,959
through<font color="#E5E5E5"> the package repository you</font><font color="#CCCCCC"> can</font>

372
00:13:57,489 --> 00:14:01,480
download it check the checksum and<font color="#E5E5E5"> do</font>

373
00:13:58,959 --> 00:14:03,099
the installation but the end<font color="#E5E5E5"> of the once</font>

374
00:14:01,480 --> 00:14:05,199
<font color="#CCCCCC">it's installed</font><font color="#E5E5E5"> and once it's</font><font color="#CCCCCC"> running you</font>

375
00:14:03,100 --> 00:14:06,489
<font color="#CCCCCC">basically</font><font color="#E5E5E5"> have a socks proxy to interact</font>

376
00:14:05,199 --> 00:14:07,389
with<font color="#CCCCCC"> that socks proxy you could use a</font>

377
00:14:06,489 --> 00:14:10,209
<font color="#CCCCCC">variety of tools that</font><font color="#E5E5E5"> I mentioned</font>

378
00:14:07,389 --> 00:14:11,709
<font color="#CCCCCC">earlier this is</font><font color="#E5E5E5"> the demo here of just</font>

379
00:14:10,209 --> 00:14:12,449
how quick and easy<font color="#E5E5E5"> it is</font><font color="#CCCCCC"> to use these</font>

380
00:14:11,709 --> 00:14:15,339
tools

381
00:14:12,449 --> 00:14:17,229
here's a simple curl<font color="#E5E5E5"> just going to this</font>

382
00:14:15,339 --> 00:14:19,149
<font color="#CCCCCC">website that returns your IP</font><font color="#E5E5E5"> now in that</font>

383
00:14:17,230 --> 00:14:21,939
<font color="#E5E5E5">case we can see the the IP of my VPS</font>

384
00:14:19,149 --> 00:14:24,040
this is the VPSs went up for<font color="#E5E5E5"> testing</font><font color="#CCCCCC"> the</font>

385
00:14:21,939 --> 00:14:25,389
next one we're<font color="#CCCCCC"> using tor 5 with curls so</font>

386
00:14:24,040 --> 00:14:25,969
you just put<font color="#E5E5E5"> torah</font><font color="#CCCCCC"> phi at the beginning</font>

387
00:14:25,389 --> 00:14:27,709
<font color="#CCCCCC">here come</font>

388
00:14:25,970 --> 00:14:28,970
and<font color="#CCCCCC"> you've</font><font color="#E5E5E5"> run that same exact curl</font>

389
00:14:27,709 --> 00:14:30,339
command and you'll see that we're

390
00:14:28,970 --> 00:14:34,189
actually<font color="#CCCCCC"> getting the IP of</font><font color="#E5E5E5"> an exit node</font>

391
00:14:30,339 --> 00:14:37,519
<font color="#E5E5E5">and the same thing will</font><font color="#CCCCCC"> happen</font><font color="#E5E5E5"> with</font><font color="#CCCCCC"> tor</font>

392
00:14:34,189 --> 00:14:39,079
<font color="#E5E5E5">socks</font><font color="#CCCCCC"> and with proxy chains</font><font color="#E5E5E5"> you got him</font>

393
00:14:37,519 --> 00:14:42,199
<font color="#CCCCCC">actually get routed</font><font color="#E5E5E5"> out to that that</font>

394
00:14:39,079 --> 00:14:45,319
<font color="#E5E5E5">that</font><font color="#CCCCCC"> goes it</font><font color="#E5E5E5"> no it in in your circuit</font><font color="#CCCCCC"> as</font>

395
00:14:42,199 --> 00:14:46,790
far<font color="#E5E5E5"> as why these IPS are the same you'll</font>

396
00:14:45,319 --> 00:14:48,500
notice I've got the clear net IP on the

397
00:14:46,790 --> 00:14:50,629
first request<font color="#E5E5E5"> and then the</font><font color="#CCCCCC"> next</font><font color="#E5E5E5"> three</font>

398
00:14:48,500 --> 00:14:54,019
requests all come out from the same

399
00:14:50,629 --> 00:14:56,509
magazine<font color="#CCCCCC"> node your tour circuits have a</font>

400
00:14:54,019 --> 00:14:58,040
<font color="#CCCCCC">lifetime on them</font><font color="#E5E5E5"> the last two hops in</font>

401
00:14:56,509 --> 00:15:00,889
your tour circuit will change over a

402
00:14:58,040 --> 00:15:02,599
period<font color="#E5E5E5"> of time so after I think it's I</font>

403
00:15:00,889 --> 00:15:04,519
<font color="#CCCCCC">think it's a matter of hours it will</font>

404
00:15:02,600 --> 00:15:05,899
<font color="#E5E5E5">actually rotate those the circuits you</font>

405
00:15:04,519 --> 00:15:07,250
<font color="#CCCCCC">can build</font><font color="#E5E5E5"> new circuits whenever you want</font>

406
00:15:05,899 --> 00:15:08,720
<font color="#E5E5E5">so if you wanted to you can actually ask</font>

407
00:15:07,250 --> 00:15:10,850
the<font color="#E5E5E5"> Tor network</font><font color="#CCCCCC"> hey please initiate a</font>

408
00:15:08,720 --> 00:15:12,379
new circuit and you'll get<font color="#E5E5E5"> a</font><font color="#CCCCCC"> different</font>

409
00:15:10,850 --> 00:15:14,120
exit node<font color="#E5E5E5"> so if you're trying to change</font>

410
00:15:12,379 --> 00:15:15,589
your external<font color="#CCCCCC"> IP</font><font color="#E5E5E5"> and you want to change</font>

411
00:15:14,120 --> 00:15:17,420
<font color="#CCCCCC">that dynamically</font><font color="#E5E5E5"> you can actually issue</font>

412
00:15:15,589 --> 00:15:19,370
commands<font color="#CCCCCC"> to do that it will update your</font>

413
00:15:17,420 --> 00:15:22,790
it would build<font color="#E5E5E5"> a new tor circuit for you</font>

414
00:15:19,370 --> 00:15:24,379
on the fly<font color="#CCCCCC"> the first hop the the the</font>

415
00:15:22,790 --> 00:15:25,939
entry node<font color="#E5E5E5"> that actually stays the same</font>

416
00:15:24,379 --> 00:15:27,430
for a few months<font color="#E5E5E5"> that doesn't change the</font>

417
00:15:25,939 --> 00:15:29,719
first of the three notes<font color="#E5E5E5"> stays the same</font>

418
00:15:27,430 --> 00:15:31,099
reason is if that<font color="#E5E5E5"> was changing</font>

419
00:15:29,720 --> 00:15:32,569
constantly<font color="#CCCCCC"> if there's a higher</font>

420
00:15:31,100 --> 00:15:33,860
probability that somebody<font color="#E5E5E5"> could come in</font>

421
00:15:32,569 --> 00:15:35,360
<font color="#E5E5E5">and</font><font color="#CCCCCC"> do an autumn eyes you just because</font>

422
00:15:33,860 --> 00:15:37,309
of<font color="#CCCCCC"> a frequency of</font><font color="#E5E5E5"> that change so the</font>

423
00:15:35,360 --> 00:15:38,480
idea from<font color="#E5E5E5"> the Tor project is if the</font>

424
00:15:37,309 --> 00:15:39,680
<font color="#E5E5E5">first hop doesn't change for a few</font>

425
00:15:38,480 --> 00:15:41,389
months you're either or at<font color="#E5E5E5"> a</font>

426
00:15:39,680 --> 00:15:45,769
beginning or you're<font color="#E5E5E5"> not for three</font>

427
00:15:41,389 --> 00:15:47,899
months<font color="#E5E5E5"> so setting up a hidden service</font>

428
00:15:45,769 --> 00:15:50,899
<font color="#E5E5E5">very straightforward</font><font color="#CCCCCC"> in this case I'm</font>

429
00:15:47,899 --> 00:15:53,329
doing<font color="#CCCCCC"> this on Ubuntu 1604 I just went</font>

430
00:15:50,899 --> 00:15:55,120
ahead<font color="#E5E5E5"> and I added the repository for the</font>

431
00:15:53,329 --> 00:15:57,109
Tor project into my<font color="#E5E5E5"> Debian install I</font>

432
00:15:55,120 --> 00:15:58,759
installed<font color="#CCCCCC"> that and I installed Apache</font>

433
00:15:57,110 --> 00:16:02,300
<font color="#E5E5E5">will say we're gonna expose Apache as</font>

434
00:15:58,759 --> 00:16:04,579
our hidden service in this<font color="#E5E5E5"> case once</font>

435
00:16:02,300 --> 00:16:08,449
Apache was installed<font color="#E5E5E5"> I went ahead and I</font>

436
00:16:04,579 --> 00:16:11,229
modified the<font color="#E5E5E5"> tor configuration</font><font color="#CCCCCC"> you can</font>

437
00:16:08,449 --> 00:16:15,139
<font color="#E5E5E5">see all that really needs to happen is</font>

438
00:16:11,230 --> 00:16:17,300
the<font color="#CCCCCC"> Tor</font><font color="#E5E5E5"> RC will have to be updated</font><font color="#CCCCCC"> so</font>

439
00:16:15,139 --> 00:16:19,339
<font color="#CCCCCC">that it exposes the the Apache interface</font>

440
00:16:17,300 --> 00:16:22,040
it's as simple as<font color="#E5E5E5"> going into your tour</font>

441
00:16:19,339 --> 00:16:24,439
<font color="#CCCCCC">RC</font><font color="#E5E5E5"> configuration saying hey I want tor</font>

442
00:16:22,040 --> 00:16:26,420
to listen on this port<font color="#CCCCCC"> let's say</font><font color="#E5E5E5"> five</font>

443
00:16:24,439 --> 00:16:28,009
<font color="#E5E5E5">five five and whenever traffic comes</font>

444
00:16:26,420 --> 00:16:30,019
into my hidden<font color="#E5E5E5"> service on five five five</font>

445
00:16:28,009 --> 00:16:33,100
I want it redirected to this port<font color="#CCCCCC"> 22</font>

446
00:16:30,019 --> 00:16:35,290
<font color="#CCCCCC">eighty whatever you want</font>

447
00:16:33,100 --> 00:16:37,120
so you modify the tour<font color="#CCCCCC"> RC</font><font color="#E5E5E5"> you restart</font>

448
00:16:35,290 --> 00:16:39,760
your<font color="#E5E5E5"> services or start your services I</font>

449
00:16:37,120 --> 00:16:41,020
<font color="#CCCCCC">type out there and then lastly you need</font>

450
00:16:39,760 --> 00:16:42,610
to know your<font color="#E5E5E5"> hidden service name your</font>

451
00:16:41,020 --> 00:16:44,500
<font color="#E5E5E5">hidden service name is actually stored</font>

452
00:16:42,610 --> 00:16:46,270
in the bar<font color="#CCCCCC"> lib tour</font><font color="#E5E5E5"> in the service</font>

453
00:16:44,500 --> 00:16:49,120
directory at least on Debian Ubuntu

454
00:16:46,270 --> 00:16:50,560
<font color="#CCCCCC">based distros you can just cat it that</font>

455
00:16:49,120 --> 00:16:52,740
name gets<font color="#CCCCCC"> generated as soon as you</font>

456
00:16:50,560 --> 00:16:55,390
enable the hidden service in the<font color="#CCCCCC"> Tor RC</font>

457
00:16:52,740 --> 00:16:57,670
<font color="#E5E5E5">there is a corresponding private key</font>

458
00:16:55,390 --> 00:16:59,770
<font color="#E5E5E5">that</font><font color="#CCCCCC"> hidden that hidden</font><font color="#E5E5E5"> service name is</font>

459
00:16:57,670 --> 00:17:01,959
basically a hash<font color="#CCCCCC"> of</font><font color="#E5E5E5"> your public key the</font>

460
00:16:59,770 --> 00:17:03,670
public key is<font color="#CCCCCC"> derived</font><font color="#E5E5E5"> from that and you</font>

461
00:17:01,960 --> 00:17:07,750
use your<font color="#CCCCCC"> private key to do some of the</font>

462
00:17:03,670 --> 00:17:09,609
kapag<font color="#CCCCCC"> rafi involvements so for this</font>

463
00:17:07,750 --> 00:17:10,839
attack<font color="#CCCCCC"> I</font><font color="#E5E5E5"> wanted to go through or for</font>

464
00:17:09,609 --> 00:17:12,339
<font color="#E5E5E5">these attacks I wanted to go through and</font>

465
00:17:10,839 --> 00:17:13,629
<font color="#E5E5E5">look at</font><font color="#CCCCCC"> some onions</font><font color="#E5E5E5"> and see if there</font>

466
00:17:12,339 --> 00:17:15,339
were<font color="#CCCCCC"> miss</font><font color="#E5E5E5"> configurations that I could</font>

467
00:17:13,630 --> 00:17:17,140
find that<font color="#CCCCCC"> would allow me to get there</font>

468
00:17:15,339 --> 00:17:19,409
clear net<font color="#E5E5E5"> IP addresses or any other</font>

469
00:17:17,140 --> 00:17:21,850
information<font color="#CCCCCC"> that</font><font color="#E5E5E5"> would be anonymize them</font>

470
00:17:19,410 --> 00:17:24,190
<font color="#E5E5E5">to do that you need</font><font color="#CCCCCC"> to have a list</font><font color="#E5E5E5"> of</font>

471
00:17:21,849 --> 00:17:26,589
onions to<font color="#CCCCCC"> get onions there's a few</font>

472
00:17:24,190 --> 00:17:28,120
different<font color="#E5E5E5"> ways a common way or a common</font>

473
00:17:26,589 --> 00:17:29,860
approach<font color="#CCCCCC"> to obtain onions is to actually</font>

474
00:17:28,119 --> 00:17:31,899
<font color="#E5E5E5">become a node on that distributed hash</font>

475
00:17:29,860 --> 00:17:33,490
table so<font color="#E5E5E5"> you get onto</font><font color="#CCCCCC"> tour and you sit</font>

476
00:17:31,900 --> 00:17:35,710
on tour for a<font color="#CCCCCC"> while and tour begins to</font>

477
00:17:33,490 --> 00:17:37,870
trust you<font color="#E5E5E5"> and then you can say hey I'd</font>

478
00:17:35,710 --> 00:17:39,280
like<font color="#E5E5E5"> to be on the distributed hash table</font>

479
00:17:37,870 --> 00:17:40,989
they say hey<font color="#E5E5E5"> you check out let's go</font>

480
00:17:39,280 --> 00:17:42,399
ahead and get<font color="#E5E5E5"> you</font><font color="#CCCCCC"> on there and once</font>

481
00:17:40,990 --> 00:17:44,440
you're on the<font color="#E5E5E5"> tour network are on the</font>

482
00:17:42,400 --> 00:17:46,150
tour distributed hash table you'll

483
00:17:44,440 --> 00:17:47,590
actually<font color="#CCCCCC"> start to see</font><font color="#E5E5E5"> hidden services</font>

484
00:17:46,150 --> 00:17:49,240
start up and register<font color="#E5E5E5"> with you like a</font>

485
00:17:47,590 --> 00:17:50,980
DNS server<font color="#CCCCCC"> and</font><font color="#E5E5E5"> they'll say hey here's my</font>

486
00:17:49,240 --> 00:17:52,210
descriptor and<font color="#E5E5E5"> since you're</font><font color="#CCCCCC"> just sitting</font>

487
00:17:50,980 --> 00:17:53,590
on<font color="#E5E5E5"> that hidden since you're sitting</font><font color="#CCCCCC"> on</font>

488
00:17:52,210 --> 00:17:55,150
the distributed<font color="#CCCCCC"> hash table you can just</font>

489
00:17:53,590 --> 00:17:56,980
gather those descriptors<font color="#E5E5E5"> and all</font><font color="#CCCCCC"> the</font>

490
00:17:55,150 --> 00:17:59,470
<font color="#CCCCCC">sudden</font><font color="#E5E5E5"> you get this list of onions that</font>

491
00:17:56,980 --> 00:18:00,490
<font color="#CCCCCC">are out there the other nice thing is if</font>

492
00:17:59,470 --> 00:18:02,110
you're<font color="#E5E5E5"> sitting on there just the</font>

493
00:18:00,490 --> 00:18:03,760
distributed<font color="#CCCCCC"> hash table</font><font color="#E5E5E5"> you get to see</font>

494
00:18:02,110 --> 00:18:05,169
the<font color="#CCCCCC"> request coming</font><font color="#E5E5E5"> in for those onion</font>

495
00:18:03,760 --> 00:18:06,760
<font color="#E5E5E5">sites as well so you can kind of do</font>

496
00:18:05,170 --> 00:18:08,740
analytics on how many<font color="#E5E5E5"> requests came in</font>

497
00:18:06,760 --> 00:18:10,120
<font color="#E5E5E5">for different sites</font><font color="#CCCCCC"> and then you can say</font>

498
00:18:08,740 --> 00:18:12,790
you know what kind of content<font color="#CCCCCC"> was on</font>

499
00:18:10,120 --> 00:18:14,229
each site and<font color="#CCCCCC"> then for kind of</font><font color="#E5E5E5"> how many</font>

500
00:18:12,790 --> 00:18:17,020
people<font color="#CCCCCC"> were doing what was a botanist</font>

501
00:18:14,230 --> 00:18:19,180
it's a web traffic<font color="#CCCCCC"> there are a lot of</font>

502
00:18:17,020 --> 00:18:20,530
threat Intel companies that do this<font color="#CCCCCC"> now</font>

503
00:18:19,180 --> 00:18:23,050
<font color="#E5E5E5">if you see a lot of people</font><font color="#CCCCCC"> out there</font>

504
00:18:20,530 --> 00:18:24,399
<font color="#E5E5E5">that offer</font><font color="#CCCCCC"> dark net scans and monitoring</font>

505
00:18:23,050 --> 00:18:25,870
<font color="#E5E5E5">a lot of times they're actually sitting</font>

506
00:18:24,400 --> 00:18:28,180
<font color="#E5E5E5">on this distributed hash table</font>

507
00:18:25,870 --> 00:18:29,709
collecting<font color="#E5E5E5"> these onions and as soon as</font>

508
00:18:28,180 --> 00:18:30,730
<font color="#E5E5E5">they see one register or one get</font>

509
00:18:29,710 --> 00:18:32,350
requested

510
00:18:30,730 --> 00:18:34,630
they'll go ahead<font color="#CCCCCC"> and start scanning that</font>

511
00:18:32,350 --> 00:18:37,899
that hidden service and looking<font color="#E5E5E5"> for</font>

512
00:18:34,630 --> 00:18:39,550
<font color="#E5E5E5">information on</font><font color="#CCCCCC"> that hidden service there</font>

513
00:18:37,900 --> 00:18:41,260
is<font color="#CCCCCC"> a change that just came</font><font color="#E5E5E5"> out a few</font>

514
00:18:39,550 --> 00:18:42,040
<font color="#E5E5E5">months back to the tor hidden services</font>

515
00:18:41,260 --> 00:18:43,750
they're calling the

516
00:18:42,040 --> 00:18:46,149
next<font color="#E5E5E5"> generation hidden services and</font>

517
00:18:43,750 --> 00:18:48,370
again not being<font color="#E5E5E5"> a</font><font color="#CCCCCC"> cryptographer I can't</font>

518
00:18:46,150 --> 00:18:50,320
tell you the magic sauce here but a key

519
00:18:48,370 --> 00:18:53,080
is used that's derived from<font color="#E5E5E5"> the actual</font>

520
00:18:50,320 --> 00:18:55,000
<font color="#E5E5E5">public key so</font><font color="#CCCCCC"> now in the future this is</font>

521
00:18:53,080 --> 00:18:56,620
<font color="#E5E5E5">just</font><font color="#CCCCCC"> starting</font><font color="#E5E5E5"> to roll out you will no</font>

522
00:18:55,000 --> 00:18:58,270
<font color="#CCCCCC">longer be able</font><font color="#E5E5E5"> to sit on the distributed</font>

523
00:18:56,620 --> 00:19:00,729
hash table<font color="#E5E5E5"> and get the direct</font><font color="#CCCCCC"> hidden</font>

524
00:18:58,270 --> 00:19:01,900
service address again can't tell you how

525
00:19:00,730 --> 00:19:04,780
that<font color="#CCCCCC"> works but that is something that's</font>

526
00:19:01,900 --> 00:19:06,520
coming<font color="#E5E5E5"> up however the older version the</font>

527
00:19:04,780 --> 00:19:07,990
older technology will be around for

528
00:19:06,520 --> 00:19:12,010
quite<font color="#E5E5E5"> some time so this will</font><font color="#CCCCCC"> still be a</font>

529
00:19:07,990 --> 00:19:14,080
<font color="#E5E5E5">possibility for for a while</font><font color="#CCCCCC"> I on the</font>

530
00:19:12,010 --> 00:19:15,820
<font color="#CCCCCC">other hand just used the clear net so I</font>

531
00:19:14,080 --> 00:19:17,740
went to<font color="#E5E5E5"> paste bin and got an</font><font color="#CCCCCC"> initial</font>

532
00:19:15,820 --> 00:19:19,840
list of hidden services<font color="#E5E5E5"> I think I may be</font>

533
00:19:17,740 --> 00:19:21,520
walked away with<font color="#CCCCCC"> 4,000 of them</font><font color="#E5E5E5"> and then</font>

534
00:19:19,840 --> 00:19:23,080
I<font color="#E5E5E5"> went through and I build a recursive</font>

535
00:19:21,520 --> 00:19:24,910
scraper<font color="#E5E5E5"> that just hit each</font><font color="#CCCCCC"> one on</font>

536
00:19:23,080 --> 00:19:26,169
<font color="#E5E5E5">web-based port and then scraped any</font>

537
00:19:24,910 --> 00:19:27,850
onions I found so I just<font color="#E5E5E5"> built out a</font>

538
00:19:26,170 --> 00:19:29,500
list and kind<font color="#CCCCCC"> of D dupe that over and</font>

539
00:19:27,850 --> 00:19:32,260
<font color="#E5E5E5">over I think in the end I was left with</font>

540
00:19:29,500 --> 00:19:34,450
maybe<font color="#CCCCCC"> 5,000 6,000 notes for testing not</font>

541
00:19:32,260 --> 00:19:35,980
<font color="#E5E5E5">all of them were</font><font color="#CCCCCC"> online obviously</font><font color="#E5E5E5"> tor</font>

542
00:19:34,450 --> 00:19:40,000
hidden<font color="#E5E5E5"> service is a very</font><font color="#CCCCCC"> volatile they</font>

543
00:19:35,980 --> 00:19:42,190
go down often<font color="#E5E5E5"> there was a guy who spoke</font>

544
00:19:40,000 --> 00:19:45,370
at a<font color="#CCCCCC"> b-sides I forget where I</font><font color="#E5E5E5"> think his</font>

545
00:19:42,190 --> 00:19:47,260
name<font color="#CCCCCC"> was dr. Garrett Owen and he had</font>

546
00:19:45,370 --> 00:19:48,790
they have a really<font color="#CCCCCC"> good talk on this</font>

547
00:19:47,260 --> 00:19:50,890
<font color="#E5E5E5">whole sitting on the descriptive hash</font>

548
00:19:48,790 --> 00:19:55,990
table and looking<font color="#E5E5E5"> at these registrations</font>

549
00:19:50,890 --> 00:19:59,320
and requests<font color="#E5E5E5"> I</font><font color="#CCCCCC"> questioned the ethics and</font>

550
00:19:55,990 --> 00:20:00,850
<font color="#E5E5E5">the legalities of doing so but they</font>

551
00:19:59,320 --> 00:20:01,990
don't seem<font color="#CCCCCC"> to</font><font color="#E5E5E5"> have an issue</font><font color="#CCCCCC"> with it they</font>

552
00:20:00,850 --> 00:20:03,760
did<font color="#E5E5E5"> it and they have some really cool</font>

553
00:20:01,990 --> 00:20:05,710
<font color="#E5E5E5">data I definitely recommend</font><font color="#CCCCCC"> watching the</font>

554
00:20:03,760 --> 00:20:07,360
talk<font color="#CCCCCC"> they go</font><font color="#E5E5E5"> through and</font><font color="#CCCCCC"> they</font><font color="#E5E5E5"> talk</font><font color="#CCCCCC"> about</font>

555
00:20:05,710 --> 00:20:09,220
a<font color="#CCCCCC"> variety of</font><font color="#E5E5E5"> things</font><font color="#CCCCCC"> but one of</font><font color="#E5E5E5"> the more</font>

556
00:20:07,360 --> 00:20:10,449
interesting<font color="#CCCCCC"> things for me was</font><font color="#E5E5E5"> there</font>

557
00:20:09,220 --> 00:20:11,830
<font color="#CCCCCC">they're sitting on</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> distribute the</font>

558
00:20:10,450 --> 00:20:13,240
<font color="#E5E5E5">hash table</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> looking at these onions</font>

559
00:20:11,830 --> 00:20:14,560
and<font color="#E5E5E5"> then they produced a set</font><font color="#CCCCCC"> of</font>

560
00:20:13,240 --> 00:20:16,960
analytics<font color="#CCCCCC"> I believe you</font><font color="#E5E5E5"> can actually</font>

561
00:20:14,560 --> 00:20:18,460
obtain<font color="#E5E5E5"> the data set and go through it as</font>

562
00:20:16,960 --> 00:20:20,290
well but he<font color="#E5E5E5"> was able to give you a good</font>

563
00:20:18,460 --> 00:20:21,550
<font color="#CCCCCC">breakdown of what hidden services are</font>

564
00:20:20,290 --> 00:20:27,370
out<font color="#E5E5E5"> there and what</font><font color="#CCCCCC"> content</font><font color="#E5E5E5"> they're</font>

565
00:20:21,550 --> 00:20:29,200
serving up<font color="#CCCCCC"> alright so</font><font color="#E5E5E5"> getting into the</font>

566
00:20:27,370 --> 00:20:31,510
<font color="#E5E5E5">actual</font><font color="#CCCCCC"> common misconfigurations that</font>

567
00:20:29,200 --> 00:20:33,340
we're going<font color="#E5E5E5"> to look at</font><font color="#CCCCCC"> it's really easy</font>

568
00:20:31,510 --> 00:20:34,780
<font color="#CCCCCC">to expose this stuff if</font><font color="#E5E5E5"> you haven't</font>

569
00:20:33,340 --> 00:20:36,040
properly<font color="#E5E5E5"> configured your service or if</font>

570
00:20:34,780 --> 00:20:37,600
you<font color="#E5E5E5"> don't really know what you're doing</font>

571
00:20:36,040 --> 00:20:39,040
<font color="#CCCCCC">a lot of times you follow these guides</font>

572
00:20:37,600 --> 00:20:41,560
<font color="#E5E5E5">that you're following</font><font color="#CCCCCC"> for clear net</font>

573
00:20:39,040 --> 00:20:43,149
<font color="#CCCCCC">sites and if you're</font><font color="#E5E5E5"> not familiar with</font>

574
00:20:41,560 --> 00:20:45,340
<font color="#E5E5E5">the underlying technology it's really</font>

575
00:20:43,150 --> 00:20:47,020
easy to<font color="#E5E5E5"> expose</font><font color="#CCCCCC"> the anonymizing</font>

576
00:20:45,340 --> 00:20:49,300
information there are a lot<font color="#CCCCCC"> of tools</font>

577
00:20:47,020 --> 00:20:50,610
that<font color="#E5E5E5"> exist</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> doing these things when I</font>

578
00:20:49,300 --> 00:20:52,110
<font color="#CCCCCC">first started I</font>

579
00:20:50,610 --> 00:20:54,510
just started<font color="#CCCCCC"> doing</font><font color="#E5E5E5"> this because of a</font>

580
00:20:52,110 --> 00:20:55,678
<font color="#E5E5E5">very specific D anonymization vector and</font>

581
00:20:54,510 --> 00:20:57,240
then I started<font color="#E5E5E5"> thinking about other</font><font color="#CCCCCC"> ones</font>

582
00:20:55,679 --> 00:20:58,140
and<font color="#E5E5E5"> by the time I was done I</font><font color="#CCCCCC"> realized</font>

583
00:20:57,240 --> 00:21:00,179
that somebody<font color="#E5E5E5"> had</font><font color="#CCCCCC"> already built this</font>

584
00:20:58,140 --> 00:21:02,399
tool<font color="#E5E5E5"> of course</font><font color="#CCCCCC"> so there's a tool there</font>

585
00:21:00,179 --> 00:21:03,960
called onion<font color="#E5E5E5"> scan which does a lot of</font>

586
00:21:02,399 --> 00:21:05,129
what I'm talking<font color="#CCCCCC"> about today I</font><font color="#E5E5E5"> think</font>

587
00:21:03,960 --> 00:21:06,960
there's<font color="#E5E5E5"> only one technique I'm going to</font>

588
00:21:05,130 --> 00:21:09,870
cover<font color="#E5E5E5"> that I believe no one else is</font>

589
00:21:06,960 --> 00:21:11,700
<font color="#E5E5E5">doing currently I may be</font><font color="#CCCCCC"> mistaken</font><font color="#E5E5E5"> but</font>

590
00:21:09,870 --> 00:21:13,320
definitely check<font color="#CCCCCC"> out onions again I have</font>

591
00:21:11,700 --> 00:21:14,610
code<font color="#CCCCCC"> that I wrote</font><font color="#E5E5E5"> it's a horrible shitty</font>

592
00:21:13,320 --> 00:21:15,720
bash script<font color="#E5E5E5"> so I'm not even</font><font color="#CCCCCC"> going to</font>

593
00:21:14,610 --> 00:21:16,760
show<font color="#E5E5E5"> you the code and I probably won't</font>

594
00:21:15,720 --> 00:21:19,169
release<font color="#E5E5E5"> it because it's garbage</font>

595
00:21:16,760 --> 00:21:23,190
<font color="#CCCCCC">definitely look at onion skin</font><font color="#E5E5E5"> you don't</font>

596
00:21:19,169 --> 00:21:24,419
want my<font color="#E5E5E5"> coat</font><font color="#CCCCCC"> alright so the following</font>

597
00:21:23,190 --> 00:21:26,250
examples are only some<font color="#CCCCCC"> of the ways</font>

598
00:21:24,419 --> 00:21:27,360
<font color="#E5E5E5">there's quite a few more ways</font><font color="#CCCCCC"> obviously</font>

599
00:21:26,250 --> 00:21:28,590
I couldn't cover them all<font color="#CCCCCC"> but I wanted</font>

600
00:21:27,360 --> 00:21:31,799
<font color="#E5E5E5">to cover</font><font color="#CCCCCC"> some of the</font><font color="#E5E5E5"> more fruitful</font><font color="#CCCCCC"> and</font>

601
00:21:28,590 --> 00:21:34,379
easy ways<font color="#CCCCCC"> to look</font><font color="#E5E5E5"> at this stuff so</font><font color="#CCCCCC"> the</font>

602
00:21:31,799 --> 00:21:36,600
first one and the<font color="#CCCCCC"> most well known is</font><font color="#E5E5E5"> the</font>

603
00:21:34,380 --> 00:21:38,190
Apache server<font color="#E5E5E5"> status Apache server</font>

604
00:21:36,600 --> 00:21:41,519
status<font color="#E5E5E5"> is a module</font><font color="#CCCCCC"> that can</font><font color="#E5E5E5"> be enabled</font>

605
00:21:38,190 --> 00:21:44,399
<font color="#E5E5E5">on Apache I'm not sure who here does</font>

606
00:21:41,519 --> 00:21:45,720
<font color="#CCCCCC">Pachi administration but the idea</font><font color="#E5E5E5"> is as</font>

607
00:21:44,399 --> 00:21:47,219
an administrator you<font color="#CCCCCC"> can</font><font color="#E5E5E5"> actually go to</font>

608
00:21:45,720 --> 00:21:48,600
<font color="#E5E5E5">slash server status and you can see</font>

609
00:21:47,220 --> 00:21:50,220
stats about hits that<font color="#E5E5E5"> have come in to</font>

610
00:21:48,600 --> 00:21:51,870
<font color="#CCCCCC">your site for requests you could see</font>

611
00:21:50,220 --> 00:21:53,789
system load you<font color="#CCCCCC"> can see a variety of</font>

612
00:21:51,870 --> 00:21:55,799
things<font color="#E5E5E5"> normally this module isn't</font>

613
00:21:53,789 --> 00:21:58,110
<font color="#CCCCCC">enabled generally</font><font color="#E5E5E5"> this</font><font color="#CCCCCC"> is something that</font>

614
00:21:55,799 --> 00:22:00,330
<font color="#CCCCCC">needs</font><font color="#E5E5E5"> to be enabled</font><font color="#CCCCCC"> and when you do</font>

615
00:21:58,110 --> 00:22:03,120
enable<font color="#E5E5E5"> this it's usually good practice</font>

616
00:22:00,330 --> 00:22:05,399
to<font color="#CCCCCC"> only expose this module to</font><font color="#E5E5E5"> localhost</font>

617
00:22:03,120 --> 00:22:07,500
<font color="#CCCCCC">so most of</font><font color="#E5E5E5"> the time you'll see if people</font>

618
00:22:05,399 --> 00:22:09,000
<font color="#CCCCCC">do enable the server status module</font><font color="#E5E5E5"> the</font>

619
00:22:07,500 --> 00:22:10,139
ability to<font color="#E5E5E5"> go into the URI and you slash</font>

620
00:22:09,000 --> 00:22:12,179
server status<font color="#E5E5E5"> and view that information</font>

621
00:22:10,139 --> 00:22:13,129
<font color="#CCCCCC">they'll only do it on localhost and the</font>

622
00:22:12,179 --> 00:22:14,880
reason is if you're an<font color="#CCCCCC"> administrator</font>

623
00:22:13,130 --> 00:22:16,350
<font color="#CCCCCC">theoretically the only person who should</font>

624
00:22:14,880 --> 00:22:17,760
be viewing that from localhost it's you

625
00:22:16,350 --> 00:22:20,039
<font color="#E5E5E5">so you've kind of some kind of a</font>

626
00:22:17,760 --> 00:22:21,899
protection<font color="#E5E5E5"> mechanism there is to hide it</font>

627
00:22:20,039 --> 00:22:25,169
in the<font color="#CCCCCC"> localhost binding and not expose</font>

628
00:22:21,899 --> 00:22:28,110
it to the<font color="#E5E5E5"> Internet there's an issue with</font>

629
00:22:25,169 --> 00:22:30,659
<font color="#CCCCCC">that</font><font color="#E5E5E5"> and the issue is when you configure</font>

630
00:22:28,110 --> 00:22:32,699
<font color="#CCCCCC">your</font><font color="#E5E5E5"> tour</font><font color="#CCCCCC"> IRC you're you're actually</font>

631
00:22:30,659 --> 00:22:34,559
exposing<font color="#E5E5E5"> localhost bindings generally</font>

632
00:22:32,700 --> 00:22:36,059
<font color="#E5E5E5">speaking so it would be silly to run a</font>

633
00:22:34,559 --> 00:22:37,320
<font color="#E5E5E5">tor service and expose</font><font color="#CCCCCC"> that to the</font>

634
00:22:36,059 --> 00:22:39,210
<font color="#CCCCCC">internet</font><font color="#E5E5E5"> so you only bind it to</font>

635
00:22:37,320 --> 00:22:40,710
<font color="#CCCCCC">localhost</font><font color="#E5E5E5"> and then</font><font color="#CCCCCC"> when tour socks proxy</font>

636
00:22:39,210 --> 00:22:41,730
is running and you<font color="#E5E5E5"> go in your tour RC</font>

637
00:22:40,710 --> 00:22:43,470
<font color="#E5E5E5">and you say I want to expose this</font>

638
00:22:41,730 --> 00:22:45,090
service<font color="#E5E5E5"> you expose the local host</font>

639
00:22:43,470 --> 00:22:48,630
<font color="#E5E5E5">service you don't expose one exposed to</font>

640
00:22:45,090 --> 00:22:52,470
the<font color="#CCCCCC"> Internet that</font><font color="#E5E5E5"> would be silly so</font>

641
00:22:48,630 --> 00:22:55,289
looking<font color="#E5E5E5"> at this configuration here</font>

642
00:22:52,470 --> 00:22:56,580
the second echo hidden service<font color="#CCCCCC"> 80</font><font color="#E5E5E5"> that's</font>

643
00:22:55,289 --> 00:22:58,110
<font color="#E5E5E5">basically all I'm adding there and I'm</font>

644
00:22:56,580 --> 00:22:59,789
<font color="#CCCCCC">just</font><font color="#E5E5E5"> saying expose one two</font><font color="#CCCCCC"> seven zero</font>

645
00:22:58,110 --> 00:23:02,219
<font color="#CCCCCC">zero one four eighty support</font>

646
00:22:59,789 --> 00:23:03,929
<font color="#E5E5E5">Tork</font><font color="#CCCCCC"> so again it's my</font><font color="#E5E5E5"> localhost binding</font>

647
00:23:02,220 --> 00:23:05,519
<font color="#E5E5E5">so getting back</font><font color="#CCCCCC"> to the server Status</font>

648
00:23:03,929 --> 00:23:07,619
page<font color="#CCCCCC"> the issue with that is when you</font>

649
00:23:05,519 --> 00:23:09,840
expose that<font color="#CCCCCC"> to localhost you're actually</font>

650
00:23:07,619 --> 00:23:12,090
exposing<font color="#E5E5E5"> that to your tor binding so</font>

651
00:23:09,840 --> 00:23:14,340
that's all well and<font color="#CCCCCC"> good</font><font color="#E5E5E5"> but it's not</font>

652
00:23:12,090 --> 00:23:16,590
<font color="#E5E5E5">that common unfortunately most people</font>

653
00:23:14,340 --> 00:23:18,478
are using a bun tube<font color="#E5E5E5"> or</font><font color="#CCCCCC"> debian</font><font color="#E5E5E5"> and most</font>

654
00:23:16,590 --> 00:23:20,249
people are using<font color="#E5E5E5"> Apache</font><font color="#CCCCCC"> the issue here</font>

655
00:23:18,479 --> 00:23:22,529
<font color="#E5E5E5">is</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> the default</font><font color="#CCCCCC"> package that's</font>

656
00:23:20,249 --> 00:23:24,570
maintained by Ubuntu<font color="#E5E5E5"> enables server</font>

657
00:23:22,529 --> 00:23:26,220
status<font color="#E5E5E5"> by default and only puts it on</font>

658
00:23:24,570 --> 00:23:28,109
localhost so they try<font color="#E5E5E5"> to do your favor</font>

659
00:23:26,220 --> 00:23:29,999
and<font color="#E5E5E5"> only enable it on the local</font><font color="#CCCCCC"> host</font><font color="#E5E5E5"> but</font>

660
00:23:28,109 --> 00:23:31,590
by doing<font color="#CCCCCC"> so</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> default package that you</font>

661
00:23:29,999 --> 00:23:33,239
find<font color="#E5E5E5"> for a bun - one of the most</font>

662
00:23:31,590 --> 00:23:35,879
<font color="#E5E5E5">commonly used VPS servers that people</font>

663
00:23:33,239 --> 00:23:37,080
are going<font color="#CCCCCC"> to</font><font color="#E5E5E5"> utilize and Apache one of</font>

664
00:23:35,879 --> 00:23:38,369
the most common web servers you're

665
00:23:37,080 --> 00:23:39,869
instantly shooting yourself in the<font color="#CCCCCC"> foot</font>

666
00:23:38,369 --> 00:23:42,478
because<font color="#E5E5E5"> you've exposed this server</font>

667
00:23:39,869 --> 00:23:43,769
<font color="#CCCCCC">Status page</font><font color="#E5E5E5"> to everybody on tour and</font>

668
00:23:42,479 --> 00:23:45,570
we'll<font color="#E5E5E5"> get into exactly</font><font color="#CCCCCC"> what</font><font color="#E5E5E5"> that means</font>

669
00:23:43,769 --> 00:23:48,779
<font color="#CCCCCC">aside from</font><font color="#E5E5E5"> just the</font><font color="#CCCCCC"> D anonymization</font>

670
00:23:45,570 --> 00:23:50,970
<font color="#CCCCCC">factoring</font><font color="#E5E5E5"> so this is an</font><font color="#CCCCCC"> example page all</font>

671
00:23:48,779 --> 00:23:52,320
<font color="#E5E5E5">of the hidden services here are real I</font>

672
00:23:50,970 --> 00:23:54,239
don't know how legit<font color="#E5E5E5"> these hidden</font>

673
00:23:52,320 --> 00:23:56,220
services are<font color="#E5E5E5"> but there are all ones that</font>

674
00:23:54,239 --> 00:23:58,139
I found<font color="#E5E5E5"> one scanning I did try</font><font color="#CCCCCC"> to make</font>

675
00:23:56,220 --> 00:24:01,379
sure<font color="#CCCCCC"> that most</font><font color="#E5E5E5"> of these are</font><font color="#CCCCCC"> just carding</font>

676
00:23:58,139 --> 00:24:04,830
or forms nothing horrendous that<font color="#E5E5E5"> can be</font>

677
00:24:01,379 --> 00:24:05,998
out there<font color="#CCCCCC"> on tour so this site here it</font>

678
00:24:04,830 --> 00:24:07,349
looks<font color="#E5E5E5"> like there was actually I found</font>

679
00:24:05,999 --> 00:24:08,820
this out through the hidden<font color="#E5E5E5"> cert of the</font>

680
00:24:07,349 --> 00:24:11,519
server<font color="#E5E5E5"> Status page this</font><font color="#CCCCCC"> guy's</font><font color="#E5E5E5"> running</font>

681
00:24:08,820 --> 00:24:13,439
two or three different<font color="#E5E5E5"> services on</font>

682
00:24:11,519 --> 00:24:15,450
<font color="#E5E5E5">different onions on the</font><font color="#CCCCCC"> left he's got</font>

683
00:24:13,440 --> 00:24:18,210
this thing<font color="#CCCCCC"> called</font><font color="#E5E5E5"> cool name okay</font><font color="#CCCCCC"> where</font>

684
00:24:15,450 --> 00:24:19,559
he's actually brute-forcing the hidden

685
00:24:18,210 --> 00:24:22,019
service names you<font color="#E5E5E5"> basically generate a</font>

686
00:24:19,559 --> 00:24:23,849
bunch<font color="#E5E5E5"> of keys and we'll take a look and</font>

687
00:24:22,019 --> 00:24:26,159
<font color="#E5E5E5">say oh I want a key there's a thing that</font>

688
00:24:23,849 --> 00:24:27,539
<font color="#E5E5E5">thing is called vanity onion</font><font color="#CCCCCC"> will you go</font>

689
00:24:26,159 --> 00:24:28,889
<font color="#E5E5E5">in and you say I want a hidden service</font>

690
00:24:27,539 --> 00:24:29,999
name that has this in it and you can

691
00:24:28,889 --> 00:24:32,158
only<font color="#E5E5E5"> usually do up to about eight</font>

692
00:24:29,999 --> 00:24:33,389
characters depends upon how many depends

693
00:24:32,159 --> 00:24:35,099
upon your<font color="#E5E5E5"> resources but it will go ahead</font>

694
00:24:33,389 --> 00:24:36,689
<font color="#E5E5E5">and generate a crap-ton of hashes</font><font color="#CCCCCC"> and</font>

695
00:24:35,099 --> 00:24:38,009
look for one that<font color="#CCCCCC"> matches and then you</font>

696
00:24:36,690 --> 00:24:39,570
get that key pair to use<font color="#E5E5E5"> for your hidden</font>

697
00:24:38,009 --> 00:24:41,309
service so you<font color="#CCCCCC"> can basically brute force</font>

698
00:24:39,570 --> 00:24:44,580
these vanity domains so he's selling

699
00:24:41,309 --> 00:24:46,769
<font color="#CCCCCC">these vanity domains on one page</font><font color="#E5E5E5"> on the</font>

700
00:24:44,580 --> 00:24:47,609
other page there's a paste bin<font color="#E5E5E5"> with who</font>

701
00:24:46,769 --> 00:24:50,029
knows<font color="#E5E5E5"> what</font>

702
00:24:47,609 --> 00:24:51,629
<font color="#E5E5E5">that is a that is another service</font>

703
00:24:50,029 --> 00:24:53,070
actually this one on the right<font color="#CCCCCC"> side</font>

704
00:24:51,629 --> 00:24:55,168
<font color="#CCCCCC">there's an ad for</font><font color="#E5E5E5"> the page</font><font color="#CCCCCC"> spoon the one</font>

705
00:24:53,070 --> 00:24:56,330
in<font color="#E5E5E5"> there a I don't</font><font color="#CCCCCC"> know</font><font color="#E5E5E5"> what's going on</font>

706
00:24:55,169 --> 00:24:59,039
<font color="#E5E5E5">there</font>

707
00:24:56,330 --> 00:25:00,269
so this<font color="#E5E5E5"> is the server</font><font color="#CCCCCC"> Status page</font><font color="#E5E5E5"> for</font>

708
00:24:59,039 --> 00:25:02,759
<font color="#CCCCCC">that hidden service the</font><font color="#E5E5E5"> student service</font>

709
00:25:00,269 --> 00:25:04,440
is up currently<font color="#E5E5E5"> if you go to slash</font>

710
00:25:02,759 --> 00:25:07,919
server status<font color="#E5E5E5"> as you can see in the URI</font>

711
00:25:04,440 --> 00:25:09,419
<font color="#E5E5E5">barely</font><font color="#CCCCCC"> you can see that I'm able</font><font color="#E5E5E5"> to view</font>

712
00:25:07,919 --> 00:25:11,180
<font color="#E5E5E5">all</font><font color="#CCCCCC"> the requests</font><font color="#E5E5E5"> that are being made to</font>

713
00:25:09,419 --> 00:25:12,830
<font color="#CCCCCC">this server</font><font color="#E5E5E5"> both on the public</font>

714
00:25:11,180 --> 00:25:14,060
the clear net address and the internal

715
00:25:12,830 --> 00:25:17,120
address because<font color="#E5E5E5"> it's the same</font><font color="#CCCCCC"> Apache</font>

716
00:25:14,060 --> 00:25:19,280
instance<font color="#E5E5E5"> so a few things</font><font color="#CCCCCC"> here</font><font color="#E5E5E5"> one is</font>

717
00:25:17,120 --> 00:25:22,189
instantly<font color="#E5E5E5"> you can see there's a request</font>

718
00:25:19,280 --> 00:25:23,930
<font color="#E5E5E5">made</font><font color="#CCCCCC"> to this fqdn</font><font color="#E5E5E5"> its actual external</font>

719
00:25:22,190 --> 00:25:25,640
domain<font color="#CCCCCC"> that's going to be the D</font>

720
00:25:23,930 --> 00:25:27,170
anonymization factor there but it's also

721
00:25:25,640 --> 00:25:29,240
important to<font color="#E5E5E5"> keep in</font><font color="#CCCCCC"> mind that</font><font color="#E5E5E5"> I'm</font>

722
00:25:27,170 --> 00:25:31,010
seeing the full get<font color="#E5E5E5"> request here and for</font>

723
00:25:29,240 --> 00:25:32,330
a lot<font color="#CCCCCC"> of people who do any kind of</font><font color="#E5E5E5"> web</font>

724
00:25:31,010 --> 00:25:33,530
dev you know it's important<font color="#E5E5E5"> to put any</font>

725
00:25:32,330 --> 00:25:34,699
<font color="#CCCCCC">kind</font><font color="#E5E5E5"> of sensitive data in your post</font>

726
00:25:33,530 --> 00:25:36,350
<font color="#CCCCCC">request because</font><font color="#E5E5E5"> you don't want to be</font>

727
00:25:34,700 --> 00:25:37,670
visible<font color="#CCCCCC"> well you do get a lot</font><font color="#E5E5E5"> of that</font>

728
00:25:36,350 --> 00:25:39,110
<font color="#E5E5E5">information</font><font color="#CCCCCC"> that gets sent in your</font><font color="#E5E5E5"> get</font>

729
00:25:37,670 --> 00:25:40,370
<font color="#CCCCCC">request</font><font color="#E5E5E5"> and you also get session</font>

730
00:25:39,110 --> 00:25:42,560
information<font color="#CCCCCC"> so sometimes you'll see</font>

731
00:25:40,370 --> 00:25:43,850
session tokens<font color="#CCCCCC"> or IDs</font><font color="#E5E5E5"> and you can</font>

732
00:25:42,560 --> 00:25:45,470
actually go ahead<font color="#E5E5E5"> and</font><font color="#CCCCCC"> just rip these out</font>

733
00:25:43,850 --> 00:25:46,669
copy them into<font color="#E5E5E5"> your browser and hijack</font>

734
00:25:45,470 --> 00:25:50,600
someone's<font color="#CCCCCC"> session just because you're</font>

735
00:25:46,670 --> 00:25:52,660
able<font color="#E5E5E5"> to see that data in the log so in</font>

736
00:25:50,600 --> 00:25:55,340
this case looking at the hidden service

737
00:25:52,660 --> 00:25:56,270
sorry looking at the fqdn<font color="#E5E5E5"> we can go</font>

738
00:25:55,340 --> 00:25:57,740
<font color="#CCCCCC">ahead</font><font color="#E5E5E5"> and just make sure that's the</font>

739
00:25:56,270 --> 00:26:00,830
legit name<font color="#E5E5E5"> sometimes people</font><font color="#CCCCCC"> just make up</font>

740
00:25:57,740 --> 00:26:03,470
names<font color="#E5E5E5"> like not found</font><font color="#CCCCCC"> calm or you know</font>

741
00:26:00,830 --> 00:26:05,419
<font color="#E5E5E5">it's not here org</font><font color="#CCCCCC"> but</font><font color="#E5E5E5"> in this case this</font>

742
00:26:03,470 --> 00:26:08,960
one does indeed register or resolve to

743
00:26:05,420 --> 00:26:10,790
an actual to an actual IP address<font color="#E5E5E5"> so to</font>

744
00:26:08,960 --> 00:26:12,770
<font color="#E5E5E5">recap all we did was</font><font color="#CCCCCC"> just</font><font color="#E5E5E5"> we found a</font>

745
00:26:10,790 --> 00:26:14,420
<font color="#CCCCCC">hidden service we just did slash server</font>

746
00:26:12,770 --> 00:26:16,550
status<font color="#E5E5E5"> we looked at there was</font><font color="#CCCCCC"> a request</font>

747
00:26:14,420 --> 00:26:18,170
for<font color="#CCCCCC"> fqt</font><font color="#E5E5E5"> ends made sure that fqdn was</font>

748
00:26:16,550 --> 00:26:23,270
legit and now<font color="#CCCCCC"> we've fully d anonymize</font>

749
00:26:18,170 --> 00:26:26,660
that<font color="#E5E5E5"> that hidden service all right so</font>

750
00:26:23,270 --> 00:26:28,940
the<font color="#CCCCCC"> next vector is missing host headers</font>

751
00:26:26,660 --> 00:26:33,190
<font color="#E5E5E5">this vector</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> don't think anyone else is</font>

752
00:26:28,940 --> 00:26:35,090
<font color="#CCCCCC">doing currently</font><font color="#E5E5E5"> found this on accident</font>

753
00:26:33,190 --> 00:26:36,620
onion<font color="#CCCCCC"> scan is doing something</font><font color="#E5E5E5"> similar</font>

754
00:26:35,090 --> 00:26:37,790
<font color="#E5E5E5">which I'll talk about at the</font><font color="#CCCCCC"> end here</font>

755
00:26:36,620 --> 00:26:41,840
but<font color="#E5E5E5"> I don't</font><font color="#CCCCCC"> believe they're doing this</font>

756
00:26:37,790 --> 00:26:43,610
yet<font color="#CCCCCC"> so there's an issue where if you</font>

757
00:26:41,840 --> 00:26:45,110
host a website<font color="#E5E5E5"> on the clear net and you</font>

758
00:26:43,610 --> 00:26:46,780
host a<font color="#E5E5E5"> website on tour on the same</font>

759
00:26:45,110 --> 00:26:49,370
<font color="#CCCCCC">apache installation like we just saw</font>

760
00:26:46,780 --> 00:26:53,330
you're running the same configurations

761
00:26:49,370 --> 00:26:55,550
<font color="#E5E5E5">from that apache instance when an apache</font>

762
00:26:53,330 --> 00:26:58,280
server is configured for<font color="#E5E5E5"> multiple</font><font color="#CCCCCC"> v</font>

763
00:26:55,550 --> 00:27:01,129
hosts<font color="#E5E5E5"> it's all done in a set of</font>

764
00:26:58,280 --> 00:27:03,590
configuration<font color="#CCCCCC"> files when</font><font color="#E5E5E5"> apache gets a</font>

765
00:27:01,130 --> 00:27:06,020
get request for<font color="#CCCCCC"> AV host</font><font color="#E5E5E5"> and there's</font>

766
00:27:03,590 --> 00:27:07,639
actually no host header in the request

767
00:27:06,020 --> 00:27:09,860
<font color="#E5E5E5">it will default to a default</font>

768
00:27:07,640 --> 00:27:11,420
configuration and that's that's the

769
00:27:09,860 --> 00:27:12,269
attack vector<font color="#CCCCCC"> here and I'll dive into</font>

770
00:27:11,420 --> 00:27:14,580
<font color="#E5E5E5">that a little bit</font>

771
00:27:12,269 --> 00:27:15,779
<font color="#CCCCCC">no it sounds kind</font><font color="#E5E5E5"> of cryptic</font><font color="#CCCCCC"> so here's</font>

772
00:27:14,580 --> 00:27:18,509
an example<font color="#CCCCCC"> configuration</font>

773
00:27:15,779 --> 00:27:20,700
I spun up a I spun up an<font color="#E5E5E5"> Apache instance</font>

774
00:27:18,509 --> 00:27:22,499
on<font color="#CCCCCC"> my VPS</font><font color="#E5E5E5"> and I created two sites</font>

775
00:27:20,700 --> 00:27:24,539
<font color="#E5E5E5">someone on the clear net and one on my</font>

776
00:27:22,499 --> 00:27:26,279
hidden service<font color="#E5E5E5"> as you can see that both</font>

777
00:27:24,539 --> 00:27:28,349
bound<font color="#E5E5E5"> to port 80 each one of them has a</font>

778
00:27:26,279 --> 00:27:30,359
respectful server name<font color="#CCCCCC"> the server name</font>

779
00:27:28,349 --> 00:27:32,820
should be<font color="#E5E5E5"> what directs the incoming</font>

780
00:27:30,359 --> 00:27:34,889
connection to either<font color="#CCCCCC"> bard</font><font color="#E5E5E5"> a bit of</font><font color="#CCCCCC"> a w</font>

781
00:27:32,820 --> 00:27:37,708
HTML or<font color="#E5E5E5"> hidden service and have</font>

782
00:27:34,889 --> 00:27:40,019
different<font color="#CCCCCC"> content in each folder</font><font color="#E5E5E5"> so I've</font>

783
00:27:37,709 --> 00:27:42,719
got these<font color="#CCCCCC"> two vhosts</font><font color="#E5E5E5"> configured in this</font>

784
00:27:40,019 --> 00:27:44,489
in this<font color="#E5E5E5"> single configuration file and it</font>

785
00:27:42,719 --> 00:27:46,289
works<font color="#CCCCCC"> so if you go to</font><font color="#E5E5E5"> my clear net site</font>

786
00:27:44,489 --> 00:27:47,940
you get<font color="#E5E5E5"> this cool</font><font color="#CCCCCC"> picture</font><font color="#E5E5E5"> this cat with</font>

787
00:27:46,289 --> 00:27:49,408
two different<font color="#CCCCCC"> eyes if you go to the</font>

788
00:27:47,940 --> 00:27:53,519
scary hidden service that you get this

789
00:27:49,409 --> 00:27:55,079
awesome hacker<font color="#CCCCCC"> Kitty</font><font color="#E5E5E5"> so from the Apache</font>

790
00:27:53,519 --> 00:27:57,629
<font color="#CCCCCC">Doc's there's an interesting bit that</font>

791
00:27:55,079 --> 00:27:58,979
says and this is ripped out<font color="#CCCCCC"> of where</font>

792
00:27:57,629 --> 00:28:00,359
they have<font color="#CCCCCC"> a demo configuration so it's</font>

793
00:27:58,979 --> 00:28:01,739
hard to<font color="#E5E5E5"> see but pretend they're talking</font>

794
00:28:00,359 --> 00:28:03,749
<font color="#CCCCCC">about the configuration I just showed</font>

795
00:28:01,739 --> 00:28:05,700
you<font color="#CCCCCC"> due to the fact that the virtual</font>

796
00:28:03,749 --> 00:28:07,379
<font color="#E5E5E5">host with the server</font><font color="#CCCCCC"> name example.com is</font>

797
00:28:05,700 --> 00:28:08,729
the first in the configuration file keep

798
00:28:07,379 --> 00:28:10,228
in mind my clear that was the first in

799
00:28:08,729 --> 00:28:11,609
<font color="#E5E5E5">configuration file</font><font color="#CCCCCC"> and has the highest</font>

800
00:28:10,229 --> 00:28:13,889
<font color="#CCCCCC">priority and could be</font><font color="#E5E5E5"> seen as the</font>

801
00:28:11,609 --> 00:28:15,269
<font color="#E5E5E5">default or primary server that means if</font>

802
00:28:13,889 --> 00:28:17,158
a request<font color="#E5E5E5"> is received that does not</font>

803
00:28:15,269 --> 00:28:18,690
match one of<font color="#E5E5E5"> the specified specified</font>

804
00:28:17,159 --> 00:28:21,989
server<font color="#E5E5E5"> name directives it will default</font>

805
00:28:18,690 --> 00:28:24,239
<font color="#CCCCCC">to that</font><font color="#E5E5E5"> first entry so if you make a</font>

806
00:28:21,989 --> 00:28:26,519
<font color="#E5E5E5">request and</font><font color="#CCCCCC"> you don't specify a host</font>

807
00:28:24,239 --> 00:28:31,679
header<font color="#E5E5E5"> it will default to the first</font>

808
00:28:26,519 --> 00:28:33,149
entry<font color="#CCCCCC"> in the</font><font color="#E5E5E5"> configuration file</font><font color="#CCCCCC"> so I'm</font>

809
00:28:31,679 --> 00:28:35,429
gonna go<font color="#E5E5E5"> through why this is bad and</font>

810
00:28:33,149 --> 00:28:38,369
<font color="#E5E5E5">I'll do it</font><font color="#CCCCCC"> step-by-step</font><font color="#E5E5E5"> and this in this</font>

811
00:28:35,429 --> 00:28:42,299
<font color="#E5E5E5">first command</font><font color="#CCCCCC"> I'm doing a curl to the</font>

812
00:28:38,369 --> 00:28:44,339
hidden service and I'm<font color="#CCCCCC"> specifying a HTTP</font>

813
00:28:42,299 --> 00:28:45,839
method that<font color="#E5E5E5"> doesn't exist</font><font color="#CCCCCC"> just call it</font>

814
00:28:44,339 --> 00:28:48,958
<font color="#E5E5E5">the garbage as you can see with the dash</font>

815
00:28:45,839 --> 00:28:50,609
X and then next I'm<font color="#E5E5E5"> specifying a host</font>

816
00:28:48,959 --> 00:28:51,989
header of my hidden service<font color="#E5E5E5"> so I'm</font>

817
00:28:50,609 --> 00:28:53,458
making a request<font color="#E5E5E5"> to my hidden service</font>

818
00:28:51,989 --> 00:28:56,669
<font color="#E5E5E5">I'm specifying my host header of the</font>

819
00:28:53,459 --> 00:28:58,079
<font color="#E5E5E5">hidden service but I'm using an HTTP</font>

820
00:28:56,669 --> 00:28:59,219
method that<font color="#E5E5E5"> doesn't exist</font><font color="#CCCCCC"> because I want</font>

821
00:28:58,079 --> 00:29:01,799
it to<font color="#E5E5E5"> error out because I want this</font>

822
00:28:59,219 --> 00:29:03,419
<font color="#CCCCCC">specific response so in Arizona and it</font>

823
00:29:01,799 --> 00:29:06,450
says I don't<font color="#E5E5E5"> know what the hell you're</font>

824
00:29:03,419 --> 00:29:08,879
trying<font color="#E5E5E5"> to say the server located</font><font color="#CCCCCC"> at a</font>

825
00:29:06,450 --> 00:29:09,359
<font color="#E5E5E5">bun</font><font color="#CCCCCC"> - at this hidden service address</font><font color="#E5E5E5"> on</font>

826
00:29:08,879 --> 00:29:11,579
port 80

827
00:29:09,359 --> 00:29:15,299
<font color="#CCCCCC">doesn't know what the hell you want</font>

828
00:29:11,579 --> 00:29:17,099
<font color="#CCCCCC">alright that's fine so now if</font><font color="#E5E5E5"> I make the</font>

829
00:29:15,299 --> 00:29:19,799
same<font color="#E5E5E5"> request to</font><font color="#CCCCCC"> that hidden</font><font color="#E5E5E5"> service</font>

830
00:29:17,099 --> 00:29:21,658
using curl<font color="#E5E5E5"> and using garbage as a method</font>

831
00:29:19,799 --> 00:29:23,639
<font color="#E5E5E5">that doesn't exist but I don't specify a</font>

832
00:29:21,659 --> 00:29:24,899
host header<font color="#E5E5E5"> I leave that blank</font><font color="#CCCCCC"> and I</font>

833
00:29:23,639 --> 00:29:26,459
make the<font color="#E5E5E5"> same request of the hidden</font>

834
00:29:24,899 --> 00:29:28,079
service<font color="#E5E5E5"> what's going to happen as a</font>

835
00:29:26,460 --> 00:29:29,279
hidden<font color="#E5E5E5"> service is going to receive the</font>

836
00:29:28,079 --> 00:29:31,079
<font color="#CCCCCC">request it's going to go</font><font color="#E5E5E5"> to the Apache</font>

837
00:29:29,279 --> 00:29:32,729
server<font color="#E5E5E5"> Apache server is</font><font color="#CCCCCC"> going</font><font color="#E5E5E5"> to say</font>

838
00:29:31,079 --> 00:29:34,320
which V host does this go to and look

839
00:29:32,729 --> 00:29:35,969
for<font color="#E5E5E5"> that host header but the host header</font>

840
00:29:34,320 --> 00:29:38,968
is missing<font color="#CCCCCC"> so it</font><font color="#E5E5E5"> doesn't</font><font color="#CCCCCC"> actually know</font>

841
00:29:35,969 --> 00:29:41,309
where it goes<font color="#CCCCCC"> so</font><font color="#E5E5E5"> per the</font><font color="#CCCCCC"> docs</font><font color="#E5E5E5"> it chooses</font>

842
00:29:38,969 --> 00:29:43,289
<font color="#CCCCCC">the</font><font color="#E5E5E5"> first configuration</font><font color="#CCCCCC"> which means as a</font>

843
00:29:41,309 --> 00:29:44,789
response and<font color="#E5E5E5"> our error message we're</font>

844
00:29:43,289 --> 00:29:46,559
actually going<font color="#CCCCCC"> to see</font><font color="#E5E5E5"> the server name</font>

845
00:29:44,789 --> 00:29:49,079
from<font color="#CCCCCC"> that first configuration</font><font color="#E5E5E5"> so if we</font>

846
00:29:46,559 --> 00:29:51,269
go<font color="#CCCCCC"> back to</font><font color="#E5E5E5"> this you'll see the server</font>

847
00:29:49,079 --> 00:29:52,649
name directive that's that's<font color="#E5E5E5"> that's</font>

848
00:29:51,269 --> 00:29:54,869
<font color="#E5E5E5">configured and you'll see in the</font>

849
00:29:52,649 --> 00:29:56,459
response when I have no host header<font color="#E5E5E5"> that</font>

850
00:29:54,869 --> 00:29:58,709
<font color="#E5E5E5">I'm making my request to the hidden</font>

851
00:29:56,460 --> 00:30:00,119
service but no host header<font color="#E5E5E5"> and I'm</font>

852
00:29:58,710 --> 00:30:04,909
getting<font color="#E5E5E5"> back</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> configuration for the</font>

853
00:30:00,119 --> 00:30:07,109
<font color="#E5E5E5">clear net IP address this works a lot</font>

854
00:30:04,909 --> 00:30:09,239
<font color="#CCCCCC">it's kind of</font><font color="#E5E5E5"> crazy right</font><font color="#CCCCCC"> now how many</font>

855
00:30:07,109 --> 00:30:10,799
web services on<font color="#E5E5E5"> tort you can hit and</font>

856
00:30:09,239 --> 00:30:12,719
<font color="#E5E5E5">you'll get this clear net information</font>

857
00:30:10,799 --> 00:30:15,389
back<font color="#E5E5E5"> sometimes you'll get the fqdn</font>

858
00:30:12,719 --> 00:30:16,739
<font color="#E5E5E5">sometimes it'll be</font><font color="#CCCCCC"> the IP</font><font color="#E5E5E5"> other times</font>

859
00:30:15,389 --> 00:30:17,968
<font color="#CCCCCC">it'll just be another onion service it</font>

860
00:30:16,739 --> 00:30:24,059
depends on how they have it configured

861
00:30:17,969 --> 00:30:26,299
and what they're<font color="#CCCCCC"> running so let's print</font>

862
00:30:24,059 --> 00:30:30,839
<font color="#CCCCCC">a demo</font><font color="#E5E5E5"> of a live hidden service for this</font>

863
00:30:26,299 --> 00:30:32,460
<font color="#E5E5E5">this</font><font color="#CCCCCC"> here is a website</font><font color="#E5E5E5"> home hosting</font><font color="#CCCCCC"> be</font>

864
00:30:30,839 --> 00:30:34,559
your own VPS this guy says<font color="#CCCCCC"> that he'll</font>

865
00:30:32,460 --> 00:30:36,989
set up a<font color="#E5E5E5"> virtual private server for you</font>

866
00:30:34,559 --> 00:30:40,440
<font color="#E5E5E5">you can just go</font><font color="#CCCCCC"> to him totally legit and</font>

867
00:30:36,989 --> 00:30:42,059
he'll set all this up<font color="#E5E5E5"> I'm gonna go ahead</font>

868
00:30:40,440 --> 00:30:43,829
<font color="#CCCCCC">and do the same</font><font color="#E5E5E5"> things I</font><font color="#CCCCCC"> did previously</font>

869
00:30:42,059 --> 00:30:45,989
<font color="#CCCCCC">to this host</font><font color="#E5E5E5"> and we'll see if we can do</font>

870
00:30:43,829 --> 00:30:48,149
<font color="#E5E5E5">an autumn eyes it but before I go I just</font>

871
00:30:45,989 --> 00:30:49,229
<font color="#E5E5E5">want to take a</font><font color="#CCCCCC"> minute to</font><font color="#E5E5E5"> take this look</font>

872
00:30:48,149 --> 00:30:51,478
<font color="#E5E5E5">at this look</font><font color="#CCCCCC"> at this</font><font color="#E5E5E5"> guy</font><font color="#CCCCCC"> holy</font><font color="#E5E5E5"> ghost</font>

873
00:30:49,229 --> 00:30:54,839
picture that's amazing look<font color="#E5E5E5"> at</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> yeah</font>

874
00:30:51,479 --> 00:30:56,309
look<font color="#E5E5E5"> at that you'll see</font><font color="#CCCCCC"> I'm</font><font color="#E5E5E5"> not gonna</font>

875
00:30:54,839 --> 00:31:00,539
plant a<font color="#CCCCCC"> backdoor</font><font color="#E5E5E5"> on your operating</font>

876
00:30:56,309 --> 00:31:02,339
system<font color="#CCCCCC"> I think the</font><font color="#E5E5E5"> best quote from</font><font color="#CCCCCC"> that</font>

877
00:31:00,539 --> 00:31:03,929
<font color="#CCCCCC">website is a well-crafted Linux system</font>

878
00:31:02,339 --> 00:31:07,249
is a very<font color="#CCCCCC"> stable system and will</font>

879
00:31:03,929 --> 00:31:07,249
continue<font color="#CCCCCC"> to work long after I'm gone</font>

880
00:31:11,000 --> 00:31:15,180
<font color="#CCCCCC">alright so in</font><font color="#E5E5E5"> this case I'm using netcat</font>

881
00:31:14,070 --> 00:31:16,679
<font color="#CCCCCC">I should</font><font color="#E5E5E5"> probably should</font><font color="#CCCCCC"> have stuck to</font>

882
00:31:15,180 --> 00:31:19,380
<font color="#CCCCCC">the</font><font color="#E5E5E5"> same commands with curl just to keep</font>

883
00:31:16,680 --> 00:31:23,210
<font color="#E5E5E5">things</font><font color="#CCCCCC"> simple but anyways I made a</font>

884
00:31:19,380 --> 00:31:25,440
request on port 80<font color="#E5E5E5"> I sent it the garbage</font>

885
00:31:23,210 --> 00:31:26,670
<font color="#E5E5E5">method not even really I</font><font color="#CCCCCC"> just in the</font>

886
00:31:25,440 --> 00:31:28,740
<font color="#E5E5E5">katadyn and I could have typed</font><font color="#CCCCCC"> anything</font>

887
00:31:26,670 --> 00:31:30,690
<font color="#E5E5E5">and hit enter twice so whatever's out</font>

888
00:31:28,740 --> 00:31:32,180
doesn't know the method comes back and

889
00:31:30,690 --> 00:31:37,860
it<font color="#E5E5E5"> gives me this you are this this</font>

890
00:31:32,180 --> 00:31:39,240
<font color="#E5E5E5">domain of</font><font color="#CCCCCC"> p OE p owh you</font><font color="#E5E5E5"> so same</font><font color="#CCCCCC"> thing</font>

891
00:31:37,860 --> 00:31:40,830
that's happened here<font color="#E5E5E5"> this guy must be</font>

892
00:31:39,240 --> 00:31:42,270
running both a clear net<font color="#CCCCCC"> site and a</font>

893
00:31:40,830 --> 00:31:44,189
hidden<font color="#E5E5E5"> service site and the fact that</font><font color="#CCCCCC"> I</font>

894
00:31:42,270 --> 00:31:45,900
didn't supply<font color="#E5E5E5"> a host header defaulted to</font>

895
00:31:44,190 --> 00:31:47,790
that default configuration and returned

896
00:31:45,900 --> 00:31:50,250
to<font color="#E5E5E5"> me the fully qualified domain name of</font>

897
00:31:47,790 --> 00:31:52,230
<font color="#CCCCCC">the private</font><font color="#E5E5E5"> of the public site so if we</font>

898
00:31:50,250 --> 00:31:54,420
go we verify again that<font color="#E5E5E5"> this public site</font>

899
00:31:52,230 --> 00:31:55,620
is legitimate<font color="#CCCCCC"> again a lot</font><font color="#E5E5E5"> of times</font>

900
00:31:54,420 --> 00:31:56,670
<font color="#CCCCCC">people will put silly things in here</font>

901
00:31:55,620 --> 00:31:59,580
like<font color="#CCCCCC"> it does</font><font color="#E5E5E5"> not exist</font>

902
00:31:56,670 --> 00:32:01,080
<font color="#E5E5E5">or</font><font color="#CCCCCC"> not your VPS comm</font><font color="#E5E5E5"> and you always want</font>

903
00:31:59,580 --> 00:32:02,760
to go ahead<font color="#E5E5E5"> and verify a lot of my</font>

904
00:32:01,080 --> 00:32:05,340
findings were false<font color="#E5E5E5"> positives</font><font color="#CCCCCC"> and</font>

905
00:32:02,760 --> 00:32:08,429
verification is key of this stuff<font color="#E5E5E5"> so</font>

906
00:32:05,340 --> 00:32:13,050
here it is here's poem poem<font color="#CCCCCC"> at</font><font color="#E5E5E5"> hu</font><font color="#CCCCCC"> boo</font>

907
00:32:08,429 --> 00:32:15,330
<font color="#E5E5E5">power of the internet not 2016 anymore I</font>

908
00:32:13,050 --> 00:32:17,700
<font color="#E5E5E5">don't know why that's there but you can</font>

909
00:32:15,330 --> 00:32:19,559
see that there is<font color="#CCCCCC"> a live</font><font color="#E5E5E5"> DNS entry for</font>

910
00:32:17,700 --> 00:32:22,860
it and it<font color="#CCCCCC"> registers back to this</font><font color="#E5E5E5"> IP</font>

911
00:32:19,559 --> 00:32:25,500
<font color="#CCCCCC">address</font><font color="#E5E5E5"> so earlier I mentioned that</font>

912
00:32:22,860 --> 00:32:27,959
<font color="#E5E5E5">onion scan does something quasi similar</font>

913
00:32:25,500 --> 00:32:29,670
to this attack<font color="#CCCCCC"> onion scan does host</font>

914
00:32:27,960 --> 00:32:32,340
header manipulation<font color="#E5E5E5"> but</font><font color="#CCCCCC"> the host header</font>

915
00:32:29,670 --> 00:32:35,130
manipulation that<font color="#CCCCCC"> onionskin does is it</font>

916
00:32:32,340 --> 00:32:37,199
will attempt to get another

917
00:32:35,130 --> 00:32:39,780
<font color="#CCCCCC">configuration if you assume that</font><font color="#E5E5E5"> website</font>

918
00:32:37,200 --> 00:32:41,910
is running so if you have a hunch that

919
00:32:39,780 --> 00:32:44,129
this hidden service is<font color="#E5E5E5"> also running</font>

920
00:32:41,910 --> 00:32:46,110
<font color="#E5E5E5">Apple comm you can</font><font color="#CCCCCC"> actually go into that</font>

921
00:32:44,130 --> 00:32:47,670
<font color="#E5E5E5">host header and put apple comm and see</font>

922
00:32:46,110 --> 00:32:49,320
if the<font color="#E5E5E5"> Apple comm configuration</font><font color="#CCCCCC"> has</font>

923
00:32:47,670 --> 00:32:50,700
returned<font color="#CCCCCC"> to you so they're doing</font>

924
00:32:49,320 --> 00:32:53,700
manipulation where they're trying<font color="#E5E5E5"> to</font>

925
00:32:50,700 --> 00:32:55,350
guess the the configurations<font color="#CCCCCC"> that might</font>

926
00:32:53,700 --> 00:32:56,820
<font color="#CCCCCC">also exist for different hosts and</font>

927
00:32:55,350 --> 00:32:58,409
they're<font color="#CCCCCC"> making the requests and</font><font color="#E5E5E5"> that</font>

928
00:32:56,820 --> 00:33:01,139
host<font color="#E5E5E5"> header for those other sites to try</font>

929
00:32:58,410 --> 00:33:03,300
<font color="#CCCCCC">to try to prove that that</font><font color="#E5E5E5"> that site is</font>

930
00:33:01,140 --> 00:33:05,520
co-hosting<font color="#E5E5E5"> an apple comm in this hidden</font>

931
00:33:03,300 --> 00:33:07,350
service<font color="#CCCCCC"> you can also use that as a</font>

932
00:33:05,520 --> 00:33:11,610
<font color="#CCCCCC">verification technique so in this case</font>

933
00:33:07,350 --> 00:33:13,800
where<font color="#CCCCCC"> we assume that</font><font color="#E5E5E5"> pone who is indeed</font>

934
00:33:11,610 --> 00:33:17,389
<font color="#E5E5E5">the same host that's running this</font>

935
00:33:13,800 --> 00:33:17,389
<font color="#E5E5E5">super-awesome VPS service</font>

936
00:33:17,779 --> 00:33:24,899
we can verify that<font color="#CCCCCC"> by modifying</font><font color="#E5E5E5"> our host</font>

937
00:33:21,600 --> 00:33:28,529
<font color="#E5E5E5">header to our hidden service and make it</font>

938
00:33:24,899 --> 00:33:32,459
<font color="#CCCCCC">pone dot h u so in this case if we go</font>

939
00:33:28,529 --> 00:33:33,720
ahead<font color="#CCCCCC"> and</font><font color="#E5E5E5"> we do curl garbage method we</font>

940
00:33:32,460 --> 00:33:35,100
give it<font color="#CCCCCC"> the host header of the hidden</font>

941
00:33:33,720 --> 00:33:36,330
service I'm sorry<font color="#E5E5E5"> let's do this for</font>

942
00:33:35,100 --> 00:33:37,860
<font color="#E5E5E5">first we're gonna do it to the clear net</font>

943
00:33:36,330 --> 00:33:39,658
<font color="#E5E5E5">site we give</font><font color="#CCCCCC"> them the host header</font><font color="#E5E5E5"> of the</font>

944
00:33:37,860 --> 00:33:41,549
hidden service and we make<font color="#E5E5E5"> our request</font>

945
00:33:39,659 --> 00:33:43,110
<font color="#E5E5E5">to the clear net so again this is not on</font>

946
00:33:41,549 --> 00:33:44,490
tour this<font color="#E5E5E5"> is just on</font><font color="#CCCCCC"> the regular</font>

947
00:33:43,110 --> 00:33:45,750
<font color="#CCCCCC">internet you go when you make a get</font>

948
00:33:44,490 --> 00:33:47,190
request and for<font color="#CCCCCC"> your host header you</font>

949
00:33:45,750 --> 00:33:48,840
specify<font color="#E5E5E5"> that hidden service name that</font>

950
00:33:47,190 --> 00:33:51,059
you<font color="#E5E5E5"> know is being hosted there it will</font>

951
00:33:48,840 --> 00:33:53,010
<font color="#E5E5E5">actually respond back</font><font color="#CCCCCC"> with the fact that</font>

952
00:33:51,059 --> 00:33:54,840
there is a configuration file<font color="#E5E5E5"> for</font><font color="#CCCCCC"> that</font>

953
00:33:53,010 --> 00:33:57,210
hidden service<font color="#CCCCCC"> so now we've been able</font><font color="#E5E5E5"> to</font>

954
00:33:54,840 --> 00:34:02,340
<font color="#E5E5E5">verify 100% that this hidden service is</font>

955
00:33:57,210 --> 00:34:05,309
<font color="#E5E5E5">running on this machine</font><font color="#CCCCCC"> alright</font><font color="#E5E5E5"> so the</font>

956
00:34:02,340 --> 00:34:08,578
next<font color="#E5E5E5"> one is SSH key fingerprint lookups</font>

957
00:34:05,309 --> 00:34:09,960
<font color="#E5E5E5">so a lot</font><font color="#CCCCCC"> of times when administrators</font>

958
00:34:08,579 --> 00:34:11,159
set up a<font color="#CCCCCC"> hidden service</font><font color="#E5E5E5"> they want to be</font>

959
00:34:09,960 --> 00:34:12,929
able<font color="#E5E5E5"> to</font><font color="#CCCCCC"> access</font><font color="#E5E5E5"> that hidden service</font>

960
00:34:11,159 --> 00:34:14,339
sometimes<font color="#E5E5E5"> on tour sometimes without</font><font color="#CCCCCC"> tour</font>

961
00:34:12,929 --> 00:34:16,020
sometimes<font color="#E5E5E5"> tour can be so slow</font><font color="#CCCCCC"> you just</font>

962
00:34:14,339 --> 00:34:17,940
<font color="#E5E5E5">don't want to deal with it it's gotten a</font>

963
00:34:16,020 --> 00:34:20,190
lot better<font color="#CCCCCC"> but because of that they</font><font color="#E5E5E5"> will</font>

964
00:34:17,940 --> 00:34:22,319
expose SSH to both their hidden service

965
00:34:20,190 --> 00:34:24,780
the Tor<font color="#E5E5E5"> network and to the clear net</font>

966
00:34:22,319 --> 00:34:26,009
<font color="#CCCCCC">network when they do this a lot of times</font>

967
00:34:24,780 --> 00:34:27,540
they don't realize that<font color="#CCCCCC"> their static</font>

968
00:34:26,010 --> 00:34:29,909
information that can identify that

969
00:34:27,540 --> 00:34:31,440
connection<font color="#CCCCCC"> so in this case we're going</font>

970
00:34:29,909 --> 00:34:34,379
to<font color="#E5E5E5"> be</font><font color="#CCCCCC"> looking at</font><font color="#E5E5E5"> the fingerprint of the</font>

971
00:34:31,440 --> 00:34:35,668
<font color="#CCCCCC">ssh</font><font color="#E5E5E5"> public key that</font><font color="#CCCCCC"> is served up to you</font>

972
00:34:34,379 --> 00:34:38,730
when you initiate your connection<font color="#CCCCCC"> to</font>

973
00:34:35,668 --> 00:34:40,109
that server so when you fire<font color="#CCCCCC"> up any ssh</font>

974
00:34:38,730 --> 00:34:41,369
connection first<font color="#E5E5E5"> thing you're</font><font color="#CCCCCC"> gonna do</font>

975
00:34:40,109 --> 00:34:43,440
<font color="#E5E5E5">is get that pop key you're gonna get a</font>

976
00:34:41,369 --> 00:34:45,480
fingerprint<font color="#CCCCCC"> of that key</font><font color="#E5E5E5"> and if that that</font>

977
00:34:43,440 --> 00:34:47,700
same key is<font color="#CCCCCC"> used for</font><font color="#E5E5E5"> both sessions</font>

978
00:34:45,480 --> 00:34:49,109
<font color="#E5E5E5">though this both</font><font color="#CCCCCC"> configurations the the</font>

979
00:34:47,699 --> 00:34:51,658
daemon listening on tour<font color="#CCCCCC"> in the daemon</font>

980
00:34:49,109 --> 00:34:53,730
listening on the clear net the the key

981
00:34:51,659 --> 00:34:56,369
is<font color="#E5E5E5"> going to be the same but a</font>

982
00:34:53,730 --> 00:35:00,660
fingerprint so we can use tools like

983
00:34:56,369 --> 00:35:02,670
<font color="#CCCCCC">showed in sentences zoom i and we can</font>

984
00:35:00,660 --> 00:35:04,618
<font color="#E5E5E5">actually identify clear net IP addresses</font>

985
00:35:02,670 --> 00:35:07,020
<font color="#CCCCCC">that are</font><font color="#E5E5E5"> using</font><font color="#CCCCCC"> that same key</font><font color="#E5E5E5"> or domains</font>

986
00:35:04,619 --> 00:35:10,170
that are<font color="#E5E5E5"> using that</font><font color="#CCCCCC"> same key same</font>

987
00:35:07,020 --> 00:35:13,319
fingerprint of that key so here's a<font color="#E5E5E5"> demo</font>

988
00:35:10,170 --> 00:35:17,069
of this attack<font color="#CCCCCC"> this site is a site where</font>

989
00:35:13,319 --> 00:35:18,859
<font color="#E5E5E5">you can apparently buy things identity</font>

990
00:35:17,069 --> 00:35:23,069
documents mostly bank statements

991
00:35:18,859 --> 00:35:24,839
<font color="#E5E5E5">falsified information and then in this</font>

992
00:35:23,069 --> 00:35:26,940
<font color="#E5E5E5">case we're going</font><font color="#CCCCCC"> to see if ssh is</font>

993
00:35:24,839 --> 00:35:28,529
listening<font color="#CCCCCC"> we're</font><font color="#E5E5E5"> just going to go ahead</font>

994
00:35:26,940 --> 00:35:29,570
<font color="#E5E5E5">and specify</font><font color="#CCCCCC"> that we want</font><font color="#E5E5E5"> the md5</font>

995
00:35:28,530 --> 00:35:30,890
fingerprint

996
00:35:29,570 --> 00:35:32,780
we make our connection and<font color="#CCCCCC"> that gets</font>

997
00:35:30,890 --> 00:35:34,790
advertised to us<font color="#E5E5E5"> we extract the md5</font>

998
00:35:32,780 --> 00:35:37,640
fingerprint and we go when<font color="#E5E5E5"> we plug that</font>

999
00:35:34,790 --> 00:35:39,560
<font color="#E5E5E5">into</font><font color="#CCCCCC"> shodhan we plug it</font><font color="#E5E5E5"> into</font><font color="#CCCCCC"> shodhan and</font>

1000
00:35:37,640 --> 00:35:43,960
we see that<font color="#E5E5E5"> this host is actually using</font>

1001
00:35:39,560 --> 00:35:43,960
that<font color="#E5E5E5"> same fingerprint</font><font color="#CCCCCC"> oh boy</font>

1002
00:36:03,900 --> 00:36:10,330
<font color="#CCCCCC">alright so in</font><font color="#E5E5E5"> this case showed in the</font>

1003
00:36:08,290 --> 00:36:12,150
heads come back and said<font color="#E5E5E5"> yeah this this</font>

1004
00:36:10,330 --> 00:36:14,799
<font color="#E5E5E5">this guy over</font><font color="#CCCCCC"> here is running the same</font>

1005
00:36:12,150 --> 00:36:16,390
<font color="#CCCCCC">who's</font><font color="#E5E5E5"> using the same fingerprint and</font>

1006
00:36:14,800 --> 00:36:19,210
we're able to<font color="#CCCCCC"> identify the fact</font><font color="#E5E5E5"> that</font>

1007
00:36:16,390 --> 00:36:20,589
most likely<font color="#CCCCCC"> this server is the</font><font color="#E5E5E5"> same</font>

1008
00:36:19,210 --> 00:36:24,490
that's<font color="#E5E5E5"> running the Association</font><font color="#CCCCCC"> stints</font>

1009
00:36:20,590 --> 00:36:27,910
<font color="#CCCCCC">with</font><font color="#E5E5E5"> that with</font><font color="#CCCCCC"> that private</font><font color="#E5E5E5"> key</font><font color="#CCCCCC"> I did</font>

1010
00:36:24,490 --> 00:36:29,740
find<font color="#E5E5E5"> one host in my scans</font>

1011
00:36:27,910 --> 00:36:32,740
I haven't dug into<font color="#E5E5E5"> it yet but there's a</font>

1012
00:36:29,740 --> 00:36:34,089
host on<font color="#CCCCCC"> shodhan that has the sorry if</font>

1013
00:36:32,740 --> 00:36:35,740
<font color="#E5E5E5">not probably</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> public key there's a host</font>

1014
00:36:34,090 --> 00:36:38,620
on<font color="#CCCCCC"> shodam that has the public</font><font color="#E5E5E5"> key</font>

1015
00:36:35,740 --> 00:36:39,939
fingerprint<font color="#E5E5E5"> for every server</font><font color="#CCCCCC"> I found on</font>

1016
00:36:38,620 --> 00:36:41,920
tour<font color="#CCCCCC"> that has a sensation running I</font>

1017
00:36:39,940 --> 00:36:43,360
<font color="#CCCCCC">don't know what they're</font><font color="#E5E5E5"> doing</font><font color="#CCCCCC"> but</font><font color="#E5E5E5"> for</font>

1018
00:36:41,920 --> 00:36:45,040
the<font color="#E5E5E5"> most</font><font color="#CCCCCC"> part when I query showed</font><font color="#E5E5E5"> in</font>

1019
00:36:43,360 --> 00:36:46,720
with any of these keys this<font color="#E5E5E5"> other server</font>

1020
00:36:45,040 --> 00:36:48,009
comes up with<font color="#E5E5E5"> this data set that has the</font>

1021
00:36:46,720 --> 00:36:49,390
information<font color="#CCCCCC"> in it I haven't</font><font color="#E5E5E5"> even let's</font>

1022
00:36:48,010 --> 00:36:50,620
see is this a web service observing<font color="#E5E5E5"> this</font>

1023
00:36:49,390 --> 00:36:55,660
content up but someone's been<font color="#E5E5E5"> tracking</font>

1024
00:36:50,620 --> 00:36:57,930
<font color="#E5E5E5">this stuff as well</font><font color="#CCCCCC"> all right so the next</font>

1025
00:36:55,660 --> 00:37:00,759
one<font color="#E5E5E5"> isn't a direct Indian</font><font color="#CCCCCC"> anima sation</font>

1026
00:36:57,930 --> 00:37:02,770
earlier I said<font color="#CCCCCC"> that you spent up a</font>

1027
00:37:00,760 --> 00:37:05,590
hidden<font color="#CCCCCC"> service and you use a private key</font>

1028
00:37:02,770 --> 00:37:07,240
and<font color="#E5E5E5"> a public</font><font color="#CCCCCC"> key to basically prove</font>

1029
00:37:05,590 --> 00:37:08,500
ownership of<font color="#CCCCCC"> that hidden</font><font color="#E5E5E5"> service and to</font>

1030
00:37:07,240 --> 00:37:11,830
do cryptographic cryptographic

1031
00:37:08,500 --> 00:37:13,450
signatures and communications<font color="#CCCCCC"> a lot of</font>

1032
00:37:11,830 --> 00:37:15,310
people<font color="#E5E5E5"> don't understand the sensitivity</font>

1033
00:37:13,450 --> 00:37:16,390
of the private key<font color="#CCCCCC"> you have a lot of</font>

1034
00:37:15,310 --> 00:37:17,529
<font color="#E5E5E5">people</font><font color="#CCCCCC"> who</font><font color="#E5E5E5"> just want to set up</font><font color="#CCCCCC"> a hidden</font>

1035
00:37:16,390 --> 00:37:19,330
<font color="#CCCCCC">service they probably should have gone</font>

1036
00:37:17,530 --> 00:37:21,730
<font color="#E5E5E5">to</font><font color="#CCCCCC"> the doctor</font><font color="#E5E5E5"> guy but they didn't so</font>

1037
00:37:19,330 --> 00:37:22,630
instead they set this up<font color="#E5E5E5"> and they say</font>

1038
00:37:21,730 --> 00:37:23,830
I'm gonna put<font color="#E5E5E5"> everything in this one</font>

1039
00:37:22,630 --> 00:37:25,540
<font color="#E5E5E5">directory because</font><font color="#CCCCCC"> it's really easy for</font>

1040
00:37:23,830 --> 00:37:26,680
<font color="#CCCCCC">me so all my tour stuff is right here my</font>

1041
00:37:25,540 --> 00:37:28,330
web server stuff my tour our

1042
00:37:26,680 --> 00:37:29,649
configuration my keys are<font color="#E5E5E5"> here</font>

1043
00:37:28,330 --> 00:37:32,860
everything's here so I can<font color="#E5E5E5"> just</font><font color="#CCCCCC"> zip it</font>

1044
00:37:29,650 --> 00:37:34,720
<font color="#CCCCCC">up move</font><font color="#E5E5E5"> it around</font><font color="#CCCCCC"> and again</font><font color="#E5E5E5"> if you're</font>

1045
00:37:32,860 --> 00:37:36,550
<font color="#E5E5E5">not familiar with what</font><font color="#CCCCCC"> you're doing that</font>

1046
00:37:34,720 --> 00:37:40,870
can cause you to actually<font color="#E5E5E5"> leak that that</font>

1047
00:37:36,550 --> 00:37:44,230
private<font color="#E5E5E5"> key so the lady who</font><font color="#CCCCCC"> runs onion</font>

1048
00:37:40,870 --> 00:37:45,940
scan<font color="#E5E5E5"> Oh</font><font color="#CCCCCC"> tweeted out a while ago yeah</font>

1049
00:37:44,230 --> 00:37:48,280
this is actually<font color="#CCCCCC"> a thing is kind of</font>

1050
00:37:45,940 --> 00:37:50,590
crazy<font color="#CCCCCC"> and I looked and just in someone's</font>

1051
00:37:48,280 --> 00:37:52,120
<font color="#CCCCCC">rub directory was I just</font><font color="#E5E5E5"> I was a private</font>

1052
00:37:50,590 --> 00:37:53,490
underscore key like<font color="#E5E5E5"> be private key</font>

1053
00:37:52,120 --> 00:37:56,220
served up from the root<font color="#CCCCCC"> directory</font>

1054
00:37:53,490 --> 00:37:57,330
that's that's<font color="#E5E5E5"> can't be</font><font color="#CCCCCC"> a thing so I went</font>

1055
00:37:56,220 --> 00:37:58,799
<font color="#CCCCCC">after</font><font color="#E5E5E5"> my computer I plugged it into my</font>

1056
00:37:57,330 --> 00:38:02,330
scanner<font color="#CCCCCC"> around the scan went to sleep</font>

1057
00:37:58,800 --> 00:38:06,240
woke up and had think<font color="#E5E5E5"> 26 private keys</font>

1058
00:38:02,330 --> 00:38:08,460
<font color="#CCCCCC">now here's a demo</font><font color="#E5E5E5"> of the private key</font>

1059
00:38:06,240 --> 00:38:09,600
leakage<font color="#CCCCCC"> this</font><font color="#E5E5E5"> is a</font><font color="#CCCCCC"> website it</font><font color="#E5E5E5"> looks like</font>

1060
00:38:08,460 --> 00:38:10,980
it's somewhat<font color="#CCCCCC"> dated people haven't</font>

1061
00:38:09,600 --> 00:38:13,319
responded in some time but<font color="#E5E5E5"> it looks like</font>

1062
00:38:10,980 --> 00:38:15,810
<font color="#E5E5E5">it was a form mostly maybe car there's</font>

1063
00:38:13,320 --> 00:38:19,430
advertisements<font color="#E5E5E5"> for cards</font><font color="#CCCCCC"> obviously the</font>

1064
00:38:15,810 --> 00:38:22,080
classic<font color="#E5E5E5"> how to</font><font color="#CCCCCC"> ask how</font><font color="#E5E5E5"> to hack facebook</font>

1065
00:38:19,430 --> 00:38:24,868
<font color="#E5E5E5">but anyways if</font><font color="#CCCCCC"> you just go into</font><font color="#E5E5E5"> the URI</font>

1066
00:38:22,080 --> 00:38:27,150
and<font color="#E5E5E5"> you add a slash private underscore</font>

1067
00:38:24,869 --> 00:38:28,530
key you'll see that the private key

1068
00:38:27,150 --> 00:38:31,020
instantly comes back in<font color="#E5E5E5"> this case I've</font>

1069
00:38:28,530 --> 00:38:33,780
just<font color="#CCCCCC"> done it through through curl and</font>

1070
00:38:31,020 --> 00:38:36,509
with this private key<font color="#CCCCCC"> I can now spin up</font>

1071
00:38:33,780 --> 00:38:39,420
<font color="#E5E5E5">has this hidden service so I can start</font>

1072
00:38:36,510 --> 00:38:41,040
my own hidden service has the<font color="#CCCCCC"> identity</font>

1073
00:38:39,420 --> 00:38:42,480
of this hidden service now again this

1074
00:38:41,040 --> 00:38:43,560
<font color="#E5E5E5">doesn't directly</font><font color="#CCCCCC"> be anonymize the</font><font color="#E5E5E5"> hidden</font>

1075
00:38:42,480 --> 00:38:44,760
service but<font color="#E5E5E5"> this will allow</font><font color="#CCCCCC"> me to a</font>

1076
00:38:43,560 --> 00:38:46,860
variety<font color="#E5E5E5"> of things which are out of the</font>

1077
00:38:44,760 --> 00:38:48,690
<font color="#E5E5E5">scope of this talk I can clone their</font>

1078
00:38:46,860 --> 00:38:50,550
site so the admin comes in he logs in

1079
00:38:48,690 --> 00:38:52,320
and I get his creds<font color="#CCCCCC"> I can inject</font>

1080
00:38:50,550 --> 00:38:54,630
<font color="#E5E5E5">malicious JavaScript into any of the</font>

1081
00:38:52,320 --> 00:38:56,190
viewers<font color="#E5E5E5"> who go</font><font color="#CCCCCC"> to this site so through</font>

1082
00:38:54,630 --> 00:38:57,600
<font color="#E5E5E5">this vector there is a variety of ways</font>

1083
00:38:56,190 --> 00:38:59,220
<font color="#CCCCCC">which you can</font><font color="#E5E5E5"> do an autumn eyes not only</font>

1084
00:38:57,600 --> 00:39:05,270
<font color="#CCCCCC">the hidden service of the administrator</font>

1085
00:38:59,220 --> 00:39:05,270
<font color="#E5E5E5">and the users as well yeah</font>

1086
00:39:09,579 --> 00:39:14,130
yeah so I<font color="#CCCCCC"> definitely never would have</font>

1087
00:39:12,440 --> 00:39:14,860
done<font color="#E5E5E5"> that</font><font color="#CCCCCC"> so I don't know</font>

1088
00:39:14,130 --> 00:39:17,909
[Laughter]

1089
00:39:14,860 --> 00:39:17,909
[Music]

1090
00:39:18,370 --> 00:39:22,630
I'm sure you<font color="#E5E5E5"> could</font><font color="#CCCCCC"> find out very</font><font color="#E5E5E5"> easily</font>

1091
00:39:22,720 --> 00:39:26,899
and then stroll which is fun<font color="#CCCCCC"> the admins</font>

1092
00:39:26,060 --> 00:39:28,160
<font color="#CCCCCC">to actually know what the hell they're</font>

1093
00:39:26,900 --> 00:39:29,630
<font color="#CCCCCC">doing</font><font color="#E5E5E5"> will troll the out of you</font>

1094
00:39:28,160 --> 00:39:31,430
<font color="#E5E5E5">when you're doing these things</font>

1095
00:39:29,630 --> 00:39:33,560
this person has horrible<font color="#E5E5E5"> English but</font>

1096
00:39:31,430 --> 00:39:38,419
they<font color="#CCCCCC"> didn't</font><font color="#E5E5E5"> make me</font><font color="#CCCCCC"> laugh and it</font><font color="#E5E5E5"> doesn't</font>

1097
00:39:33,560 --> 00:39:42,230
stop this is a good one<font color="#E5E5E5"> too this is</font>

1098
00:39:38,420 --> 00:39:44,180
<font color="#E5E5E5">probably my favorite</font><font color="#CCCCCC"> and then lastly</font>

1099
00:39:42,230 --> 00:39:50,720
this<font color="#CCCCCC"> one this one kind</font><font color="#E5E5E5"> of</font><font color="#CCCCCC"> tripped me up</font>

1100
00:39:44,180 --> 00:39:56,930
<font color="#E5E5E5">because he put right yeah I looked at is</font>

1101
00:39:50,720 --> 00:39:58,100
<font color="#E5E5E5">like score and then I think the last</font><font color="#CCCCCC"> one</font>

1102
00:39:56,930 --> 00:40:00,649
I'm going to<font color="#E5E5E5"> talk</font><font color="#CCCCCC"> about today before I</font>

1103
00:39:58,100 --> 00:40:03,710
go into some demos is verbose and

1104
00:40:00,650 --> 00:40:05,410
misconfigured<font color="#CCCCCC"> web</font><font color="#E5E5E5"> services</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> many web</font>

1105
00:40:03,710 --> 00:40:08,180
web applications<font color="#CCCCCC"> can leak information</font>

1106
00:40:05,410 --> 00:40:09,830
<font color="#E5E5E5">just by their configurations one time I</font>

1107
00:40:08,180 --> 00:40:11,569
found<font color="#E5E5E5"> a known clown instance somebody</font>

1108
00:40:09,830 --> 00:40:13,130
had set up<font color="#E5E5E5"> own cloud and I've seen this</font>

1109
00:40:11,570 --> 00:40:14,750
with<font color="#CCCCCC"> plex as well they set it up on</font><font color="#E5E5E5"> the</font>

1110
00:40:13,130 --> 00:40:16,340
clear net site and then they converted

1111
00:40:14,750 --> 00:40:18,590
over to a hidden<font color="#CCCCCC"> service but a lot of</font>

1112
00:40:16,340 --> 00:40:20,150
the clear net domain<font color="#CCCCCC"> information or IPS</font>

1113
00:40:18,590 --> 00:40:22,220
were hard-coded into some<font color="#CCCCCC"> resources</font>

1114
00:40:20,150 --> 00:40:24,620
whether<font color="#E5E5E5"> it was a JPEG that was used or a</font>

1115
00:40:22,220 --> 00:40:27,439
link that was used so scraping a site

1116
00:40:24,620 --> 00:40:30,109
can actually reveal<font color="#CCCCCC"> clear net</font><font color="#E5E5E5"> IP is</font><font color="#CCCCCC"> or</font>

1117
00:40:27,440 --> 00:40:32,870
domains as well<font color="#E5E5E5"> um you can also find</font>

1118
00:40:30,110 --> 00:40:34,940
this in the<font color="#E5E5E5"> form of info dot PHP</font><font color="#CCCCCC"> or if</font>

1119
00:40:32,870 --> 00:40:36,920
you know debugging is enabled on like

1120
00:40:34,940 --> 00:40:39,290
dokuwiki<font color="#E5E5E5"> x' you can get a lot of</font><font color="#CCCCCC"> this</font>

1121
00:40:36,920 --> 00:40:42,020
information<font color="#E5E5E5"> from for both server</font>

1122
00:40:39,290 --> 00:40:44,600
configurations<font color="#E5E5E5"> I didn't think that scan</font>

1123
00:40:42,020 --> 00:40:46,580
for info dot PHP until<font color="#E5E5E5"> yesterday so I</font>

1124
00:40:44,600 --> 00:40:48,529
went<font color="#CCCCCC"> through and scanned</font><font color="#E5E5E5"> I found a</font>

1125
00:40:46,580 --> 00:40:48,980
<font color="#E5E5E5">decent amount most of them were internal</font>

1126
00:40:48,530 --> 00:40:50,690
<font color="#CCCCCC">IPs</font>

1127
00:40:48,980 --> 00:40:53,480
so it didn't<font color="#CCCCCC"> really help me out I did</font>

1128
00:40:50,690 --> 00:40:55,880
find this<font color="#CCCCCC"> one</font><font color="#E5E5E5"> really quick one that does</font>

1129
00:40:53,480 --> 00:40:59,060
list its public IP inside of the info

1130
00:40:55,880 --> 00:41:00,590
<font color="#E5E5E5">dot PHP</font><font color="#CCCCCC"> sadly by the time the next day</font>

1131
00:40:59,060 --> 00:41:02,000
when I<font color="#E5E5E5"> went to go hit</font><font color="#CCCCCC"> it I got a 500</font>

1132
00:41:00,590 --> 00:41:04,220
error on the server so I<font color="#E5E5E5"> wasn't able to</font>

1133
00:41:02,000 --> 00:41:06,230
take<font color="#E5E5E5"> any pretty pretty screenshots</font><font color="#CCCCCC"> but</font>

1134
00:41:04,220 --> 00:41:08,509
<font color="#CCCCCC">just again</font><font color="#E5E5E5"> keep in mind setting up a</font>

1135
00:41:06,230 --> 00:41:10,400
service<font color="#E5E5E5"> initially on a clear net site</font>

1136
00:41:08,510 --> 00:41:11,930
converting it over or exposing<font color="#CCCCCC"> these</font>

1137
00:41:10,400 --> 00:41:14,060
debugging interfaces or verbose

1138
00:41:11,930 --> 00:41:17,589
debugging<font color="#E5E5E5"> information can candy</font>

1139
00:41:14,060 --> 00:41:20,270
anonymize that other common checks

1140
00:41:17,590 --> 00:41:21,500
<font color="#CCCCCC">service banners and again onionskin</font><font color="#E5E5E5"> does</font>

1141
00:41:20,270 --> 00:41:23,060
most of<font color="#E5E5E5"> this stuff I'm not advocating</font>

1142
00:41:21,500 --> 00:41:25,250
for in<font color="#CCCCCC"> skåne</font><font color="#E5E5E5"> I've actually never used it</font>

1143
00:41:23,060 --> 00:41:26,750
but<font color="#E5E5E5"> I know it will do server service</font>

1144
00:41:25,250 --> 00:41:28,460
banner checks as well<font color="#CCCCCC"> I think it</font>

1145
00:41:26,750 --> 00:41:29,230
probably checks sums the server banner

1146
00:41:28,460 --> 00:41:31,000
and<font color="#E5E5E5"> then</font>

1147
00:41:29,230 --> 00:41:33,430
goes elsewhere<font color="#E5E5E5"> and look for the same</font>

1148
00:41:31,000 --> 00:41:35,770
<font color="#CCCCCC">information obviously</font><font color="#E5E5E5"> HTTP search can</font>

1149
00:41:33,430 --> 00:41:39,029
have the<font color="#E5E5E5"> same effect as the SSH</font>

1150
00:41:35,770 --> 00:41:41,080
public keys fingerprints did<font color="#CCCCCC"> DNS lookups</font>

1151
00:41:39,030 --> 00:41:43,270
<font color="#CCCCCC">it's a little</font><font color="#E5E5E5"> trigger with DNS</font><font color="#CCCCCC"> because</font>

1152
00:41:41,080 --> 00:41:45,670
<font color="#E5E5E5">of caching servers and how DNS is going</font>

1153
00:41:43,270 --> 00:41:47,230
to be<font color="#CCCCCC"> routed but there are ways in</font><font color="#E5E5E5"> some</font>

1154
00:41:45,670 --> 00:41:48,700
situations where if you control a name

1155
00:41:47,230 --> 00:41:50,410
server you can<font color="#E5E5E5"> get a hidden service to</font>

1156
00:41:48,700 --> 00:41:55,509
do a lookup directly to you not through

1157
00:41:50,410 --> 00:41:58,960
tor<font color="#CCCCCC"> exploitation again you know</font><font color="#E5E5E5"> really</font>

1158
00:41:55,510 --> 00:42:01,180
bad PHP code out there<font color="#CCCCCC"> so</font><font color="#E5E5E5"> just a command</font>

1159
00:41:58,960 --> 00:42:03,040
injection or sequel Iowa from hopping on

1160
00:42:01,180 --> 00:42:07,690
the box and numerating it that way<font color="#CCCCCC"> and</font>

1161
00:42:03,040 --> 00:42:10,690
then there's there's many<font color="#E5E5E5"> more so let's</font>

1162
00:42:07,690 --> 00:42:12,700
do some demos<font color="#CCCCCC"> I'm</font><font color="#E5E5E5"> gonna try this live I</font>

1163
00:42:10,690 --> 00:42:19,200
recorded it just in<font color="#CCCCCC"> case so let's see</font>

1164
00:42:12,700 --> 00:42:19,200
what happens<font color="#CCCCCC"> I will zoom</font><font color="#E5E5E5"> into the sick</font>

1165
00:42:20,089 --> 00:42:24,819
oh yeah I lost<font color="#E5E5E5"> my SSH connection all</font>

1166
00:42:22,400 --> 00:42:24,819
<font color="#E5E5E5">right so</font>

1167
00:42:47,840 --> 00:42:54,950
<font color="#E5E5E5">all right you guys can see</font><font color="#CCCCCC"> that all</font>

1168
00:42:49,850 --> 00:42:57,500
<font color="#CCCCCC">right</font><font color="#E5E5E5"> so I'm just gonna run my horribly</font>

1169
00:42:54,950 --> 00:42:59,839
written<font color="#E5E5E5"> script here called scandal and</font>

1170
00:42:57,500 --> 00:43:02,840
I'm gonna<font color="#E5E5E5"> supply it a list of onion</font>

1171
00:42:59,840 --> 00:43:04,790
addresses<font color="#E5E5E5"> so the onion address list is</font>

1172
00:43:02,840 --> 00:43:06,830
just<font color="#E5E5E5"> that just onion addresses for the</font>

1173
00:43:04,790 --> 00:43:07,880
sake of<font color="#E5E5E5"> its demo I went ahead and just</font>

1174
00:43:06,830 --> 00:43:09,350
<font color="#CCCCCC">grabbed some of the more interesting</font>

1175
00:43:07,880 --> 00:43:11,360
<font color="#CCCCCC">ones</font><font color="#E5E5E5"> to trim it</font><font color="#CCCCCC"> down when I run this</font>

1176
00:43:09,350 --> 00:43:13,640
<font color="#CCCCCC">over thousands I just run it at night</font>

1177
00:43:11,360 --> 00:43:15,020
<font color="#E5E5E5">and go</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> bed sometimes</font><font color="#CCCCCC"> since I'm</font><font color="#E5E5E5"> not a</font>

1178
00:43:13,640 --> 00:43:16,940
developer<font color="#CCCCCC"> and I'm not cool</font><font color="#E5E5E5"> enough</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> do</font>

1179
00:43:15,020 --> 00:43:18,800
multi-threading<font color="#E5E5E5"> sometimes I'll open like</font>

1180
00:43:16,940 --> 00:43:21,520
20 screen sessions and chunk up the file

1181
00:43:18,800 --> 00:43:21,520
<font color="#CCCCCC">and do it that</font><font color="#E5E5E5"> way</font>

1182
00:43:25,000 --> 00:43:28,550
so I'm gonna go ahead<font color="#E5E5E5"> and just let this</font>

1183
00:43:26,990 --> 00:43:30,439
run through<font color="#E5E5E5"> it will take about four</font>

1184
00:43:28,550 --> 00:43:32,600
<font color="#CCCCCC">minutes to do so so as</font><font color="#E5E5E5"> this is running</font>

1185
00:43:30,440 --> 00:43:34,880
and<font color="#CCCCCC"> also if we get</font><font color="#E5E5E5"> bored I can kill it I</font>

1186
00:43:32,600 --> 00:43:36,230
have a backup<font color="#CCCCCC"> of</font><font color="#E5E5E5"> the output so as this</font>

1187
00:43:34,880 --> 00:43:37,400
<font color="#E5E5E5">is running you'll see it goes through</font>

1188
00:43:36,230 --> 00:43:39,170
and<font color="#E5E5E5"> it checks</font><font color="#CCCCCC"> to see if the</font><font color="#E5E5E5"> server's</font>

1189
00:43:37,400 --> 00:43:41,240
Apache<font color="#CCCCCC"> if it is it'll</font><font color="#E5E5E5"> go through and do</font>

1190
00:43:39,170 --> 00:43:42,320
the attacks for server status<font color="#E5E5E5"> checks and</font>

1191
00:43:41,240 --> 00:43:44,600
<font color="#E5E5E5">we'll go</font><font color="#CCCCCC"> through and</font><font color="#E5E5E5"> see</font><font color="#CCCCCC"> if you can get</font>

1192
00:43:42,320 --> 00:43:46,250
the post header information like we

1193
00:43:44,600 --> 00:43:47,930
talked about and then<font color="#CCCCCC"> it will go</font><font color="#E5E5E5"> ahead</font>

1194
00:43:46,250 --> 00:43:50,180
<font color="#E5E5E5">and check</font><font color="#CCCCCC"> for the private key</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> and</font>

1195
00:43:47,930 --> 00:43:53,060
lastly<font color="#E5E5E5"> for the SSH fingerprint now at</font>

1196
00:43:50,180 --> 00:43:54,859
this point<font color="#E5E5E5"> the SSH fingerprint just gets</font>

1197
00:43:53,060 --> 00:43:56,660
dumped into a file<font color="#CCCCCC"> I do have</font><font color="#E5E5E5"> another</font>

1198
00:43:54,860 --> 00:43:58,010
Python<font color="#E5E5E5"> script which I'll show you that</font>

1199
00:43:56,660 --> 00:43:59,330
<font color="#CCCCCC">will go through</font><font color="#E5E5E5"> and take the fingerprint</font>

1200
00:43:58,010 --> 00:44:02,600
push it up<font color="#CCCCCC"> to show it and</font><font color="#E5E5E5"> get any</font>

1201
00:43:59,330 --> 00:44:04,520
results back<font color="#E5E5E5"> for you again lazy haven't</font>

1202
00:44:02,600 --> 00:44:06,319
dived it in yet<font color="#CCCCCC"> probably wouldn't be</font>

1203
00:44:04,520 --> 00:44:08,390
<font color="#E5E5E5">doing it in bash as it's in Python now</font>

1204
00:44:06,320 --> 00:44:09,620
<font color="#E5E5E5">so let's</font><font color="#CCCCCC"> go and let this run</font><font color="#E5E5E5"> it might</font>

1205
00:44:08,390 --> 00:44:11,629
take it<font color="#E5E5E5"> another couple of minutes</font><font color="#CCCCCC"> here</font>

1206
00:44:09,620 --> 00:44:13,759
<font color="#E5E5E5">does anyone have any</font><font color="#CCCCCC"> questions</font><font color="#E5E5E5"> so far</font>

1207
00:44:11,630 --> 00:44:14,810
<font color="#E5E5E5">I'm probably gonna run close</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> the end</font>

1208
00:44:13,760 --> 00:44:16,550
time here so if anyone does have

1209
00:44:14,810 --> 00:44:20,110
<font color="#CCCCCC">questions</font><font color="#E5E5E5"> now is</font><font color="#CCCCCC"> probably a good time as</font>

1210
00:44:16,550 --> 00:44:22,330
<font color="#E5E5E5">this runs yeah</font>

1211
00:44:20,110 --> 00:44:24,460
I'm violating<font color="#E5E5E5"> them not a questionable</font>

1212
00:44:22,330 --> 00:44:25,960
<font color="#CCCCCC">but your notice that</font><font color="#E5E5E5"> our attack will</font>

1213
00:44:24,460 --> 00:44:27,940
also work<font color="#E5E5E5"> against an improperly</font>

1214
00:44:25,960 --> 00:44:30,130
configured nginx<font color="#CCCCCC"> instance</font><font color="#E5E5E5"> that there's a</font>

1215
00:44:27,940 --> 00:44:33,820
default<font color="#E5E5E5"> there's a default site directive</font>

1216
00:44:30,130 --> 00:44:35,290
there too<font color="#E5E5E5"> so if you if you pass no votes</font>

1217
00:44:33,820 --> 00:44:37,150
header to someone who has default site

1218
00:44:35,290 --> 00:44:38,710
configured on their public<font color="#E5E5E5"> facing you'll</font>

1219
00:44:37,150 --> 00:44:40,930
probably also have<font color="#E5E5E5"> the same</font><font color="#CCCCCC"> because</font>

1220
00:44:38,710 --> 00:44:42,520
<font color="#E5E5E5">there yeah that's</font><font color="#CCCCCC"> a good call</font><font color="#E5E5E5"> I know</font>

1221
00:44:40,930 --> 00:44:44,589
somebody has looked at a couple<font color="#CCCCCC"> of like</font>

1222
00:44:42,520 --> 00:44:46,060
light HTTP<font color="#CCCCCC"> DS as well or some of the</font>

1223
00:44:44,590 --> 00:44:49,120
other web servers<font color="#E5E5E5"> I haven't done any</font>

1224
00:44:46,060 --> 00:44:50,799
testing<font color="#E5E5E5"> aside from Apache only because I</font>

1225
00:44:49,120 --> 00:44:52,509
figured it was<font color="#E5E5E5"> one</font><font color="#CCCCCC"> of the most common so</font>

1226
00:44:50,800 --> 00:44:53,830
it was kind of I tried to keep my my

1227
00:44:52,510 --> 00:44:55,690
scans relatively small and limited

1228
00:44:53,830 --> 00:44:57,160
<font color="#E5E5E5">without</font><font color="#CCCCCC"> giving out a bunch of</font><font color="#E5E5E5"> more stuff</font>

1229
00:44:55,690 --> 00:44:59,260
<font color="#E5E5E5">but that's a very</font><font color="#CCCCCC"> good call</font><font color="#E5E5E5"> I'm sure</font>

1230
00:44:57,160 --> 00:45:02,170
many other web servers may be<font color="#E5E5E5"> vulnerable</font>

1231
00:44:59,260 --> 00:45:03,700
<font color="#CCCCCC">I know that that</font><font color="#E5E5E5"> that attack that</font>

1232
00:45:02,170 --> 00:45:04,960
<font color="#CCCCCC">documentation in Apache that</font>

1233
00:45:03,700 --> 00:45:06,759
specifically says about the fault of the

1234
00:45:04,960 --> 00:45:07,990
first is I think<font color="#E5E5E5"> one of the one of the</font>

1235
00:45:06,760 --> 00:45:10,570
reasons why<font color="#CCCCCC"> that happens but</font><font color="#E5E5E5"> it's</font>

1236
00:45:07,990 --> 00:45:11,819
definitely worth<font color="#CCCCCC"> checking out any other</font>

1237
00:45:10,570 --> 00:45:15,040
<font color="#E5E5E5">questions</font>

1238
00:45:11,820 --> 00:45:16,870
<font color="#E5E5E5">no</font><font color="#CCCCCC"> okay so I'm not gonna</font><font color="#E5E5E5"> let this run</font>

1239
00:45:15,040 --> 00:45:17,860
all the way<font color="#CCCCCC"> through it usually only has</font>

1240
00:45:16,870 --> 00:45:19,270
<font color="#E5E5E5">another couple minutes</font><font color="#CCCCCC"> to go but</font><font color="#E5E5E5"> I've</font>

1241
00:45:17,860 --> 00:45:20,350
got a backup<font color="#E5E5E5"> of the output of this so</font>

1242
00:45:19,270 --> 00:45:21,970
let's<font color="#CCCCCC"> go ahead</font><font color="#E5E5E5"> and take a look at what</font>

1243
00:45:20,350 --> 00:45:24,509
this script will generate for<font color="#CCCCCC"> me when</font>

1244
00:45:21,970 --> 00:45:24,509
it's done<font color="#E5E5E5"> running</font>

1245
00:45:38,670 --> 00:45:43,559
<font color="#E5E5E5">all right so at the end result</font><font color="#CCCCCC"> I go</font>

1246
00:45:41,640 --> 00:45:45,720
<font color="#E5E5E5">through and I get any of</font><font color="#CCCCCC"> the URIs that</font>

1247
00:45:43,559 --> 00:45:47,670
<font color="#CCCCCC">are in the server</font><font color="#E5E5E5"> status page</font><font color="#CCCCCC"> so right</font>

1248
00:45:45,720 --> 00:45:49,410
here we've gone ahead and pulled a full

1249
00:45:47,670 --> 00:45:50,819
fully qualified domain on the<font color="#E5E5E5"> clear net</font>

1250
00:45:49,410 --> 00:45:53,788
from this hidden service<font color="#E5E5E5"> server status</font>

1251
00:45:50,819 --> 00:45:59,609
<font color="#E5E5E5">page it'll also go through and grab the</font>

1252
00:45:53,789 --> 00:46:02,309
fingerprints<font color="#E5E5E5"> and private keys Apache</font>

1253
00:45:59,609 --> 00:46:06,690
server status<font color="#E5E5E5"> sorry the Apache header</font>

1254
00:46:02,309 --> 00:46:10,079
mod mod and yeah<font color="#E5E5E5"> so it's one of these</font>

1255
00:46:06,690 --> 00:46:11,309
sites here<font color="#E5E5E5"> and I haven't</font><font color="#CCCCCC"> shown the keys</font>

1256
00:46:10,079 --> 00:46:14,549
yet but he's one of<font color="#E5E5E5"> these sites in this</font>

1257
00:46:11,309 --> 00:46:17,549
response<font color="#CCCCCC"> does leak it's public IP or</font>

1258
00:46:14,549 --> 00:46:18,900
domain information<font color="#CCCCCC"> so this scan again it</font>

1259
00:46:17,549 --> 00:46:21,930
<font color="#CCCCCC">took me prob about four or five</font><font color="#E5E5E5"> minutes</font>

1260
00:46:18,900 --> 00:46:25,670
to run<font color="#CCCCCC"> resulted</font><font color="#E5E5E5"> in about by twelve or</font>

1261
00:46:21,930 --> 00:46:29,700
<font color="#E5E5E5">thirteen hidden services</font><font color="#CCCCCC"> D</font><font color="#E5E5E5"> anonymized</font>

1262
00:46:25,670 --> 00:46:32,269
<font color="#CCCCCC">now as far as the keys go for the</font><font color="#E5E5E5"> SSH</font>

1263
00:46:29,700 --> 00:46:32,269
fingerprint

1264
00:46:44,380 --> 00:46:48,430
<font color="#CCCCCC">all right so in this</font><font color="#E5E5E5"> case</font><font color="#CCCCCC"> I just</font><font color="#E5E5E5"> run the</font>

1265
00:46:46,089 --> 00:46:50,859
<font color="#E5E5E5">Python file it's gonna look for a file</font>

1266
00:46:48,430 --> 00:46:52,779
called<font color="#E5E5E5"> keys list keys list has all my</font>

1267
00:46:50,859 --> 00:46:56,589
keys from that scan<font color="#E5E5E5"> that I extracted</font><font color="#CCCCCC"> so</font>

1268
00:46:52,779 --> 00:46:59,289
I just<font color="#CCCCCC"> catted them and grab</font><font color="#E5E5E5"> them out and</font>

1269
00:46:56,589 --> 00:47:02,109
<font color="#E5E5E5">it will go ahead perfect awesome perfect</font>

1270
00:46:59,289 --> 00:47:09,450
<font color="#CCCCCC">cool yep</font>

1271
00:47:02,109 --> 00:47:09,450
marvelous so normally

1272
00:47:13,250 --> 00:47:20,510
normally<font color="#CCCCCC"> that it look like</font><font color="#E5E5E5"> this for the</font>

1273
00:47:19,340 --> 00:47:22,790
results<font color="#E5E5E5"> that are found</font>

1274
00:47:20,510 --> 00:47:24,619
there's the IP address<font color="#CCCCCC"> 2d anonymize the</font>

1275
00:47:22,790 --> 00:47:27,470
<font color="#E5E5E5">hidden service any of the ones that say</font>

1276
00:47:24,619 --> 00:47:29,570
found<font color="#CCCCCC"> to that dot one</font><font color="#E5E5E5"> for three</font>

1277
00:47:27,470 --> 00:47:31,250
server is the<font color="#CCCCCC"> server that's</font><font color="#E5E5E5"> on</font><font color="#CCCCCC"> shodhan</font>

1278
00:47:29,570 --> 00:47:33,260
that's indexing all these keys right<font color="#CCCCCC"> now</font>

1279
00:47:31,250 --> 00:47:37,660
<font color="#CCCCCC">so a lot of</font><font color="#E5E5E5"> these results will return to</font>

1280
00:47:33,260 --> 00:47:37,660
because of that<font color="#CCCCCC"> other index indexer so</font>

1281
00:47:45,800 --> 00:47:52,220
all right so we're all hyped up<font color="#E5E5E5"> you want</font>

1282
00:47:47,960 --> 00:47:53,420
<font color="#E5E5E5">to go do some scanning</font><font color="#CCCCCC"> beware</font><font color="#E5E5E5"> I trimmed</font>

1283
00:47:52,220 --> 00:47:57,279
a lot<font color="#E5E5E5"> of this stuff and I</font><font color="#CCCCCC"> tried to make</font>

1284
00:47:53,420 --> 00:47:59,960
<font color="#CCCCCC">it as PC as possible for here</font>

1285
00:47:57,280 --> 00:48:03,860
enough said and there's some<font color="#CCCCCC"> out</font>

1286
00:47:59,960 --> 00:48:06,310
there<font color="#CCCCCC"> are they safe from my opinion I</font>

1287
00:48:03,860 --> 00:48:09,170
<font color="#CCCCCC">don't know</font>

1288
00:48:06,310 --> 00:48:10,970
<font color="#E5E5E5">Who am I to say</font><font color="#CCCCCC"> there are a lot of</font>

1289
00:48:09,170 --> 00:48:13,040
<font color="#E5E5E5">attacks both on from a network level and</font>

1290
00:48:10,970 --> 00:48:14,990
from<font color="#E5E5E5"> a configuration level that can be</font>

1291
00:48:13,040 --> 00:48:16,310
exploited<font color="#CCCCCC"> so I'm not</font><font color="#E5E5E5"> here to say</font><font color="#CCCCCC"> where</font>

1292
00:48:14,990 --> 00:48:17,930
<font color="#CCCCCC">the tour is good or</font><font color="#E5E5E5"> tour is bad these</font>

1293
00:48:16,310 --> 00:48:21,200
<font color="#E5E5E5">are just my findings on the state of</font>

1294
00:48:17,930 --> 00:48:25,970
hidden services<font color="#CCCCCC"> I do have I'll put this</font>

1295
00:48:21,200 --> 00:48:29,210
<font color="#E5E5E5">slide deck up on DC 5 6 2 s talks repo</font>

1296
00:48:25,970 --> 00:48:31,100
you can find us<font color="#E5E5E5"> through DC 5 6 2 org</font><font color="#CCCCCC"> but</font>

1297
00:48:29,210 --> 00:48:32,930
<font color="#CCCCCC">I do have some references here</font><font color="#E5E5E5"> on some</font>

1298
00:48:31,100 --> 00:48:34,520
really<font color="#E5E5E5"> good videos on tour and hidden</font>

1299
00:48:32,930 --> 00:48:36,890
services and some<font color="#E5E5E5"> slip-ups and some</font>

1300
00:48:34,520 --> 00:48:38,509
attacks<font color="#E5E5E5"> I also have references here to</font>

1301
00:48:36,890 --> 00:48:40,040
some of the more important tour spec

1302
00:48:38,510 --> 00:48:41,720
papers if you're interested<font color="#CCCCCC"> and</font><font color="#E5E5E5"> doing</font>

1303
00:48:40,040 --> 00:48:46,160
any research<font color="#CCCCCC"> these helped</font><font color="#E5E5E5"> me out</font><font color="#CCCCCC"> quite</font>

1304
00:48:41,720 --> 00:48:48,020
quite a bit and then lastly<font color="#E5E5E5"> help run DC</font>

1305
00:48:46,160 --> 00:48:50,000
5 6<font color="#CCCCCC"> 2 it's a local</font><font color="#E5E5E5"> Def Con group here in</font>

1306
00:48:48,020 --> 00:48:51,470
LA<font color="#E5E5E5"> if you guys are not part of Def Con</font>

1307
00:48:50,000 --> 00:48:53,030
group<font color="#E5E5E5"> in your area</font><font color="#CCCCCC"> go find one because</font>

1308
00:48:51,470 --> 00:48:54,529
<font color="#E5E5E5">they are fun and</font><font color="#CCCCCC"> they're awesome and</font>

1309
00:48:53,030 --> 00:48:57,680
<font color="#E5E5E5">being with this group has helped me</font>

1310
00:48:54,530 --> 00:49:02,260
learn<font color="#E5E5E5"> and grow immensely</font><font color="#CCCCCC"> so I just want</font>

1311
00:48:57,680 --> 00:49:02,259
to<font color="#E5E5E5"> say thanks to the group</font><font color="#CCCCCC"> and so I got</font>

1312
00:49:06,120 --> 00:49:14,890
[Applause]

1313
00:49:09,280 --> 00:49:14,890
any questions<font color="#E5E5E5"> no all right</font><font color="#CCCCCC"> thank you yes</font>

