1
00:00:00,000 --> 00:00:07,130
needing a break before they can<font color="#E5E5E5"> get one</font>

2
00:00:02,399 --> 00:00:07,130
or they're not<font color="#E5E5E5"> going to</font><font color="#CCCCCC"> give</font>

3
00:00:59,770 --> 00:01:06,340
well then hi yes Rodney pointed out you

4
00:01:04,690 --> 00:01:09,759
can't see a single thing from up here

5
00:01:06,340 --> 00:01:11,260
it's really really something sort<font color="#E5E5E5"> of</font>

6
00:01:09,760 --> 00:01:15,100
like standing<font color="#E5E5E5"> on the end of a runway</font>

7
00:01:11,260 --> 00:01:16,270
with 747 coming at you not that I've

8
00:01:15,100 --> 00:01:19,509
done<font color="#E5E5E5"> that but I hear it's kind of like</font>

9
00:01:16,270 --> 00:01:21,429
that anyway so<font color="#E5E5E5"> get me talk here about</font>

10
00:01:19,510 --> 00:01:24,430
security engineering what we've done for

11
00:01:21,430 --> 00:01:29,140
<font color="#CCCCCC">Windows Vista</font><font color="#E5E5E5"> a couple of things I want</font>

12
00:01:24,430 --> 00:01:30,490
to mention about<font color="#E5E5E5"> this first off I like</font>

13
00:01:29,140 --> 00:01:34,780
playing with powerpoints so you'll see

14
00:01:30,490 --> 00:01:39,250
some of<font color="#E5E5E5"> that what yeah once upon a time</font>

15
00:01:34,780 --> 00:01:41,200
I I used<font color="#E5E5E5"> to build demos for office the</font>

16
00:01:39,250 --> 00:01:42,460
technical side of<font color="#E5E5E5"> it but you have to</font>

17
00:01:41,200 --> 00:01:45,160
learn how<font color="#CCCCCC"> to use all the fancy features</font>

18
00:01:42,460 --> 00:01:46,539
so that's kind of me anyway i'll talk

19
00:01:45,160 --> 00:01:49,450
about Who I am what it is that I'm

20
00:01:46,540 --> 00:01:52,000
really<font color="#E5E5E5"> here</font><font color="#CCCCCC"> to discuss and then I'll</font>

21
00:01:49,450 --> 00:01:55,810
delve into what we did<font color="#CCCCCC"> in terms of our</font>

22
00:01:52,000 --> 00:01:58,750
view<font color="#CCCCCC"> of how to build this as securely as</font>

23
00:01:55,810 --> 00:02:00,670
possible show you sort of<font color="#E5E5E5"> an example a</font>

24
00:01:58,750 --> 00:02:03,430
case<font color="#E5E5E5"> study that</font><font color="#CCCCCC"> occurred about a year</font>

25
00:02:00,670 --> 00:02:05,140
ago and then if we actually<font color="#CCCCCC"> have any</font>

26
00:02:03,430 --> 00:02:07,209
time left and now to work running a bit

27
00:02:05,140 --> 00:02:10,509
late who knows but<font color="#CCCCCC"> I'll take questions</font>

28
00:02:07,209 --> 00:02:15,670
<font color="#CCCCCC">as best I can so start off</font><font color="#E5E5E5"> just give you</font>

29
00:02:10,508 --> 00:02:17,890
a quick heads up if you saw the Vista

30
00:02:15,670 --> 00:02:20,319
security presentation at black hat or

31
00:02:17,890 --> 00:02:22,359
hack in the<font color="#CCCCCC"> box you've already seen the</font>

32
00:02:20,319 --> 00:02:24,069
important stuff that's here there's not

33
00:02:22,360 --> 00:02:25,450
really a whole lot<font color="#CCCCCC"> of new content I've</font>

34
00:02:24,069 --> 00:02:27,700
rejiggered it a bit to make<font color="#CCCCCC"> it a bit</font>

35
00:02:25,450 --> 00:02:29,410
easier to follow everything that's going

36
00:02:27,700 --> 00:02:31,569
on but other than that it's it's not

37
00:02:29,410 --> 00:02:33,670
really new<font color="#E5E5E5"> information what we did a</font>

38
00:02:31,569 --> 00:02:37,089
year ago for Vista is basically what we

39
00:02:33,670 --> 00:02:39,220
did for Vista and I'm not really<font color="#E5E5E5"> to a</font>

40
00:02:37,090 --> 00:02:40,900
point yet where I can talk much about

41
00:02:39,220 --> 00:02:43,120
what we're<font color="#CCCCCC"> doing for future versions of</font>

42
00:02:40,900 --> 00:02:46,270
Windows cool stuff<font color="#E5E5E5"> I just can't talk</font>

43
00:02:43,120 --> 00:02:48,610
<font color="#E5E5E5">about it yet so a quick thing about</font><font color="#CCCCCC"> Who</font>

44
00:02:46,270 --> 00:02:50,440
I am I'm lead security program manager

45
00:02:48,610 --> 00:02:53,670
in the windows security assurance group

46
00:02:50,440 --> 00:02:56,560
what we do in<font color="#CCCCCC"> windows</font><font color="#E5E5E5"> security assurance</font>

47
00:02:53,670 --> 00:02:58,540
we evangelize security to<font color="#CCCCCC"> the</font>

48
00:02:56,560 --> 00:03:00,130
organization throughout windows so

49
00:02:58,540 --> 00:03:02,590
<font color="#E5E5E5">people who are developers testers</font>

50
00:03:00,130 --> 00:03:04,239
program managers to like get them to

51
00:03:02,590 --> 00:03:05,410
understand why security is important and

52
00:03:04,239 --> 00:03:07,420
what it is<font color="#E5E5E5"> that they really ought</font><font color="#CCCCCC"> to be</font>

53
00:03:05,410 --> 00:03:08,650
<font color="#E5E5E5">doing our team also does some</font>

54
00:03:07,420 --> 00:03:12,609
consultation on design and

55
00:03:08,650 --> 00:03:13,580
implementation we are training various

56
00:03:12,610 --> 00:03:15,590
<font color="#E5E5E5">people in the organization</font>

57
00:03:13,580 --> 00:03:18,140
on the attacker techniques and how to

58
00:03:15,590 --> 00:03:20,090
defend against them and we also are

59
00:03:18,140 --> 00:03:23,059
responsible for<font color="#CCCCCC"> developing and enforcing</font>

60
00:03:20,090 --> 00:03:26,690
the security policies so I joined

61
00:03:23,060 --> 00:03:28,480
<font color="#E5E5E5">Microsoft 14 years</font><font color="#CCCCCC"> ago it's</font><font color="#E5E5E5"> really hard</font>

62
00:03:26,690 --> 00:03:31,490
to<font color="#E5E5E5"> believe that it's been that long but</font>

63
00:03:28,480 --> 00:03:32,840
done stuff deployment of management

64
00:03:31,490 --> 00:03:34,280
support worked in the financial services

65
00:03:32,840 --> 00:03:35,540
group when we had a much larger

66
00:03:34,280 --> 00:03:37,640
financial services group that we do

67
00:03:35,540 --> 00:03:39,170
today done some online security since

68
00:03:37,640 --> 00:03:41,089
then and most recently<font color="#CCCCCC"> moved into</font>

69
00:03:39,170 --> 00:03:43,100
<font color="#CCCCCC">Windows security</font><font color="#E5E5E5"> you can Court of see</font>

70
00:03:41,090 --> 00:03:46,460
how the migration occurred to get me

71
00:03:43,100 --> 00:03:48,079
where I am so I just want<font color="#CCCCCC"> to</font><font color="#E5E5E5"> make</font><font color="#CCCCCC"> it</font>

72
00:03:46,460 --> 00:03:50,660
clear i'm going to talk about what we

73
00:03:48,080 --> 00:03:52,370
did in vista the security engineering

74
00:03:50,660 --> 00:03:55,790
activities some of our security

75
00:03:52,370 --> 00:03:57,290
initiatives also want to get feedback<font color="#E5E5E5"> on</font>

76
00:03:55,790 --> 00:03:59,420
things<font color="#E5E5E5"> that we ought to be</font><font color="#CCCCCC"> doing better</font>

77
00:03:57,290 --> 00:04:01,220
<font color="#CCCCCC">i want</font><font color="#E5E5E5"> to make it very clear though that</font>

78
00:03:59,420 --> 00:04:03,769
<font color="#E5E5E5">i'm not here to talk about security</font>

79
00:04:01,220 --> 00:04:08,300
features so stuff like BitLocker TPM

80
00:04:03,770 --> 00:04:11,450
integration even the details of some of

81
00:04:08,300 --> 00:04:14,420
the fancier security features<font color="#E5E5E5"> are just</font>

82
00:04:11,450 --> 00:04:16,579
not part of what<font color="#E5E5E5"> this is about so it's</font>

83
00:04:14,420 --> 00:04:20,959
more about our design philosophies and

84
00:04:16,579 --> 00:04:23,510
how we we did the engineering so in

85
00:04:20,959 --> 00:04:25,280
talking about<font color="#E5E5E5"> this we basically started</font>

86
00:04:23,510 --> 00:04:27,590
with what we had done for the security

87
00:04:25,280 --> 00:04:31,280
<font color="#E5E5E5">development life cycle for XP sp2 and</font>

88
00:04:27,590 --> 00:04:33,229
then we had a series<font color="#CCCCCC"> of goals we wanted</font>

89
00:04:31,280 --> 00:04:35,659
<font color="#CCCCCC">to apply least</font><font color="#E5E5E5"> privileged throughout the</font>

90
00:04:33,230 --> 00:04:37,070
architecture this is stuff that actually

91
00:04:35,660 --> 00:04:40,610
rodney<font color="#E5E5E5"> was talking about where you've</font>

92
00:04:37,070 --> 00:04:42,950
got anything<font color="#CCCCCC"> that you</font><font color="#E5E5E5"> don't need to be</font>

93
00:04:40,610 --> 00:04:45,680
running but you have running is a

94
00:04:42,950 --> 00:04:48,580
potential place for something to be used

95
00:04:45,680 --> 00:04:50,960
<font color="#E5E5E5">by an attacker because codes not perfect</font>

96
00:04:48,580 --> 00:04:52,340
you see where this all leads if you

97
00:04:50,960 --> 00:04:54,039
don't need<font color="#CCCCCC"> it</font><font color="#E5E5E5"> why should it be there</font>

98
00:04:52,340 --> 00:04:56,510
that's kind of what we<font color="#E5E5E5"> were looking at</font>

99
00:04:54,040 --> 00:05:00,320
we wanted to automate as much as

100
00:04:56,510 --> 00:05:02,150
possible we also wanted<font color="#CCCCCC"> to take security</font>

101
00:05:00,320 --> 00:05:04,070
expertise throughout the industry and

102
00:05:02,150 --> 00:05:05,960
apply it as methodically as we could on

103
00:05:04,070 --> 00:05:08,030
the<font color="#E5E5E5"> operating system as a whole and then</font>

104
00:05:05,960 --> 00:05:10,130
do<font color="#CCCCCC"> some other defense and depth kind of</font>

105
00:05:08,030 --> 00:05:12,770
things those<font color="#CCCCCC"> are fun but we'll talk</font>

106
00:05:10,130 --> 00:05:15,440
<font color="#E5E5E5">about those last so the idea really is</font>

107
00:05:12,770 --> 00:05:17,900
we wanted to stop playing whack Amole

108
00:05:15,440 --> 00:05:21,560
where we keep<font color="#E5E5E5"> coming out with these big</font>

109
00:05:17,900 --> 00:05:24,229
piles of patches once a month and by the

110
00:05:21,560 --> 00:05:26,930
<font color="#E5E5E5">way before</font><font color="#CCCCCC"> I go any further I should</font>

111
00:05:24,229 --> 00:05:28,820
point out whack-a-mole actually has no<font color="#CCCCCC"> k</font>

112
00:05:26,930 --> 00:05:30,229
I looked this up on<font color="#CCCCCC"> the internet and</font>

113
00:05:28,820 --> 00:05:33,110
since it's on the internet it must be

114
00:05:30,229 --> 00:05:34,699
true therefore there<font color="#E5E5E5"> is no k on this</font>

115
00:05:33,110 --> 00:05:39,949
slide it's apparently a trademark

116
00:05:34,699 --> 00:05:43,070
without a<font color="#E5E5E5"> k so the office</font><font color="#CCCCCC"> spellchecker</font>

117
00:05:39,949 --> 00:05:46,389
did not know that but<font color="#E5E5E5"> look I figure if</font>

118
00:05:43,070 --> 00:05:49,940
it's on wikipedia it's got to be right

119
00:05:46,389 --> 00:05:54,190
so let's start<font color="#E5E5E5"> by talking about the the</font>

120
00:05:49,940 --> 00:05:58,310
least<font color="#CCCCCC"> privileged stuff the idea</font><font color="#E5E5E5"> here is</font>

121
00:05:54,190 --> 00:06:00,740
if you've got programs that are running

122
00:05:58,310 --> 00:06:02,150
in situations like go I don't know

123
00:06:00,740 --> 00:06:05,509
<font color="#E5E5E5">you're running a system you're running</font>

124
00:06:02,150 --> 00:06:08,630
as admin it compromised in that bit<font color="#CCCCCC"> of</font>

125
00:06:05,509 --> 00:06:11,449
code means you own the box that's kind

126
00:06:08,630 --> 00:06:13,669
of bad so what we want<font color="#E5E5E5"> to do is try</font><font color="#CCCCCC"> and</font>

127
00:06:11,449 --> 00:06:15,080
<font color="#E5E5E5">make</font><font color="#CCCCCC"> sure that if you don't have to be</font>

128
00:06:13,669 --> 00:06:18,049
system if<font color="#E5E5E5"> you don't have to be</font>

129
00:06:15,080 --> 00:06:19,609
administrator don't do it means that if

130
00:06:18,050 --> 00:06:22,310
that particular<font color="#E5E5E5"> piece</font><font color="#CCCCCC"> of code gets</font>

131
00:06:19,610 --> 00:06:25,120
compromised you're not going to be quite

132
00:06:22,310 --> 00:06:27,020
as bad off as you<font color="#CCCCCC"> otherwise might be so</font>

133
00:06:25,120 --> 00:06:28,910
first couple<font color="#E5E5E5"> of things we did with that</font>

134
00:06:27,020 --> 00:06:31,520
was to<font color="#E5E5E5"> try and make</font><font color="#CCCCCC"> it so that people</font>

135
00:06:28,910 --> 00:06:33,620
could actually use standard user as

136
00:06:31,520 --> 00:06:36,198
their regular everyday kind of

137
00:06:33,620 --> 00:06:37,960
environment this has been<font color="#E5E5E5"> something</font>

138
00:06:36,199 --> 00:06:41,389
that's been a complaint<font color="#E5E5E5"> for a long time</font>

139
00:06:37,960 --> 00:06:43,760
<font color="#E5E5E5">we talked about this way back in</font><font color="#CCCCCC"> the NT</font>

140
00:06:41,389 --> 00:06:45,560
31 there was this concept of standard

141
00:06:43,760 --> 00:06:49,310
user and it was great you couldn't do

142
00:06:45,560 --> 00:06:50,870
anything<font color="#E5E5E5"> so we're trying to make it so</font>

143
00:06:49,310 --> 00:06:53,000
that<font color="#E5E5E5"> it's something more useful for a</font>

144
00:06:50,870 --> 00:06:56,240
standard user to live in and even

145
00:06:53,000 --> 00:06:58,120
administrators if you really<font color="#CCCCCC"> need to</font><font color="#E5E5E5"> do</font>

146
00:06:56,240 --> 00:07:00,620
the heavy duty administrator stuff

147
00:06:58,120 --> 00:07:03,440
that's something<font color="#CCCCCC"> that should</font><font color="#E5E5E5"> only happen</font>

148
00:07:00,620 --> 00:07:05,539
when you need it so those two were

149
00:07:03,440 --> 00:07:07,880
really the impetus behind<font color="#CCCCCC"> a user account</font>

150
00:07:05,539 --> 00:07:09,380
control that's what it's<font color="#E5E5E5"> about it's not</font>

151
00:07:07,880 --> 00:07:11,449
really so much a security feature in and

152
00:07:09,380 --> 00:07:13,849
of itself as it is a means of allowing

153
00:07:11,449 --> 00:07:17,330
you<font color="#CCCCCC"> to run with fewer privileges than</font>

154
00:07:13,849 --> 00:07:19,460
you otherwise might also did some stuff

155
00:07:17,330 --> 00:07:21,500
with<font color="#CCCCCC"> Internet Explorer to be able</font><font color="#E5E5E5"> to run</font>

156
00:07:19,460 --> 00:07:24,349
<font color="#E5E5E5">anymore restricted environment so that</font>

157
00:07:21,500 --> 00:07:27,110
it basically virtualizes a lot of the

158
00:07:24,349 --> 00:07:29,150
operating system so an attacker that

159
00:07:27,110 --> 00:07:34,280
<font color="#E5E5E5">attacks that really attacks a little</font>

160
00:07:29,150 --> 00:07:37,070
sandbox then we went to harden some

161
00:07:34,280 --> 00:07:38,539
services again just<font color="#E5E5E5"> like it is with</font>

162
00:07:37,070 --> 00:07:40,039
running the applications of least

163
00:07:38,539 --> 00:07:40,490
privilege you want to run the services

164
00:07:40,039 --> 00:07:41,650
with

165
00:07:40,490 --> 00:07:44,180
only the privileges that are necessary

166
00:07:41,650 --> 00:07:47,090
so in order to do that we needed to

167
00:07:44,180 --> 00:07:49,069
<font color="#E5E5E5">define what</font><font color="#CCCCCC"> those restrictions were that</font>

168
00:07:47,090 --> 00:07:51,080
way you can be able to come back and

169
00:07:49,069 --> 00:07:54,080
test does it actually work the way you

170
00:07:51,080 --> 00:07:57,409
were expecting it to and what was the

171
00:07:54,080 --> 00:07:59,599
<font color="#E5E5E5">the small space that you needed so let</font>

172
00:07:57,410 --> 00:08:02,930
me drill a bit more into this idea<font color="#E5E5E5"> of of</font>

173
00:07:59,599 --> 00:08:05,210
hardening the services we spent time on

174
00:08:02,930 --> 00:08:08,720
this because services are fun for

175
00:08:05,210 --> 00:08:10,159
attackers<font color="#CCCCCC"> SAS or blaster slammer there's</font>

176
00:08:08,720 --> 00:08:12,710
a lot<font color="#CCCCCC"> of birds on the end of these do</font>

177
00:08:10,160 --> 00:08:19,970
you<font color="#E5E5E5"> notice what is it about worms and</font>

178
00:08:12,710 --> 00:08:30,729
<font color="#CCCCCC">earth ah how that then that must mix up</font>

179
00:08:19,970 --> 00:08:33,050
<font color="#CCCCCC">oh so they're rough that's good uh</font>

180
00:08:30,729 --> 00:08:34,939
they're great<font color="#E5E5E5"> because a service is great</font>

181
00:08:33,049 --> 00:08:36,679
because the<font color="#CCCCCC"> machines on is plugged</font><font color="#E5E5E5"> into</font>

182
00:08:34,940 --> 00:08:38,899
<font color="#E5E5E5">the network like so many people do at</font>

183
00:08:36,679 --> 00:08:40,010
home and at work and whatever and maybe

184
00:08:38,899 --> 00:08:41,000
<font color="#E5E5E5">they're working on the machine maybe</font>

185
00:08:40,010 --> 00:08:43,159
they're not<font color="#E5E5E5"> but the things on</font>

186
00:08:41,000 --> 00:08:45,190
twenty-four/seven services are on

187
00:08:43,159 --> 00:08:48,680
twenty-four/seven services are fun

188
00:08:45,190 --> 00:08:50,420
usually in they tend<font color="#E5E5E5"> to run in these</font>

189
00:08:48,680 --> 00:08:52,130
elevated identities most of these

190
00:08:50,420 --> 00:08:55,910
services of historically run a system

191
00:08:52,130 --> 00:08:58,010
<font color="#E5E5E5">yum and of course you know worms like</font>

192
00:08:55,910 --> 00:09:00,110
that they can do things<font color="#E5E5E5"> like altering</font>

193
00:08:58,010 --> 00:09:01,459
the OS they can open<font color="#CCCCCC"> whatever</font>

194
00:09:00,110 --> 00:09:03,050
connections they want to be able<font color="#E5E5E5"> to</font>

195
00:09:01,459 --> 00:09:06,290
spread themselves throughout the network

196
00:09:03,050 --> 00:09:08,240
and so obviously<font color="#CCCCCC"> if you can stop all of</font>

197
00:09:06,290 --> 00:09:10,099
<font color="#E5E5E5">that that's a pretty good defense</font>

198
00:09:08,240 --> 00:09:13,130
against a lot<font color="#E5E5E5"> of the attacks that have</font>

199
00:09:10,100 --> 00:09:17,060
been used<font color="#E5E5E5"> in</font><font color="#CCCCCC"> the past so we wanted to</font>

200
00:09:13,130 --> 00:09:19,100
get services to stop being system so<font color="#CCCCCC"> we</font>

201
00:09:17,060 --> 00:09:21,529
have local service we have network

202
00:09:19,100 --> 00:09:23,180
service they're not members of

203
00:09:21,529 --> 00:09:24,850
administrators so they can't do the

204
00:09:23,180 --> 00:09:27,260
kinds of things that admins can do

205
00:09:24,850 --> 00:09:29,660
they're denied the most powerful

206
00:09:27,260 --> 00:09:32,779
privileges<font color="#E5E5E5"> SE debe satc be that sort of</font>

207
00:09:29,660 --> 00:09:34,640
stuff so they're much more restricted

208
00:09:32,779 --> 00:09:38,810
than anything that historically would

209
00:09:34,640 --> 00:09:41,089
have been running as system so a bunch

210
00:09:38,810 --> 00:09:43,040
<font color="#E5E5E5">of these services in XP sp2 that we're</font>

211
00:09:41,089 --> 00:09:45,620
running<font color="#CCCCCC"> a system some of them were moved</font>

212
00:09:43,040 --> 00:09:48,140
to local service windows audio<font color="#CCCCCC"> dhcp etc</font>

213
00:09:45,620 --> 00:09:49,579
etc etc we had a different set that<font color="#E5E5E5"> were</font>

214
00:09:48,140 --> 00:09:50,930
<font color="#E5E5E5">moved to network service those are the</font>

215
00:09:49,579 --> 00:09:53,569
ones that well you would expect<font color="#E5E5E5"> to be</font>

216
00:09:50,930 --> 00:09:55,699
connecting to the network not a surprise

217
00:09:53,570 --> 00:09:59,630
of course<font color="#CCCCCC"> Vista has</font><font color="#E5E5E5"> a bunch of new</font>

218
00:09:55,700 --> 00:10:02,390
services so forty-eight percent of those

219
00:09:59,630 --> 00:10:05,120
are also going to be<font color="#E5E5E5"> running in a low</font>

220
00:10:02,390 --> 00:10:06,920
privileged account in vista if they were

221
00:10:05,120 --> 00:10:08,990
having to run as system they actually

222
00:10:06,920 --> 00:10:10,310
did have to justify why they needed<font color="#CCCCCC"> to</font>

223
00:10:08,990 --> 00:10:15,560
have those sorts of elevated privileges

224
00:10:10,310 --> 00:10:19,550
that was part of our<font color="#E5E5E5"> enforcement effort</font>

225
00:10:15,560 --> 00:10:21,949
on our<font color="#E5E5E5"> team</font><font color="#CCCCCC"> so some of what we started</font>

226
00:10:19,550 --> 00:10:26,089
to do is have a specific service sins

227
00:10:21,950 --> 00:10:28,430
and so that way you can<font color="#CCCCCC"> you can akal</font>

228
00:10:26,090 --> 00:10:30,560
down the various objects so that they

229
00:10:28,430 --> 00:10:31,760
apply to<font color="#CCCCCC"> a particular service they're</font>

230
00:10:30,560 --> 00:10:35,119
owned by that<font color="#E5E5E5"> service and</font><font color="#CCCCCC"> only</font>

231
00:10:31,760 --> 00:10:37,550
accessible to that service nice thing<font color="#E5E5E5"> is</font>

232
00:10:35,120 --> 00:10:38,840
<font color="#E5E5E5">it's integrated into the existing api's</font>

233
00:10:37,550 --> 00:10:41,270
the look of<font color="#CCCCCC"> accounts said look up</font>

234
00:10:38,840 --> 00:10:42,980
account name so it didn't require

235
00:10:41,270 --> 00:10:46,340
substantial new work to be able<font color="#CCCCCC"> to</font>

236
00:10:42,980 --> 00:10:49,280
implement it this is sort of an<font color="#E5E5E5"> example</font>

237
00:10:46,340 --> 00:10:51,950
of one of<font color="#E5E5E5"> them turns out to be a Crip</font>

238
00:10:49,280 --> 00:10:53,920
service the fun thing about it you

239
00:10:51,950 --> 00:10:55,880
<font color="#E5E5E5">notice how long the</font><font color="#CCCCCC"> Cid's have gotten</font>

240
00:10:53,920 --> 00:11:00,579
compare<font color="#CCCCCC"> that to what they look like in</font>

241
00:10:55,880 --> 00:11:00,580
<font color="#CCCCCC">NT 31 just</font><font color="#E5E5E5"> for what it's worth</font>

242
00:11:00,940 --> 00:11:06,230
eventually they're going to<font color="#E5E5E5"> get too long</font>

243
00:11:02,780 --> 00:11:07,910
to<font color="#CCCCCC"> fit on a slide it's getting there we</font>

244
00:11:06,230 --> 00:11:09,530
also wanted to just eliminate all<font color="#CCCCCC"> the</font>

245
00:11:07,910 --> 00:11:12,319
unnecessary privileges<font color="#E5E5E5"> altogether as i</font>

246
00:11:09,530 --> 00:11:13,550
mentioned before so we said if you're

247
00:11:12,320 --> 00:11:15,020
<font color="#E5E5E5">going</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> have a service</font><font color="#CCCCCC"> you have to</font>

248
00:11:13,550 --> 00:11:18,500
enumerate what the privileges are that

249
00:11:15,020 --> 00:11:20,600
you need and<font color="#CCCCCC"> so this is an opt-in kind</font>

250
00:11:18,500 --> 00:11:22,400
of an approach if you don't say you need

251
00:11:20,600 --> 00:11:25,700
it<font color="#E5E5E5"> you don't get</font><font color="#CCCCCC"> it if you don't get it</font>

252
00:11:22,400 --> 00:11:28,240
you don't have<font color="#E5E5E5"> access to it so now what</font>

253
00:11:25,700 --> 00:11:30,680
happens then is<font color="#E5E5E5"> if you happen to have a</font>

254
00:11:28,240 --> 00:11:33,620
single service that's got multiple

255
00:11:30,680 --> 00:11:35,180
processes in it it takes sorry the other

256
00:11:33,620 --> 00:11:36,920
way around<font color="#E5E5E5"> single process that has</font>

257
00:11:35,180 --> 00:11:39,589
multiple services in it you get<font color="#CCCCCC"> a case</font>

258
00:11:36,920 --> 00:11:42,589
where it takes the union of all of the

259
00:11:39,590 --> 00:11:46,810
privileges<font color="#E5E5E5"> and that is what the process</font>

260
00:11:42,590 --> 00:11:50,090
gifts as its as its privileged set so

261
00:11:46,810 --> 00:11:52,760
<font color="#E5E5E5">needless to say we wanted</font><font color="#CCCCCC"> to have as few</font>

262
00:11:50,090 --> 00:11:54,830
processes as possible lots of processes

263
00:11:52,760 --> 00:11:58,910
makes a lot of complicated stuff and IPC

264
00:11:54,830 --> 00:12:00,260
more stuff to manage and also at the

265
00:11:58,910 --> 00:12:02,329
same time we didn't want it so that you

266
00:12:00,260 --> 00:12:03,710
had a single process that had all<font color="#E5E5E5"> the</font>

267
00:12:02,330 --> 00:12:05,630
services in it and so all of a sudden

268
00:12:03,710 --> 00:12:06,950
<font color="#CCCCCC">that looks like local system even</font><font color="#E5E5E5"> though</font>

269
00:12:05,630 --> 00:12:09,680
it wasn't<font color="#CCCCCC"> supposed</font><font color="#E5E5E5"> to be</font>

270
00:12:06,950 --> 00:12:12,110
so basically we had a balancing act

271
00:12:09,680 --> 00:12:13,729
there that we were working on but this

272
00:12:12,110 --> 00:12:16,880
is kind of what it looks like when

273
00:12:13,730 --> 00:12:19,460
you're enumerated what it is that you

274
00:12:16,880 --> 00:12:22,939
<font color="#CCCCCC">need we looked through those and we</font>

275
00:12:19,460 --> 00:12:24,560
found a few consistent themes and so

276
00:12:22,940 --> 00:12:26,900
because<font color="#CCCCCC"> we found</font><font color="#E5E5E5"> these themes we were</font>

277
00:12:24,560 --> 00:12:33,709
able to<font color="#E5E5E5"> group a bunch of similar sorts</font>

278
00:12:26,900 --> 00:12:36,290
of services into single processes I'll

279
00:12:33,710 --> 00:12:38,870
mention<font color="#E5E5E5"> that actually the next slide but</font>

280
00:12:36,290 --> 00:12:42,319
the gist here also is if you're going<font color="#E5E5E5"> to</font>

281
00:12:38,870 --> 00:12:44,380
be having network access you say what

282
00:12:42,320 --> 00:12:47,210
ports you need what directions you need

283
00:12:44,380 --> 00:12:49,880
the nice thing<font color="#CCCCCC"> about that is if you have</font>

284
00:12:47,210 --> 00:12:51,830
<font color="#E5E5E5">vulnerability and you happen to be a</font>

285
00:12:49,880 --> 00:12:54,250
service that uses port<font color="#E5E5E5"> one two three</font>

286
00:12:51,830 --> 00:12:56,810
that's not going to be accessible

287
00:12:54,250 --> 00:12:59,870
through port 80 so it's not<font color="#E5E5E5"> going to be</font>

288
00:12:56,810 --> 00:13:02,719
able to be reused<font color="#E5E5E5"> to do HTTP connections</font>

289
00:12:59,870 --> 00:13:05,420
elsewhere the firewall actually does<font color="#CCCCCC"> the</font>

290
00:13:02,720 --> 00:13:07,400
enforcement of this so this is<font color="#CCCCCC"> the</font>

291
00:13:05,420 --> 00:13:10,490
grouping that i was talking about<font color="#E5E5E5"> um so</font>

292
00:13:07,400 --> 00:13:13,760
you can see there's a<font color="#E5E5E5"> six of the primary</font>

293
00:13:10,490 --> 00:13:15,380
ones this basically covers the vast

294
00:13:13,760 --> 00:13:17,569
majority of the services that<font color="#CCCCCC"> exist in</font>

295
00:13:15,380 --> 00:13:19,370
the OS so you're not actually going to

296
00:13:17,570 --> 00:13:21,980
see a<font color="#E5E5E5"> whole lot of service hosts running</font>

297
00:13:19,370 --> 00:13:25,340
you will see<font color="#E5E5E5"> more than you had in XP sp2</font>

298
00:13:21,980 --> 00:13:28,340
but it's not by you know fifty or

299
00:13:25,340 --> 00:13:29,870
hundred or anything of that sort so we

300
00:13:28,340 --> 00:13:31,220
were able<font color="#E5E5E5"> to group them together and</font>

301
00:13:29,870 --> 00:13:34,370
reduce the total number of service hosts

302
00:13:31,220 --> 00:13:36,290
that<font color="#E5E5E5"> had to be running and not a whole</font>

303
00:13:34,370 --> 00:13:39,800
<font color="#CCCCCC">lot else to say there other than you can</font>

304
00:13:36,290 --> 00:13:41,930
see where this leads so take a look for

305
00:13:39,800 --> 00:13:45,500
example it at what happened with dhcp

306
00:13:41,930 --> 00:13:50,630
client in XP sp2 that was running<font color="#CCCCCC"> a</font>

307
00:13:45,500 --> 00:13:52,300
system had 24 privileges it was it had a

308
00:13:50,630 --> 00:13:54,920
network identity as a machine account

309
00:13:52,300 --> 00:13:57,020
which is<font color="#E5E5E5"> kind of</font><font color="#CCCCCC"> cool because then you</font>

310
00:13:54,920 --> 00:13:58,339
can identify yourself as this machine

311
00:13:57,020 --> 00:13:59,990
and do all<font color="#CCCCCC"> sorts of things that</font><font color="#E5E5E5"> you</font>

312
00:13:58,340 --> 00:14:02,750
otherwise shouldn't be able<font color="#E5E5E5"> to do with</font>

313
00:13:59,990 --> 00:14:06,200
<font color="#E5E5E5">something</font><font color="#CCCCCC"> like dhcp client could use any</font>

314
00:14:02,750 --> 00:14:08,390
port you wanted and it wasn't<font color="#E5E5E5"> it wasn't</font>

315
00:14:06,200 --> 00:14:10,250
locked down<font color="#E5E5E5"> with the service said so we</font>

316
00:14:08,390 --> 00:14:12,319
changed all of that stuff in vista it's

317
00:14:10,250 --> 00:14:14,210
now running as local service<font color="#E5E5E5"> only has</font>

318
00:14:12,320 --> 00:14:18,080
four privileges<font color="#E5E5E5"> no identity whatsoever</font>

319
00:14:14,210 --> 00:14:20,100
on the<font color="#E5E5E5"> network only uses the DHCP port</font>

320
00:14:18,080 --> 00:14:22,040
and it

321
00:14:20,100 --> 00:14:25,500
is<font color="#E5E5E5"> locked down while the service said</font>

322
00:14:22,040 --> 00:14:27,750
much<font color="#E5E5E5"> more restricted than what we had</font>

323
00:14:25,500 --> 00:14:31,819
before<font color="#E5E5E5"> and therefore much less that you</font>

324
00:14:27,750 --> 00:14:35,430
can do in the way of damage so

325
00:14:31,819 --> 00:14:39,240
automation automation is great love

326
00:14:35,430 --> 00:14:41,790
automation because let's face it<font color="#CCCCCC"> you</font>

327
00:14:39,240 --> 00:14:45,750
don't<font color="#E5E5E5"> want to go around having humans</font>

328
00:14:41,790 --> 00:14:47,430
doing machines jobs show you kind<font color="#E5E5E5"> of</font>

329
00:14:45,750 --> 00:14:49,589
some of this stuff<font color="#CCCCCC"> that we did here in</font>

330
00:14:47,430 --> 00:14:53,880
terms of code analysis<font color="#E5E5E5"> you've got a case</font>

331
00:14:49,589 --> 00:14:58,139
here code with<font color="#E5E5E5"> buffer x equals 5 so if</font>

332
00:14:53,880 --> 00:15:03,269
you're given that how big is<font color="#E5E5E5"> buff what's</font>

333
00:14:58,139 --> 00:15:04,949
<font color="#CCCCCC">the value of x t trick question it's a</font>

334
00:15:03,269 --> 00:15:07,130
trick question that's<font color="#E5E5E5"> the point you</font>

335
00:15:04,949 --> 00:15:09,899
can't tell based on what you're given

336
00:15:07,130 --> 00:15:12,870
what the the size of buff is what the

337
00:15:09,899 --> 00:15:16,500
value of x is there's not a formal

338
00:15:12,870 --> 00:15:18,800
association in C and C++ very powerful

339
00:15:16,500 --> 00:15:20,610
very dangerous<font color="#E5E5E5"> use or to go around with</font>

340
00:15:18,800 --> 00:15:25,079
walking the tightrope without a net

341
00:15:20,610 --> 00:15:27,000
underneath so I Sal was produced to help

342
00:15:25,079 --> 00:15:28,729
address this it's kind<font color="#E5E5E5"> of like what</font>

343
00:15:27,000 --> 00:15:31,339
it'll does for our<font color="#E5E5E5"> PC it gives you</font>

344
00:15:28,730 --> 00:15:35,149
definitions that you can<font color="#E5E5E5"> establish there</font>

345
00:15:31,339 --> 00:15:38,910
to basically set up contracts so that

346
00:15:35,149 --> 00:15:40,470
code that calls you is is able to

347
00:15:38,910 --> 00:15:42,899
determine what sizes the buffers are

348
00:15:40,470 --> 00:15:44,730
supposed to be that that<font color="#E5E5E5"> sort of thing</font>

349
00:15:42,899 --> 00:15:47,100
who's basically so that we could do a

350
00:15:44,730 --> 00:15:51,930
static type analysis on code to find

351
00:15:47,100 --> 00:15:56,810
buffer overruns<font color="#CCCCCC"> so here's simple sample</font>

352
00:15:51,930 --> 00:16:00,239
code to show you how it works fairly

353
00:15:56,810 --> 00:16:03,300
straightforward stuff setting up the

354
00:16:00,240 --> 00:16:05,009
buffers we got ourselves a pointer and

355
00:16:03,300 --> 00:16:08,339
got the function<font color="#CCCCCC"> that writes that many</font>

356
00:16:05,009 --> 00:16:10,860
characters to buff thing is of course<font color="#E5E5E5"> of</font>

357
00:16:08,339 --> 00:16:12,240
cch buff is greater than size of buff

358
00:16:10,860 --> 00:16:14,389
you're going to walk<font color="#E5E5E5"> off the</font><font color="#CCCCCC"> end of buff</font>

359
00:16:12,240 --> 00:16:17,040
and you've got yourself a buffer overrun

360
00:16:14,389 --> 00:16:20,579
this is about as simple as it gets right

361
00:16:17,040 --> 00:16:22,740
so you go in<font color="#E5E5E5"> and put in some</font><font color="#CCCCCC"> Sal</font>

362
00:16:20,579 --> 00:16:24,620
lamentation in front of it now what

363
00:16:22,740 --> 00:16:27,509
<font color="#E5E5E5">you're saying is this is going to be</font>

364
00:16:24,620 --> 00:16:31,319
written to this particular buffer here

365
00:16:27,509 --> 00:16:32,660
and it's<font color="#E5E5E5"> not going to be no it's a size</font>

366
00:16:31,319 --> 00:16:35,029
of

367
00:16:32,660 --> 00:16:37,759
an element if that's your<font color="#CCCCCC"> data type</font>

368
00:16:35,029 --> 00:16:40,430
there and how many elements in size is

369
00:16:37,759 --> 00:16:43,129
going to be so once you've established

370
00:16:40,430 --> 00:16:45,019
that then when you've got code that does

371
00:16:43,129 --> 00:16:48,050
something<font color="#E5E5E5"> really ugly like this where</font>

372
00:16:45,019 --> 00:16:50,959
you allocate 200 and you try<font color="#CCCCCC"> and stuff</font>

373
00:16:48,050 --> 00:16:53,089
210 characters into it needless to say

374
00:16:50,959 --> 00:16:55,219
you've got<font color="#E5E5E5"> yourself a nice a</font><font color="#CCCCCC"> little</font>

375
00:16:53,089 --> 00:16:58,490
buffer<font color="#E5E5E5"> overrun their bad stuff can</font>

376
00:16:55,220 --> 00:17:01,689
happen who knows what we all know but

377
00:16:58,490 --> 00:17:04,130
anyway if you try and compile this now

378
00:17:01,689 --> 00:17:05,329
because of cell lamentation you're going

379
00:17:04,130 --> 00:17:07,459
to get a warning<font color="#E5E5E5"> here that you've got a</font>

380
00:17:05,329 --> 00:17:09,049
potential buffer overrun it's<font color="#CCCCCC"> supposed</font>

381
00:17:07,459 --> 00:17:12,140
to<font color="#E5E5E5"> be</font><font color="#CCCCCC"> two hundred</font><font color="#E5E5E5"> times two bites but</font>

382
00:17:09,049 --> 00:17:15,168
you might shove 420 in there it's also

383
00:17:12,140 --> 00:17:18,260
possible that you would not fill it at

384
00:17:15,169 --> 00:17:22,819
all you might have no<font color="#CCCCCC"> to bad things that</font>

385
00:17:18,260 --> 00:17:26,689
<font color="#E5E5E5">are bad together so that's how it works</font>

386
00:17:22,819 --> 00:17:28,428
here<font color="#CCCCCC"> now in the real world I don't know</font>

387
00:17:26,689 --> 00:17:32,090
how<font color="#CCCCCC"> many of</font><font color="#E5E5E5"> you remember this it's now</font>

388
00:17:28,429 --> 00:17:34,159
been<font color="#E5E5E5"> over a year but it was this lovely</font>

389
00:17:32,090 --> 00:17:35,928
advisory about the BG sound where you

390
00:17:34,159 --> 00:17:42,500
put in a really really long file name

391
00:17:35,929 --> 00:17:45,559
and the workaround was pretty nice yeah

392
00:17:42,500 --> 00:17:48,470
we weren't<font color="#E5E5E5"> really happy when that was</font>

393
00:17:45,559 --> 00:17:52,700
the official workaround for this<font color="#E5E5E5"> Mabel</font>

394
00:17:48,470 --> 00:17:56,570
asst to say uh so here's the code that

395
00:17:52,700 --> 00:17:59,570
<font color="#CCCCCC">had the problem and of course</font><font color="#E5E5E5"> you know</font>

396
00:17:56,570 --> 00:18:04,668
there's your buffer overrun it's<font color="#E5E5E5"> really</font>

397
00:17:59,570 --> 00:18:06,408
obvious right yeah well<font color="#CCCCCC"> okay so let's</font>

398
00:18:04,669 --> 00:18:09,020
let's take a look<font color="#E5E5E5"> at really how this all</font>

399
00:18:06,409 --> 00:18:13,100
comes together when you<font color="#E5E5E5"> put it with pre</font>

400
00:18:09,020 --> 00:18:16,429
fast and cell so we've got our two

401
00:18:13,100 --> 00:18:21,770
snippets of code here and actually we

402
00:18:16,429 --> 00:18:24,530
got you'll notice<font color="#E5E5E5"> on November 24th we</font>

403
00:18:21,770 --> 00:18:26,030
had a bug opened by pre fast yes that

404
00:18:24,530 --> 00:18:27,980
was before<font color="#E5E5E5"> the advisory went out I just</font>

405
00:18:26,030 --> 00:18:30,889
want<font color="#CCCCCC"> to mention that it was however</font>

406
00:18:27,980 --> 00:18:32,870
after the code went out what's pretty

407
00:18:30,890 --> 00:18:36,020
fast real fast as the is the code

408
00:18:32,870 --> 00:18:37,699
analysis tool sorry that it yeah if I

409
00:18:36,020 --> 00:18:39,889
never meant that yeah ok Reeve Asus code

410
00:18:37,700 --> 00:18:43,340
analysis tool it<font color="#E5E5E5"> basically goes through</font>

411
00:18:39,890 --> 00:18:45,590
and looks for bugs of this sort we have

412
00:18:43,340 --> 00:18:47,809
a series of rules in there that

413
00:18:45,590 --> 00:18:50,779
come from various vulnerabilities that

414
00:18:47,809 --> 00:18:53,960
were found in the past<font color="#E5E5E5"> and those rules</font>

415
00:18:50,779 --> 00:18:56,059
<font color="#E5E5E5">are designed to look at situations that</font>

416
00:18:53,960 --> 00:18:57,650
are similar<font color="#CCCCCC"> to the vulnerabilities that</font>

417
00:18:56,059 --> 00:18:59,870
have been found<font color="#E5E5E5"> in the past</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> find</font>

418
00:18:57,650 --> 00:19:01,429
them elsewhere in the code so we<font color="#E5E5E5"> have</font>

419
00:18:59,870 --> 00:19:03,799
little spiders running through the code

420
00:19:01,429 --> 00:19:07,220
looking for similar situations and they

421
00:19:03,799 --> 00:19:09,320
go give us these alerts so<font color="#E5E5E5"> November 24th</font>

422
00:19:07,220 --> 00:19:12,230
of 2005 550 in the morning isn't that

423
00:19:09,320 --> 00:19:15,678
like Thanksgiving<font color="#CCCCCC"> got that we're working</font>

424
00:19:12,230 --> 00:19:18,380
<font color="#CCCCCC">on Thanksgiving anyway so here we</font><font color="#E5E5E5"> had</font>

425
00:19:15,679 --> 00:19:22,159
this potential overflow using the<font color="#E5E5E5"> pwc</font>

426
00:19:18,380 --> 00:19:24,100
temp path because we have this buffer

427
00:19:22,159 --> 00:19:26,899
access unbounded by the buffer size

428
00:19:24,100 --> 00:19:29,779
there was no consonant that was

429
00:19:26,899 --> 00:19:33,110
constraining the size of<font color="#CCCCCC"> cch path so</font>

430
00:19:29,779 --> 00:19:36,679
that was where our buffer overrun

431
00:19:33,110 --> 00:19:38,090
happened you'll<font color="#E5E5E5"> notice there it says</font>

432
00:19:36,679 --> 00:19:40,669
<font color="#E5E5E5">that it found that</font><font color="#CCCCCC"> the buffer was</font>

433
00:19:38,090 --> 00:19:42,379
supposed to be 260 elements that's what

434
00:19:40,669 --> 00:19:44,149
we had allocated but we have no idea

435
00:19:42,380 --> 00:19:46,820
<font color="#E5E5E5">actually what was getting stuffed into</font>

436
00:19:44,149 --> 00:19:51,049
there so someone shoves 261 in there

437
00:19:46,820 --> 00:19:53,240
tada you got a buffer overrun so here

438
00:19:51,049 --> 00:19:55,309
it's a case where you've got annotation

439
00:19:53,240 --> 00:19:57,740
that requires<font color="#CCCCCC"> that the second parameter</font>

440
00:19:55,309 --> 00:20:00,980
be of length greater than or<font color="#CCCCCC"> equal to</font>

441
00:19:57,740 --> 00:20:04,940
the parameter three elements at two

442
00:20:00,980 --> 00:20:10,070
bytes per element and parameter<font color="#E5E5E5"> 2 is the</font>

443
00:20:04,940 --> 00:20:13,070
one that's calling the pw temp path for

444
00:20:10,070 --> 00:20:16,129
its data typing so that's sort of how

445
00:20:13,070 --> 00:20:18,020
you find the<font color="#CCCCCC"> path to connect</font><font color="#E5E5E5"> all this</font>

446
00:20:16,130 --> 00:20:20,570
together and that's<font color="#E5E5E5"> really the work that</font>

447
00:20:18,020 --> 00:20:22,658
pre fast does it opens<font color="#E5E5E5"> these bugs now we</font>

448
00:20:20,570 --> 00:20:25,549
have an opportunity<font color="#E5E5E5"> then to track them</font>

449
00:20:22,659 --> 00:20:27,679
find out what the problem was fix it and

450
00:20:25,549 --> 00:20:29,960
get<font color="#E5E5E5"> it addressed before it ever hits the</font>

451
00:20:27,679 --> 00:20:33,799
streets you'll<font color="#E5E5E5"> notice this particular</font>

452
00:20:29,960 --> 00:20:39,110
case it hit the street in<font color="#E5E5E5"> a Vista beta 2</font>

453
00:20:33,799 --> 00:20:41,480
I guess it was but turns out that we did

454
00:20:39,110 --> 00:20:44,120
actually find it before it<font color="#CCCCCC"> was found on</font>

455
00:20:41,480 --> 00:20:46,960
<font color="#E5E5E5">the streets anyway the whole point</font>

456
00:20:44,120 --> 00:20:48,889
behind this is as we get these various

457
00:20:46,960 --> 00:20:51,049
vulnerabilities reported to us either

458
00:20:48,890 --> 00:20:52,970
internally or externally we're able to

459
00:20:51,049 --> 00:20:54,980
do root cause analysis on it figure<font color="#CCCCCC"> out</font>

460
00:20:52,970 --> 00:20:57,770
what did we do<font color="#CCCCCC"> wrong what did we miss if</font>

461
00:20:54,980 --> 00:20:59,149
it's a situation<font color="#CCCCCC"> that's generalizable we</font>

462
00:20:57,770 --> 00:21:01,399
can turn it into a set of rules that

463
00:20:59,149 --> 00:21:02,988
pre fast looks for in the future if it

464
00:21:01,399 --> 00:21:05,959
finds stuff like that it automatically

465
00:21:02,989 --> 00:21:07,129
logs bugs the bugs get fixed<font color="#CCCCCC"> and we</font>

466
00:21:05,960 --> 00:21:10,429
don't have<font color="#E5E5E5"> the vulnerabilities in the</font>

467
00:21:07,129 --> 00:21:12,738
wild anymore it's kind<font color="#CCCCCC"> of cool so in</font>

468
00:21:10,429 --> 00:21:17,059
this particular case<font color="#E5E5E5"> after the zotov</font>

469
00:21:12,739 --> 00:21:19,039
worm occurred pre fast had an additional

470
00:21:17,059 --> 00:21:19,940
warning added that was 2015 which was

471
00:21:19,039 --> 00:21:24,649
the one that<font color="#E5E5E5"> I mentioned</font><font color="#CCCCCC"> on the previous</font>

472
00:21:19,940 --> 00:21:26,929
slide so we set that<font color="#E5E5E5"> one to auto file</font>

473
00:21:24,649 --> 00:21:29,059
the bugs bug automatically got filed

474
00:21:26,929 --> 00:21:31,759
there on thanksgiving or whenever that

475
00:21:29,059 --> 00:21:33,830
was turns out there were a few other

476
00:21:31,759 --> 00:21:35,599
ways that<font color="#E5E5E5"> it was caught as well so the</font>

477
00:21:33,830 --> 00:21:39,199
first it was immediately caught by

478
00:21:35,599 --> 00:21:41,210
pretty fast<font color="#E5E5E5"> on that</font><font color="#CCCCCC"> November build that</font>

479
00:21:39,200 --> 00:21:43,519
was the Sal annotation it was<font color="#E5E5E5"> also found</font>

480
00:21:41,210 --> 00:21:45,889
<font color="#CCCCCC">about a week later when we were doing</font>

481
00:21:43,519 --> 00:21:48,080
some internal fuzzing yet another

482
00:21:45,889 --> 00:21:49,699
process that we go through it was also

483
00:21:48,080 --> 00:21:53,029
reported through windows error reporting

484
00:21:49,700 --> 00:21:54,710
and so basically three different ways

485
00:21:53,029 --> 00:21:57,139
<font color="#CCCCCC">that this one was caught there's</font><font color="#E5E5E5"> no</font>

486
00:21:54,710 --> 00:22:01,039
<font color="#E5E5E5">question in our mind that</font><font color="#CCCCCC"> it would have</font>

487
00:21:57,139 --> 00:22:05,689
been caught and fixed prior to rtm even

488
00:22:01,039 --> 00:22:08,450
if<font color="#E5E5E5"> that advisory had not gone out so the</font>

489
00:22:05,690 --> 00:22:11,419
<font color="#E5E5E5">idea here is we're trying</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> build this</font>

490
00:22:08,450 --> 00:22:13,339
iterative loop where we collect

491
00:22:11,419 --> 00:22:14,570
additional information figure out what

492
00:22:13,339 --> 00:22:16,519
kinds of things we've been missing and

493
00:22:14,570 --> 00:22:19,039
turn them<font color="#E5E5E5"> into processes that we can</font>

494
00:22:16,519 --> 00:22:21,379
<font color="#CCCCCC">automate</font><font color="#E5E5E5"> so that we catch those much</font>

495
00:22:19,039 --> 00:22:24,129
more quickly and<font color="#E5E5E5"> easily in the future</font>

496
00:22:21,379 --> 00:22:26,748
it's a lot less expensive<font color="#CCCCCC"> than hiring</font>

497
00:22:24,129 --> 00:22:28,998
hundreds of thousands of people not to

498
00:22:26,749 --> 00:22:32,960
mention<font color="#CCCCCC"> it's hard to</font><font color="#E5E5E5"> find people who do</font>

499
00:22:28,999 --> 00:22:37,029
this stuff the other thing<font color="#CCCCCC"> is then we've</font>

500
00:22:32,960 --> 00:22:41,289
had<font color="#E5E5E5"> file parsers have been under</font><font color="#CCCCCC"> attack</font>

501
00:22:37,029 --> 00:22:45,080
you'll<font color="#E5E5E5"> notice we had a few over those</font>

502
00:22:41,289 --> 00:22:48,049
about<font color="#E5E5E5"> a year and change of these file</font>

503
00:22:45,080 --> 00:22:49,460
parsers that were attacked and most

504
00:22:48,049 --> 00:22:54,649
recently actually I<font color="#E5E5E5"> haven't even put on</font>

505
00:22:49,460 --> 00:22:57,859
here we had the<font color="#E5E5E5"> Ani attack against Vista</font>

506
00:22:54,649 --> 00:23:00,228
in fact and so i'll actually allude to

507
00:22:57,859 --> 00:23:02,478
that in the<font color="#E5E5E5"> next slide</font><font color="#CCCCCC"> here but what</font>

508
00:23:00,229 --> 00:23:06,259
we've been doing is taking a multi-prong

509
00:23:02,479 --> 00:23:08,149
approach on the parsers one thing is to

510
00:23:06,259 --> 00:23:09,710
just automate them a lot of<font color="#CCCCCC"> the</font>

511
00:23:08,149 --> 00:23:11,059
attackers the way that they're finding

512
00:23:09,710 --> 00:23:12,860
these vulnerabilities is there running

513
00:23:11,059 --> 00:23:14,960
buzzers well hey look we can

514
00:23:12,860 --> 00:23:16,250
buzzers<font color="#E5E5E5"> to and the cool thing is we get</font>

515
00:23:14,960 --> 00:23:18,640
to run<font color="#E5E5E5"> the saucers on the code before</font>

516
00:23:16,250 --> 00:23:20,450
the attackers the not so cool thing is

517
00:23:18,640 --> 00:23:24,890
attackers have an<font color="#E5E5E5"> infinite amount of</font>

518
00:23:20,450 --> 00:23:29,179
time we don't<font color="#E5E5E5"> so we do</font><font color="#CCCCCC"> have that as our</font>

519
00:23:24,890 --> 00:23:31,520
disadvantage anyway we have actually a

520
00:23:29,179 --> 00:23:33,740
few now internally developed buzzers

521
00:23:31,520 --> 00:23:37,250
we've also made use of some externally

522
00:23:33,740 --> 00:23:41,360
developed buzzers the the<font color="#CCCCCC"> highest risk</font>

523
00:23:37,250 --> 00:23:44,240
parsers get ddl extensions and then for

524
00:23:41,360 --> 00:23:47,479
the real tough targets we actually<font color="#CCCCCC"> go</font>

525
00:23:44,240 --> 00:23:50,630
through and take time to to customize

526
00:23:47,480 --> 00:23:59,120
some smart fuzzies so that those get the

527
00:23:50,630 --> 00:24:01,910
the greatest depth of analysis so we

528
00:23:59,120 --> 00:24:03,678
have<font color="#E5E5E5"> gotten to the point now through</font><font color="#CCCCCC"> our</font>

529
00:24:01,910 --> 00:24:06,410
code coverage analysis that we can

530
00:24:03,679 --> 00:24:08,030
actually reduce the the size of our

531
00:24:06,410 --> 00:24:09,260
templates so that we don't have to do a

532
00:24:08,030 --> 00:24:11,059
whole<font color="#CCCCCC"> bunch of</font><font color="#E5E5E5"> tests that would</font>

533
00:24:09,260 --> 00:24:13,429
basically be<font color="#CCCCCC"> redundant Lee exercising</font>

534
00:24:11,059 --> 00:24:15,918
the same<font color="#E5E5E5"> segment of code we're getting</font>

535
00:24:13,429 --> 00:24:18,260
<font color="#CCCCCC">better at this but this is this is sort</font>

536
00:24:15,919 --> 00:24:21,950
of the<font color="#E5E5E5"> bleeding edge of our fuzzing</font>

537
00:24:18,260 --> 00:24:24,590
effort but for example we we had 19,000

538
00:24:21,950 --> 00:24:27,140
JPEGs we were able<font color="#E5E5E5"> to reduce that</font><font color="#CCCCCC"> 247</font>

539
00:24:24,590 --> 00:24:31,340
and get the same amount of effective

540
00:24:27,140 --> 00:24:34,820
code exercise oh that's exercising not

541
00:24:31,340 --> 00:24:37,549
in like<font color="#CCCCCC"> the exorcist kind of sense the</font>

542
00:24:34,820 --> 00:24:39,668
other thing<font color="#CCCCCC"> is on some other areas where</font>

543
00:24:37,549 --> 00:24:43,280
it's really<font color="#E5E5E5"> necessary we go and get</font>

544
00:24:39,669 --> 00:24:46,250
security experts who are particularly

545
00:24:43,280 --> 00:24:50,210
well versed in certain areas<font color="#CCCCCC"> of the code</font>

546
00:24:46,250 --> 00:24:52,820
of<font color="#E5E5E5"> the OS so we'll go through and do do</font>

547
00:24:50,210 --> 00:24:54,530
much more detailed analysis with those

548
00:24:52,820 --> 00:24:57,799
now that<font color="#E5E5E5"> of</font><font color="#CCCCCC"> course is much more</font>

549
00:24:54,530 --> 00:25:00,200
expensive much slower but you<font color="#E5E5E5"> get better</font>

550
00:24:57,799 --> 00:25:01,340
<font color="#E5E5E5">coverage so you use that where it really</font>

551
00:25:00,200 --> 00:25:06,860
is<font color="#E5E5E5"> going to get you the biggest bang to</font>

552
00:25:01,340 --> 00:25:08,449
the buck<font color="#E5E5E5"> oh so yeah let's talk a bit</font>

553
00:25:06,860 --> 00:25:15,709
more about<font color="#CCCCCC"> the security expertise shall</font>

554
00:25:08,450 --> 00:25:17,510
we that's our next area um I don't<font color="#E5E5E5"> know</font>

555
00:25:15,710 --> 00:25:22,040
if you recognize that particular picture

556
00:25:17,510 --> 00:25:24,610
that was Soylent Green yes great great

557
00:25:22,040 --> 00:25:25,830
<font color="#E5E5E5">movie it's interesting we talked about</font>

558
00:25:24,610 --> 00:25:28,439
global war

559
00:25:25,830 --> 00:25:32,158
is causing<font color="#E5E5E5"> starvation on the planet this</font>

560
00:25:28,440 --> 00:25:33,000
was in nineteen seventy I believe sort

561
00:25:32,159 --> 00:25:37,019
of an interesting<font color="#E5E5E5"> thing to consider</font>

562
00:25:33,000 --> 00:25:38,279
anyway security expertise so lots<font color="#E5E5E5"> and</font>

563
00:25:37,019 --> 00:25:41,880
lots<font color="#E5E5E5"> of features in Vista that needed</font>

564
00:25:38,279 --> 00:25:43,820
the analysis done on them so we divided

565
00:25:41,880 --> 00:25:47,340
them into different different categories

566
00:25:43,820 --> 00:25:49,408
for some of them we decided<font color="#E5E5E5"> they would</font>

567
00:25:47,340 --> 00:25:51,809
be best served<font color="#E5E5E5"> by doing externally</font>

568
00:25:49,409 --> 00:25:53,519
<font color="#E5E5E5">Commission pen tests so I'll talk a bit</font>

569
00:25:51,809 --> 00:25:56,129
more<font color="#E5E5E5"> about</font><font color="#CCCCCC"> some of</font><font color="#E5E5E5"> the people</font><font color="#CCCCCC"> who've</font>

570
00:25:53,519 --> 00:25:58,830
done<font color="#E5E5E5"> those kinds of tests but basically</font>

571
00:25:56,130 --> 00:26:00,330
<font color="#E5E5E5">they would go through and specifically</font>

572
00:25:58,830 --> 00:26:03,779
try and take this stuff apart piece by

573
00:26:00,330 --> 00:26:05,820
piece for the other stuff we'd take a

574
00:26:03,779 --> 00:26:08,669
look at<font color="#CCCCCC"> what looked like high risk</font>

575
00:26:05,820 --> 00:26:10,799
features for those high-risk features we

576
00:26:08,669 --> 00:26:12,059
go through<font color="#E5E5E5"> and do a design review to see</font>

577
00:26:10,799 --> 00:26:14,129
<font color="#CCCCCC">how it was that they were planning on</font>

578
00:26:12,059 --> 00:26:15,690
implementing it in the first place then

579
00:26:14,130 --> 00:26:18,389
we'd come<font color="#E5E5E5"> back later do an</font>

580
00:26:15,690 --> 00:26:20,370
implementation review to see what they

581
00:26:18,389 --> 00:26:22,350
said at the beginning do is that really

582
00:26:20,370 --> 00:26:24,178
what they produced and<font color="#CCCCCC"> dolphin is not</font>

583
00:26:22,350 --> 00:26:27,029
there were some differences in some

584
00:26:24,179 --> 00:26:29,130
actually made stuff that looked really

585
00:26:27,029 --> 00:26:31,740
good in the design review be not so

586
00:26:29,130 --> 00:26:33,600
great in the implementation review and

587
00:26:31,740 --> 00:26:35,460
<font color="#E5E5E5">then we also had some horizontal</font>

588
00:26:33,600 --> 00:26:38,090
investigations these were areas where

589
00:26:35,460 --> 00:26:40,380
they<font color="#E5E5E5"> weren't feature specific they were</font>

590
00:26:38,090 --> 00:26:43,559
<font color="#E5E5E5">designed constructs that apply across</font>

591
00:26:40,380 --> 00:26:45,510
lots of features things like RPC<font color="#CCCCCC"> network</font>

592
00:26:43,559 --> 00:26:49,320
listeners that sort of stuff so all

593
00:26:45,510 --> 00:26:53,460
those together put different kinds<font color="#E5E5E5"> of</font>

594
00:26:49,320 --> 00:26:55,590
prongs into changes in the code of<font color="#E5E5E5"> Vista</font>

595
00:26:53,460 --> 00:26:57,539
all designed<font color="#E5E5E5"> to give us security</font>

596
00:26:55,590 --> 00:26:59,158
improvements fairly straightforward<font color="#E5E5E5"> when</font>

597
00:26:57,539 --> 00:27:04,019
you think about<font color="#E5E5E5"> it but it really was</font>

598
00:26:59,159 --> 00:27:06,210
very methodical so<font color="#E5E5E5"> pen testing was the</font>

599
00:27:04,019 --> 00:27:07,919
largest pen test in the company's

600
00:27:06,210 --> 00:27:09,659
history now granted we haven't exactly

601
00:27:07,919 --> 00:27:12,269
been doing pen tests for 50 years or

602
00:27:09,659 --> 00:27:13,440
anything but this was by far much

603
00:27:12,269 --> 00:27:16,110
greater than<font color="#E5E5E5"> we've</font><font color="#CCCCCC"> done on anything else</font>

604
00:27:13,440 --> 00:27:18,090
<font color="#E5E5E5">in the past we had an internal team of</font>

605
00:27:16,110 --> 00:27:21,959
hackers these were people who are

606
00:27:18,090 --> 00:27:24,090
closely related to MSR see the Microsoft

607
00:27:21,960 --> 00:27:26,100
Security Response Center so the folks

608
00:27:24,090 --> 00:27:29,370
who answer secure at microsoft com

609
00:27:26,100 --> 00:27:31,678
there's a group that sits pretty much

610
00:27:29,370 --> 00:27:33,299
right next to them who's<font color="#CCCCCC"> responsible for</font>

611
00:27:31,679 --> 00:27:35,549
taking those exploits and trying to

612
00:27:33,299 --> 00:27:36,750
<font color="#E5E5E5">figure out how do those exploits work</font>

613
00:27:35,549 --> 00:27:37,950
are there places elsewhere in the

614
00:27:36,750 --> 00:27:39,250
<font color="#E5E5E5">operating system where those would be</font>

615
00:27:37,950 --> 00:27:41,890
applicable the

616
00:27:39,250 --> 00:27:46,180
hackers were brought in to work on some

617
00:27:41,890 --> 00:27:48,040
of the features of Vista so we had a

618
00:27:46,180 --> 00:27:50,200
bunch of different<font color="#E5E5E5"> penetration tests</font>

619
00:27:48,040 --> 00:27:51,879
going<font color="#E5E5E5"> on simultaneously bunch of</font>

620
00:27:50,200 --> 00:27:54,190
different features just by the internal

621
00:27:51,880 --> 00:27:56,800
team of hackers we also had what we

622
00:27:54,190 --> 00:27:59,740
called the blue hat hackers you may have

623
00:27:56,800 --> 00:28:01,000
<font color="#CCCCCC">heard of blue hat it's basically a</font>

624
00:27:59,740 --> 00:28:02,970
security conference that's<font color="#E5E5E5"> sort of like</font>

625
00:28:01,000 --> 00:28:05,530
black hat but it's at<font color="#E5E5E5"> Microsoft</font>

626
00:28:02,970 --> 00:28:08,650
specifically<font color="#E5E5E5"> for Microsoft developers</font>

627
00:28:05,530 --> 00:28:12,879
and plays and such so we've hired some

628
00:28:08,650 --> 00:28:15,610
of those people<font color="#CCCCCC"> as consultants for Vista</font>

629
00:28:12,880 --> 00:28:18,430
we had over 20 of them that we crammed

630
00:28:15,610 --> 00:28:19,629
in a decent-sized room but it was you

631
00:28:18,430 --> 00:28:22,060
<font color="#E5E5E5">know not the size of this room or</font>

632
00:28:19,630 --> 00:28:23,950
<font color="#CCCCCC">anything neat thing that was that</font>

633
00:28:22,060 --> 00:28:25,419
happened was there was an<font color="#CCCCCC"> awful lot of</font>

634
00:28:23,950 --> 00:28:26,830
synergy that went on you know<font color="#E5E5E5"> this is</font>

635
00:28:25,420 --> 00:28:28,090
<font color="#E5E5E5">sort of like extreme development you get</font>

636
00:28:26,830 --> 00:28:30,220
a bunch<font color="#CCCCCC"> of different</font><font color="#E5E5E5"> people who have</font>

637
00:28:28,090 --> 00:28:32,350
areas of focus and they<font color="#CCCCCC"> shout across the</font>

638
00:28:30,220 --> 00:28:36,160
room at each other you<font color="#E5E5E5"> know you've got</font>

639
00:28:32,350 --> 00:28:39,790
<font color="#E5E5E5">somebody who's who's doing some some</font>

640
00:28:36,160 --> 00:28:44,440
stuff with HTTP and can talk to the guy

641
00:28:39,790 --> 00:28:46,060
who's focused on<font color="#E5E5E5"> TCP be able to very</font>

642
00:28:44,440 --> 00:28:47,560
quickly get some answers of how you

643
00:28:46,060 --> 00:28:50,560
might<font color="#CCCCCC"> be</font><font color="#E5E5E5"> able to put some things</font>

644
00:28:47,560 --> 00:28:51,879
together that would create an attack

645
00:28:50,560 --> 00:28:54,850
that isn't necessarily obvious at first

646
00:28:51,880 --> 00:28:56,980
blush these folks<font color="#E5E5E5"> have access to the</font>

647
00:28:54,850 --> 00:28:59,469
full<font color="#E5E5E5"> source code all the symbols the</font>

648
00:28:56,980 --> 00:29:01,510
specs the threat models they<font color="#CCCCCC"> basically</font>

649
00:28:59,470 --> 00:29:04,840
were able to get access to everything

650
00:29:01,510 --> 00:29:06,220
that any developer at<font color="#E5E5E5"> Microsoft has and</font>

651
00:29:04,840 --> 00:29:07,780
what's really interesting about it is

652
00:29:06,220 --> 00:29:10,120
because they<font color="#CCCCCC"> weren't feature specific</font>

653
00:29:07,780 --> 00:29:11,410
they were sort<font color="#CCCCCC"> of agnostic you know a</font>

654
00:29:10,120 --> 00:29:12,639
lot<font color="#E5E5E5"> of people when you when you're</font>

655
00:29:11,410 --> 00:29:14,080
working on a particular feature your

656
00:29:12,640 --> 00:29:17,020
focus is on that feature in that feature

657
00:29:14,080 --> 00:29:19,899
alone you get kind of parochial about it

658
00:29:17,020 --> 00:29:21,370
these folks hey hey whatever<font color="#E5E5E5"> they</font><font color="#CCCCCC"> can go</font>

659
00:29:19,900 --> 00:29:23,950
and talk to anybody about anything at

660
00:29:21,370 --> 00:29:24,939
any<font color="#CCCCCC"> time and</font><font color="#E5E5E5"> they often did it was very</font>

661
00:29:23,950 --> 00:29:27,730
interesting to see<font color="#CCCCCC"> the kinds of things</font>

662
00:29:24,940 --> 00:29:30,340
that they uncovered everything<font color="#E5E5E5"> that they</font>

663
00:29:27,730 --> 00:29:33,880
needed in the way of people was within a

664
00:29:30,340 --> 00:29:35,439
building away from them so for each

665
00:29:33,880 --> 00:29:38,110
target they'd spend anywhere for a week

666
00:29:35,440 --> 00:29:40,480
to a couple<font color="#E5E5E5"> of months and they could ask</font>

667
00:29:38,110 --> 00:29:43,149
anybody anything about anything and they

668
00:29:40,480 --> 00:29:48,100
got answers so some of the things<font color="#CCCCCC"> that</font>

669
00:29:43,150 --> 00:29:50,140
showed<font color="#CCCCCC"> up rabbit holes this</font><font color="#E5E5E5"> is where you</font>

670
00:29:48,100 --> 00:29:51,399
know because this was a sort of extreme

671
00:29:50,140 --> 00:29:53,180
development environment you've got all

672
00:29:51,400 --> 00:29:56,870
these<font color="#CCCCCC"> twenty plus people in a room</font>

673
00:29:53,180 --> 00:29:59,060
they put their various discoveries

674
00:29:56,870 --> 00:30:00,889
together and they'd<font color="#CCCCCC"> be able</font><font color="#E5E5E5"> to determine</font>

675
00:29:59,060 --> 00:30:02,450
that well by going through<font color="#E5E5E5"> this code to</font>

676
00:30:00,890 --> 00:30:04,910
this code to that code to that could<font color="#CCCCCC"> to</font>

677
00:30:02,450 --> 00:30:08,120
that<font color="#CCCCCC"> you can gain access to system</font><font color="#E5E5E5"> aha</font>

678
00:30:04,910 --> 00:30:10,010
that's pretty<font color="#CCCCCC"> cool so what at</font><font color="#E5E5E5"> first</font>

679
00:30:08,120 --> 00:30:12,050
<font color="#E5E5E5">blush looks like it's not a big deal</font>

680
00:30:10,010 --> 00:30:14,140
because<font color="#E5E5E5"> well this thing runs as you know</font>

681
00:30:12,050 --> 00:30:16,580
some heavily restricted snippet of code

682
00:30:14,140 --> 00:30:18,230
if they<font color="#E5E5E5"> could find a path that would</font>

683
00:30:16,580 --> 00:30:20,810
<font color="#E5E5E5">ultimately get them down in the box it</font>

684
00:30:18,230 --> 00:30:24,940
became a<font color="#CCCCCC"> big deal they found quite a few</font>

685
00:30:20,810 --> 00:30:26,929
of them<font color="#CCCCCC"> actually um this was great the</font>

686
00:30:24,940 --> 00:30:30,050
security assumptions that you'd find<font color="#CCCCCC"> in</font>

687
00:30:26,930 --> 00:30:32,000
threat models you know feature one says

688
00:30:30,050 --> 00:30:33,379
<font color="#E5E5E5">a well we don't have to do anything we</font>

689
00:30:32,000 --> 00:30:35,210
don't parse anything we just<font color="#E5E5E5"> pass it</font>

690
00:30:33,380 --> 00:30:36,230
down to this<font color="#E5E5E5"> other guys the other guys</font>

691
00:30:35,210 --> 00:30:38,180
say hey we don't<font color="#CCCCCC"> have to do any</font>

692
00:30:36,230 --> 00:30:44,690
validation they did the validation for

693
00:30:38,180 --> 00:30:47,420
us<font color="#CCCCCC"> hmm yeah does happen happened more</font>

694
00:30:44,690 --> 00:30:49,900
<font color="#CCCCCC">than I'd like to see so we did find some</font>

695
00:30:47,420 --> 00:30:53,600
of these and we got them addressed

696
00:30:49,900 --> 00:30:56,090
failures of imagination people who

697
00:30:53,600 --> 00:30:59,050
develop features develop them expecting

698
00:30:56,090 --> 00:31:04,939
them to be used<font color="#E5E5E5"> a particular way a</font>

699
00:30:59,050 --> 00:31:06,710
typical developer of say a slotted

700
00:31:04,940 --> 00:31:10,010
screwdriver doesn't expect it to be<font color="#E5E5E5"> used</font>

701
00:31:06,710 --> 00:31:11,630
as a chisel but somebody gets that

702
00:31:10,010 --> 00:31:13,220
slotted screwdriver in their hand and by

703
00:31:11,630 --> 00:31:15,200
god they will use it as a chisel a

704
00:31:13,220 --> 00:31:16,880
similar<font color="#E5E5E5"> sort of thing that happens with</font>

705
00:31:15,200 --> 00:31:18,710
code you're not really<font color="#E5E5E5"> expecting it to</font>

706
00:31:16,880 --> 00:31:22,550
be used in some of the ways that it ends

707
00:31:18,710 --> 00:31:25,220
up<font color="#CCCCCC"> being used you know developers like</font>

708
00:31:22,550 --> 00:31:27,200
to be really clever and sometimes being

709
00:31:25,220 --> 00:31:28,520
really clever means that you're more

710
00:31:27,200 --> 00:31:31,100
clever than the<font color="#E5E5E5"> person who wrote the</font>

711
00:31:28,520 --> 00:31:32,240
code<font color="#CCCCCC"> that you're using or at least you</font>

712
00:31:31,100 --> 00:31:34,280
<font color="#E5E5E5">think you're more clever and as a result</font>

713
00:31:32,240 --> 00:31:35,810
you<font color="#E5E5E5"> end up exposing some stuff</font><font color="#CCCCCC"> that</font>

714
00:31:34,280 --> 00:31:38,629
never was designed to be exposed<font color="#E5E5E5"> but</font>

715
00:31:35,810 --> 00:31:41,690
ends up being exposed these were also

716
00:31:38,630 --> 00:31:44,290
discovered many of them were the kinds

717
00:31:41,690 --> 00:31:46,970
of things that led to those rabbit holes

718
00:31:44,290 --> 00:31:49,250
we found even some just weird random

719
00:31:46,970 --> 00:31:51,500
stuff some file names that weren't

720
00:31:49,250 --> 00:31:54,710
exactly<font color="#E5E5E5"> the best choices like this one</font>

721
00:31:51,500 --> 00:31:56,270
so this one showed<font color="#CCCCCC"> up and all</font><font color="#E5E5E5"> of a</font>

722
00:31:54,710 --> 00:31:58,220
sudden bunch of reports started coming

723
00:31:56,270 --> 00:32:01,690
in oh my god<font color="#CCCCCC"> i just installed the</font>

724
00:31:58,220 --> 00:32:01,690
operating system and i just got owned

725
00:32:01,950 --> 00:32:10,149
no no it was this was the win<font color="#E5E5E5"> logon</font>

726
00:32:05,739 --> 00:32:12,399
<font color="#CCCCCC">session 0 viewer window hook dll besides</font>

727
00:32:10,149 --> 00:32:14,080
most attackers these days aren't really

728
00:32:12,399 --> 00:32:15,879
that interested in advertising that

729
00:32:14,080 --> 00:32:18,399
they've just owned your box unless

730
00:32:15,879 --> 00:32:22,299
they're just out looking for you know

731
00:32:18,399 --> 00:32:24,219
cleverness brownie points anyway this is

732
00:32:22,299 --> 00:32:29,200
one of<font color="#E5E5E5"> my favorites this this</font><font color="#CCCCCC"> was</font>

733
00:32:24,220 --> 00:32:31,350
actually in the<font color="#CCCCCC"> code for vista really</font>

734
00:32:29,200 --> 00:32:36,519
the the<font color="#E5E5E5"> description</font><font color="#CCCCCC"> that was given was</font>

735
00:32:31,350 --> 00:32:39,879
almost like a haiku where i've called it

736
00:32:36,519 --> 00:32:42,729
a high code anyway uh interesting stuff

737
00:32:39,879 --> 00:32:44,049
hard<font color="#E5E5E5"> to read hard to understand but</font>

738
00:32:42,729 --> 00:32:50,200
pretty cool<font color="#E5E5E5"> when you finally figure out</font>

739
00:32:44,049 --> 00:32:57,519
what it does okay so onto the defense in

740
00:32:50,200 --> 00:33:03,340
depth stuff yeah recognize that<font color="#E5E5E5"> one for</font>

741
00:32:57,519 --> 00:33:04,539
games yeah so we were thinking from<font color="#E5E5E5"> the</font>

742
00:33:03,340 --> 00:33:07,658
point of view of having to look several

743
00:33:04,539 --> 00:33:12,399
moves ahead did some stuff to GS for

744
00:33:07,659 --> 00:33:15,879
example did better stack protection so

745
00:33:12,399 --> 00:33:18,219
it's better in terms of looking further

746
00:33:15,879 --> 00:33:20,678
ahead in the code through the

747
00:33:18,220 --> 00:33:22,179
annotations that we've got and so we're

748
00:33:20,679 --> 00:33:25,989
able<font color="#E5E5E5"> to find situations like this where</font>

749
00:33:22,179 --> 00:33:27,369
your return address way down there<font color="#CCCCCC"> you</font>

750
00:33:25,989 --> 00:33:30,489
might be able<font color="#E5E5E5"> to actually walk all the</font>

751
00:33:27,369 --> 00:33:33,369
way down there<font color="#E5E5E5"> and now this is something</font>

752
00:33:30,489 --> 00:33:35,889
that can be<font color="#E5E5E5"> caught a bit more easily did</font>

753
00:33:33,369 --> 00:33:40,539
some stuff to the<font color="#E5E5E5"> heap not doing</font><font color="#CCCCCC"> luca</font>

754
00:33:35,889 --> 00:33:43,090
sides got the the block header integrity

755
00:33:40,539 --> 00:33:47,379
checks so we're able to do better error

756
00:33:43,090 --> 00:33:49,389
detection and oh I really dug this one

757
00:33:47,379 --> 00:33:52,209
<font color="#CCCCCC">the the pseudo-random base address so</font>

758
00:33:49,389 --> 00:33:54,158
it's<font color="#E5E5E5"> not always in the same place makes</font>

759
00:33:52,210 --> 00:33:56,349
it a little harder for attackers to take

760
00:33:54,159 --> 00:33:57,970
<font color="#E5E5E5">advantage of what historically has been</font>

761
00:33:56,349 --> 00:34:01,029
ah yes you know it's going to be there

762
00:33:57,970 --> 00:34:02,729
<font color="#E5E5E5">when you're done we also have the the</font>

763
00:34:01,029 --> 00:34:06,429
feature of heap terminate on corruption

764
00:34:02,729 --> 00:34:09,639
so basically<font color="#E5E5E5"> it's Canaries if the canary</font>

765
00:34:06,429 --> 00:34:11,440
dies you yank the application that was

766
00:34:09,639 --> 00:34:14,500
<font color="#E5E5E5">running at the process that's on by</font>

767
00:34:11,440 --> 00:34:15,070
default on the 64-bit version it's on

768
00:34:14,500 --> 00:34:16,960
force

769
00:34:15,070 --> 00:34:18,880
services most apps on x86 we couldn't

770
00:34:16,960 --> 00:34:21,490
have it on by default on x86 because too

771
00:34:18,880 --> 00:34:22,900
many things<font color="#CCCCCC"> that needed</font><font color="#E5E5E5"> to work stopped</font>

772
00:34:21,489 --> 00:34:26,770
working what does<font color="#E5E5E5"> that tell you about</font>

773
00:34:22,900 --> 00:34:28,450
those applications badly written yeah

774
00:34:26,770 --> 00:34:30,759
the problem is of course<font color="#E5E5E5"> we could you</font>

775
00:34:28,449 --> 00:34:33,009
know<font color="#E5E5E5"> have had</font><font color="#CCCCCC"> it on by default for x86</font>

776
00:34:30,760 --> 00:34:34,510
and those badly written applications

777
00:34:33,010 --> 00:34:36,400
wouldn't work and then<font color="#CCCCCC"> people would be</font>

778
00:34:34,510 --> 00:34:39,160
calling complaining because their code

779
00:34:36,400 --> 00:34:41,950
doesn't work the stuff that<font color="#CCCCCC"> they paid</font>

780
00:34:39,159 --> 00:34:44,319
<font color="#CCCCCC">good money for back in 1997 that they</font>

781
00:34:41,949 --> 00:34:46,389
still<font color="#CCCCCC"> want to run on the new version of</font>

782
00:34:44,320 --> 00:34:48,130
<font color="#E5E5E5">the operating system what I call the</font>

783
00:34:46,389 --> 00:34:49,299
what if you<font color="#E5E5E5"> threw a war and nobody came</font>

784
00:34:48,130 --> 00:34:50,800
it would be great to build this

785
00:34:49,300 --> 00:34:52,720
wonderfully secure operating system that

786
00:34:50,800 --> 00:34:56,830
nobody can buy because they can't use

787
00:34:52,719 --> 00:34:58,270
what they still need it's real exercise

788
00:34:56,830 --> 00:34:59,980
in frustration I have to say that's the

789
00:34:58,270 --> 00:35:01,900
sort of stuff<font color="#CCCCCC"> that we deal with on a</font>

790
00:34:59,980 --> 00:35:04,870
regular basis there was more talked

791
00:35:01,900 --> 00:35:08,920
about Adrienne's talk back in<font color="#E5E5E5"> black hat</font>

792
00:35:04,870 --> 00:35:12,640
last summer did function pointer

793
00:35:08,920 --> 00:35:13,810
<font color="#E5E5E5">encoding as well nothing terribly fancy</font>

794
00:35:12,640 --> 00:35:15,640
here but it's sort of<font color="#E5E5E5"> what you would</font>

795
00:35:13,810 --> 00:35:17,200
expect if<font color="#CCCCCC"> you encode the function</font>

796
00:35:15,640 --> 00:35:19,629
pointer then it makes it a little harder

797
00:35:17,200 --> 00:35:22,839
for an attacker to predict where the

798
00:35:19,630 --> 00:35:25,690
pointers are going so it<font color="#E5E5E5"> just does</font>

799
00:35:22,840 --> 00:35:27,310
either<font color="#CCCCCC"> the X or with the / process</font>

800
00:35:25,690 --> 00:35:28,840
quickie or the XOR with the shared

801
00:35:27,310 --> 00:35:30,250
cookie in<font color="#CCCCCC"> the shared users data</font>

802
00:35:28,840 --> 00:35:34,480
depending on whether it's a system

803
00:35:30,250 --> 00:35:40,480
pointer or not also data execution

804
00:35:34,480 --> 00:35:42,910
protection it on older pcs MX was not

805
00:35:40,480 --> 00:35:45,700
something that was<font color="#CCCCCC"> available in</font><font color="#E5E5E5"> the</font>

806
00:35:42,910 --> 00:35:47,950
hardware<font color="#E5E5E5"> so it was kind of an</font>

807
00:35:45,700 --> 00:35:50,830
interesting thing to have this as the

808
00:35:47,950 --> 00:35:53,620
software version of depth for XP sp2 but

809
00:35:50,830 --> 00:35:55,029
not especially<font color="#E5E5E5"> powerful these days since</font>

810
00:35:53,620 --> 00:35:57,190
you need<font color="#E5E5E5"> a pretty new machine to run</font>

811
00:35:55,030 --> 00:36:00,940
vista anyway those<font color="#CCCCCC"> are all the ones</font><font color="#E5E5E5"> that</font>

812
00:35:57,190 --> 00:36:04,600
also have an<font color="#E5E5E5"> X support on them I will</font>

813
00:36:00,940 --> 00:36:06,400
say though most machines that I've seen

814
00:36:04,600 --> 00:36:09,370
thus far that can run vista have NX

815
00:36:06,400 --> 00:36:10,720
turned off by default in the<font color="#E5E5E5"> hardware so</font>

816
00:36:09,370 --> 00:36:12,430
you gotta go<font color="#E5E5E5"> in and</font><font color="#CCCCCC"> you got</font><font color="#E5E5E5"> to manually</font>

817
00:36:10,720 --> 00:36:14,379
<font color="#CCCCCC">turn it on up in the bios settings and</font>

818
00:36:12,430 --> 00:36:17,259
blah blah blah but if you do you can

819
00:36:14,380 --> 00:36:20,740
enable it as part of the US as<font color="#CCCCCC"> well the</font>

820
00:36:17,260 --> 00:36:22,270
default is to have it opted in so<font color="#E5E5E5"> X is</font>

821
00:36:20,740 --> 00:36:25,770
that are linked using<font color="#E5E5E5"> the amex compact</font>

822
00:36:22,270 --> 00:36:28,480
yes those have NX turned on permanently

823
00:36:25,770 --> 00:36:29,029
all the services and windows were able

824
00:36:28,480 --> 00:36:33,939
to do it most

825
00:36:29,029 --> 00:36:37,009
the<font color="#E5E5E5"> Exies also were able to do it yeah</font>

826
00:36:33,939 --> 00:36:40,009
you can switch into the opt-out mode

827
00:36:37,009 --> 00:36:42,380
there's<font color="#CCCCCC"> dialog box in vista and in fact</font>

828
00:36:40,009 --> 00:36:44,239
<font color="#E5E5E5">i do this where</font><font color="#CCCCCC"> i have</font><font color="#E5E5E5"> everything</font>

829
00:36:42,380 --> 00:36:48,319
turning on exxon and then you opt out

830
00:36:44,239 --> 00:36:50,929
just for the things that that are not

831
00:36:48,319 --> 00:36:56,199
compatible<font color="#E5E5E5"> with NX what was the one that</font>

832
00:36:50,929 --> 00:37:00,199
<font color="#CCCCCC">i found i found one spyware blaster</font>

833
00:36:56,199 --> 00:37:03,199
oddly enough which I love that program

834
00:37:00,199 --> 00:37:04,759
but you have to turn<font color="#E5E5E5"> NX off for it what</font>

835
00:37:03,199 --> 00:37:08,239
does<font color="#CCCCCC"> that tell you anyway moving right</font>

836
00:37:04,759 --> 00:37:11,359
along so stuff that's been said about

837
00:37:08,239 --> 00:37:14,229
Deb basically said hey this is pretty

838
00:37:11,359 --> 00:37:16,759
<font color="#E5E5E5">cool but you know</font><font color="#CCCCCC"> you can work around it</font>

839
00:37:14,229 --> 00:37:18,649
one thing<font color="#CCCCCC"> that would be really cool</font>

840
00:37:16,759 --> 00:37:20,329
though if you wanted to defend against

841
00:37:18,650 --> 00:37:21,229
working<font color="#E5E5E5"> around it would be to do some</font>

842
00:37:20,329 --> 00:37:26,079
form of address space layout

843
00:37:21,229 --> 00:37:29,239
randomization good idea so we did it

844
00:37:26,079 --> 00:37:33,249
works with data execution protection the

845
00:37:29,239 --> 00:37:36,349
idea between<font color="#E5E5E5"> a the idea behind a SLR is</font>

846
00:37:33,249 --> 00:37:39,109
that you don't know where<font color="#E5E5E5"> the executable</font>

847
00:37:36,349 --> 00:37:42,219
code is going to run we're in memory so

848
00:37:39,109 --> 00:37:44,989
it makes it a lot harder<font color="#E5E5E5"> for you to</font>

849
00:37:42,219 --> 00:37:46,429
write exploit code that's going to be

850
00:37:44,989 --> 00:37:47,659
able<font color="#E5E5E5"> to point to particular routines</font>

851
00:37:46,429 --> 00:37:53,659
because you don't know exactly where

852
00:37:47,659 --> 00:37:56,539
<font color="#E5E5E5">they are now they</font><font color="#CCCCCC"> have to opt in so this</font>

853
00:37:53,659 --> 00:37:58,999
means that it's not<font color="#E5E5E5"> available for every</font>

854
00:37:56,539 --> 00:38:02,439
application that you would have but it

855
00:37:58,999 --> 00:38:04,968
is<font color="#E5E5E5"> available for</font><font color="#CCCCCC"> most of</font><font color="#E5E5E5"> Windows</font>

856
00:38:02,439 --> 00:38:07,339
actually all of Windows but separate

857
00:38:04,969 --> 00:38:09,229
story so part of what we had to figure

858
00:38:07,339 --> 00:38:15,769
<font color="#CCCCCC">out is how did how to do this balance in</font>

859
00:38:09,229 --> 00:38:17,569
terms of the<font color="#E5E5E5"> the granularity and so you</font>

860
00:38:15,769 --> 00:38:20,598
<font color="#CCCCCC">know you want to</font><font color="#E5E5E5"> have as many as</font>

861
00:38:17,569 --> 00:38:23,209
possible variations in where the code

862
00:38:20,599 --> 00:38:24,469
would would end up running but at<font color="#E5E5E5"> the</font>

863
00:38:23,209 --> 00:38:26,448
same time you need<font color="#CCCCCC"> to have these blocks</font>

864
00:38:24,469 --> 00:38:28,609
be large enough that the executables can

865
00:38:26,449 --> 00:38:30,890
have sufficient contiguous space so that

866
00:38:28,609 --> 00:38:33,859
they're<font color="#E5E5E5"> not going too slow to a crawl so</font>

867
00:38:30,890 --> 00:38:36,949
it we<font color="#E5E5E5"> basically got to where it's a</font>

868
00:38:33,859 --> 00:38:40,308
hundred and I don't know 114 or

869
00:38:36,949 --> 00:38:42,990
something possible places where your

870
00:38:40,309 --> 00:38:45,960
code might start

871
00:38:42,990 --> 00:38:47,879
that gives you basically a<font color="#E5E5E5"> ninety nine</font>

872
00:38:45,960 --> 00:38:51,510
and a half percent<font color="#E5E5E5"> chance that an attack</font>

873
00:38:47,880 --> 00:38:53,250
will fail the first time now needless to

874
00:38:51,510 --> 00:38:55,560
say if you<font color="#E5E5E5"> have an attack that's going</font>

875
00:38:53,250 --> 00:38:59,070
to be against code that automatically

876
00:38:55,560 --> 00:39:02,570
restarts<font color="#E5E5E5"> okay so you hit it and you know</font>

877
00:38:59,070 --> 00:39:06,660
after<font color="#CCCCCC"> 60 tries or so</font><font color="#E5E5E5"> your year about</font>

878
00:39:02,570 --> 00:39:08,100
going to hit a success so some of the

879
00:39:06,660 --> 00:39:09,990
kinds of defenses that we have were

880
00:39:08,100 --> 00:39:11,339
putting in code that would recognize

881
00:39:09,990 --> 00:39:13,410
when it was restarting a bunch of<font color="#E5E5E5"> times</font>

882
00:39:11,340 --> 00:39:16,170
<font color="#CCCCCC">ago haha minute somebody's trying to</font>

883
00:39:13,410 --> 00:39:18,660
attack<font color="#CCCCCC"> me but</font><font color="#E5E5E5"> again that requires that</font>

884
00:39:16,170 --> 00:39:21,690
you be aware of it so development of new

885
00:39:18,660 --> 00:39:23,879
code needs to opt into a SLR and needs

886
00:39:21,690 --> 00:39:26,160
<font color="#CCCCCC">to</font><font color="#E5E5E5"> be aware</font><font color="#CCCCCC"> of when it is automatically</font>

887
00:39:23,880 --> 00:39:27,390
restarting if it happens<font color="#E5E5E5"> to even have</font>

888
00:39:26,160 --> 00:39:29,790
the capability of automatically

889
00:39:27,390 --> 00:39:34,350
restarting typically services or more in

890
00:39:29,790 --> 00:39:36,990
that vein than applications um turned

891
00:39:34,350 --> 00:39:39,000
out that by a chi thermos balance we

892
00:39:36,990 --> 00:39:41,160
really didn't end up having a net change

893
00:39:39,000 --> 00:39:44,520
in performance of the OS some things

894
00:39:41,160 --> 00:39:46,319
were a bit faster some slower and we've

895
00:39:44,520 --> 00:39:49,680
been we've been<font color="#E5E5E5"> doing pretty well in</font>

896
00:39:46,320 --> 00:39:52,170
terms of app compat so<font color="#E5E5E5"> I'm pleased with</font>

897
00:39:49,680 --> 00:39:55,680
the ultimate<font color="#E5E5E5"> results all the features of</font>

898
00:39:52,170 --> 00:40:02,580
Vista did opt into this so the entire OS

899
00:39:55,680 --> 00:40:05,549
is running with a SLR so I want<font color="#E5E5E5"> to wrap</font>

900
00:40:02,580 --> 00:40:06,869
up here with a case study the one that

901
00:40:05,550 --> 00:40:11,760
has been<font color="#CCCCCC"> mentioned a couple of times</font>

902
00:40:06,869 --> 00:40:13,260
<font color="#CCCCCC">here</font><font color="#E5E5E5"> is Oh Todd uh</font><font color="#CCCCCC"> so zou tab was pretty</font>

903
00:40:11,760 --> 00:40:16,080
bad for<font color="#E5E5E5"> anyone</font><font color="#CCCCCC"> who is running</font><font color="#E5E5E5"> windows</font>

904
00:40:13,260 --> 00:40:19,260
2000 it was a remote unauthenticated

905
00:40:16,080 --> 00:40:20,880
code execution on the box<font color="#E5E5E5"> just buy it</font>

906
00:40:19,260 --> 00:40:24,480
sitting<font color="#CCCCCC"> there being plugged into the</font>

907
00:40:20,880 --> 00:40:26,520
network kind of ugly there wasn't an SD

908
00:40:24,480 --> 00:40:28,320
l of course back when<font color="#E5E5E5"> we were doing</font>

909
00:40:26,520 --> 00:40:30,720
windows 2000 so<font color="#E5E5E5"> I guess</font><font color="#CCCCCC"> that shouldn't</font>

910
00:40:28,320 --> 00:40:32,730
come as a great shock<font color="#E5E5E5"> of this to</font><font color="#CCCCCC"> SP</font>

911
00:40:30,720 --> 00:40:34,919
<font color="#E5E5E5">where I'm sorry XP sp1 same sort of</font>

912
00:40:32,730 --> 00:40:37,170
thing but it did happen to have a

913
00:40:34,920 --> 00:40:39,630
restricted<font color="#CCCCCC"> akal so there was a little</font>

914
00:40:37,170 --> 00:40:44,400
bit of sort<font color="#E5E5E5"> of almost accidental</font>

915
00:40:39,630 --> 00:40:47,730
security their server 2003 happened to

916
00:40:44,400 --> 00:40:50,820
have an RPC call back instituted with

917
00:40:47,730 --> 00:40:52,950
the intent of being more secure and this

918
00:40:50,820 --> 00:40:56,250
just happened<font color="#E5E5E5"> to make it so that it was</font>

919
00:40:52,950 --> 00:41:00,368
<font color="#E5E5E5">not a remote vulnerability any longer</font>

920
00:40:56,250 --> 00:41:03,099
<font color="#CCCCCC">XP sp2</font><font color="#E5E5E5"> well it was based on server 2003</font>

921
00:41:00,369 --> 00:41:05,890
so it shouldn't be a huge shock that it

922
00:41:03,099 --> 00:41:08,140
picked that up as well but even<font color="#CCCCCC"> if it</font>

923
00:41:05,890 --> 00:41:10,538
turned out that we had missed it in XP

924
00:41:08,140 --> 00:41:13,029
sp2 that it hadn't picked up that server

925
00:41:10,539 --> 00:41:15,309
2003<font color="#CCCCCC"> opportune call back what have</font>

926
00:41:13,029 --> 00:41:18,730
turned out that because we have the

927
00:41:15,309 --> 00:41:21,940
firewall on by default in XP sp2 that

928
00:41:18,730 --> 00:41:26,579
<font color="#CCCCCC">zotov would not have been were mobile in</font>

929
00:41:21,940 --> 00:41:29,500
XP sp2 well invest up let's look at it

930
00:41:26,579 --> 00:41:32,890
we had the pre<font color="#CCCCCC"> fast</font><font color="#E5E5E5"> prefix code scanners</font>

931
00:41:29,500 --> 00:41:35,109
so the buffer overrun would most likely

932
00:41:32,890 --> 00:41:36,759
have been caught there but you know if

933
00:41:35,109 --> 00:41:38,259
we happen to miss it because we didn't

934
00:41:36,760 --> 00:41:40,569
create<font color="#E5E5E5"> a rule yet that was going to find</font>

935
00:41:38,260 --> 00:41:43,269
it well we also were doing the RPC

936
00:41:40,569 --> 00:41:46,420
fuzzing and penetration testing and even

937
00:41:43,269 --> 00:41:48,910
if we<font color="#E5E5E5"> missed it there we had the</font>

938
00:41:46,420 --> 00:41:51,579
improved version of GS the improved

939
00:41:48,910 --> 00:41:53,649
version of safe seh should have caught

940
00:41:51,579 --> 00:41:56,859
it at compile time up even if that

941
00:41:53,650 --> 00:41:58,420
<font color="#E5E5E5">didn't do it you're also protected by NX</font>

942
00:41:56,859 --> 00:42:02,288
being turned on and<font color="#CCCCCC"> ASL are being</font>

943
00:41:58,420 --> 00:42:05,039
enabled and even if all of those well we

944
00:42:02,289 --> 00:42:08,140
still have that firewall on by default

945
00:42:05,039 --> 00:42:10,660
so it still would have been blocked so

946
00:42:08,140 --> 00:42:12,190
you can see I mean the point<font color="#E5E5E5"> isn't I I</font>

947
00:42:10,660 --> 00:42:14,230
want to make it really<font color="#E5E5E5"> clear the point</font>

948
00:42:12,190 --> 00:42:17,140
is<font color="#E5E5E5"> not there are no vulnerabilities in</font>

949
00:42:14,230 --> 00:42:19,000
vista<font color="#E5E5E5"> I'm not going to be like some</font>

950
00:42:17,140 --> 00:42:23,019
vendors and stand up here and say it's

951
00:42:19,000 --> 00:42:25,150
unbreakable I recognize that<font color="#CCCCCC"> it's a big</font>

952
00:42:23,019 --> 00:42:26,649
<font color="#E5E5E5">complicated operating system we covered</font>

953
00:42:25,150 --> 00:42:29,619
a tremendous amount<font color="#E5E5E5"> of territory in</font>

954
00:42:26,650 --> 00:42:31,839
vista we have numerous<font color="#E5E5E5"> instances of</font>

955
00:42:29,619 --> 00:42:34,390
things like this where we caught

956
00:42:31,839 --> 00:42:36,130
tremendous number of bugs that were in

957
00:42:34,390 --> 00:42:39,879
the operating system that could have

958
00:42:36,130 --> 00:42:43,019
been exploitable but aren't<font color="#E5E5E5"> because we</font>

959
00:42:39,880 --> 00:42:46,089
have these various tools available to us

960
00:42:43,019 --> 00:42:48,729
so<font color="#E5E5E5"> just to give you sort of a visual</font>

961
00:42:46,089 --> 00:42:50,288
<font color="#CCCCCC">comparison with XP sp2 you can think</font><font color="#E5E5E5"> of</font>

962
00:42:48,730 --> 00:42:54,099
<font color="#E5E5E5">those big windows logos like the surface</font>

963
00:42:50,289 --> 00:42:56,890
area<font color="#CCCCCC"> of the OS we covered a number of</font>

964
00:42:54,099 --> 00:42:59,230
<font color="#E5E5E5">things even in the XP sp2 days we</font>

965
00:42:56,890 --> 00:43:01,808
trained people on how to be secure we

966
00:42:59,230 --> 00:43:03,579
did threat models and looked at them we

967
00:43:01,809 --> 00:43:04,509
were tracking the security bugs we found

968
00:43:03,579 --> 00:43:07,690
and made sure that they were getting

969
00:43:04,509 --> 00:43:08,980
fixed we had prefix we were working on

970
00:43:07,690 --> 00:43:11,920
making<font color="#E5E5E5"> sure that the the</font>

971
00:43:08,980 --> 00:43:14,320
default permissions of applications and

972
00:43:11,920 --> 00:43:16,930
services were restricted feature<font color="#CCCCCC"> chains</font>

973
00:43:14,320 --> 00:43:18,490
did<font color="#E5E5E5"> code reviews they also had other</font>

974
00:43:16,930 --> 00:43:22,359
features who would review each other's

975
00:43:18,490 --> 00:43:25,479
code<font color="#CCCCCC"> it was good stuff</font><font color="#E5E5E5"> as we moved into</font>

976
00:43:22,359 --> 00:43:27,490
<font color="#E5E5E5">Vista first thing was we replaced a lot</font>

977
00:43:25,480 --> 00:43:28,930
of<font color="#E5E5E5"> those manual code reviews with the</font>

978
00:43:27,490 --> 00:43:30,939
automated tools we get much more

979
00:43:28,930 --> 00:43:35,049
coverage much more quickly much more

980
00:43:30,940 --> 00:43:38,040
effectively so those tools a lot of

981
00:43:35,050 --> 00:43:41,170
those<font color="#CCCCCC"> are like these</font><font color="#E5E5E5"> guys over here</font>

982
00:43:38,040 --> 00:43:45,640
<font color="#E5E5E5">doing the pre fast we scan code for</font>

983
00:43:41,170 --> 00:43:47,440
api's that are really bad often really

984
00:43:45,640 --> 00:43:51,190
often<font color="#E5E5E5"> leading to buffer over and stuff</font>

985
00:43:47,440 --> 00:43:52,869
like stir copy you know Sal annotation

986
00:43:51,190 --> 00:43:56,890
which we described earlier was put into

987
00:43:52,869 --> 00:43:58,600
all the new code in the OS<font color="#E5E5E5"> oh this was</font>

988
00:43:56,890 --> 00:44:01,180
an interest in one the third party code

989
00:43:58,600 --> 00:44:03,490
sdl tracking that's one of the people I

990
00:44:01,180 --> 00:44:05,440
worked very<font color="#CCCCCC"> closely with who was</font><font color="#E5E5E5"> working</font>

991
00:44:03,490 --> 00:44:07,509
on<font color="#E5E5E5"> this looking to make sure that even</font>

992
00:44:05,440 --> 00:44:09,250
code that didn't belong to<font color="#CCCCCC"> Windows that</font>

993
00:44:07,510 --> 00:44:11,740
<font color="#E5E5E5">didn't even belong to Microsoft followed</font>

994
00:44:09,250 --> 00:44:12,880
the<font color="#CCCCCC"> sdl as much as was reasonable we</font>

995
00:44:11,740 --> 00:44:15,759
obviously have some things that are

996
00:44:12,880 --> 00:44:17,950
internal only but we were making sure

997
00:44:15,760 --> 00:44:21,490
that that code that came from other

998
00:44:17,950 --> 00:44:23,259
companies also had to follow the<font color="#CCCCCC"> sdl or</font>

999
00:44:21,490 --> 00:44:31,200
else had<font color="#CCCCCC"> to have a serious justification</font>

1000
00:44:23,260 --> 00:44:34,270
for why they couldn't<font color="#CCCCCC"> ok</font><font color="#E5E5E5"> jack FX cop</font>

1001
00:44:31,200 --> 00:44:35,890
trying to remember what it does it's

1002
00:44:34,270 --> 00:44:37,420
yeah i<font color="#CCCCCC"> know it's another code analysis</font>

1003
00:44:35,890 --> 00:44:39,910
<font color="#CCCCCC">tool but</font><font color="#E5E5E5"> i'm trying to remember it's a</font>

1004
00:44:37,420 --> 00:44:41,140
static analysis tool and<font color="#CCCCCC"> i'm trying to</font>

1005
00:44:39,910 --> 00:44:43,180
remember<font color="#E5E5E5"> what it was it's supposed to</font>

1006
00:44:41,140 --> 00:44:46,060
look for the the different settings that

1007
00:44:43,180 --> 00:44:47,710
you had like<font color="#E5E5E5"> that you had had to have</font>

1008
00:44:46,060 --> 00:44:54,450
GES enabled that<font color="#E5E5E5"> you have to have safe</font>

1009
00:44:47,710 --> 00:44:56,440
<font color="#CCCCCC">seh enabled what's up that's our</font>

1010
00:44:54,450 --> 00:44:58,569
governments back door into<font color="#E5E5E5"> the system</font>

1011
00:44:56,440 --> 00:45:01,390
you know based<font color="#E5E5E5"> on the name that would be</font>

1012
00:44:58,570 --> 00:45:02,859
great very clever but no it's basically

1013
00:45:01,390 --> 00:45:03,700
it's supposed<font color="#E5E5E5"> to do it analysis to make</font>

1014
00:45:02,859 --> 00:45:04,930
sure that you have the appropriate

1015
00:45:03,700 --> 00:45:06,279
setting so that we didn't have<font color="#E5E5E5"> to</font>

1016
00:45:04,930 --> 00:45:07,899
manually<font color="#E5E5E5"> go back and look at it and it</font>

1017
00:45:06,280 --> 00:45:10,300
generates basically an Excel spreadsheet

1018
00:45:07,900 --> 00:45:12,550
and tells us get all<font color="#E5E5E5"> of your components</font>

1019
00:45:10,300 --> 00:45:14,550
pass and which ones failed and because

1020
00:45:12,550 --> 00:45:17,290
it's in Excel you can very easily do the

1021
00:45:14,550 --> 00:45:18,520
the collapsing down the rows so that

1022
00:45:17,290 --> 00:45:19,720
you'd see only the things<font color="#E5E5E5"> that said</font>

1023
00:45:18,520 --> 00:45:21,920
failed and then you'd be able to very

1024
00:45:19,720 --> 00:45:24,799
quickly find them<font color="#E5E5E5"> and beat them up</font>

1025
00:45:21,920 --> 00:45:27,020
really kind<font color="#E5E5E5"> of cool but anyway other</font>

1026
00:45:24,799 --> 00:45:30,170
stuff that<font color="#CCCCCC"> we did sort of these depth</font>

1027
00:45:27,020 --> 00:45:31,640
kinds of things design reviews many

1028
00:45:30,170 --> 00:45:33,859
security approaches for some of the

1029
00:45:31,640 --> 00:45:38,359
features that needed some extra time

1030
00:45:33,859 --> 00:45:39,859
doing a sort of stop coding stop testing

1031
00:45:38,359 --> 00:45:42,470
stop doing anything<font color="#E5E5E5"> other than looking</font>

1032
00:45:39,859 --> 00:45:45,109
at the security the penetration testing

1033
00:45:42,470 --> 00:45:46,730
I mentioned some special projects that I

1034
00:45:45,109 --> 00:45:49,490
can't talk<font color="#CCCCCC"> about but we add some other</font>

1035
00:45:46,730 --> 00:45:51,799
things<font color="#CCCCCC"> that we did as well and finally</font>

1036
00:45:49,490 --> 00:45:53,419
the final parts are fuzzing the service

1037
00:45:51,799 --> 00:45:56,359
hardening that gave us some additional

1038
00:45:53,420 --> 00:45:58,940
targeted views now as I<font color="#CCCCCC"> said there's</font>

1039
00:45:56,359 --> 00:46:00,319
some gaps in there there's spaces in

1040
00:45:58,940 --> 00:46:02,510
there there's stuff that we didn't cover

1041
00:46:00,319 --> 00:46:05,000
there's stuff that we missed this is<font color="#E5E5E5"> why</font>

1042
00:46:02,510 --> 00:46:07,490
we<font color="#E5E5E5"> have things like the the Ani</font>

1043
00:46:05,000 --> 00:46:11,960
vulnerability that came out we fuzzed<font color="#E5E5E5"> a</font>

1044
00:46:07,490 --> 00:46:13,609
and I a lot we still missed it we had

1045
00:46:11,960 --> 00:46:14,990
all those other kinds<font color="#E5E5E5"> of things that I</font>

1046
00:46:13,609 --> 00:46:16,900
talked about<font color="#E5E5E5"> on</font><font color="#CCCCCC"> the previous slide we</font>

1047
00:46:14,990 --> 00:46:19,910
still missed it there's<font color="#E5E5E5"> not going to be</font>

1048
00:46:16,900 --> 00:46:21,619
an absolute hundred percent certainty

1049
00:46:19,910 --> 00:46:24,890
that will catch everything we caught so

1050
00:46:21,619 --> 00:46:26,480
much that to recognize<font color="#E5E5E5"> how few that</font>

1051
00:46:24,890 --> 00:46:29,480
we're seeing now compared to<font color="#E5E5E5"> how</font><font color="#CCCCCC"> many we</font>

1052
00:46:26,480 --> 00:46:32,589
saw this time last year for XP we're

1053
00:46:29,480 --> 00:46:34,790
doing<font color="#E5E5E5"> pretty well from what I'm seeing I</font>

1054
00:46:32,589 --> 00:46:38,180
just<font color="#E5E5E5"> mentioned</font><font color="#CCCCCC"> one other thing about</font><font color="#E5E5E5"> it</font>

1055
00:46:34,790 --> 00:46:41,540
it turns out that a SLR actually ended

1056
00:46:38,180 --> 00:46:43,578
up hurting in the<font color="#E5E5E5"> Ani case because the</font>

1057
00:46:41,540 --> 00:46:47,029
code did restart automatically and so it

1058
00:46:43,579 --> 00:46:50,420
didn't actually slow things down in that

1059
00:46:47,030 --> 00:46:52,010
particular case it's always interesting

1060
00:46:50,420 --> 00:46:54,380
when you see how the things that you do

1061
00:46:52,010 --> 00:46:58,069
create new environments that you hadn't

1062
00:46:54,380 --> 00:47:02,150
expected got any sort of suggestions any

1063
00:46:58,069 --> 00:47:04,160
sort of things that<font color="#E5E5E5"> you find please do</font>

1064
00:47:02,150 --> 00:47:07,760
email the secure folks secure microsoft

1065
00:47:04,160 --> 00:47:12,140
com that's the MSR see Security Response

1066
00:47:07,760 --> 00:47:15,980
Center and I don't know how am I<font color="#E5E5E5"> I took</font>

1067
00:47:12,140 --> 00:47:17,660
less than an hour<font color="#E5E5E5"> I took less than an</font>

1068
00:47:15,980 --> 00:47:25,730
hour I managed<font color="#CCCCCC"> to get it all done in the</font>

1069
00:47:17,660 --> 00:47:27,259
time allotted<font color="#CCCCCC"> okay thank</font><font color="#E5E5E5"> you so I don't</font>

1070
00:47:25,730 --> 00:47:29,240
know you guys tell me<font color="#E5E5E5"> how you want to do</font>

1071
00:47:27,260 --> 00:47:30,530
the scheduling because the the goons are

1072
00:47:29,240 --> 00:47:32,779
responsible for this so what do you want

1073
00:47:30,530 --> 00:47:35,020
to do do<font color="#E5E5E5"> you want do you</font><font color="#CCCCCC"> want me to stop</font>

1074
00:47:32,780 --> 00:47:35,020
or

1075
00:47:43,300 --> 00:47:49,700
yeah 121 talk left so I mean I'm I'm

1076
00:47:46,340 --> 00:47:52,820
happy<font color="#E5E5E5"> to answer questions while we're</font>

1077
00:47:49,700 --> 00:47:57,069
doing this the trade-off of stuff if you

1078
00:47:52,820 --> 00:47:57,070
want<font color="#CCCCCC"> okay let's do that then</font>

1079
00:48:32,300 --> 00:48:34,360
you

