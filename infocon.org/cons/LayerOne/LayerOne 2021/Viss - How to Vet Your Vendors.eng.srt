1
00:00:02,399 --> 00:00:03,120
hello

2
00:00:03,120 --> 00:00:04,960
i hope your layer one is going well so

3
00:00:04,960 --> 00:00:06,319
far as well as a can

4
00:00:06,319 --> 00:00:08,559
anyhow given the plague welcome to how

5
00:00:08,559 --> 00:00:09,679
to vet your vendors

6
00:00:09,679 --> 00:00:11,040
today i'll be explaining some tricks

7
00:00:11,040 --> 00:00:12,480
that you can use to gather intel on

8
00:00:12,480 --> 00:00:13,040
vendors

9
00:00:13,040 --> 00:00:15,040
if you find yourself in a in a role

10
00:00:15,040 --> 00:00:16,400
where you have to evaluate the security

11
00:00:16,400 --> 00:00:17,760
of vendors that your company wishes to

12
00:00:17,760 --> 00:00:18,880
do business with

13
00:00:18,880 --> 00:00:20,640
right off the hop we have three big ones

14
00:00:20,640 --> 00:00:23,279
equifax solarwinds and sonicwall

15
00:00:23,279 --> 00:00:24,720
three companies who were incredibly

16
00:00:24,720 --> 00:00:26,160
cavalier with the security posture and

17
00:00:26,160 --> 00:00:27,599
who eventually got popped because they

18
00:00:27,599 --> 00:00:29,439
did the least legally permissible amount

19
00:00:29,439 --> 00:00:30,400
of work

20
00:00:30,400 --> 00:00:31,760
today we'll talk about how to

21
00:00:31,760 --> 00:00:33,200
potentially avoid being in that blast

22
00:00:33,200 --> 00:00:34,000
radius

23
00:00:34,000 --> 00:00:35,600
or something like that it is

24
00:00:35,600 --> 00:00:37,200
surprisingly straightforward presuming

25
00:00:37,200 --> 00:00:38,320
that you have the time and the

26
00:00:38,320 --> 00:00:39,200
inclination

27
00:00:39,200 --> 00:00:40,719
or if you want to just sleep better at

28
00:00:40,719 --> 00:00:41,680
night knowing that you're helping

29
00:00:41,680 --> 00:00:44,320
decision makers be better so here's a

30
00:00:44,320 --> 00:00:44,879
little bit

31
00:00:44,879 --> 00:00:46,239
about me i won't spend a lot of time

32
00:00:46,239 --> 00:00:48,559
here you can pause this if you want

33
00:00:48,559 --> 00:00:52,000
but the image is accurate so the scope

34
00:00:52,000 --> 00:00:53,120
of this presentation is to cover

35
00:00:53,120 --> 00:00:53,920
specifically

36
00:00:53,920 --> 00:00:55,360
how to audit vendors that your company

37
00:00:55,360 --> 00:00:56,640
is bringing on board for one reason or

38
00:00:56,640 --> 00:00:57,120
another

39
00:00:57,120 --> 00:00:58,480
maybe they're gonna host your company

40
00:00:58,480 --> 00:01:00,719
chat maybe they're gonna

41
00:01:00,719 --> 00:01:02,399
maybe you're buying uh their anti-spam

42
00:01:02,399 --> 00:01:04,479
appliance maybe you're buying an hsm

43
00:01:04,479 --> 00:01:06,960
or an iam solution maybe you're buying

44
00:01:06,960 --> 00:01:08,640
the hris system

45
00:01:08,640 --> 00:01:10,400
uh the concept is that you're offloading

46
00:01:10,400 --> 00:01:12,080
some kind of business service

47
00:01:12,080 --> 00:01:13,439
that you do to a vendor or that your

48
00:01:13,439 --> 00:01:15,040
company does to a vendor or you're

49
00:01:15,040 --> 00:01:16,320
buying their software or hardware and

50
00:01:16,320 --> 00:01:17,759
you intend on running it in your

51
00:01:17,759 --> 00:01:19,040
environment day-to-day

52
00:01:19,040 --> 00:01:20,960
or potentially uh you're buying a

53
00:01:20,960 --> 00:01:22,720
cloud-based service from them and you're

54
00:01:22,720 --> 00:01:24,479
going to use them for

55
00:01:24,479 --> 00:01:26,640
business reasons the concept doesn't

56
00:01:26,640 --> 00:01:28,080
always work well when reviewing services

57
00:01:28,080 --> 00:01:29,840
organizations largely because in many

58
00:01:29,840 --> 00:01:30,320
cases

59
00:01:30,320 --> 00:01:32,560
uh there just isn't a lot of surface for

60
00:01:32,560 --> 00:01:33,840
services organizations

61
00:01:33,840 --> 00:01:35,840
they'll have some typical business use

62
00:01:35,840 --> 00:01:37,600
case stuff female servers dns servers

63
00:01:37,600 --> 00:01:38,320
maybe but

64
00:01:38,320 --> 00:01:40,159
not dozens and dozens of hosts you

65
00:01:40,159 --> 00:01:41,759
should look anyway there's a pretty good

66
00:01:41,759 --> 00:01:43,200
chance that you'll get some kind of

67
00:01:43,200 --> 00:01:46,240
read on how well they know technology

68
00:01:46,240 --> 00:01:48,240
based on what you find

69
00:01:48,240 --> 00:01:50,240
so right now the way that most

70
00:01:50,240 --> 00:01:52,240
businesses do vendor risk assessments is

71
00:01:52,240 --> 00:01:52,799
to send

72
00:01:52,799 --> 00:01:54,240
the vendor a spreadsheet full of

73
00:01:54,240 --> 00:01:56,719
questions and essentially the vendors

74
00:01:56,719 --> 00:01:57,600
tend to just lie

75
00:01:57,600 --> 00:01:59,680
into it this makes the insurance and

76
00:01:59,680 --> 00:02:00,880
compliance people happy

77
00:02:00,880 --> 00:02:02,320
but it is absolutely nothing for

78
00:02:02,320 --> 00:02:04,560
security whatsoever so despite knowing

79
00:02:04,560 --> 00:02:06,079
this businesses continue to operate in

80
00:02:06,079 --> 00:02:07,119
this manner

81
00:02:07,119 --> 00:02:08,800
there's a lot of pearl clutching and

82
00:02:08,800 --> 00:02:10,560
gasping that happens when the vendor

83
00:02:10,560 --> 00:02:11,280
that told them

84
00:02:11,280 --> 00:02:12,319
in the spreadsheet that they were

85
00:02:12,319 --> 00:02:13,680
hardened ends up getting in the news

86
00:02:13,680 --> 00:02:15,360
like solarwinds did

87
00:02:15,360 --> 00:02:17,280
they like to feign surprise but what's

88
00:02:17,280 --> 00:02:18,720
really happening in reality is that the

89
00:02:18,720 --> 00:02:19,360
business

90
00:02:19,360 --> 00:02:21,120
tends to do the absolute least amount of

91
00:02:21,120 --> 00:02:22,959
work that they can legally get away with

92
00:02:22,959 --> 00:02:24,560
and the sentiment around this topic

93
00:02:24,560 --> 00:02:26,800
tends to be who cares we're insured

94
00:02:26,800 --> 00:02:28,400
we're protected by contractual language

95
00:02:28,400 --> 00:02:30,000
and a platoon of lawyers which

96
00:02:30,000 --> 00:02:31,680
makes the business risk people happy but

97
00:02:31,680 --> 00:02:33,120
again does absolutely nothing to

98
00:02:33,120 --> 00:02:35,680
mitigate any actual risk whatsoever

99
00:02:35,680 --> 00:02:37,440
when the lawyers are happy it just means

100
00:02:37,440 --> 00:02:39,120
we have a defensible position from

101
00:02:39,120 --> 00:02:40,160
getting sued

102
00:02:40,160 --> 00:02:42,319
not we're confident that we can repel

103
00:02:42,319 --> 00:02:45,200
firepower of some magnitude

104
00:02:45,200 --> 00:02:46,959
so the whole endeavor here is just lip

105
00:02:46,959 --> 00:02:48,640
service to legal and compliance

106
00:02:48,640 --> 00:02:50,400
requirements it's only done at all

107
00:02:50,400 --> 00:02:51,840
because businesses will put strongly

108
00:02:51,840 --> 00:02:52,720
worded language

109
00:02:52,720 --> 00:02:54,879
in their pci socks or hipaa policies and

110
00:02:54,879 --> 00:02:56,319
then when the auditors show up they have

111
00:02:56,319 --> 00:02:57,519
to somehow figure out a way to

112
00:02:57,519 --> 00:02:58,879
demonstrate that they're actually doing

113
00:02:58,879 --> 00:03:00,640
what they say they're doing in those

114
00:03:00,640 --> 00:03:03,920
in those policies and there's usually a

115
00:03:03,920 --> 00:03:06,080
lot of fidgeting and ums and odds

116
00:03:06,080 --> 00:03:08,480
so in many cases businesses employ the

117
00:03:08,480 --> 00:03:10,400
use of what are called risk acceptance

118
00:03:10,400 --> 00:03:11,280
forms

119
00:03:11,280 --> 00:03:12,879
and those tend to be another sort of

120
00:03:12,879 --> 00:03:15,040
hack tip towards the lawyers

121
00:03:15,040 --> 00:03:18,400
in nearly every case a risk acceptance

122
00:03:18,400 --> 00:03:20,080
form is a type of attestation

123
00:03:20,080 --> 00:03:22,400
saying my business unit the one that's

124
00:03:22,400 --> 00:03:24,000
making this absurd request

125
00:03:24,000 --> 00:03:25,760
will take the responsibility of dealing

126
00:03:25,760 --> 00:03:27,599
with the outcome of bad stuff since

127
00:03:27,599 --> 00:03:29,200
we're casting security overboard and

128
00:03:29,200 --> 00:03:30,799
replacing it with these two paragraphs

129
00:03:30,799 --> 00:03:33,280
of text the problem with this concept is

130
00:03:33,280 --> 00:03:35,200
that again in nearly every case if

131
00:03:35,200 --> 00:03:36,400
something terrible does

132
00:03:36,400 --> 00:03:39,040
actually happen it's not that business

133
00:03:39,040 --> 00:03:40,799
unit that has to deal with it it's the

134
00:03:40,799 --> 00:03:42,400
company lawyers

135
00:03:42,400 --> 00:03:43,680
it's interesting to me that nobody has

136
00:03:43,680 --> 00:03:45,280
caught on to that yet or maybe they have

137
00:03:45,280 --> 00:03:46,560
and there's some arrangement that we

138
00:03:46,560 --> 00:03:47,920
can't see because the boundaries of

139
00:03:47,920 --> 00:03:48,640
these large or

140
00:03:48,640 --> 00:03:50,480
large orgs tend to be opaque like

141
00:03:50,480 --> 00:03:51,840
equifax for example

142
00:03:51,840 --> 00:03:53,360
who lied to congress and got away with

143
00:03:53,360 --> 00:03:56,000
it it's all smoke and mirrors to appease

144
00:03:56,000 --> 00:03:58,159
insurance carriers basically so

145
00:03:58,159 --> 00:04:00,799
all of that being said what can we

146
00:04:00,799 --> 00:04:01,360
actually

147
00:04:01,360 --> 00:04:03,599
do about it i know i've made it sound

148
00:04:03,599 --> 00:04:05,280
pretty bad but surprisingly the answer

149
00:04:05,280 --> 00:04:05,760
is

150
00:04:05,760 --> 00:04:08,239
uh pretty easy and kind of fun uh we do

151
00:04:08,239 --> 00:04:09,120
it ourselves

152
00:04:09,120 --> 00:04:10,959
i see a lot of folks complain on twitter

153
00:04:10,959 --> 00:04:12,159
that they don't get a chance to do the

154
00:04:12,159 --> 00:04:14,080
cool red team stuff in their jobs

155
00:04:14,080 --> 00:04:16,000
but this is a perfect opportunity to get

156
00:04:16,000 --> 00:04:18,000
some sort of like diet version of that

157
00:04:18,000 --> 00:04:19,519
you'll be able to play evil hacker and

158
00:04:19,519 --> 00:04:21,040
find terrible things

159
00:04:21,040 --> 00:04:22,400
there's a lot of material that exists

160
00:04:22,400 --> 00:04:24,400
today for helping folks do bug bounties

161
00:04:24,400 --> 00:04:25,759
and a lot of open source intelligence

162
00:04:25,759 --> 00:04:26,160
work

163
00:04:26,160 --> 00:04:28,320
as well as discovery and enumeration and

164
00:04:28,320 --> 00:04:29,680
all these skills on deck

165
00:04:29,680 --> 00:04:31,199
uh are on deck for this sort of

166
00:04:31,199 --> 00:04:33,680
assessment work you can keep your skills

167
00:04:33,680 --> 00:04:36,080
sharp and in many cases uh it's good fun

168
00:04:36,080 --> 00:04:37,120
up until the part where you have to

169
00:04:37,120 --> 00:04:38,800
report findings because something like

170
00:04:38,800 --> 00:04:39,840
half the time

171
00:04:39,840 --> 00:04:40,960
um you're going to be raining on

172
00:04:40,960 --> 00:04:42,880
somebody's parade

173
00:04:42,880 --> 00:04:44,800
so setting boundaries is important it is

174
00:04:44,800 --> 00:04:46,240
unlikely that you'll be able to

175
00:04:46,240 --> 00:04:48,639
spend the amount of time that you want

176
00:04:48,639 --> 00:04:49,520
on any

177
00:04:49,520 --> 00:04:50,960
one of these given assessments

178
00:04:50,960 --> 00:04:52,479
especially if there's a bunch of them to

179
00:04:52,479 --> 00:04:53,040
do

180
00:04:53,040 --> 00:04:54,639
in many cases you'll get stuck having to

181
00:04:54,639 --> 00:04:56,639
do five or ten sometimes

182
00:04:56,639 --> 00:04:58,240
the business will ask you to do like a

183
00:04:58,240 --> 00:04:59,680
shootout between several different

184
00:04:59,680 --> 00:05:00,479
vendors and

185
00:05:00,479 --> 00:05:02,560
you're supposed to give them results

186
00:05:02,560 --> 00:05:03,520
that they have to like

187
00:05:03,520 --> 00:05:05,039
you know choose the best out of three or

188
00:05:05,039 --> 00:05:08,159
what have you um

189
00:05:08,320 --> 00:05:10,240
it's not a pen test you don't need to go

190
00:05:10,240 --> 00:05:11,919
deep um you don't need

191
00:05:11,919 --> 00:05:14,080
uh to penetrate anything or exploit

192
00:05:14,080 --> 00:05:15,039
anything necessarily

193
00:05:15,039 --> 00:05:17,199
you just have to get an idea of what the

194
00:05:17,199 --> 00:05:18,160
surface is like

195
00:05:18,160 --> 00:05:20,880
and what their behavior is like uh from

196
00:05:20,880 --> 00:05:21,919
the equipment that they put on the

197
00:05:21,919 --> 00:05:22,880
internet

198
00:05:22,880 --> 00:05:24,560
all you're looking for here are patterns

199
00:05:24,560 --> 00:05:26,320
of behavior and there's a pretty

200
00:05:26,320 --> 00:05:28,400
broad spectrum of stuff to look for uh

201
00:05:28,400 --> 00:05:30,000
there's also a handful of top-level

202
00:05:30,000 --> 00:05:31,840
categories that we can cover

203
00:05:31,840 --> 00:05:34,240
easy and fast ones things like checking

204
00:05:34,240 --> 00:05:36,800
news websites for their org name

205
00:05:36,800 --> 00:05:38,320
have they been in the news at all

206
00:05:38,320 --> 00:05:40,800
recently uh if so why

207
00:05:40,800 --> 00:05:42,880
was it interesting or relevant did it

208
00:05:42,880 --> 00:05:44,000
give you pause

209
00:05:44,000 --> 00:05:45,520
can you find them on linkedin or

210
00:05:45,520 --> 00:05:47,280
instagram do they have official accounts

211
00:05:47,280 --> 00:05:48,560
on various platforms

212
00:05:48,560 --> 00:05:50,160
if they do what do they post is it

213
00:05:50,160 --> 00:05:52,080
benign or does it worry you

214
00:05:52,080 --> 00:05:54,160
who's in charge is there ceso someone

215
00:05:54,160 --> 00:05:55,440
that was scraping barnacles off a

216
00:05:55,440 --> 00:05:57,039
rowboat 18 months ago

217
00:05:57,039 --> 00:05:58,319
do the people running the show appear to

218
00:05:58,319 --> 00:06:00,160
have any idea what they're doing have

219
00:06:00,160 --> 00:06:01,759
those people been in the news

220
00:06:01,759 --> 00:06:03,039
this stuff is almost entirely just

221
00:06:03,039 --> 00:06:04,560
google darking and this stage is just

222
00:06:04,560 --> 00:06:06,000
looking around for big public

223
00:06:06,000 --> 00:06:07,280
news that would measure up to being

224
00:06:07,280 --> 00:06:09,759
either good or bad it's a

225
00:06:09,759 --> 00:06:12,720
sort of the first layer of the onion

226
00:06:12,720 --> 00:06:13,520
next

227
00:06:13,520 --> 00:06:15,759
we can get into more granular stuff like

228
00:06:15,759 --> 00:06:17,520
posts from employees on various social

229
00:06:17,520 --> 00:06:18,720
media platforms

230
00:06:18,720 --> 00:06:20,560
evaluating what their digital perimeter

231
00:06:20,560 --> 00:06:23,199
looks like seeing if they have devs and

232
00:06:23,199 --> 00:06:25,919
if those devs are leaking stuff checking

233
00:06:25,919 --> 00:06:27,199
leak databases to see

234
00:06:27,199 --> 00:06:30,479
if they openly employ nazis for example

235
00:06:30,479 --> 00:06:31,840
sometimes you'll find nothing other

236
00:06:31,840 --> 00:06:33,919
times you'll find private ssh keys or

237
00:06:33,919 --> 00:06:35,919
rampant racism or abuse

238
00:06:35,919 --> 00:06:37,360
maybe glassdoor has a bunch of

239
00:06:37,360 --> 00:06:38,720
complaints about them and that their

240
00:06:38,720 --> 00:06:40,160
head of tech support used to be the head

241
00:06:40,160 --> 00:06:41,680
of tech support for a cable company and

242
00:06:41,680 --> 00:06:42,880
was hired intentionally to make

243
00:06:42,880 --> 00:06:44,479
customers miserable

244
00:06:44,479 --> 00:06:46,000
maybe they're trying to stop employees

245
00:06:46,000 --> 00:06:47,600
who are attempting to unionize

246
00:06:47,600 --> 00:06:48,960
maybe they really don't like gay people

247
00:06:48,960 --> 00:06:50,720
buying wedding cakes maybe they sell

248
00:06:50,720 --> 00:06:52,560
equipment to oppressive regimes that use

249
00:06:52,560 --> 00:06:54,240
that equipment to kill people

250
00:06:54,240 --> 00:06:56,080
um and maybe these sorts of things are

251
00:06:56,080 --> 00:06:57,120
things that you don't want any

252
00:06:57,120 --> 00:06:58,800
involvement with whatsoever

253
00:06:58,800 --> 00:07:00,800
uh this stage will give you an idea of

254
00:07:00,800 --> 00:07:02,319
the sort of culture

255
00:07:02,319 --> 00:07:03,759
inside of the business and what the

256
00:07:03,759 --> 00:07:06,319
people do what kind of people

257
00:07:06,319 --> 00:07:08,800
do they hire how do they groom them how

258
00:07:08,800 --> 00:07:09,919
do they how does

259
00:07:09,919 --> 00:07:11,840
uh how does that interplay with the

260
00:07:11,840 --> 00:07:13,440
world around them and their customers

261
00:07:13,440 --> 00:07:14,560
what happens when they have a good day

262
00:07:14,560 --> 00:07:16,639
or a bad day if any of this stuff is

263
00:07:16,639 --> 00:07:18,639
is discoverable it's all interesting

264
00:07:18,639 --> 00:07:20,400
stuff that will ma will

265
00:07:20,400 --> 00:07:22,560
somehow fit into your metric for how to

266
00:07:22,560 --> 00:07:24,479
decide whether or not to use this vendor

267
00:07:24,479 --> 00:07:26,080
all this becomes relevant because if

268
00:07:26,080 --> 00:07:27,599
you're the gatekeeper of whether the

269
00:07:27,599 --> 00:07:28,960
business gets involved with them it's up

270
00:07:28,960 --> 00:07:30,800
to you to be as informed as you can

271
00:07:30,800 --> 00:07:32,240
with these things since the entire

272
00:07:32,240 --> 00:07:33,840
intention here is essentially to avoid

273
00:07:33,840 --> 00:07:35,840
surprises

274
00:07:35,840 --> 00:07:38,400
sometimes the things that you can find

275
00:07:38,400 --> 00:07:40,160
are really easy and straightforward

276
00:07:40,160 --> 00:07:42,160
um they will tell you a lot about how

277
00:07:42,160 --> 00:07:43,840
seriously given company takes their own

278
00:07:43,840 --> 00:07:44,639
security

279
00:07:44,639 --> 00:07:46,720
leaking certificates or internal assets

280
00:07:46,720 --> 00:07:48,400
web servers with poor configuration or

281
00:07:48,400 --> 00:07:49,919
that leak sensitive files

282
00:07:49,919 --> 00:07:52,000
lots of open ports that shouldn't be

283
00:07:52,000 --> 00:07:53,759
open or stuff that shouldn't be public

284
00:07:53,759 --> 00:07:56,080
holes and firewalls poked to get to

285
00:07:56,080 --> 00:07:57,199
internal assets

286
00:07:57,199 --> 00:07:58,800
devs and staging systems scattered all

287
00:07:58,800 --> 00:08:00,479
over the internet uh usually super

288
00:08:00,479 --> 00:08:01,039
broken

289
00:08:01,039 --> 00:08:04,000
exposed secrets or or like who puts dev

290
00:08:04,000 --> 00:08:05,759
and staging servers in the sim like why

291
00:08:05,759 --> 00:08:07,280
would you log those right so you can

292
00:08:07,280 --> 00:08:08,800
beat up on those all day and nobody will

293
00:08:08,800 --> 00:08:09,680
ever notice

294
00:08:09,680 --> 00:08:11,840
the list gets really long really fast

295
00:08:11,840 --> 00:08:13,520
but at this point you're just sniffing

296
00:08:13,520 --> 00:08:14,879
for clues in the hopes of finding

297
00:08:14,879 --> 00:08:16,560
patterns of behavior that will give you

298
00:08:16,560 --> 00:08:19,120
an idea of what to put in your dossier

299
00:08:19,120 --> 00:08:21,280
so there's an incredibly wide range of

300
00:08:21,280 --> 00:08:22,720
findings that you could be searching for

301
00:08:22,720 --> 00:08:24,560
and largely they're going to depend on

302
00:08:24,560 --> 00:08:26,720
like what the company that you're

303
00:08:26,720 --> 00:08:28,080
investigating does like what's their

304
00:08:28,080 --> 00:08:28,960
line of business

305
00:08:28,960 --> 00:08:30,639
uh what you're looking for is evidence

306
00:08:30,639 --> 00:08:32,080
of either them doing

307
00:08:32,080 --> 00:08:34,240
stuff right or them doing stuff wrong

308
00:08:34,240 --> 00:08:36,159
maybe somewhere in between but

309
00:08:36,159 --> 00:08:38,640
that's the angle here some kind of

310
00:08:38,640 --> 00:08:40,000
measurable thing that will give you

311
00:08:40,000 --> 00:08:41,519
enough of an impression about how they

312
00:08:41,519 --> 00:08:42,159
behave

313
00:08:42,159 --> 00:08:43,519
and if that's acceptable given the

314
00:08:43,519 --> 00:08:45,200
context of your business relationship

315
00:08:45,200 --> 00:08:46,399
with them or the

316
00:08:46,399 --> 00:08:48,560
soon-to-be business relationship uh the

317
00:08:48,560 --> 00:08:49,680
school of thought here is that the same

318
00:08:49,680 --> 00:08:51,120
people who maintain the equipment

319
00:08:51,120 --> 00:08:52,640
attached to the internet

320
00:08:52,640 --> 00:08:54,240
are the same people who maintain the

321
00:08:54,240 --> 00:08:56,080
equipment that's attached to the land

322
00:08:56,080 --> 00:08:59,120
uh this obviously will vary uh but it's

323
00:08:59,120 --> 00:09:00,080
not

324
00:09:00,080 --> 00:09:01,839
it's not always exactly the same people

325
00:09:01,839 --> 00:09:03,200
maybe it's the same department

326
00:09:03,200 --> 00:09:04,399
maybe it'll be different departments

327
00:09:04,399 --> 00:09:06,320
depending on geographic location in that

328
00:09:06,320 --> 00:09:07,600
case there's a lot of wiggle room and

329
00:09:07,600 --> 00:09:08,959
configuration drift

330
00:09:08,959 --> 00:09:11,040
so generally speaking it may be one or

331
00:09:11,040 --> 00:09:12,880
two groups inside of an it department

332
00:09:12,880 --> 00:09:15,360
who are all governed by the same rules

333
00:09:15,360 --> 00:09:16,640
so if you spot terrible things on the

334
00:09:16,640 --> 00:09:19,200
perimeter it means the business is okay

335
00:09:19,200 --> 00:09:20,800
with those terrible things being there

336
00:09:20,800 --> 00:09:22,000
because they were intentionally

337
00:09:22,000 --> 00:09:24,320
configured that way and made public

338
00:09:24,320 --> 00:09:26,080
you can safely make the assumption that

339
00:09:26,080 --> 00:09:28,320
systems behind the network boundary

340
00:09:28,320 --> 00:09:30,399
are likely worse since in very many

341
00:09:30,399 --> 00:09:32,320
cases

342
00:09:32,320 --> 00:09:34,000
in nearly all of them a company will

343
00:09:34,000 --> 00:09:35,440
only do the absolute bare minimum

344
00:09:35,440 --> 00:09:37,120
required by their compliance framework

345
00:09:37,120 --> 00:09:38,399
and nothing else

346
00:09:38,399 --> 00:09:40,640
and nearly every one of those were

347
00:09:40,640 --> 00:09:42,399
written by accountants and lawyers

348
00:09:42,399 --> 00:09:44,320
not technology people so the language

349
00:09:44,320 --> 00:09:45,680
tends to be incredibly vague

350
00:09:45,680 --> 00:09:47,360
and give no direction for how to do

351
00:09:47,360 --> 00:09:48,800
stuff correctly

352
00:09:48,800 --> 00:09:50,800
and often they're heavily abused and

353
00:09:50,800 --> 00:09:52,560
come peppered with gotchas caveats

354
00:09:52,560 --> 00:09:53,839
logical fallacies

355
00:09:53,839 --> 00:09:57,120
and super fat assumptions so a great

356
00:09:57,120 --> 00:09:58,800
thing to look for is ancient equipment

357
00:09:58,800 --> 00:09:59,120
and

358
00:09:59,120 --> 00:10:01,760
unpatched gear if you find something

359
00:10:01,760 --> 00:10:02,240
like

360
00:10:02,240 --> 00:10:05,600
iis-7 on the internet or maybe iis 8.5

361
00:10:05,600 --> 00:10:07,279
that telegraphs quite a lot

362
00:10:07,279 --> 00:10:09,040
uh obviously the business is okay with

363
00:10:09,040 --> 00:10:10,800
having that stuff um

364
00:10:10,800 --> 00:10:12,959
never the business was okay with having

365
00:10:12,959 --> 00:10:14,399
stuff that will never get patched

366
00:10:14,399 --> 00:10:16,480
again exposed to the internet and they

367
00:10:16,480 --> 00:10:17,839
found some sort of like legally

368
00:10:17,839 --> 00:10:19,360
defensible way to argue that this

369
00:10:19,360 --> 00:10:20,560
somehow is okay

370
00:10:20,560 --> 00:10:21,680
usually because of insurance or

371
00:10:21,680 --> 00:10:23,279
compliance or this isn't in scope or

372
00:10:23,279 --> 00:10:24,240
whatever

373
00:10:24,240 --> 00:10:26,480
um there's a list of excuses that they

374
00:10:26,480 --> 00:10:28,000
can use that's a mile long but at the

375
00:10:28,000 --> 00:10:28,959
end of the day

376
00:10:28,959 --> 00:10:31,200
if you look at a place today in 2021 and

377
00:10:31,200 --> 00:10:32,720
they have windows xp

378
00:10:32,720 --> 00:10:34,640
three-year-old versions of juniper pulse

379
00:10:34,640 --> 00:10:36,000
land desk appliances

380
00:10:36,000 --> 00:10:37,760
the admin interface to their pbx and

381
00:10:37,760 --> 00:10:39,760
phpmyadmin and a bunch of samba ports

382
00:10:39,760 --> 00:10:40,800
open to the internet

383
00:10:40,800 --> 00:10:42,399
it's a pretty safe bet you're planning

384
00:10:42,399 --> 00:10:44,560
on sending that vendor your data

385
00:10:44,560 --> 00:10:46,560
it likely won't be safe for very long

386
00:10:46,560 --> 00:10:48,160
because you can guarantee that

387
00:10:48,160 --> 00:10:49,600
you if you were able to find all that

388
00:10:49,600 --> 00:10:52,640
stuff um other people can just as easily

389
00:10:52,640 --> 00:10:52,880
and

390
00:10:52,880 --> 00:10:54,959
it's also very likely you weren't the

391
00:10:54,959 --> 00:10:56,320
first to find it

392
00:10:56,320 --> 00:10:58,399
so maybe the thing that they sell is

393
00:10:58,399 --> 00:10:59,279
supposed to be the thing that you're

394
00:10:59,279 --> 00:11:01,200
buying and maybe it's an on-prem piece

395
00:11:01,200 --> 00:11:02,160
of equipment

396
00:11:02,160 --> 00:11:04,000
if the perimeter looks like that you can

397
00:11:04,000 --> 00:11:05,760
bet that they put less security effort

398
00:11:05,760 --> 00:11:07,279
into the thing that they sell

399
00:11:07,279 --> 00:11:09,120
nobody's holding a gun to their head so

400
00:11:09,120 --> 00:11:11,519
they just don't do it

401
00:11:11,519 --> 00:11:14,079
abandoned equipment tends to leak that

402
00:11:14,079 --> 00:11:15,600
the business isn't good about cleaning

403
00:11:15,600 --> 00:11:17,200
up their messes and will often

404
00:11:17,200 --> 00:11:19,120
be riddled with technical debt well

405
00:11:19,120 --> 00:11:21,200
places like this get ransomware because

406
00:11:21,200 --> 00:11:23,360
they happily create attack surfaces that

407
00:11:23,360 --> 00:11:24,560
are publicly exposed

408
00:11:24,560 --> 00:11:26,079
and the more stuff you have online the

409
00:11:26,079 --> 00:11:27,600
easier it is for attackers to break in

410
00:11:27,600 --> 00:11:29,600
and metric is pretty straightforward

411
00:11:29,600 --> 00:11:32,160
if you discover some five-year-old

412
00:11:32,160 --> 00:11:33,760
wordpress blog that you can trivially

413
00:11:33,760 --> 00:11:34,480
pop

414
00:11:34,480 --> 00:11:36,399
um chances are good that the cred that

415
00:11:36,399 --> 00:11:37,839
there are creds in it and

416
00:11:37,839 --> 00:11:40,399
the chances that those creds are the

417
00:11:40,399 --> 00:11:41,839
current active directory password for

418
00:11:41,839 --> 00:11:43,040
whoever that user is are

419
00:11:43,040 --> 00:11:45,200
pretty high uh and again they're

420
00:11:45,200 --> 00:11:46,720
probably running oa and they probably

421
00:11:46,720 --> 00:11:47,200
don't have

422
00:11:47,200 --> 00:11:50,480
2fa so here we are again the category or

423
00:11:50,480 --> 00:11:52,480
this category largely covers things like

424
00:11:52,480 --> 00:11:53,600
third-party hosting

425
00:11:53,600 --> 00:11:55,760
cloud services if they aren't a fully

426
00:11:55,760 --> 00:11:56,800
cloud shop already

427
00:11:56,800 --> 00:11:58,320
or other third-party stuff that's not

428
00:11:58,320 --> 00:12:00,720
sort of their core business services

429
00:12:00,720 --> 00:12:02,399
which have to be exposed to the internet

430
00:12:02,399 --> 00:12:04,959
dev servers staging servers test boxes

431
00:12:04,959 --> 00:12:06,399
marketing campaigns

432
00:12:06,399 --> 00:12:07,120
stuff that should have been

433
00:12:07,120 --> 00:12:08,720
decommissioned or cleaned up a long time

434
00:12:08,720 --> 00:12:10,000
ago but instead were for some

435
00:12:10,000 --> 00:12:12,399
reason left to ferment on the internet

436
00:12:12,399 --> 00:12:13,519
like a fine milk

437
00:12:13,519 --> 00:12:16,480
or maybe a durian often times you'll

438
00:12:16,480 --> 00:12:16,880
find

439
00:12:16,880 --> 00:12:18,959
internal hosts that are for some reason

440
00:12:18,959 --> 00:12:20,079
online

441
00:12:20,079 --> 00:12:21,839
holes poked in firewalls stuff that

442
00:12:21,839 --> 00:12:23,519
labels itself intranet either by

443
00:12:23,519 --> 00:12:25,200
hostname or ssl cert or perhaps

444
00:12:25,200 --> 00:12:27,600
rfc 1918 addresses and public dns that

445
00:12:27,600 --> 00:12:29,360
have really descriptive host names

446
00:12:29,360 --> 00:12:31,680
um i classified jira and confluence as

447
00:12:31,680 --> 00:12:32,480
this

448
00:12:32,480 --> 00:12:34,079
like if i can get at your main code

449
00:12:34,079 --> 00:12:35,600
repository from the internet that's a

450
00:12:35,600 --> 00:12:36,560
bad thing

451
00:12:36,560 --> 00:12:38,240
and if i can get at your main company

452
00:12:38,240 --> 00:12:40,079
wiki from the internet that's also a bad

453
00:12:40,079 --> 00:12:40,399
thing

454
00:12:40,399 --> 00:12:42,399
it means anyone else can and those creds

455
00:12:42,399 --> 00:12:43,760
that someone left on that 400 year old

456
00:12:43,760 --> 00:12:44,720
wordpress blog

457
00:12:44,720 --> 00:12:47,440
they might work in jira and confluence

458
00:12:47,440 --> 00:12:48,000
what about

459
00:12:48,000 --> 00:12:50,480
jenkins or what about bamboo that's how

460
00:12:50,480 --> 00:12:52,399
ricotta got popped if you remember

461
00:12:52,399 --> 00:12:54,079
that camera company they had jenkins on

462
00:12:54,079 --> 00:12:55,440
their perimeter just exposed to the

463
00:12:55,440 --> 00:12:55,920
world

464
00:12:55,920 --> 00:12:56,959
and someone noticed that the

465
00:12:56,959 --> 00:12:58,800
groovyscript console was enabled and

466
00:12:58,800 --> 00:13:00,720
just one shot to sheld them

467
00:13:00,720 --> 00:13:02,720
uh then from there got into every single

468
00:13:02,720 --> 00:13:04,079
one of their customers

469
00:13:04,079 --> 00:13:05,760
camera systems including amazon and

470
00:13:05,760 --> 00:13:07,920
tesla and octa so things caught fire

471
00:13:07,920 --> 00:13:09,040
incredibly quickly

472
00:13:09,040 --> 00:13:10,639
uh i get that everyone is going to cloud

473
00:13:10,639 --> 00:13:12,079
these days but you know what else you

474
00:13:12,079 --> 00:13:13,279
can put in the cloud

475
00:13:13,279 --> 00:13:15,760
firewalls uh firewalls that have network

476
00:13:15,760 --> 00:13:17,760
segmentation and vpn capabilities

477
00:13:17,760 --> 00:13:19,519
so just because there's a bunch of boxes

478
00:13:19,519 --> 00:13:20,880
in the cloud doesn't necessarily mean

479
00:13:20,880 --> 00:13:21,600
that they have to be

480
00:13:21,600 --> 00:13:23,920
all publicly accessible all the time you

481
00:13:23,920 --> 00:13:25,360
can have stuff in the cloud structured

482
00:13:25,360 --> 00:13:26,560
logically

483
00:13:26,560 --> 00:13:27,920
just like in a data center with network

484
00:13:27,920 --> 00:13:29,600
segments and security boundaries it

485
00:13:29,600 --> 00:13:30,560
works

486
00:13:30,560 --> 00:13:32,160
so if a company is leaving systems

487
00:13:32,160 --> 00:13:33,760
public which are classified as both

488
00:13:33,760 --> 00:13:35,200
internal and cloud

489
00:13:35,200 --> 00:13:37,200
this should telegraph a lot to you they

490
00:13:37,200 --> 00:13:38,320
think it's cool to leave

491
00:13:38,320 --> 00:13:41,120
internal resources public and if they

492
00:13:41,120 --> 00:13:42,880
are a vendor that is going to be housing

493
00:13:42,880 --> 00:13:43,680
your data

494
00:13:43,680 --> 00:13:45,519
it is reasonable to assume that your

495
00:13:45,519 --> 00:13:46,880
data is going to live in those public

496
00:13:46,880 --> 00:13:48,079
servers and that should probably

497
00:13:48,079 --> 00:13:50,800
give you pause there's a story i could

498
00:13:50,800 --> 00:13:51,680
tell

499
00:13:51,680 --> 00:13:53,360
about that time i was part of the hack

500
00:13:53,360 --> 00:13:54,720
the pentagon

501
00:13:54,720 --> 00:13:56,720
the hack the pentagon bug bounty and i

502
00:13:56,720 --> 00:13:58,399
found a blue coat proxy server on the

503
00:13:58,399 --> 00:14:00,000
usmc's network in langley that was

504
00:14:00,000 --> 00:14:02,000
misconfigured to accept proxy requests

505
00:14:02,000 --> 00:14:04,880
from the public interface so like set

506
00:14:04,880 --> 00:14:06,880
your browser proxy to that ip and bam

507
00:14:06,880 --> 00:14:08,160
suddenly you're proxying from the

508
00:14:08,160 --> 00:14:09,600
internet into their lan

509
00:14:09,600 --> 00:14:11,120
because somebody checked the wrong box

510
00:14:11,120 --> 00:14:13,279
in the config maybe plug

511
00:14:13,279 --> 00:14:15,519
that into proxy chains and i don't know

512
00:14:15,519 --> 00:14:17,199
and map that military network

513
00:14:17,199 --> 00:14:20,320
from the internet um if you find a web

514
00:14:20,320 --> 00:14:22,160
endpoint check to see if it's a proxy

515
00:14:22,160 --> 00:14:24,480
sometimes you get really lucky and in

516
00:14:24,480 --> 00:14:25,760
those circumstances

517
00:14:25,760 --> 00:14:27,680
again this finding telegraphs quite a

518
00:14:27,680 --> 00:14:29,519
lot if you can get to their land like

519
00:14:29,519 --> 00:14:30,079
that

520
00:14:30,079 --> 00:14:33,600
who else can or already has

521
00:14:33,600 --> 00:14:35,199
you'll also run into the circumstance of

522
00:14:35,199 --> 00:14:37,600
where a large org has

523
00:14:37,600 --> 00:14:40,480
multiple offices in cities or countries

524
00:14:40,480 --> 00:14:41,040
and

525
00:14:41,040 --> 00:14:42,800
those multiple offices will also have

526
00:14:42,800 --> 00:14:44,880
their own tech people and those

527
00:14:44,880 --> 00:14:47,519
tech people may not see eye to eye one

528
00:14:47,519 --> 00:14:48,959
group may be strong in linux

529
00:14:48,959 --> 00:14:50,720
another may be really strong in windows

530
00:14:50,720 --> 00:14:52,959
maybe palo versus cisco

531
00:14:52,959 --> 00:14:53,760
there are a lot of different

532
00:14:53,760 --> 00:14:55,600
permutations here but the concept is

533
00:14:55,600 --> 00:14:57,040
that when you have technologists that

534
00:14:57,040 --> 00:14:57,440
don't

535
00:14:57,440 --> 00:14:59,519
agree on stuff and the business seems to

536
00:14:59,519 --> 00:15:01,519
have multiple technology personality

537
00:15:01,519 --> 00:15:02,399
syndrome

538
00:15:02,399 --> 00:15:04,079
it seems to suggest that the people who

539
00:15:04,079 --> 00:15:05,839
operate in that space follow the

540
00:15:05,839 --> 00:15:07,680
that's someone else's problem school of

541
00:15:07,680 --> 00:15:09,920
thought and in nearly every circumstance

542
00:15:09,920 --> 00:15:12,399
the it department will say we'll say

543
00:15:12,399 --> 00:15:14,000
security is someone else's problem

544
00:15:14,000 --> 00:15:15,760
so this ends up being a sort of race to

545
00:15:15,760 --> 00:15:17,040
the bottom of who can do the least

546
00:15:17,040 --> 00:15:18,880
possible amount of work

547
00:15:18,880 --> 00:15:20,560
again terrible for the security posture

548
00:15:20,560 --> 00:15:21,920
of a company as a whole

549
00:15:21,920 --> 00:15:23,519
but it creates a bunch of fun places

550
00:15:23,519 --> 00:15:25,600
that you can shim a tax stuff in

551
00:15:25,600 --> 00:15:26,880
if you find a vendor exhibiting this

552
00:15:26,880 --> 00:15:28,639
behavior don't be surprised if their

553
00:15:28,639 --> 00:15:30,079
support department is either complete

554
00:15:30,079 --> 00:15:31,759
garbage or friendly but unable to

555
00:15:31,759 --> 00:15:33,120
actually get anything done

556
00:15:33,120 --> 00:15:34,399
because when you submit a request to

557
00:15:34,399 --> 00:15:36,079
that support department it's going to go

558
00:15:36,079 --> 00:15:37,600
to their qa department or their i.t

559
00:15:37,600 --> 00:15:39,600
people or what have you

560
00:15:39,600 --> 00:15:41,279
otherwise a department that says this

561
00:15:41,279 --> 00:15:43,120
isn't my problem send it somewhere else

562
00:15:43,120 --> 00:15:44,639
to which they will begrudgingly send it

563
00:15:44,639 --> 00:15:46,160
somewhere else and get exactly the same

564
00:15:46,160 --> 00:15:47,680
response so

565
00:15:47,680 --> 00:15:49,120
some interesting colorful stuff that

566
00:15:49,120 --> 00:15:50,320
happens behind the scenes if for some

567
00:15:50,320 --> 00:15:51,839
reason tech support just never ever gets

568
00:15:51,839 --> 00:15:53,199
back to you

569
00:15:53,199 --> 00:15:55,440
let's do some live fire examples uh well

570
00:15:55,440 --> 00:15:56,800
as live fires we can

571
00:15:56,800 --> 00:15:58,959
as we can for this recorded talk uh so

572
00:15:58,959 --> 00:15:59,839
this is celebrity

573
00:15:59,839 --> 00:16:01,759
a company who recently was in the news

574
00:16:01,759 --> 00:16:03,360
because moxie marlon spike discovered

575
00:16:03,360 --> 00:16:03,759
that

576
00:16:03,759 --> 00:16:05,519
their hardware for taking data off of

577
00:16:05,519 --> 00:16:07,360
phones has absolutely no defenses in it

578
00:16:07,360 --> 00:16:08,079
whatsoever

579
00:16:08,079 --> 00:16:09,839
and is trivially exploited so like he

580
00:16:09,839 --> 00:16:11,759
wrote some exploits that popped the

581
00:16:11,759 --> 00:16:12,480
device

582
00:16:12,480 --> 00:16:13,839
and did this sort of proof-of-concept

583
00:16:13,839 --> 00:16:15,759
message box thing just as a show

584
00:16:15,759 --> 00:16:17,839
but what it made clear was that

585
00:16:17,839 --> 00:16:19,440
celebrity didn't ever consider the

586
00:16:19,440 --> 00:16:20,959
security implications of plugging a

587
00:16:20,959 --> 00:16:22,959
device into their equipment

588
00:16:22,959 --> 00:16:24,639
that tried to hack it like they never

589
00:16:24,639 --> 00:16:26,160
once configured that they would plug an

590
00:16:26,160 --> 00:16:27,519
iphone into their

591
00:16:27,519 --> 00:16:29,040
their equipment that i guess i think

592
00:16:29,040 --> 00:16:31,839
it's running windows um

593
00:16:31,839 --> 00:16:35,279
and that device could transmit malware

594
00:16:35,279 --> 00:16:37,680
like the concept never occurred to them

595
00:16:37,680 --> 00:16:38,320
um like

596
00:16:38,320 --> 00:16:39,600
i wonder what else they don't pay

597
00:16:39,600 --> 00:16:41,199
attention to and having a look at their

598
00:16:41,199 --> 00:16:42,720
main website we can see that

599
00:16:42,720 --> 00:16:44,320
it's just another unpatched wordpress

600
00:16:44,320 --> 00:16:46,320
blog so their main corporate website i

601
00:16:46,320 --> 00:16:47,440
guess

602
00:16:47,440 --> 00:16:49,600
and in addition to a multitude of

603
00:16:49,600 --> 00:16:50,720
wordpress bones

604
00:16:50,720 --> 00:16:52,880
there's also like a debug.log file off

605
00:16:52,880 --> 00:16:53,759
their main domain

606
00:16:53,759 --> 00:16:55,519
that is available that leaks all sorts

607
00:16:55,519 --> 00:16:56,720
of details about the wordpress

608
00:16:56,720 --> 00:16:57,600
installation

609
00:16:57,600 --> 00:16:59,040
um you'd think a company that sells

610
00:16:59,040 --> 00:17:00,240
high-end security equipment to law

611
00:17:00,240 --> 00:17:01,920
enforcement would exhibit some like

612
00:17:01,920 --> 00:17:03,920
decorum with regards to security but i

613
00:17:03,920 --> 00:17:04,720
guess not

614
00:17:04,720 --> 00:17:06,640
i spent maybe 15 minutes looking into

615
00:17:06,640 --> 00:17:08,240
celebrate when they made the news

616
00:17:08,240 --> 00:17:11,119
i found a lot in 15 minutes another

617
00:17:11,119 --> 00:17:12,640
great one is experian

618
00:17:12,640 --> 00:17:13,919
who was also in the news recently for

619
00:17:13,919 --> 00:17:16,640
more huge data leaks surprise surprise

620
00:17:16,640 --> 00:17:18,079
there's some really telling stuff on

621
00:17:18,079 --> 00:17:19,919
their public perimeter like here's one

622
00:17:19,919 --> 00:17:20,480
host

623
00:17:20,480 --> 00:17:22,799
that has dot int in uh in the host name

624
00:17:22,799 --> 00:17:24,240
for a bunch of subdomains that are all

625
00:17:24,240 --> 00:17:25,919
attached to one ip

626
00:17:25,919 --> 00:17:28,960
and the screenshots show uh

627
00:17:28,960 --> 00:17:31,200
it shows unconfigured iis and super

628
00:17:31,200 --> 00:17:32,960
verbose error messages

629
00:17:32,960 --> 00:17:34,480
all on the same host and i see a lot of

630
00:17:34,480 --> 00:17:36,240
help desk stuff um

631
00:17:36,240 --> 00:17:38,320
account management stuff all on this one

632
00:17:38,320 --> 00:17:39,600
on this one ip

633
00:17:39,600 --> 00:17:42,320
so in theory if you shell this host i

634
00:17:42,320 --> 00:17:43,520
imagine there's a bunch of nifty stuff

635
00:17:43,520 --> 00:17:45,280
on there ranging from passwords to user

636
00:17:45,280 --> 00:17:47,520
info possibly help desk trouble tickets

637
00:17:47,520 --> 00:17:48,640
what goes into those you think i don't

638
00:17:48,640 --> 00:17:50,799
know ssl certs vpn creds

639
00:17:50,799 --> 00:17:53,600
user imagination lots of fun stuff oh

640
00:17:53,600 --> 00:17:54,160
and if you

641
00:17:54,160 --> 00:17:56,799
if you pop that host here's several

642
00:17:56,799 --> 00:17:58,160
there are several dozen

643
00:17:58,160 --> 00:18:00,160
rfc 1918 addresses that they put in

644
00:18:00,160 --> 00:18:01,760
their public dns for some reason so

645
00:18:01,760 --> 00:18:04,480
great you pop the help desk api and once

646
00:18:04,480 --> 00:18:05,679
you breach that server

647
00:18:05,679 --> 00:18:07,440
in theory now you have access to their

648
00:18:07,440 --> 00:18:09,440
lan and now you have access to these

649
00:18:09,440 --> 00:18:10,559
hosts which you know

650
00:18:10,559 --> 00:18:13,039
exists and now you know uh it's ip

651
00:18:13,039 --> 00:18:14,559
because for some reason

652
00:18:14,559 --> 00:18:17,600
um it's in their public dns like whoever

653
00:18:17,600 --> 00:18:19,440
admins their dns doesn't get the dns as

654
00:18:19,440 --> 00:18:20,240
public

655
00:18:20,240 --> 00:18:22,320
um and putting private address

656
00:18:22,320 --> 00:18:24,080
information in public dns is leaking

657
00:18:24,080 --> 00:18:24,799
data

658
00:18:24,799 --> 00:18:28,080
uh about their lan there are uh these

659
00:18:28,080 --> 00:18:29,280
are just two hosts obviously for

660
00:18:29,280 --> 00:18:30,720
experian but you get the idea

661
00:18:30,720 --> 00:18:32,080
if this is what their perimeter looks

662
00:18:32,080 --> 00:18:33,280
like and their perimeter is supposed to

663
00:18:33,280 --> 00:18:34,640
be hardened because it's connected to

664
00:18:34,640 --> 00:18:35,840
the internet imagine what their lan

665
00:18:35,840 --> 00:18:36,960
looks like

666
00:18:36,960 --> 00:18:38,960
having learned this about experian do

667
00:18:38,960 --> 00:18:40,320
you feel comfortable with them holding

668
00:18:40,320 --> 00:18:41,360
on to your data

669
00:18:41,360 --> 00:18:43,520
do you think that if you and some

670
00:18:43,520 --> 00:18:44,559
friends have circled up with some

671
00:18:44,559 --> 00:18:46,320
laptops on a weekend and turn their wan

672
00:18:46,320 --> 00:18:48,000
into your own private ctf you'd get a

673
00:18:48,000 --> 00:18:49,120
high score

674
00:18:49,120 --> 00:18:50,880
i mean i'm not saying go and do it i'm

675
00:18:50,880 --> 00:18:53,440
saying you remember family fun center

676
00:18:53,440 --> 00:18:56,480
that oh and in the case of uh

677
00:18:56,480 --> 00:18:58,080
if if networking doesn't do it for you

678
00:18:58,080 --> 00:18:59,840
and dns doesn't do it for you either

679
00:18:59,840 --> 00:19:01,600
um then here's a site apparently they

680
00:19:01,600 --> 00:19:02,880
have on their way on that allows you to

681
00:19:02,880 --> 00:19:04,400
change a user's password

682
00:19:04,400 --> 00:19:06,960
if you know their current password so

683
00:19:06,960 --> 00:19:07,840
like there's

684
00:19:07,840 --> 00:19:09,760
something like 2.5 terabyte of password

685
00:19:09,760 --> 00:19:11,120
leak data just floating around on the

686
00:19:11,120 --> 00:19:12,000
internet you can just

687
00:19:12,000 --> 00:19:14,240
get for free what could possibly go

688
00:19:14,240 --> 00:19:15,440
wrong

689
00:19:15,440 --> 00:19:18,320
right so you have to do this for like 10

690
00:19:18,320 --> 00:19:20,240
or 15 orgs

691
00:19:20,240 --> 00:19:22,320
in a short period of time and you might

692
00:19:22,320 --> 00:19:23,679
get stressed out uh

693
00:19:23,679 --> 00:19:25,679
these things are kinda sorta like mini

694
00:19:25,679 --> 00:19:27,120
pen tests but without the actual

695
00:19:27,120 --> 00:19:28,160
exploitation

696
00:19:28,160 --> 00:19:29,919
um you're just scoping stuff out to get

697
00:19:29,919 --> 00:19:31,600
an idea of what sort of nonsense you

698
00:19:31,600 --> 00:19:32,799
could be in for

699
00:19:32,799 --> 00:19:34,640
and you won't always find complete trash

700
00:19:34,640 --> 00:19:36,160
fires sometimes you'll

701
00:19:36,160 --> 00:19:39,360
find like one host and a site

702
00:19:39,360 --> 00:19:41,120
uh or maybe four or five hosts and like

703
00:19:41,120 --> 00:19:43,120
no open ports but there are legitimately

704
00:19:43,120 --> 00:19:44,000
some

705
00:19:44,000 --> 00:19:46,080
hardened shops out there uh they may

706
00:19:46,080 --> 00:19:48,160
only turn up one out of every 10 or 20

707
00:19:48,160 --> 00:19:50,000
times and they are a pleasant surprise

708
00:19:50,000 --> 00:19:51,600
they do exist but they are few and far

709
00:19:51,600 --> 00:19:52,640
between

710
00:19:52,640 --> 00:19:54,720
it is though this is a bunch of work so

711
00:19:54,720 --> 00:19:56,400
we had phobos we automated this because

712
00:19:56,400 --> 00:19:57,600
we do this quite a lot

713
00:19:57,600 --> 00:20:00,480
um our product is engineered to do this

714
00:20:00,480 --> 00:20:01,760
largely so that we don't have to do it

715
00:20:01,760 --> 00:20:03,200
by hand anymore

716
00:20:03,200 --> 00:20:06,559
so every angle i've talked about so far

717
00:20:06,559 --> 00:20:08,159
in this talk has been a thing that we

718
00:20:08,159 --> 00:20:09,919
built into orbital um

719
00:20:09,919 --> 00:20:12,080
so this isn't really like a vuln finder

720
00:20:12,080 --> 00:20:13,919
tool not exactly i've

721
00:20:13,919 --> 00:20:15,120
i've referred to it as sort of a

722
00:20:15,120 --> 00:20:17,039
dividing rod for shells

723
00:20:17,039 --> 00:20:18,159
it's not going to make the compliance

724
00:20:18,159 --> 00:20:20,000
auditors very excited but it'll it'll

725
00:20:20,000 --> 00:20:21,360
probably make the red and blue team's

726
00:20:21,360 --> 00:20:23,600
eyebrows do a little dance

727
00:20:23,600 --> 00:20:26,720
so the tldr here is basically that we're

728
00:20:26,720 --> 00:20:28,480
doing like a threat model

729
00:20:28,480 --> 00:20:31,679
um specifically for the relationship

730
00:20:31,679 --> 00:20:34,000
between your business and the vendor

731
00:20:34,000 --> 00:20:36,080
um it's a very limited one and for the

732
00:20:36,080 --> 00:20:37,520
narrow circumstance of like

733
00:20:37,520 --> 00:20:39,200
what happens is if this vendor gets

734
00:20:39,200 --> 00:20:41,200
popped or otherwise has some huge issue

735
00:20:41,200 --> 00:20:43,280
how is that going to impact my company

736
00:20:43,280 --> 00:20:44,480
who is the vendor

737
00:20:44,480 --> 00:20:46,400
what are they going to be doing for you

738
00:20:46,400 --> 00:20:48,000
what data are you going to be

739
00:20:48,000 --> 00:20:50,159
letting them have access to what will

740
00:20:50,159 --> 00:20:51,120
they be doing

741
00:20:51,120 --> 00:20:53,919
with that data what happens if they have

742
00:20:53,919 --> 00:20:54,480
a problem

743
00:20:54,480 --> 00:20:57,360
involving your data um what happens if

744
00:20:57,360 --> 00:20:59,120
they have an insider threat

745
00:20:59,120 --> 00:21:00,799
and that person has access to your data

746
00:21:00,799 --> 00:21:02,400
or your network uh

747
00:21:02,400 --> 00:21:04,240
will they have physical access to your

748
00:21:04,240 --> 00:21:05,440
office or your data center

749
00:21:05,440 --> 00:21:07,440
like put your bad guy hat on and imagine

750
00:21:07,440 --> 00:21:08,640
if you were

751
00:21:08,640 --> 00:21:10,960
this vendor and you wanted to do damage

752
00:21:10,960 --> 00:21:12,000
to your company

753
00:21:12,000 --> 00:21:13,919
what would you do what data would you go

754
00:21:13,919 --> 00:21:15,280
after would you go after people would

755
00:21:15,280 --> 00:21:16,000
you go after data

756
00:21:16,000 --> 00:21:19,360
systems uh spoofing fishing the world is

757
00:21:19,360 --> 00:21:21,600
your oyster use your imagination

758
00:21:21,600 --> 00:21:22,960
write that all down because that's now

759
00:21:22,960 --> 00:21:24,640
your threat model glue that to your

760
00:21:24,640 --> 00:21:25,919
dossier and turn it in with your

761
00:21:25,919 --> 00:21:26,640
findings

762
00:21:26,640 --> 00:21:28,720
the folks who make the decision on

763
00:21:28,720 --> 00:21:30,240
whether or not to pay this vendor for

764
00:21:30,240 --> 00:21:31,120
their services

765
00:21:31,120 --> 00:21:33,600
will very much appreciate knowing what

766
00:21:33,600 --> 00:21:35,679
specific flavor of they could get

767
00:21:35,679 --> 00:21:38,559
if things go pear-shaped um and in

768
00:21:38,559 --> 00:21:40,159
nearly every case the whole point of the

769
00:21:40,159 --> 00:21:40,559
stuff

770
00:21:40,559 --> 00:21:43,200
is to avoid surprises you could also

771
00:21:43,200 --> 00:21:44,000
consider a tabletop

772
00:21:44,000 --> 00:21:46,640
exercise what scenario could you invent

773
00:21:46,640 --> 00:21:48,559
uh that could involve this vendor

774
00:21:48,559 --> 00:21:50,240
could they introduce ransomware to your

775
00:21:50,240 --> 00:21:51,760
network could they steal your data could

776
00:21:51,760 --> 00:21:53,440
they blackmail people

777
00:21:53,440 --> 00:21:56,480
what could you do to deal with it or

778
00:21:56,480 --> 00:21:57,360
recover

779
00:21:57,360 --> 00:21:59,440
are there boundaries or contingencies

780
00:21:59,440 --> 00:22:01,440
stopping you from being able to react in

781
00:22:01,440 --> 00:22:03,280
the event that something bad happens

782
00:22:03,280 --> 00:22:05,200
do you have a disaster recovery plan do

783
00:22:05,200 --> 00:22:07,120
you have a crisis management plan

784
00:22:07,120 --> 00:22:08,960
what if your first plan fails do you

785
00:22:08,960 --> 00:22:10,400
have a plan b

786
00:22:10,400 --> 00:22:12,799
um these are what this is where things

787
00:22:12,799 --> 00:22:13,919
get pretty interesting

788
00:22:13,919 --> 00:22:15,280
um and this is where things start to

789
00:22:15,280 --> 00:22:16,799
intersect with like the red team world

790
00:22:16,799 --> 00:22:17,280
because

791
00:22:17,280 --> 00:22:19,360
in doing this kind of work since 2008

792
00:22:19,360 --> 00:22:20,799
i've never once heard

793
00:22:20,799 --> 00:22:23,039
of a red team scenario or exercise where

794
00:22:23,039 --> 00:22:24,720
the narrative is

795
00:22:24,720 --> 00:22:26,960
like so your offsite backup vendor got

796
00:22:26,960 --> 00:22:28,960
popped and the attackers got access to

797
00:22:28,960 --> 00:22:30,960
hash dumps because you back up whole vms

798
00:22:30,960 --> 00:22:32,960
or your domain controllers or

799
00:22:32,960 --> 00:22:35,440
um the chat tool that you use was

800
00:22:35,440 --> 00:22:36,880
compromised and it turns out that they

801
00:22:36,880 --> 00:22:39,039
actually lied in that vendor

802
00:22:39,039 --> 00:22:40,559
security assessment spreadsheet you sent

803
00:22:40,559 --> 00:22:41,840
to them and they actually store

804
00:22:41,840 --> 00:22:43,440
everything in plain text on disk so all

805
00:22:43,440 --> 00:22:44,720
of your chat logs and all your file

806
00:22:44,720 --> 00:22:46,559
attachments are just somewhere on

807
00:22:46,559 --> 00:22:49,679
some ext4 partition they can just grab

808
00:22:49,679 --> 00:22:51,600
maybe these sorts of gigs do happen i

809
00:22:51,600 --> 00:22:53,440
just have not heard of them happening so

810
00:22:53,440 --> 00:22:54,720
at least from where i'm sitting these

811
00:22:54,720 --> 00:22:55,600
are

812
00:22:55,600 --> 00:22:58,320
this is sort of

813
00:23:00,080 --> 00:23:03,440
uncharted waters so

814
00:23:03,440 --> 00:23:06,320
ultimately at the end of the day you

815
00:23:06,320 --> 00:23:08,080
have to make a decision

816
00:23:08,080 --> 00:23:10,080
of whether or not to do business with

817
00:23:10,080 --> 00:23:11,520
this vendor you're investigating

818
00:23:11,520 --> 00:23:12,880
and given the findings that you've

819
00:23:12,880 --> 00:23:14,559
learned about the vendor do you think

820
00:23:14,559 --> 00:23:15,760
that the risk is too high

821
00:23:15,760 --> 00:23:17,760
or not or somewhere in between do you

822
00:23:17,760 --> 00:23:19,360
feel better or worse about the vendor

823
00:23:19,360 --> 00:23:21,120
having investigated them

824
00:23:21,120 --> 00:23:24,320
all of this goes in your dossier so

825
00:23:24,320 --> 00:23:26,320
in a perfect world there would be guard

826
00:23:26,320 --> 00:23:27,760
rails around

827
00:23:27,760 --> 00:23:30,240
onboarding of a new vendor since black

828
00:23:30,240 --> 00:23:31,840
black box appliances

829
00:23:31,840 --> 00:23:33,919
and on-prem software have quickly become

830
00:23:33,919 --> 00:23:35,440
sort of the darling attack vector of

831
00:23:35,440 --> 00:23:36,559
2021.

832
00:23:36,559 --> 00:23:38,159
um these scenarios are super fun and

833
00:23:38,159 --> 00:23:40,159
super cool uh to play out and like a

834
00:23:40,159 --> 00:23:41,600
role playing or tabletop

835
00:23:41,600 --> 00:23:42,880
sort of thing or if you can somehow work

836
00:23:42,880 --> 00:23:44,240
them into a red team gig these are

837
00:23:44,240 --> 00:23:46,080
really juicy things that

838
00:23:46,080 --> 00:23:48,480
not a lot of people get to to you know

839
00:23:48,480 --> 00:23:50,159
walk that path uh because it makes

840
00:23:50,159 --> 00:23:52,159
businesses incredibly nervous

841
00:23:52,159 --> 00:23:54,080
um if you have the opportunity to do

842
00:23:54,080 --> 00:23:55,520
this stuff in house i highly encourage

843
00:23:55,520 --> 00:23:56,400
you to do it

844
00:23:56,400 --> 00:23:58,240
because you can get incredibly creative

845
00:23:58,240 --> 00:23:59,360
everyone is going to have a really good

846
00:23:59,360 --> 00:24:00,880
time and it's a fantastic way to get

847
00:24:00,880 --> 00:24:02,400
various teams to work together and learn

848
00:24:02,400 --> 00:24:03,600
from one another

849
00:24:03,600 --> 00:24:05,200
one of the best and most lucrative sort

850
00:24:05,200 --> 00:24:06,720
of learning experiences you can have

851
00:24:06,720 --> 00:24:08,240
using this sort of framework is to sort

852
00:24:08,240 --> 00:24:08,960
of

853
00:24:08,960 --> 00:24:11,600
come up with like a dnd type scenario

854
00:24:11,600 --> 00:24:13,679
and pit red team versus blue team

855
00:24:13,679 --> 00:24:16,480
uh against one another or uh create a

856
00:24:16,480 --> 00:24:18,320
scenario where you whereby you have

857
00:24:18,320 --> 00:24:19,760
um the red team and the blue team

858
00:24:19,760 --> 00:24:21,919
discover a live attacker in an

859
00:24:21,919 --> 00:24:23,440
environment and now have to sort of work

860
00:24:23,440 --> 00:24:24,240
together

861
00:24:24,240 --> 00:24:26,960
uh to fend off the sort of common enemy

862
00:24:26,960 --> 00:24:28,960
it's a fantastic way to get into all the

863
00:24:28,960 --> 00:24:30,480
various permutations of how weird stuff

864
00:24:30,480 --> 00:24:31,600
can go sideways

865
00:24:31,600 --> 00:24:34,480
and it'll give both maybe three teams

866
00:24:34,480 --> 00:24:35,840
four teams however many there are

867
00:24:35,840 --> 00:24:38,480
a great opportunity to come up with fun

868
00:24:38,480 --> 00:24:39,840
weird stuff on the fly

869
00:24:39,840 --> 00:24:41,440
and all of that fun weird stuff that

870
00:24:41,440 --> 00:24:43,039
comes up ends up going into the threat

871
00:24:43,039 --> 00:24:43,840
model and

872
00:24:43,840 --> 00:24:47,360
the more robust these um

873
00:24:47,360 --> 00:24:49,919
endeavors become uh the more sort of

874
00:24:49,919 --> 00:24:51,279
everybody wins because at the end of the

875
00:24:51,279 --> 00:24:52,799
day the objective is to

876
00:24:52,799 --> 00:24:55,760
sort of move forward safely so uh

877
00:24:55,760 --> 00:24:57,200
hopefully you found this useful

878
00:24:57,200 --> 00:24:59,120
i will be around for questions and thank

879
00:24:59,120 --> 00:25:01,840
you very much

