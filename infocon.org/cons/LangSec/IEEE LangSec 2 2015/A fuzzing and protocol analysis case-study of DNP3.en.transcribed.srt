1
00:00:00,979 --> 00:00:09,149
so my name is Adam<font color="#CCCCCC"> crane I'm a software</font>

2
00:00:05,670 --> 00:00:11,269
<font color="#CCCCCC">engineer and the SCADA</font><font color="#E5E5E5"> automation kind</font>

3
00:00:09,150 --> 00:00:14,040
of power area<font color="#E5E5E5"> I've been doing that</font><font color="#CCCCCC"> for</font>

4
00:00:11,269 --> 00:00:15,360
about a decade<font color="#E5E5E5"> so I guess you know</font>

5
00:00:14,040 --> 00:00:17,099
<font color="#CCCCCC">Sergey said this talk is about the</font>

6
00:00:15,360 --> 00:00:19,020
systems<font color="#CCCCCC"> that</font><font color="#E5E5E5"> keep the lights on I guess</font>

7
00:00:17,100 --> 00:00:23,820
I'm the<font color="#E5E5E5"> software engineer that writes</font>

8
00:00:19,020 --> 00:00:25,109
the bugs that<font color="#E5E5E5"> turns the lights off</font><font color="#CCCCCC"> in a</font>

9
00:00:23,820 --> 00:00:26,580
protocol we're going to talk<font color="#E5E5E5"> about is</font>

10
00:00:25,109 --> 00:00:31,109
called<font color="#E5E5E5"> dnp3 and it's actually an I</font>

11
00:00:26,580 --> 00:00:34,800
Triple E standard<font color="#E5E5E5"> as of about 2010 or 11</font>

12
00:00:31,109 --> 00:00:37,829
I think<font color="#E5E5E5"> so I want to assume that people</font>

13
00:00:34,800 --> 00:00:40,890
<font color="#CCCCCC">know too much about SCADA so give you a</font>

14
00:00:37,829 --> 00:00:43,350
really quick<font color="#E5E5E5"> rundown</font><font color="#CCCCCC"> SCADA is kind of</font><font color="#E5E5E5"> a</font>

15
00:00:40,890 --> 00:00:45,329
subcategory<font color="#E5E5E5"> of all industrial control</font>

16
00:00:43,350 --> 00:00:46,950
systems and<font color="#E5E5E5"> the characteristics that</font>

17
00:00:45,329 --> 00:00:49,230
make<font color="#E5E5E5"> its cater generally a couple of</font>

18
00:00:46,950 --> 00:00:51,449
things<font color="#E5E5E5"> they're geographically</font>

19
00:00:49,230 --> 00:00:54,839
distributed<font color="#E5E5E5"> so you're monitoring some</font>

20
00:00:51,449 --> 00:00:56,550
process that<font color="#CCCCCC"> is over</font><font color="#E5E5E5"> like</font><font color="#CCCCCC"> maybe in a</font>

21
00:00:54,840 --> 00:01:00,120
large span of areas<font color="#CCCCCC"> you can think</font><font color="#E5E5E5"> about</font>

22
00:00:56,550 --> 00:01:01,500
the systems that<font color="#E5E5E5"> kind of monitor all the</font>

23
00:01:00,120 --> 00:01:03,709
<font color="#E5E5E5">electric substations you have in the</font>

24
00:01:01,500 --> 00:01:08,250
field<font color="#E5E5E5"> or maybe you're you know managing</font>

25
00:01:03,710 --> 00:01:09,510
<font color="#E5E5E5">water flows in a water system and it's</font>

26
00:01:08,250 --> 00:01:11,460
you<font color="#CCCCCC"> know the communications are</font>

27
00:01:09,510 --> 00:01:12,900
generally hub-and-spoke and centralized

28
00:01:11,460 --> 00:01:14,820
so you have some kind of control<font color="#E5E5E5"> center</font>

29
00:01:12,900 --> 00:01:16,890
<font color="#E5E5E5">that's really trying to monitor all the</font>

30
00:01:14,820 --> 00:01:19,490
things are<font color="#E5E5E5"> going on the field and for</font>

31
00:01:16,890 --> 00:01:21,780
<font color="#E5E5E5">the most part this processes are able</font><font color="#CCCCCC"> to</font>

32
00:01:19,490 --> 00:01:23,610
kind of protect themselves over the

33
00:01:21,780 --> 00:01:24,780
<font color="#CCCCCC">short-term</font><font color="#E5E5E5"> there's some kind</font><font color="#CCCCCC"> of logic</font>

34
00:01:23,610 --> 00:01:27,780
distributed out in the field and this

35
00:01:24,780 --> 00:01:29,729
<font color="#E5E5E5">communication may come and</font><font color="#CCCCCC"> go based</font><font color="#E5E5E5"> on</font>

36
00:01:27,780 --> 00:01:33,060
you know<font color="#E5E5E5"> if the storm comes in you need</font>

37
00:01:29,729 --> 00:01:34,650
your things to kind<font color="#CCCCCC"> of be able</font><font color="#E5E5E5"> to keep</font>

38
00:01:33,060 --> 00:01:38,610
keep things<font color="#CCCCCC"> going in the</font><font color="#E5E5E5"> absence of that</font>

39
00:01:34,650 --> 00:01:39,570
<font color="#E5E5E5">you know supervisory control but you</font>

40
00:01:38,610 --> 00:01:42,150
know<font color="#CCCCCC"> because these things</font><font color="#E5E5E5"> are</font>

41
00:01:39,570 --> 00:01:44,148
geographically distributed<font color="#E5E5E5"> these all</font>

42
00:01:42,150 --> 00:01:46,049
kinds all<font color="#E5E5E5"> manner of communication</font>

43
00:01:44,149 --> 00:01:48,630
<font color="#E5E5E5">technologies to get out to those remote</font>

44
00:01:46,049 --> 00:01:50,009
<font color="#E5E5E5">endpoints</font><font color="#CCCCCC"> so you may</font><font color="#E5E5E5"> be surprised</font><font color="#CCCCCC"> to</font>

45
00:01:48,630 --> 00:01:52,170
learn that like a large portion<font color="#CCCCCC"> of the</font>

46
00:01:50,009 --> 00:01:54,030
communications infrastructure for the

47
00:01:52,170 --> 00:01:57,329
electric power grid<font color="#CCCCCC"> is still over 1200</font>

48
00:01:54,030 --> 00:01:59,219
baud modems<font color="#CCCCCC"> for instance and most of the</font>

49
00:01:57,329 --> 00:02:00,809
protocols in<font color="#E5E5E5"> this space were designed to</font>

50
00:01:59,219 --> 00:02:02,820
<font color="#E5E5E5">work over</font><font color="#CCCCCC"> the sort of legacy</font><font color="#E5E5E5"> serial</font>

51
00:02:00,810 --> 00:02:04,229
networks<font color="#E5E5E5"> and now have been kind of</font>

52
00:02:02,820 --> 00:02:05,908
transformed and maybe<font color="#CCCCCC"> they've</font><font color="#E5E5E5"> add</font>

53
00:02:04,229 --> 00:02:07,979
encapsulation or maybe they have<font color="#CCCCCC"> they've</font>

54
00:02:05,909 --> 00:02:12,560
removed it<font color="#E5E5E5"> and now it's</font><font color="#CCCCCC"> all being</font><font color="#E5E5E5"> you</font>

55
00:02:07,979 --> 00:02:12,560
know<font color="#E5E5E5"> kind</font><font color="#CCCCCC"> of put over bear-bear TCP</font>

56
00:02:13,510 --> 00:02:19,970
<font color="#E5E5E5">dnp3 was kind of a first in this area</font>

57
00:02:17,780 --> 00:02:23,810
<font color="#E5E5E5">you know if you were in electric power</font>

58
00:02:19,970 --> 00:02:25,640
kind of in the early 90s mid 90s you

59
00:02:23,810 --> 00:02:27,319
bought like<font color="#CCCCCC"> a monolithic solution stack</font>

60
00:02:25,640 --> 00:02:29,208
from one vendor and they gouged you for

61
00:02:27,319 --> 00:02:31,399
it<font color="#E5E5E5"> and you had no ability</font><font color="#CCCCCC"> to you know</font>

62
00:02:29,209 --> 00:02:33,349
<font color="#E5E5E5">pick other equipment or</font><font color="#CCCCCC"> things from</font>

63
00:02:31,400 --> 00:02:34,760
<font color="#CCCCCC">different vendors</font><font color="#E5E5E5"> so it was kind of a</font>

64
00:02:33,349 --> 00:02:37,040
first<font color="#E5E5E5"> effort to say here's a standard</font>

65
00:02:34,760 --> 00:02:40,010
<font color="#CCCCCC">all the</font><font color="#E5E5E5"> vendors will implement it people</font>

66
00:02:37,040 --> 00:02:41,569
can pick and<font color="#CCCCCC"> choose and and just</font><font color="#E5E5E5"> really</font>

67
00:02:40,010 --> 00:02:46,160
was an attempt<font color="#CCCCCC"> to kind</font><font color="#E5E5E5"> of avoid vendor</font>

68
00:02:41,569 --> 00:02:47,929
lock-in<font color="#CCCCCC"> but like many standards</font><font color="#E5E5E5"> people</font>

69
00:02:46,160 --> 00:02:50,090
<font color="#CCCCCC">could resist the urge to add things to</font>

70
00:02:47,930 --> 00:02:53,569
it<font color="#CCCCCC"> and things</font><font color="#E5E5E5"> kept</font><font color="#CCCCCC"> getting bolted on and</font>

71
00:02:50,090 --> 00:02:55,609
bolted on and<font color="#E5E5E5"> bolted on</font><font color="#CCCCCC"> you know this is</font>

72
00:02:53,569 --> 00:02:58,280
not your grandma's RFC this thing has

73
00:02:55,609 --> 00:02:59,810
about<font color="#CCCCCC"> 1,200</font><font color="#E5E5E5"> pages to read through if you</font>

74
00:02:58,280 --> 00:03:00,950
go and<font color="#E5E5E5"> download the spec so we have a</font>

75
00:02:59,810 --> 00:03:03,290
few people<font color="#CCCCCC"> in</font><font color="#E5E5E5"> this room that</font><font color="#CCCCCC"> I've known</font>

76
00:03:00,950 --> 00:03:06,200
have looked at<font color="#E5E5E5"> encoding different levels</font>

77
00:03:03,290 --> 00:03:08,720
of this protocol<font color="#CCCCCC"> and you know toolkits</font>

78
00:03:06,200 --> 00:03:10,790
like hammer they can tell you it's it's

79
00:03:08,720 --> 00:03:12,379
<font color="#E5E5E5">not simple when you start</font><font color="#CCCCCC"> going through</font>

80
00:03:10,790 --> 00:03:14,120
<font color="#E5E5E5">all the different possible and coatings</font>

81
00:03:12,379 --> 00:03:16,190
and<font color="#E5E5E5"> data types and it's I think</font><font color="#CCCCCC"> as</font>

82
00:03:14,120 --> 00:03:17,690
Meredith said it s for a couple<font color="#E5E5E5"> years</font>

83
00:03:16,190 --> 00:03:18,590
<font color="#CCCCCC">ago it's you know deeply into</font>

84
00:03:17,690 --> 00:03:20,750
<font color="#E5E5E5">context-sensitive</font>

85
00:03:18,590 --> 00:03:23,329
territory and also<font color="#CCCCCC"> has an enormous</font>

86
00:03:20,750 --> 00:03:26,389
<font color="#E5E5E5">amount</font><font color="#CCCCCC"> of state so implementing</font><font color="#E5E5E5"> this is</font>

87
00:03:23,329 --> 00:03:29,510
a real<font color="#CCCCCC"> problem and doing it securely is</font>

88
00:03:26,389 --> 00:03:33,500
I don't<font color="#CCCCCC"> know if anyone's going to</font><font color="#E5E5E5"> be</font>

89
00:03:29,510 --> 00:03:35,060
able<font color="#E5E5E5"> to do it reasonably quickly over</font>

90
00:03:33,500 --> 00:03:36,889
the architecture the protocol like I

91
00:03:35,060 --> 00:03:38,870
said it's<font color="#E5E5E5"> it's a legacy serial protocols</font>

92
00:03:36,889 --> 00:03:41,379
<font color="#CCCCCC">it has its own link layer with crcs for</font>

93
00:03:38,870 --> 00:03:43,220
error correction<font color="#CCCCCC"> it</font><font color="#E5E5E5"> has a very crude</font><font color="#CCCCCC"> um</font>

94
00:03:41,379 --> 00:03:46,069
transport layer that<font color="#E5E5E5"> does kind</font><font color="#CCCCCC"> of in</font>

95
00:03:43,220 --> 00:03:48,829
<font color="#E5E5E5">order</font><font color="#CCCCCC"> reassembly so you'll get messages</font>

96
00:03:46,069 --> 00:03:50,839
here that are about 300<font color="#E5E5E5"> bytes and</font>

97
00:03:48,829 --> 00:03:52,879
multiple ones of those accumulating the

98
00:03:50,840 --> 00:03:54,290
link<font color="#E5E5E5"> transport layer assembler up to an</font>

99
00:03:52,879 --> 00:03:57,709
<font color="#E5E5E5">application layer message that is</font>

100
00:03:54,290 --> 00:04:00,048
usually<font color="#E5E5E5"> no bigger than about</font><font color="#CCCCCC"> 2k and at</font>

101
00:03:57,709 --> 00:04:03,919
that green application layer that's

102
00:04:00,049 --> 00:04:06,079
where your your skata semantics are

103
00:04:03,919 --> 00:04:08,780
things<font color="#E5E5E5"> like control messages to open a</font>

104
00:04:06,079 --> 00:04:12,280
breaker<font color="#E5E5E5"> or open a valve or turn on a</font>

105
00:04:08,780 --> 00:04:14,629
pump<font color="#E5E5E5"> and data back from</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> field</font>

106
00:04:12,280 --> 00:04:17,449
measurement values like you<font color="#CCCCCC"> know</font><font color="#E5E5E5"> binary</font>

107
00:04:14,629 --> 00:04:20,238
<font color="#CCCCCC">as a</font><font color="#E5E5E5"> breaker open</font><font color="#CCCCCC"> and closed or you know</font>

108
00:04:17,449 --> 00:04:22,820
what's the<font color="#E5E5E5"> reading for current or</font>

109
00:04:20,238 --> 00:04:26,810
<font color="#CCCCCC">voltage on a line</font>

110
00:04:22,820 --> 00:04:28,650
so at a very very<font color="#CCCCCC"> high level</font>

111
00:04:26,810 --> 00:04:30,630
<font color="#CCCCCC">application-layer messages look like</font>

112
00:04:28,650 --> 00:04:36,599
this in<font color="#E5E5E5"> dnp3 you've got a function code</font>

113
00:04:30,630 --> 00:04:39,000
and then you have zero<font color="#E5E5E5"> or more object</font>

114
00:04:36,600 --> 00:04:42,390
headers that<font color="#E5E5E5"> follow and the encoding of</font>

115
00:04:39,000 --> 00:04:44,610
this is<font color="#E5E5E5"> highly irregular and depends on</font>

116
00:04:42,390 --> 00:04:47,700
<font color="#E5E5E5">the different types of you</font><font color="#CCCCCC"> know header</font>

117
00:04:44,610 --> 00:04:48,990
types that<font color="#E5E5E5"> you have there and then so</font>

118
00:04:47,700 --> 00:04:51,300
the semantics of<font color="#E5E5E5"> the messages themselves</font>

119
00:04:48,990 --> 00:04:54,840
<font color="#E5E5E5">are really</font><font color="#CCCCCC"> a combination of function</font>

120
00:04:51,300 --> 00:04:57,960
codes<font color="#E5E5E5"> and objects and the spec doesn't</font>

121
00:04:54,840 --> 00:05:00,450
<font color="#E5E5E5">really say it says which you're allowed</font>

122
00:04:57,960 --> 00:05:02,580
but it place no limitations on all the

123
00:05:00,450 --> 00:05:04,590
<font color="#E5E5E5">different permutations of objects</font><font color="#CCCCCC"> that</font>

124
00:05:02,580 --> 00:05:06,359
<font color="#E5E5E5">you can pair with function codes so you</font>

125
00:05:04,590 --> 00:05:08,039
<font color="#E5E5E5">can do all kinds</font><font color="#CCCCCC"> of operations in a</font>

126
00:05:06,360 --> 00:05:10,290
single<font color="#CCCCCC"> message because the meaning of</font>

127
00:05:08,040 --> 00:05:12,600
this function codes<font color="#CCCCCC"> is very overloaded</font>

128
00:05:10,290 --> 00:05:14,760
so a<font color="#CCCCCC"> write means completely</font><font color="#E5E5E5"> different</font>

129
00:05:12,600 --> 00:05:15,960
things you know are<font color="#E5E5E5"> you writing the time</font>

130
00:05:14,760 --> 00:05:17,490
and date are<font color="#E5E5E5"> you trying to do a time</font>

131
00:05:15,960 --> 00:05:21,030
synchronization<font color="#E5E5E5"> or you're</font><font color="#CCCCCC"> doing a write</font>

132
00:05:17,490 --> 00:05:23,190
<font color="#E5E5E5">to actually open</font><font color="#CCCCCC"> or close something</font><font color="#E5E5E5"> are</font>

133
00:05:21,030 --> 00:05:26,159
you<font color="#E5E5E5"> writing a file or you</font><font color="#CCCCCC"> can do all</font>

134
00:05:23,190 --> 00:05:27,810
three<font color="#E5E5E5"> in</font><font color="#CCCCCC"> one message right so there's</font>

135
00:05:26,160 --> 00:05:29,400
very little constraint<font color="#E5E5E5"> placed on the</font>

136
00:05:27,810 --> 00:05:31,230
messages which makes validating these

137
00:05:29,400 --> 00:05:37,739
and<font color="#E5E5E5"> figure</font><font color="#CCCCCC"> out what to do with</font><font color="#E5E5E5"> the</font>

138
00:05:31,230 --> 00:05:39,420
single message<font color="#E5E5E5"> not not so easy it's also</font>

139
00:05:37,740 --> 00:05:44,250
made it<font color="#CCCCCC"> very easy</font><font color="#E5E5E5"> to kind</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> extend the</font>

140
00:05:39,420 --> 00:05:45,360
protocol so I<font color="#CCCCCC"> gotten into this</font><font color="#E5E5E5"> because I</font>

141
00:05:44,250 --> 00:05:47,940
was<font color="#E5E5E5"> working on an</font><font color="#CCCCCC"> open source</font>

142
00:05:45,360 --> 00:05:50,640
<font color="#E5E5E5">implementation</font><font color="#CCCCCC"> of this protocol</font><font color="#E5E5E5"> and kind</font>

143
00:05:47,940 --> 00:05:52,860
of<font color="#E5E5E5"> got interested</font><font color="#CCCCCC"> in fuzzing so I wrote</font>

144
00:05:50,640 --> 00:05:55,710
a smart fuzzer<font color="#E5E5E5"> and I had a buddy at a</font>

145
00:05:52,860 --> 00:05:57,240
electric utility who just kind of

146
00:05:55,710 --> 00:06:00,330
<font color="#CCCCCC">unleashed it on everything in his lab</font>

147
00:05:57,240 --> 00:06:01,740
he's it's all broken<font color="#E5E5E5"> right and somehow I</font>

148
00:06:00,330 --> 00:06:03,630
<font color="#CCCCCC">don't</font><font color="#E5E5E5"> know how he did</font><font color="#CCCCCC"> it he got the</font>

149
00:06:01,740 --> 00:06:06,840
permission<font color="#CCCCCC"> of his CIO to</font><font color="#E5E5E5"> start reporting</font>

150
00:06:03,630 --> 00:06:09,330
<font color="#E5E5E5">to DHS so he went on a massive bug</font>

151
00:06:06,840 --> 00:06:11,789
campaign in<font color="#E5E5E5"> 2013 just kind of fuzzing</font>

152
00:06:09,330 --> 00:06:13,340
everything we could find and<font color="#E5E5E5"> we ended</font><font color="#CCCCCC"> up</font>

153
00:06:11,790 --> 00:06:17,430
with like<font color="#CCCCCC"> you know about 30 different</font>

154
00:06:13,340 --> 00:06:19,380
<font color="#CCCCCC">CVS coming out through ics-cert and</font><font color="#E5E5E5"> as</font>

155
00:06:17,430 --> 00:06:20,550
far<font color="#E5E5E5"> as this length set goes it's kind</font><font color="#CCCCCC"> of</font>

156
00:06:19,380 --> 00:06:21,900
<font color="#E5E5E5">a really deep study of all the different</font>

157
00:06:20,550 --> 00:06:24,540
failure modes<font color="#E5E5E5"> you could see in one</font>

158
00:06:21,900 --> 00:06:27,390
protocol we have<font color="#CCCCCC"> a nice assortment of</font>

159
00:06:24,540 --> 00:06:28,590
<font color="#CCCCCC">different things</font><font color="#E5E5E5"> so you can go to that</font>

160
00:06:27,390 --> 00:06:31,409
<font color="#CCCCCC">link and kind of look at all the</font>

161
00:06:28,590 --> 00:06:35,330
different CDC<font color="#E5E5E5"> bees they're not terribly</font>

162
00:06:31,410 --> 00:06:39,660
descriptive there's a real stigma<font color="#E5E5E5"> around</font>

163
00:06:35,330 --> 00:06:43,889
releasing<font color="#CCCCCC"> Oh</font><font color="#E5E5E5"> days and ICS SCADA so we</font>

164
00:06:39,660 --> 00:06:45,389
released uh<font color="#E5E5E5"> I I'll tell you some stories</font>

165
00:06:43,889 --> 00:06:49,139
<font color="#CCCCCC">in the hallway</font><font color="#E5E5E5"> about interactions with</font>

166
00:06:45,389 --> 00:06:50,819
vendors but we<font color="#E5E5E5"> release some of the data</font>

167
00:06:49,139 --> 00:06:53,520
<font color="#CCCCCC">that we</font><font color="#E5E5E5"> never tied it to a</font><font color="#CCCCCC"> specific</font>

168
00:06:50,819 --> 00:06:56,789
product<font color="#E5E5E5"> to give people an</font><font color="#CCCCCC"> example what</font>

169
00:06:53,520 --> 00:06:58,830
frames<font color="#E5E5E5"> cause failures</font><font color="#CCCCCC"> you didn't</font><font color="#E5E5E5"> really</font>

170
00:06:56,789 --> 00:07:00,719
embarrass anybody and I didn't you<font color="#CCCCCC"> know</font>

171
00:06:58,830 --> 00:07:07,050
I didn't want the FBI<font color="#E5E5E5"> showing up at my</font>

172
00:07:00,720 --> 00:07:09,060
doorstep<font color="#E5E5E5"> one of the things that was kind</font>

173
00:07:07,050 --> 00:07:11,759
<font color="#CCCCCC">of an important revelation for the</font>

174
00:07:09,060 --> 00:07:14,789
industry was kind of<font color="#E5E5E5"> a different attack</font>

175
00:07:11,759 --> 00:07:16,710
vector<font color="#CCCCCC"> in electric power things are</font>

176
00:07:14,789 --> 00:07:18,930
primarily kind of compliance<font color="#CCCCCC"> driven</font>

177
00:07:16,710 --> 00:07:21,359
people<font color="#E5E5E5"> aren't if you're on the network</font>

178
00:07:18,930 --> 00:07:23,039
you're<font color="#CCCCCC"> on</font><font color="#E5E5E5"> the network so most people</font>

179
00:07:21,360 --> 00:07:24,449
from a compliance<font color="#CCCCCC"> perspective are really</font>

180
00:07:23,039 --> 00:07:25,860
working<font color="#E5E5E5"> worried about that bridge</font>

181
00:07:24,449 --> 00:07:29,250
<font color="#E5E5E5">between the corporate network through</font>

182
00:07:25,860 --> 00:07:31,169
the<font color="#CCCCCC"> dmz onto the OT</font><font color="#E5E5E5"> network they're</font>

183
00:07:29,250 --> 00:07:33,780
<font color="#E5E5E5">really worried</font><font color="#CCCCCC"> about you know protecting</font>

184
00:07:31,169 --> 00:07:35,549
that<font color="#E5E5E5"> as an attack path well what we</font>

185
00:07:33,780 --> 00:07:37,590
showed<font color="#CCCCCC"> was that</font><font color="#E5E5E5"> you could go out</font><font color="#CCCCCC"> to some</font>

186
00:07:35,550 --> 00:07:41,219
kind of remote site in the field<font color="#CCCCCC"> you</font>

187
00:07:37,590 --> 00:07:43,280
know<font color="#E5E5E5"> doesn't have a camera and send fuzz</font>

188
00:07:41,219 --> 00:07:45,360
packets back<font color="#E5E5E5"> toward the control center</font>

189
00:07:43,280 --> 00:07:46,739
<font color="#E5E5E5">the control center really</font><font color="#CCCCCC"> is a server</font>

190
00:07:45,360 --> 00:07:48,509
platform is talking to hundreds of

191
00:07:46,740 --> 00:07:50,699
<font color="#E5E5E5">things so if you knock</font><font color="#CCCCCC"> that thing down</font>

192
00:07:48,509 --> 00:07:52,349
<font color="#CCCCCC">you tip that thing over</font><font color="#E5E5E5"> operators have</font>

193
00:07:50,699 --> 00:07:57,990
lost control<font color="#E5E5E5"> or visibility to their</font>

194
00:07:52,349 --> 00:08:02,430
entire<font color="#E5E5E5"> system</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> also there's an</font>

195
00:07:57,990 --> 00:08:04,169
<font color="#CCCCCC">exception in the in the regulations for</font>

196
00:08:02,430 --> 00:08:06,229
what you have to do<font color="#E5E5E5"> for serial</font>

197
00:08:04,169 --> 00:08:09,830
<font color="#E5E5E5">communication since</font><font color="#CCCCCC"> there non-routable</font>

198
00:08:06,229 --> 00:08:12,180
<font color="#E5E5E5">it's much easier</font><font color="#CCCCCC"> for utilities to</font>

199
00:08:09,830 --> 00:08:15,630
they're exempt<font color="#E5E5E5"> from Newark</font><font color="#CCCCCC"> set</font>

200
00:08:12,180 --> 00:08:17,430
regulatory requirements so showing

201
00:08:15,630 --> 00:08:19,979
<font color="#E5E5E5">people you could say send the same</font><font color="#CCCCCC"> fuzz</font>

202
00:08:17,430 --> 00:08:21,449
data over<font color="#E5E5E5"> 1200 baud modem or nine</font>

203
00:08:19,979 --> 00:08:24,270
<font color="#CCCCCC">Herberger</font><font color="#E5E5E5"> Hertz radio and how the same</font>

204
00:08:21,449 --> 00:08:25,710
effect was kind of the kind<font color="#CCCCCC"> of a</font>

205
00:08:24,270 --> 00:08:27,180
revelation for<font color="#E5E5E5"> them and you</font><font color="#CCCCCC"> probably</font>

206
00:08:25,710 --> 00:08:28,349
<font color="#E5E5E5">think it's silly</font><font color="#CCCCCC"> you know</font><font color="#E5E5E5"> parses</font><font color="#CCCCCC"> or</font>

207
00:08:27,180 --> 00:08:31,979
parsers regardless of how they're

208
00:08:28,349 --> 00:08:35,218
<font color="#E5E5E5">consuming the bytes but they thought</font>

209
00:08:31,979 --> 00:08:37,529
<font color="#E5E5E5">that was kind of a big deal the fuzzer</font>

210
00:08:35,219 --> 00:08:39,270
itself<font color="#E5E5E5"> like I said really nothing</font>

211
00:08:37,529 --> 00:08:41,338
<font color="#CCCCCC">special it</font><font color="#E5E5E5"> was just a generational smart</font>

212
00:08:39,270 --> 00:08:43,370
fuzzer having implemented<font color="#E5E5E5"> the full</font>

213
00:08:41,339 --> 00:08:45,540
protocol<font color="#CCCCCC"> I had a lot of</font><font color="#E5E5E5"> insights into</font>

214
00:08:43,370 --> 00:08:47,339
you know where people<font color="#CCCCCC"> will likely</font><font color="#E5E5E5"> make</font>

215
00:08:45,540 --> 00:08:48,839
mistakes<font color="#CCCCCC"> so it was easy to</font><font color="#E5E5E5"> kind of</font>

216
00:08:47,339 --> 00:08:51,150
capture<font color="#CCCCCC"> that there's a lot of the</font>

217
00:08:48,840 --> 00:08:52,470
modeling was really just stressing

218
00:08:51,150 --> 00:08:55,319
integer boundary conditions and

219
00:08:52,470 --> 00:08:58,140
overflows and adding or removing<font color="#E5E5E5"> you</font>

220
00:08:55,320 --> 00:08:59,880
know expected data<font color="#E5E5E5"> and you know we</font>

221
00:08:58,140 --> 00:09:01,920
didn't have source code<font color="#E5E5E5"> for these things</font>

222
00:08:59,880 --> 00:09:03,870
<font color="#E5E5E5">so we couldn't do instrumentation so we</font>

223
00:09:01,920 --> 00:09:06,150
had<font color="#E5E5E5"> very very simple you</font><font color="#CCCCCC"> know failure</font>

224
00:09:03,870 --> 00:09:07,890
metric you know send a known valid

225
00:09:06,150 --> 00:09:10,380
packet get a response try another tack

226
00:09:07,890 --> 00:09:12,420
packet<font color="#CCCCCC"> doing</font><font color="#E5E5E5"> a type loop till the device</font>

227
00:09:10,380 --> 00:09:14,220
stops responding<font color="#CCCCCC"> and I'm sure we missed</font>

228
00:09:12,420 --> 00:09:16,890
all<font color="#E5E5E5"> kinds of subtle</font><font color="#CCCCCC"> things like memory</font>

229
00:09:14,220 --> 00:09:18,870
<font color="#E5E5E5">leaks and so forth but</font><font color="#CCCCCC"> there's you know</font>

230
00:09:16,890 --> 00:09:23,339
so many seg faults that you know does<font color="#CCCCCC"> it</font>

231
00:09:18,870 --> 00:09:25,800
<font color="#E5E5E5">doesn't really matter</font><font color="#CCCCCC"> you know like I</font>

232
00:09:23,339 --> 00:09:28,290
<font color="#CCCCCC">said what do we</font><font color="#E5E5E5"> find you</font><font color="#CCCCCC"> know I</font><font color="#E5E5E5"> don't</font>

233
00:09:25,800 --> 00:09:29,609
<font color="#CCCCCC">have</font><font color="#E5E5E5"> any</font><font color="#CCCCCC"> videos of</font><font color="#E5E5E5"> breaking the embedded</font>

234
00:09:28,290 --> 00:09:31,579
devices but<font color="#E5E5E5"> you know just a few</font>

235
00:09:29,610 --> 00:09:34,440
<font color="#E5E5E5">screenshots of</font><font color="#CCCCCC"> Windows things that were</font>

236
00:09:31,580 --> 00:09:36,270
you know<font color="#E5E5E5"> a lot of infinite loops</font><font color="#CCCCCC"> a lot</font>

237
00:09:34,440 --> 00:09:39,480
of infinite loops that allocate memory

238
00:09:36,270 --> 00:09:41,610
<font color="#CCCCCC">to</font><font color="#E5E5E5"> the process bleeds out a lot of you</font>

239
00:09:39,480 --> 00:09:44,520
know<font color="#E5E5E5"> Robert read access areas a lot of</font>

240
00:09:41,610 --> 00:09:46,560
buffer overruns<font color="#CCCCCC"> I mean I'm not a reverse</font>

241
00:09:44,520 --> 00:09:49,110
engineer we've taken a long<font color="#CCCCCC"> time</font><font color="#E5E5E5"> to go</font>

242
00:09:46,560 --> 00:09:51,329
and try to reverse<font color="#CCCCCC"> every</font><font color="#E5E5E5"> single one of</font>

243
00:09:49,110 --> 00:09:52,529
these so you know<font color="#E5E5E5"> sometimes the language</font>

244
00:09:51,330 --> 00:09:56,339
<font color="#CCCCCC">runtime tells you it's a buffer overflow</font>

245
00:09:52,529 --> 00:10:01,380
I can get that right some<font color="#E5E5E5"> of the common</font>

246
00:09:56,339 --> 00:10:04,140
faults on most common dnp3 has these

247
00:10:01,380 --> 00:10:05,850
header types called<font color="#E5E5E5"> basically</font><font color="#CCCCCC"> start-stop</font>

248
00:10:04,140 --> 00:10:07,350
they tell you that there's basically<font color="#CCCCCC"> an</font>

249
00:10:05,850 --> 00:10:09,750
<font color="#CCCCCC">array that falls with a certain number</font>

250
00:10:07,350 --> 00:10:11,580
<font color="#E5E5E5">of like fixed length elements and these</font>

251
00:10:09,750 --> 00:10:13,350
<font color="#E5E5E5">are just addressing for the different</font>

252
00:10:11,580 --> 00:10:16,589
measurement values is done completely<font color="#CCCCCC"> by</font>

253
00:10:13,350 --> 00:10:20,460
index so this header type basically<font color="#E5E5E5"> says</font>

254
00:10:16,589 --> 00:10:25,589
there are measurement values from<font color="#CCCCCC"> zero</font>

255
00:10:20,460 --> 00:10:29,339
to max unsigned in<font color="#CCCCCC"> all of a certain type</font>

256
00:10:25,589 --> 00:10:30,870
of a<font color="#CCCCCC"> certain fixed</font><font color="#E5E5E5"> length type so to</font>

257
00:10:29,339 --> 00:10:32,190
<font color="#E5E5E5">actually validate the header and move on</font>

258
00:10:30,870 --> 00:10:32,910
to the<font color="#E5E5E5"> next setter you have to figure</font>

259
00:10:32,190 --> 00:10:35,850
<font color="#E5E5E5">out how many</font><font color="#CCCCCC"> there are</font>

260
00:10:32,910 --> 00:10:37,829
well you know<font color="#E5E5E5"> this you're going</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> have</font>

261
00:10:35,850 --> 00:10:39,780
an integer overflow and<font color="#E5E5E5"> when you end up</font>

262
00:10:37,830 --> 00:10:41,310
reading<font color="#E5E5E5"> the data you're going to end up</font>

263
00:10:39,780 --> 00:10:42,480
crashing with<font color="#CCCCCC"> the read access arrows</font>

264
00:10:41,310 --> 00:10:42,750
that's<font color="#E5E5E5"> going to roll</font><font color="#CCCCCC"> back over</font><font color="#E5E5E5"> to zero</font>

265
00:10:42,480 --> 00:10:44,940
right

266
00:10:42,750 --> 00:10:48,510
so that was you know<font color="#CCCCCC"> extremely common</font>

267
00:10:44,940 --> 00:10:50,279
<font color="#E5E5E5">fault you know but even more interesting</font>

268
00:10:48,510 --> 00:10:52,830
I<font color="#CCCCCC"> think we're some of the kind</font><font color="#E5E5E5"> of less</font>

269
00:10:50,279 --> 00:10:54,480
common faults<font color="#E5E5E5"> this is actually a reply</font>

270
00:10:52,830 --> 00:10:57,089
message from a remote device<font color="#E5E5E5"> in the</font>

271
00:10:54,480 --> 00:10:59,280
<font color="#E5E5E5">field back towards a master and the</font>

272
00:10:57,089 --> 00:11:00,600
object type that it contains the control

273
00:10:59,280 --> 00:11:01,819
that should normally go in the<font color="#E5E5E5"> other</font>

274
00:11:00,600 --> 00:11:03,770
<font color="#E5E5E5">direction</font>

275
00:11:01,820 --> 00:11:06,230
right so this<font color="#CCCCCC"> has</font><font color="#E5E5E5"> never come from</font><font color="#CCCCCC"> the</font>

276
00:11:03,770 --> 00:11:08,810
<font color="#E5E5E5">field back towards a master and it's</font>

277
00:11:06,230 --> 00:11:10,820
completely syntactically valid all the

278
00:11:08,810 --> 00:11:12,739
data is all the specified data is there

279
00:11:10,820 --> 00:11:15,260
it's just semantically meaningless

280
00:11:12,740 --> 00:11:17,750
<font color="#E5E5E5">because</font><font color="#CCCCCC"> that you</font><font color="#E5E5E5"> know it's an example of</font>

281
00:11:15,260 --> 00:11:21,710
<font color="#E5E5E5">something that should never make it</font><font color="#CCCCCC"> past</font>

282
00:11:17,750 --> 00:11:24,710
a very very early<font color="#E5E5E5"> stage of a parsing or</font>

283
00:11:21,710 --> 00:11:26,360
<font color="#E5E5E5">white listing and even more interesting</font>

284
00:11:24,710 --> 00:11:28,940
<font color="#E5E5E5">that the buffer</font><font color="#CCCCCC"> ogram was only triggered</font>

285
00:11:26,360 --> 00:11:30,590
if those last two fields of<font color="#CCCCCC"> 11 bytes</font>

286
00:11:28,940 --> 00:11:32,120
<font color="#CCCCCC">were particular values so we were kind</font>

287
00:11:30,590 --> 00:11:33,740
of<font color="#CCCCCC"> seating those with</font><font color="#E5E5E5"> pseudo-random data</font>

288
00:11:32,120 --> 00:11:35,360
as we were fuzzing and it took

289
00:11:33,740 --> 00:11:37,280
particular<font color="#E5E5E5"> combinations to trigger that</font>

290
00:11:35,360 --> 00:11:39,080
<font color="#E5E5E5">so something something had gone pretty</font>

291
00:11:37,280 --> 00:11:43,339
horribly wrong in<font color="#CCCCCC"> the early stages of</font>

292
00:11:39,080 --> 00:11:46,370
processing<font color="#CCCCCC"> on that</font><font color="#E5E5E5"> one so you know all</font>

293
00:11:43,340 --> 00:11:49,760
<font color="#E5E5E5">the people said you know so what this is</font>

294
00:11:46,370 --> 00:11:51,080
an unauthenticated<font color="#E5E5E5"> protocol right what's</font>

295
00:11:49,760 --> 00:11:52,430
the point of fuzzing something that has

296
00:11:51,080 --> 00:11:54,830
no author you can<font color="#CCCCCC"> just trip and close</font>

297
00:11:52,430 --> 00:11:56,900
the breakers well the committee since

298
00:11:54,830 --> 00:11:59,600
2007 that<font color="#E5E5E5"> designs this protocol has</font><font color="#CCCCCC"> been</font>

299
00:11:56,900 --> 00:12:01,610
adding<font color="#E5E5E5"> security into this protocol so</font>

300
00:11:59,600 --> 00:12:04,550
not on top of<font color="#CCCCCC"> but actually into</font><font color="#E5E5E5"> the</font>

301
00:12:01,610 --> 00:12:07,220
application layer itself<font color="#E5E5E5"> and it's really</font>

302
00:12:04,550 --> 00:12:09,589
tightly coupled to<font color="#E5E5E5"> the application layer</font>

303
00:12:07,220 --> 00:12:12,800
they've invented new function codes new

304
00:12:09,590 --> 00:12:15,110
objects new<font color="#CCCCCC"> state machines</font><font color="#E5E5E5"> and they have</font>

305
00:12:12,800 --> 00:12:16,729
to come to modes of authentication<font color="#E5E5E5"> and</font>

306
00:12:15,110 --> 00:12:22,400
some really<font color="#E5E5E5"> cute things</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> like saving</font>

307
00:12:16,730 --> 00:12:23,720
bandwidth<font color="#E5E5E5"> so I would say that a lot</font><font color="#CCCCCC"> of</font>

308
00:12:22,400 --> 00:12:25,880
<font color="#CCCCCC">the things that</font><font color="#E5E5E5"> they've added to this</font>

309
00:12:23,720 --> 00:12:27,080
really really<font color="#E5E5E5"> complex protocol I'd go so</font>

310
00:12:25,880 --> 00:12:33,640
far<font color="#CCCCCC"> as it could call them you know</font>

311
00:12:27,080 --> 00:12:38,030
<font color="#CCCCCC">security</font><font color="#E5E5E5"> anti-patterns the first one is</font>

312
00:12:33,640 --> 00:12:39,770
us they have selective authentication<font color="#E5E5E5"> so</font>

313
00:12:38,030 --> 00:12:41,000
they basically<font color="#CCCCCC"> take in the space of</font><font color="#E5E5E5"> all</font>

314
00:12:39,770 --> 00:12:42,560
the different function codes in the

315
00:12:41,000 --> 00:12:44,800
standard and try to identify the ones

316
00:12:42,560 --> 00:12:48,949
that they deem critical and that's

317
00:12:44,800 --> 00:12:50,780
mostly<font color="#CCCCCC"> oriented around</font><font color="#E5E5E5"> function codes</font>

318
00:12:48,950 --> 00:12:53,030
that<font color="#E5E5E5"> could affect the process state like</font>

319
00:12:50,780 --> 00:12:55,550
opening and closing a breaker or<font color="#E5E5E5"> reading</font>

320
00:12:53,030 --> 00:12:57,199
and writing a file but you'd be

321
00:12:55,550 --> 00:12:58,880
surprised to learn that<font color="#E5E5E5"> response is</font>

322
00:12:57,200 --> 00:13:01,730
<font color="#E5E5E5">coming from the field or non-mandatory</font>

323
00:12:58,880 --> 00:13:03,850
you could enable<font color="#E5E5E5"> challenging in</font>

324
00:13:01,730 --> 00:13:06,260
authenticating<font color="#E5E5E5"> those responses but it's</font>

325
00:13:03,850 --> 00:13:09,320
you're not<font color="#E5E5E5"> required to</font><font color="#CCCCCC"> have them on by</font>

326
00:13:06,260 --> 00:13:12,189
default<font color="#CCCCCC"> and</font><font color="#E5E5E5"> it's interesting if you</font><font color="#CCCCCC"> do a</font>

327
00:13:09,320 --> 00:13:14,030
crude<font color="#E5E5E5"> analysis of the protocol</font><font color="#CCCCCC"> itself</font>

328
00:13:12,190 --> 00:13:15,860
<font color="#E5E5E5">responses from the field with</font>

329
00:13:14,030 --> 00:13:17,449
measurement<font color="#E5E5E5"> data can</font><font color="#CCCCCC"> be paired</font>

330
00:13:15,860 --> 00:13:19,580
those function codes can<font color="#CCCCCC"> be paired with</font>

331
00:13:17,450 --> 00:13:22,280
<font color="#E5E5E5">the highest number</font><font color="#CCCCCC"> of objects so they</font>

332
00:13:19,580 --> 00:13:24,310
<font color="#E5E5E5">have the highest attack surface so the</font>

333
00:13:22,280 --> 00:13:27,110
<font color="#CCCCCC">people that</font><font color="#E5E5E5"> designed</font><font color="#CCCCCC"> this protocol</font>

334
00:13:24,310 --> 00:13:29,479
<font color="#E5E5E5">really there was no thought to</font>

335
00:13:27,110 --> 00:13:32,990
protecting from implementation defects

336
00:13:29,480 --> 00:13:34,490
it was all ranted around<font color="#CCCCCC"> you know having</font>

337
00:13:32,990 --> 00:13:35,840
perfect parsers assuming a world of

338
00:13:34,490 --> 00:13:38,000
perfect parsers<font color="#CCCCCC"> where these bugs</font><font color="#E5E5E5"> don't</font>

339
00:13:35,840 --> 00:13:41,030
exist<font color="#E5E5E5"> and</font><font color="#CCCCCC"> just kind of protect and what</font>

340
00:13:38,000 --> 00:13:46,160
the function<font color="#CCCCCC"> codes actually do for the</font>

341
00:13:41,030 --> 00:13:49,579
process itself so<font color="#CCCCCC"> a</font><font color="#E5E5E5"> couple other kind of</font>

342
00:13:46,160 --> 00:13:51,920
gems here in the standard<font color="#E5E5E5"> two modes of</font>

343
00:13:49,580 --> 00:13:54,860
authentication<font color="#E5E5E5"> the primary mode is a</font>

344
00:13:51,920 --> 00:13:56,540
challenge response<font color="#E5E5E5"> which nobody likes</font>

345
00:13:54,860 --> 00:13:58,100
because it adds a<font color="#E5E5E5"> bunch of latency on</font>

346
00:13:56,540 --> 00:14:00,709
these<font color="#E5E5E5"> systems that can be time critical</font>

347
00:13:58,100 --> 00:14:02,990
so you know you send a message<font color="#CCCCCC"> the</font>

348
00:14:00,710 --> 00:14:05,000
<font color="#CCCCCC">outstation</font><font color="#E5E5E5"> or the master says you know</font>

349
00:14:02,990 --> 00:14:07,340
prove<font color="#CCCCCC"> its you here's a nonce you know</font>

350
00:14:05,000 --> 00:14:09,290
produce<font color="#E5E5E5"> a hash for me send it back okay</font>

351
00:14:07,340 --> 00:14:13,070
<font color="#CCCCCC">and then you and you process the initial</font>

352
00:14:09,290 --> 00:14:14,839
<font color="#CCCCCC">message you can actually implement that</font>

353
00:14:13,070 --> 00:14:16,610
reasonably well because you can kind<font color="#CCCCCC"> of</font>

354
00:14:14,840 --> 00:14:19,070
treat<font color="#E5E5E5"> that blob after the function codes</font>

355
00:14:16,610 --> 00:14:20,980
and opaque set of<font color="#E5E5E5"> bytes not even touch</font>

356
00:14:19,070 --> 00:14:23,540
it<font color="#CCCCCC"> until</font><font color="#E5E5E5"> after you've gotten back your</font>

357
00:14:20,980 --> 00:14:25,700
response to the challenge<font color="#E5E5E5"> and validated</font>

358
00:14:23,540 --> 00:14:27,439
it comes from<font color="#E5E5E5"> a trusted source there's</font>

359
00:14:25,700 --> 00:14:28,460
another mode called<font color="#E5E5E5"> aggressive mode</font>

360
00:14:27,440 --> 00:14:32,360
which is kind of<font color="#E5E5E5"> a</font><font color="#CCCCCC"> one-pass</font>

361
00:14:28,460 --> 00:14:34,220
authentication<font color="#CCCCCC"> and that mode uses</font>

362
00:14:32,360 --> 00:14:37,790
sequence numbers to protect<font color="#CCCCCC"> from replay</font>

363
00:14:34,220 --> 00:14:40,280
attacks so what they've done<font color="#E5E5E5"> is they've</font>

364
00:14:37,790 --> 00:14:42,680
reused the normal dnp3 object headers

365
00:14:40,280 --> 00:14:44,390
and the payload objects that<font color="#E5E5E5"> would</font>

366
00:14:42,680 --> 00:14:45,650
<font color="#CCCCCC">normally part of a normal request</font><font color="#E5E5E5"> are</font>

367
00:14:44,390 --> 00:14:48,290
kind<font color="#E5E5E5"> of sandwiched in the</font><font color="#CCCCCC"> middle there</font>

368
00:14:45,650 --> 00:14:50,360
and it's preceded<font color="#CCCCCC"> by a user ID and</font><font color="#E5E5E5"> a</font>

369
00:14:48,290 --> 00:14:55,010
sequence number<font color="#E5E5E5"> that has to increment</font>

370
00:14:50,360 --> 00:14:56,210
<font color="#CCCCCC">and then the h mac is on the end but you</font>

371
00:14:55,010 --> 00:14:59,569
<font color="#CCCCCC">know like we've already discussed</font>

372
00:14:56,210 --> 00:15:00,920
<font color="#CCCCCC">there's well first off there's there's</font>

373
00:14:59,570 --> 00:15:03,110
an ambiguity<font color="#E5E5E5"> with the</font><font color="#CCCCCC"> corrupt request</font>

374
00:15:00,920 --> 00:15:04,310
<font color="#E5E5E5">itself you get a message</font><font color="#CCCCCC"> like this</font><font color="#E5E5E5"> and</font>

375
00:15:03,110 --> 00:15:06,110
you have<font color="#CCCCCC"> a function there's no special</font>

376
00:15:04,310 --> 00:15:08,329
<font color="#E5E5E5">function identifying this</font><font color="#CCCCCC"> as aggressive</font>

377
00:15:06,110 --> 00:15:10,070
mode so<font color="#E5E5E5"> you have to speculate parse the</font>

378
00:15:08,330 --> 00:15:11,300
first object header to even<font color="#CCCCCC"> determine</font>

379
00:15:10,070 --> 00:15:13,730
whether it's an aggressive mode or

380
00:15:11,300 --> 00:15:17,180
normal<font color="#E5E5E5"> request so they've already added</font>

381
00:15:13,730 --> 00:15:18,560
some you know<font color="#E5E5E5"> new syntax</font><font color="#CCCCCC"> completely</font>

382
00:15:17,180 --> 00:15:21,020
<font color="#CCCCCC">different</font><font color="#E5E5E5"> than the old protocol just</font><font color="#CCCCCC"> to</font>

383
00:15:18,560 --> 00:15:24,319
handle<font color="#E5E5E5"> this use case that's not great</font>

384
00:15:21,020 --> 00:15:26,090
it's not so bad<font color="#E5E5E5"> these the things I'm a</font>

385
00:15:24,320 --> 00:15:27,580
<font color="#CCCCCC">little more worried about</font><font color="#E5E5E5"> is that this</font>

386
00:15:26,090 --> 00:15:32,050
kind<font color="#CCCCCC"> of pseudo on</font>

387
00:15:27,580 --> 00:15:34,930
<font color="#E5E5E5">the loop</font><font color="#CCCCCC"> you can't parse the object you</font>

388
00:15:32,050 --> 00:15:36,939
can't skip<font color="#E5E5E5"> object headers you have to</font>

389
00:15:34,930 --> 00:15:39,459
least do some<font color="#E5E5E5"> level of light parsing to</font>

390
00:15:36,940 --> 00:15:42,340
get to the<font color="#CCCCCC"> VH Mack at the end</font><font color="#E5E5E5"> so you're</font>

391
00:15:39,460 --> 00:15:44,470
actually<font color="#CCCCCC"> having to you know inspect this</font>

392
00:15:42,340 --> 00:15:45,790
potentially<font color="#CCCCCC"> dangerous data just to</font>

393
00:15:44,470 --> 00:15:47,320
<font color="#E5E5E5">authenticate yourself it's irrelevant</font>

394
00:15:45,790 --> 00:15:48,670
<font color="#E5E5E5">you don't even want to process</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> until</font>

395
00:15:47,320 --> 00:15:52,540
you've<font color="#E5E5E5"> gotten to the hmm at the end of</font>

396
00:15:48,670 --> 00:15:54,550
the message fortunately after<font color="#E5E5E5"> the</font>

397
00:15:52,540 --> 00:15:56,949
session key negotiation you know how big

398
00:15:54,550 --> 00:15:58,329
<font color="#CCCCCC">that</font><font color="#E5E5E5"> H Mack is supposed to be so you</font>

399
00:15:56,950 --> 00:16:01,090
<font color="#CCCCCC">know if you know what</font><font color="#E5E5E5"> you're doing you</font>

400
00:15:58,330 --> 00:16:02,560
<font color="#CCCCCC">can try to rip it off the end validate</font>

401
00:16:01,090 --> 00:16:04,210
the message<font color="#E5E5E5"> and then do some parsing</font>

402
00:16:02,560 --> 00:16:05,800
that's that's not documented anywhere<font color="#E5E5E5"> in</font>

403
00:16:04,210 --> 00:16:07,270
the spec and<font color="#CCCCCC"> I suspect this the kind</font><font color="#E5E5E5"> of</font>

404
00:16:05,800 --> 00:16:13,870
kind<font color="#E5E5E5"> of thing that will trip a lot of</font>

405
00:16:07,270 --> 00:16:15,970
people up other gems so some of<font color="#E5E5E5"> the</font>

406
00:16:13,870 --> 00:16:18,730
objects themselves that<font color="#CCCCCC"> you know encode</font>

407
00:16:15,970 --> 00:16:20,920
some of the security<font color="#E5E5E5"> primitives</font><font color="#CCCCCC"> this one</font>

408
00:16:18,730 --> 00:16:24,100
is a session<font color="#E5E5E5"> key status object this is</font>

409
00:16:20,920 --> 00:16:26,439
how the<font color="#E5E5E5"> one side notifies the other the</font>

410
00:16:24,100 --> 00:16:29,710
state of the session<font color="#E5E5E5"> keys how they're</font>

411
00:16:26,440 --> 00:16:31,300
<font color="#CCCCCC">encoded this object is usually framed by</font>

412
00:16:29,710 --> 00:16:32,830
tag length<font color="#CCCCCC"> value so there's a header</font>

413
00:16:31,300 --> 00:16:36,550
that<font color="#E5E5E5"> specifies</font><font color="#CCCCCC"> the size</font><font color="#E5E5E5"> of the whole</font>

414
00:16:32,830 --> 00:16:40,480
object and these objects have you know

415
00:16:36,550 --> 00:16:42,520
some number<font color="#CCCCCC"> of that's</font><font color="#E5E5E5"> not always</font>

416
00:16:40,480 --> 00:16:44,530
<font color="#CCCCCC">reported there is some number of fixed</font>

417
00:16:42,520 --> 00:16:46,900
<font color="#E5E5E5">length fields the fixed length fields</font>

418
00:16:44,530 --> 00:16:48,880
always come first<font color="#CCCCCC"> and then some number</font>

419
00:16:46,900 --> 00:16:51,910
<font color="#E5E5E5">of variable length fields so in this</font>

420
00:16:48,880 --> 00:16:56,200
object<font color="#E5E5E5"> the way that it's encoded is they</font>

421
00:16:51,910 --> 00:16:58,959
have a<font color="#CCCCCC"> 16-bit</font><font color="#E5E5E5"> integer that frames this</font>

422
00:16:56,200 --> 00:17:01,210
<font color="#E5E5E5">sub variable length field and then the</font>

423
00:16:58,960 --> 00:17:03,490
last<font color="#E5E5E5"> variable length field is implicitly</font>

424
00:17:01,210 --> 00:17:07,209
the remainder from the<font color="#CCCCCC"> encapsulated</font>

425
00:17:03,490 --> 00:17:09,190
framing<font color="#E5E5E5"> not great</font><font color="#CCCCCC"> right well you would</font>

426
00:17:07,209 --> 00:17:12,900
think<font color="#CCCCCC"> that they would</font><font color="#E5E5E5"> at</font><font color="#CCCCCC"> least imply</font>

427
00:17:09,190 --> 00:17:12,900
<font color="#CCCCCC">this you know apply this</font><font color="#E5E5E5"> encoding scheme</font>

428
00:17:12,959 --> 00:17:23,560
<font color="#E5E5E5">consistently some of the objects have a</font>

429
00:17:19,440 --> 00:17:27,339
you<font color="#E5E5E5"> know explicit length for this field</font>

430
00:17:23,560 --> 00:17:30,040
<font color="#E5E5E5">that can</font><font color="#CCCCCC"> disagree with the framing so</font>

431
00:17:27,339 --> 00:17:31,980
it's you know it's done in two ways<font color="#E5E5E5"> what</font>

432
00:17:30,040 --> 00:17:34,899
<font color="#E5E5E5">does the spec how to say about this you</font>

433
00:17:31,980 --> 00:17:36,130
<font color="#CCCCCC">can just read</font><font color="#E5E5E5"> that second part says the</font>

434
00:17:34,900 --> 00:17:38,080
length of the challenge data<font color="#CCCCCC"> in may</font>

435
00:17:36,130 --> 00:17:40,570
therefore be<font color="#E5E5E5"> either calculated from the</font>

436
00:17:38,080 --> 00:17:43,330
qualifier or<font color="#E5E5E5"> read</font><font color="#CCCCCC"> from the course</font>

437
00:17:40,570 --> 00:17:48,820
<font color="#CCCCCC">a field of</font><font color="#E5E5E5"> the object it'll</font><font color="#CCCCCC"> be fine</font>

438
00:17:43,330 --> 00:17:49,750
right<font color="#CCCCCC"> no that's</font><font color="#E5E5E5"> not good</font><font color="#CCCCCC"> so these are</font>

439
00:17:48,820 --> 00:17:52,080
the kind of things<font color="#E5E5E5"> that need to be</font>

440
00:17:49,750 --> 00:17:54,880
cleaned<font color="#E5E5E5"> up these are where you know</font>

441
00:17:52,080 --> 00:17:57,279
<font color="#E5E5E5">modeling protocols and grammars will</font>

442
00:17:54,880 --> 00:17:58,690
have a real<font color="#CCCCCC"> impact and these</font><font color="#E5E5E5"> the kinds</font>

443
00:17:57,279 --> 00:18:00,580
of things will<font color="#E5E5E5"> be a significant source</font>

444
00:17:58,690 --> 00:18:02,620
of bugs I think for you know

445
00:18:00,580 --> 00:18:04,539
implementations<font color="#E5E5E5"> of this protocol going</font>

446
00:18:02,620 --> 00:18:06,399
forward<font color="#E5E5E5"> it hasn't gotten a whole lot</font><font color="#CCCCCC"> of</font>

447
00:18:04,539 --> 00:18:07,779
adoption yet<font color="#E5E5E5"> I mean</font><font color="#CCCCCC"> this feedback is</font>

448
00:18:06,399 --> 00:18:09,729
<font color="#E5E5E5">definitely kind of going towards the</font>

449
00:18:07,779 --> 00:18:11,620
committee<font color="#E5E5E5"> but they do have devices in</font>

450
00:18:09,730 --> 00:18:14,110
the field and changing this<font color="#CCCCCC"> is our</font>

451
00:18:11,620 --> 00:18:16,779
<font color="#E5E5E5">breaking changes and with the patch</font>

452
00:18:14,110 --> 00:18:20,469
situation in SCADA<font color="#E5E5E5"> it's really a</font>

453
00:18:16,779 --> 00:18:23,559
<font color="#CCCCCC">nightmare to</font><font color="#E5E5E5"> roll updates to things so</font>

454
00:18:20,470 --> 00:18:28,090
you know conclusions on<font color="#CCCCCC"> si I really</font>

455
00:18:23,559 --> 00:18:29,860
think that skata vendors<font color="#E5E5E5"> should really</font>

456
00:18:28,090 --> 00:18:31,059
<font color="#E5E5E5">just consider a layered approach you</font>

457
00:18:29,860 --> 00:18:32,590
know don't try to get cute<font color="#E5E5E5"> and</font>

458
00:18:31,059 --> 00:18:34,330
<font color="#CCCCCC">selectively authenticate based on</font>

459
00:18:32,590 --> 00:18:36,789
function<font color="#CCCCCC"> you know data is dangerous</font>

460
00:18:34,330 --> 00:18:38,289
regardless what<font color="#CCCCCC"> the intended function is</font>

461
00:18:36,789 --> 00:18:43,299
<font color="#CCCCCC">I've really been trying to sell that</font>

462
00:18:38,289 --> 00:18:48,279
message to people<font color="#E5E5E5"> how can lengths up</font>

463
00:18:43,299 --> 00:18:49,960
help<font color="#E5E5E5"> I think</font><font color="#CCCCCC"> we need</font><font color="#E5E5E5"> better tools so</font><font color="#CCCCCC"> you</font>

464
00:18:48,279 --> 00:18:53,769
<font color="#CCCCCC">know I like hearing</font><font color="#E5E5E5"> about</font><font color="#CCCCCC"> stuff like</font>

465
00:18:49,960 --> 00:18:55,149
<font color="#E5E5E5">hammer on the Ross parsing library we</font>

466
00:18:53,769 --> 00:18:58,210
need those tools to work on embedded

467
00:18:55,149 --> 00:18:59,168
systems<font color="#E5E5E5"> so we need variants those tools</font>

468
00:18:58,210 --> 00:19:03,039
<font color="#E5E5E5">that can handle things like</font>

469
00:18:59,169 --> 00:19:06,159
deterministic latency standards bodies

470
00:19:03,039 --> 00:19:12,570
need some theory and guidance to<font color="#CCCCCC"> produce</font>

471
00:19:06,159 --> 00:19:16,750
better designs<font color="#CCCCCC"> participate if you can</font>

472
00:19:12,570 --> 00:19:18,460
and a trap I've seen<font color="#E5E5E5"> over and</font><font color="#CCCCCC"> over in</font>

473
00:19:16,750 --> 00:19:19,659
<font color="#E5E5E5">this</font><font color="#CCCCCC"> spaces I think that as they develop</font>

474
00:19:18,460 --> 00:19:22,389
these protocols<font color="#E5E5E5"> they need reference</font>

475
00:19:19,659 --> 00:19:24,730
implementations to kind<font color="#E5E5E5"> of inform that</font>

476
00:19:22,389 --> 00:19:25,750
<font color="#E5E5E5">people spend enormous amount of time in</font>

477
00:19:24,730 --> 00:19:27,159
these<font color="#E5E5E5"> committees and it's mostly</font>

478
00:19:25,750 --> 00:19:28,269
consultants kind of writing<font color="#E5E5E5"> things on</font>

479
00:19:27,159 --> 00:19:31,720
paper<font color="#E5E5E5"> and</font><font color="#CCCCCC"> they're</font><font color="#E5E5E5"> just</font><font color="#CCCCCC"> hoping it's</font>

480
00:19:28,269 --> 00:19:33,429
implementable very little feedback<font color="#E5E5E5"> so I</font>

481
00:19:31,720 --> 00:19:38,399
think that's really<font color="#E5E5E5"> important that's</font>

482
00:19:33,429 --> 00:19:38,399
<font color="#E5E5E5">kind of where I've</font><font color="#CCCCCC"> been trying to</font><font color="#E5E5E5"> help</font>

483
00:19:38,540 --> 00:19:42,960
with that<font color="#E5E5E5"> it's questions I know there</font>

484
00:19:41,550 --> 00:19:53,940
was<font color="#E5E5E5"> a lot</font><font color="#CCCCCC"> of things in a very short</font>

485
00:19:42,960 --> 00:19:58,070
<font color="#E5E5E5">period of time but so distinctly not</font><font color="#CCCCCC"> tit</font>

486
00:19:53,940 --> 00:19:58,070
<font color="#CCCCCC">theate</font><font color="#E5E5E5"> not a theoretical</font><font color="#CCCCCC"> problem</font><font color="#E5E5E5"> no</font>

487
00:19:58,160 --> 00:20:01,160
questions

488
00:20:02,750 --> 00:20:08,130
thanks um one thing that<font color="#E5E5E5"> jumped out</font><font color="#CCCCCC"> at</font>

489
00:20:05,550 --> 00:20:10,560
me<font color="#CCCCCC"> here is perhaps not intimately</font><font color="#E5E5E5"> to</font>

490
00:20:08,130 --> 00:20:13,650
related to<font color="#E5E5E5"> laying sack but um do you</font>

491
00:20:10,560 --> 00:20:15,060
know of any any ways<font color="#E5E5E5"> that the aggressive</font>

492
00:20:13,650 --> 00:20:19,200
mode of<font color="#E5E5E5"> indication in particular is</font>

493
00:20:15,060 --> 00:20:21,960
currently being protected against replay

494
00:20:19,200 --> 00:20:23,340
besides the sequence number<font color="#CCCCCC"> oh it does</font>

495
00:20:21,960 --> 00:20:25,710
have a sequence<font color="#E5E5E5"> number</font><font color="#CCCCCC"> yeah</font><font color="#E5E5E5"> okay</font>

496
00:20:23,340 --> 00:20:27,330
and they use the sequence number even in

497
00:20:25,710 --> 00:20:31,050
the challenge response<font color="#E5E5E5"> so it's like you</font>

498
00:20:27,330 --> 00:20:33,090
<font color="#E5E5E5">know somewhat unnecessary but there's no</font>

499
00:20:31,050 --> 00:20:33,930
<font color="#E5E5E5">there's no timing protections and</font>

500
00:20:33,090 --> 00:20:35,820
aggressive<font color="#CCCCCC"> modes you</font><font color="#E5E5E5"> could</font><font color="#CCCCCC"> definitely</font>

501
00:20:33,930 --> 00:20:37,800
hold a packet back and then replay it<font color="#CCCCCC"> at</font>

502
00:20:35,820 --> 00:20:39,450
inconvenient time so it's somewhat less

503
00:20:37,800 --> 00:20:41,639
secure than<font color="#E5E5E5"> the challenge response but</font>

504
00:20:39,450 --> 00:20:48,140
yeah it's<font color="#E5E5E5"> just if there</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> just a</font><font color="#CCCCCC"> 32 bit</font>

505
00:20:41,640 --> 00:20:48,140
sequence number more questions

506
00:20:48,549 --> 00:20:51,749
in that case

