1
00:00:03,679 --> 00:00:04,960
hi there

2
00:00:04,960 --> 00:00:07,359
hey uh my name is larry pesci and i'm

3
00:00:07,359 --> 00:00:08,960
the director of research

4
00:00:08,960 --> 00:00:11,840
just a few other hats uh at uh in

5
00:00:11,840 --> 00:00:12,559
guardians

6
00:00:12,559 --> 00:00:15,040
and i'm here to talk a little bit today

7
00:00:15,040 --> 00:00:16,400
about um

8
00:00:16,400 --> 00:00:19,680
some rfid type

9
00:00:19,680 --> 00:00:22,880
cards from uh hid global and we're doing

10
00:00:22,880 --> 00:00:23,199
some

11
00:00:23,199 --> 00:00:27,519
hit card hacking uh here at crango con

12
00:00:27,519 --> 00:00:30,880
so first up uh a big thanks

13
00:00:30,880 --> 00:00:34,079
uh to santa for inviting me

14
00:00:34,079 --> 00:00:37,280
um you know it took a little bit of time

15
00:00:37,280 --> 00:00:41,520
uh to get here a couple flights

16
00:00:41,520 --> 00:00:45,280
um you know masks secret locations

17
00:00:45,280 --> 00:00:48,640
um but uh you know many of my uh my

18
00:00:48,640 --> 00:00:50,399
other presenters are saying it's uh it's

19
00:00:50,399 --> 00:00:53,680
it's pretty cold but um i'm

20
00:00:53,680 --> 00:00:55,760
i'm from new england and and we get a

21
00:00:55,760 --> 00:00:57,920
fair bit of snow and it's not as cold as

22
00:00:57,920 --> 00:00:58,399
some

23
00:00:58,399 --> 00:01:01,920
other places uh but uh certainly

24
00:01:01,920 --> 00:01:04,319
uh it's still you know jeans and t-shirt

25
00:01:04,319 --> 00:01:05,040
weather

26
00:01:05,040 --> 00:01:07,840
uh here at the north pole even though it

27
00:01:07,840 --> 00:01:09,040
is a little blustery

28
00:01:09,040 --> 00:01:10,400
now you don't want to stay outside for

29
00:01:10,400 --> 00:01:13,040
very long but certainly

30
00:01:13,040 --> 00:01:15,840
it's uh it's still quite reasonable so a

31
00:01:15,840 --> 00:01:18,799
big thanks to uh to santa for the invite

32
00:01:18,799 --> 00:01:22,080
uh and for uh the hospitality

33
00:01:22,080 --> 00:01:24,320
all right without further ado let's uh

34
00:01:24,320 --> 00:01:25,520
start looking

35
00:01:25,520 --> 00:01:28,720
at the hidden prox 2 from hid

36
00:01:28,720 --> 00:01:30,320
corporation

37
00:01:30,320 --> 00:01:34,000
so the hit prox2 is based on

38
00:01:34,000 --> 00:01:37,680
some low frequency rfid

39
00:01:37,680 --> 00:01:41,439
based technology they are fairly simple

40
00:01:41,439 --> 00:01:43,520
they don't have any security mechanism

41
00:01:43,520 --> 00:01:46,079
uh to them

42
00:01:46,079 --> 00:01:47,759
you read the card and they typically

43
00:01:47,759 --> 00:01:52,159
spit out a unique number of some sort

44
00:01:52,159 --> 00:01:55,439
they're incredibly uh popular for

45
00:01:55,439 --> 00:01:58,000
physical access control uh for gaining

46
00:01:58,000 --> 00:02:01,200
access into various organizations

47
00:02:01,200 --> 00:02:04,640
uh typically door access whether that be

48
00:02:04,640 --> 00:02:06,799
uh you know potentially into the front

49
00:02:06,799 --> 00:02:09,119
door of a multi-tenant facility

50
00:02:09,119 --> 00:02:11,599
into office suites and you know

51
00:02:11,599 --> 00:02:12,400
potentially even

52
00:02:12,400 --> 00:02:15,680
into some secure

53
00:02:15,680 --> 00:02:17,200
data centers and i'm using air quotes

54
00:02:17,200 --> 00:02:19,360
here for secure

55
00:02:19,360 --> 00:02:21,520
to restrict access into specific

56
00:02:21,520 --> 00:02:22,400
locations

57
00:02:22,400 --> 00:02:24,959
uh where there may be some more uh

58
00:02:24,959 --> 00:02:25,680
sensitive

59
00:02:25,680 --> 00:02:28,160
types of things that we need to restrict

60
00:02:28,160 --> 00:02:28,879
access to

61
00:02:28,879 --> 00:02:31,599
okay they are in fact typically low cost

62
00:02:31,599 --> 00:02:32,800
there are a couple of different

63
00:02:32,800 --> 00:02:36,640
um solutions within his

64
00:02:36,640 --> 00:02:39,360
prox uh product line but we're

65
00:02:39,360 --> 00:02:41,440
specifically going to be focusing on

66
00:02:41,440 --> 00:02:44,879
the uh hidden procs 2. specifically

67
00:02:44,879 --> 00:02:48,319
um from some quotes from stephanie r

68
00:02:48,319 --> 00:02:49,280
dilley

69
00:02:49,280 --> 00:02:52,319
the product manager uh at hid global uh

70
00:02:52,319 --> 00:02:53,440
who states that

71
00:02:53,440 --> 00:02:55,920
legacy 125 kilohertz that's the low

72
00:02:55,920 --> 00:02:56,800
frequency

73
00:02:56,800 --> 00:02:59,040
uh proximity technology is still in

74
00:02:59,040 --> 00:03:01,680
place at around 70 to 80 percent of all

75
00:03:01,680 --> 00:03:03,280
physical access control deployments in

76
00:03:03,280 --> 00:03:06,720
the us and it will be a long time before

77
00:03:06,720 --> 00:03:07,840
that changes

78
00:03:07,840 --> 00:03:10,959
and and absolutely i can i can see

79
00:03:10,959 --> 00:03:13,280
that figure based on the number of times

80
00:03:13,280 --> 00:03:15,200
i've gone into facilities and seen

81
00:03:15,200 --> 00:03:19,760
uh the hid prox2 solutions as well as

82
00:03:19,760 --> 00:03:22,720
the being for a long time typically

83
00:03:22,720 --> 00:03:25,120
these installs going into organizations

84
00:03:25,120 --> 00:03:29,040
are those that

85
00:03:29,200 --> 00:03:32,400
are a fixed asset and there's no push to

86
00:03:32,400 --> 00:03:34,080
replace them

87
00:03:34,080 --> 00:03:35,360
given that they're installed they're

88
00:03:35,360 --> 00:03:38,560
working and it will be fairly expensive

89
00:03:38,560 --> 00:03:42,080
to to make that happen oh

90
00:03:42,080 --> 00:03:44,319
hey so what's uh what does it all look

91
00:03:44,319 --> 00:03:45,680
like well

92
00:03:45,680 --> 00:03:48,239
we've got a couple of components uh to

93
00:03:48,239 --> 00:03:50,319
uh to the system uh on the left we've

94
00:03:50,319 --> 00:03:51,200
got our

95
00:03:51,200 --> 00:03:54,400
uh hidden prox2 uh reader uh where we

96
00:03:54,400 --> 00:03:54,959
present

97
00:03:54,959 --> 00:03:58,799
uh the card to the reader and the uh 125

98
00:03:58,799 --> 00:04:00,400
kilohertz uh rf

99
00:04:00,400 --> 00:04:03,040
energy uh transpires the card is

100
00:04:03,040 --> 00:04:05,519
activated by the presence of rf energy

101
00:04:05,519 --> 00:04:09,040
uh through some capacitive inductance

102
00:04:09,040 --> 00:04:11,280
and the card activates spits out a

103
00:04:11,280 --> 00:04:12,159
number

104
00:04:12,159 --> 00:04:15,040
uh and in this case access to santa's

105
00:04:15,040 --> 00:04:17,040
sentence workshop

106
00:04:17,040 --> 00:04:19,680
now the unique number from the card is

107
00:04:19,680 --> 00:04:20,798
translated

108
00:04:20,798 --> 00:04:24,560
uh via uh wire to some sort of

109
00:04:24,560 --> 00:04:27,600
uh controller that is the part that is

110
00:04:27,600 --> 00:04:28,080
uh

111
00:04:28,080 --> 00:04:30,000
checking for which numbers are allowed

112
00:04:30,000 --> 00:04:31,280
into uh

113
00:04:31,280 --> 00:04:34,000
into uh which doors and then triggers

114
00:04:34,000 --> 00:04:36,400
the unlock events uh for those

115
00:04:36,400 --> 00:04:40,400
uh those doors now on the wired side

116
00:04:40,400 --> 00:04:43,680
of on the back of the the the

117
00:04:43,680 --> 00:04:46,479
kid prox2 reader uh it gets translated

118
00:04:46,479 --> 00:04:47,040
to

119
00:04:47,040 --> 00:04:50,160
uh the wigan protocol uh which is a

120
00:04:50,160 --> 00:04:52,880
a well-known well-documented standard

121
00:04:52,880 --> 00:04:54,639
that is unencrypted

122
00:04:54,639 --> 00:04:57,040
uh on the back end so you know

123
00:04:57,040 --> 00:04:58,560
potentially in some of these systems we

124
00:04:58,560 --> 00:05:00,479
have a couple of other opportunities for

125
00:05:00,479 --> 00:05:02,000
us to interact with them

126
00:05:02,000 --> 00:05:04,960
and not just on the rf side we could

127
00:05:04,960 --> 00:05:06,160
potentially

128
00:05:06,160 --> 00:05:08,320
intercept that wigan protocol on the

129
00:05:08,320 --> 00:05:09,520
wire

130
00:05:09,520 --> 00:05:11,360
or we could potentially find somewhere

131
00:05:11,360 --> 00:05:13,120
on the network uh

132
00:05:13,120 --> 00:05:15,680
the systems that are potentially uh

133
00:05:15,680 --> 00:05:18,639
integrating with the door controllers

134
00:05:18,639 --> 00:05:21,600
uh for the read of the batches and the

135
00:05:21,600 --> 00:05:22,560
unlock codes

136
00:05:22,560 --> 00:05:26,880
uh you know typical windows

137
00:05:26,880 --> 00:05:29,520
or linux space system that would be

138
00:05:29,520 --> 00:05:31,120
subject to various network

139
00:05:31,120 --> 00:05:33,840
uh traditional type of pen test attacks

140
00:05:33,840 --> 00:05:36,080
on the network

141
00:05:36,080 --> 00:05:39,360
all right so let's take a look at the

142
00:05:39,360 --> 00:05:42,240
the cards themselves well the cards

143
00:05:42,240 --> 00:05:42,880
themselves

144
00:05:42,880 --> 00:05:45,120
do provide us a little bit of uh

145
00:05:45,120 --> 00:05:46,960
information

146
00:05:46,960 --> 00:05:48,479
when presented to a reader when

147
00:05:48,479 --> 00:05:50,639
activated they do spit out a unique

148
00:05:50,639 --> 00:05:51,280
number

149
00:05:51,280 --> 00:05:52,960
uh to the reader which is then

150
00:05:52,960 --> 00:05:55,520
interpreted and sent wigan protocol to

151
00:05:55,520 --> 00:05:57,120
the controller which verifies hey this

152
00:05:57,120 --> 00:05:57,759
card number

153
00:05:57,759 --> 00:06:00,960
is allowed uh into this door

154
00:06:00,960 --> 00:06:05,280
or not on the card itself there are some

155
00:06:05,280 --> 00:06:06,880
numbers printed

156
00:06:06,880 --> 00:06:09,440
there are uh the two numbers being the

157
00:06:09,440 --> 00:06:10,000
unique

158
00:06:10,000 --> 00:06:12,960
card identifier and the sales order

159
00:06:12,960 --> 00:06:13,840
tracking number

160
00:06:13,840 --> 00:06:16,160
now for the most part that sales order

161
00:06:16,160 --> 00:06:17,919
tracking number is not particularly

162
00:06:17,919 --> 00:06:18,800
useful

163
00:06:18,800 --> 00:06:22,240
uh to us but that card

164
00:06:22,240 --> 00:06:25,919
id number is that card unique id number

165
00:06:25,919 --> 00:06:30,000
is intended to be unique per card

166
00:06:30,000 --> 00:06:33,039
but if we can read that physically

167
00:06:33,039 --> 00:06:35,039
that doesn't make a whole lot of sense

168
00:06:35,039 --> 00:06:37,280
for us to have that be a secure

169
00:06:37,280 --> 00:06:38,479
mechanism

170
00:06:38,479 --> 00:06:41,199
but what really happens is that card id

171
00:06:41,199 --> 00:06:42,880
number is combined

172
00:06:42,880 --> 00:06:45,919
with a facility number or a unique

173
00:06:45,919 --> 00:06:49,360
you know purchaser or a unique location

174
00:06:49,360 --> 00:06:52,080
of facility number which is not printed

175
00:06:52,080 --> 00:06:54,400
on the card and it's only inspected

176
00:06:54,400 --> 00:06:57,280
uh and transferred in the air uh when

177
00:06:57,280 --> 00:06:57,919
read

178
00:06:57,919 --> 00:07:00,560
so a combination of a hidden facility

179
00:07:00,560 --> 00:07:01,360
number

180
00:07:01,360 --> 00:07:04,000
and a unique card id number that is

181
00:07:04,000 --> 00:07:04,960
printed

182
00:07:04,960 --> 00:07:08,080
on the outside of the cart one of the

183
00:07:08,080 --> 00:07:10,240
things that i think that's pretty neat

184
00:07:10,240 --> 00:07:12,880
about what hit did and potentially comes

185
00:07:12,880 --> 00:07:14,960
back to to bite them a little bit

186
00:07:14,960 --> 00:07:18,319
is hit didn't develop their own rfid

187
00:07:18,319 --> 00:07:19,680
based technologies

188
00:07:19,680 --> 00:07:22,720
they actually uh used some uh

189
00:07:22,720 --> 00:07:24,720
some rfid technology that was already

190
00:07:24,720 --> 00:07:27,120
out there from atmel specifically

191
00:07:27,120 --> 00:07:30,400
uh the t5557 and

192
00:07:30,400 --> 00:07:34,080
also i think the new one is the t55

193
00:07:34,080 --> 00:07:37,280
77 which to the best of my knowledge is

194
00:07:37,280 --> 00:07:40,400
uh backwards uh compatible now the thing

195
00:07:40,400 --> 00:07:41,680
that makes this interesting

196
00:07:41,680 --> 00:07:45,759
is that the atmel t5557 chipset

197
00:07:45,759 --> 00:07:48,080
is publicly available and it's usable

198
00:07:48,080 --> 00:07:48,800
for

199
00:07:48,800 --> 00:07:51,599
other purposes and is readily available

200
00:07:51,599 --> 00:07:52,560
uh

201
00:07:52,560 --> 00:07:54,800
in the market and hid global just

202
00:07:54,800 --> 00:07:56,080
decided to

203
00:07:56,080 --> 00:07:58,879
adopt this chipset for for their

204
00:07:58,879 --> 00:08:00,000
application

205
00:08:00,000 --> 00:08:01,280
what that means is that we could

206
00:08:01,280 --> 00:08:03,280
potentially purchase

207
00:08:03,280 --> 00:08:06,240
uh other cards from other systems that

208
00:08:06,240 --> 00:08:08,080
are leveraging this chipset to be able

209
00:08:08,080 --> 00:08:08,960
to use

210
00:08:08,960 --> 00:08:12,000
uh within our kid prox card to supported

211
00:08:12,000 --> 00:08:14,160
systems

212
00:08:14,160 --> 00:08:17,520
all right so looking at that data format

213
00:08:17,520 --> 00:08:18,000
we

214
00:08:18,000 --> 00:08:21,039
for what is spit into the air

215
00:08:21,039 --> 00:08:24,400
comprised of that facility code

216
00:08:24,400 --> 00:08:28,000
and the unique card id

217
00:08:28,000 --> 00:08:31,199
the facility code is between uh 1

218
00:08:31,199 --> 00:08:35,519
and 255. zero is reserved for internal

219
00:08:35,519 --> 00:08:38,559
hidden corporation development and so

220
00:08:38,559 --> 00:08:39,360
forth

221
00:08:39,360 --> 00:08:41,679
uh and then the unique card id is

222
00:08:41,679 --> 00:08:43,440
between one and sixty five thousand five

223
00:08:43,440 --> 00:08:44,800
hundred and thirty five

224
00:08:44,800 --> 00:08:47,680
uh where zero is reserved or uh hid's

225
00:08:47,680 --> 00:08:48,399
internal

226
00:08:48,399 --> 00:08:51,760
uh stuff as well so

227
00:08:51,760 --> 00:08:53,600
we have a facility code between 1 and

228
00:08:53,600 --> 00:08:56,480
255 and for each one of those facility

229
00:08:56,480 --> 00:08:58,880
codes we can have a unique card

230
00:08:58,880 --> 00:09:00,000
identifier

231
00:09:00,000 --> 00:09:03,519
so i can walk up to a facility and

232
00:09:03,519 --> 00:09:06,560
see two different cards

233
00:09:06,560 --> 00:09:08,560
out in front of the building maybe

234
00:09:08,560 --> 00:09:10,000
someone's wearing them and note that

235
00:09:10,000 --> 00:09:13,120
they have the same card id uh in fact in

236
00:09:13,120 --> 00:09:16,160
likely in this case uh the facility code

237
00:09:16,160 --> 00:09:17,760
is different

238
00:09:17,760 --> 00:09:19,440
uh and we'll talk a little bit about you

239
00:09:19,440 --> 00:09:20,880
know some of those facility codes and

240
00:09:20,880 --> 00:09:22,399
the card ids

241
00:09:22,399 --> 00:09:26,880
so once that the data is on the card we

242
00:09:26,880 --> 00:09:28,240
print the card id unique

243
00:09:28,240 --> 00:09:31,680
uh on the outside we've got our facility

244
00:09:31,680 --> 00:09:32,959
code

245
00:09:32,959 --> 00:09:36,560
that data is then encoded and then

246
00:09:36,560 --> 00:09:39,040
happens to be encoded to a length of a

247
00:09:39,040 --> 00:09:40,080
26-bit

248
00:09:40,080 --> 00:09:43,839
data format and then at the reader it

249
00:09:43,839 --> 00:09:44,519
fits

250
00:09:44,519 --> 00:09:47,680
conveniently within a single

251
00:09:47,680 --> 00:09:50,959
wiegand protocol 26-bit data format so

252
00:09:50,959 --> 00:09:54,560
it fits nicely for one one packet

253
00:09:54,560 --> 00:09:57,839
now some of his

254
00:09:57,839 --> 00:10:02,640
later adaptations the hit corporate 1000

255
00:10:02,640 --> 00:10:04,959
has the ability to have longer facility

256
00:10:04,959 --> 00:10:06,800
code and card ids

257
00:10:06,800 --> 00:10:10,240
uh resulting in longer output of between

258
00:10:10,240 --> 00:10:13,120
34 to 37 bits

259
00:10:13,120 --> 00:10:16,160
but it doesn't have any additional

260
00:10:16,160 --> 00:10:19,279
security protections it is

261
00:10:19,279 --> 00:10:22,000
specifically related to the availability

262
00:10:22,000 --> 00:10:23,839
of the quote key space those unique

263
00:10:23,839 --> 00:10:26,399
identifiers

264
00:10:26,399 --> 00:10:29,440
so how would i interact uh with

265
00:10:29,440 --> 00:10:32,320
uh some of these hidde cards and and

266
00:10:32,320 --> 00:10:33,120
readers

267
00:10:33,120 --> 00:10:35,040
now there's a bunch of tools out there

268
00:10:35,040 --> 00:10:37,360
but arguably my favorite

269
00:10:37,360 --> 00:10:39,839
and even my favorite out of the proxmark

270
00:10:39,839 --> 00:10:40,800
versions

271
00:10:40,800 --> 00:10:44,240
the proxmark 3 the rdv2 uh

272
00:10:44,240 --> 00:10:47,920
version so specifically the prox mark

273
00:10:47,920 --> 00:10:51,519
iii uh is a tool for

274
00:10:51,519 --> 00:10:54,880
interacting with uh rfid both high

275
00:10:54,880 --> 00:10:55,839
frequency

276
00:10:55,839 --> 00:10:59,360
uh and low frequency for doing some

277
00:10:59,360 --> 00:11:00,640
really deep analysis

278
00:11:00,640 --> 00:11:04,000
as well as some utility type of

279
00:11:04,000 --> 00:11:06,640
uh application for interacting with

280
00:11:06,640 --> 00:11:08,320
various rfid tags

281
00:11:08,320 --> 00:11:09,839
and in this case we're specifically

282
00:11:09,839 --> 00:11:13,200
focused uh on the hidden prox2

283
00:11:13,200 --> 00:11:16,640
uh hardware was uh the original prox

284
00:11:16,640 --> 00:11:18,560
mark iii designed by jonathan west

285
00:11:18,560 --> 00:11:19,279
hughes

286
00:11:19,279 --> 00:11:22,720
uh and software by gerhard uh decoding

287
00:11:22,720 --> 00:11:23,839
gans

288
00:11:23,839 --> 00:11:27,600
and a few others as well as part of the

289
00:11:27,600 --> 00:11:28,480
project

290
00:11:28,480 --> 00:11:31,279
and uh the software and hardware has

291
00:11:31,279 --> 00:11:31,680
seen

292
00:11:31,680 --> 00:11:35,600
some evolution uh over time

293
00:11:35,600 --> 00:11:37,120
uh the thing that i think that is

294
00:11:37,120 --> 00:11:38,880
fantastic about the proxmark

295
00:11:38,880 --> 00:11:41,120
uh while it's complex potentially in its

296
00:11:41,120 --> 00:11:42,880
usage through

297
00:11:42,880 --> 00:11:45,360
the tethered software attaching it to

298
00:11:45,360 --> 00:11:46,480
our computer

299
00:11:46,480 --> 00:11:48,480
it gives us the ability to read tags

300
00:11:48,480 --> 00:11:51,440
interrogate them find out all the values

301
00:11:51,440 --> 00:11:53,279
find out its feature set capabilities

302
00:11:53,279 --> 00:11:55,680
and even determine its types

303
00:11:55,680 --> 00:11:59,600
it has also the ability to become a card

304
00:11:59,600 --> 00:12:02,880
a tag itself meaning

305
00:12:02,880 --> 00:12:05,040
it can receive the data and then

306
00:12:05,040 --> 00:12:06,560
transmit

307
00:12:06,560 --> 00:12:08,959
that data back as if it was an actual

308
00:12:08,959 --> 00:12:10,240
card okay

309
00:12:10,240 --> 00:12:12,880
uh it's typically usb based when we're

310
00:12:12,880 --> 00:12:14,720
interacting with it with the prox mark

311
00:12:14,720 --> 00:12:16,240
iii software it does also work in

312
00:12:16,240 --> 00:12:18,160
standalone mode we'll cover that

313
00:12:18,160 --> 00:12:20,399
uh but uh typically we're interacting

314
00:12:20,399 --> 00:12:21,279
with it uh

315
00:12:21,279 --> 00:12:24,959
over usb uh to manipulate the device

316
00:12:24,959 --> 00:12:26,880
with the prox mark iii software

317
00:12:26,880 --> 00:12:29,760
and that proxmark3 software has multiple

318
00:12:29,760 --> 00:12:30,959
different options

319
00:12:30,959 --> 00:12:32,720
and some of that evolution over over

320
00:12:32,720 --> 00:12:34,639
time

321
00:12:34,639 --> 00:12:37,920
and one of the more a prevalent is the

322
00:12:37,920 --> 00:12:38,240
uh

323
00:12:38,240 --> 00:12:40,800
iceman version of the prox mark iii uh

324
00:12:40,800 --> 00:12:41,600
software

325
00:12:41,600 --> 00:12:44,320
uh we've seen some uh from brad and

326
00:12:44,320 --> 00:12:45,360
hanowitz

327
00:12:45,360 --> 00:12:47,600
introducing the ability to do uh brute

328
00:12:47,600 --> 00:12:48,560
forcing

329
00:12:48,560 --> 00:12:51,120
on head cards with prox brute uh and

330
00:12:51,120 --> 00:12:52,959
even some potential

331
00:12:52,959 --> 00:12:56,160
interesting custom versions for the

332
00:12:56,160 --> 00:12:59,439
holiday hack challenge

333
00:12:59,760 --> 00:13:03,120
all right so with the proxmark 3

334
00:13:03,120 --> 00:13:05,600
attached to our computer over usb using

335
00:13:05,600 --> 00:13:08,320
the prox mark 3 software we can in fact

336
00:13:08,320 --> 00:13:12,399
read the cards get their unique values

337
00:13:12,399 --> 00:13:15,680
and then get the prox mark iii to replay

338
00:13:15,680 --> 00:13:17,200
those values into the air

339
00:13:17,200 --> 00:13:21,279
acting as if we had the physical card

340
00:13:21,279 --> 00:13:23,920
this allows us to effectively perform

341
00:13:23,920 --> 00:13:24,639
cloning

342
00:13:24,639 --> 00:13:28,000
type of attacks now we can do capture

343
00:13:28,000 --> 00:13:30,480
and effectively replay and we can do

344
00:13:30,480 --> 00:13:31,440
capture

345
00:13:31,440 --> 00:13:35,040
and push that data to a brand new card

346
00:13:35,040 --> 00:13:36,320
so we can actually have

347
00:13:36,320 --> 00:13:38,959
physical card medium as opposed to this

348
00:13:38,959 --> 00:13:39,839
piece of

349
00:13:39,839 --> 00:13:43,120
electronics now there's no prevention

350
00:13:43,120 --> 00:13:44,320
for anyone for reading

351
00:13:44,320 --> 00:13:47,360
these tags we just need to present it to

352
00:13:47,360 --> 00:13:48,480
the reader

353
00:13:48,480 --> 00:13:51,199
and in this case uh we're connected to

354
00:13:51,199 --> 00:13:52,720
the prox mark 3 software we've got our

355
00:13:52,720 --> 00:13:53,279
product mark

356
00:13:53,279 --> 00:13:57,360
iii connected via usb and we issue the

357
00:13:57,360 --> 00:14:01,199
low frequency hid read command

358
00:14:01,199 --> 00:14:03,279
it reads a card present uh to the

359
00:14:03,279 --> 00:14:04,480
antenna

360
00:14:04,480 --> 00:14:07,199
in very close proximity and it tells us

361
00:14:07,199 --> 00:14:07,600
that

362
00:14:07,600 --> 00:14:11,040
uh it's a 26 bit uh hid

363
00:14:11,040 --> 00:14:13,839
gives us our facility code of 149 and

364
00:14:13,839 --> 00:14:15,279
our card number of six

365
00:14:15,279 --> 00:14:18,880
four eight nine nine okay and then some

366
00:14:18,880 --> 00:14:21,920
uh some raw data uh down on the bottom

367
00:14:21,920 --> 00:14:22,639
with lots of

368
00:14:22,639 --> 00:14:25,199
zero leading zeros and if you take a

369
00:14:25,199 --> 00:14:26,880
look the card that we read

370
00:14:26,880 --> 00:14:29,519
uh over here on the right uh we do have

371
00:14:29,519 --> 00:14:30,399
some values

372
00:14:30,399 --> 00:14:33,600
printed on the card is 64899

373
00:14:33,600 --> 00:14:37,680
and then the 1126-1137-1

374
00:14:37,680 --> 00:14:39,199
being that unique purchase order

375
00:14:39,199 --> 00:14:41,680
tracking number so the unique number for

376
00:14:41,680 --> 00:14:44,720
this card was 64899 which we recovered

377
00:14:44,720 --> 00:14:46,160
as the cn

378
00:14:46,160 --> 00:14:48,639
with our low frequency hit reap and we

379
00:14:48,639 --> 00:14:50,240
also recovered that

380
00:14:50,240 --> 00:14:53,040
facility code the fc of 149 the part

381
00:14:53,040 --> 00:14:54,480
that's only inspected

382
00:14:54,480 --> 00:14:58,240
in rf once we have that data

383
00:14:58,240 --> 00:15:00,800
we can use the low frequency hid

384
00:15:00,800 --> 00:15:02,079
simulate or sim

385
00:15:02,079 --> 00:15:05,680
command and use some raw data to spit

386
00:15:05,680 --> 00:15:06,320
those same

387
00:15:06,320 --> 00:15:08,639
card values back out into the air from

388
00:15:08,639 --> 00:15:09,920
our prox mark iii

389
00:15:09,920 --> 00:15:12,240
and then present our prox mark iii to

390
00:15:12,240 --> 00:15:12,959
the reader

391
00:15:12,959 --> 00:15:16,079
uh which the reader thinks a valid card

392
00:15:16,079 --> 00:15:18,160
has been presented

393
00:15:18,160 --> 00:15:21,120
uh in this case we are using uh the raw

394
00:15:21,120 --> 00:15:21,760
data

395
00:15:21,760 --> 00:15:24,240
with the tr uh the leading zeros uh

396
00:15:24,240 --> 00:15:25,040
trimmed off

397
00:15:25,040 --> 00:15:27,760
so you note on our lf he had read we

398
00:15:27,760 --> 00:15:29,279
have that raw data at the bottom with a

399
00:15:29,279 --> 00:15:30,320
bunch of zeros

400
00:15:30,320 --> 00:15:32,639
uh starting two four oh one uh we just

401
00:15:32,639 --> 00:15:34,240
use that two four oh one

402
00:15:34,240 --> 00:15:37,519
uh for uh the replay

403
00:15:37,519 --> 00:15:40,240
um for the raw data with the low

404
00:15:40,240 --> 00:15:41,279
frequency hid

405
00:15:41,279 --> 00:15:45,040
simulate so super easy

406
00:15:45,040 --> 00:15:48,720
read and effectively replay

407
00:15:48,720 --> 00:15:52,079
we can also clone to a

408
00:15:52,079 --> 00:15:55,839
a new card now the standard hid prox 2

409
00:15:55,839 --> 00:15:59,120
tags are uh not writable that

410
00:15:59,120 --> 00:16:01,519
facility and id code cannot be changed

411
00:16:01,519 --> 00:16:02,240
they're read

412
00:16:02,240 --> 00:16:05,440
only cards but as you remember they are

413
00:16:05,440 --> 00:16:11,279
commodity atmel t5557 or t557s

414
00:16:11,279 --> 00:16:13,040
and there are some enterprising firms

415
00:16:13,040 --> 00:16:14,320
that have purchased

416
00:16:14,320 --> 00:16:16,800
these atmel chipsets and provide them to

417
00:16:16,800 --> 00:16:18,320
the consumer

418
00:16:18,320 --> 00:16:20,480
in a quote magic version and i'm using

419
00:16:20,480 --> 00:16:21,839
air quotes here

420
00:16:21,839 --> 00:16:25,600
to make them writeable now

421
00:16:25,600 --> 00:16:28,959
they're they're questionable in uh

422
00:16:28,959 --> 00:16:31,600
you know how hid wants folks to sell

423
00:16:31,600 --> 00:16:32,399
these

424
00:16:32,399 --> 00:16:34,720
um but they can't do a ton of

425
00:16:34,720 --> 00:16:36,000
restriction because they

426
00:16:36,000 --> 00:16:38,240
are a publicly available chipset from

427
00:16:38,240 --> 00:16:39,360
amazon from

428
00:16:39,360 --> 00:16:42,320
uh from atmel uh and i've had really

429
00:16:42,320 --> 00:16:43,360
great luck

430
00:16:43,360 --> 00:16:46,079
in being able to to find some of these

431
00:16:46,079 --> 00:16:46,720
both through

432
00:16:46,720 --> 00:16:50,000
ebay and amazon and amazon

433
00:16:50,000 --> 00:16:53,360
prime today uh by searching for

434
00:16:53,360 --> 00:16:56,880
uh writable t5557 uh and sometimes

435
00:16:56,880 --> 00:16:57,440
you'll get

436
00:16:57,440 --> 00:17:02,399
the models that come back of the t5577

437
00:17:02,399 --> 00:17:04,319
okay so how would we actually write this

438
00:17:04,319 --> 00:17:06,319
to uh a new card

439
00:17:06,319 --> 00:17:09,199
uh well first one uh instead of doing uh

440
00:17:09,199 --> 00:17:09,520
the

441
00:17:09,520 --> 00:17:14,000
uh lf hid read we can just do lf search

442
00:17:14,000 --> 00:17:17,359
and it tries to find all the possible

443
00:17:17,359 --> 00:17:18,799
low frequency card present to the

444
00:17:18,799 --> 00:17:21,119
antenna and in this case

445
00:17:21,119 --> 00:17:25,039
uh it did find that we had that same

446
00:17:25,039 --> 00:17:28,400
head card with the facility code of 149

447
00:17:28,400 --> 00:17:29,320
and the

448
00:17:29,320 --> 00:17:32,480
64899 for the unique card identifier

449
00:17:32,480 --> 00:17:34,640
and its raw data so it attempts to read

450
00:17:34,640 --> 00:17:36,240
all the low frequency tags

451
00:17:36,240 --> 00:17:40,000
and until it discovers one

452
00:17:40,000 --> 00:17:43,120
once we have that that raw data we can

453
00:17:43,120 --> 00:17:46,400
write that to a new card with the

454
00:17:46,400 --> 00:17:49,440
low frequency lf hid clone

455
00:17:49,440 --> 00:17:51,840
and the clone is not simulating that

456
00:17:51,840 --> 00:17:53,760
data into the air it's actually

457
00:17:53,760 --> 00:17:57,360
pushing it to a a new blank card

458
00:17:57,360 --> 00:18:00,640
with the t5557 chipset and writing that

459
00:18:00,640 --> 00:18:01,760
raw data to it

460
00:18:01,760 --> 00:18:03,520
uh it says it's preparing to clone you

461
00:18:03,520 --> 00:18:05,760
present the card it writes the data

462
00:18:05,760 --> 00:18:10,559
and then you have a new physical cart

463
00:18:10,559 --> 00:18:12,880
all right it is possible to do

464
00:18:12,880 --> 00:18:14,799
standalone

465
00:18:14,799 --> 00:18:18,080
cloning or capture and replay

466
00:18:18,080 --> 00:18:20,240
because well if we're going to do a

467
00:18:20,240 --> 00:18:22,000
capture and replay

468
00:18:22,000 --> 00:18:24,080
that device you know it's really small

469
00:18:24,080 --> 00:18:25,360
fits in the palm of your hand

470
00:18:25,360 --> 00:18:27,120
but it's now attached to your laptop

471
00:18:27,120 --> 00:18:28,640
with a usb cable when you're issuing

472
00:18:28,640 --> 00:18:31,039
some commands and so forth

473
00:18:31,039 --> 00:18:34,559
and that's not very stealthy that's

474
00:18:34,559 --> 00:18:37,679
quite obvious to surreptitiously bump

475
00:18:37,679 --> 00:18:39,039
into someone on the bus

476
00:18:39,039 --> 00:18:43,120
or outside of the building uh and

477
00:18:43,120 --> 00:18:44,960
that's you're gonna get caught doing

478
00:18:44,960 --> 00:18:46,480
that type of stuff so

479
00:18:46,480 --> 00:18:48,559
uh the prox mark iii can also perform

480
00:18:48,559 --> 00:18:49,520
untethered

481
00:18:49,520 --> 00:18:52,480
cloning meaning if you provide it with

482
00:18:52,480 --> 00:18:54,880
some power like a

483
00:18:54,880 --> 00:18:57,679
portable usb phone charger type thing or

484
00:18:57,679 --> 00:18:59,440
the optional internal battery for the

485
00:18:59,440 --> 00:19:00,799
rdv2

486
00:19:00,799 --> 00:19:03,039
we can power it and then use that one

487
00:19:03,039 --> 00:19:04,400
button

488
00:19:04,400 --> 00:19:06,480
uh on the prox mark iii with the various

489
00:19:06,480 --> 00:19:09,520
sets of key presses to read hid tags

490
00:19:09,520 --> 00:19:10,960
and once it reads a tag it will

491
00:19:10,960 --> 00:19:13,440
automatically start simulating just like

492
00:19:13,440 --> 00:19:14,799
issuing that

493
00:19:14,799 --> 00:19:17,919
lf hidden simulate command for the most

494
00:19:17,919 --> 00:19:18,480
recent

495
00:19:18,480 --> 00:19:21,679
tag that was read so and we can do that

496
00:19:21,679 --> 00:19:23,520
with that small device battery powered

497
00:19:23,520 --> 00:19:24,320
in the palm

498
00:19:24,320 --> 00:19:28,880
of our hand the challenge becomes

499
00:19:28,880 --> 00:19:31,120
what happens if we read a tag with the

500
00:19:31,120 --> 00:19:32,880
unique identifier

501
00:19:32,880 --> 00:19:35,280
and a facility code and typically that

502
00:19:35,280 --> 00:19:37,200
facility code is going to be the same

503
00:19:37,200 --> 00:19:39,919
for every that that run of cards that we

504
00:19:39,919 --> 00:19:40,559
order

505
00:19:40,559 --> 00:19:42,480
uh so let's say santa's workshop

506
00:19:42,480 --> 00:19:44,640
facility code 149

507
00:19:44,640 --> 00:19:47,600
every card that has access to santa's

508
00:19:47,600 --> 00:19:49,360
workshop will typically have

509
00:19:49,360 --> 00:19:52,240
uh the facility code of 149 and the

510
00:19:52,240 --> 00:19:54,720
unique card identifiers are the part

511
00:19:54,720 --> 00:19:57,919
uh that change now it is possible to

512
00:19:57,919 --> 00:20:01,919
buy cards that are randomized

513
00:20:01,919 --> 00:20:05,440
but you definitely pay a premium

514
00:20:05,440 --> 00:20:07,760
for that uh and i've only ever

515
00:20:07,760 --> 00:20:10,559
encountered uh one organization that

516
00:20:10,559 --> 00:20:14,080
has ever uh had fully admitted that

517
00:20:14,080 --> 00:20:16,400
they randomized all of their facility

518
00:20:16,400 --> 00:20:17,840
codes and

519
00:20:17,840 --> 00:20:19,840
their card numbers and they said they

520
00:20:19,840 --> 00:20:21,280
paid you know

521
00:20:21,280 --> 00:20:23,760
exorbitant amounts of money to be able

522
00:20:23,760 --> 00:20:25,360
to make that happen

523
00:20:25,360 --> 00:20:27,760
now part of the reason why they did so

524
00:20:27,760 --> 00:20:29,679
is if you think about how you're buying

525
00:20:29,679 --> 00:20:31,440
your cards you're getting them in say a

526
00:20:31,440 --> 00:20:32,400
chunk of

527
00:20:32,400 --> 00:20:35,679
100 or five hundred cards and they're

528
00:20:35,679 --> 00:20:37,200
all shrink wrap you un

529
00:20:37,200 --> 00:20:41,039
you open the shrink wrap and then uh

530
00:20:41,039 --> 00:20:43,679
you start programming the cards and you

531
00:20:43,679 --> 00:20:44,320
know the first

532
00:20:44,320 --> 00:20:45,840
your first card out you program the

533
00:20:45,840 --> 00:20:48,240
system and that's the the security team

534
00:20:48,240 --> 00:20:49,840
uh meaning the physical security team

535
00:20:49,840 --> 00:20:51,440
they have access to everything so they

536
00:20:51,440 --> 00:20:52,880
can do their inspections

537
00:20:52,880 --> 00:20:56,000
uh and then maybe you uh end up with the

538
00:20:56,000 --> 00:20:56,799
c-level

539
00:20:56,799 --> 00:20:58,880
executives and they have access to

540
00:20:58,880 --> 00:20:59,919
everything

541
00:20:59,919 --> 00:21:02,559
and then you start moving down uh down

542
00:21:02,559 --> 00:21:04,080
the chain you have your

543
00:21:04,080 --> 00:21:05,679
computer administrators that need access

544
00:21:05,679 --> 00:21:07,919
to the computer room uh and then you get

545
00:21:07,919 --> 00:21:09,360
down to your administrative assistants

546
00:21:09,360 --> 00:21:10,960
and your interns that just need access

547
00:21:10,960 --> 00:21:13,039
to the front door

548
00:21:13,039 --> 00:21:17,840
but let's say uh you uh recover a card

549
00:21:17,840 --> 00:21:20,880
and uh it's for the administrative

550
00:21:20,880 --> 00:21:22,320
assistant you can get into the front

551
00:21:22,320 --> 00:21:24,400
door of the multi-tenant facility

552
00:21:24,400 --> 00:21:26,960
you can get into the office suite but

553
00:21:26,960 --> 00:21:28,880
you present that card to the data center

554
00:21:28,880 --> 00:21:31,520
door and it doesn't allow you in

555
00:21:31,520 --> 00:21:34,960
because now you have the card of a lower

556
00:21:34,960 --> 00:21:36,640
privileged user and you need to elevate

557
00:21:36,640 --> 00:21:38,000
your rights

558
00:21:38,000 --> 00:21:40,559
now if we think about that you know

559
00:21:40,559 --> 00:21:42,400
that's that administrative assistant

560
00:21:42,400 --> 00:21:45,440
that has likely gotten that card

561
00:21:45,440 --> 00:21:47,840
towards the end of the run meaning they

562
00:21:47,840 --> 00:21:49,360
have the higher number

563
00:21:49,360 --> 00:21:51,520
so if we think about those cards that

564
00:21:51,520 --> 00:21:53,679
were delivered they're typically

565
00:21:53,679 --> 00:21:56,240
sequentially numbered so if we look at

566
00:21:56,240 --> 00:21:57,120
this one here

567
00:21:57,120 --> 00:21:59,039
up in the top middle we've got uh one

568
00:21:59,039 --> 00:22:00,559
five five seven three

569
00:22:00,559 --> 00:22:04,640
and then we go over to the left uh 574

570
00:22:04,640 --> 00:22:07,919
575 second third one in go back

571
00:22:07,919 --> 00:22:13,640
one 576 578

572
00:22:13,640 --> 00:22:17,200
579 580 581

573
00:22:17,200 --> 00:22:20,960
there's no 577 but i'd argue that it's

574
00:22:20,960 --> 00:22:22,080
probably the card that's

575
00:22:22,080 --> 00:22:24,320
turned over in the front here uh where

576
00:22:24,320 --> 00:22:26,320
we can't see the number

577
00:22:26,320 --> 00:22:28,720
so they're sequentially numbered maybe

578
00:22:28,720 --> 00:22:30,320
they're a little bit out of order uh you

579
00:22:30,320 --> 00:22:30,559
know

580
00:22:30,559 --> 00:22:32,480
maybe we dropped them uh as we were

581
00:22:32,480 --> 00:22:34,640
taking a couple of them out uh so

582
00:22:34,640 --> 00:22:37,600
they're they're close so if we can read

583
00:22:37,600 --> 00:22:38,400
one card

584
00:22:38,400 --> 00:22:41,760
and recover the facility code maybe we

585
00:22:41,760 --> 00:22:43,520
need to start guessing

586
00:22:43,520 --> 00:22:46,080
other card numbers because the card

587
00:22:46,080 --> 00:22:47,280
number that we read

588
00:22:47,280 --> 00:22:50,320
doesn't provide us access but those with

589
00:22:50,320 --> 00:22:53,039
lower numbers and some case higher

590
00:22:53,039 --> 00:22:53,520
numbers

591
00:22:53,520 --> 00:22:56,640
usually lower numbers uh will allow us

592
00:22:56,640 --> 00:22:59,039
to get into places where uh the card

593
00:22:59,039 --> 00:23:00,240
number that we read

594
00:23:00,240 --> 00:23:02,799
uh doesn't allow us to but read using

595
00:23:02,799 --> 00:23:03,520
that same

596
00:23:03,520 --> 00:23:07,120
facility code okay so

597
00:23:07,120 --> 00:23:10,240
with that thinking um about uh some of

598
00:23:10,240 --> 00:23:11,840
those facility codes and those card

599
00:23:11,840 --> 00:23:12,559
numbers

600
00:23:12,559 --> 00:23:15,840
uh i do very much encourage you to

601
00:23:15,840 --> 00:23:17,840
have fun during the holiday hack

602
00:23:17,840 --> 00:23:19,120
challenge and

603
00:23:19,120 --> 00:23:22,240
explore the use of a approx mark

604
00:23:22,240 --> 00:23:25,840
iii uh within uh within the challenge

605
00:23:25,840 --> 00:23:29,280
and a huge thanks to uh the holiday hack

606
00:23:29,280 --> 00:23:29,840
challenge

607
00:23:29,840 --> 00:23:33,520
team that puts all this on and spends

608
00:23:33,520 --> 00:23:36,640
so much time crafting this game

609
00:23:36,640 --> 00:23:40,080
and you know giving this to uh

610
00:23:40,080 --> 00:23:42,480
to the community during the holidays so

611
00:23:42,480 --> 00:23:44,000
and again a big thanks

612
00:23:44,000 --> 00:23:47,600
uh to santa uh and uh everyone involved

613
00:23:47,600 --> 00:23:51,039
and please uh go enjoy and uh we'll talk

614
00:23:51,039 --> 00:23:57,360
to you soon

