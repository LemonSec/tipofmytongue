1
00:00:02,159 --> 00:00:04,160
hi everyone and welcome to my cringlecon

2
00:00:04,160 --> 00:00:06,399
3 talk red teaming why organizations

3
00:00:06,399 --> 00:00:07,359
hack themselves

4
00:00:07,359 --> 00:00:09,440
i'm david tomaszek i'm a senior security

5
00:00:09,440 --> 00:00:10,559
engineer

6
00:00:10,559 --> 00:00:11,920
on the google red team and i'm going to

7
00:00:11,920 --> 00:00:14,080
be talking a little bit about why we do

8
00:00:14,080 --> 00:00:16,239
red teaming and how we go about the

9
00:00:16,239 --> 00:00:18,080
approach of conducting a red team

10
00:00:18,080 --> 00:00:21,279
exercise before we dive in i'd like to

11
00:00:21,279 --> 00:00:22,880
cover a quick disclaimer

12
00:00:22,880 --> 00:00:24,720
that the opinions stated here are my own

13
00:00:24,720 --> 00:00:25,920
and not those

14
00:00:25,920 --> 00:00:28,960
of my company the scenario described is

15
00:00:28,960 --> 00:00:30,240
entirely hypothetical

16
00:00:30,240 --> 00:00:32,159
and does not reflect any real world

17
00:00:32,159 --> 00:00:34,559
events

18
00:00:34,640 --> 00:00:37,120
a little obligatory about me as i said

19
00:00:37,120 --> 00:00:38,879
before i'm senior security engineer at

20
00:00:38,879 --> 00:00:40,719
google i'm a tech lead on the offensive

21
00:00:40,719 --> 00:00:42,000
security team

22
00:00:42,000 --> 00:00:44,640
i'm also a security researcher and a ctf

23
00:00:44,640 --> 00:00:45,600
player

24
00:00:45,600 --> 00:00:48,960
uh there's my twitter and blog if you're

25
00:00:48,960 --> 00:00:50,559
interested in finding out more

26
00:00:50,559 --> 00:00:53,360
i will also have a copy of the slides up

27
00:00:53,360 --> 00:00:54,719
on my blog

28
00:00:54,719 --> 00:00:58,559
once this goes live so what is

29
00:00:58,559 --> 00:01:00,160
offensive security well offensive

30
00:01:00,160 --> 00:01:01,920
security is basically

31
00:01:01,920 --> 00:01:04,080
using adversarial techniques to test

32
00:01:04,080 --> 00:01:06,000
security controls sometimes you'll hear

33
00:01:06,000 --> 00:01:06,880
it called

34
00:01:06,880 --> 00:01:09,280
ethical hacking it's at least legal

35
00:01:09,280 --> 00:01:10,320
hacking

36
00:01:10,320 --> 00:01:12,960
it's a spectrum of activity ranging from

37
00:01:12,960 --> 00:01:15,280
penetration testing to red teaming

38
00:01:15,280 --> 00:01:18,159
it's authorized by the organization that

39
00:01:18,159 --> 00:01:18,799
is

40
00:01:18,799 --> 00:01:22,240
under attack in the case of uh

41
00:01:22,240 --> 00:01:23,920
a internal red team it would be

42
00:01:23,920 --> 00:01:25,439
authorized by your employer

43
00:01:25,439 --> 00:01:27,520
it's also done as consulting where

44
00:01:27,520 --> 00:01:29,439
you're hired by a company to come in and

45
00:01:29,439 --> 00:01:30,640
perform these

46
00:01:30,640 --> 00:01:33,280
attacks in either case it's done with

47
00:01:33,280 --> 00:01:37,119
authorization of the target

48
00:01:37,200 --> 00:01:39,680
so red teaming in particular is a

49
00:01:39,680 --> 00:01:41,600
business objective driven

50
00:01:41,600 --> 00:01:44,399
approach to offensive security it's

51
00:01:44,399 --> 00:01:47,040
attempting to test the entire cyber kill

52
00:01:47,040 --> 00:01:49,439
chain but through adversary emulation

53
00:01:49,439 --> 00:01:51,600
and what i mean by the cyber kill chain

54
00:01:51,600 --> 00:01:53,280
is what we have here on the right and

55
00:01:53,280 --> 00:01:54,640
it's the steps

56
00:01:54,640 --> 00:01:56,719
that generally any adversary whether

57
00:01:56,719 --> 00:01:58,719
simulated or real world will have to go

58
00:01:58,719 --> 00:01:59,200
through

59
00:01:59,200 --> 00:02:01,600
in order to successfully compromise an

60
00:02:01,600 --> 00:02:03,119
organization

61
00:02:03,119 --> 00:02:05,600
and it starts with reconnaissance and

62
00:02:05,600 --> 00:02:07,119
goes all the way until

63
00:02:07,119 --> 00:02:09,360
they have action on their target right

64
00:02:09,360 --> 00:02:11,120
which is actually conducting whatever it

65
00:02:11,120 --> 00:02:12,400
is you were trying to do

66
00:02:12,400 --> 00:02:14,640
whether it's stealing some data or

67
00:02:14,640 --> 00:02:16,000
modifying some data

68
00:02:16,000 --> 00:02:18,720
or performing some other business

69
00:02:18,720 --> 00:02:19,520
relevant

70
00:02:19,520 --> 00:02:22,239
action within the target organization

71
00:02:22,239 --> 00:02:23,920
and we'll go through each of these steps

72
00:02:23,920 --> 00:02:24,400
using

73
00:02:24,400 --> 00:02:27,599
an example of how we go about

74
00:02:27,599 --> 00:02:31,679
conducting a red team exercise

75
00:02:32,160 --> 00:02:34,959
there's a reason why we conduct red

76
00:02:34,959 --> 00:02:36,080
teaming

77
00:02:36,080 --> 00:02:39,120
it's mostly done to do what we call

78
00:02:39,120 --> 00:02:40,879
challenging assumptions which is where

79
00:02:40,879 --> 00:02:43,040
you think that you have

80
00:02:43,040 --> 00:02:45,120
adequate security or you think that you

81
00:02:45,120 --> 00:02:46,879
have security controls in place but it's

82
00:02:46,879 --> 00:02:48,800
to try to identify those gaps between

83
00:02:48,800 --> 00:02:49,120
how

84
00:02:49,120 --> 00:02:50,800
they were designed and how they are

85
00:02:50,800 --> 00:02:52,560
implemented right discover

86
00:02:52,560 --> 00:02:55,680
maybe misconfigurations or unexpected

87
00:02:55,680 --> 00:02:58,879
approaches to bypass security controls

88
00:02:58,879 --> 00:03:02,239
you might find exposed back ends that no

89
00:03:02,239 --> 00:03:03,680
one knew about or something like that

90
00:03:03,680 --> 00:03:04,080
that

91
00:03:04,080 --> 00:03:05,840
allows you to completely bypass the

92
00:03:05,840 --> 00:03:08,319
security controls

93
00:03:08,319 --> 00:03:09,920
it's also important in that it allows

94
00:03:09,920 --> 00:03:12,159
you to test your detection and response

95
00:03:12,159 --> 00:03:14,800
capabilities as an organization so your

96
00:03:14,800 --> 00:03:15,519
red team

97
00:03:15,519 --> 00:03:18,959
or your red teaming partner is the only

98
00:03:18,959 --> 00:03:20,800
adversary you'll be able to compare

99
00:03:20,800 --> 00:03:21,920
notes with

100
00:03:21,920 --> 00:03:23,599
whenever you get breached by a real

101
00:03:23,599 --> 00:03:25,040
adversary there's no way to know what

102
00:03:25,040 --> 00:03:27,040
you missed whereas when conducting a red

103
00:03:27,040 --> 00:03:28,799
team you can go back and compare notes

104
00:03:28,799 --> 00:03:30,400
between the red and blue teams

105
00:03:30,400 --> 00:03:32,480
to discover whether were there any hosts

106
00:03:32,480 --> 00:03:33,920
that the blue team missed you

107
00:03:33,920 --> 00:03:37,440
taking action on was there any um

108
00:03:37,440 --> 00:03:39,040
you know things that should have been

109
00:03:39,040 --> 00:03:41,120
signaled that weren't signaled

110
00:03:41,120 --> 00:03:44,640
in the case of the exercise

111
00:03:44,640 --> 00:03:46,480
so these are all these blind spots that

112
00:03:46,480 --> 00:03:48,480
you can find by comparing notes and

113
00:03:48,480 --> 00:03:49,440
finding out

114
00:03:49,440 --> 00:03:51,360
what additional signals need to be added

115
00:03:51,360 --> 00:03:52,799
what different actions should be taken

116
00:03:52,799 --> 00:03:53,360
on those

117
00:03:53,360 --> 00:03:56,560
uh signals how does the cleanup work

118
00:03:56,560 --> 00:03:59,280
digit the blue team send signals to the

119
00:03:59,280 --> 00:04:00,000
adversary

120
00:04:00,000 --> 00:04:01,360
when they were caught so there's a

121
00:04:01,360 --> 00:04:03,360
variety of different

122
00:04:03,360 --> 00:04:05,680
lessons that can come out of conducting

123
00:04:05,680 --> 00:04:09,439
an offensive security exercise

124
00:04:09,439 --> 00:04:11,120
so how do we go about running one of

125
00:04:11,120 --> 00:04:13,040
these exercises well i said we'd go

126
00:04:13,040 --> 00:04:15,040
through the various phases and

127
00:04:15,040 --> 00:04:16,560
the first thing we have to do is we have

128
00:04:16,560 --> 00:04:18,720
to figure out who our actor

129
00:04:18,720 --> 00:04:21,199
and our objective are right like what is

130
00:04:21,199 --> 00:04:22,000
it that

131
00:04:22,000 --> 00:04:24,560
someone is trying to do and who is it

132
00:04:24,560 --> 00:04:26,160
that is trying to do that

133
00:04:26,160 --> 00:04:27,600
so you might have a cyber crime group

134
00:04:27,600 --> 00:04:29,280
stealing credit card data

135
00:04:29,280 --> 00:04:30,800
a business competitor stealing

136
00:04:30,800 --> 00:04:32,960
intellectual property a nation state

137
00:04:32,960 --> 00:04:35,520
accessing the email of dissidents

138
00:04:35,520 --> 00:04:38,400
activists defacing a popular page or

139
00:04:38,400 --> 00:04:40,560
even the evil grinch stealing christmas

140
00:04:40,560 --> 00:04:42,000
lists in any of these

141
00:04:42,000 --> 00:04:44,160
we have an actor that is trying to

142
00:04:44,160 --> 00:04:46,240
perform an objective that is relevant to

143
00:04:46,240 --> 00:04:48,400
your organization right any of those

144
00:04:48,400 --> 00:04:51,120
objectives are things that are going to

145
00:04:51,120 --> 00:04:52,320
reputationally

146
00:04:52,320 --> 00:04:54,960
financially physically harm your

147
00:04:54,960 --> 00:04:57,840
organization

148
00:04:57,919 --> 00:04:59,600
so we have this fictional organization

149
00:04:59,600 --> 00:05:01,120
we'll be doing some red teaming for

150
00:05:01,120 --> 00:05:04,400
called spacely sprockets and our

151
00:05:04,400 --> 00:05:06,400
simulated adversary will be cogswell's

152
00:05:06,400 --> 00:05:08,320
cogs they're well resourced but they're

153
00:05:08,320 --> 00:05:10,000
not at the level of an intelligence

154
00:05:10,000 --> 00:05:13,039
agency they have access to commercial

155
00:05:13,039 --> 00:05:14,639
tools they would have access

156
00:05:14,639 --> 00:05:17,520
to research and would have professionals

157
00:05:17,520 --> 00:05:18,720
working on this but

158
00:05:18,720 --> 00:05:22,160
would not have access to a variety of

159
00:05:22,160 --> 00:05:26,560
oda and browsers or in operating systems

160
00:05:26,560 --> 00:05:28,080
they're very interested in not being

161
00:05:28,080 --> 00:05:29,520
caught because our adversary would be

162
00:05:29,520 --> 00:05:31,280
committing a crime so

163
00:05:31,280 --> 00:05:34,000
we are wanting to keep a very low

164
00:05:34,000 --> 00:05:38,000
profile as we go through the exercise

165
00:05:38,000 --> 00:05:39,919
their objective is to steal intellectual

166
00:05:39,919 --> 00:05:41,680
property in this particular case

167
00:05:41,680 --> 00:05:43,199
they are interested in stealing the new

168
00:05:43,199 --> 00:05:45,360
series 2021 sprocket

169
00:05:45,360 --> 00:05:47,440
as well as a list of top customers so

170
00:05:47,440 --> 00:05:50,080
then maybe they could make something

171
00:05:50,080 --> 00:05:52,400
similar to the 2021 sprocket and sell it

172
00:05:52,400 --> 00:05:55,520
to our top customers

173
00:05:55,840 --> 00:05:57,759
before we actually start engaging though

174
00:05:57,759 --> 00:05:59,600
we need to write the rules of engagement

175
00:05:59,600 --> 00:06:00,960
which define

176
00:06:00,960 --> 00:06:03,280
what we can and can't do in other words

177
00:06:03,280 --> 00:06:05,280
it limits the team's action

178
00:06:05,280 --> 00:06:07,360
we need to identify a scope which is the

179
00:06:07,360 --> 00:06:09,120
hosts and networks that can be targeted

180
00:06:09,120 --> 00:06:10,639
we need to determine whether or not we

181
00:06:10,639 --> 00:06:11,840
have limits

182
00:06:11,840 --> 00:06:14,319
on social engineering whether physical

183
00:06:14,319 --> 00:06:16,000
attacks are allowed or not

184
00:06:16,000 --> 00:06:17,199
and we need to ensure that we're

185
00:06:17,199 --> 00:06:19,120
respecting our users whether that's

186
00:06:19,120 --> 00:06:21,280
customers or users internal to the

187
00:06:21,280 --> 00:06:22,479
organization

188
00:06:22,479 --> 00:06:24,080
they do have a right to privacy and we

189
00:06:24,080 --> 00:06:25,919
need to conduct our exercise in a way

190
00:06:25,919 --> 00:06:27,120
that protects their

191
00:06:27,120 --> 00:06:30,479
right to privacy so we do put together a

192
00:06:30,479 --> 00:06:32,400
list of these constraints and what we

193
00:06:32,400 --> 00:06:34,800
can and can't do and get both our

194
00:06:34,800 --> 00:06:35,759
leadership

195
00:06:35,759 --> 00:06:38,080
and our legal team to sign off rules of

196
00:06:38,080 --> 00:06:39,840
engagement can be either

197
00:06:39,840 --> 00:06:42,560
on a per exercise basis or you can have

198
00:06:42,560 --> 00:06:44,400
standing rules of engagement if you have

199
00:06:44,400 --> 00:06:45,840
an internal team that's going to be

200
00:06:45,840 --> 00:06:46,880
conducting

201
00:06:46,880 --> 00:06:49,680
red team exercises on a regular basis

202
00:06:49,680 --> 00:06:50,479
that cover

203
00:06:50,479 --> 00:06:54,479
all of your red team exercises

204
00:06:55,280 --> 00:06:57,039
so reconnaissance is about getting

205
00:06:57,039 --> 00:06:58,639
information about your target

206
00:06:58,639 --> 00:07:01,199
and reconnaissance can be either passive

207
00:07:01,199 --> 00:07:02,639
or active

208
00:07:02,639 --> 00:07:04,639
passive reconnaissance is when you don't

209
00:07:04,639 --> 00:07:05,840
send any traffic

210
00:07:05,840 --> 00:07:07,680
to your target immediately there's

211
00:07:07,680 --> 00:07:09,520
nothing that's going to alert them

212
00:07:09,520 --> 00:07:11,680
that an exercise is being conducted or

213
00:07:11,680 --> 00:07:13,599
that an attack is being conducted

214
00:07:13,599 --> 00:07:15,840
that focuses on them right and that can

215
00:07:15,840 --> 00:07:17,680
include things like reading job listings

216
00:07:17,680 --> 00:07:18,479
which

217
00:07:18,479 --> 00:07:20,400
maybe list specific technologies that

218
00:07:20,400 --> 00:07:22,080
they expect familiarity with

219
00:07:22,080 --> 00:07:24,720
that ex list specific skills that they

220
00:07:24,720 --> 00:07:25,599
expect

221
00:07:25,599 --> 00:07:27,520
uh new employees to have these can tell

222
00:07:27,520 --> 00:07:29,039
you a lot about their internal tech

223
00:07:29,039 --> 00:07:30,400
stack

224
00:07:30,400 --> 00:07:31,840
looking for news articles you'll find

225
00:07:31,840 --> 00:07:33,919
posts that say you know

226
00:07:33,919 --> 00:07:36,000
this technology has just been adopted by

227
00:07:36,000 --> 00:07:37,360
the by a company

228
00:07:37,360 --> 00:07:39,280
or something like that and that'll tell

229
00:07:39,280 --> 00:07:40,880
you about their internal tech stack and

230
00:07:40,880 --> 00:07:42,639
also looking for employees posting to

231
00:07:42,639 --> 00:07:44,080
support forms it's amazing

232
00:07:44,080 --> 00:07:47,520
what you can find by looking at

233
00:07:47,520 --> 00:07:50,560
support forums at public mailing lists

234
00:07:50,560 --> 00:07:52,000
things like that where employees may

235
00:07:52,000 --> 00:07:54,639
have disclosed information

236
00:07:54,639 --> 00:07:57,759
also sometimes employees personal github

237
00:07:57,759 --> 00:07:59,680
repositories sometimes people will check

238
00:07:59,680 --> 00:08:01,919
in configuration files or

239
00:08:01,919 --> 00:08:04,160
even more sensitive information like

240
00:08:04,160 --> 00:08:05,680
cookies or credentials

241
00:08:05,680 --> 00:08:08,160
into a personal github repository that's

242
00:08:08,160 --> 00:08:10,160
publicly exposed

243
00:08:10,160 --> 00:08:12,720
which can obviously help you conduct

244
00:08:12,720 --> 00:08:15,120
your red team exercise

245
00:08:15,120 --> 00:08:16,960
on the other hand we have active options

246
00:08:16,960 --> 00:08:18,639
which include things like

247
00:08:18,639 --> 00:08:20,800
performing port scans brute forcing

248
00:08:20,800 --> 00:08:22,319
credentials

249
00:08:22,319 --> 00:08:24,960
uh interacting with web servers to try

250
00:08:24,960 --> 00:08:27,520
to find vulnerabilities in them

251
00:08:27,520 --> 00:08:29,599
performing sql injection attacks all

252
00:08:29,599 --> 00:08:31,520
kinds of active

253
00:08:31,520 --> 00:08:33,440
reconnaissance steps to try to find out

254
00:08:33,440 --> 00:08:34,799
about the environment that you're

255
00:08:34,799 --> 00:08:35,919
operating in

256
00:08:35,919 --> 00:08:38,159
but all of these have an element of risk

257
00:08:38,159 --> 00:08:40,080
associated with getting caught so if

258
00:08:40,080 --> 00:08:41,519
you're trying to be quiet about your

259
00:08:41,519 --> 00:08:42,479
attacks

260
00:08:42,479 --> 00:08:46,640
these active options tend to be more

261
00:08:46,640 --> 00:08:49,040
noticeable to your target environment

262
00:08:49,040 --> 00:08:49,680
and so

263
00:08:49,680 --> 00:08:53,040
are things that you want to either limit

264
00:08:53,040 --> 00:08:55,040
the scope of or conduct it from separate

265
00:08:55,040 --> 00:08:56,480
infrastructure than you're going to use

266
00:08:56,480 --> 00:08:58,240
for your actual attacks or some other

267
00:08:58,240 --> 00:09:00,240
ways separate it from

268
00:09:00,240 --> 00:09:02,560
your active phase of your exercise so

269
00:09:02,560 --> 00:09:03,760
that the reconnaissance isn't

270
00:09:03,760 --> 00:09:08,080
attributable back to your threat actor

271
00:09:08,080 --> 00:09:09,920
in the case of spacely sprockets we can

272
00:09:09,920 --> 00:09:12,640
do something called dns enumeration

273
00:09:12,640 --> 00:09:14,480
to find out about their mail server

274
00:09:14,480 --> 00:09:16,480
their vpn and this is just a case where

275
00:09:16,480 --> 00:09:17,680
we take

276
00:09:17,680 --> 00:09:20,560
common subdomains and try to perform dns

277
00:09:20,560 --> 00:09:22,080
lookups and we find out which ones

278
00:09:22,080 --> 00:09:24,000
actually point to real hosts

279
00:09:24,000 --> 00:09:26,640
and so that allows us to have an idea of

280
00:09:26,640 --> 00:09:28,320
what their infrastructure looks

281
00:09:28,320 --> 00:09:30,480
like from the very get-go just by

282
00:09:30,480 --> 00:09:33,680
guessing some of their domain names

283
00:09:33,680 --> 00:09:35,760
additionally by looking at support

284
00:09:35,760 --> 00:09:37,600
mailing lists and other information we

285
00:09:37,600 --> 00:09:39,600
can find out that they're running

286
00:09:39,600 --> 00:09:41,880
their support portal on support force

287
00:09:41,880 --> 00:09:43,519
14.1

288
00:09:43,519 --> 00:09:45,200
and that they're getting a particular

289
00:09:45,200 --> 00:09:47,279
error when they're trying to

290
00:09:47,279 --> 00:09:49,200
run it now the error itself isn't that

291
00:09:49,200 --> 00:09:50,480
interesting to us but what is

292
00:09:50,480 --> 00:09:52,240
interesting is that in the error message

293
00:09:52,240 --> 00:09:53,839
they've quoted they tell us the host

294
00:09:53,839 --> 00:09:56,480
name where it's running

295
00:09:56,480 --> 00:09:58,480
and give us more information about where

296
00:09:58,480 --> 00:10:00,000
our target is right so if we know that

297
00:10:00,000 --> 00:10:01,680
there's some vulnerabilities in support

298
00:10:01,680 --> 00:10:04,000
force 14.1 for example

299
00:10:04,000 --> 00:10:06,399
then we could target this particular

300
00:10:06,399 --> 00:10:10,000
server with those vulnerabilities

301
00:10:10,640 --> 00:10:12,640
so the very next step we want to do is

302
00:10:12,640 --> 00:10:14,720
we want to gain some initial access

303
00:10:14,720 --> 00:10:16,640
to the target environment and there's a

304
00:10:16,640 --> 00:10:18,000
bunch of different ways

305
00:10:18,000 --> 00:10:19,760
you can go about that one of the most

306
00:10:19,760 --> 00:10:21,200
common ways

307
00:10:21,200 --> 00:10:23,760
for an attack to take place is through

308
00:10:23,760 --> 00:10:25,120
fishing

309
00:10:25,120 --> 00:10:26,959
it can be for fishing for username and

310
00:10:26,959 --> 00:10:28,240
password or fishing with

311
00:10:28,240 --> 00:10:30,720
maybe a malicious attachment but some

312
00:10:30,720 --> 00:10:32,800
form of phishing is very commonly used

313
00:10:32,800 --> 00:10:33,440
in breaching

314
00:10:33,440 --> 00:10:35,279
organizations and this is why for

315
00:10:35,279 --> 00:10:37,440
example two-factor can be

316
00:10:37,440 --> 00:10:39,680
a very important step in a security

317
00:10:39,680 --> 00:10:41,360
boundary because it makes phishing for

318
00:10:41,360 --> 00:10:42,720
the username and password

319
00:10:42,720 --> 00:10:47,279
a more difficult task for an attacker

320
00:10:47,279 --> 00:10:48,880
can also potentially compromise an

321
00:10:48,880 --> 00:10:50,560
internet-facing server like i mentioned

322
00:10:50,560 --> 00:10:52,399
if we knew of a vulnerability in their

323
00:10:52,399 --> 00:10:54,160
support portal perhaps we could use that

324
00:10:54,160 --> 00:10:56,000
as an initial foothold

325
00:10:56,000 --> 00:10:57,600
maybe we can email them a malicious

326
00:10:57,600 --> 00:10:59,120
attachment to a

327
00:10:59,120 --> 00:11:01,600
document that when macros are enabled

328
00:11:01,600 --> 00:11:03,680
does something on their workstation

329
00:11:03,680 --> 00:11:06,560
and gives us some level of access it

330
00:11:06,560 --> 00:11:08,320
could potentially drop a flash drive or

331
00:11:08,320 --> 00:11:09,920
something that looks like a flash drive

332
00:11:09,920 --> 00:11:11,920
in the parking lot and hope they

333
00:11:11,920 --> 00:11:14,720
pick it up and plug it in fans of the tv

334
00:11:14,720 --> 00:11:15,760
show mr robot

335
00:11:15,760 --> 00:11:17,279
might be familiar with this particular

336
00:11:17,279 --> 00:11:19,200
style of attack

337
00:11:19,200 --> 00:11:21,279
and on the right we in fact have a

338
00:11:21,279 --> 00:11:23,040
product from hack five

339
00:11:23,040 --> 00:11:24,880
called the usb rubber ducky which is a

340
00:11:24,880 --> 00:11:27,360
very very well known tool for conducting

341
00:11:27,360 --> 00:11:28,240
these kind

342
00:11:28,240 --> 00:11:32,320
of attacks it's a

343
00:11:32,320 --> 00:11:34,720
small microcontroller that looks like a

344
00:11:34,720 --> 00:11:36,560
flash drive in terms of physical form

345
00:11:36,560 --> 00:11:38,480
factor but in fact pretends to be a

346
00:11:38,480 --> 00:11:40,079
keyboard when you plug it in

347
00:11:40,079 --> 00:11:42,399
so it can type in arbitrary things which

348
00:11:42,399 --> 00:11:44,480
can do things like run a command

349
00:11:44,480 --> 00:11:46,800
or browse to a web page or any number of

350
00:11:46,800 --> 00:11:48,320
other things

351
00:11:48,320 --> 00:11:49,600
as if you were controlling their

352
00:11:49,600 --> 00:11:52,720
computer another possibility is to bribe

353
00:11:52,720 --> 00:11:54,079
an insider

354
00:11:54,079 --> 00:11:56,000
it's a little less commonly done in

355
00:11:56,000 --> 00:11:58,320
terms of red team exercises but is a

356
00:11:58,320 --> 00:11:59,680
real world scenario

357
00:11:59,680 --> 00:12:01,839
where an insider might be subject to

358
00:12:01,839 --> 00:12:04,320
some form of coercion whether financial

359
00:12:04,320 --> 00:12:07,680
or other coercion to get them to perform

360
00:12:07,680 --> 00:12:07,920
an

361
00:12:07,920 --> 00:12:10,079
action like executing something on their

362
00:12:10,079 --> 00:12:11,440
work computer to give you an

363
00:12:11,440 --> 00:12:14,320
initial foothold if you do decide to go

364
00:12:14,320 --> 00:12:15,200
that way out in

365
00:12:15,200 --> 00:12:17,760
an exercise do be sensitive of how you

366
00:12:17,760 --> 00:12:19,600
do it usually that's something we could

367
00:12:19,600 --> 00:12:22,720
would do as a simulated uh initial

368
00:12:22,720 --> 00:12:24,639
foothold where the insider

369
00:12:24,639 --> 00:12:26,639
would be someone who's volunteered to

370
00:12:26,639 --> 00:12:28,160
work with us we're not going to try to

371
00:12:28,160 --> 00:12:30,240
coerce our own employees

372
00:12:30,240 --> 00:12:32,320
because that does not it's not an

373
00:12:32,320 --> 00:12:34,079
effective way to build trust between the

374
00:12:34,079 --> 00:12:36,839
security team and the rest of the

375
00:12:36,839 --> 00:12:38,720
organization

376
00:12:38,720 --> 00:12:40,320
so how do we get initial access on

377
00:12:40,320 --> 00:12:42,399
spacely sprockets

378
00:12:42,399 --> 00:12:44,800
well one possible way is to send an

379
00:12:44,800 --> 00:12:45,760
email to

380
00:12:45,760 --> 00:12:49,040
support that links to a clone of the

381
00:12:49,040 --> 00:12:51,040
support site login page right we know

382
00:12:51,040 --> 00:12:52,000
where their support site

383
00:12:52,000 --> 00:12:54,480
is so we can just clone the login page

384
00:12:54,480 --> 00:12:56,160
and we can capture their username and

385
00:12:56,160 --> 00:12:57,839
password and this is of course a form of

386
00:12:57,839 --> 00:12:59,680
credential phishing

387
00:12:59,680 --> 00:13:01,920
and then maybe we can use that combined

388
00:13:01,920 --> 00:13:04,079
with the remote access or vpn server

389
00:13:04,079 --> 00:13:06,399
that we found earlier to log in

390
00:13:06,399 --> 00:13:08,800
and even get a remote desktop session on

391
00:13:08,800 --> 00:13:10,720
the support agents workstation so at

392
00:13:10,720 --> 00:13:12,000
this point we have

393
00:13:12,000 --> 00:13:15,360
a remote capability into a workstation

394
00:13:15,360 --> 00:13:18,839
within their environment using their

395
00:13:18,839 --> 00:13:20,320
credentials

396
00:13:20,320 --> 00:13:21,519
so now we need to move on to

397
00:13:21,519 --> 00:13:23,120
establishing a command and control

398
00:13:23,120 --> 00:13:24,639
mechanism right sometimes you'll hear

399
00:13:24,639 --> 00:13:26,320
this called c2

400
00:13:26,320 --> 00:13:28,240
and what that is is it allows the remote

401
00:13:28,240 --> 00:13:30,079
access to your target systems

402
00:13:30,079 --> 00:13:32,560
it's usually intended to obfuscate the

403
00:13:32,560 --> 00:13:35,120
traffic so it's not easily detected

404
00:13:35,120 --> 00:13:37,440
it can either be a custom tool or you

405
00:13:37,440 --> 00:13:39,440
can use existing or legitimate tools

406
00:13:39,440 --> 00:13:41,440
such as the remote desktop protocol or

407
00:13:41,440 --> 00:13:42,639
secure shell

408
00:13:42,639 --> 00:13:44,959
maybe just add an ssh each key of your

409
00:13:44,959 --> 00:13:46,639
own as a back door to

410
00:13:46,639 --> 00:13:49,680
allow you access uh

411
00:13:49,680 --> 00:13:51,680
into the system so there's a couple of

412
00:13:51,680 --> 00:13:53,120
different ways you can establish your

413
00:13:53,120 --> 00:13:54,720
command and control

414
00:13:54,720 --> 00:13:58,079
of the target environment um

415
00:13:58,079 --> 00:14:00,839
and the way we'll choose for spacely

416
00:14:00,839 --> 00:14:02,000
sprockets uh

417
00:14:02,000 --> 00:14:03,440
is we'll actually use a tool called

418
00:14:03,440 --> 00:14:05,600
metasploit if anyone has

419
00:14:05,600 --> 00:14:07,120
much familiarity with penetration

420
00:14:07,120 --> 00:14:09,839
testing or for example the

421
00:14:09,839 --> 00:14:12,480
oscp certification you've probably

422
00:14:12,480 --> 00:14:15,440
gotten very familiar with metasploit

423
00:14:15,440 --> 00:14:18,480
and we'll establish a connection

424
00:14:18,480 --> 00:14:20,399
from our environment back to the red

425
00:14:20,399 --> 00:14:22,079
team server so this appears as an

426
00:14:22,079 --> 00:14:24,240
outbound connection so it's less

427
00:14:24,240 --> 00:14:25,600
suspicious than attempting to get

428
00:14:25,600 --> 00:14:27,839
something in through the firewall

429
00:14:27,839 --> 00:14:30,000
most corporate firewalls are fairly

430
00:14:30,000 --> 00:14:31,600
permissive in what they allow going

431
00:14:31,600 --> 00:14:32,880
outbound

432
00:14:32,880 --> 00:14:34,240
and what metasploit gives us the

433
00:14:34,240 --> 00:14:36,480
capability to do is to do things like

434
00:14:36,480 --> 00:14:39,279
run commands on the remote system

435
00:14:39,279 --> 00:14:41,279
transfer files to and from the remote

436
00:14:41,279 --> 00:14:41,839
system

437
00:14:41,839 --> 00:14:44,880
dump credentials that are saved on

438
00:14:44,880 --> 00:14:47,440
our target system and also even route

439
00:14:47,440 --> 00:14:48,720
our network traffic through the

440
00:14:48,720 --> 00:14:49,920
metasploit implant

441
00:14:49,920 --> 00:14:52,320
so that other attacks we conduct seem to

442
00:14:52,320 --> 00:14:54,320
be coming from within their network

443
00:14:54,320 --> 00:14:56,240
instead of coming from the internet so

444
00:14:56,240 --> 00:14:57,440
this gives us a lot of different

445
00:14:57,440 --> 00:14:58,800
capabilities

446
00:14:58,800 --> 00:15:00,639
that puts us in a much stronger position

447
00:15:00,639 --> 00:15:02,480
than we were when we were outside of the

448
00:15:02,480 --> 00:15:04,880
network

449
00:15:05,600 --> 00:15:07,600
the next thing we need to do is we need

450
00:15:07,600 --> 00:15:09,279
to do movement within the network you

451
00:15:09,279 --> 00:15:10,240
may also hear this

452
00:15:10,240 --> 00:15:13,440
described as lateral movement basically

453
00:15:13,440 --> 00:15:14,720
the machine that you initially

454
00:15:14,720 --> 00:15:15,920
compromise

455
00:15:15,920 --> 00:15:17,279
may not have access to what you're

456
00:15:17,279 --> 00:15:18,959
ultimately going for so in this case

457
00:15:18,959 --> 00:15:21,199
remember we want blueprints for

458
00:15:21,199 --> 00:15:24,320
uh the new series 2021 sprocket

459
00:15:24,320 --> 00:15:26,480
and a support engineer probably doesn't

460
00:15:26,480 --> 00:15:27,839
have access

461
00:15:27,839 --> 00:15:30,639
to that so there's a couple of different

462
00:15:30,639 --> 00:15:32,000
ways you can do it you can do it by

463
00:15:32,000 --> 00:15:33,759
compromising internal hosts using

464
00:15:33,759 --> 00:15:36,000
vulnerabilities present on those hosts

465
00:15:36,000 --> 00:15:37,920
we can try to reuse the credentials that

466
00:15:37,920 --> 00:15:39,759
we have either from our support engineer

467
00:15:39,759 --> 00:15:42,399
or from credentials saved on their host

468
00:15:42,399 --> 00:15:44,480
or we can try various mechanisms of

469
00:15:44,480 --> 00:15:47,519
transitive trust which is when one host

470
00:15:47,519 --> 00:15:50,000
implicitly trusts traffic coming from

471
00:15:50,000 --> 00:15:51,360
another host

472
00:15:51,360 --> 00:15:53,360
so this can include things like moving

473
00:15:53,360 --> 00:15:55,519
within a windows domain for example you

474
00:15:55,519 --> 00:15:57,519
might have login privileges on another

475
00:15:57,519 --> 00:15:58,320
host

476
00:15:58,320 --> 00:16:00,399
that you can use to remotely gain access

477
00:16:00,399 --> 00:16:03,680
to that other host

478
00:16:03,759 --> 00:16:05,440
in the particular case of spacely

479
00:16:05,440 --> 00:16:07,199
sprockets what we're going to do

480
00:16:07,199 --> 00:16:09,079
is use access to a support

481
00:16:09,079 --> 00:16:10,880
representation the support reps

482
00:16:10,880 --> 00:16:12,639
workstation

483
00:16:12,639 --> 00:16:14,000
which doesn't have the access to the

484
00:16:14,000 --> 00:16:15,680
data we want but we will upload

485
00:16:15,680 --> 00:16:18,399
metasploit again to the file server

486
00:16:18,399 --> 00:16:20,880
and ask the internal it staff to help

487
00:16:20,880 --> 00:16:21,440
with an

488
00:16:21,440 --> 00:16:24,160
issue what this will do is potentially

489
00:16:24,160 --> 00:16:24,880
get them to

490
00:16:24,880 --> 00:16:27,680
execute that tool for us and we can gain

491
00:16:27,680 --> 00:16:28,720
a session running

492
00:16:28,720 --> 00:16:31,759
as their internal help desk and once we

493
00:16:31,759 --> 00:16:32,800
have that

494
00:16:32,800 --> 00:16:34,880
we can use the help desk privileges to

495
00:16:34,880 --> 00:16:36,800
create a new account and grant ourselves

496
00:16:36,800 --> 00:16:37,680
access

497
00:16:37,680 --> 00:16:40,639
to all the servers within their domain

498
00:16:40,639 --> 00:16:41,120
so

499
00:16:41,120 --> 00:16:43,360
by compromising the support rep we've

500
00:16:43,360 --> 00:16:44,240
then used them

501
00:16:44,240 --> 00:16:46,959
to compromise it staff which we're then

502
00:16:46,959 --> 00:16:48,480
using to give ourselves

503
00:16:48,480 --> 00:16:50,320
more privileges and allow ourselves to

504
00:16:50,320 --> 00:16:54,480
move across their entire organization

505
00:16:55,279 --> 00:16:57,440
finally we're moving on to action on

506
00:16:57,440 --> 00:16:59,279
objectives and that's when we actually

507
00:16:59,279 --> 00:17:00,240
want to do

508
00:17:00,240 --> 00:17:03,519
our final um you know final

509
00:17:03,519 --> 00:17:05,439
task that we're trying to do in order to

510
00:17:05,439 --> 00:17:08,079
consider our exercises success

511
00:17:08,079 --> 00:17:10,160
very often that's about accessing or

512
00:17:10,160 --> 00:17:11,919
modifying data or systems so

513
00:17:11,919 --> 00:17:14,079
exfiltrating sensitive data

514
00:17:14,079 --> 00:17:16,799
modifying records knocking systems

515
00:17:16,799 --> 00:17:17,439
offline

516
00:17:17,439 --> 00:17:19,520
adding long-term access any number of

517
00:17:19,520 --> 00:17:22,640
these can be your final objective

518
00:17:22,640 --> 00:17:25,359
most of the time that i have been

519
00:17:25,359 --> 00:17:27,280
engaged in red teaming it's exfiltrating

520
00:17:27,280 --> 00:17:29,600
some sort of sensitive data whether it's

521
00:17:29,600 --> 00:17:31,600
data about users data about corporate

522
00:17:31,600 --> 00:17:33,600
records whatever it may be but there's

523
00:17:33,600 --> 00:17:34,799
this data that's held

524
00:17:34,799 --> 00:17:38,400
and is of interest to the adversary

525
00:17:38,400 --> 00:17:41,200
and in the case of spacely sprockets we

526
00:17:41,200 --> 00:17:41,600
again

527
00:17:41,600 --> 00:17:45,039
want the blueprints for the new series

528
00:17:45,039 --> 00:17:47,280
2021 sprocket

529
00:17:47,280 --> 00:17:49,280
so what we want to do is access the file

530
00:17:49,280 --> 00:17:51,120
server that we've granted ourselves

531
00:17:51,120 --> 00:17:52,559
access to

532
00:17:52,559 --> 00:17:55,600
and archive product designs archive

533
00:17:55,600 --> 00:17:57,440
customer lists right we

534
00:17:57,440 --> 00:17:59,760
you can extract those as like a zip file

535
00:17:59,760 --> 00:18:02,480
or some other form of archive

536
00:18:02,480 --> 00:18:04,320
and then first we'll copy the data back

537
00:18:04,320 --> 00:18:07,200
to the support

538
00:18:07,200 --> 00:18:08,559
individuals computer the support

539
00:18:08,559 --> 00:18:10,320
engineer computer because what we don't

540
00:18:10,320 --> 00:18:11,840
want is we don't want a whole bunch of

541
00:18:11,840 --> 00:18:13,440
traffic from the file server going

542
00:18:13,440 --> 00:18:15,200
directly to the internet that might look

543
00:18:15,200 --> 00:18:16,320
suspicious

544
00:18:16,320 --> 00:18:18,240
whereas traffic from a workstation to

545
00:18:18,240 --> 00:18:19,919
the internet is a lot less likely to

546
00:18:19,919 --> 00:18:21,679
look suspicious so we'll copy it back

547
00:18:21,679 --> 00:18:22,720
first

548
00:18:22,720 --> 00:18:25,840
to an intermediate host and then

549
00:18:25,840 --> 00:18:28,320
we will slowly upload the data to the

550
00:18:28,320 --> 00:18:29,280
server on

551
00:18:29,280 --> 00:18:30,720
the internet and we'll do that in an

552
00:18:30,720 --> 00:18:32,880
encrypted fashion and there's several

553
00:18:32,880 --> 00:18:34,559
different reasons for doing it encrypted

554
00:18:34,559 --> 00:18:36,480
first of all it prevents any data loss

555
00:18:36,480 --> 00:18:38,400
protection systems from triggering on

556
00:18:38,400 --> 00:18:40,559
the data any dlp systems

557
00:18:40,559 --> 00:18:42,880
secondly it does because this is an

558
00:18:42,880 --> 00:18:44,799
exercise one of the things we need to do

559
00:18:44,799 --> 00:18:46,559
is protect the data that we are touching

560
00:18:46,559 --> 00:18:48,240
so uploading it encrypted

561
00:18:48,240 --> 00:18:49,840
protects the data because we do have an

562
00:18:49,840 --> 00:18:51,679
interest in keeping it

563
00:18:51,679 --> 00:18:54,720
secret and finally uh

564
00:18:54,720 --> 00:18:57,200
it does better match the ttps the

565
00:18:57,200 --> 00:18:59,520
tactics techniques and procedures

566
00:18:59,520 --> 00:19:02,080
of known adversaries so uploading in an

567
00:19:02,080 --> 00:19:03,520
encrypted format

568
00:19:03,520 --> 00:19:05,600
has several benefits to us in a red team

569
00:19:05,600 --> 00:19:07,360
exercise

570
00:19:07,360 --> 00:19:10,559
we also will conduct the upload slowly

571
00:19:10,559 --> 00:19:13,840
because we want to

572
00:19:13,840 --> 00:19:15,840
reduce the likelihood that any sort of

573
00:19:15,840 --> 00:19:17,679
network level detections

574
00:19:17,679 --> 00:19:19,840
take note of a sudden spike in outbound

575
00:19:19,840 --> 00:19:21,520
traffic from this host

576
00:19:21,520 --> 00:19:23,520
so trickling it slowly though it may

577
00:19:23,520 --> 00:19:25,840
feel

578
00:19:26,160 --> 00:19:28,240
may feel difficult waiting for that time

579
00:19:28,240 --> 00:19:29,440
for it to finish

580
00:19:29,440 --> 00:19:32,559
is actually something that would

581
00:19:32,559 --> 00:19:33,840
make it more likely that you're

582
00:19:33,840 --> 00:19:37,439
successful in your exercise

583
00:19:37,679 --> 00:19:40,640
so once you've completed an exercise all

584
00:19:40,640 --> 00:19:42,000
you've done at that point is

585
00:19:42,000 --> 00:19:43,840
found some issues you haven't actually

586
00:19:43,840 --> 00:19:45,600
improved the security posture of your

587
00:19:45,600 --> 00:19:47,520
organization and at the end of the day

588
00:19:47,520 --> 00:19:50,080
as a security professional it's my job

589
00:19:50,080 --> 00:19:52,160
to improve the security posture of the

590
00:19:52,160 --> 00:19:54,080
organization that i'm working in

591
00:19:54,080 --> 00:19:55,919
and so that's where impact comes in

592
00:19:55,919 --> 00:19:57,360
right we need to do something with our

593
00:19:57,360 --> 00:19:58,080
findings

594
00:19:58,080 --> 00:20:00,240
where we actually get the security

595
00:20:00,240 --> 00:20:01,120
posture

596
00:20:01,120 --> 00:20:02,799
to a higher level where we're able to

597
00:20:02,799 --> 00:20:04,880
make our organization more secure and

598
00:20:04,880 --> 00:20:06,080
better able to withstand

599
00:20:06,080 --> 00:20:09,840
attacks like the one we've simulated

600
00:20:09,840 --> 00:20:14,960
and so one of the first steps in our

601
00:20:14,960 --> 00:20:18,000
process here is actually reporting

602
00:20:18,000 --> 00:20:21,440
on the uh exercise that we've just

603
00:20:21,440 --> 00:20:22,880
conducted

604
00:20:22,880 --> 00:20:25,280
and quite frankly communication skills

605
00:20:25,280 --> 00:20:27,360
are one of the most underrated security

606
00:20:27,360 --> 00:20:28,880
skills at the end of the day your

607
00:20:28,880 --> 00:20:30,880
reports are going to be read by a wide

608
00:20:30,880 --> 00:20:32,799
audience that will include other

609
00:20:32,799 --> 00:20:34,159
security professionals

610
00:20:34,159 --> 00:20:37,280
i.t staff software developers

611
00:20:37,280 --> 00:20:39,440
physical security potentially your

612
00:20:39,440 --> 00:20:41,200
leadership that is vps

613
00:20:41,200 --> 00:20:44,080
and csos and everything like that and

614
00:20:44,080 --> 00:20:45,840
even lawyers are going to be interested

615
00:20:45,840 --> 00:20:47,280
in this sort of thing because they need

616
00:20:47,280 --> 00:20:48,159
to know

617
00:20:48,159 --> 00:20:49,840
what kind of liabilities might have

618
00:20:49,840 --> 00:20:51,919
existed if there was a data breach it

619
00:20:51,919 --> 00:20:53,120
can help them to

620
00:20:53,120 --> 00:20:55,440
inform future exercises and the rules of

621
00:20:55,440 --> 00:20:56,799
engagement there

622
00:20:56,799 --> 00:21:00,080
so there's a wide spectrum of

623
00:21:00,080 --> 00:21:02,000
roles that will be involved in reading

624
00:21:02,000 --> 00:21:03,360
your report so you need to write

625
00:21:03,360 --> 00:21:04,240
something

626
00:21:04,240 --> 00:21:07,440
that is clear that is digestible

627
00:21:07,440 --> 00:21:10,000
that doesn't assume underlying security

628
00:21:10,000 --> 00:21:11,760
knowledge

629
00:21:11,760 --> 00:21:14,320
so basically figuring out how to

630
00:21:14,320 --> 00:21:16,080
communicate with all of these other

631
00:21:16,080 --> 00:21:19,440
different groups in a written report

632
00:21:19,440 --> 00:21:22,240
is actually a critical skill for red

633
00:21:22,240 --> 00:21:23,200
team

634
00:21:23,200 --> 00:21:25,760
operators

635
00:21:26,559 --> 00:21:29,919
you also need to produce actionable

636
00:21:29,919 --> 00:21:31,919
results you can't just say oh it's all

637
00:21:31,919 --> 00:21:32,480
broken

638
00:21:32,480 --> 00:21:34,960
and leave it there you need to be able

639
00:21:34,960 --> 00:21:36,080
to suggest

640
00:21:36,080 --> 00:21:38,720
fixes that make the situation better if

641
00:21:38,720 --> 00:21:40,080
you just say that the

642
00:21:40,080 --> 00:21:42,960
situation is broken and full of flaws

643
00:21:42,960 --> 00:21:44,799
then that's not going to get

644
00:21:44,799 --> 00:21:47,440
into a great position you don't

645
00:21:47,440 --> 00:21:49,120
necessarily have to describe the

646
00:21:49,120 --> 00:21:51,120
implementation of all of the fixes but

647
00:21:51,120 --> 00:21:53,200
you should describe what the ideal state

648
00:21:53,200 --> 00:21:54,640
is so

649
00:21:54,640 --> 00:21:56,400
i've got some examples in the spacely

650
00:21:56,400 --> 00:21:58,880
sprockets case

651
00:21:58,880 --> 00:22:00,720
in a moment because i know this is a

652
00:22:00,720 --> 00:22:03,280
little bit of a nebulous point here

653
00:22:03,280 --> 00:22:04,880
you can also advise on hardening

654
00:22:04,880 --> 00:22:06,799
measures right like some things

655
00:22:06,799 --> 00:22:08,640
may not be possible to completely

656
00:22:08,640 --> 00:22:10,400
prevent but you can make it

657
00:22:10,400 --> 00:22:12,640
more difficult for an adversary to do it

658
00:22:12,640 --> 00:22:14,400
anything that increases the cost to the

659
00:22:14,400 --> 00:22:16,159
adversary makes that a less

660
00:22:16,159 --> 00:22:19,520
likely attack path

661
00:22:19,520 --> 00:22:21,520
you can also start to suggest things

662
00:22:21,520 --> 00:22:23,200
that improve detection

663
00:22:23,200 --> 00:22:24,840
while prevention is better than

664
00:22:24,840 --> 00:22:27,200
detection our detection and response

665
00:22:27,200 --> 00:22:28,480
teams are a critical part of our

666
00:22:28,480 --> 00:22:29,760
security posture

667
00:22:29,760 --> 00:22:31,440
and so coming up with new things that

668
00:22:31,440 --> 00:22:33,200
they can detect such as

669
00:22:33,200 --> 00:22:35,840
exfiltration of large quantities of data

670
00:22:35,840 --> 00:22:37,440
would be something that you can make

671
00:22:37,440 --> 00:22:39,679
recommendations to

672
00:22:39,679 --> 00:22:41,679
so what recommendations might we have

673
00:22:41,679 --> 00:22:43,120
from spacely sprockets

674
00:22:43,120 --> 00:22:45,600
well for one i would strongly suggest

675
00:22:45,600 --> 00:22:47,360
that they use two-factor authentication

676
00:22:47,360 --> 00:22:48,640
particularly if they use physical

677
00:22:48,640 --> 00:22:49,760
security tokens

678
00:22:49,760 --> 00:22:53,280
like uh ubiko's security keys or

679
00:22:53,280 --> 00:22:56,799
any other universal two-factor

680
00:22:56,799 --> 00:22:59,840
format security token

681
00:22:59,840 --> 00:23:02,080
would make it a lot harder to fish them

682
00:23:02,080 --> 00:23:03,280
you wouldn't be able to just get a

683
00:23:03,280 --> 00:23:05,039
username and password and get directly

684
00:23:05,039 --> 00:23:06,559
into their system you'd need to come up

685
00:23:06,559 --> 00:23:08,000
with another approach

686
00:23:08,000 --> 00:23:09,760
to gain that initial access so that

687
00:23:09,760 --> 00:23:11,039
would have made the perimeter much

688
00:23:11,039 --> 00:23:13,919
harder to breach

689
00:23:13,919 --> 00:23:15,679
also scanning the file server for

690
00:23:15,679 --> 00:23:17,760
malware in the case of spacely sprockets

691
00:23:17,760 --> 00:23:19,520
right metasploit is something that will

692
00:23:19,520 --> 00:23:21,280
commonly be flagged as malware even

693
00:23:21,280 --> 00:23:23,520
though it also has legitimate uses

694
00:23:23,520 --> 00:23:26,320
such as in a red team so scanning the

695
00:23:26,320 --> 00:23:28,720
file server and finding those

696
00:23:28,720 --> 00:23:30,799
instances would be useful whenever

697
00:23:30,799 --> 00:23:33,600
someone uploads a new file

698
00:23:33,600 --> 00:23:35,440
detecting large file copies to

699
00:23:35,440 --> 00:23:37,200
workstations right we exfiltrated all

700
00:23:37,200 --> 00:23:38,720
the data through the workstation

701
00:23:38,720 --> 00:23:41,360
if it's not normal for a support reps

702
00:23:41,360 --> 00:23:42,559
workstation to be

703
00:23:42,559 --> 00:23:44,480
pulling gigabytes and gigabytes of data

704
00:23:44,480 --> 00:23:46,559
from the file server all at once

705
00:23:46,559 --> 00:23:48,400
then that's something that's an anomaly

706
00:23:48,400 --> 00:23:50,159
that is worth looking at it's not always

707
00:23:50,159 --> 00:23:52,000
going to be malicious but that's why you

708
00:23:52,000 --> 00:23:53,279
have

709
00:23:53,279 --> 00:23:55,360
incident responders that's why you have

710
00:23:55,360 --> 00:23:57,760
a security operations center to take a

711
00:23:57,760 --> 00:23:59,440
look at these things and determine is it

712
00:23:59,440 --> 00:24:00,240
malicious or

713
00:24:00,240 --> 00:24:03,360
is it in fact a benign event

714
00:24:03,360 --> 00:24:05,200
and finally the fact that compromising

715
00:24:05,200 --> 00:24:07,039
one support tech was adequate to create

716
00:24:07,039 --> 00:24:08,799
a new account

717
00:24:08,799 --> 00:24:10,880
suggesting that it takes two people to

718
00:24:10,880 --> 00:24:12,480
actually create new accounts

719
00:24:12,480 --> 00:24:14,080
means that you've raised the bar

720
00:24:14,080 --> 00:24:16,080
significantly for an attacker yes an

721
00:24:16,080 --> 00:24:18,080
attacker could still just compromise

722
00:24:18,080 --> 00:24:20,240
two support texts but it gives you

723
00:24:20,240 --> 00:24:21,919
longer time to detect the attack it

724
00:24:21,919 --> 00:24:23,279
gives you a higher likelihood of

725
00:24:23,279 --> 00:24:25,520
detection when you have to compromise

726
00:24:25,520 --> 00:24:28,400
the two individuals instead of just one

727
00:24:28,400 --> 00:24:29,200
so

728
00:24:29,200 --> 00:24:30,720
requiring two texts to create new

729
00:24:30,720 --> 00:24:32,400
accounts has a small cost to the

730
00:24:32,400 --> 00:24:33,919
business in terms of time for new

731
00:24:33,919 --> 00:24:35,120
account creation

732
00:24:35,120 --> 00:24:36,799
but it also has big benefits in

733
00:24:36,799 --> 00:24:38,240
preventing the creation

734
00:24:38,240 --> 00:24:40,320
of rogue accounts within the

735
00:24:40,320 --> 00:24:43,039
organization

736
00:24:44,799 --> 00:24:46,640
so that's all we've really got time for

737
00:24:46,640 --> 00:24:47,919
uh i do want to

738
00:24:47,919 --> 00:24:51,360
suggest um some resources here uh

739
00:24:51,360 --> 00:24:54,799
this is my twitter my blog um i've got

740
00:24:54,799 --> 00:24:57,200
uh the slides that i've used for this

741
00:24:57,200 --> 00:24:58,960
actually from a previous incarnation of

742
00:24:58,960 --> 00:24:59,600
this talk

743
00:24:59,600 --> 00:25:02,960
and notes up here and

744
00:25:02,960 --> 00:25:04,640
a reading list for those who are

745
00:25:04,640 --> 00:25:06,960
interested in

746
00:25:06,960 --> 00:25:09,360
getting into the red teaming space as

747
00:25:09,360 --> 00:25:10,799
well as

748
00:25:10,799 --> 00:25:12,720
a great book that is about the practice

749
00:25:12,720 --> 00:25:14,000
of red teaming not super

750
00:25:14,000 --> 00:25:16,640
technical but is about why red teaming

751
00:25:16,640 --> 00:25:18,960
exists the history and how it is used

752
00:25:18,960 --> 00:25:19,440
today

753
00:25:19,440 --> 00:25:22,880
by organizations uh and i think it's a

754
00:25:22,880 --> 00:25:23,600
wonderful

755
00:25:23,600 --> 00:25:28,559
resource as well i want to thank sans uh

756
00:25:28,559 --> 00:25:30,720
and the holiday hack challenge for

757
00:25:30,720 --> 00:25:31,919
letting me

758
00:25:31,919 --> 00:25:33,919
speak for a little bit and bring this

759
00:25:33,919 --> 00:25:35,440
presentation to you

760
00:25:35,440 --> 00:25:37,200
encourage everyone to play holiday hack

761
00:25:37,200 --> 00:25:39,120
challenge if you don't know it is hosted

762
00:25:39,120 --> 00:25:39,919
on

763
00:25:39,919 --> 00:25:42,159
google cloud platform so i could highly

764
00:25:42,159 --> 00:25:43,919
recommend checking it out and giving it

765
00:25:43,919 --> 00:25:46,000
a try the challenges are always

766
00:25:46,000 --> 00:25:50,240
fantastic and a lot of fun and finally

767
00:25:50,240 --> 00:25:53,440
thanks to all of you who have attended

768
00:25:53,440 --> 00:25:54,159
this talk

769
00:25:54,159 --> 00:25:55,840
and i hope that you found something

770
00:25:55,840 --> 00:25:57,440
about it useful

771
00:25:57,440 --> 00:26:00,960
informative entertaining um and

772
00:26:00,960 --> 00:26:02,960
please you know reach out to me via

773
00:26:02,960 --> 00:26:04,480
twitter or other means

774
00:26:04,480 --> 00:26:06,159
to provide any feedback that you might

775
00:26:06,159 --> 00:26:07,919
have and

776
00:26:07,919 --> 00:26:11,290
thank you very much

777
00:26:11,290 --> 00:26:14,430
[Music]

