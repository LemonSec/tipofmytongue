1
00:00:02,460 --> 00:00:05,510
thank you

2
00:00:20,030 --> 00:00:34,700
there's a few more seats up up here for

3
00:00:23,100 --> 00:00:38,489
the people standing if you'd like okay

4
00:00:34,700 --> 00:00:39,960
our next speaker is Brett chance by day

5
00:00:38,489 --> 00:00:41,309
Brett chance is a member of the red team

6
00:00:39,960 --> 00:00:43,080
where he continues to hone his skills

7
00:00:41,309 --> 00:00:44,790
that often result in the system in tears

8
00:00:43,080 --> 00:00:46,530
when the Sun Goes Down you can find him

9
00:00:44,790 --> 00:00:48,420
performing security research the centers

10
00:00:46,530 --> 00:00:48,870
around web apps mobile apps and security

11
00:00:48,420 --> 00:00:51,120
devices

12
00:00:48,870 --> 00:00:53,250
he's also an active member of DC 5 6 to

13
00:00:51,120 --> 00:00:55,480
please join me in welcoming Brett chance

14
00:00:53,250 --> 00:01:03,800
to shell con 2017

15
00:00:55,480 --> 00:01:03,800
[Applause]

16
00:01:11,380 --> 00:01:16,539
well done now Oh perfect

17
00:01:14,630 --> 00:01:18,798
alright so my talk today is titled

18
00:01:16,539 --> 00:01:22,009
identifying bugs and mobile applications

19
00:01:18,799 --> 00:01:24,350
from leaky api's to account takeover and

20
00:01:22,009 --> 00:01:26,570
the structure of this talk I'll give a

21
00:01:24,350 --> 00:01:28,579
little you know three or four slides on

22
00:01:26,570 --> 00:01:30,380
how you can monitor traffic on

23
00:01:28,579 --> 00:01:31,939
applications for yourself and then I'm

24
00:01:30,380 --> 00:01:34,818
going to cover some bugs that I found

25
00:01:31,939 --> 00:01:38,148
methods that I've used to uncover these

26
00:01:34,819 --> 00:01:40,039
issues but first Who am I once again I'm

27
00:01:38,149 --> 00:01:43,459
Brett chance you can find me on twitter

28
00:01:40,039 --> 00:01:46,340
at we're in mind dirt my job I do I do

29
00:01:43,459 --> 00:01:48,439
red team and TVs and basically internal

30
00:01:46,340 --> 00:01:50,750
pin tests external pin tests the web

31
00:01:48,439 --> 00:01:53,348
application stuff so I do a lot of

32
00:01:50,750 --> 00:01:55,520
different things there as far as copies

33
00:01:53,349 --> 00:01:56,659
mainly security research I'm pretty much

34
00:01:55,520 --> 00:01:59,479
on the computer all the time probably

35
00:01:56,659 --> 00:02:01,549
like a lot of you and my research

36
00:01:59,479 --> 00:02:05,030
focuses on mobile applications websites

37
00:02:01,549 --> 00:02:08,149
and security devices so a lot of cameras

38
00:02:05,030 --> 00:02:10,068
DVRs NPR's if I could pop a shell on

39
00:02:08,149 --> 00:02:12,140
something that's internet connected I'm

40
00:02:10,068 --> 00:02:14,420
happy with that

41
00:02:12,140 --> 00:02:17,480
once the the group I'm a part of is TC

42
00:02:14,420 --> 00:02:19,250
562 we're hosting the CTF this year feel

43
00:02:17,480 --> 00:02:20,869
free to go check that out we're a group

44
00:02:19,250 --> 00:02:22,880
that's based out of Long Beach we have

45
00:02:20,870 --> 00:02:25,579
members across all la so if you're

46
00:02:22,880 --> 00:02:30,519
looking to get more you know into a

47
00:02:25,579 --> 00:02:33,139
group like that feel free to drop by so

48
00:02:30,519 --> 00:02:34,910
the images on this talk I tried my best

49
00:02:33,139 --> 00:02:37,670
to make them not worry but if they are

50
00:02:34,910 --> 00:02:40,160
blurry you can pull the PDF right now at

51
00:02:37,670 --> 00:02:42,410
my site Brad chance comm slash bug stop

52
00:02:40,160 --> 00:02:46,069
PDF and if there's any issues you give

53
00:02:42,410 --> 00:02:48,350
you everything they're clear so quick

54
00:02:46,069 --> 00:02:50,540
primer I'm not a mobile app developer

55
00:02:48,350 --> 00:02:53,120
not really developer at all I mean I

56
00:02:50,540 --> 00:02:56,239
know but PowerShell and c-sharp but I

57
00:02:53,120 --> 00:02:58,370
don't know what makes these apps tick I

58
00:02:56,239 --> 00:03:00,950
just know how to break them so that's

59
00:02:58,370 --> 00:03:04,639
kind of what the talk is about to give

60
00:03:00,950 --> 00:03:05,959
you a really quick primer on API for

61
00:03:04,639 --> 00:03:07,370
like a web server if you go to a web

62
00:03:05,959 --> 00:03:09,739
server and say it's a wordpress

63
00:03:07,370 --> 00:03:11,630
installation that web application is

64
00:03:09,739 --> 00:03:13,370
running and on the back end of that

65
00:03:11,630 --> 00:03:15,799
server there's a database that's

66
00:03:13,370 --> 00:03:17,120
generally hosted there for mobile

67
00:03:15,799 --> 00:03:19,160
applications it's a little different

68
00:03:17,120 --> 00:03:22,160
there's a server on the backend and then

69
00:03:19,160 --> 00:03:24,290
the device that you use the client will

70
00:03:22,160 --> 00:03:26,329
use now the API is what strings

71
00:03:24,290 --> 00:03:28,760
those two together so that the device

72
00:03:26,329 --> 00:03:30,739
can call the API call something to the

73
00:03:28,760 --> 00:03:32,899
server the server generates a response

74
00:03:30,739 --> 00:03:35,810
the API channels that all the way back

75
00:03:32,900 --> 00:03:37,519
down to the end device and a lot of what

76
00:03:35,810 --> 00:03:40,730
we're gonna be looking at is how to

77
00:03:37,519 --> 00:03:43,189
manipulate API is what information API

78
00:03:40,730 --> 00:03:45,548
delivers to a client that the user does

79
00:03:43,189 --> 00:03:47,569
not see directly on the application and

80
00:03:45,549 --> 00:03:50,060
one of the reasons I wanted to give this

81
00:03:47,569 --> 00:03:52,719
talk is I feel like many people are very

82
00:03:50,060 --> 00:03:55,370
familiar with web application security

83
00:03:52,719 --> 00:03:55,790
yeah I probably many people in this room

84
00:03:55,370 --> 00:03:58,609
can

85
00:03:55,790 --> 00:04:02,000
sideout can speak to at least four of

86
00:03:58,609 --> 00:04:04,819
the top OWASA top ten and I feel like

87
00:04:02,000 --> 00:04:10,099
mobile applications they don't get that

88
00:04:04,819 --> 00:04:12,888
much airtime so so the setup you you can

89
00:04:10,099 --> 00:04:15,409
use basically any proxy solution but to

90
00:04:12,889 --> 00:04:17,959
that I've used our burp suite by port

91
00:04:15,409 --> 00:04:20,389
swagger and fiddler by telluric and

92
00:04:17,959 --> 00:04:23,180
these applications are designed to well

93
00:04:20,389 --> 00:04:25,009
burp suite is a that has a ton of

94
00:04:23,180 --> 00:04:27,139
offensive capabilities you can scan web

95
00:04:25,009 --> 00:04:29,150
sites and and you know find

96
00:04:27,139 --> 00:04:31,039
vulnerabilities and don't do it a lot of

97
00:04:29,150 --> 00:04:33,020
interesting features but relevant to

98
00:04:31,039 --> 00:04:35,389
this talk you're really setting up a

99
00:04:33,020 --> 00:04:37,729
proxy that you're basically going to man

100
00:04:35,389 --> 00:04:39,979
the middle your phone or an emulated

101
00:04:37,729 --> 00:04:42,260
device and then you're gonna be watching

102
00:04:39,979 --> 00:04:43,490
that traffic that's coming in and you

103
00:04:42,260 --> 00:04:47,719
can do this both of these applications

104
00:04:43,490 --> 00:04:49,669
fiddler and burp suite support Linux

105
00:04:47,720 --> 00:04:53,330
Windows and Mac so you can really pick

106
00:04:49,669 --> 00:04:54,919
whichever one you'd like another thing

107
00:04:53,330 --> 00:04:57,320
you're gonna need is you need a Wi-Fi

108
00:04:54,919 --> 00:04:59,240
connection your phone if you're still in

109
00:04:57,320 --> 00:05:01,159
3G the device your laptop your

110
00:04:59,240 --> 00:05:02,930
computer's not gonna be on 3G so there's

111
00:05:01,159 --> 00:05:05,210
no you can intercept that so you need a

112
00:05:02,930 --> 00:05:06,530
Wi-Fi connection for your phone and your

113
00:05:05,210 --> 00:05:08,960
computer to be on that same connection

114
00:05:06,530 --> 00:05:11,030
and you're gonna need a smart phone

115
00:05:08,960 --> 00:05:13,250
generally an Android or an iOS device I

116
00:05:11,030 --> 00:05:15,679
feel is best although lately my testing

117
00:05:13,250 --> 00:05:18,949
I've been doing earlier versions of

118
00:05:15,680 --> 00:05:20,810
Android so like Samsung Galaxy 3 isn't

119
00:05:18,949 --> 00:05:22,430
one of use for a lot of testing iOS

120
00:05:20,810 --> 00:05:26,210
recently I believe they did a big patch

121
00:05:22,430 --> 00:05:28,009
where a lot of the ETL SSL traffic

122
00:05:26,210 --> 00:05:31,008
coming in it's really hard to man the

123
00:05:28,009 --> 00:05:32,419
middle so I find that if I D grade down

124
00:05:31,009 --> 00:05:35,180
to an older version of Android that

125
00:05:32,419 --> 00:05:36,560
could pickle a lot of that and with

126
00:05:35,180 --> 00:05:36,860
everything new you're gonna need a

127
00:05:36,560 --> 00:05:38,990
little bit

128
00:05:36,860 --> 00:05:40,580
patience you suck everything right away

129
00:05:38,990 --> 00:05:45,349
we all know this and you just gotta keep

130
00:05:40,580 --> 00:05:46,789
trying and you'll get better so the

131
00:05:45,349 --> 00:05:48,020
setup for this I don't have any

132
00:05:46,789 --> 00:05:49,400
screenshots but I got some links they're

133
00:05:48,020 --> 00:05:51,969
gonna be coming up that kind of you can

134
00:05:49,400 --> 00:05:54,318
go to take pictures or look at the PDF

135
00:05:51,969 --> 00:05:55,639
that you can follow step by step when

136
00:05:54,319 --> 00:05:57,050
you're actually at your computer but

137
00:05:55,639 --> 00:05:58,969
essentially what we're gonna do is we're

138
00:05:57,050 --> 00:06:02,449
going to enable a proxy either through

139
00:05:58,969 --> 00:06:04,159
fiddler or burp suite we're gonna tell

140
00:06:02,449 --> 00:06:05,330
it to generate a root certificate that

141
00:06:04,159 --> 00:06:07,340
we're going to install on your computer

142
00:06:05,330 --> 00:06:08,628
and then we're going to connect then

143
00:06:07,340 --> 00:06:10,369
you're going to take your device connect

144
00:06:08,629 --> 00:06:12,319
to that proxy from your device and

145
00:06:10,370 --> 00:06:14,659
you're gonna navigate to the website or

146
00:06:12,319 --> 00:06:16,849
to the IP of the computer that's hosting

147
00:06:14,659 --> 00:06:18,919
the software that's running the proxy

148
00:06:16,849 --> 00:06:20,569
and from there you install that

149
00:06:18,919 --> 00:06:22,159
certificate on your device this allows

150
00:06:20,569 --> 00:06:24,560
for the device to the grow up to traffic

151
00:06:22,159 --> 00:06:26,060
send it back to the proxy server and

152
00:06:24,560 --> 00:06:29,319
that's where you'll be able to view all

153
00:06:26,060 --> 00:06:32,479
the traffic that's coming from your app

154
00:06:29,319 --> 00:06:33,889
so once this is all done essentially

155
00:06:32,479 --> 00:06:36,889
what you'll be able to do is open

156
00:06:33,889 --> 00:06:39,439
applications and look at the application

157
00:06:36,889 --> 00:06:41,210
on your computer and see raw traffic

158
00:06:39,439 --> 00:06:43,219
just like you would if you were on a web

159
00:06:41,210 --> 00:06:45,979
browser on computer and this is where we

160
00:06:43,219 --> 00:06:47,810
want to be most people aren't aware that

161
00:06:45,979 --> 00:06:49,460
I'm sure many people are aware but a lot

162
00:06:47,810 --> 00:06:51,349
of people don't think that you can like

163
00:06:49,460 --> 00:06:53,000
view traffic than mobile application

164
00:06:51,349 --> 00:06:58,039
ascending you definitely can and this is

165
00:06:53,000 --> 00:07:01,279
the way to do it so some next steps

166
00:06:58,039 --> 00:07:03,949
these are kind of my really abridged

167
00:07:01,279 --> 00:07:06,889
version of like a a wasp or or something

168
00:07:03,949 --> 00:07:08,569
like that whenever I find a mobile

169
00:07:06,889 --> 00:07:11,210
application and I want to start testing

170
00:07:08,569 --> 00:07:13,279
it one of the things I do right away if

171
00:07:11,210 --> 00:07:15,799
it's a it's an application that has say

172
00:07:13,279 --> 00:07:18,199
you can create accounts I'll create two

173
00:07:15,800 --> 00:07:20,960
I'll create two accounts the reason for

174
00:07:18,199 --> 00:07:24,589
this is I want to look at the headers

175
00:07:20,960 --> 00:07:26,750
how is this application handing handling

176
00:07:24,589 --> 00:07:28,849
their session management are they using

177
00:07:26,750 --> 00:07:31,909
like something really simple like basics

178
00:07:28,849 --> 00:07:33,438
before cookie in that type of thing that

179
00:07:31,909 --> 00:07:34,610
you can you know decode and look at

180
00:07:33,439 --> 00:07:37,849
what's actually happening or are they

181
00:07:34,610 --> 00:07:41,449
using something different and then once

182
00:07:37,849 --> 00:07:43,849
I have these two accounts all then other

183
00:07:41,449 --> 00:07:46,250
than compare the two what changes our

184
00:07:43,849 --> 00:07:50,089
cookie are the tokens changing re other

185
00:07:46,250 --> 00:07:50,840
headers changing basically see identify

186
00:07:50,089 --> 00:07:53,600
what's chained

187
00:07:50,840 --> 00:07:55,310
this application the second thing I do

188
00:07:53,600 --> 00:07:58,040
is like change account information

189
00:07:55,310 --> 00:07:59,930
whether this is like a first name or an

190
00:07:58,040 --> 00:08:02,660
email address or a password I want to

191
00:07:59,930 --> 00:08:05,030
look at this request I want to see what

192
00:08:02,660 --> 00:08:07,340
this looks like is the path is the

193
00:08:05,030 --> 00:08:09,049
changing email request a one-stage

194
00:08:07,340 --> 00:08:12,138
request or two-stage and by that I mean

195
00:08:09,050 --> 00:08:15,080
is that is the request saying username

196
00:08:12,139 --> 00:08:18,020
you know change you know whatever WM /

197
00:08:15,080 --> 00:08:21,500
app API bla and the post data is

198
00:08:18,020 --> 00:08:25,219
username password new email or new

199
00:08:21,500 --> 00:08:27,169
password or is it a request vo where

200
00:08:25,220 --> 00:08:28,790
does that initial one and a second

201
00:08:27,169 --> 00:08:31,159
request is kicked off from the API that

202
00:08:28,790 --> 00:08:33,229
says modify the email or password of

203
00:08:31,160 --> 00:08:35,479
this account if that's the case maybe we

204
00:08:33,229 --> 00:08:38,500
can modify that second request and

205
00:08:35,479 --> 00:08:41,150
change other accounts information and

206
00:08:38,500 --> 00:08:43,159
the third is if the account if the

207
00:08:41,150 --> 00:08:45,500
application is social in nature meaning

208
00:08:43,159 --> 00:08:48,140
it's a social network of some sort view

209
00:08:45,500 --> 00:08:50,029
other profiles one of the really big

210
00:08:48,140 --> 00:08:53,839
things I'll be covering here are leaky

211
00:08:50,029 --> 00:08:54,860
api's so I poke about it briefly a

212
00:08:53,839 --> 00:08:57,860
moment ago

213
00:08:54,860 --> 00:09:00,050
where data that's sent to the device the

214
00:08:57,860 --> 00:09:01,790
actual application isn't all the data

215
00:09:00,050 --> 00:09:04,250
that's coming generally mobile

216
00:09:01,790 --> 00:09:06,170
applications are sending JSON blobs and

217
00:09:04,250 --> 00:09:08,240
the device is rendering that in

218
00:09:06,170 --> 00:09:10,370
different areas of the application but

219
00:09:08,240 --> 00:09:12,230
there's a lot of that data sometimes

220
00:09:10,370 --> 00:09:13,940
that the application is sending that

221
00:09:12,230 --> 00:09:19,130
isn't rendered and you can view that

222
00:09:13,940 --> 00:09:20,600
through this method and ultimately

223
00:09:19,130 --> 00:09:22,339
explore the app like you normally would

224
00:09:20,600 --> 00:09:24,080
I think it's really good if you're not

225
00:09:22,339 --> 00:09:26,750
if you do the first three things you're

226
00:09:24,080 --> 00:09:28,250
not finding anything you want to you

227
00:09:26,750 --> 00:09:30,529
know you really want to explore the app

228
00:09:28,250 --> 00:09:32,720
like it was I don't know Facebook like I

229
00:09:30,529 --> 00:09:34,430
app that you use a ton like Twitter you

230
00:09:32,720 --> 00:09:36,890
know go through all the menus even if

231
00:09:34,430 --> 00:09:38,180
you're not using them just and then look

232
00:09:36,890 --> 00:09:39,589
at the requests that are firing from

233
00:09:38,180 --> 00:09:41,300
that and you can scroll back through

234
00:09:39,589 --> 00:09:43,310
burp suite or fiddler and you can look

235
00:09:41,300 --> 00:09:49,250
at each one where the responses were the

236
00:09:43,310 --> 00:09:51,170
calls and you know go from there so I've

237
00:09:49,250 --> 00:09:53,870
identified a number of bugs I've been

238
00:09:51,170 --> 00:09:55,400
doing this for a bit and what I do is

239
00:09:53,870 --> 00:09:57,230
when I find a bug I'll responsibly

240
00:09:55,400 --> 00:09:58,939
disclose it to the creator of the

241
00:09:57,230 --> 00:10:01,459
application and sometimes that goes

242
00:09:58,940 --> 00:10:02,329
great sometimes it goes horribly you

243
00:10:01,459 --> 00:10:03,560
know if you're not familiar with the

244
00:10:02,329 --> 00:10:06,589
whole security research

245
00:10:03,560 --> 00:10:09,680
and you know notifying companies of the

246
00:10:06,590 --> 00:10:12,650
dangers of vulnerabilities you should

247
00:10:09,680 --> 00:10:14,839
look into that but this is basically a

248
00:10:12,650 --> 00:10:17,150
these two links right here are going to

249
00:10:14,840 --> 00:10:19,010
be describing how you can set these up

250
00:10:17,150 --> 00:10:20,420
in full detail step by step on your

251
00:10:19,010 --> 00:10:22,250
computer so if you take a picture of

252
00:10:20,420 --> 00:10:30,310
that or look at the PDF for you to do

253
00:10:22,250 --> 00:10:30,310
that okay sure

254
00:10:39,420 --> 00:10:44,699
all right so I'm gonna start going over

255
00:10:41,520 --> 00:10:46,829
some plugs back down then you know no

256
00:10:44,700 --> 00:10:48,840
mobile applications and the first one's

257
00:10:46,830 --> 00:10:51,240
gonna be wishbone it's a social

258
00:10:48,840 --> 00:10:53,820
networking voting app and how this works

259
00:10:51,240 --> 00:10:56,280
is on the picture on the left

260
00:10:53,820 --> 00:10:57,510
I guess they say here's a picture here's

261
00:10:56,280 --> 00:10:59,730
a picture which one do you like better

262
00:10:57,510 --> 00:11:05,490
guess is a thing people do I don't

263
00:10:59,730 --> 00:11:07,290
understand it but there it exists you

264
00:11:05,490 --> 00:11:11,730
can see at the very bottom of this and

265
00:11:07,290 --> 00:11:12,329
oh can I walk you can see this username

266
00:11:11,730 --> 00:11:14,520
right here

267
00:11:12,330 --> 00:11:16,470
and if you click it it'll watch the

268
00:11:14,520 --> 00:11:20,640
users profile that's basically what I

269
00:11:16,470 --> 00:11:24,300
did for this one very simple that's

270
00:11:20,640 --> 00:11:28,980
actually remarkably clear okay great so

271
00:11:24,300 --> 00:11:30,030
right away things things to see if you

272
00:11:28,980 --> 00:11:32,340
can't see it's in the back remember to

273
00:11:30,030 --> 00:11:34,500
check the PDF it's much clearer right

274
00:11:32,340 --> 00:11:36,870
away something that poked that I noticed

275
00:11:34,500 --> 00:11:38,880
right away is a sequential user ID up

276
00:11:36,870 --> 00:11:40,680
here in the users that's a really bad

277
00:11:38,880 --> 00:11:44,550
practice for a number of reasons but

278
00:11:40,680 --> 00:11:47,489
namely if an app was giving out other

279
00:11:44,550 --> 00:11:49,890
information you user can scrape that

280
00:11:47,490 --> 00:11:52,410
they can go from one user 1 user 1

281
00:11:49,890 --> 00:11:54,930
million grab all that user data save it

282
00:11:52,410 --> 00:11:57,300
super simple super simple Python script

283
00:11:54,930 --> 00:12:00,000
to go from but if you look at the

284
00:11:57,300 --> 00:12:01,770
response of this request at the bottom

285
00:12:00,000 --> 00:12:04,290
you're gonna see some information is

286
00:12:01,770 --> 00:12:07,170
coming that includes the email of the

287
00:12:04,290 --> 00:12:09,480
user the full name of the user and the

288
00:12:07,170 --> 00:12:10,800
mobile phone number that's currently set

289
00:12:09,480 --> 00:12:12,660
the null because the user didn't have

290
00:12:10,800 --> 00:12:14,490
one in their profile this is probably

291
00:12:12,660 --> 00:12:16,980
something that certainly something to

292
00:12:14,490 --> 00:12:18,540
you that the application shouldn't be

293
00:12:16,980 --> 00:12:20,070
sending out it's a user it's it's

294
00:12:18,540 --> 00:12:22,170
certainly not rendering on the phone or

295
00:12:20,070 --> 00:12:23,220
the device but the end user is getting

296
00:12:22,170 --> 00:12:28,890
it they just don't know they're getting

297
00:12:23,220 --> 00:12:30,510
it now I mean see now how could someone

298
00:12:28,890 --> 00:12:32,970
like miss use this I kind of covered it

299
00:12:30,510 --> 00:12:34,470
but someone could scrape this out in a

300
00:12:32,970 --> 00:12:38,040
Python script or a Ruby script or

301
00:12:34,470 --> 00:12:39,990
whatever script and say go user 1 - 1

302
00:12:38,040 --> 00:12:43,380
million then give me the fields for

303
00:12:39,990 --> 00:12:44,610
email phone and full name and that would

304
00:12:43,380 --> 00:12:46,620
be bad because then someone would

305
00:12:44,610 --> 00:12:49,850
practically have at least a portion of

306
00:12:46,620 --> 00:12:52,319
this entire social networks database and

307
00:12:49,850 --> 00:12:54,709
I tried to

308
00:12:52,319 --> 00:12:57,599
I reached out to this company ten times

309
00:12:54,709 --> 00:13:00,959
spanning six months even and never got a

310
00:12:57,600 --> 00:13:04,019
response and until late May and

311
00:13:00,959 --> 00:13:06,299
something else that happened in May was

312
00:13:04,019 --> 00:13:07,529
that wishbone actually had a Mongo

313
00:13:06,299 --> 00:13:09,179
database which if you're not familiar

314
00:13:07,529 --> 00:13:11,489
with those by default they don't have

315
00:13:09,179 --> 00:13:13,079
authentication so you can log in to the

316
00:13:11,489 --> 00:13:15,419
Mongo DB and then you can start

317
00:13:13,079 --> 00:13:17,939
extracting data or deleting data or

318
00:13:15,419 --> 00:13:20,399
doing a lot of other things and someone

319
00:13:17,939 --> 00:13:23,029
found it and they can load all of it and

320
00:13:20,399 --> 00:13:25,949
then became a big news story 2.2 million

321
00:13:23,029 --> 00:13:29,910
users emails phone numbers and all that

322
00:13:25,949 --> 00:13:30,839
full names are exposed and then right

323
00:13:29,910 --> 00:13:32,639
after this happened

324
00:13:30,839 --> 00:13:38,399
wishbone contacted me and said oh we're

325
00:13:32,639 --> 00:13:40,619
fixing this right away so it's kind of

326
00:13:38,399 --> 00:13:42,329
interesting I think the guys that got

327
00:13:40,619 --> 00:13:44,600
into this MongoDB probably thought were

328
00:13:42,329 --> 00:13:48,358
like oh we scored we got this amazing

329
00:13:44,600 --> 00:13:49,829
you know database and sure they did but

330
00:13:48,359 --> 00:13:51,569
they didn't really need that Mongo

331
00:13:49,829 --> 00:13:55,258
database it could have exploited the API

332
00:13:51,569 --> 00:13:57,029
here to get the same so it doesn't

333
00:13:55,259 --> 00:13:58,920
matter this is just you know just show

334
00:13:57,029 --> 00:14:00,990
that

335
00:13:58,920 --> 00:14:02,329
database or however you're handling in

336
00:14:00,990 --> 00:14:05,130
your system you're back in a

337
00:14:02,329 --> 00:14:07,949
misconfigured api linking information is

338
00:14:05,130 --> 00:14:10,189
really bad and can you know expose your

339
00:14:07,950 --> 00:14:10,190
user base

340
00:14:10,459 --> 00:14:15,500
all right so seeking arrangement leak

341
00:14:13,470 --> 00:14:18,180
trifecta is what this one's called and

342
00:14:15,500 --> 00:14:20,160
this first piece is a quote on the

343
00:14:18,180 --> 00:14:20,790
website seeking arrangement com respect

344
00:14:20,160 --> 00:14:22,649
your privacy

345
00:14:20,790 --> 00:14:24,060
all personal information you submitted

346
00:14:22,649 --> 00:14:26,209
the seeking arrangement will be kept in

347
00:14:24,060 --> 00:14:29,310
the strictest strictest confidence

348
00:14:26,209 --> 00:14:30,869
so we'll get more tomorrow on that but

349
00:14:29,310 --> 00:14:32,670
really quick seeking arrangement seeking

350
00:14:30,870 --> 00:14:34,529
millionaire and miss travel com

351
00:14:32,670 --> 00:14:37,729
they're all owned by the same company

352
00:14:34,529 --> 00:14:40,260
they're a dating app I'll call it and

353
00:14:37,730 --> 00:14:42,350
user sign up and you know if they

354
00:14:40,260 --> 00:14:44,399
interact with people kind of like a I

355
00:14:42,350 --> 00:14:46,800
would compare it to kind of like a twin

356
00:14:44,399 --> 00:14:49,800
tinder I guess so

357
00:14:46,800 --> 00:14:51,240
my steps to find issues with these Apple

358
00:14:49,800 --> 00:14:53,729
this application was to create an

359
00:14:51,240 --> 00:14:55,110
account and start viewing profiles right

360
00:14:53,730 --> 00:14:57,000
away the social network so I go straight

361
00:14:55,110 --> 00:14:59,100
back to thinking they're probably

362
00:14:57,000 --> 00:15:03,600
leaking some data off their API that you

363
00:14:59,100 --> 00:15:08,839
can scrape so hopefully this is clear

364
00:15:03,600 --> 00:15:12,060
okay so right away you move over here

365
00:15:08,839 --> 00:15:13,709
just work it's just much clearer on PDF

366
00:15:12,060 --> 00:15:17,760
once again so right away I'm viewing

367
00:15:13,709 --> 00:15:19,680
another users page here and right away I

368
00:15:17,760 --> 00:15:23,220
see the email address is exposed again

369
00:15:19,680 --> 00:15:26,069
did I see this flag value that's

370
00:15:23,220 --> 00:15:28,320
pointing to like a our dns 100 terabyte

371
00:15:26,070 --> 00:15:30,029
com I don't really know what that is but

372
00:15:28,320 --> 00:15:31,440
they're doing some type of flagging a

373
00:15:30,029 --> 00:15:34,019
clogging of accounts and they're

374
00:15:31,440 --> 00:15:35,820
managing it by what's their host name

375
00:15:34,019 --> 00:15:38,490
and that sort of information that kind

376
00:15:35,820 --> 00:15:40,199
of made me think that's a lot of

377
00:15:38,490 --> 00:15:42,540
information they have here and it's not

378
00:15:40,199 --> 00:15:45,240
coming to the in app there's probably a

379
00:15:42,540 --> 00:15:47,550
ton more so I just viewed three or four

380
00:15:45,240 --> 00:15:50,550
different profiles here's the second one

381
00:15:47,550 --> 00:15:53,790
I viewed the black that area there is

382
00:15:50,550 --> 00:15:56,910
the email address and here's the third

383
00:15:53,790 --> 00:16:02,670
one I viewed and this one's a little

384
00:15:56,910 --> 00:16:06,810
little crazy so what really got me here

385
00:16:02,670 --> 00:16:08,760
is that one is temp password equals 0 so

386
00:16:06,810 --> 00:16:10,800
as if I was an attacker and I was

387
00:16:08,760 --> 00:16:11,649
looking to attack this I would look at

388
00:16:10,800 --> 00:16:12,998
like

389
00:16:11,649 --> 00:16:14,410
what temp passwords are what the

390
00:16:12,999 --> 00:16:16,629
structure is is it like a six digit

391
00:16:14,410 --> 00:16:18,610
number could I could an attacker

392
00:16:16,629 --> 00:16:21,220
potentially scrape all the users and say

393
00:16:18,610 --> 00:16:22,839
if ten password equals 1 then brute

394
00:16:21,220 --> 00:16:25,509
force that temp password that's an area

395
00:16:22,839 --> 00:16:29,559
to look at certainly but then there's

396
00:16:25,509 --> 00:16:31,089
this last activity piece here and here

397
00:16:29,559 --> 00:16:34,480
you'll actually get the IP address of

398
00:16:31,089 --> 00:16:36,879
the user the host name of the user the

399
00:16:34,480 --> 00:16:38,110
OS that they're viewing the the Apple on

400
00:16:36,879 --> 00:16:40,869
seeking arrangement has a web version

401
00:16:38,110 --> 00:16:45,610
apparently and you know when they were

402
00:16:40,869 --> 00:16:47,889
last online and that's pretty spooky for

403
00:16:45,610 --> 00:16:49,839
social networks in general social

404
00:16:47,889 --> 00:16:51,610
especially dating social networks

405
00:16:49,839 --> 00:16:53,769
because then users can stalk other users

406
00:16:51,610 --> 00:16:56,800
it gives them a lot of information to

407
00:16:53,769 --> 00:17:00,279
find things so this was another case of

408
00:16:56,800 --> 00:17:02,679
another leaky API I reported this in May

409
00:17:00,279 --> 00:17:04,119
it was fixed in August and it's not a

410
00:17:02,679 --> 00:17:05,648
terrible timeline for this stuff I've

411
00:17:04,119 --> 00:17:07,479
seen much longer

412
00:17:05,648 --> 00:17:09,369
I wanted to include I'm searching around

413
00:17:07,480 --> 00:17:11,169
for sneaking arrangement and they have a

414
00:17:09,369 --> 00:17:12,339
number of I can't verify any of this

415
00:17:11,169 --> 00:17:13,959
stuff I don't know if any of this is

416
00:17:12,339 --> 00:17:15,760
true or happen but this is what happens

417
00:17:13,959 --> 00:17:17,679
why Google seeking arrangement and

418
00:17:15,760 --> 00:17:19,898
they've had a number of stalking cases

419
00:17:17,679 --> 00:17:22,240
and I think this leaky API could have

420
00:17:19,898 --> 00:17:23,918
severely attributed to someone else if

421
00:17:22,240 --> 00:17:26,559
they wanted to start stalking users

422
00:17:23,919 --> 00:17:30,760
there so I'm glad it's patched and

423
00:17:26,559 --> 00:17:33,158
that's no longer an issue for people so

424
00:17:30,760 --> 00:17:35,440
there are a couple two mystery apps I

425
00:17:33,159 --> 00:17:38,110
can't give names for and that's either

426
00:17:35,440 --> 00:17:40,779
because they're not patched or there's

427
00:17:38,110 --> 00:17:42,100
another issue so let's just say this is

428
00:17:40,779 --> 00:17:44,049
an app that is used to purchase goods

429
00:17:42,100 --> 00:17:46,689
and those goods are then delivered to

430
00:17:44,049 --> 00:17:54,129
the customer and it's a somewhat popular

431
00:17:46,690 --> 00:17:55,360
app in its own niche so once again my

432
00:17:54,130 --> 00:17:57,220
steps here are to create an account

433
00:17:55,360 --> 00:17:59,379
start looking around see what I can do I

434
00:17:57,220 --> 00:18:01,240
want to view the application I want to

435
00:17:59,380 --> 00:18:04,059
make a request and ultimately on this

436
00:18:01,240 --> 00:18:06,730
one I made an a request to update my my

437
00:18:04,059 --> 00:18:09,250
accounts email address and you'll see

438
00:18:06,730 --> 00:18:12,490
here sorry I'm doing the shuffle back

439
00:18:09,250 --> 00:18:14,049
and forth but so once again right away

440
00:18:12,490 --> 00:18:16,539
you're gonna see sequential user IDs

441
00:18:14,049 --> 00:18:20,020
once again just super prevalent in

442
00:18:16,539 --> 00:18:22,629
mobile applications and what really

443
00:18:20,020 --> 00:18:24,668
caught my eye here was well let me cover

444
00:18:22,630 --> 00:18:24,960
this first I created two user accounts

445
00:18:24,669 --> 00:18:30,240
for

446
00:18:24,960 --> 00:18:33,299
gdb CCC and from here you'll see the

447
00:18:30,240 --> 00:18:35,760
author authorization is a basic basics

448
00:18:33,299 --> 00:18:39,870
t4 encrypted piece are here and coded

449
00:18:35,760 --> 00:18:41,640
piece rather and two extra headers here

450
00:18:39,870 --> 00:18:43,439
are created for the same user ID that

451
00:18:41,640 --> 00:18:45,840
I'm currently logged into and the

452
00:18:43,440 --> 00:18:48,000
username and this is right here's the

453
00:18:45,840 --> 00:18:50,580
request to change that email so it's

454
00:18:48,000 --> 00:18:52,590
saying this is profile formation so my

455
00:18:50,580 --> 00:18:54,539
profile my date of birth didn't update

456
00:18:52,590 --> 00:19:02,309
but this is my new email that I want to

457
00:18:54,539 --> 00:19:03,840
make for myself so right away I see

458
00:19:02,309 --> 00:19:05,940
base64 I'm thinking I want to create

459
00:19:03,840 --> 00:19:09,000
that second account and see what changes

460
00:19:05,940 --> 00:19:12,270
does do other headers change you bait

461
00:19:09,000 --> 00:19:14,640
this at base64 string change its that's

462
00:19:12,270 --> 00:19:18,330
what I did and the only thing that

463
00:19:14,640 --> 00:19:21,630
really changed here is the you'll see

464
00:19:18,330 --> 00:19:24,059
the username the X user ID the base64

465
00:19:21,630 --> 00:19:27,360
stayed the same and when I decoded that

466
00:19:24,059 --> 00:19:32,010
base64 you'll actually see it there it's

467
00:19:27,360 --> 00:19:34,678
API at redacted comm : asdf a and that

468
00:19:32,010 --> 00:19:38,220
made me think they're using a global off

469
00:19:34,679 --> 00:19:41,340
for all this stuff and that made me

470
00:19:38,220 --> 00:19:44,250
think that I I can probably change any

471
00:19:41,340 --> 00:19:45,899
users account here so I tested it and

472
00:19:44,250 --> 00:19:48,510
sure enough it worked I was able to

473
00:19:45,899 --> 00:19:50,879
modify my other account from the first

474
00:19:48,510 --> 00:19:53,970
account and that's a pretty serious

475
00:19:50,880 --> 00:19:55,980
issue here because any user can change

476
00:19:53,970 --> 00:19:58,640
any other users information so it's

477
00:19:55,980 --> 00:20:01,320
really a terrible set up really the only

478
00:19:58,640 --> 00:20:02,940
reason for user accounts period here is

479
00:20:01,320 --> 00:20:04,980
that different users have different

480
00:20:02,940 --> 00:20:07,350
billing but they're not segmenting that

481
00:20:04,980 --> 00:20:09,390
by authorization so I'm not sure how

482
00:20:07,350 --> 00:20:14,699
this will set up but it's a a pretty bad

483
00:20:09,390 --> 00:20:16,760
situation to sequential user IDs the

484
00:20:14,700 --> 00:20:20,149
impact here could have been really bad

485
00:20:16,760 --> 00:20:22,890
it would have been super easy initially

486
00:20:20,149 --> 00:20:25,799
initially I thought that the X username

487
00:20:22,890 --> 00:20:28,169
request here the header at the very

488
00:20:25,799 --> 00:20:31,110
bottom the DC DD sees you see at Bob me

489
00:20:28,169 --> 00:20:33,450
on that info which if you don't know is

490
00:20:31,110 --> 00:20:35,789
a Bob Beldon impose a male on intercom

491
00:20:33,450 --> 00:20:37,920
thing I use a lot mail an era Commons

492
00:20:35,789 --> 00:20:41,460
filter a lot of places but

493
00:20:37,920 --> 00:20:43,170
using that works really well so I

494
00:20:41,460 --> 00:20:44,460
thought right away that the impact of

495
00:20:43,170 --> 00:20:46,260
this would be really low you wouldn't be

496
00:20:44,460 --> 00:20:48,090
able to forge this request to modify

497
00:20:46,260 --> 00:20:50,670
another users account because the ex

498
00:20:48,090 --> 00:20:52,560
user name the ex user ID well we know

499
00:20:50,670 --> 00:20:56,490
that sequential so we can increment one

500
00:20:52,560 --> 00:20:57,960
or or go minus one but if you don't know

501
00:20:56,490 --> 00:20:59,760
the user name maybe you can't send this

502
00:20:57,960 --> 00:21:01,740
request but when I stripped those off

503
00:20:59,760 --> 00:21:03,690
and sent the request that still works

504
00:21:01,740 --> 00:21:07,080
they're not needed so yeah it's still

505
00:21:03,690 --> 00:21:09,450
pretty bad and if you put this in a

506
00:21:07,080 --> 00:21:12,360
script basically an attacker could have

507
00:21:09,450 --> 00:21:14,790
said go through 1 user 1 to 1 million

508
00:21:12,360 --> 00:21:16,530
and change the email to a catch-all

509
00:21:14,790 --> 00:21:17,460
domain or something like that and then

510
00:21:16,530 --> 00:21:19,800
they could've hijacked all these

511
00:21:17,460 --> 00:21:21,780
accounts and then you know ultimately

512
00:21:19,800 --> 00:21:25,649
billing informations exposed and a lot

513
00:21:21,780 --> 00:21:29,430
of other terrible things can happen but

514
00:21:25,650 --> 00:21:31,830
this they said they fix it and I went to

515
00:21:29,430 --> 00:21:33,870
go test it for a to verify because I'm

516
00:21:31,830 --> 00:21:36,659
what's going to talk about here and it

517
00:21:33,870 --> 00:21:41,459
wasn't fixed and so I reassured that

518
00:21:36,660 --> 00:21:43,910
request to please verify this this

519
00:21:41,460 --> 00:21:46,350
application it's a mystery IOT wearable

520
00:21:43,910 --> 00:21:48,900
the wearable tracks information and

521
00:21:46,350 --> 00:21:50,820
stats on the where the mobile

522
00:21:48,900 --> 00:21:52,950
applications where all the simple can be

523
00:21:50,820 --> 00:21:54,899
viewed so generally if you're thinking

524
00:21:52,950 --> 00:21:56,700
like a Fitbit or that's like well you

525
00:21:54,900 --> 00:21:58,230
know information where a lot of

526
00:21:56,700 --> 00:22:00,360
information about you your whereabouts

527
00:21:58,230 --> 00:22:01,830
and that sort of thing are aggregated

528
00:22:00,360 --> 00:22:03,419
somewhere and then displayed to you on

529
00:22:01,830 --> 00:22:04,710
mobile application it's a lot of

530
00:22:03,420 --> 00:22:05,790
personal information about you so you

531
00:22:04,710 --> 00:22:10,230
probably wouldn't want someone to get

532
00:22:05,790 --> 00:22:12,810
ahold of that so I started reviewing the

533
00:22:10,230 --> 00:22:14,310
mobile application and basically just

534
00:22:12,810 --> 00:22:16,790
kind of seeing what data was being sent

535
00:22:14,310 --> 00:22:19,710
back right away I saw something that

536
00:22:16,790 --> 00:22:24,300
that was interesting the name on the

537
00:22:19,710 --> 00:22:26,430
application for the user there's this

538
00:22:24,300 --> 00:22:30,659
anonymized name which was shown on the

539
00:22:26,430 --> 00:22:33,800
app but the the response actually sent a

540
00:22:30,660 --> 00:22:33,800
full name

541
00:22:34,260 --> 00:22:40,860
last name here so right away

542
00:22:38,040 --> 00:22:42,090
I'm seeing that okay the the app is

543
00:22:40,860 --> 00:22:45,360
getting other information than the

544
00:22:42,090 --> 00:22:46,290
actual devices I'm sorry the the app is

545
00:22:45,360 --> 00:22:47,129
getting information is just not

546
00:22:46,290 --> 00:22:49,020
rendering that data

547
00:22:47,130 --> 00:22:49,420
I bet since they're leaking this they're

548
00:22:49,020 --> 00:22:51,370
probably

549
00:22:49,420 --> 00:22:54,760
taking some other things so I started

550
00:22:51,370 --> 00:22:56,949
poking around and made basically did my

551
00:22:54,760 --> 00:22:59,080
fourth step and what I showed originally

552
00:22:56,950 --> 00:23:01,240
where I checked all these settings areas

553
00:22:59,080 --> 00:23:03,399
I went through all the menus and I said

554
00:23:01,240 --> 00:23:05,680
okay let's stop monitoring this let's

555
00:23:03,400 --> 00:23:09,940
review all of this and I stumbled on

556
00:23:05,680 --> 00:23:14,770
this this is a call from their API to a

557
00:23:09,940 --> 00:23:18,760
app third-party credentials and yeah if

558
00:23:14,770 --> 00:23:21,360
you're familiar with AWS at all these

559
00:23:18,760 --> 00:23:25,090
are AWS access keys and secret keys and

560
00:23:21,360 --> 00:23:27,250
I don't want that the loop there but so

561
00:23:25,090 --> 00:23:30,000
they're holding they're giving you their

562
00:23:27,250 --> 00:23:33,310
AWS access key there aw a secret key

563
00:23:30,000 --> 00:23:35,110
both for their iOS and Android although

564
00:23:33,310 --> 00:23:38,260
they may be the same I haven't analyzed

565
00:23:35,110 --> 00:23:40,120
it and there's a ton of other API keys I

566
00:23:38,260 --> 00:23:41,920
didn't list here that they're calling

567
00:23:40,120 --> 00:23:43,719
from and what this will allow if you're

568
00:23:41,920 --> 00:23:45,640
not familiar with AWS is you could take

569
00:23:43,720 --> 00:23:48,640
the you can take the access key the

570
00:23:45,640 --> 00:23:50,350
secret key plug it into AWS Clee you use

571
00:23:48,640 --> 00:23:53,050
AWS configure to set this up and you'll

572
00:23:50,350 --> 00:23:54,969
be able to you know list their s3

573
00:23:53,050 --> 00:23:58,080
buckets probably describe their ec2

574
00:23:54,970 --> 00:24:01,120
instances which are VPS is basically and

575
00:23:58,080 --> 00:24:03,070
yeah and the name of these doesn't

576
00:24:01,120 --> 00:24:04,510
doesn't make you feel good because the

577
00:24:03,070 --> 00:24:07,000
information they'd have one of them like

578
00:24:04,510 --> 00:24:10,000
production battery data or production

579
00:24:07,000 --> 00:24:11,500
sync info what's what's this app what's

580
00:24:10,000 --> 00:24:14,230
this wearable syncing that's probably

581
00:24:11,500 --> 00:24:17,980
seeking a lot of information about about

582
00:24:14,230 --> 00:24:21,550
the user so I I reached out to this

583
00:24:17,980 --> 00:24:23,560
company and I didn't get a good response

584
00:24:21,550 --> 00:24:25,090
they said they they feel this is more of

585
00:24:23,560 --> 00:24:27,429
a man-in-the-middle attack than anything

586
00:24:25,090 --> 00:24:28,870
else and it's not it's not really an

587
00:24:27,430 --> 00:24:33,720
issue and I thought they're getting

588
00:24:28,870 --> 00:24:33,719
around to encrypting it so there's that

589
00:24:38,320 --> 00:24:44,530
so as a red team member I've certainly

590
00:24:41,440 --> 00:24:47,590
used like a double yes a lot too I found

591
00:24:44,530 --> 00:24:49,030
AWS keys and have they've been low

592
00:24:47,590 --> 00:24:51,879
permission right they've been the API

593
00:24:49,030 --> 00:24:54,389
user that but they still listings and

594
00:24:51,880 --> 00:24:58,120
view s3 buckets download that data and

595
00:24:54,390 --> 00:25:00,700
I've certainly used that to find other

596
00:24:58,120 --> 00:25:02,590
keys or information in the s3 buckets

597
00:25:00,700 --> 00:25:04,780
super to escalate my access to like a

598
00:25:02,590 --> 00:25:06,610
power user that has I am access directly

599
00:25:04,780 --> 00:25:09,580
native a yes and that could have been

600
00:25:06,610 --> 00:25:11,590
used here I tried to explain that to

601
00:25:09,580 --> 00:25:14,280
them and they said that they you know I

602
00:25:11,590 --> 00:25:16,659
already said what they said but yeah and

603
00:25:14,280 --> 00:25:18,940
they're taking another pass over their

604
00:25:16,660 --> 00:25:23,100
AWS stuff they feel very confident that

605
00:25:18,940 --> 00:25:26,140
their permissions were solid but yeah

606
00:25:23,100 --> 00:25:29,199
all right so we're all adults here

607
00:25:26,140 --> 00:25:32,110
so by bees by bees is sold as the

608
00:25:29,200 --> 00:25:35,040
world's first smart vibrator and it

609
00:25:32,110 --> 00:25:37,360
allows a remote partner to control it so

610
00:25:35,040 --> 00:25:39,760
these other three there's how the four

611
00:25:37,360 --> 00:25:42,129
three four have been kind of scary this

612
00:25:39,760 --> 00:25:45,340
one kind of gets into a crazy area so I

613
00:25:42,130 --> 00:25:47,380
get ready this mobile app basically

614
00:25:45,340 --> 00:25:49,750
functions by it has a chat area where

615
00:25:47,380 --> 00:25:51,070
two people can't communicate and by

616
00:25:49,750 --> 00:25:53,080
communicating I mean they can send

617
00:25:51,070 --> 00:25:54,970
messages just like a you know text

618
00:25:53,080 --> 00:25:57,070
messages they can send pictures they can

619
00:25:54,970 --> 00:26:00,070
start calls they can call sort of video

620
00:25:57,070 --> 00:26:04,300
calls then the remote partner can

621
00:26:00,070 --> 00:26:08,889
control the functions of the device this

622
00:26:04,300 --> 00:26:11,020
is a just an image of that so partner

623
00:26:08,890 --> 00:26:13,240
has a device has a phone the other

624
00:26:11,020 --> 00:26:15,010
person's on the app too he can control

625
00:26:13,240 --> 00:26:16,870
it and after the on the right image is

626
00:26:15,010 --> 00:26:20,410
very top you'll see the controls where

627
00:26:16,870 --> 00:26:24,250
they a person can control this device so

628
00:26:20,410 --> 00:26:26,020
why B's has a privacy wall so which is

629
00:26:24,250 --> 00:26:29,200
good it's a good thing to have you can't

630
00:26:26,020 --> 00:26:30,340
you can't just start saying hey can I

631
00:26:29,200 --> 00:26:32,530
take control of your device

632
00:26:30,340 --> 00:26:34,090
you can't go can I start a video call or

633
00:26:32,530 --> 00:26:36,310
a phone call with you there's this

634
00:26:34,090 --> 00:26:38,740
invitation process as a take place first

635
00:26:36,310 --> 00:26:41,320
user a has to send an invite to user B

636
00:26:38,740 --> 00:26:43,690
and user B has to go I'll accept that or

637
00:26:41,320 --> 00:26:45,760
all the I'll decline it right and I

638
00:26:43,690 --> 00:26:48,210
thought that's really interesting so I

639
00:26:45,760 --> 00:26:50,970
wonder if you can force except in the

640
00:26:48,210 --> 00:26:53,040
tations on behalf of other users so

641
00:26:50,970 --> 00:26:54,720
that's what I did I create a few test

642
00:26:53,040 --> 00:26:58,080
accounts and I started playing with

643
00:26:54,720 --> 00:27:00,150
these requests and then I well I don't

644
00:26:58,080 --> 00:27:01,949
want to get ahead of myself hope this is

645
00:27:00,150 --> 00:27:08,670
somewhat visible yeah that's all right

646
00:27:01,950 --> 00:27:12,660
okay all right so in these examples I'll

647
00:27:08,670 --> 00:27:19,110
be using user ones DDD CCC and user to

648
00:27:12,660 --> 00:27:23,840
is a a BB 12 and I just slap this can

649
00:27:19,110 --> 00:27:26,189
you still hear me yeah my good cool so

650
00:27:23,840 --> 00:27:27,780
what I'm doing is the request up here at

651
00:27:26,190 --> 00:27:31,440
the top is recruiting a new multiple

652
00:27:27,780 --> 00:27:34,139
contact request and it's saying I'm user

653
00:27:31,440 --> 00:27:36,900
do you need ECC want to send this invite

654
00:27:34,140 --> 00:27:39,480
to this other user and the response from

655
00:27:36,900 --> 00:27:41,670
this request is saying we're gonna

656
00:27:39,480 --> 00:27:45,630
generate this with the request ID and

657
00:27:41,670 --> 00:27:48,510
this here is the other user accepting

658
00:27:45,630 --> 00:27:50,820
this so he's saying that processes

659
00:27:48,510 --> 00:27:54,270
contact request and the post stated here

660
00:27:50,820 --> 00:27:57,720
is I'm user name I attested and user

661
00:27:54,270 --> 00:27:59,700
name AAA BBB 12 and I will accept that

662
00:27:57,720 --> 00:28:04,260
request ID that the other person sent

663
00:27:59,700 --> 00:28:05,130
the response is status true so I want

664
00:28:04,260 --> 00:28:06,600
admit I'm what I mean

665
00:28:05,130 --> 00:28:08,550
I wanted me to sorry I want to

666
00:28:06,600 --> 00:28:11,070
manipulate this request I want to try to

667
00:28:08,550 --> 00:28:13,169
forge this and accept it on another user

668
00:28:11,070 --> 00:28:13,620
behalf to basically break this privacy

669
00:28:13,170 --> 00:28:14,970
wall

670
00:28:13,620 --> 00:28:16,770
it's the first step to getting through

671
00:28:14,970 --> 00:28:18,950
anything here so I thought this was a

672
00:28:16,770 --> 00:28:22,740
good area to look at and this is what I

673
00:28:18,950 --> 00:28:26,640
what I did so real quick this is this is

674
00:28:22,740 --> 00:28:29,580
me logged in as the EDD CCC and this is

675
00:28:26,640 --> 00:28:31,230
my third account here Jason k12 preface

676
00:28:29,580 --> 00:28:32,669
this if you're doing any of this stuff

677
00:28:31,230 --> 00:28:34,680
you want to do it on your own account

678
00:28:32,670 --> 00:28:36,510
you want to create why I create two

679
00:28:34,680 --> 00:28:39,000
accounts or three accounts is if you do

680
00:28:36,510 --> 00:28:40,920
this to a regular app users or you start

681
00:28:39,000 --> 00:28:42,900
messing with their stuff your you know

682
00:28:40,920 --> 00:28:45,680
that's very grayish black you're gonna

683
00:28:42,900 --> 00:28:49,620
run a foul CFA stuff at the organization

684
00:28:45,680 --> 00:28:51,360
you know gets in a mood so this is my

685
00:28:49,620 --> 00:28:54,479
other account I have three accounts here

686
00:28:51,360 --> 00:28:58,020
and what I'm saying here is I want this

687
00:28:54,480 --> 00:29:00,810
user to get a request from a BBB 12 and

688
00:28:58,020 --> 00:29:01,970
then while I'm still logged in as this

689
00:29:00,810 --> 00:29:05,269
user here

690
00:29:01,970 --> 00:29:08,559
I want to accept that I'm going to

691
00:29:05,269 --> 00:29:11,570
accept this request on Jason equate k12

692
00:29:08,559 --> 00:29:15,620
behalf and response status true

693
00:29:11,570 --> 00:29:18,649
so this basically breaks the privacy

694
00:29:15,620 --> 00:29:20,178
wall basically any user can say hey no

695
00:29:18,649 --> 00:29:23,719
I'm going to talk to you now and there's

696
00:29:20,179 --> 00:29:25,909
no way you can stop me kind of thing so

697
00:29:23,720 --> 00:29:27,950
this is basically covering it this

698
00:29:25,909 --> 00:29:30,889
picture on the right is just a an iPad

699
00:29:27,950 --> 00:29:33,259
and and basically this is like the

700
00:29:30,889 --> 00:29:34,969
notification someone would get if I they

701
00:29:33,259 --> 00:29:37,639
forced a chat right away and then that

702
00:29:34,970 --> 00:29:39,919
person could say hey that's you want to

703
00:29:37,639 --> 00:29:41,508
have a chat do you want to you know

704
00:29:39,919 --> 00:29:43,909
check out this photo I'm sending you

705
00:29:41,509 --> 00:29:46,250
it's basically just demonstrating this

706
00:29:43,909 --> 00:29:48,470
probably see well it's gone it's now now

707
00:29:46,250 --> 00:29:49,220
there's no where our user can go to

708
00:29:48,470 --> 00:29:52,360
protect himself

709
00:29:49,220 --> 00:29:55,519
other than block that user and

710
00:29:52,360 --> 00:29:57,649
ultimately this got me thinking of that

711
00:29:55,519 --> 00:29:59,330
that request wasn't a super easy one I

712
00:29:57,649 --> 00:29:59,899
just had to modify a couple things and

713
00:29:59,330 --> 00:30:05,600
that worked

714
00:29:59,899 --> 00:30:09,439
what else is broken here so this is the

715
00:30:05,600 --> 00:30:11,418
update email piece here and just like

716
00:30:09,440 --> 00:30:15,080
the others previously I'm still logged

717
00:30:11,419 --> 00:30:17,840
in to the original account teeny DC and

718
00:30:15,080 --> 00:30:20,330
what I'm saying is for my account I want

719
00:30:17,840 --> 00:30:21,769
to update the email and my new email

720
00:30:20,330 --> 00:30:24,889
should be DVCC

721
00:30:21,769 --> 00:30:26,299
new at gmail.com and that's why username

722
00:30:24,889 --> 00:30:29,418
on the end of it the response that comes

723
00:30:26,299 --> 00:30:31,940
back is hey that worked great so now I

724
00:30:29,419 --> 00:30:35,029
want to see can I reset the email of

725
00:30:31,940 --> 00:30:36,799
another user so still all you notice

726
00:30:35,029 --> 00:30:38,629
this user up here but now I'm going to

727
00:30:36,799 --> 00:30:40,940
change my email to a new email for a mil

728
00:30:38,629 --> 00:30:44,059
inator and I'm going to change that user

729
00:30:40,940 --> 00:30:47,629
name to to whatever user name I want to

730
00:30:44,059 --> 00:30:50,809
reset basically the response is true so

731
00:30:47,629 --> 00:30:52,549
if that worked so that's pretty bad and

732
00:30:50,809 --> 00:30:53,990
why it's pretty bad is I mean you're

733
00:30:52,549 --> 00:30:56,509
probably getting there but you probably

734
00:30:53,990 --> 00:30:58,750
know it already you can reset any user's

735
00:30:56,509 --> 00:31:00,950
email and with the forgot password

736
00:30:58,750 --> 00:31:03,080
structure on most applications and

737
00:31:00,950 --> 00:31:04,580
websites you could then request that

738
00:31:03,080 --> 00:31:06,678
password for that account that new email

739
00:31:04,580 --> 00:31:09,529
address gain access to that account and

740
00:31:06,679 --> 00:31:11,240
now the Alpha ization protocol for this

741
00:31:09,529 --> 00:31:14,360
application is basically for fit it's

742
00:31:11,240 --> 00:31:15,410
any user can do anything and very likely

743
00:31:14,360 --> 00:31:16,820
they're not shaped there

744
00:31:15,410 --> 00:31:18,770
they were not checking out the requests

745
00:31:16,820 --> 00:31:24,080
but once I got to this point I reached

746
00:31:18,770 --> 00:31:26,270
out to the company so the impact of this

747
00:31:24,080 --> 00:31:27,980
is pretty pretty terrifying right

748
00:31:26,270 --> 00:31:30,860
the only good thing the saving grace for

749
00:31:27,980 --> 00:31:32,750
this is that the chats and sessions the

750
00:31:30,860 --> 00:31:34,459
chance Ross session based so once

751
00:31:32,750 --> 00:31:36,410
they're over there's not a log of those

752
00:31:34,460 --> 00:31:38,990
so if a user's account gets hijacked

753
00:31:36,410 --> 00:31:41,630
they're not going to be there chat

754
00:31:38,990 --> 00:31:43,250
histories not exposed but the impact is

755
00:31:41,630 --> 00:31:46,280
still kind of frightening because say

756
00:31:43,250 --> 00:31:50,090
you have Bob and Diane and or Diana I

757
00:31:46,280 --> 00:31:53,000
think I used and someone hijacks Bob's

758
00:31:50,090 --> 00:31:54,709
account diana has a device and Bob

759
00:31:53,000 --> 00:31:56,120
didn't just start sending pictures or

760
00:31:54,710 --> 00:31:58,400
says he wants to control a device she

761
00:31:56,120 --> 00:32:00,290
has no way of knowing that's not Bob and

762
00:31:58,400 --> 00:32:03,170
that's pretty terrible

763
00:32:00,290 --> 00:32:05,360
so I reported this to by bees and they

764
00:32:03,170 --> 00:32:08,590
fixed it within an hour probably the the

765
00:32:05,360 --> 00:32:12,560
fastest patch I've ever had

766
00:32:08,590 --> 00:32:15,260
and yeah so they were super cool about

767
00:32:12,560 --> 00:32:16,970
the whole thing and ran through that if

768
00:32:15,260 --> 00:32:19,730
you're not familiar with this group it's

769
00:32:16,970 --> 00:32:21,380
called the Internet of dongs and it's a

770
00:32:19,730 --> 00:32:24,050
group that goes around and they they

771
00:32:21,380 --> 00:32:28,580
patch all these smart sex toys basically

772
00:32:24,050 --> 00:32:30,700
and they basically set up bug bounties

773
00:32:28,580 --> 00:32:32,389
and that those type of programs for

774
00:32:30,700 --> 00:32:34,610
companies that sell these types of

775
00:32:32,390 --> 00:32:37,550
devices and it's a it's a really cool

776
00:32:34,610 --> 00:32:38,750
thing and you'll see like some of the

777
00:32:37,550 --> 00:32:40,820
other things have come out of this or

778
00:32:38,750 --> 00:32:42,890
are people that have rerouted the

779
00:32:40,820 --> 00:32:46,419
Internet Protocol in these things to

780
00:32:42,890 --> 00:32:48,500
work on tor which is pretty crazy right

781
00:32:46,420 --> 00:32:52,340
just hidden checking out these types of

782
00:32:48,500 --> 00:32:53,720
things so free to go check them out so

783
00:32:52,340 --> 00:32:56,540
that's kind of all I have right now and

784
00:32:53,720 --> 00:32:59,450
once again my twitter is there and I'll

785
00:32:56,540 --> 00:33:09,339
take this time for questions

786
00:32:59,450 --> 00:33:12,339
[Applause]

787
00:33:09,339 --> 00:33:12,339
sure

788
00:33:17,220 --> 00:33:20,370
they go

789
00:33:27,429 --> 00:33:30,539
any other questions

790
00:33:30,970 --> 00:33:35,800
so in any of anybody can do this and

791
00:33:33,430 --> 00:33:39,160
snap it not hard at all just follow the

792
00:33:35,800 --> 00:33:48,550
steps and yeah all right

793
00:33:39,160 --> 00:33:49,720
well thank you very much okay if you

794
00:33:48,550 --> 00:33:51,159
liked what you saw please let us know

795
00:33:49,720 --> 00:33:53,230
what you think by participating in our

796
00:33:51,160 --> 00:33:55,750
speaker survey at the back table there

797
00:33:53,230 --> 00:33:58,180
there's some cards just to three

798
00:33:55,750 --> 00:34:00,160
questions should take 15 seconds

799
00:33:58,180 --> 00:34:01,480
synonomous just put it in that box and

800
00:34:00,160 --> 00:34:02,920
let us know what you think about this

801
00:34:01,480 --> 00:34:05,640
and the other talks throughout the day

802
00:34:02,920 --> 00:34:05,640
thank you

