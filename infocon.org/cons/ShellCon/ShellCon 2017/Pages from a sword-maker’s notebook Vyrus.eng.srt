1
00:00:00,030 --> 00:00:04,759
<font color="#E5E5E5">get started just a</font><font color="#CCCCCC"> couple minutes early</font>

2
00:00:01,680 --> 00:00:08,940
<font color="#CCCCCC">before I do have one</font><font color="#E5E5E5"> quick announcement</font>

3
00:00:04,759 --> 00:00:13,170
<font color="#CCCCCC">scale another local conference more</font>

4
00:00:08,940 --> 00:00:15,509
system in<font color="#E5E5E5"> and</font><font color="#CCCCCC"> open-source</font><font color="#E5E5E5"> focused in LA</font>

5
00:00:13,170 --> 00:00:18,330
<font color="#CCCCCC">there call</font><font color="#E5E5E5"> for papers is open now and</font><font color="#CCCCCC"> I</font>

6
00:00:15,509 --> 00:00:21,199
believe closes<font color="#E5E5E5"> next month so if any of</font>

7
00:00:18,330 --> 00:00:24,720
<font color="#CCCCCC">you are</font><font color="#E5E5E5"> so inclined</font><font color="#CCCCCC"> might check that out</font>

8
00:00:21,199 --> 00:00:26,880
<font color="#CCCCCC">alright so</font><font color="#E5E5E5"> as I said we're gonna start</font>

9
00:00:24,720 --> 00:00:29,130
just<font color="#E5E5E5"> a</font><font color="#CCCCCC"> few minutes early here</font><font color="#E5E5E5"> because</font>

10
00:00:26,880 --> 00:00:32,250
sort<font color="#E5E5E5"> of spot and he's got a lot</font><font color="#CCCCCC"> of stuff</font>

11
00:00:29,130 --> 00:00:45,570
to say so without further ado this is

12
00:00:32,250 --> 00:00:48,420
<font color="#E5E5E5">virus</font><font color="#CCCCCC"> yeah so</font><font color="#E5E5E5"> I apologize originally I</font>

13
00:00:45,570 --> 00:00:51,180
was really afraid of<font color="#CCCCCC"> rehashing content</font>

14
00:00:48,420 --> 00:00:52,199
from my<font color="#CCCCCC"> balkon talk because that's why</font>

15
00:00:51,180 --> 00:00:53,969
<font color="#CCCCCC">I'm a lot</font><font color="#E5E5E5"> of stuff I'm going</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> cover</font>

16
00:00:52,199 --> 00:00:56,489
<font color="#E5E5E5">today and today</font><font color="#CCCCCC"> is more of</font><font color="#E5E5E5"> a like how to</font>

17
00:00:53,969 --> 00:00:58,829
do<font color="#CCCCCC"> all the evil stuff and then like</font><font color="#E5E5E5"> 10</font>

18
00:00:56,489 --> 00:01:00,419
minutes<font color="#E5E5E5"> into</font><font color="#CCCCCC"> making these slides give</font>

19
00:00:58,829 --> 00:01:02,219
them and had<font color="#E5E5E5"> to</font><font color="#CCCCCC"> edit a bunch so I</font>

20
00:01:00,420 --> 00:01:04,890
apologize in advance<font color="#CCCCCC"> I'll probably talk</font>

21
00:01:02,219 --> 00:01:08,930
extremely fast<font color="#CCCCCC"> so we're gonna</font><font color="#E5E5E5"> talk about</font>

22
00:01:04,890 --> 00:01:12,450
<font color="#CCCCCC">today is just kind of a tips and</font><font color="#E5E5E5"> tricks</font>

23
00:01:08,930 --> 00:01:13,890
<font color="#E5E5E5">skills I have acquired over time in</font>

24
00:01:12,450 --> 00:01:16,380
scenarios I will not describe because

25
00:01:13,890 --> 00:01:17,720
plausible deniability<font color="#CCCCCC"> I'm basically</font><font color="#E5E5E5"> how</font>

26
00:01:16,380 --> 00:01:19,560
<font color="#CCCCCC">to write</font><font color="#E5E5E5"> long term</font>

27
00:01:17,720 --> 00:01:21,929
<font color="#E5E5E5">intelligence-gathering software</font>

28
00:01:19,560 --> 00:01:23,640
basically<font color="#E5E5E5"> like you know spyware or</font><font color="#CCCCCC"> what</font>

29
00:01:21,930 --> 00:01:25,200
some<font color="#CCCCCC"> people call a PT II or just the</font>

30
00:01:23,640 --> 00:01:26,670
actual scary<font color="#E5E5E5"> stuff that sits inside some</font>

31
00:01:25,200 --> 00:01:28,470
of<font color="#E5E5E5"> these box for not days like a pen</font>

32
00:01:26,670 --> 00:01:31,680
tester but like months days or months

33
00:01:28,470 --> 00:01:33,990
weeks years that kind<font color="#CCCCCC"> of stuff so from a</font>

34
00:01:31,680 --> 00:01:35,790
culture in perspective like we are<font color="#CCCCCC"> ray</font>

35
00:01:33,990 --> 00:01:38,009
<font color="#E5E5E5">we want to get into organization at the</font>

36
00:01:35,790 --> 00:01:39,509
end of the day an organization is just<font color="#CCCCCC"> a</font>

37
00:01:38,009 --> 00:01:40,590
<font color="#CCCCCC">collection of people</font><font color="#E5E5E5"> right I mean it</font>

38
00:01:39,509 --> 00:01:41,970
doesn't<font color="#E5E5E5"> have to be a corporation</font><font color="#CCCCCC"> it</font>

39
00:01:40,590 --> 00:01:44,579
could<font color="#CCCCCC"> just be a group of friends it</font>

40
00:01:41,970 --> 00:01:47,100
could be terrorists who knows<font color="#CCCCCC"> at the end</font>

41
00:01:44,579 --> 00:01:48,689
of the day people<font color="#CCCCCC"> from an information</font>

42
00:01:47,100 --> 00:01:50,339
security<font color="#E5E5E5"> perspective</font><font color="#CCCCCC"> site from</font><font color="#E5E5E5"> human and</font>

43
00:01:48,689 --> 00:01:52,320
are really<font color="#E5E5E5"> just the devices and</font><font color="#CCCCCC"> the data</font>

44
00:01:50,340 --> 00:01:54,450
that's<font color="#E5E5E5"> on them so our</font><font color="#CCCCCC"> kill chain in</font><font color="#E5E5E5"> this</font>

45
00:01:52,320 --> 00:01:56,610
vector<font color="#E5E5E5"> and for the duration of this talk</font>

46
00:01:54,450 --> 00:01:58,530
is<font color="#CCCCCC"> basically how do we get on a thing</font>

47
00:01:56,610 --> 00:02:00,179
and stay<font color="#CCCCCC"> on a thing for</font><font color="#E5E5E5"> a long time and</font>

48
00:01:58,530 --> 00:02:01,469
<font color="#CCCCCC">steal fucking all the things all the</font>

49
00:02:00,180 --> 00:02:04,860
time<font color="#E5E5E5"> for a long periods of time</font>

50
00:02:01,469 --> 00:02:07,320
that's our kill chain so the obvious<font color="#E5E5E5"> and</font>

51
00:02:04,860 --> 00:02:09,538
most<font color="#E5E5E5"> plentifully used and talked about</font>

52
00:02:07,320 --> 00:02:10,440
<font color="#E5E5E5">method for doing this is</font><font color="#CCCCCC"> phishing the</font>

53
00:02:09,538 --> 00:02:12,750
problem with<font color="#E5E5E5"> doing long-term</font>

54
00:02:10,440 --> 00:02:14,520
<font color="#E5E5E5">surveillance via phishing</font>

55
00:02:12,750 --> 00:02:16,290
<font color="#E5E5E5">there there are a lot</font><font color="#CCCCCC"> of good things</font>

56
00:02:14,520 --> 00:02:19,650
<font color="#CCCCCC">obviously in terms of entrance but</font>

57
00:02:16,290 --> 00:02:20,910
there's a<font color="#CCCCCC"> lotta</font><font color="#E5E5E5"> downsides typically if</font>

58
00:02:19,650 --> 00:02:22,560
you talk to a pen tester they'll say

59
00:02:20,910 --> 00:02:24,329
well<font color="#CCCCCC"> fishings nice but fishings really</font>

60
00:02:22,560 --> 00:02:27,270
loud and<font color="#E5E5E5"> can typically an elegant well</font>

61
00:02:24,330 --> 00:02:29,280
that's that's great<font color="#CCCCCC"> but you know over</font>

62
00:02:27,270 --> 00:02:32,100
time<font color="#E5E5E5"> you</font><font color="#CCCCCC"> know when you're trying</font><font color="#E5E5E5"> to stay</font>

63
00:02:29,280 --> 00:02:33,000
<font color="#CCCCCC">in</font><font color="#E5E5E5"> for for long periods of time</font><font color="#CCCCCC"> it's not</font>

64
00:02:32,100 --> 00:02:34,140
as<font color="#E5E5E5"> simple as though I've got a</font>

65
00:02:33,000 --> 00:02:36,570
<font color="#CCCCCC">Metasploit shell and that</font><font color="#E5E5E5"> means I can</font>

66
00:02:34,140 --> 00:02:38,579
<font color="#E5E5E5">access da and everything</font><font color="#CCCCCC"> else is not</font><font color="#E5E5E5"> a</font>

67
00:02:36,570 --> 00:02:41,040
thing<font color="#CCCCCC"> so on the good side it's really</font>

68
00:02:38,580 --> 00:02:42,209
<font color="#CCCCCC">easy you typically get multiple shots</font><font color="#E5E5E5"> of</font>

69
00:02:41,040 --> 00:02:44,340
the target<font color="#CCCCCC"> even if you're spearfishing</font>

70
00:02:42,209 --> 00:02:48,030
<font color="#E5E5E5">right I mean you create an identity it</font>

71
00:02:44,340 --> 00:02:50,700
may take you months you<font color="#E5E5E5"> you know set up</font>

72
00:02:48,030 --> 00:02:52,020
a false report<font color="#CCCCCC"> it takes time to</font><font color="#E5E5E5"> initiate</font>

73
00:02:50,700 --> 00:02:53,339
the kill and<font color="#CCCCCC"> then if you don't get what</font>

74
00:02:52,020 --> 00:02:55,650
you<font color="#CCCCCC"> want you just</font><font color="#E5E5E5"> do it all over</font><font color="#CCCCCC"> again</font>

75
00:02:53,340 --> 00:02:56,730
<font color="#E5E5E5">right there's nobody immune</font><font color="#CCCCCC"> your social</font>

76
00:02:55,650 --> 00:02:58,730
engineering we all know<font color="#E5E5E5"> this if you</font>

77
00:02:56,730 --> 00:03:01,130
don't<font color="#CCCCCC"> know this you're fuckin wrong</font>

78
00:02:58,730 --> 00:03:03,420
<font color="#CCCCCC">there's little to no technical technical</font>

79
00:03:01,130 --> 00:03:04,829
specificity required for most phishing

80
00:03:03,420 --> 00:03:06,750
attacks I mean<font color="#E5E5E5"> really like you can</font>

81
00:03:04,830 --> 00:03:08,520
<font color="#E5E5E5">Google everything</font><font color="#CCCCCC"> you need to</font><font color="#E5E5E5"> know to be</font>

82
00:03:06,750 --> 00:03:10,050
at the absolute<font color="#CCCCCC"> pinnacle of social</font>

83
00:03:08,520 --> 00:03:11,550
engineering<font color="#E5E5E5"> it's not you know you don't</font>

84
00:03:10,050 --> 00:03:13,739
have to know<font color="#CCCCCC"> how to refer to binary or</font>

85
00:03:11,550 --> 00:03:15,270
<font color="#E5E5E5">right</font><font color="#CCCCCC"> O'Day and the great thing is that</font>

86
00:03:13,739 --> 00:03:16,950
generally if you're successful<font color="#E5E5E5"> at any</font>

87
00:03:15,270 --> 00:03:18,660
level<font color="#CCCCCC"> of phishing campaign you get</font>

88
00:03:16,950 --> 00:03:19,470
<font color="#E5E5E5">access as that user so even if you're</font>

89
00:03:18,660 --> 00:03:21,329
not<font color="#E5E5E5"> rude</font>

90
00:03:19,470 --> 00:03:22,950
if the purpose<font color="#CCCCCC"> is intelligence gathering</font>

91
00:03:21,330 --> 00:03:24,180
you usually get enough access to do what

92
00:03:22,950 --> 00:03:25,470
you want to<font color="#E5E5E5"> do the first time you don't</font>

93
00:03:24,180 --> 00:03:29,370
<font color="#E5E5E5">usually have to worry about privileged</font>

94
00:03:25,470 --> 00:03:32,400
access<font color="#E5E5E5"> on the</font><font color="#CCCCCC"> outside phishing is really</font>

95
00:03:29,370 --> 00:03:35,160
loud<font color="#CCCCCC"> it's</font><font color="#E5E5E5"> almost impossible to carry out</font>

96
00:03:32,400 --> 00:03:37,230
any level of<font color="#E5E5E5"> social engineering without</font>

97
00:03:35,160 --> 00:03:41,430
leaving some<font color="#CCCCCC"> kind of trace I mean you</font>

98
00:03:37,230 --> 00:03:43,768
can<font color="#CCCCCC"> new</font><font color="#E5E5E5"> clogs and you can leave fake</font>

99
00:03:41,430 --> 00:03:45,390
logs and you can you<font color="#E5E5E5"> know leave yourself</font>

100
00:03:43,769 --> 00:03:47,760
social exit strategies but<font color="#E5E5E5"> for the most</font>

101
00:03:45,390 --> 00:03:49,950
part<font color="#E5E5E5"> considering the technical impact</font>

102
00:03:47,760 --> 00:03:51,390
<font color="#E5E5E5">phishing is generally loud it generally</font>

103
00:03:49,950 --> 00:03:52,798
leaves a lot<font color="#CCCCCC"> of evidence</font><font color="#E5E5E5"> even if all</font>

104
00:03:51,390 --> 00:03:55,399
you're doing<font color="#CCCCCC"> is an email that's in some</font>

105
00:03:52,799 --> 00:03:59,610
third parties log that<font color="#E5E5E5"> you can't remove</font>

106
00:03:55,400 --> 00:04:02,250
<font color="#CCCCCC">spear versus net obviously like the net</font>

107
00:03:59,610 --> 00:04:04,019
fishing<font color="#CCCCCC"> is probably almost certainly</font>

108
00:04:02,250 --> 00:04:05,760
<font color="#CCCCCC">going to</font><font color="#E5E5E5"> be detected but it'll look like</font>

109
00:04:04,019 --> 00:04:07,769
innocuous but<font color="#E5E5E5"> that being said if it's</font>

110
00:04:05,760 --> 00:04:10,109
<font color="#CCCCCC">not if it's</font><font color="#E5E5E5"> if it's effective it</font>

111
00:04:07,769 --> 00:04:12,329
probably can't look innocuous enough<font color="#CCCCCC"> to</font>

112
00:04:10,110 --> 00:04:13,320
you<font color="#E5E5E5"> know be attributed to some spammer</font>

113
00:04:12,329 --> 00:04:15,090
on the<font color="#E5E5E5"> internet which means somebody's</font>

114
00:04:13,320 --> 00:04:16,890
<font color="#E5E5E5">going</font><font color="#CCCCCC"> to investigate</font><font color="#E5E5E5"> it</font><font color="#CCCCCC"> if it's a spear</font>

115
00:04:15,090 --> 00:04:19,290
fish it<font color="#CCCCCC"> has</font><font color="#E5E5E5"> a much more</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> a much higher</font>

116
00:04:16,890 --> 00:04:20,519
likelihood<font color="#CCCCCC"> of success</font><font color="#E5E5E5"> but your tricks</font>

117
00:04:19,290 --> 00:04:21,900
look unique you don't<font color="#CCCCCC"> look</font><font color="#E5E5E5"> like a</font>

118
00:04:20,519 --> 00:04:23,010
garden-variety attacker you're more

119
00:04:21,899 --> 00:04:24,989
likely to<font color="#E5E5E5"> get profiled you're more</font>

120
00:04:23,010 --> 00:04:27,230
likely to<font color="#E5E5E5"> get caught</font><font color="#CCCCCC"> it's generally high</font>

121
00:04:24,990 --> 00:04:31,140
<font color="#E5E5E5">risk</font>

122
00:04:27,230 --> 00:04:34,050
compared to technical<font color="#E5E5E5"> variants like if a</font>

123
00:04:31,140 --> 00:04:35,550
fish<font color="#CCCCCC"> it goes bad and</font><font color="#E5E5E5"> somebody's randomly</font>

124
00:04:34,050 --> 00:04:36,960
<font color="#E5E5E5">using a computer and they get an error</font>

125
00:04:35,550 --> 00:04:38,610
<font color="#CCCCCC">message</font><font color="#E5E5E5"> that like breaks their machine</font>

126
00:04:36,960 --> 00:04:41,159
that's<font color="#CCCCCC"> it</font><font color="#E5E5E5"> gets investigated right it's</font>

127
00:04:38,610 --> 00:04:43,860
not<font color="#CCCCCC"> like oh you tried to</font><font color="#E5E5E5"> launch</font><font color="#CCCCCC"> oday at</font>

128
00:04:41,160 --> 00:04:44,730
some process and the program died

129
00:04:43,860 --> 00:04:46,170
because<font color="#E5E5E5"> actually happens all the time</font>

130
00:04:44,730 --> 00:04:47,520
<font color="#E5E5E5">because</font><font color="#CCCCCC"> programs poorly written right</font>

131
00:04:46,170 --> 00:04:49,700
<font color="#E5E5E5">like nobody knows how to write software</font>

132
00:04:47,520 --> 00:04:51,419
no big deal

133
00:04:49,700 --> 00:04:52,590
generally if you're going<font color="#E5E5E5"> after a</font>

134
00:04:51,420 --> 00:04:53,850
hardened target you're guilty until

135
00:04:52,590 --> 00:04:55,080
<font color="#E5E5E5">proven innocent</font><font color="#CCCCCC"> like if you're going</font>

136
00:04:53,850 --> 00:04:57,450
after like something<font color="#CCCCCC"> that's current</font>

137
00:04:55,080 --> 00:04:59,159
military or somebody who is<font color="#CCCCCC"> afraid of</font>

138
00:04:57,450 --> 00:05:00,900
<font color="#E5E5E5">the government watching them or someone</font>

139
00:04:59,160 --> 00:05:01,890
<font color="#E5E5E5">activists or something like these are</font>

140
00:05:00,900 --> 00:05:03,299
generally hardened<font color="#CCCCCC"> target</font>

141
00:05:01,890 --> 00:05:04,560
looking for shit to fail they're

142
00:05:03,300 --> 00:05:05,730
generally paranoid<font color="#CCCCCC"> when something</font>

143
00:05:04,560 --> 00:05:06,870
randomly fails on their box they're

144
00:05:05,730 --> 00:05:09,420
going<font color="#CCCCCC"> to</font><font color="#E5E5E5"> notice and when they notice</font>

145
00:05:06,870 --> 00:05:10,530
they're<font color="#E5E5E5"> not just</font><font color="#CCCCCC"> gonna go oh nothing</font>

146
00:05:09,420 --> 00:05:11,700
like<font color="#E5E5E5"> a typical user they're gonna</font>

147
00:05:10,530 --> 00:05:12,840
<font color="#E5E5E5">actually investigate they're going to</font>

148
00:05:11,700 --> 00:05:16,250
<font color="#CCCCCC">Google with Def Con talk on how to do</font>

149
00:05:12,840 --> 00:05:16,250
<font color="#CCCCCC">TFI are like you're gonna</font><font color="#E5E5E5"> get caught</font>

150
00:05:17,639 --> 00:05:23,360
so in terms<font color="#E5E5E5"> of fishing if you're gonna</font>

151
00:05:20,819 --> 00:05:26,520
do<font color="#E5E5E5"> it right</font><font color="#CCCCCC"> we'll talk</font><font color="#E5E5E5"> about vectors so</font>

152
00:05:23,360 --> 00:05:31,289
the probably<font color="#E5E5E5"> the most talked about</font>

153
00:05:26,520 --> 00:05:32,909
vector these days<font color="#E5E5E5"> is OS is office all</font>

154
00:05:31,289 --> 00:05:34,560
right<font color="#E5E5E5"> going</font><font color="#CCCCCC"> in through weird Doc's</font><font color="#E5E5E5"> Excel</font>

155
00:05:32,909 --> 00:05:36,870
<font color="#E5E5E5">Doc's</font><font color="#CCCCCC"> proper presentations stuff like</font>

156
00:05:34,560 --> 00:05:39,360
that<font color="#E5E5E5"> so pretty</font><font color="#CCCCCC"> much if you're gonna hide</font>

157
00:05:36,870 --> 00:05:43,710
a payload in a Word document<font color="#CCCCCC"> go google</font>

158
00:05:39,360 --> 00:05:45,120
this guy right now<font color="#E5E5E5"> he's got a tool that</font>

159
00:05:43,710 --> 00:05:47,520
I<font color="#E5E5E5"> know the last time I talked to him he</font>

160
00:05:45,120 --> 00:05:49,379
<font color="#CCCCCC">was trying to</font><font color="#E5E5E5"> get open sourced</font>

161
00:05:47,520 --> 00:05:51,000
<font color="#CCCCCC">I believe that's still on the agenda but</font>

162
00:05:49,379 --> 00:05:54,689
<font color="#CCCCCC">there's some issues</font><font color="#E5E5E5"> with work and blah</font>

163
00:05:51,000 --> 00:05:57,779
blah blah<font color="#CCCCCC"> I've seen it I wish I could</font>

164
00:05:54,689 --> 00:05:59,639
show<font color="#CCCCCC"> it to</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> but he</font><font color="#E5E5E5"> has</font><font color="#CCCCCC"> given some</font>

165
00:05:57,779 --> 00:06:02,729
talks on what it can<font color="#E5E5E5"> do and it's</font><font color="#CCCCCC"> pretty</font>

166
00:05:59,639 --> 00:06:04,500
much a point-and-click<font color="#E5E5E5"> like GUI on</font><font color="#CCCCCC"> mic</font>

167
00:06:02,729 --> 00:06:06,419
<font color="#E5E5E5">and make bad stuff out</font><font color="#CCCCCC"> of office</font><font color="#E5E5E5"> and</font>

168
00:06:04,500 --> 00:06:08,129
there's way more tricks there's just

169
00:06:06,419 --> 00:06:10,650
<font color="#E5E5E5">it's just</font><font color="#CCCCCC"> awesome it's like the</font>

170
00:06:08,129 --> 00:06:13,879
Metasploit<font color="#E5E5E5"> making office malware and</font>

171
00:06:10,650 --> 00:06:16,198
like none of<font color="#E5E5E5"> this stuff gets caught most</font>

172
00:06:13,879 --> 00:06:17,610
office payloads are based around macros

173
00:06:16,199 --> 00:06:19,409
<font color="#E5E5E5">and that's this</font><font color="#CCCCCC"> is pretty</font><font color="#E5E5E5"> much how you</font>

174
00:06:17,610 --> 00:06:20,610
write macro<font color="#E5E5E5"> it's not hard</font><font color="#CCCCCC"> you pretty</font>

175
00:06:19,409 --> 00:06:22,229
much take whatever your evil stuff<font color="#E5E5E5"> is</font>

176
00:06:20,610 --> 00:06:24,240
you stick it between those two lines<font color="#E5E5E5"> of</font>

177
00:06:22,229 --> 00:06:29,339
code in the macro area of word and you

178
00:06:24,240 --> 00:06:31,710
click<font color="#E5E5E5"> Save done</font><font color="#CCCCCC"> to be</font><font color="#E5E5E5"> more specific</font>

179
00:06:29,339 --> 00:06:32,940
oh no internet being slow and<font color="#CCCCCC"> not</font>

180
00:06:31,710 --> 00:06:34,409
loading my pictures this is<font color="#E5E5E5"> gonna be a</font>

181
00:06:32,940 --> 00:06:38,430
really<font color="#E5E5E5"> weird presentation without</font>

182
00:06:34,409 --> 00:06:43,020
pictures so this<font color="#CCCCCC"> is an example of a</font>

183
00:06:38,430 --> 00:06:44,400
payload<font color="#CCCCCC"> this is one I used unfortunately</font>

184
00:06:43,020 --> 00:06:46,438
the logo is not<font color="#E5E5E5"> showing up so this is</font>

185
00:06:44,400 --> 00:06:49,679
<font color="#CCCCCC">gonna</font><font color="#E5E5E5"> be pissed at me</font><font color="#CCCCCC"> I this</font><font color="#E5E5E5"> is this was</font>

186
00:06:46,439 --> 00:06:52,740
generated<font color="#CCCCCC"> by this</font><font color="#E5E5E5"> over Phobos we use</font>

187
00:06:49,680 --> 00:06:55,020
stuff like<font color="#E5E5E5"> this</font><font color="#CCCCCC"> on a gig that we did</font>

188
00:06:52,740 --> 00:06:56,520
together<font color="#E5E5E5"> while back this is just like a</font>

189
00:06:55,020 --> 00:06:57,779
copy-paste example like if you want

190
00:06:56,520 --> 00:06:59,698
<font color="#E5E5E5">something you</font><font color="#CCCCCC"> can immediately paste into</font>

191
00:06:57,779 --> 00:07:01,199
Word and make it<font color="#E5E5E5"> lo delicious thing this</font>

192
00:06:59,699 --> 00:07:03,210
<font color="#CCCCCC">will load count that exe but this is an</font>

193
00:07:01,199 --> 00:07:09,029
<font color="#CCCCCC">example</font><font color="#E5E5E5"> of like paste this get</font><font color="#CCCCCC"> shell</font>

194
00:07:03,210 --> 00:07:11,638
<font color="#E5E5E5">right or deployed long term payload</font><font color="#CCCCCC"> more</font>

195
00:07:09,029 --> 00:07:13,589
recently I've only used<font color="#CCCCCC"> this in POC</font>

196
00:07:11,639 --> 00:07:16,169
<font color="#E5E5E5">because it's new to me</font><font color="#CCCCCC"> this is like the</font>

197
00:07:13,589 --> 00:07:18,150
DD DD<font color="#E5E5E5"> trick</font><font color="#CCCCCC"> whichever is talking about</font>

198
00:07:16,169 --> 00:07:20,099
<font color="#E5E5E5">on Twitter right</font><font color="#CCCCCC"> now this</font><font color="#E5E5E5"> is actually</font>

199
00:07:18,150 --> 00:07:22,679
really<font color="#E5E5E5"> interesting</font><font color="#CCCCCC"> so basically it turns</font>

200
00:07:20,099 --> 00:07:24,960
<font color="#E5E5E5">out that anywhere on office where you</font>

201
00:07:22,680 --> 00:07:26,279
<font color="#CCCCCC">can add a mail merge field</font><font color="#E5E5E5"> you can add a</font>

202
00:07:24,960 --> 00:07:28,589
<font color="#E5E5E5">function in the same</font><font color="#CCCCCC"> way that you would</font>

203
00:07:26,279 --> 00:07:31,380
add like a function in<font color="#E5E5E5"> Excel turns out</font>

204
00:07:28,589 --> 00:07:35,130
you can make functions<font color="#CCCCCC"> call programs law</font>

205
00:07:31,380 --> 00:07:36,210
<font color="#E5E5E5">um so I highly</font><font color="#CCCCCC"> recommend going</font><font color="#E5E5E5"> to these</font>

206
00:07:35,130 --> 00:07:38,159
<font color="#E5E5E5">guys Twitter feeds and looking at the</font>

207
00:07:36,210 --> 00:07:41,880
pin<font color="#E5E5E5"> post because they've got a blog</font><font color="#CCCCCC"> that</font>

208
00:07:38,160 --> 00:07:43,050
I thought I had<font color="#E5E5E5"> there we go</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> blog</font>

209
00:07:41,880 --> 00:07:44,580
pretty much explains how to do it

210
00:07:43,050 --> 00:07:45,990
there's<font color="#E5E5E5"> no point in me copying their</font>

211
00:07:44,580 --> 00:07:47,640
screenshots because it's all<font color="#E5E5E5"> there it's</font>

212
00:07:45,990 --> 00:07:50,100
a really awesome how-to on how to get

213
00:07:47,640 --> 00:07:51,840
<font color="#E5E5E5">their POC working and that line at the</font>

214
00:07:50,100 --> 00:07:53,730
bottom<font color="#E5E5E5"> is literally if you paste that</font>

215
00:07:51,840 --> 00:07:55,200
into a field like when you<font color="#CCCCCC"> open a</font>

216
00:07:53,730 --> 00:07:59,390
document<font color="#CCCCCC"> that</font><font color="#E5E5E5"> will call count that's a</font>

217
00:07:55,200 --> 00:08:01,530
<font color="#E5E5E5">that's an example Palin</font><font color="#CCCCCC"> other</font><font color="#E5E5E5"> methods of</font>

218
00:07:59,390 --> 00:08:04,830
social<font color="#CCCCCC"> engineering getting on a system</font>

219
00:08:01,530 --> 00:08:07,440
there's the<font color="#E5E5E5"> PDF proxy</font><font color="#CCCCCC"> 6e combo which</font>

220
00:08:04,830 --> 00:08:09,510
I'll have<font color="#E5E5E5"> a picture in the following</font>

221
00:08:07,440 --> 00:08:11,550
<font color="#E5E5E5">slide which kind of shows how that's</font>

222
00:08:09,510 --> 00:08:12,900
<font color="#CCCCCC">encapsulated</font><font color="#E5E5E5"> PDF proxy is this awesome</font>

223
00:08:11,550 --> 00:08:13,650
awesome awesome tool written by this<font color="#E5E5E5"> guy</font>

224
00:08:12,900 --> 00:08:15,510
named Josh<font color="#E5E5E5"> Pitts</font>

225
00:08:13,650 --> 00:08:17,510
that we will talk<font color="#E5E5E5"> about</font><font color="#CCCCCC"> or our reference</font>

226
00:08:15,510 --> 00:08:21,330
at least five times throughout<font color="#E5E5E5"> this talk</font>

227
00:08:17,510 --> 00:08:23,700
long story short<font color="#E5E5E5"> it analyzes but it</font>

228
00:08:21,330 --> 00:08:26,430
analyzes files usually binaries<font color="#E5E5E5"> and</font>

229
00:08:23,700 --> 00:08:28,950
finds things called code caves<font color="#E5E5E5"> which</font>

230
00:08:26,430 --> 00:08:31,830
we'll talk about<font color="#E5E5E5"> later</font><font color="#CCCCCC"> and basically it</font>

231
00:08:28,950 --> 00:08:33,720
takes<font color="#E5E5E5"> malicious code and sticks it in</font>

232
00:08:31,830 --> 00:08:35,280
that<font color="#E5E5E5"> code cave so that that file is</font>

233
00:08:33,720 --> 00:08:36,900
essentially<font color="#CCCCCC"> a backdoor and</font><font color="#E5E5E5"> it works on</font>

234
00:08:35,280 --> 00:08:38,490
<font color="#E5E5E5">all</font><font color="#CCCCCC"> kind</font><font color="#E5E5E5"> of shit it works on all the</font>

235
00:08:36,900 --> 00:08:39,900
binaries on Linux<font color="#E5E5E5"> all the binaries on</font>

236
00:08:38,490 --> 00:08:41,370
<font color="#CCCCCC">Windows all the binaries on OSX works on</font>

237
00:08:39,900 --> 00:08:43,228
a bunch<font color="#E5E5E5"> of web payloads</font><font color="#CCCCCC"> it works</font><font color="#E5E5E5"> on</font>

238
00:08:41,370 --> 00:08:45,990
documents it works on like fucking

239
00:08:43,229 --> 00:08:47,580
everything<font color="#E5E5E5"> and he</font><font color="#CCCCCC"> is no longer</font>

240
00:08:45,990 --> 00:08:50,400
<font color="#E5E5E5">maintaining it but</font><font color="#CCCCCC"> it's written</font><font color="#E5E5E5"> in</font>

241
00:08:47,580 --> 00:08:51,720
Python and it's<font color="#CCCCCC"> all the dependencies</font><font color="#E5E5E5"> are</font>

242
00:08:50,400 --> 00:08:53,010
largely documented so if you want to

243
00:08:51,720 --> 00:08:54,960
<font color="#E5E5E5">take that</font><font color="#CCCCCC"> functionality out</font><font color="#E5E5E5"> and put it</font>

244
00:08:53,010 --> 00:08:57,540
into something<font color="#CCCCCC"> that is standalone</font><font color="#E5E5E5"> and</font>

245
00:08:54,960 --> 00:08:59,070
self-contained and<font color="#E5E5E5"> autonomous</font><font color="#CCCCCC"> it's</font>

246
00:08:57,540 --> 00:09:00,780
really<font color="#E5E5E5"> relatively straightforward the</font>

247
00:08:59,070 --> 00:09:03,000
codes relatively<font color="#CCCCCC"> well documented more</font>

248
00:09:00,780 --> 00:09:04,680
<font color="#E5E5E5">importantly especially</font><font color="#CCCCCC"> if you're dealing</font>

249
00:09:03,000 --> 00:09:06,000
on modern operating<font color="#CCCCCC"> systems the problem</font>

250
00:09:04,680 --> 00:09:07,199
is<font color="#CCCCCC"> yeah I</font><font color="#E5E5E5"> can back to our binary but</font>

251
00:09:06,000 --> 00:09:09,990
it's gonna change<font color="#E5E5E5"> the signature right</font>

252
00:09:07,200 --> 00:09:11,220
well he has a new project<font color="#E5E5E5"> which he just</font>

253
00:09:09,990 --> 00:09:13,620
talked about<font color="#E5E5E5"> I</font><font color="#CCCCCC"> think a couple</font><font color="#E5E5E5"> of weeks</font>

254
00:09:11,220 --> 00:09:16,320
<font color="#CCCCCC">ago</font><font color="#E5E5E5"> called</font><font color="#CCCCCC"> cig thief</font><font color="#E5E5E5"> sick thief is</font>

255
00:09:13,620 --> 00:09:18,150
awesome<font color="#E5E5E5"> I honestly haven't had a chance</font>

256
00:09:16,320 --> 00:09:20,070
<font color="#E5E5E5">to look at really</font><font color="#CCCCCC"> the internals to</font><font color="#E5E5E5"> know</font>

257
00:09:18,150 --> 00:09:21,930
how the hell<font color="#CCCCCC"> it works it's fucking</font>

258
00:09:20,070 --> 00:09:24,300
voodoo<font color="#CCCCCC"> oh but basically you take</font><font color="#E5E5E5"> a</font>

259
00:09:21,930 --> 00:09:26,189
signed binary that fits<font color="#E5E5E5"> certain</font>

260
00:09:24,300 --> 00:09:27,719
parameters<font color="#CCCCCC"> and you say</font><font color="#E5E5E5"> steal this</font>

261
00:09:26,190 --> 00:09:29,160
<font color="#E5E5E5">signature you take that signature you</font>

262
00:09:27,720 --> 00:09:30,750
back to<font color="#CCCCCC"> the original binary</font><font color="#E5E5E5"> and you add</font>

263
00:09:29,160 --> 00:09:33,089
the signature back<font color="#E5E5E5"> and nothing has</font>

264
00:09:30,750 --> 00:09:34,910
changed holy shit nothing finds this

265
00:09:33,090 --> 00:09:37,770
please use it

266
00:09:34,910 --> 00:09:39,150
evil grade<font color="#E5E5E5"> III</font><font color="#CCCCCC"> I talked to a lot</font><font color="#E5E5E5"> of pen</font>

267
00:09:37,770 --> 00:09:40,949
testers who basically<font color="#E5E5E5"> come to me with</font>

268
00:09:39,150 --> 00:09:44,220
<font color="#E5E5E5">like well</font><font color="#CCCCCC"> if your grades great but you</font>

269
00:09:40,950 --> 00:09:45,509
know SSL<font color="#CCCCCC"> makes things</font><font color="#E5E5E5"> not work</font>

270
00:09:44,220 --> 00:09:48,509
for those of you they don't<font color="#CCCCCC"> know evil</font>

271
00:09:45,509 --> 00:09:52,259
<font color="#E5E5E5">grade is a man the middle</font><font color="#CCCCCC"> trick</font><font color="#E5E5E5"> slash</font>

272
00:09:48,509 --> 00:09:54,300
utility that<font color="#E5E5E5"> it listens for HTTP</font>

273
00:09:52,259 --> 00:09:56,189
requests for updates servers and as the

274
00:09:54,300 --> 00:09:57,990
update comes down it<font color="#CCCCCC"> backdoors the</font>

275
00:09:56,189 --> 00:09:59,610
update and then sensitive actually<font color="#CCCCCC"> BDF</font>

276
00:09:57,990 --> 00:10:00,839
the backdoor factory proxy has like a

277
00:09:59,610 --> 00:10:03,300
proxy fight version that kind of<font color="#E5E5E5"> does</font>

278
00:10:00,839 --> 00:10:05,189
what<font color="#CCCCCC"> you will grade those</font><font color="#E5E5E5"> yeah so like</font>

279
00:10:03,300 --> 00:10:06,719
<font color="#E5E5E5">the SSL thing and how you know yeah</font>

280
00:10:05,189 --> 00:10:08,279
<font color="#CCCCCC">something the app connects and it</font>

281
00:10:06,720 --> 00:10:09,660
doesn't you know it gets<font color="#E5E5E5"> a different</font>

282
00:10:08,279 --> 00:10:11,670
<font color="#CCCCCC">cert</font><font color="#E5E5E5"> and so that means it's not gonna</font>

283
00:10:09,660 --> 00:10:13,379
work<font color="#E5E5E5"> yeah that's true for like honestly</font>

284
00:10:11,670 --> 00:10:15,089
<font color="#E5E5E5">in the real world like ten percent</font><font color="#CCCCCC"> of</font>

285
00:10:13,379 --> 00:10:17,339
web targets<font color="#E5E5E5"> because yeah it's not gonna</font>

286
00:10:15,089 --> 00:10:22,019
<font color="#E5E5E5">work on like a Windows Update but like</font>

287
00:10:17,339 --> 00:10:24,089
sublime and fucking games and<font color="#E5E5E5"> there's so</font>

288
00:10:22,019 --> 00:10:26,339
many<font color="#E5E5E5"> little</font><font color="#CCCCCC"> stupid third-party pieces of</font>

289
00:10:24,089 --> 00:10:28,079
software<font color="#CCCCCC"> that people</font><font color="#E5E5E5"> use like little</font>

290
00:10:26,339 --> 00:10:30,209
steam updates that people don't use game

291
00:10:28,079 --> 00:10:31,378
cheats or great one right<font color="#CCCCCC"> like</font><font color="#E5E5E5"> people</font>

292
00:10:30,209 --> 00:10:33,388
download porn all the time with<font color="#E5E5E5"> little</font>

293
00:10:31,379 --> 00:10:34,980
<font color="#E5E5E5">like auto</font><font color="#CCCCCC"> executors stuff but all of</font>

294
00:10:33,389 --> 00:10:36,569
that<font color="#E5E5E5"> shit ignores the fucking</font><font color="#CCCCCC"> safe okay</font>

295
00:10:34,980 --> 00:10:38,040
it connects the cert goes bad and

296
00:10:36,569 --> 00:10:39,209
<font color="#CCCCCC">there's a silent thing in the back that</font>

297
00:10:38,040 --> 00:10:42,089
<font color="#CCCCCC">goes from fucking I still want the</font>

298
00:10:39,209 --> 00:10:46,128
update<font color="#E5E5E5"> and it installs yeah SSL does not</font>

299
00:10:42,089 --> 00:10:47,850
kill any of that shit<font color="#CCCCCC"> beef is a modern</font>

300
00:10:46,129 --> 00:10:49,170
<font color="#CCCCCC">pentest framework</font><font color="#E5E5E5"> for browser</font>

301
00:10:47,850 --> 00:10:52,110
exploitation

302
00:10:49,170 --> 00:10:53,309
<font color="#E5E5E5">I had a demo that I was going to show</font>

303
00:10:52,110 --> 00:10:55,110
you that<font color="#CCCCCC"> I didn't have time to</font><font color="#E5E5E5"> write</font>

304
00:10:53,309 --> 00:10:58,379
<font color="#E5E5E5">because I'm a new dad</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> babies are</font>

305
00:10:55,110 --> 00:10:59,579
complicated<font color="#CCCCCC"> um</font><font color="#E5E5E5"> I just</font><font color="#CCCCCC"> got it working</font><font color="#E5E5E5"> and</font>

306
00:10:58,379 --> 00:11:01,439
unfortunately<font color="#E5E5E5"> I</font><font color="#CCCCCC"> don't have it portable</font>

307
00:10:59,579 --> 00:11:04,800
<font color="#E5E5E5">enough to show you I'll probably drop it</font>

308
00:11:01,439 --> 00:11:06,498
on my github<font color="#CCCCCC"> when I</font><font color="#E5E5E5"> get home tonight and</font>

309
00:11:04,800 --> 00:11:09,179
I'll tweet it<font color="#E5E5E5"> out and people can</font>

310
00:11:06,499 --> 00:11:10,740
organically share it<font color="#E5E5E5"> it's basically just</font>

311
00:11:09,179 --> 00:11:14,220
a key logger<font color="#CCCCCC"> that sits in</font><font color="#E5E5E5"> the browser</font>

312
00:11:10,740 --> 00:11:15,899
<font color="#E5E5E5">and stupid you'd be surprised how long</font>

313
00:11:14,220 --> 00:11:18,749
people<font color="#E5E5E5"> leave their browsers open and</font>

314
00:11:15,899 --> 00:11:19,949
don't read with their machine so<font color="#E5E5E5"> you</font>

315
00:11:18,749 --> 00:11:21,899
know even<font color="#E5E5E5"> if they don't reviewed it for</font>

316
00:11:19,949 --> 00:11:24,349
a week that's a week<font color="#E5E5E5"> of everything that</font>

317
00:11:21,899 --> 00:11:26,779
they've logged into getting creds<font color="#E5E5E5"> wise</font>

318
00:11:24,350 --> 00:11:29,519
also you can manual<font color="#E5E5E5"> packets poof</font>

319
00:11:26,779 --> 00:11:31,949
<font color="#CCCCCC">unfortunately the only source code I</font>

320
00:11:29,519 --> 00:11:34,980
have<font color="#CCCCCC"> to show you how manual packet</font>

321
00:11:31,949 --> 00:11:36,149
spoofing can be used<font color="#CCCCCC"> I sold to a</font>

322
00:11:34,980 --> 00:11:38,009
<font color="#E5E5E5">third-party vendor</font><font color="#CCCCCC"> this will remain</font>

323
00:11:36,149 --> 00:11:40,499
<font color="#CCCCCC">nameless</font><font color="#E5E5E5"> so I can't show it to you but</font>

324
00:11:38,009 --> 00:11:42,509
basically<font color="#CCCCCC"> in a lot of update chains</font>

325
00:11:40,499 --> 00:11:45,059
<font color="#E5E5E5">aside from the three-part handshake to</font>

326
00:11:42,509 --> 00:11:48,509
open up the<font color="#CCCCCC"> ssl chain</font><font color="#E5E5E5"> it just pushes</font><font color="#CCCCCC"> a</font>

327
00:11:45,059 --> 00:11:50,249
binary<font color="#E5E5E5"> and there's no signature</font>

328
00:11:48,509 --> 00:11:51,959
verification on the<font color="#E5E5E5"> client side they're</font>

329
00:11:50,249 --> 00:11:53,639
supposed to but a<font color="#CCCCCC"> lot of</font><font color="#E5E5E5"> companies don't</font>

330
00:11:51,959 --> 00:11:55,109
<font color="#E5E5E5">do it because have to</font><font color="#CCCCCC"> do with</font>

331
00:11:53,639 --> 00:11:56,640
verification certs<font color="#E5E5E5"> what that means</font>

332
00:11:55,110 --> 00:12:01,050
essentially is<font color="#CCCCCC"> that</font>

333
00:11:56,640 --> 00:12:03,840
you can constantly send packets in

334
00:12:01,050 --> 00:12:06,599
groups that assume<font color="#CCCCCC"> okay if</font><font color="#E5E5E5"> I would</font><font color="#CCCCCC"> have</font>

335
00:12:03,840 --> 00:12:08,850
connected<font color="#E5E5E5"> here's a bunch of data that is</font>

336
00:12:06,600 --> 00:12:10,410
the<font color="#CCCCCC"> binary and you keep sending</font><font color="#E5E5E5"> this and</font>

337
00:12:08,850 --> 00:12:12,150
what happens<font color="#CCCCCC"> is eventually</font><font color="#E5E5E5"> when they</font>

338
00:12:10,410 --> 00:12:12,719
actually do an update your packets<font color="#E5E5E5"> get</font>

339
00:12:12,150 --> 00:12:14,640
<font color="#E5E5E5">there first</font>

340
00:12:12,720 --> 00:12:17,700
<font color="#CCCCCC">and they'd absorb or it absorbs</font><font color="#E5E5E5"> the</font>

341
00:12:14,640 --> 00:12:19,770
original and it just<font color="#E5E5E5"> absorbs</font><font color="#CCCCCC"> like I said</font>

342
00:12:17,700 --> 00:12:23,550
I wish I had I could say the code but

343
00:12:19,770 --> 00:12:24,930
<font color="#CCCCCC">you know</font><font color="#E5E5E5"> I like not going to jail</font><font color="#CCCCCC"> other</font>

344
00:12:23,550 --> 00:12:26,280
<font color="#E5E5E5">methods of social engineering a lot</font><font color="#CCCCCC"> of</font>

345
00:12:24,930 --> 00:12:27,870
<font color="#E5E5E5">people download where's back all the</font>

346
00:12:26,280 --> 00:12:32,189
layers<font color="#E5E5E5"> nobody's checking signatures</font><font color="#CCCCCC"> it</font>

347
00:12:27,870 --> 00:12:33,960
totally works<font color="#CCCCCC"> I have maybe 15 times</font><font color="#E5E5E5"> that</font>

348
00:12:32,190 --> 00:12:37,500
<font color="#E5E5E5">I can specifically remember in my entire</font>

349
00:12:33,960 --> 00:12:39,450
<font color="#E5E5E5">InfoSec career</font><font color="#CCCCCC"> remember</font><font color="#E5E5E5"> specifically</font>

350
00:12:37,500 --> 00:12:42,300
using<font color="#CCCCCC"> adult-entertainment as a method of</font>

351
00:12:39,450 --> 00:12:43,830
like this<font color="#E5E5E5"> bot this program will fucking</font>

352
00:12:42,300 --> 00:12:46,670
destroy your<font color="#E5E5E5"> computer but click here to</font>

353
00:12:43,830 --> 00:12:50,280
get boobies people click yes every time

354
00:12:46,670 --> 00:12:52,650
<font color="#E5E5E5">every time it's fucking true right I</font>

355
00:12:50,280 --> 00:12:54,270
mean<font color="#E5E5E5"> sexist as</font><font color="#CCCCCC"> most as much as you think</font>

356
00:12:52,650 --> 00:12:55,860
<font color="#CCCCCC">it may be</font><font color="#E5E5E5"> a like a Chris Rock says it's</font>

357
00:12:54,270 --> 00:12:56,819
true<font color="#CCCCCC"> if America was</font><font color="#E5E5E5"> a woman America</font>

358
00:12:55,860 --> 00:12:58,380
would be a big-titty woman

359
00:12:56,820 --> 00:13:01,230
<font color="#E5E5E5">everybody loves the big city</font><font color="#CCCCCC"> woman it's</font>

360
00:12:58,380 --> 00:13:03,300
<font color="#E5E5E5">fucking true in general people click</font>

361
00:13:01,230 --> 00:13:04,980
shit they do<font color="#CCCCCC"> sometimes you have to get</font>

362
00:13:03,300 --> 00:13:06,300
you know<font color="#E5E5E5"> unique about letting their</font>

363
00:13:04,980 --> 00:13:07,680
guard<font color="#CCCCCC"> down because</font><font color="#E5E5E5"> some people know not</font>

364
00:13:06,300 --> 00:13:11,790
to click shit but everybody click shit

365
00:13:07,680 --> 00:13:14,729
<font color="#E5E5E5">we</font><font color="#CCCCCC"> all do it</font><font color="#E5E5E5"> okay so other vectors right</font>

366
00:13:11,790 --> 00:13:16,050
you can<font color="#E5E5E5"> add a stuff</font><font color="#CCCCCC"> image libraries are</font>

367
00:13:14,730 --> 00:13:19,530
a great one because<font color="#CCCCCC"> they tend to not get</font>

368
00:13:16,050 --> 00:13:21,180
updated<font color="#E5E5E5"> games</font><font color="#CCCCCC"> web</font><font color="#E5E5E5"> servers one of my</font>

369
00:13:19,530 --> 00:13:23,040
favorite for going after local<font color="#E5E5E5"> web</font>

370
00:13:21,180 --> 00:13:24,479
<font color="#E5E5E5">servers is internal websites that</font>

371
00:13:23,040 --> 00:13:26,670
haven't been<font color="#E5E5E5"> updated</font><font color="#CCCCCC"> in a while</font><font color="#E5E5E5"> that</font>

372
00:13:24,480 --> 00:13:29,160
have profile pictures a lot of them use

373
00:13:26,670 --> 00:13:30,930
variants of<font color="#E5E5E5"> GD Lib that it's fucking old</font>

374
00:13:29,160 --> 00:13:32,819
<font color="#E5E5E5">there's tons of bugs in GD Lib so you</font>

375
00:13:30,930 --> 00:13:35,719
update a profile picture<font color="#E5E5E5"> but you</font><font color="#CCCCCC"> know</font>

376
00:13:32,820 --> 00:13:37,920
you get web browser access<font color="#E5E5E5"> it's awesome</font>

377
00:13:35,720 --> 00:13:39,810
<font color="#CCCCCC">chat applications are</font><font color="#E5E5E5"> another</font><font color="#CCCCCC"> popular</font>

378
00:13:37,920 --> 00:13:41,130
one there's<font color="#CCCCCC"> so many documented bugs and</font>

379
00:13:39,810 --> 00:13:43,619
Lib purple that have not been patched

380
00:13:41,130 --> 00:13:45,630
<font color="#E5E5E5">and the Purple's in like everything I</font>

381
00:13:43,620 --> 00:13:47,190
really kind of<font color="#E5E5E5"> don't know why that's not</font>

382
00:13:45,630 --> 00:13:50,430
a bigger deal with<font color="#CCCCCC"> activists since they</font>

383
00:13:47,190 --> 00:13:51,930
all use it for<font color="#E5E5E5"> tor chat but yeah</font><font color="#CCCCCC"> media</font>

384
00:13:50,430 --> 00:13:53,430
sharing bugs are really<font color="#E5E5E5"> fun because</font>

385
00:13:51,930 --> 00:13:55,890
generally when<font color="#CCCCCC"> they break it generally</font>

386
00:13:53,430 --> 00:13:56,849
like media tends to<font color="#E5E5E5"> break a lot right</font>

387
00:13:55,890 --> 00:13:57,780
like how many<font color="#E5E5E5"> times have you</font><font color="#CCCCCC"> tried</font><font color="#E5E5E5"> to</font>

388
00:13:56,850 --> 00:13:58,980
play<font color="#CCCCCC"> a video</font><font color="#E5E5E5"> off the internet that's</font>

389
00:13:57,780 --> 00:14:01,199
totally legit it just doesn't<font color="#CCCCCC"> play</font>

390
00:13:58,980 --> 00:14:03,000
because insert VLC problem or ffmpeg or

391
00:14:01,200 --> 00:14:04,380
whatever because<font color="#E5E5E5"> everybody wants to not</font>

392
00:14:03,000 --> 00:14:06,120
play nice<font color="#E5E5E5"> with codecs which means that</font>

393
00:14:04,380 --> 00:14:07,110
there's constant<font color="#E5E5E5"> parsing errors but it</font>

394
00:14:06,120 --> 00:14:09,370
<font color="#CCCCCC">generally means</font><font color="#E5E5E5"> that if you're using</font>

395
00:14:07,110 --> 00:14:10,570
<font color="#CCCCCC">O'Dea and</font><font color="#E5E5E5"> a media server</font>

396
00:14:09,370 --> 00:14:11,980
you<font color="#CCCCCC"> can't get</font><font color="#E5E5E5"> multiple plays at the</font>

397
00:14:10,570 --> 00:14:13,330
target because nobody's gonna check the

398
00:14:11,980 --> 00:14:16,510
<font color="#CCCCCC">air</font><font color="#E5E5E5"> right</font><font color="#CCCCCC"> they're just</font><font color="#E5E5E5"> used to videos</font>

399
00:14:13,330 --> 00:14:17,890
<font color="#E5E5E5">not working</font><font color="#CCCCCC"> drivers are a great one how</font>

400
00:14:16,510 --> 00:14:19,900
many<font color="#CCCCCC"> in this room have tried to update</font>

401
00:14:17,890 --> 00:14:21,400
and video drivers or ATI drivers at some

402
00:14:19,900 --> 00:14:23,140
point and had it horribly shit the bed

403
00:14:21,400 --> 00:14:24,699
on<font color="#E5E5E5"> their box and not investigated</font><font color="#CCCCCC"> it</font>

404
00:14:23,140 --> 00:14:27,310
yeah and you<font color="#E5E5E5"> guys are all smarter than</font>

405
00:14:24,700 --> 00:14:29,740
the average users right<font color="#E5E5E5"> yeah great place</font>

406
00:14:27,310 --> 00:14:32,349
<font color="#E5E5E5">to</font><font color="#CCCCCC"> find a day there's also like old day</font>

407
00:14:29,740 --> 00:14:34,300
as I call it<font color="#E5E5E5"> or like one day this is in</font>

408
00:14:32,350 --> 00:14:37,060
my opinion<font color="#CCCCCC"> the most effective method for</font>

409
00:14:34,300 --> 00:14:40,079
<font color="#CCCCCC">getting into anything</font><font color="#E5E5E5"> because at the</font><font color="#CCCCCC"> end</font>

410
00:14:37,060 --> 00:14:42,670
<font color="#E5E5E5">of the day nobody patches</font><font color="#CCCCCC"> whether it's</font>

411
00:14:40,080 --> 00:14:44,710
it's too much it's too hard they're

412
00:14:42,670 --> 00:14:46,180
worried about the updates not being

413
00:14:44,710 --> 00:14:47,980
compatible with<font color="#E5E5E5"> other shit they're</font>

414
00:14:46,180 --> 00:14:50,290
worried about<font color="#CCCCCC"> I don't want to learn to</font>

415
00:14:47,980 --> 00:14:53,220
do and if it whatever right like most

416
00:14:50,290 --> 00:14:55,959
software in the<font color="#E5E5E5"> world is not new and</font>

417
00:14:53,220 --> 00:14:57,790
that means it has<font color="#E5E5E5"> bugs and the great</font>

418
00:14:55,960 --> 00:14:59,710
thing<font color="#CCCCCC"> about it is that</font><font color="#E5E5E5"> it's way easier</font>

419
00:14:57,790 --> 00:15:01,480
<font color="#CCCCCC">it's scale to look up old bugs that</font>

420
00:14:59,710 --> 00:15:02,620
haven't been patched because nobody put

421
00:15:01,480 --> 00:15:03,970
a logo on<font color="#E5E5E5"> it and gave</font><font color="#CCCCCC"> it a name</font><font color="#E5E5E5"> and</font>

422
00:15:02,620 --> 00:15:06,790
thought it was important than it<font color="#E5E5E5"> is to</font>

423
00:15:03,970 --> 00:15:09,130
<font color="#CCCCCC">find O'Day right</font><font color="#E5E5E5"> but O'Day is that while</font>

424
00:15:06,790 --> 00:15:11,079
O'Day may be great when it works<font color="#CCCCCC"> when it</font>

425
00:15:09,130 --> 00:15:13,210
<font color="#CCCCCC">doesn't</font><font color="#E5E5E5"> work</font><font color="#CCCCCC"> you are absolutely getting</font>

426
00:15:11,080 --> 00:15:15,040
<font color="#CCCCCC">investigated point you're fighting a war</font>

427
00:15:13,210 --> 00:15:16,300
against<font color="#E5E5E5"> the</font><font color="#CCCCCC"> dfi are person I'm</font><font color="#E5E5E5"> not</font>

428
00:15:15,040 --> 00:15:17,260
getting caught<font color="#E5E5E5"> or at least not getting</font>

429
00:15:16,300 --> 00:15:19,089
your payload ripped off and you're

430
00:15:17,260 --> 00:15:20,920
<font color="#E5E5E5">definitely using losing the bug with</font>

431
00:15:19,089 --> 00:15:22,360
this somebody<font color="#E5E5E5"> catches you as long as</font>

432
00:15:20,920 --> 00:15:24,040
<font color="#CCCCCC">they</font><font color="#E5E5E5"> can't attribute it</font><font color="#CCCCCC"> to you fuck its</font>

433
00:15:22,360 --> 00:15:26,680
release but<font color="#CCCCCC"> move on it</font><font color="#E5E5E5"> just looks like a</font>

434
00:15:24,040 --> 00:15:28,900
garden-variety hack<font color="#CCCCCC"> sole access</font>

435
00:15:26,680 --> 00:15:31,510
<font color="#E5E5E5">obviously evil made nothing</font><font color="#CCCCCC"> else needs</font>

436
00:15:28,900 --> 00:15:33,400
to<font color="#E5E5E5"> be</font><font color="#CCCCCC"> said about that and you know</font><font color="#E5E5E5"> long</font>

437
00:15:31,510 --> 00:15:35,770
con<font color="#E5E5E5"> you know I mean insert favorite</font>

438
00:15:33,400 --> 00:15:37,990
movie about<font color="#E5E5E5"> thieves right like you know</font>

439
00:15:35,770 --> 00:15:39,130
<font color="#E5E5E5">you make somebody's friend you sit with</font>

440
00:15:37,990 --> 00:15:40,510
them for a long time to<font color="#E5E5E5"> get coffee</font>

441
00:15:39,130 --> 00:15:42,040
regularly<font color="#E5E5E5"> and then that one day you</font>

442
00:15:40,510 --> 00:15:44,080
pineapple them you're there<font color="#E5E5E5"> to perform</font>

443
00:15:42,040 --> 00:15:46,360
tech support if it doesn't work they

444
00:15:44,080 --> 00:15:49,900
<font color="#E5E5E5">don't think anything's weird</font><font color="#CCCCCC"> Wireless</font>

445
00:15:46,360 --> 00:15:50,980
similar thing<font color="#CCCCCC"> I'm not gonna labor on</font>

446
00:15:49,900 --> 00:15:53,980
wireless<font color="#E5E5E5"> you all kind of know how</font>

447
00:15:50,980 --> 00:15:55,959
<font color="#E5E5E5">Wireless attacks work also the new like</font>

448
00:15:53,980 --> 00:15:58,209
<font color="#CCCCCC">wpa attack that everybody's talking</font>

449
00:15:55,959 --> 00:16:00,219
about<font color="#E5E5E5"> is fucking horseshit</font><font color="#CCCCCC"> can't aired</font>

450
00:15:58,209 --> 00:16:01,660
to all the fuck<font color="#E5E5E5"> that's out there like if</font>

451
00:16:00,220 --> 00:16:04,779
you<font color="#E5E5E5"> don't believe</font><font color="#CCCCCC"> me go read the</font><font color="#E5E5E5"> BSD</font>

452
00:16:01,660 --> 00:16:07,000
patch like honestly like the BSD patch

453
00:16:04,779 --> 00:16:08,650
that changes the<font color="#CCCCCC"> nonces non-relevant and</font>

454
00:16:07,000 --> 00:16:11,350
a whole lot of commercial commercial

455
00:16:08,650 --> 00:16:13,209
router applications<font color="#E5E5E5"> because they use</font>

456
00:16:11,350 --> 00:16:14,650
their own seeds for nonces anyway

457
00:16:13,209 --> 00:16:16,779
<font color="#E5E5E5">because a lot of</font><font color="#CCCCCC"> them have used the</font>

458
00:16:14,650 --> 00:16:19,260
nonce to provide their backdoors<font color="#CCCCCC"> it's</font>

459
00:16:16,779 --> 00:16:21,930
<font color="#E5E5E5">fucking truth</font>

460
00:16:19,260 --> 00:16:24,810
so persistence so persistence takes on a

461
00:16:21,930 --> 00:16:27,689
totally<font color="#CCCCCC"> different vernacular when we're</font>

462
00:16:24,810 --> 00:16:29,130
<font color="#CCCCCC">talking about</font><font color="#E5E5E5"> like</font><font color="#CCCCCC"> long-term</font>

463
00:16:27,690 --> 00:16:30,870
surveillance gathering right when<font color="#E5E5E5"> you're</font>

464
00:16:29,130 --> 00:16:32,160
<font color="#E5E5E5">pen tester persistence is</font><font color="#CCCCCC"> same memory</font>

465
00:16:30,870 --> 00:16:34,200
you don't<font color="#E5E5E5"> write to disk</font><font color="#CCCCCC"> well that's</font>

466
00:16:32,160 --> 00:16:35,069
<font color="#E5E5E5">great</font><font color="#CCCCCC"> if you want an interactive shell</font>

467
00:16:34,200 --> 00:16:36,420
and you<font color="#E5E5E5"> don't want</font><font color="#CCCCCC"> to do something</font>

468
00:16:35,070 --> 00:16:38,460
<font color="#E5E5E5">autonomous and you want to stay in for</font>

469
00:16:36,420 --> 00:16:40,709
like an hour<font color="#CCCCCC"> right what happens when you</font>

470
00:16:38,460 --> 00:16:43,290
want<font color="#CCCCCC"> to stay in</font><font color="#E5E5E5"> for three years you're</font>

471
00:16:40,710 --> 00:16:45,060
right in<font color="#E5E5E5"> the fucking disk</font><font color="#CCCCCC"> okay like okay</font>

472
00:16:43,290 --> 00:16:46,709
<font color="#CCCCCC">fine people don't really boot their</font>

473
00:16:45,060 --> 00:16:48,359
machines<font color="#CCCCCC"> often but like in three years</font>

474
00:16:46,710 --> 00:16:49,770
shit's getting rebooted<font color="#E5E5E5"> stuffs getting</font>

475
00:16:48,360 --> 00:16:51,000
restarted new packages are getting

476
00:16:49,770 --> 00:16:52,980
installed<font color="#E5E5E5"> and you want to stay</font><font color="#CCCCCC"> on that</font>

477
00:16:51,000 --> 00:16:54,960
<font color="#E5E5E5">device so persistence is a thing</font><font color="#CCCCCC"> right</font><font color="#E5E5E5"> I</font>

478
00:16:52,980 --> 00:17:00,090
mean yes<font color="#E5E5E5"> disk writing is a way to get</font>

479
00:16:54,960 --> 00:17:03,540
caught but fucking deal<font color="#E5E5E5"> obviously</font>

480
00:17:00,090 --> 00:17:05,850
persistence<font color="#CCCCCC"> has</font><font color="#E5E5E5"> problems</font><font color="#CCCCCC"> it's you know</font>

481
00:17:03,540 --> 00:17:07,170
<font color="#CCCCCC">disk writes are easy to catch it gets</font>

482
00:17:05,849 --> 00:17:09,089
commonly checked<font color="#CCCCCC"> it's it's really</font>

483
00:17:07,170 --> 00:17:10,290
effective man once you're on<font color="#E5E5E5"> disk</font><font color="#CCCCCC"> yeah</font>

484
00:17:09,089 --> 00:17:11,520
you're gonna<font color="#E5E5E5"> get caught but once you're</font>

485
00:17:10,290 --> 00:17:13,889
<font color="#E5E5E5">on disk you're on disk</font>

486
00:17:11,520 --> 00:17:16,109
nobody's getting rid of you there's

487
00:17:13,890 --> 00:17:17,310
multi-platform ways to get on<font color="#E5E5E5"> disk which</font>

488
00:17:16,109 --> 00:17:21,000
<font color="#CCCCCC">is what we're</font><font color="#E5E5E5"> going to talk</font><font color="#CCCCCC"> about in a</font>

489
00:17:17,310 --> 00:17:23,730
minute<font color="#CCCCCC"> mix is probably the easiest</font><font color="#E5E5E5"> hunt</font>

490
00:17:21,000 --> 00:17:26,250
<font color="#CCCCCC">it's persistence to</font><font color="#E5E5E5"> profile mostly</font>

491
00:17:23,730 --> 00:17:28,920
because everything<font color="#E5E5E5"> that's designed to</font>

492
00:17:26,250 --> 00:17:30,690
<font color="#E5E5E5">find on</font><font color="#CCCCCC"> disc persistence is generally</font>

493
00:17:28,920 --> 00:17:32,310
based on some level of signature and the

494
00:17:30,690 --> 00:17:33,330
problem with signatures is that really

495
00:17:32,310 --> 00:17:34,679
the<font color="#E5E5E5"> only way the industry has figured</font>

496
00:17:33,330 --> 00:17:37,199
out<font color="#E5E5E5"> how to verify signatures up the</font>

497
00:17:34,680 --> 00:17:38,430
chain<font color="#E5E5E5"> really is based on hardware</font><font color="#CCCCCC"> and</font>

498
00:17:37,200 --> 00:17:39,660
the problem with hardware<font color="#E5E5E5"> that gets</font>

499
00:17:38,430 --> 00:17:43,010
<font color="#E5E5E5">released with licensed software is that</font>

500
00:17:39,660 --> 00:17:45,840
<font color="#E5E5E5">nothing in Linux is licensed</font><font color="#CCCCCC"> like</font>

501
00:17:43,010 --> 00:17:48,330
<font color="#E5E5E5">there's</font><font color="#CCCCCC"> no</font><font color="#E5E5E5"> there's dragons they're like</font>

502
00:17:45,840 --> 00:17:51,149
no it's<font color="#CCCCCC"> not it's not practical people</font>

503
00:17:48,330 --> 00:17:54,629
<font color="#CCCCCC">don't do it you know it tends to be</font>

504
00:17:51,150 --> 00:17:56,130
quiet<font color="#CCCCCC"> so okay now</font><font color="#E5E5E5"> we're gonna mostly</font>

505
00:17:54,630 --> 00:17:57,240
<font color="#CCCCCC">gonna talk</font><font color="#E5E5E5"> about</font><font color="#CCCCCC"> resistance vectors and</font>

506
00:17:56,130 --> 00:17:58,530
then we're gonna talk<font color="#CCCCCC"> about intelligence</font>

507
00:17:57,240 --> 00:18:00,090
gathering vectors at the end of it<font color="#E5E5E5"> and</font>

508
00:17:58,530 --> 00:18:01,080
then there's some<font color="#CCCCCC"> general like don't do</font>

509
00:18:00,090 --> 00:18:04,470
this at the<font color="#CCCCCC"> end that's</font><font color="#E5E5E5"> pretty much the</font>

510
00:18:01,080 --> 00:18:06,510
talk so first vector<font color="#E5E5E5"> MBR so this is an</font>

511
00:18:04,470 --> 00:18:07,920
MBR<font color="#E5E5E5"> payload that</font><font color="#CCCCCC"> I wrote I don't know</font>

512
00:18:06,510 --> 00:18:11,700
maybe<font color="#E5E5E5"> three years ago it's incredibly</font>

513
00:18:07,920 --> 00:18:12,960
<font color="#E5E5E5">simple all it does is a</font><font color="#CCCCCC"> hello</font><font color="#E5E5E5"> display</font>

514
00:18:11,700 --> 00:18:14,940
this message down here root is only the

515
00:18:12,960 --> 00:18:16,350
beginning which is<font color="#E5E5E5"> not that big a deal</font>

516
00:18:14,940 --> 00:18:21,620
<font color="#E5E5E5">the bigger deal is</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> it never boots</font>

517
00:18:16,350 --> 00:18:23,969
your machine and this<font color="#E5E5E5"> is a primer</font>

518
00:18:21,620 --> 00:18:27,989
<font color="#CCCCCC">without</font><font color="#E5E5E5"> getting into more explanation</font>

519
00:18:23,970 --> 00:18:28,320
basically an MBR<font color="#E5E5E5"> is more or less</font><font color="#CCCCCC"> 512</font>

520
00:18:27,990 --> 00:18:29,670
bytes

521
00:18:28,320 --> 00:18:31,200
<font color="#CCCCCC">phyto bytes is the maximum but you have</font>

522
00:18:29,670 --> 00:18:31,940
to include a partition table if you<font color="#CCCCCC"> want</font>

523
00:18:31,200 --> 00:18:33,919
to get<font color="#E5E5E5"> fancy with it</font>

524
00:18:31,940 --> 00:18:35,570
can change<font color="#CCCCCC"> the partition</font><font color="#E5E5E5"> table during</font>

525
00:18:33,919 --> 00:18:37,279
<font color="#E5E5E5">your infection but basically this</font><font color="#CCCCCC"> is</font>

526
00:18:35,570 --> 00:18:38,539
where you started<font color="#E5E5E5"> if you wanted to that</font>

527
00:18:37,279 --> 00:18:40,690
<font color="#E5E5E5">this is this this is where I would start</font>

528
00:18:38,539 --> 00:18:42,590
<font color="#CCCCCC">if you wanted to write an MB our payload</font>

529
00:18:40,690 --> 00:18:46,669
<font color="#CCCCCC">anybody here not</font><font color="#E5E5E5"> know what a Master Boot</font>

530
00:18:42,590 --> 00:18:47,959
Record is<font color="#E5E5E5"> okay cool</font><font color="#CCCCCC"> so yeah I</font><font color="#E5E5E5"> mean I'll</font>

531
00:18:46,669 --> 00:18:49,279
publish the slides but that's a<font color="#CCCCCC"> that's a</font>

532
00:18:47,960 --> 00:18:51,409
quick like I would like to write<font color="#CCCCCC"> an BR</font>

533
00:18:49,279 --> 00:18:54,559
<font color="#CCCCCC">malware this is where we start in terms</font>

534
00:18:51,409 --> 00:18:55,490
of how do you<font color="#E5E5E5"> infect it on Windows it's</font>

535
00:18:54,559 --> 00:18:57,799
a little more difficult<font color="#E5E5E5"> you have to use</font>

536
00:18:55,490 --> 00:18:59,870
driver stuff which<font color="#E5E5E5"> I didn't bother on</font><font color="#CCCCCC"> OS</font>

537
00:18:57,799 --> 00:19:02,690
<font color="#CCCCCC">X it's not</font><font color="#E5E5E5"> really relevant because they</font>

538
00:18:59,870 --> 00:19:04,100
only use UEFI now so unless<font color="#E5E5E5"> you're going</font>

539
00:19:02,690 --> 00:19:05,720
<font color="#E5E5E5">after a legacy Apple devices which</font>

540
00:19:04,100 --> 00:19:08,120
statistically tend to not exist<font color="#E5E5E5"> in a</font>

541
00:19:05,720 --> 00:19:10,309
while anyway<font color="#E5E5E5"> fine for Linux it's fucking</font>

542
00:19:08,120 --> 00:19:11,539
great because all kinds<font color="#E5E5E5"> of Linux systems</font>

543
00:19:10,309 --> 00:19:13,158
still use backwards compatible<font color="#E5E5E5"> right</font>

544
00:19:11,539 --> 00:19:15,559
everybody's BIOS is not setting<font color="#E5E5E5"> you</font><font color="#CCCCCC"> if</font><font color="#E5E5E5"> I</font>

545
00:19:13,159 --> 00:19:17,149
only it's all set in UEFI<font color="#E5E5E5"> legacy the</font>

546
00:19:15,559 --> 00:19:18,980
legacy is so that you can<font color="#CCCCCC"> install a bun</font>

547
00:19:17,149 --> 00:19:20,209
<font color="#E5E5E5">to when you put your flash drive</font><font color="#CCCCCC"> in it</font>

548
00:19:18,980 --> 00:19:22,669
cuz so many of those things<font color="#E5E5E5"> are</font><font color="#CCCCCC"> not you</font>

549
00:19:20,210 --> 00:19:26,750
if I only<font color="#E5E5E5"> yeah unless your user is</font>

550
00:19:22,669 --> 00:19:29,539
locked down<font color="#E5E5E5"> this will copy a payload to</font>

551
00:19:26,750 --> 00:19:31,970
<font color="#CCCCCC">the beginning of a drive and now it's</font>

552
00:19:29,539 --> 00:19:33,769
done<font color="#E5E5E5"> but I've used this all the time</font>

553
00:19:31,970 --> 00:19:37,639
he's the CCDC I use this on jobs like

554
00:19:33,769 --> 00:19:39,889
it's fucking<font color="#E5E5E5"> awesome so moving on to</font>

555
00:19:37,639 --> 00:19:42,168
UEFI<font color="#CCCCCC"> the first thing that somebody</font><font color="#E5E5E5"> will</font>

556
00:19:39,889 --> 00:19:43,699
tell you about<font color="#E5E5E5"> UEFI persistence problems</font>

557
00:19:42,169 --> 00:19:45,470
it's like well what about secure boot it

558
00:19:43,700 --> 00:19:46,279
turns out secure boots implementation on

559
00:19:45,470 --> 00:19:49,429
pretty much every operating system

560
00:19:46,279 --> 00:19:51,110
besides<font color="#CCCCCC"> from OS X fucking sucks and</font>

561
00:19:49,429 --> 00:19:52,460
<font color="#CCCCCC">we'll</font><font color="#E5E5E5"> talk about why in</font><font color="#CCCCCC"> a minute and</font><font color="#E5E5E5"> the</font>

562
00:19:51,110 --> 00:19:54,889
great<font color="#E5E5E5"> thing is that writing a UEFI</font>

563
00:19:52,460 --> 00:19:56,570
binary<font color="#E5E5E5"> is way easier than writing an MBR</font>

564
00:19:54,889 --> 00:19:59,090
because it with an MBR you've got a

565
00:19:56,570 --> 00:20:00,529
<font color="#E5E5E5">limited you've got</font><font color="#CCCCCC"> BIOS real-mode you've</font>

566
00:19:59,090 --> 00:20:02,809
got a<font color="#E5E5E5"> limited amount of assembly you</font><font color="#CCCCCC"> can</font>

567
00:20:00,529 --> 00:20:05,570
fuck<font color="#E5E5E5"> with it</font><font color="#CCCCCC"> they're their rules</font><font color="#E5E5E5"> you</font>

568
00:20:02,809 --> 00:20:09,830
<font color="#E5E5E5">have fine it's fine Karl right I should</font>

569
00:20:05,570 --> 00:20:13,370
see<font color="#E5E5E5"> there you go</font><font color="#CCCCCC"> there's a hello world</font>

570
00:20:09,830 --> 00:20:17,269
you if I so fill print<font color="#CCCCCC"> l with do evil</font>

571
00:20:13,370 --> 00:20:18,529
<font color="#E5E5E5">shit here done because I should scroll</font>

572
00:20:17,269 --> 00:20:21,309
sideways<font color="#E5E5E5"> you can see the end of the</font>

573
00:20:18,529 --> 00:20:23,720
function<font color="#E5E5E5"> but that's pretty</font><font color="#CCCCCC"> much</font><font color="#E5E5E5"> it</font>

574
00:20:21,309 --> 00:20:25,549
<font color="#CCCCCC">UEFI on</font><font color="#E5E5E5"> a</font><font color="#CCCCCC"> Windows so this is great great</font>

575
00:20:23,720 --> 00:20:27,769
so<font color="#CCCCCC"> look let us go down the memory lane</font>

576
00:20:25,549 --> 00:20:29,809
of<font color="#E5E5E5"> the ways</font><font color="#CCCCCC"> Windows is completely fucked</font>

577
00:20:27,769 --> 00:20:35,110
UEFI on its own environment

578
00:20:29,809 --> 00:20:39,950
<font color="#E5E5E5">so first anybody remember the domain</font>

579
00:20:35,110 --> 00:20:42,740
<font color="#E5E5E5">2008 bug</font><font color="#CCCCCC"> where so like Microsoft</font>

580
00:20:39,950 --> 00:20:44,330
released this trick where we<font color="#CCCCCC"> release</font>

581
00:20:42,740 --> 00:20:45,559
<font color="#E5E5E5">this feature where</font>

582
00:20:44,330 --> 00:20:47,029
they wanted<font color="#E5E5E5"> to get rid</font><font color="#CCCCCC"> of the local</font>

583
00:20:45,559 --> 00:20:48,379
admin problem right so<font color="#CCCCCC"> look</font><font color="#E5E5E5"> you have</font><font color="#CCCCCC"> 802</font>

584
00:20:47,029 --> 00:20:49,610
an<font color="#E5E5E5"> X on your network but then like at</font>

585
00:20:48,380 --> 00:20:51,110
the<font color="#E5E5E5"> end of the day somebody's gonna just</font>

586
00:20:49,610 --> 00:20:53,870
take<font color="#CCCCCC"> Parker shit</font><font color="#E5E5E5"> and like it look alive</font>

587
00:20:51,110 --> 00:20:56,178
men and then fuck<font color="#E5E5E5"> right so they came out</font>

588
00:20:53,870 --> 00:20:59,830
with<font color="#E5E5E5"> this thing on 2008 where you could</font>

589
00:20:56,179 --> 00:21:03,769
give your GPO<font color="#E5E5E5"> unencrypted hash that only</font>

590
00:20:59,830 --> 00:21:06,080
Microsoft stuff<font color="#E5E5E5"> could decrypt and that</font>

591
00:21:03,769 --> 00:21:08,059
<font color="#CCCCCC">password would get set as the local</font>

592
00:21:06,080 --> 00:21:09,080
admin password as soon as they plug into

593
00:21:08,059 --> 00:21:11,658
the network<font color="#E5E5E5"> so that we didn't have</font><font color="#CCCCCC"> to</font>

594
00:21:09,080 --> 00:21:15,678
worry<font color="#E5E5E5"> about like get system me me cats</font>

595
00:21:11,659 --> 00:21:17,360
<font color="#E5E5E5">right which was a cool</font><font color="#CCCCCC"> idea and</font><font color="#E5E5E5"> then in</font>

596
00:21:15,679 --> 00:21:18,289
the help<font color="#E5E5E5"> manual like apparently when</font>

597
00:21:17,360 --> 00:21:19,879
they released<font color="#E5E5E5"> that feature the</font><font color="#CCCCCC"> original</font>

598
00:21:18,289 --> 00:21:22,220
<font color="#CCCCCC">plan was to make a button so that</font><font color="#E5E5E5"> you</font>

599
00:21:19,880 --> 00:21:23,149
could roll your seeds<font color="#E5E5E5"> predictable never</font>

600
00:21:22,220 --> 00:21:24,909
<font color="#E5E5E5">come out with that button and then they</font>

601
00:21:23,149 --> 00:21:27,260
publish<font color="#E5E5E5"> the key</font><font color="#CCCCCC"> in the help manual</font><font color="#E5E5E5"> oops</font>

602
00:21:24,909 --> 00:21:28,789
<font color="#CCCCCC">so it turns</font><font color="#E5E5E5"> out they did the same</font><font color="#CCCCCC"> fuckin</font>

603
00:21:27,260 --> 00:21:31,940
thing with<font color="#CCCCCC"> UEFI right where they were</font>

604
00:21:28,789 --> 00:21:33,950
like okay<font color="#E5E5E5"> here's sind stuff</font><font color="#CCCCCC"> in</font><font color="#E5E5E5"> all the</font>

605
00:21:31,940 --> 00:21:35,570
chips because<font color="#E5E5E5"> Intel sucks</font><font color="#CCCCCC"> are you know</font>

606
00:21:33,950 --> 00:21:38,720
<font color="#CCCCCC">we'd like Intel</font><font color="#E5E5E5"> and like everything's</font>

607
00:21:35,570 --> 00:21:39,799
cool<font color="#CCCCCC"> and you know we're</font><font color="#E5E5E5"> gonna sign all</font>

608
00:21:38,720 --> 00:21:43,370
<font color="#E5E5E5">of our images and</font><font color="#CCCCCC"> if you want to</font><font color="#E5E5E5"> sign</font>

609
00:21:39,799 --> 00:21:45,649
your<font color="#E5E5E5"> own here's the key oh shit so that</font>

610
00:21:43,370 --> 00:21:47,178
happened<font color="#CCCCCC"> and then</font><font color="#E5E5E5"> there was this policy</font>

611
00:21:45,649 --> 00:21:49,010
problem where they were<font color="#E5E5E5"> like</font><font color="#CCCCCC"> okay</font><font color="#E5E5E5"> we'll</font>

612
00:21:47,179 --> 00:21:51,649
<font color="#CCCCCC">fix</font><font color="#E5E5E5"> it well release this patch so that</font>

613
00:21:49,010 --> 00:21:53,240
<font color="#E5E5E5">you can only do that if you're an admin</font>

614
00:21:51,649 --> 00:21:54,918
on the system well the problem is<font color="#E5E5E5"> that</font>

615
00:21:53,240 --> 00:21:56,090
<font color="#E5E5E5">get system is really fucking easy and</font>

616
00:21:54,919 --> 00:21:57,980
there wasn't<font color="#CCCCCC"> really a way</font><font color="#E5E5E5"> to tell the</font>

617
00:21:56,090 --> 00:22:00,889
<font color="#CCCCCC">difference</font><font color="#E5E5E5"> between system and hardware</font>

618
00:21:57,980 --> 00:22:03,649
systems so<font color="#CCCCCC"> that patch didn't work and</font>

619
00:22:00,889 --> 00:22:07,189
they tried it<font color="#CCCCCC"> again which long story</font>

620
00:22:03,649 --> 00:22:08,658
short didn't work either<font color="#CCCCCC"> and now we're</font>

621
00:22:07,190 --> 00:22:11,090
at<font color="#E5E5E5"> this problem</font><font color="#CCCCCC"> where even if they</font>

622
00:22:08,659 --> 00:22:14,389
release<font color="#CCCCCC"> a patch tomorrow that fixes all</font>

623
00:22:11,090 --> 00:22:16,220
<font color="#CCCCCC">of the new signing key stuff so that</font>

624
00:22:14,389 --> 00:22:19,100
only<font color="#E5E5E5"> the appropriate people can sign</font>

625
00:22:16,220 --> 00:22:22,010
<font color="#E5E5E5">images there's still a bunch of</font><font color="#CCCCCC"> devices</font>

626
00:22:19,100 --> 00:22:23,629
in the wild<font color="#E5E5E5"> ie most of them that now you</font>

627
00:22:22,010 --> 00:22:25,309
can't revoke the old keys because

628
00:22:23,630 --> 00:22:26,899
<font color="#E5E5E5">they're still valid so really none</font><font color="#CCCCCC"> of</font>

629
00:22:25,309 --> 00:22:31,100
this<font color="#CCCCCC"> fucking matters because the old</font>

630
00:22:26,899 --> 00:22:33,408
keys gonna keep<font color="#CCCCCC"> working on Linux UEFI is</font>

631
00:22:31,100 --> 00:22:35,658
a fucking joke because in short<font color="#E5E5E5"> the way</font>

632
00:22:33,409 --> 00:22:37,100
you if I works is<font color="#E5E5E5"> that you you</font><font color="#CCCCCC"> enter</font>

633
00:22:35,659 --> 00:22:38,990
your<font color="#E5E5E5"> BIOS interface you tell it here's</font>

634
00:22:37,100 --> 00:22:43,699
my<font color="#E5E5E5"> key I'm gonna sign my UEFI image or</font>

635
00:22:38,990 --> 00:22:45,799
kernel with and then you boot and you

636
00:22:43,700 --> 00:22:47,179
know before<font color="#CCCCCC"> it boots your kernel it says</font>

637
00:22:45,799 --> 00:22:48,320
I'm gonna<font color="#E5E5E5"> take a signature yes that</font>

638
00:22:47,179 --> 00:22:50,179
<font color="#CCCCCC">signature is good I'll boot that</font>

639
00:22:48,320 --> 00:22:52,370
<font color="#CCCCCC">signature</font><font color="#E5E5E5"> that I won't the problem is</font>

640
00:22:50,179 --> 00:22:55,880
that<font color="#E5E5E5"> that means you need a way to give</font>

641
00:22:52,370 --> 00:22:57,959
your<font color="#E5E5E5"> BIOS a third party key or come with</font>

642
00:22:55,880 --> 00:23:00,659
a pre<font color="#CCCCCC"> signed image</font><font color="#E5E5E5"> well</font>

643
00:22:57,960 --> 00:23:01,909
<font color="#E5E5E5">okay really Linux consistency in the</font>

644
00:23:00,659 --> 00:23:04,320
kernel

645
00:23:01,909 --> 00:23:05,610
<font color="#CCCCCC">like on most operating systems it's</font>

646
00:23:04,320 --> 00:23:07,559
<font color="#E5E5E5">fucking compiled this party install so</font>

647
00:23:05,610 --> 00:23:09,209
how the hell you gonna<font color="#E5E5E5"> sign it</font><font color="#CCCCCC"> at the</font>

648
00:23:07,559 --> 00:23:10,860
end<font color="#E5E5E5"> of the day like yes there is a way</font>

649
00:23:09,210 --> 00:23:12,240
to do this right<font color="#E5E5E5"> nobody fucking does it</font>

650
00:23:10,860 --> 00:23:13,799
and on most<font color="#CCCCCC"> Hardware they don't have a</font>

651
00:23:12,240 --> 00:23:15,299
way<font color="#CCCCCC"> for</font><font color="#E5E5E5"> you to insert the key manually</font>

652
00:23:13,799 --> 00:23:16,710
so really until we're<font color="#E5E5E5"> ten years down the</font>

653
00:23:15,299 --> 00:23:19,590
line<font color="#E5E5E5"> and</font><font color="#CCCCCC"> people are logically being able</font>

654
00:23:16,710 --> 00:23:24,149
<font color="#E5E5E5">to implant UEFI keys just assume it's</font>

655
00:23:19,590 --> 00:23:26,399
not there because it isn't<font color="#CCCCCC"> Apple</font><font color="#E5E5E5"> yeah</font>

656
00:23:24,149 --> 00:23:29,549
good luck there you if I is crazy

657
00:23:26,399 --> 00:23:30,989
<font color="#E5E5E5">because they</font><font color="#CCCCCC"> own all</font><font color="#E5E5E5"> the chips on their</font>

658
00:23:29,549 --> 00:23:33,179
board and<font color="#E5E5E5"> so there's like system on</font>

659
00:23:30,990 --> 00:23:35,220
<font color="#CCCCCC">chips</font><font color="#E5E5E5"> that sign the</font><font color="#CCCCCC"> thing that signs</font><font color="#E5E5E5"> the</font>

660
00:23:33,179 --> 00:23:36,570
UEFI and it's their stuff out<font color="#E5E5E5"> there from</font>

661
00:23:35,220 --> 00:23:37,830
<font color="#CCCCCC">Dena</font><font color="#E5E5E5"> dies</font><font color="#CCCCCC"> OB</font><font color="#E5E5E5"> and a couple other badass</font>

662
00:23:36,570 --> 00:23:39,178
researchers<font color="#CCCCCC"> know how to do it but</font><font color="#E5E5E5"> like</font>

663
00:23:37,830 --> 00:23:43,110
in terms of<font color="#E5E5E5"> being easy to employ your</font>

664
00:23:39,179 --> 00:23:44,460
practical<font color="#E5E5E5"> but there's all</font><font color="#CCCCCC"> their ways to</font>

665
00:23:43,110 --> 00:23:46,729
<font color="#CCCCCC">fuck</font><font color="#E5E5E5"> with stuff on OSX so we'll talk</font>

666
00:23:44,460 --> 00:23:50,039
<font color="#CCCCCC">about</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> in a minute okay so another</font>

667
00:23:46,730 --> 00:23:53,390
persistence method is demonization<font color="#CCCCCC"> so</font>

668
00:23:50,039 --> 00:23:57,330
how do how to do persistent demonizes<font color="#CCCCCC"> in</font>

669
00:23:53,390 --> 00:23:59,159
anything that's<font color="#CCCCCC"> UNIX</font><font color="#E5E5E5"> based the</font>

670
00:23:57,330 --> 00:24:01,110
<font color="#CCCCCC">demonising that the</font><font color="#E5E5E5"> typical double</font><font color="#CCCCCC"> fork</font>

671
00:23:59,159 --> 00:24:04,230
is<font color="#E5E5E5"> gonna be your best bet</font><font color="#CCCCCC"> why because</font>

672
00:24:01,110 --> 00:24:07,199
most<font color="#CCCCCC"> linux stuff gets suspended not</font>

673
00:24:04,230 --> 00:24:10,140
rebooted<font color="#E5E5E5"> that's good because that means</font>

674
00:24:07,200 --> 00:24:11,490
<font color="#E5E5E5">orphan</font><font color="#CCCCCC"> processes survive so orphan</font>

675
00:24:10,140 --> 00:24:13,169
<font color="#E5E5E5">process</font><font color="#CCCCCC"> is just like this</font><font color="#E5E5E5"> simple easy</font>

676
00:24:11,490 --> 00:24:16,020
peasy<font color="#E5E5E5"> one two three of the way that you</font>

677
00:24:13,169 --> 00:24:18,960
do orphan<font color="#E5E5E5"> processes you you write</font><font color="#CCCCCC"> a fork</font>

678
00:24:16,020 --> 00:24:20,399
<font color="#E5E5E5">you set your</font><font color="#CCCCCC"> said you apply any signals</font>

679
00:24:18,960 --> 00:24:22,020
that you're gonna<font color="#E5E5E5"> use to control your</font>

680
00:24:20,399 --> 00:24:23,639
program<font color="#E5E5E5"> which is completely optional and</font>

681
00:24:22,020 --> 00:24:25,440
<font color="#E5E5E5">then you fork again</font><font color="#CCCCCC"> and when you fork</font>

682
00:24:23,640 --> 00:24:26,490
<font color="#CCCCCC">again you've distance yourself from the</font>

683
00:24:25,440 --> 00:24:28,049
terminal and<font color="#E5E5E5"> you've distance yourself</font>

684
00:24:26,490 --> 00:24:29,640
from the tty you exist as this orphan

685
00:24:28,049 --> 00:24:32,730
process controlled by whatever the init

686
00:24:29,640 --> 00:24:35,270
handler is another way<font color="#CCCCCC"> to do this is to</font>

687
00:24:32,730 --> 00:24:38,429
modify or implant your own in a<font color="#CCCCCC"> T script</font>

688
00:24:35,270 --> 00:24:42,480
<font color="#CCCCCC">here's</font><font color="#E5E5E5"> an example of a super like</font>

689
00:24:38,429 --> 00:24:44,370
bare-bones in addy script<font color="#CCCCCC"> yeah</font>

690
00:24:42,480 --> 00:24:46,799
you can add lines and stuff my favorite

691
00:24:44,370 --> 00:24:49,229
trick to do with these is<font color="#CCCCCC"> any time</font><font color="#E5E5E5"> you</font>

692
00:24:46,799 --> 00:24:54,360
find a explicit directory reference like

693
00:24:49,230 --> 00:24:56,399
here<font color="#CCCCCC"> you</font><font color="#E5E5E5"> can assign a directory path to</font>

694
00:24:54,360 --> 00:24:58,168
pipes and you can put those come up

695
00:24:56,399 --> 00:24:59,870
those pipes as commands<font color="#E5E5E5"> like you can</font>

696
00:24:58,169 --> 00:25:01,320
make like a shell<font color="#E5E5E5"> file be your pipe</font>

697
00:24:59,870 --> 00:25:06,600
<font color="#CCCCCC">funny</font><font color="#E5E5E5"> story</font>

698
00:25:01,320 --> 00:25:08,039
space is a valid directory path<font color="#CCCCCC"> as</font><font color="#E5E5E5"> a</font>

699
00:25:06,600 --> 00:25:09,418
<font color="#CCCCCC">fellow directory path in</font><font color="#E5E5E5"> Linux so you</font>

700
00:25:08,039 --> 00:25:10,860
can totally<font color="#CCCCCC"> have a directory that when</font>

701
00:25:09,419 --> 00:25:20,010
you hit LS just shows up as

702
00:25:10,860 --> 00:25:24,770
thing<font color="#E5E5E5"> just saying</font><font color="#CCCCCC"> next RCD</font><font color="#E5E5E5"> same kind of</font>

703
00:25:20,010 --> 00:25:27,840
<font color="#E5E5E5">deal yeah find a</font><font color="#CCCCCC"> Mexico defy it</font><font color="#E5E5E5"> or add</font>

704
00:25:24,770 --> 00:25:32,760
<font color="#E5E5E5">our CD script now your steps or step on</font>

705
00:25:27,840 --> 00:25:34,350
boot<font color="#CCCCCC"> system D fucking</font><font color="#E5E5E5"> system</font><font color="#CCCCCC"> D luckily</font>

706
00:25:32,760 --> 00:25:37,320
it's well documented<font color="#E5E5E5"> so pretty much like</font>

707
00:25:34,350 --> 00:25:42,840
<font color="#CCCCCC">follow</font><font color="#E5E5E5"> the instructions on how</font><font color="#CCCCCC"> to do</font>

708
00:25:37,320 --> 00:25:44,159
stuff<font color="#E5E5E5"> and this</font><font color="#CCCCCC"> is a cool little I didn't</font>

709
00:25:42,840 --> 00:25:46,918
know<font color="#E5E5E5"> that until I</font><font color="#CCCCCC"> started fucking with</font>

710
00:25:44,160 --> 00:25:48,570
it turns out that works or you<font color="#CCCCCC"> can add a</font>

711
00:25:46,919 --> 00:25:50,040
cron job<font color="#CCCCCC"> cron jobs</font><font color="#E5E5E5"> great for fireless</font>

712
00:25:48,570 --> 00:25:51,360
persistence<font color="#E5E5E5"> especially if you're dealing</font>

713
00:25:50,040 --> 00:25:53,220
<font color="#E5E5E5">with a system</font><font color="#CCCCCC"> that commonly has access</font>

714
00:25:51,360 --> 00:25:54,659
to<font color="#E5E5E5"> the</font><font color="#CCCCCC"> Internet because you can have</font><font color="#E5E5E5"> a</font>

715
00:25:53,220 --> 00:25:56,070
cron job<font color="#CCCCCC"> that pulls</font><font color="#E5E5E5"> down your payloads</font>

716
00:25:54,660 --> 00:25:57,270
dynamically<font color="#E5E5E5"> which is great because you</font>

717
00:25:56,070 --> 00:26:00,540
<font color="#CCCCCC">can add crypto stuff</font><font color="#E5E5E5"> which we'll talk</font>

718
00:25:57,270 --> 00:26:03,120
<font color="#CCCCCC">about later</font><font color="#E5E5E5"> all right so there's also</font>

719
00:26:00,540 --> 00:26:04,320
user space persistence<font color="#CCCCCC"> oh my god</font><font color="#E5E5E5"> so many</font>

720
00:26:03,120 --> 00:26:08,219
<font color="#E5E5E5">places to hide</font><font color="#CCCCCC"> in the Windows registry</font>

721
00:26:04,320 --> 00:26:11,010
<font color="#E5E5E5">so many um so these are</font><font color="#CCCCCC"> the default</font>

722
00:26:08,220 --> 00:26:12,570
<font color="#CCCCCC">Windows Keys on stuff that</font><font color="#E5E5E5"> starts up</font>

723
00:26:11,010 --> 00:26:14,160
when you start your computer<font color="#E5E5E5"> you can</font>

724
00:26:12,570 --> 00:26:15,809
<font color="#E5E5E5">modify the</font><font color="#CCCCCC"> pass you can</font><font color="#E5E5E5"> add stuff to the</font>

725
00:26:14,160 --> 00:26:18,900
<font color="#CCCCCC">past you just put an exe in there should</font>

726
00:26:15,809 --> 00:26:23,668
fucking work<font color="#E5E5E5"> boot execute is stuff that</font>

727
00:26:18,900 --> 00:26:26,940
<font color="#E5E5E5">explicitly operates on boot the user in</font>

728
00:26:23,669 --> 00:26:29,070
it is a lot<font color="#E5E5E5"> like user DLL or a pin at</font>

729
00:26:26,940 --> 00:26:32,280
DLL<font color="#E5E5E5"> basically you take a DLL you add it</font>

730
00:26:29,070 --> 00:26:34,710
to<font color="#CCCCCC"> this to this key and anytime I</font><font color="#E5E5E5"> think</font>

731
00:26:32,280 --> 00:26:36,780
it's<font color="#E5E5E5"> kernel32.dll</font><font color="#CCCCCC"> get to load it into a</font>

732
00:26:34,710 --> 00:26:38,820
program it also loads your<font color="#CCCCCC"> DOL so you</font>

733
00:26:36,780 --> 00:26:42,840
kind of you get deal shared object

734
00:26:38,820 --> 00:26:44,159
injection for free<font color="#CCCCCC"> notify any time</font>

735
00:26:42,840 --> 00:26:47,340
there's a notify signal on the system

736
00:26:44,160 --> 00:26:49,340
it'll inject whatever<font color="#CCCCCC"> that points to you</font>

737
00:26:47,340 --> 00:26:51,449
can modify the<font color="#CCCCCC"> Windows shell</font><font color="#E5E5E5"> period</font>

738
00:26:49,340 --> 00:26:53,428
<font color="#CCCCCC">because it turns out there for whatever</font>

739
00:26:51,450 --> 00:26:55,380
reason based<font color="#E5E5E5"> on its dependency issues it</font>

740
00:26:53,429 --> 00:26:57,480
<font color="#E5E5E5">doesn't sign itself all the</font><font color="#CCCCCC"> time like</font>

741
00:26:55,380 --> 00:26:58,830
<font color="#CCCCCC">it's context changes</font><font color="#E5E5E5"> I haven't really</font>

742
00:26:57,480 --> 00:27:00,150
figured out<font color="#E5E5E5"> how</font><font color="#CCCCCC"> to put that</font><font color="#E5E5E5"> in a simple</font>

743
00:26:58,830 --> 00:27:01,678
<font color="#E5E5E5">pill that I can deliver to you that's</font>

744
00:27:00,150 --> 00:27:03,120
<font color="#E5E5E5">measurable but trust me start fucking</font>

745
00:27:01,679 --> 00:27:04,290
with<font color="#CCCCCC"> the signatures on explored ie XE</font>

746
00:27:03,120 --> 00:27:05,520
<font color="#E5E5E5">and see how many times your computer</font>

747
00:27:04,290 --> 00:27:11,299
doesn't<font color="#E5E5E5"> shit the bed it's kind of</font>

748
00:27:05,520 --> 00:27:16,740
alarming default startup locations

749
00:27:11,299 --> 00:27:18,870
<font color="#E5E5E5">services so</font><font color="#CCCCCC"> windows services are</font><font color="#E5E5E5"> they're</font>

750
00:27:16,740 --> 00:27:20,400
<font color="#CCCCCC">basically just EAX ease with</font><font color="#E5E5E5"> okay so</font>

751
00:27:18,870 --> 00:27:21,959
like all PE files are<font color="#E5E5E5"> pretty much the</font>

752
00:27:20,400 --> 00:27:23,730
same<font color="#E5E5E5"> the only</font><font color="#CCCCCC"> difference is their entry</font>

753
00:27:21,960 --> 00:27:26,100
point<font color="#E5E5E5"> so an exe</font><font color="#CCCCCC"> typical</font><font color="#E5E5E5"> go has win</font>

754
00:27:23,730 --> 00:27:27,540
as an entry point a<font color="#E5E5E5"> DOL has ideal domain</font>

755
00:27:26,100 --> 00:27:29,240
as an entry point which<font color="#CCCCCC"> you can actually</font>

756
00:27:27,540 --> 00:27:31,500
<font color="#E5E5E5">change one into the other which I have</font>

757
00:27:29,240 --> 00:27:33,210
code to do and I was going to show you

758
00:27:31,500 --> 00:27:34,470
but again<font color="#E5E5E5"> I sold it and I actually asked</font>

759
00:27:33,210 --> 00:27:38,150
the<font color="#E5E5E5"> person I sold it to if I could show</font>

760
00:27:34,470 --> 00:27:40,470
it<font color="#CCCCCC"> and they were like no</font><font color="#E5E5E5"> so sorry um but</font>

761
00:27:38,150 --> 00:27:42,930
<font color="#CCCCCC">and Windows services are no exception</font>

762
00:27:40,470 --> 00:27:44,070
there's like a third you know this is a

763
00:27:42,930 --> 00:27:46,770
<font color="#CCCCCC">window</font><font color="#E5E5E5"> service there you go add these</font>

764
00:27:44,070 --> 00:27:47,850
three functions<font color="#CCCCCC"> do some stuff</font><font color="#E5E5E5"> and add</font>

765
00:27:46,770 --> 00:27:51,000
<font color="#E5E5E5">your service or the service directory</font>

766
00:27:47,850 --> 00:27:52,560
now you get loaded as<font color="#E5E5E5"> a service</font><font color="#CCCCCC"> these</font>

767
00:27:51,000 --> 00:27:53,820
are the registry<font color="#E5E5E5"> keys that initial a</font>

768
00:27:52,560 --> 00:27:55,710
background services this<font color="#E5E5E5"> is a good way</font>

769
00:27:53,820 --> 00:27:59,280
to<font color="#E5E5E5"> hide from some process managers or</font>

770
00:27:55,710 --> 00:28:03,390
pokémon<font color="#E5E5E5"> kind of thing</font><font color="#CCCCCC"> browser helper T</font>

771
00:27:59,280 --> 00:28:06,389
<font color="#E5E5E5">houses because this these are shared</font>

772
00:28:03,390 --> 00:28:07,770
<font color="#E5E5E5">objects they kept loaded</font><font color="#CCCCCC"> anytime</font><font color="#E5E5E5"> that a</font>

773
00:28:06,390 --> 00:28:10,500
web browser gets let you know typically

774
00:28:07,770 --> 00:28:12,900
<font color="#E5E5E5">ie gets loaded into memory right also</font>

775
00:28:10,500 --> 00:28:14,580
<font color="#E5E5E5">load your</font><font color="#CCCCCC"> DLLs what's</font><font color="#E5E5E5"> awesome it's like</font>

776
00:28:12,900 --> 00:28:15,870
<font color="#CCCCCC">a lot of</font><font color="#E5E5E5"> people like LastPass</font><font color="#CCCCCC"> and stuff</font>

777
00:28:14,580 --> 00:28:17,460
like that<font color="#E5E5E5"> right these password managers</font>

778
00:28:15,870 --> 00:28:18,899
that are<font color="#CCCCCC"> browser</font><font color="#E5E5E5"> specific</font><font color="#CCCCCC"> which means</font>

779
00:28:17,460 --> 00:28:20,910
they get mapped<font color="#E5E5E5"> into the browser memory</font>

780
00:28:18,900 --> 00:28:22,830
space<font color="#E5E5E5"> so you can</font><font color="#CCCCCC"> totally take</font>

781
00:28:20,910 --> 00:28:24,930
functionality out<font color="#CCCCCC"> of open</font><font color="#E5E5E5"> source code</font>

782
00:28:22,830 --> 00:28:27,720
like<font color="#E5E5E5"> oh I don't know recall and be like</font>

783
00:28:24,930 --> 00:28:30,000
hey load and then when you get loaded

784
00:28:27,720 --> 00:28:32,250
like totally<font color="#E5E5E5"> dump your process memory</font>

785
00:28:30,000 --> 00:28:34,440
<font color="#E5E5E5">and like HTTP POST it basic ste 4</font>

786
00:28:32,250 --> 00:28:36,930
encoded via image stenography<font color="#CCCCCC"> to like</font>

787
00:28:34,440 --> 00:28:39,480
evil<font color="#CCCCCC"> comm and then you just grep the</font>

788
00:28:36,930 --> 00:28:41,550
image for like all the LastPass

789
00:28:39,480 --> 00:28:43,230
passwords<font color="#E5E5E5"> and you couple that with a key</font>

790
00:28:41,550 --> 00:28:44,700
logger<font color="#CCCCCC"> and you go ok stop the key logger</font>

791
00:28:43,230 --> 00:28:45,990
for<font color="#CCCCCC"> 10 seconds</font><font color="#E5E5E5"> and then send me all that</font>

792
00:28:44,700 --> 00:28:49,580
data<font color="#E5E5E5"> and you take the passer and plug</font>

793
00:28:45,990 --> 00:28:49,580
into the<font color="#CCCCCC"> databases yeah all</font><font color="#E5E5E5"> the things</font>

794
00:28:49,850 --> 00:28:55,409
we talked<font color="#E5E5E5"> about</font><font color="#CCCCCC"> earlier this</font><font color="#E5E5E5"> is the same</font>

795
00:28:52,710 --> 00:28:57,360
thing as the other<font color="#E5E5E5"> registry key but I</font>

796
00:28:55,410 --> 00:29:00,690
think it's a user 32<font color="#E5E5E5"> anytime user 32</font>

797
00:28:57,360 --> 00:29:04,679
gets loaded it loads your<font color="#CCCCCC"> DLL app cert</font>

798
00:29:00,690 --> 00:29:05,820
dll's<font color="#E5E5E5"> is actually forget what</font><font color="#CCCCCC"> that was</font>

799
00:29:04,680 --> 00:29:07,680
<font color="#E5E5E5">sorry</font>

800
00:29:05,820 --> 00:29:09,689
anyway it's a path<font color="#E5E5E5"> that loads more</font><font color="#CCCCCC"> Delos</font>

801
00:29:07,680 --> 00:29:10,890
sorry this<font color="#E5E5E5"> isn't my laptop</font><font color="#CCCCCC"> I had speaker</font>

802
00:29:09,690 --> 00:29:14,190
notes<font color="#E5E5E5"> I don't have</font><font color="#CCCCCC"> access</font><font color="#E5E5E5"> to my speaker</font>

803
00:29:10,890 --> 00:29:16,650
notes<font color="#E5E5E5"> right now</font><font color="#CCCCCC"> file</font><font color="#E5E5E5"> Association this is</font>

804
00:29:14,190 --> 00:29:19,440
a cool one you change<font color="#E5E5E5"> like the dot docx</font>

805
00:29:16,650 --> 00:29:22,080
file Association<font color="#E5E5E5"> to like my evil program</font>

806
00:29:19,440 --> 00:29:24,270
which<font color="#E5E5E5"> then calls word so you get every</font>

807
00:29:22,080 --> 00:29:28,080
<font color="#CCCCCC">document</font><font color="#E5E5E5"> and contacts works really well</font>

808
00:29:24,270 --> 00:29:29,610
<font color="#E5E5E5">on like putty keys so anytime anybody</font>

809
00:29:28,080 --> 00:29:32,010
opens<font color="#E5E5E5"> this putty key call my thing that</font>

810
00:29:29,610 --> 00:29:36,360
steals at first

811
00:29:32,010 --> 00:29:36,980
SCP host<font color="#E5E5E5"> turns out like yeah</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> CB host</font>

812
00:29:36,360 --> 00:29:38,479
is totally

813
00:29:36,980 --> 00:29:39,799
<font color="#CCCCCC">and it's supposed to sign stuff but it</font>

814
00:29:38,480 --> 00:29:43,190
totally<font color="#E5E5E5"> doesn't this is there's a really</font>

815
00:29:39,799 --> 00:29:44,990
<font color="#CCCCCC">great blog</font><font color="#E5E5E5"> from</font><font color="#CCCCCC"> a live attack that</font>

816
00:29:43,190 --> 00:29:47,450
somebody found<font color="#E5E5E5"> on the wild silence</font><font color="#CCCCCC"> that</font>

817
00:29:44,990 --> 00:29:49,330
covers a CBS<font color="#E5E5E5"> CB host is basically the</font>

818
00:29:47,450 --> 00:29:52,220
Windows executable that starts<font color="#CCCCCC"> system</font>

819
00:29:49,330 --> 00:29:54,110
services<font color="#E5E5E5"> so you</font><font color="#CCCCCC"> can</font><font color="#E5E5E5"> change you</font><font color="#CCCCCC"> can add</font>

820
00:29:52,220 --> 00:29:55,730
passes<font color="#CCCCCC"> you can add paths and say hey</font>

821
00:29:54,110 --> 00:29:57,740
when<font color="#E5E5E5"> the service gets loaded also load</font>

822
00:29:55,730 --> 00:29:58,360
this<font color="#CCCCCC"> DLL</font><font color="#E5E5E5"> or you can add services in</font>

823
00:29:57,740 --> 00:30:01,519
general

824
00:29:58,360 --> 00:30:03,469
<font color="#E5E5E5">WMI I actually didn't until I was doing</font>

825
00:30:01,519 --> 00:30:05,929
research<font color="#CCCCCC"> for this talk know that WM I</font>

826
00:30:03,470 --> 00:30:08,000
could be used<font color="#E5E5E5"> for persistence</font><font color="#CCCCCC"> that</font>

827
00:30:05,929 --> 00:30:10,429
<font color="#CCCCCC">survives reboots turns out it totally</font>

828
00:30:08,000 --> 00:30:12,320
can so you use a reboot or<font color="#E5E5E5"> you use WMI</font>

829
00:30:10,429 --> 00:30:14,299
<font color="#E5E5E5">command to like set a scheduled</font><font color="#CCCCCC"> tasks</font>

830
00:30:12,320 --> 00:30:15,769
which like adds credit or downloads or

831
00:30:14,299 --> 00:30:17,629
does whatever shady stuff<font color="#E5E5E5"> you want to do</font>

832
00:30:15,769 --> 00:30:19,820
and then at the end it<font color="#CCCCCC"> says run another</font>

833
00:30:17,630 --> 00:30:22,130
<font color="#CCCCCC">WMI command and if that</font><font color="#E5E5E5"> WI command is a</font>

834
00:30:19,820 --> 00:30:24,500
scheduled<font color="#CCCCCC"> task</font><font color="#E5E5E5"> you can set it for run</font>

835
00:30:22,130 --> 00:30:27,200
after reboot so then the next<font color="#E5E5E5"> time it</font>

836
00:30:24,500 --> 00:30:30,740
reboots it adds itself<font color="#E5E5E5"> so if your run</font>

837
00:30:27,200 --> 00:30:32,299
<font color="#E5E5E5">time doesn't use files</font><font color="#CCCCCC"> then you can</font>

838
00:30:30,740 --> 00:30:34,460
<font color="#CCCCCC">basically have</font><font color="#E5E5E5"> a</font><font color="#CCCCCC"> WMI command</font><font color="#E5E5E5"> that never</font>

839
00:30:32,299 --> 00:30:36,110
dies it just survives one reboot to make

840
00:30:34,460 --> 00:30:37,880
<font color="#E5E5E5">itself</font><font color="#CCCCCC"> last the next one which is kind</font>

841
00:30:36,110 --> 00:30:39,678
<font color="#CCCCCC">of Awesome there's a</font><font color="#E5E5E5"> really awesome</font>

842
00:30:37,880 --> 00:30:40,880
black guy talk on how to do this all the

843
00:30:39,679 --> 00:30:42,700
<font color="#CCCCCC">other there's like</font><font color="#E5E5E5"> this is built in the</font>

844
00:30:40,880 --> 00:30:44,809
<font color="#E5E5E5">Metasploit this is built into like</font>

845
00:30:42,700 --> 00:30:46,130
cobalt strike and a bunch of other like

846
00:30:44,809 --> 00:30:47,059
basic tools now so like<font color="#E5E5E5"> I highly</font>

847
00:30:46,130 --> 00:30:48,350
recommend<font color="#CCCCCC"> just going</font><font color="#E5E5E5"> to look at their</font>

848
00:30:47,059 --> 00:30:49,639
source<font color="#E5E5E5"> to find out how it works but if</font>

849
00:30:48,350 --> 00:30:50,629
you<font color="#E5E5E5"> want to however</font><font color="#CCCCCC"> under</font><font color="#E5E5E5"> the hood this</font>

850
00:30:49,639 --> 00:30:53,299
<font color="#E5E5E5">is the black</font><font color="#CCCCCC"> guy thought that'll tell</font>

851
00:30:50,630 --> 00:30:56,419
you<font color="#E5E5E5"> how to do it</font><font color="#CCCCCC"> I didn't</font><font color="#E5E5E5"> think it is</font>

852
00:30:53,299 --> 00:30:58,639
and then you know<font color="#E5E5E5"> just props to to Chris</font>

853
00:30:56,419 --> 00:31:01,010
<font color="#E5E5E5">so</font><font color="#CCCCCC"> I asked on Twitter like hey file is</font>

854
00:30:58,639 --> 00:31:02,269
<font color="#CCCCCC">WMI backdoors like don't survive a</font>

855
00:31:01,010 --> 00:31:04,908
reboot right and he was<font color="#E5E5E5"> like oh yeah</font>

856
00:31:02,269 --> 00:31:06,110
<font color="#E5E5E5">just use PowerShell well</font><font color="#CCCCCC"> eww my command</font>

857
00:31:04,909 --> 00:31:08,950
<font color="#E5E5E5">calls</font><font color="#CCCCCC"> PowerShell</font><font color="#E5E5E5"> PowerShell calls me</font>

858
00:31:06,110 --> 00:31:08,949
cats do all<font color="#E5E5E5"> the things</font>

859
00:31:19,370 --> 00:31:25,439
<font color="#E5E5E5">all right I'm trying</font><font color="#CCCCCC"> to go fast so</font>

860
00:31:23,340 --> 00:31:28,709
<font color="#E5E5E5">shortcut hijacks like change the dot</font>

861
00:31:25,440 --> 00:31:31,110
link<font color="#CCCCCC"> oh and all the things right</font><font color="#E5E5E5"> and</font>

862
00:31:28,710 --> 00:31:34,169
change<font color="#E5E5E5"> this call my shape have my shit</font>

863
00:31:31,110 --> 00:31:35,908
called the original<font color="#E5E5E5"> DLL hijacking so</font>

864
00:31:34,169 --> 00:31:38,220
this is the hierarchy<font color="#CCCCCC"> in which</font><font color="#E5E5E5"> every</font>

865
00:31:35,909 --> 00:31:40,080
shared object gets loaded on<font color="#E5E5E5"> Windows</font><font color="#CCCCCC"> in</font>

866
00:31:38,220 --> 00:31:41,970
order so if you<font color="#E5E5E5"> change if you add one</font>

867
00:31:40,080 --> 00:31:45,360
here or you change one before it gets to

868
00:31:41,970 --> 00:31:46,620
<font color="#E5E5E5">the real one yours wins</font><font color="#CCCCCC"> you can back to</font>

869
00:31:45,360 --> 00:31:48,299
<font color="#E5E5E5">where the PE file which</font><font color="#CCCCCC"> okay so now</font>

870
00:31:46,620 --> 00:31:49,260
we're gonna<font color="#E5E5E5"> talk about</font><font color="#CCCCCC"> Co caves which I</font>

871
00:31:48,299 --> 00:31:50,370
mentioned<font color="#CCCCCC"> earlier when I was</font><font color="#E5E5E5"> like on my</font>

872
00:31:49,260 --> 00:31:51,690
back<font color="#CCCCCC"> door factory this is essentially</font>

873
00:31:50,370 --> 00:31:55,620
how<font color="#E5E5E5"> back to our factory works on all of</font>

874
00:31:51,690 --> 00:31:57,269
its subs<font color="#E5E5E5"> so somewhere in the rat's nest</font>

875
00:31:55,620 --> 00:31:58,678
of<font color="#E5E5E5"> a program it's executing and</font>

876
00:31:57,269 --> 00:32:01,110
<font color="#E5E5E5">somewhere there is assembly that says</font>

877
00:31:58,679 --> 00:32:03,539
jump somewhere<font color="#CCCCCC"> right and that somewhere</font>

878
00:32:01,110 --> 00:32:05,250
does some<font color="#E5E5E5"> I should go back jumps to a</font>

879
00:32:03,539 --> 00:32:06,899
place usually<font color="#CCCCCC"> a function</font><font color="#E5E5E5"> some stuff</font>

880
00:32:05,250 --> 00:32:10,230
happens and then it like pop up<font color="#E5E5E5"> right go</font>

881
00:32:06,899 --> 00:32:12,090
back<font color="#CCCCCC"> to</font><font color="#E5E5E5"> where you were</font><font color="#CCCCCC"> basically you</font>

882
00:32:10,230 --> 00:32:15,090
<font color="#E5E5E5">take that jump and you make it jump</font><font color="#CCCCCC"> to</font>

883
00:32:12,090 --> 00:32:16,379
my code your code calls<font color="#E5E5E5"> the original</font>

884
00:32:15,090 --> 00:32:20,010
code and then the<font color="#CCCCCC"> original code jumps</font>

885
00:32:16,380 --> 00:32:21,090
back<font color="#E5E5E5"> to where it was</font><font color="#CCCCCC"> yeah that pretty</font>

886
00:32:20,010 --> 00:32:22,799
<font color="#CCCCCC">much works on everything</font><font color="#E5E5E5"> because</font><font color="#CCCCCC"> that's</font>

887
00:32:21,090 --> 00:32:26,010
<font color="#E5E5E5">how something works</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> just changed the</font>

888
00:32:22,799 --> 00:32:28,590
<font color="#E5E5E5">jump vector and this is where I talk</font>

889
00:32:26,010 --> 00:32:29,879
<font color="#CCCCCC">about like the</font><font color="#E5E5E5"> modern this is this is</font>

890
00:32:28,590 --> 00:32:31,110
pretty<font color="#E5E5E5"> much like if you want if you want</font>

891
00:32:29,880 --> 00:32:32,220
to<font color="#E5E5E5"> back</font><font color="#CCCCCC"> to our file</font><font color="#E5E5E5"> and you don't to</font><font color="#CCCCCC"> get</font>

892
00:32:31,110 --> 00:32:34,289
<font color="#E5E5E5">code this is what you do on</font><font color="#CCCCCC"> Windows</font>

893
00:32:32,220 --> 00:32:38,970
right<font color="#E5E5E5"> now who's totally where is</font><font color="#CCCCCC"> fuckin</font>

894
00:32:34,289 --> 00:32:41,070
scandalous<font color="#CCCCCC"> so Linux</font><font color="#E5E5E5"> so you can only</font>

895
00:32:38,970 --> 00:32:43,049
preload stuff this is a github<font color="#E5E5E5"> for an LD</font>

896
00:32:41,070 --> 00:32:44,668
preload backdoor<font color="#E5E5E5"> go look it up I'm not</font>

897
00:32:43,049 --> 00:32:45,629
<font color="#E5E5E5">gonna bother pasting it here</font><font color="#CCCCCC"> kernel</font>

898
00:32:44,669 --> 00:32:47,100
module you can<font color="#E5E5E5"> write it back to our</font>

899
00:32:45,630 --> 00:32:48,120
kernel module this<font color="#E5E5E5"> is</font><font color="#CCCCCC"> a POC kernel</font>

900
00:32:47,100 --> 00:32:51,019
module<font color="#E5E5E5"> that's totally free on the</font>

901
00:32:48,120 --> 00:32:53,699
internet<font color="#E5E5E5"> totally use</font><font color="#CCCCCC"> it nothing</font><font color="#E5E5E5"> finds it</font>

902
00:32:51,019 --> 00:32:55,500
kernel modification<font color="#E5E5E5"> you can</font><font color="#CCCCCC"> actually</font>

903
00:32:53,700 --> 00:32:57,480
<font color="#E5E5E5">replace the kernel</font><font color="#CCCCCC"> itself I've</font><font color="#E5E5E5"> totally</font>

904
00:32:55,500 --> 00:32:58,950
on gigs been like oh I went<font color="#E5E5E5"> to</font><font color="#CCCCCC"> backdoor</font>

905
00:32:57,480 --> 00:33:00,720
<font color="#E5E5E5">this kernel</font><font color="#CCCCCC"> oh is the kernel source on</font>

906
00:32:58,950 --> 00:33:01,950
<font color="#E5E5E5">this box</font><font color="#CCCCCC"> sweet I'll just add my back to</font>

907
00:33:00,720 --> 00:33:06,899
one of<font color="#E5E5E5"> the source and then recompile it</font>

908
00:33:01,950 --> 00:33:08,580
with their<font color="#CCCCCC"> fucking compiler cisco</font>

909
00:33:06,899 --> 00:33:10,139
hijacking cisco hijacking is a little

910
00:33:08,580 --> 00:33:11,668
harder<font color="#CCCCCC"> i don't</font><font color="#E5E5E5"> actually know if this is</font>

911
00:33:10,139 --> 00:33:13,469
<font color="#E5E5E5">in back to our factory or not</font><font color="#CCCCCC"> i think it</font>

912
00:33:11,669 --> 00:33:14,760
either is or me and Josh we're talking

913
00:33:13,470 --> 00:33:16,610
about<font color="#E5E5E5"> putting it in there and we didn't</font>

914
00:33:14,760 --> 00:33:20,250
or something like<font color="#E5E5E5"> that</font>

915
00:33:16,610 --> 00:33:22,229
basically you<font color="#CCCCCC"> backdoor the kernel which</font>

916
00:33:20,250 --> 00:33:23,460
is<font color="#E5E5E5"> essentially an elf</font><font color="#CCCCCC"> which I'll</font><font color="#E5E5E5"> talk</font>

917
00:33:22,230 --> 00:33:26,070
about how to<font color="#E5E5E5"> do a standard</font><font color="#CCCCCC"> helped back</font>

918
00:33:23,460 --> 00:33:27,240
<font color="#E5E5E5">to</font><font color="#CCCCCC"> one a minute to change a syscall</font>

919
00:33:26,070 --> 00:33:27,980
<font color="#E5E5E5">direction so you have</font><font color="#CCCCCC"> syscalls alright</font>

920
00:33:27,240 --> 00:33:30,230
<font color="#E5E5E5">like one is right</font>

921
00:33:27,980 --> 00:33:32,299
<font color="#CCCCCC">two three</font><font color="#E5E5E5"> whatever and you say okay no</font>

922
00:33:30,230 --> 00:33:35,179
instead of pointing to<font color="#E5E5E5"> this as we point</font>

923
00:33:32,299 --> 00:33:37,309
here and<font color="#E5E5E5"> you add a section to the exe or</font>

924
00:33:35,179 --> 00:33:39,110
to the elf<font color="#CCCCCC"> that says do some evil code</font>

925
00:33:37,309 --> 00:33:40,610
and then you call the original<font color="#CCCCCC"> place</font>

926
00:33:39,110 --> 00:33:41,659
that<font color="#CCCCCC"> we're supposed</font><font color="#E5E5E5"> to call this is call</font>

927
00:33:40,610 --> 00:33:44,389
and now that's<font color="#E5E5E5"> this call is your</font>

928
00:33:41,660 --> 00:33:45,440
<font color="#CCCCCC">backdoor this</font><font color="#E5E5E5"> is I'm gonna fly through</font>

929
00:33:44,390 --> 00:33:47,540
these<font color="#E5E5E5"> because</font><font color="#CCCCCC"> we ran out of</font><font color="#E5E5E5"> time but</font>

930
00:33:45,440 --> 00:33:49,700
this<font color="#CCCCCC"> is</font><font color="#E5E5E5"> like elf backdoor and 101 you</font>

931
00:33:47,540 --> 00:33:51,320
basically<font color="#E5E5E5"> change the the header table</font>

932
00:33:49,700 --> 00:33:52,910
<font color="#E5E5E5">and the section table to add a section</font>

933
00:33:51,320 --> 00:33:54,980
<font color="#E5E5E5">and then in that section</font><font color="#CCCCCC"> you hide your</font>

934
00:33:52,910 --> 00:33:57,830
shit and<font color="#E5E5E5"> then if you're</font><font color="#CCCCCC"> dealing with a</font>

935
00:33:54,980 --> 00:34:00,590
compressed kernel then that elf<font color="#E5E5E5"> is the</font>

936
00:33:57,830 --> 00:34:03,470
is this VM is this this is<font color="#E5E5E5"> your elf</font><font color="#CCCCCC"> so</font>

937
00:34:00,590 --> 00:34:06,530
you unzip<font color="#CCCCCC"> that you know modify</font><font color="#E5E5E5"> your elf</font>

938
00:34:03,470 --> 00:34:10,040
stick it back in<font color="#CCCCCC"> at there you can patch</font>

939
00:34:06,530 --> 00:34:13,369
spam<font color="#E5E5E5"> these are two source examples of</font>

940
00:34:10,040 --> 00:34:15,619
modifying<font color="#E5E5E5"> Pam and Linux to do shady shit</font>

941
00:34:13,369 --> 00:34:18,100
<font color="#CCCCCC">like every</font><font color="#E5E5E5"> time the password has changed</font>

942
00:34:15,619 --> 00:34:21,080
<font color="#CCCCCC">send it to me over some covert channel</font>

943
00:34:18,100 --> 00:34:24,290
<font color="#CCCCCC">you can use set unique set</font><font color="#E5E5E5"> UID</font><font color="#CCCCCC"> root</font>

944
00:34:21,080 --> 00:34:26,899
binaries which is you modify a non root

945
00:34:24,290 --> 00:34:28,369
binary to run as root<font color="#E5E5E5"> and then not lose</font>

946
00:34:26,899 --> 00:34:30,319
those permissive permissions<font color="#E5E5E5"> when it</font>

947
00:34:28,369 --> 00:34:31,730
exits this is a really good example<font color="#E5E5E5"> of</font>

948
00:34:30,320 --> 00:34:33,320
<font color="#CCCCCC">how</font><font color="#E5E5E5"> to use</font><font color="#CCCCCC"> that to produce a backdoor</font>

949
00:34:31,730 --> 00:34:34,580
<font color="#E5E5E5">and this is kind of the</font><font color="#CCCCCC"> example of like</font>

950
00:34:33,320 --> 00:34:38,060
once a box is owned it can never<font color="#E5E5E5"> really</font>

951
00:34:34,580 --> 00:34:39,918
be uh known<font color="#E5E5E5"> elf backdoor you can back</font><font color="#CCCCCC"> to</font>

952
00:34:38,060 --> 00:34:41,509
<font color="#CCCCCC">run elf itself a backdoor LS or backdoor</font>

953
00:34:39,918 --> 00:34:45,168
load again backdoor<font color="#CCCCCC"> factor</font><font color="#E5E5E5"> you learn how</font>

954
00:34:41,510 --> 00:34:46,609
to do it oh it's next user space<font color="#CCCCCC"> so this</font>

955
00:34:45,168 --> 00:34:48,109
is supposed to be<font color="#E5E5E5"> hard because of this</font>

956
00:34:46,609 --> 00:34:49,609
thing called sip which is like system

957
00:34:48,109 --> 00:34:50,750
intercept some crap I keep forgetting

958
00:34:49,609 --> 00:34:53,869
what the acronym names but basically

959
00:34:50,750 --> 00:34:56,149
it's only<font color="#E5E5E5"> OSX stuff is supposed to be</font>

960
00:34:53,869 --> 00:35:00,320
able to<font color="#E5E5E5"> write to special places on the</font>

961
00:34:56,149 --> 00:35:01,609
OS X file system the<font color="#CCCCCC"> problem is is that</font>

962
00:35:00,320 --> 00:35:03,140
applications are<font color="#E5E5E5"> allowed to register</font>

963
00:35:01,609 --> 00:35:07,460
<font color="#E5E5E5">supplications so if you pop an</font>

964
00:35:03,140 --> 00:35:09,200
application who fucking cares<font color="#CCCCCC"> you can</font>

965
00:35:07,460 --> 00:35:10,820
write a car module<font color="#CCCCCC"> they call them K</font>

966
00:35:09,200 --> 00:35:11,960
extensions or kernel extensions but it's

967
00:35:10,820 --> 00:35:14,750
just<font color="#CCCCCC"> coral module and you pretty much</font>

968
00:35:11,960 --> 00:35:16,760
isn't say miss<font color="#E5E5E5"> calls</font><font color="#CCCCCC"> you can backdoor</font>

969
00:35:14,750 --> 00:35:18,020
<font color="#CCCCCC">Amoco a file</font><font color="#E5E5E5"> itself again read back</font>

970
00:35:16,760 --> 00:35:20,960
<font color="#E5E5E5">their factory it totally</font><font color="#CCCCCC"> doesn't for you</font>

971
00:35:18,020 --> 00:35:24,470
you can<font color="#E5E5E5"> add</font><font color="#CCCCCC"> launch hds this is what a</font>

972
00:35:20,960 --> 00:35:25,970
launch HD daemon looks like again

973
00:35:24,470 --> 00:35:27,319
there's a path to an<font color="#E5E5E5"> example script and</font>

974
00:35:25,970 --> 00:35:28,430
<font color="#CCCCCC">that script can be an Apple script and</font>

975
00:35:27,320 --> 00:35:29,510
there's all kinds of<font color="#E5E5E5"> documentation on</font>

976
00:35:28,430 --> 00:35:30,950
how to<font color="#E5E5E5"> do horrible things on Apple</font>

977
00:35:29,510 --> 00:35:32,630
script and this is a cool trick<font color="#CCCCCC"> for</font>

978
00:35:30,950 --> 00:35:34,279
anybody<font color="#E5E5E5"> that decides to do that because</font>

979
00:35:32,630 --> 00:35:35,720
by default<font color="#E5E5E5"> loading an Apple script or</font>

980
00:35:34,280 --> 00:35:38,050
load a terminal window<font color="#E5E5E5"> that makes it not</font>

981
00:35:35,720 --> 00:35:38,049
do that

982
00:35:38,680 --> 00:35:42,910
you can add a<font color="#E5E5E5"> login hook Apple actually</font>

983
00:35:41,170 --> 00:35:44,260
documents how to add a<font color="#E5E5E5"> login hooks this</font>

984
00:35:42,910 --> 00:35:47,078
is deprecated<font color="#E5E5E5"> but still tends to work</font>

985
00:35:44,260 --> 00:35:51,490
<font color="#E5E5E5">use it</font><font color="#CCCCCC"> or</font><font color="#E5E5E5"> you can do constant process</font>

986
00:35:47,079 --> 00:35:52,839
migration which it's<font color="#E5E5E5"> messy</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> typically</font>

987
00:35:51,490 --> 00:35:54,368
<font color="#E5E5E5">involves some level</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> memory corruption</font>

988
00:35:52,839 --> 00:35:55,420
<font color="#E5E5E5">so I don't really</font><font color="#CCCCCC"> abdicate</font><font color="#E5E5E5"> using it</font>

989
00:35:54,369 --> 00:35:57,040
which is why I didn't<font color="#E5E5E5"> really get into</font>

990
00:35:55,420 --> 00:35:59,589
the weeds on how to do it<font color="#E5E5E5"> credential</font>

991
00:35:57,040 --> 00:36:00,910
access is great credential accesses can

992
00:35:59,589 --> 00:36:01,960
be a double-edged sword<font color="#E5E5E5"> especially if</font>

993
00:36:00,910 --> 00:36:03,220
you're accessing<font color="#CCCCCC"> third-party resources</font>

994
00:36:01,960 --> 00:36:04,359
<font color="#E5E5E5">right look you steal somebody's gmail</font>

995
00:36:03,220 --> 00:36:06,220
creds but every<font color="#E5E5E5"> time you log in</font><font color="#CCCCCC"> their</font>

996
00:36:04,359 --> 00:36:07,480
email your<font color="#CCCCCC"> locations</font><font color="#E5E5E5"> gonna be known so</font>

997
00:36:06,220 --> 00:36:09,399
that's when you do things like<font color="#E5E5E5"> leave a</font>

998
00:36:07,480 --> 00:36:11,200
proxy on<font color="#CCCCCC"> their box that's HTTP but that</font>

999
00:36:09,400 --> 00:36:12,700
way<font color="#CCCCCC"> you can give it a job and</font><font color="#E5E5E5"> tell it</font>

1000
00:36:11,200 --> 00:36:14,529
hey the next<font color="#CCCCCC"> time you check email</font><font color="#E5E5E5"> make a</font>

1001
00:36:12,700 --> 00:36:16,810
copy<font color="#E5E5E5"> of it for me because</font><font color="#CCCCCC"> you don't</font><font color="#E5E5E5"> want</font>

1002
00:36:14,530 --> 00:36:18,880
to get caught<font color="#CCCCCC"> in our logs phone</font><font color="#E5E5E5"> backup</font>

1003
00:36:16,810 --> 00:36:21,369
files are a great one<font color="#CCCCCC"> especially</font><font color="#E5E5E5"> since</font>

1004
00:36:18,880 --> 00:36:23,079
most people<font color="#CCCCCC"> actually don't encrypt their</font>

1005
00:36:21,369 --> 00:36:24,339
phone backup files they're supposed to

1006
00:36:23,079 --> 00:36:26,230
<font color="#E5E5E5">there's tons of functionality to do it</font>

1007
00:36:24,339 --> 00:36:28,450
but<font color="#CCCCCC"> because</font><font color="#E5E5E5"> it takes longer to UNCHR it</font>

1008
00:36:26,230 --> 00:36:31,540
or to decrypt<font color="#E5E5E5"> and then to update a phone</font>

1009
00:36:28,450 --> 00:36:34,299
a lot<font color="#E5E5E5"> of people don't do it</font><font color="#CCCCCC"> so you can</font>

1010
00:36:31,540 --> 00:36:36,579
find a<font color="#E5E5E5"> backup file on disk and what I</font>

1011
00:36:34,300 --> 00:36:38,859
want to do since phones get weird in

1012
00:36:36,579 --> 00:36:42,490
terms of environment change<font color="#E5E5E5"> is hide code</font>

1013
00:36:38,859 --> 00:36:45,910
on the phone back up<font color="#CCCCCC"> such that</font><font color="#E5E5E5"> the</font>

1014
00:36:42,490 --> 00:36:47,799
loader<font color="#E5E5E5"> in like for example</font><font color="#CCCCCC"> iTunes well</font>

1015
00:36:45,910 --> 00:36:49,598
<font color="#E5E5E5">execute machine code when it purses the</font>

1016
00:36:47,800 --> 00:36:50,710
download but it won't go to<font color="#E5E5E5"> the phone so</font>

1017
00:36:49,599 --> 00:36:51,579
the phone is<font color="#E5E5E5"> holding this code that</font>

1018
00:36:50,710 --> 00:36:52,480
effectively does nothing to<font color="#E5E5E5"> the phone</font>

1019
00:36:51,579 --> 00:36:54,490
but<font color="#E5E5E5"> as soon as they plug the phone into</font>

1020
00:36:52,480 --> 00:36:56,440
the computer and they say make me an

1021
00:36:54,490 --> 00:36:57,759
image<font color="#CCCCCC"> write it</font><font color="#E5E5E5"> references the old image</font>

1022
00:36:56,440 --> 00:37:00,520
and in loading the old image<font color="#CCCCCC"> a trencher</font>

1023
00:36:57,760 --> 00:37:03,130
exploit<font color="#E5E5E5"> which I had source to do but I'm</font>

1024
00:37:00,520 --> 00:37:05,980
using<font color="#E5E5E5"> that on a live engagement on the</font>

1025
00:37:03,130 --> 00:37:07,869
side<font color="#E5E5E5"> so sorry</font>

1026
00:37:05,980 --> 00:37:08,800
<font color="#E5E5E5">alright intelligence-gathering trying to</font>

1027
00:37:07,869 --> 00:37:10,089
speed up<font color="#CCCCCC"> guys</font><font color="#E5E5E5"> I know we're</font><font color="#CCCCCC"> totally out</font>

1028
00:37:08,800 --> 00:37:11,980
of time<font color="#E5E5E5"> so this</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> basically</font><font color="#CCCCCC"> how</font><font color="#E5E5E5"> you</font>

1029
00:37:10,089 --> 00:37:14,170
build a key<font color="#E5E5E5"> logger on</font><font color="#CCCCCC"> windows there's a</font>

1030
00:37:11,980 --> 00:37:17,319
function<font color="#CCCCCC"> called</font><font color="#E5E5E5"> get</font><font color="#CCCCCC"> eight ok get a sync</font>

1031
00:37:14,170 --> 00:37:18,760
key<font color="#E5E5E5"> state you call that and say on every</font>

1032
00:37:17,319 --> 00:37:19,960
key is this keeping<font color="#E5E5E5"> press this is</font>

1033
00:37:18,760 --> 00:37:21,490
<font color="#E5E5E5">keeping press this is</font><font color="#CCCCCC"> keeping pressed</font>

1034
00:37:19,960 --> 00:37:23,650
and if it is you write it<font color="#CCCCCC"> which sounds</font>

1035
00:37:21,490 --> 00:37:25,060
<font color="#CCCCCC">really fucking loud and it</font><font color="#E5E5E5"> is but</font>

1036
00:37:23,650 --> 00:37:26,230
apparently<font color="#CCCCCC"> everybody's used to shit</font>

1037
00:37:25,060 --> 00:37:27,130
<font color="#E5E5E5">being allowed on</font><font color="#CCCCCC"> windows</font><font color="#E5E5E5"> because this is</font>

1038
00:37:26,230 --> 00:37:28,060
how<font color="#E5E5E5"> Empire does it this is all</font>

1039
00:37:27,130 --> 00:37:29,260
<font color="#CCCCCC">Metasploit does it this is</font><font color="#E5E5E5"> all</font>

1040
00:37:28,060 --> 00:37:33,009
commercial shit on the fucking<font color="#CCCCCC"> darknet</font>

1041
00:37:29,260 --> 00:37:35,230
<font color="#CCCCCC">doesn't in nobody fucking cares on</font><font color="#E5E5E5"> Linux</font>

1042
00:37:33,010 --> 00:37:36,460
your keyboard<font color="#E5E5E5"> is a device fucking cat</font>

1043
00:37:35,230 --> 00:37:39,640
HTTP POST

1044
00:37:36,460 --> 00:37:41,109
<font color="#E5E5E5">done there's this is a</font><font color="#CCCCCC"> linux</font><font color="#E5E5E5"> key logger</font>

1045
00:37:39,640 --> 00:37:42,730
<font color="#CCCCCC">that i ripped off years ago</font><font color="#E5E5E5"> and have</font>

1046
00:37:41,109 --> 00:37:46,509
been<font color="#E5E5E5"> using the guts and all of my</font>

1047
00:37:42,730 --> 00:37:47,890
implants<font color="#E5E5E5"> for years now on</font><font color="#CCCCCC"> Apple</font><font color="#E5E5E5"> because</font>

1048
00:37:46,510 --> 00:37:49,330
<font color="#E5E5E5">everything is a fucking pain</font><font color="#CCCCCC"> in the ass</font>

1049
00:37:47,890 --> 00:37:53,140
and<font color="#E5E5E5"> the fucking Apple you know</font>

1050
00:37:49,330 --> 00:37:54,730
universe<font color="#CCCCCC"> you have to create</font><font color="#E5E5E5"> an event and</font>

1051
00:37:53,140 --> 00:37:55,930
the problem is you can't<font color="#E5E5E5"> create an event</font>

1052
00:37:54,730 --> 00:37:57,970
for<font color="#E5E5E5"> arbitrary actions you can only</font>

1053
00:37:55,930 --> 00:38:00,759
create an event<font color="#CCCCCC"> for</font><font color="#E5E5E5"> certain shit so and</font>

1054
00:37:57,970 --> 00:38:02,259
this you create<font color="#CCCCCC"> a string fork</font><font color="#E5E5E5"> you</font>

1055
00:38:00,760 --> 00:38:03,880
basically create an event for<font color="#E5E5E5"> every key</font>

1056
00:38:02,260 --> 00:38:05,560
<font color="#CCCCCC">you</font><font color="#E5E5E5"> turn you</font><font color="#CCCCCC"> two key into a string</font><font color="#E5E5E5"> and</font>

1057
00:38:03,880 --> 00:38:06,760
you say when<font color="#E5E5E5"> this event happens do a</font>

1058
00:38:05,560 --> 00:38:07,840
thing and<font color="#E5E5E5"> then you run a loop that</font>

1059
00:38:06,760 --> 00:38:09,520
listens<font color="#CCCCCC"> for those events</font><font color="#E5E5E5"> which is</font>

1060
00:38:07,840 --> 00:38:12,220
<font color="#E5E5E5">fucking complicated so I actually this</font>

1061
00:38:09,520 --> 00:38:15,190
<font color="#CCCCCC">is a chunk of code that does it for you</font>

1062
00:38:12,220 --> 00:38:17,529
in C and then I actually use this and<font color="#E5E5E5"> go</font>

1063
00:38:15,190 --> 00:38:20,110
and and go I call exceed<font color="#CCCCCC"> out start</font>

1064
00:38:17,530 --> 00:38:23,260
<font color="#CCCCCC">longer and it spits out data to a buffer</font>

1065
00:38:20,110 --> 00:38:24,550
<font color="#E5E5E5">that go can traverse</font><font color="#CCCCCC"> which I couldn't</font>

1066
00:38:23,260 --> 00:38:27,460
post the go code because<font color="#E5E5E5"> that's part of</font>

1067
00:38:24,550 --> 00:38:29,260
an implant<font color="#E5E5E5"> that for lots of reasons I</font>

1068
00:38:27,460 --> 00:38:30,760
cannot disclose but I can disclose<font color="#E5E5E5"> this</font>

1069
00:38:29,260 --> 00:38:35,590
because this<font color="#E5E5E5"> is</font><font color="#CCCCCC"> just arbitrary C to</font>

1070
00:38:30,760 --> 00:38:39,880
build a<font color="#CCCCCC"> keylogger on screen capture</font>

1071
00:38:35,590 --> 00:38:42,640
video<font color="#E5E5E5"> this is</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> don't</font><font color="#CCCCCC"> think I</font><font color="#E5E5E5"> have code</font>

1072
00:38:39,880 --> 00:38:44,980
to do this but I just<font color="#E5E5E5"> didn't have</font><font color="#CCCCCC"> time</font>

1073
00:38:42,640 --> 00:38:46,299
<font color="#CCCCCC">to comprise it into a</font><font color="#E5E5E5"> simple format it's</font>

1074
00:38:44,980 --> 00:38:47,500
it's kind of all spread out and the

1075
00:38:46,300 --> 00:38:48,790
implant<font color="#E5E5E5"> that I use it in but basically</font>

1076
00:38:47,500 --> 00:38:50,200
there's a function<font color="#E5E5E5"> in there where</font>

1077
00:38:48,790 --> 00:38:51,580
there's stuff in there<font color="#E5E5E5"> where you create</font>

1078
00:38:50,200 --> 00:38:53,109
what's called<font color="#E5E5E5"> context so you create a</font>

1079
00:38:51,580 --> 00:38:54,819
context which is<font color="#E5E5E5"> a placeholder for stuff</font>

1080
00:38:53,110 --> 00:38:56,170
<font color="#E5E5E5">and you say hold all the stuff on the</font>

1081
00:38:54,820 --> 00:38:58,420
desktop and<font color="#E5E5E5"> you</font><font color="#CCCCCC"> can another context it</font>

1082
00:38:56,170 --> 00:38:59,410
says<font color="#E5E5E5"> hold all the stuff in any bitmap</font>

1083
00:38:58,420 --> 00:39:00,790
that<font color="#CCCCCC"> I make</font><font color="#E5E5E5"> and then you call this</font>

1084
00:38:59,410 --> 00:39:03,100
function<font color="#E5E5E5"> over and over again which is</font>

1085
00:39:00,790 --> 00:39:04,720
you know take a bitmap<font color="#E5E5E5"> from context a in</font>

1086
00:39:03,100 --> 00:39:09,730
<font color="#E5E5E5">stored in context B and then you send</font>

1087
00:39:04,720 --> 00:39:11,529
context be<font color="#CCCCCC"> someplace this is</font><font color="#E5E5E5"> a video</font>

1088
00:39:09,730 --> 00:39:12,850
<font color="#CCCCCC">capture on</font><font color="#E5E5E5"> OS X which again I didn't</font>

1089
00:39:11,530 --> 00:39:14,380
<font color="#E5E5E5">bother to write myself because I stole</font>

1090
00:39:12,850 --> 00:39:18,730
this a while<font color="#E5E5E5"> ago and</font><font color="#CCCCCC"> I've</font><font color="#E5E5E5"> been using it</font>

1091
00:39:14,380 --> 00:39:22,240
so go steal<font color="#E5E5E5"> theirs</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> is a image</font>

1092
00:39:18,730 --> 00:39:25,600
capture same deal<font color="#CCCCCC"> on</font><font color="#E5E5E5"> Linux you</font><font color="#CCCCCC"> can use a</font>

1093
00:39:22,240 --> 00:39:27,040
xwd<font color="#E5E5E5"> not always relevant because</font><font color="#CCCCCC"> a lot of</font>

1094
00:39:25,600 --> 00:39:29,680
times you're just<font color="#E5E5E5"> gonna be</font><font color="#CCCCCC"> scotch</font>

1095
00:39:27,040 --> 00:39:31,660
capturing<font color="#CCCCCC"> from the tty there you there's</font>

1096
00:39:29,680 --> 00:39:33,370
<font color="#CCCCCC">TTY spy code out there that's public but</font>

1097
00:39:31,660 --> 00:39:34,660
it<font color="#E5E5E5"> actually doesn't compile very well</font><font color="#CCCCCC"> in</font>

1098
00:39:33,370 --> 00:39:36,370
modern operating<font color="#CCCCCC"> systems and I haven't</font>

1099
00:39:34,660 --> 00:39:38,410
<font color="#E5E5E5">figured</font><font color="#CCCCCC"> out why I honestly</font><font color="#E5E5E5"> haven't used</font>

1100
00:39:36,370 --> 00:39:39,970
it that much because usually<font color="#E5E5E5"> a</font><font color="#CCCCCC"> keylogger</font>

1101
00:39:38,410 --> 00:39:41,200
<font color="#CCCCCC">on</font><font color="#E5E5E5"> Linux works just as well</font><font color="#CCCCCC"> in the</font>

1102
00:39:39,970 --> 00:39:42,549
<font color="#CCCCCC">Khilafah</font><font color="#E5E5E5"> that I showed you earlier I've</font>

1103
00:39:41,200 --> 00:39:46,180
never had family so I've<font color="#E5E5E5"> never had a</font>

1104
00:39:42,550 --> 00:39:48,400
<font color="#E5E5E5">reason to do this</font><font color="#CCCCCC"> webcams oh my god</font>

1105
00:39:46,180 --> 00:39:49,899
like manually<font color="#E5E5E5"> going into the API</font><font color="#CCCCCC"> of</font>

1106
00:39:48,400 --> 00:39:52,000
every single<font color="#CCCCCC"> system</font><font color="#E5E5E5"> in order to build</font>

1107
00:39:49,900 --> 00:39:53,620
<font color="#CCCCCC">platform-independent malware to do</font><font color="#E5E5E5"> shit</font>

1108
00:39:52,000 --> 00:39:56,050
is a giant pain in the ass<font color="#E5E5E5"> just use</font>

1109
00:39:53,620 --> 00:39:58,990
<font color="#CCCCCC">OpenCV yes it's huge its 2017</font>

1110
00:39:56,050 --> 00:40:00,520
nobody cares we're<font color="#E5E5E5"> not hiding malware on</font>

1111
00:39:58,990 --> 00:40:01,419
floppies<font color="#E5E5E5"> anymore if I pick your malware</font>

1112
00:40:00,520 --> 00:40:05,430
is 10 Meg's<font color="#CCCCCC"> I mean</font>

1113
00:40:01,420 --> 00:40:07,870
fuck off and<font color="#CCCCCC"> it's multi-platform like I</font>

1114
00:40:05,430 --> 00:40:10,569
think<font color="#E5E5E5"> I did</font><font color="#CCCCCC"> include</font><font color="#E5E5E5"> the source</font><font color="#CCCCCC"> yeah here</font>

1115
00:40:07,870 --> 00:40:13,390
is go code from<font color="#E5E5E5"> a payload that</font><font color="#CCCCCC"> I use all</font>

1116
00:40:10,570 --> 00:40:15,580
the<font color="#CCCCCC"> time and here you go this is capture</font>

1117
00:40:13,390 --> 00:40:17,470
shit from<font color="#CCCCCC"> a camera let me tell you</font><font color="#E5E5E5"> going</font>

1118
00:40:15,580 --> 00:40:19,299
on pen tests and showing<font color="#CCCCCC"> people not just</font>

1119
00:40:17,470 --> 00:40:20,919
<font color="#E5E5E5">shells but the faces</font><font color="#CCCCCC"> of the</font><font color="#E5E5E5"> people while</font>

1120
00:40:19,300 --> 00:40:25,510
<font color="#E5E5E5">they're using the box that</font><font color="#CCCCCC"> has the shell</font>

1121
00:40:20,920 --> 00:40:28,120
oh fuck makes people<font color="#CCCCCC"> shoot the</font><font color="#E5E5E5"> bed audio</font>

1122
00:40:25,510 --> 00:40:30,040
<font color="#E5E5E5">same thing turns out audio works on</font>

1123
00:40:28,120 --> 00:40:32,650
fucking everything<font color="#E5E5E5"> and like here you go</font>

1124
00:40:30,040 --> 00:40:35,710
<font color="#E5E5E5">block of</font><font color="#CCCCCC"> C which says turn mic on and</font>

1125
00:40:32,650 --> 00:40:37,300
listen to shit<font color="#E5E5E5"> stream to me holy fuck</font>

1126
00:40:35,710 --> 00:40:42,280
like<font color="#CCCCCC"> port bug in conference rooms with</font>

1127
00:40:37,300 --> 00:40:43,360
laptops<font color="#E5E5E5"> people</font><font color="#CCCCCC"> freak</font><font color="#E5E5E5"> out</font><font color="#CCCCCC"> browser data</font><font color="#E5E5E5"> so</font>

1128
00:40:42,280 --> 00:40:44,560
I'm just gonna<font color="#E5E5E5"> gonna go through these</font>

1129
00:40:43,360 --> 00:40:46,000
super quick<font color="#CCCCCC"> because they're not really</font>

1130
00:40:44,560 --> 00:40:47,680
<font color="#E5E5E5">relevant like yeah there's some quick</font>

1131
00:40:46,000 --> 00:40:49,060
<font color="#E5E5E5">ways to do like decryption and these are</font>

1132
00:40:47,680 --> 00:40:49,990
some sources<font color="#CCCCCC"> that</font><font color="#E5E5E5"> all really</font><font color="#CCCCCC"> is because</font>

1133
00:40:49,060 --> 00:40:51,070
I'm<font color="#E5E5E5"> gonna release the softs but</font>

1134
00:40:49,990 --> 00:40:52,750
<font color="#E5E5E5">basically if you</font><font color="#CCCCCC"> want</font><font color="#E5E5E5"> to steal stuff</font>

1135
00:40:51,070 --> 00:40:54,190
<font color="#CCCCCC">from browsers</font><font color="#E5E5E5"> pop and nurse off to</font>

1136
00:40:52,750 --> 00:40:56,140
utility on there and just<font color="#E5E5E5"> run it like</font>

1137
00:40:54,190 --> 00:40:58,180
they have stuff to do<font color="#E5E5E5"> all</font><font color="#CCCCCC"> kinds of</font><font color="#E5E5E5"> like</font>

1138
00:40:56,140 --> 00:40:59,890
every browser<font color="#E5E5E5"> in the world</font><font color="#CCCCCC"> like Outlook</font>

1139
00:40:58,180 --> 00:41:01,359
and<font color="#E5E5E5"> whatever you</font><font color="#CCCCCC"> just run this and it</font>

1140
00:40:59,890 --> 00:41:04,960
steals all the<font color="#E5E5E5"> credits all the codes all</font>

1141
00:41:01,360 --> 00:41:06,640
<font color="#CCCCCC">the things</font><font color="#E5E5E5"> email history</font><font color="#CCCCCC"> these are more</font>

1142
00:41:04,960 --> 00:41:08,800
general and we're like way<font color="#CCCCCC"> at a</font><font color="#E5E5E5"> time so</font>

1143
00:41:06,640 --> 00:41:10,240
I'm<font color="#E5E5E5"> just gonna like go real fast this is</font>

1144
00:41:08,800 --> 00:41:11,410
like you can<font color="#E5E5E5"> perform an email backup if</font>

1145
00:41:10,240 --> 00:41:12,490
you have a<font color="#E5E5E5"> proxy on somebody else's</font>

1146
00:41:11,410 --> 00:41:15,640
machine that way you<font color="#E5E5E5"> don't have to worry</font>

1147
00:41:12,490 --> 00:41:17,319
<font color="#CCCCCC">about history crapping you can if you</font>

1148
00:41:15,640 --> 00:41:19,450
get really shady<font color="#E5E5E5"> or you get really good</font>

1149
00:41:17,320 --> 00:41:20,920
access you<font color="#CCCCCC"> can redirect the MX record</font><font color="#E5E5E5"> to</font>

1150
00:41:19,450 --> 00:41:22,330
<font color="#E5E5E5">your server and</font><font color="#CCCCCC"> then change the IP</font>

1151
00:41:20,920 --> 00:41:23,650
record to go back to the original server

1152
00:41:22,330 --> 00:41:25,930
so<font color="#CCCCCC"> that</font><font color="#E5E5E5"> you just</font><font color="#CCCCCC"> backed already at the</font>

1153
00:41:23,650 --> 00:41:27,940
<font color="#CCCCCC">SMTP server this is great because</font><font color="#E5E5E5"> while</font>

1154
00:41:25,930 --> 00:41:32,290
<font color="#E5E5E5">Gmail keeps logs of things that log into</font>

1155
00:41:27,940 --> 00:41:33,730
it the clients don't so every time they

1156
00:41:32,290 --> 00:41:35,200
log<font color="#E5E5E5"> into an email they're just sending</font>

1157
00:41:33,730 --> 00:41:39,300
it to you there's no fucking record or

1158
00:41:35,200 --> 00:41:42,609
that right<font color="#CCCCCC"> you can steal the backup file</font>

1159
00:41:39,300 --> 00:41:46,180
<font color="#CCCCCC">these are all places that</font><font color="#E5E5E5"> the outlook</font>

1160
00:41:42,610 --> 00:41:47,890
<font color="#E5E5E5">that</font><font color="#CCCCCC"> you know</font><font color="#E5E5E5"> window sorry</font><font color="#CCCCCC"> that email</font>

1161
00:41:46,180 --> 00:41:49,390
clients<font color="#E5E5E5"> tend to hide there are tend to</font>

1162
00:41:47,890 --> 00:41:51,160
<font color="#E5E5E5">store their backup directories and none</font>

1163
00:41:49,390 --> 00:41:53,290
of them are encrypted by default<font color="#E5E5E5"> that</font>

1164
00:41:51,160 --> 00:41:55,210
tends to<font color="#E5E5E5"> work</font><font color="#CCCCCC"> and again</font><font color="#E5E5E5"> like just using</font>

1165
00:41:53,290 --> 00:41:59,320
<font color="#E5E5E5">your soft like their soft stuff will</font>

1166
00:41:55,210 --> 00:42:01,150
totally run all the things<font color="#E5E5E5"> location data</font>

1167
00:41:59,320 --> 00:42:03,400
this<font color="#E5E5E5"> is a fun one so</font><font color="#CCCCCC"> a lot</font><font color="#E5E5E5"> of times like</font>

1168
00:42:01,150 --> 00:42:05,080
geoip functionality if you're talking<font color="#CCCCCC"> to</font>

1169
00:42:03,400 --> 00:42:06,550
<font color="#E5E5E5">hardware you</font><font color="#CCCCCC"> love crypto bugs</font><font color="#E5E5E5"> because</font>

1170
00:42:05,080 --> 00:42:08,110
the API<font color="#CCCCCC"> is are different so just go</font>

1171
00:42:06,550 --> 00:42:09,730
what's my IP<font color="#E5E5E5"> ping something in the</font>

1172
00:42:08,110 --> 00:42:11,950
public<font color="#CCCCCC"> and be</font><font color="#E5E5E5"> like</font><font color="#CCCCCC"> google what's my IP</font>

1173
00:42:09,730 --> 00:42:13,510
and<font color="#E5E5E5"> then do geoip geoip databases were</font>

1174
00:42:11,950 --> 00:42:15,129
getting<font color="#E5E5E5"> better because since people are</font>

1175
00:42:13,510 --> 00:42:18,069
<font color="#E5E5E5">carrying more about privacy and</font>

1176
00:42:15,130 --> 00:42:19,660
<font color="#E5E5E5">geolocation shit off</font><font color="#CCCCCC"> more and more</font>

1177
00:42:18,069 --> 00:42:20,709
<font color="#E5E5E5">companies are putting forth public</font>

1178
00:42:19,660 --> 00:42:23,019
resources into making<font color="#E5E5E5"> their geolocation</font>

1179
00:42:20,709 --> 00:42:24,368
databases better Wi-Fi<font color="#E5E5E5"> keys this</font><font color="#CCCCCC"> is a</font>

1180
00:42:23,019 --> 00:42:26,410
link<font color="#CCCCCC"> that'll tell you how to steal Wi-Fi</font>

1181
00:42:24,369 --> 00:42:27,910
keys again it's super documented<font color="#CCCCCC"> trying</font>

1182
00:42:26,410 --> 00:42:28,930
to save<font color="#CCCCCC"> stuff for time WPA supplicant</font>

1183
00:42:27,910 --> 00:42:32,019
<font color="#E5E5E5">you can go through the config and</font>

1184
00:42:28,930 --> 00:42:33,399
<font color="#CCCCCC">backdoor stuff doctor my files this</font><font color="#E5E5E5"> is a</font>

1185
00:42:32,019 --> 00:42:34,959
fun one a lot<font color="#E5E5E5"> of people overlook this if</font>

1186
00:42:33,400 --> 00:42:36,579
you get<font color="#E5E5E5"> on a box and you really want to</font>

1187
00:42:34,959 --> 00:42:38,229
mine<font color="#E5E5E5"> into what somebody's</font><font color="#CCCCCC"> doing steal</font>

1188
00:42:36,579 --> 00:42:40,029
all the document files normalize them

1189
00:42:38,229 --> 00:42:41,828
all<font color="#E5E5E5"> to text which is you know a bash</font>

1190
00:42:40,029 --> 00:42:43,449
<font color="#CCCCCC">scripts</font><font color="#E5E5E5"> super easy and then put them</font><font color="#CCCCCC"> on</font>

1191
00:42:41,829 --> 00:42:45,069
a local server<font color="#E5E5E5"> and install Apache nuts</font>

1192
00:42:43,449 --> 00:42:46,809
and have nut<font color="#E5E5E5"> indexed</font><font color="#CCCCCC"> that local server</font>

1193
00:42:45,069 --> 00:42:48,549
<font color="#CCCCCC">BAM</font><font color="#E5E5E5"> personal search engine for</font>

1194
00:42:46,809 --> 00:42:50,410
somebody's life shit<font color="#E5E5E5"> works so well with</font>

1195
00:42:48,549 --> 00:42:51,759
like<font color="#E5E5E5"> Twitter grabs and Facebook grabs</font>

1196
00:42:50,410 --> 00:42:53,529
<font color="#E5E5E5">and email grabs you to put all in one</font>

1197
00:42:51,759 --> 00:42:57,849
document<font color="#CCCCCC"> like an NSA</font><font color="#E5E5E5"> the shit out of</font>

1198
00:42:53,529 --> 00:42:59,979
them<font color="#CCCCCC"> chat logs</font><font color="#E5E5E5"> these are all the you</font>

1199
00:42:57,849 --> 00:43:04,900
<font color="#E5E5E5">know these are places where</font><font color="#CCCCCC"> lip purple</font>

1200
00:42:59,979 --> 00:43:06,999
and stuff source chat logs yeah password

1201
00:43:04,900 --> 00:43:09,039
managers again like password managers

1202
00:43:06,999 --> 00:43:13,509
are typically binaries<font color="#E5E5E5"> backdoor them</font><font color="#CCCCCC"> run</font>

1203
00:43:09,039 --> 00:43:15,130
<font color="#E5E5E5">a key logger for</font><font color="#CCCCCC"> ten seconds all</font><font color="#E5E5E5"> right</font>

1204
00:43:13,509 --> 00:43:17,650
<font color="#E5E5E5">well the rest of it isn't really</font>

1205
00:43:15,130 --> 00:43:18,699
relevant<font color="#E5E5E5"> but I was going to cover a</font>

1206
00:43:17,650 --> 00:43:20,469
packer<font color="#CCCCCC"> and I was gonna cover some</font>

1207
00:43:18,699 --> 00:43:23,150
dynamic execution stuff but alright<font color="#E5E5E5"> I'll</font>

1208
00:43:20,469 --> 00:43:32,780
try yeah sorry guys

1209
00:43:23,150 --> 00:43:37,800
[Applause]

1210
00:43:32,780 --> 00:43:40,830
I'll publish<font color="#E5E5E5"> them I don't know it'll</font><font color="#CCCCCC"> be</font>

1211
00:43:37,800 --> 00:43:42,630
<font color="#CCCCCC">linked slides that</font><font color="#E5E5E5"> I use slides calm</font>

1212
00:43:40,830 --> 00:43:44,100
they'll be<font color="#E5E5E5"> a slides comlink I'm sure</font>

1213
00:43:42,630 --> 00:43:50,660
I'll get<font color="#E5E5E5"> shell</font><font color="#CCCCCC"> con</font><font color="#E5E5E5"> to like tweet it out</font>

1214
00:43:44,100 --> 00:43:50,660
or<font color="#E5E5E5"> something all right thanks again</font>

