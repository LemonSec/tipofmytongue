1
00:00:01,730 --> 00:00:08,309
okay welcome everybody this is a purple

2
00:00:05,730 --> 00:00:09,389
team exposed with Mary Sawyer Mary is a

3
00:00:08,309 --> 00:00:11,250
member of the red team at Palo Alto

4
00:00:09,389 --> 00:00:12,780
Networks in addition to her work on the

5
00:00:11,250 --> 00:00:14,340
red team to stay ahead of attackers by

6
00:00:12,780 --> 00:00:15,719
embracing their mentality strategies and

7
00:00:14,340 --> 00:00:17,789
tactics to test the organization's

8
00:00:15,719 --> 00:00:19,380
security posture Mary is also innovating

9
00:00:17,789 --> 00:00:25,680
on the purple team program please

10
00:00:19,380 --> 00:00:27,390
welcome Mary she'll con 2018 hey

11
00:00:25,680 --> 00:00:28,650
everybody thanks for coming my talk and

12
00:00:27,390 --> 00:00:30,510
more importantly thanks to all the shell

13
00:00:28,650 --> 00:00:33,870
con guys especially the AV guys you just

14
00:00:30,510 --> 00:00:36,570
saved my butt okay so just a quick show

15
00:00:33,870 --> 00:00:39,410
of hands have you guys tried out purple

16
00:00:36,570 --> 00:00:42,750
teaming and your organization's before

17
00:00:39,410 --> 00:00:45,660
yeah maybe like read blog posts about it

18
00:00:42,750 --> 00:00:48,809
just sort of confused phone like how to

19
00:00:45,660 --> 00:00:50,190
actually implement it yeah okay so

20
00:00:48,809 --> 00:00:52,349
that's kind of how we started out at

21
00:00:50,190 --> 00:00:54,629
Palo Alto - we decided that we were

22
00:00:52,350 --> 00:00:56,760
gonna start it like last year I think

23
00:00:54,629 --> 00:00:59,460
and it started out more as like an

24
00:00:56,760 --> 00:01:02,218
ad-hoc process but this year I was

25
00:00:59,460 --> 00:01:04,110
really able to innovate on how we were

26
00:01:02,219 --> 00:01:08,159
doing that and I hope to share my

27
00:01:04,110 --> 00:01:10,920
insights with you today all right so

28
00:01:08,159 --> 00:01:13,770
today we're gonna be going over what a

29
00:01:10,920 --> 00:01:15,450
purple team is if you need it or not how

30
00:01:13,770 --> 00:01:20,250
you should assemble your team some

31
00:01:15,450 --> 00:01:21,720
automation frameworks and basic steps

32
00:01:20,250 --> 00:01:24,210
for you to follow when you're trying it

33
00:01:21,720 --> 00:01:28,080
up in your own organization and then

34
00:01:24,210 --> 00:01:29,070
we'll put it all together so if you read

35
00:01:28,080 --> 00:01:30,899
all the blog posts you're probably

36
00:01:29,070 --> 00:01:32,939
familiar generally with what the

37
00:01:30,900 --> 00:01:35,189
definition for a purple team is it's

38
00:01:32,939 --> 00:01:36,929
supposed to be a framework for iterative

39
00:01:35,189 --> 00:01:40,020
testing to rapidly and effectively

40
00:01:36,930 --> 00:01:43,170
identify deficiencies within your

41
00:01:40,020 --> 00:01:44,699
environment but in practice we found

42
00:01:43,170 --> 00:01:47,100
that it's just two people sitting down

43
00:01:44,700 --> 00:01:52,380
running tests and developing alerts or

44
00:01:47,100 --> 00:01:54,570
fixes I think it's really important for

45
00:01:52,380 --> 00:01:56,280
you to sit down and ask yourself whether

46
00:01:54,570 --> 00:01:58,289
or not you actually need a purple team I

47
00:01:56,280 --> 00:01:59,549
know a lot of the resources out there

48
00:01:58,290 --> 00:02:01,619
tell you that of course you should be

49
00:01:59,549 --> 00:02:03,600
purple teaming why not it's the next gen

50
00:02:01,619 --> 00:02:06,030
thing but I think it's really most

51
00:02:03,600 --> 00:02:07,979
useful in small to medium businesses or

52
00:02:06,030 --> 00:02:09,989
maybe younger security teams were you

53
00:02:07,979 --> 00:02:11,879
trying to build up processes rapidly and

54
00:02:09,989 --> 00:02:13,680
effectively or maybe you're suffering

55
00:02:11,879 --> 00:02:14,280
from like pen test fatigue where you're

56
00:02:13,680 --> 00:02:15,660
getting a lot

57
00:02:14,280 --> 00:02:19,080
results and not seeing a lot of

58
00:02:15,660 --> 00:02:20,760
improvement in your security posture so

59
00:02:19,080 --> 00:02:25,410
ask your doctor if purple teaming is

60
00:02:20,760 --> 00:02:28,079
right for you so again our purple

61
00:02:25,410 --> 00:02:30,299
teaming journey you made it you may or

62
00:02:28,080 --> 00:02:32,520
may not have attended my boss's talk

63
00:02:30,300 --> 00:02:34,080
last year PJ she was talking about red

64
00:02:32,520 --> 00:02:36,750
teaming and she mentioned what we were

65
00:02:34,080 --> 00:02:38,610
doing on the front of purple teaming so

66
00:02:36,750 --> 00:02:40,440
it started out initially as an intern

67
00:02:38,610 --> 00:02:42,600
project one of our lovely and talented

68
00:02:40,440 --> 00:02:45,120
interns actually built us an application

69
00:02:42,600 --> 00:02:47,579
that was able to track our red team

70
00:02:45,120 --> 00:02:49,769
attacks as they were happening phases

71
00:02:47,580 --> 00:02:51,540
from the red team in the attack and then

72
00:02:49,769 --> 00:02:54,060
the blue team could either mark things

73
00:02:51,540 --> 00:02:55,190
as detected or not whenever they got

74
00:02:54,060 --> 00:02:58,320
alerts

75
00:02:55,190 --> 00:03:00,780
however this costume and because in

76
00:02:58,320 --> 00:03:03,150
consistent communication was more of a

77
00:03:00,780 --> 00:03:05,790
battle than a real collaboration we

78
00:03:03,150 --> 00:03:07,560
didn't find much insight for the blue

79
00:03:05,790 --> 00:03:09,510
team on why they weren't detecting what

80
00:03:07,560 --> 00:03:12,000
we were attacking on and the red team

81
00:03:09,510 --> 00:03:16,829
couldn't run tests that blue team could

82
00:03:12,000 --> 00:03:18,690
even track her lively so we came up with

83
00:03:16,830 --> 00:03:21,540
this structure for our purple teaming

84
00:03:18,690 --> 00:03:23,519
operations first off it you should

85
00:03:21,540 --> 00:03:27,320
assemble a team have two people

86
00:03:23,519 --> 00:03:30,090
dedicated to purple teaming it can be a

87
00:03:27,320 --> 00:03:33,480
less skilled person and a more skilled

88
00:03:30,090 --> 00:03:36,120
person depending upon what resources you

89
00:03:33,480 --> 00:03:38,518
have at the time I think it's a really

90
00:03:36,120 --> 00:03:41,430
sweet opportunity to train up Junior pen

91
00:03:38,519 --> 00:03:43,590
testers or analysts because you are

92
00:03:41,430 --> 00:03:46,109
again testing in a dedicated test

93
00:03:43,590 --> 00:03:48,840
environment it allows them to build

94
00:03:46,109 --> 00:03:50,130
familiarity with the new with new tools

95
00:03:48,840 --> 00:03:52,200
from inside a controlled test

96
00:03:50,130 --> 00:03:53,820
environment without where they can test

97
00:03:52,200 --> 00:03:56,940
things without fat fingering something

98
00:03:53,820 --> 00:03:58,519
and it won't like cause something to go

99
00:03:56,940 --> 00:04:01,980
down that's customer-facing

100
00:03:58,519 --> 00:04:03,480
and I know that scheduling can get dicey

101
00:04:01,980 --> 00:04:04,910
when you're working in a sock or in a

102
00:04:03,480 --> 00:04:07,709
red team where you're doing an exercise

103
00:04:04,910 --> 00:04:09,959
however it really helps communications

104
00:04:07,709 --> 00:04:12,630
if you set up working sessions regularly

105
00:04:09,959 --> 00:04:14,670
so that even if you don't run any tests

106
00:04:12,630 --> 00:04:19,918
that week you're discussing what you

107
00:04:14,670 --> 00:04:22,440
should be doing and then we came up with

108
00:04:19,918 --> 00:04:23,909
this workflow for actually testing this

109
00:04:22,440 --> 00:04:25,349
is obviously based on the scientific

110
00:04:23,909 --> 00:04:27,630
method but we found that I was the

111
00:04:25,349 --> 00:04:27,840
simplest thing to get us actually get

112
00:04:27,630 --> 00:04:30,060
the

113
00:04:27,840 --> 00:04:32,190
all rolling first you're going to start

114
00:04:30,060 --> 00:04:33,750
out with obviously a Miss configuration

115
00:04:32,190 --> 00:04:35,699
or vulnerability in the environment

116
00:04:33,750 --> 00:04:37,979
maybe you see something that hasn't been

117
00:04:35,699 --> 00:04:39,120
remediated yet or you have some niggling

118
00:04:37,979 --> 00:04:42,090
thing in the back of your mind where

119
00:04:39,120 --> 00:04:44,400
you're like hey are we blocking that or

120
00:04:42,090 --> 00:04:45,989
maybe you're reading about a new attack

121
00:04:44,400 --> 00:04:49,080
vector and you're not sure whether or

122
00:04:45,990 --> 00:04:50,370
not it works in your environment first

123
00:04:49,080 --> 00:04:52,229
you're going to start out by writing

124
00:04:50,370 --> 00:04:54,449
down what you think is wrong and then

125
00:04:52,229 --> 00:04:57,389
putting it into a tracking system like

126
00:04:54,449 --> 00:04:59,430
JIRA from there you're going to

127
00:04:57,389 --> 00:05:01,889
obviously do all your like backlog

128
00:04:59,430 --> 00:05:04,380
grooming see what you actually want to

129
00:05:01,889 --> 00:05:06,330
run first and then when you're actually

130
00:05:04,380 --> 00:05:08,190
running the experiments you're going to

131
00:05:06,330 --> 00:05:09,960
need to first of all collect telemetry

132
00:05:08,190 --> 00:05:13,290
on windows you're probably going to use

133
00:05:09,960 --> 00:05:15,599
proc line or on Linux or Mac s trace

134
00:05:13,290 --> 00:05:17,340
you're going to actually run the test

135
00:05:15,600 --> 00:05:20,220
oh yeah either in the malware or like

136
00:05:17,340 --> 00:05:21,780
the command that you want to run you're

137
00:05:20,220 --> 00:05:23,580
going to watch your seam while it's

138
00:05:21,780 --> 00:05:25,888
happening in real time to see if any

139
00:05:23,580 --> 00:05:28,889
alerts bubble up and you're also going

140
00:05:25,889 --> 00:05:30,780
to be taking notes from there you're

141
00:05:28,889 --> 00:05:32,669
going to examine everything that you

142
00:05:30,780 --> 00:05:34,530
gather during the experimentation phrase

143
00:05:32,669 --> 00:05:36,419
and you're going to determine whether

144
00:05:34,530 --> 00:05:38,940
the attack was a success or whether it

145
00:05:36,419 --> 00:05:41,490
was a failure now if it was a success

146
00:05:38,940 --> 00:05:44,099
obviously we can't have that so we need

147
00:05:41,490 --> 00:05:46,560
to develop an improvement be that an

148
00:05:44,099 --> 00:05:48,210
alert a threat hunting use-case or maybe

149
00:05:46,560 --> 00:05:51,320
a mitigating control like turning off

150
00:05:48,210 --> 00:05:54,060
SMB 1 which you should do by the way

151
00:05:51,320 --> 00:05:55,800
once you build that improvement you want

152
00:05:54,060 --> 00:05:57,870
to test it you want to make sure that if

153
00:05:55,800 --> 00:05:59,550
you put this into production it's not

154
00:05:57,870 --> 00:06:02,580
going to like break everything or give

155
00:05:59,550 --> 00:06:05,340
you a million results so you want to go

156
00:06:02,580 --> 00:06:08,669
through this workflow again until you

157
00:06:05,340 --> 00:06:09,960
have confidence that this alert or

158
00:06:08,669 --> 00:06:13,680
threat hunting yeast case isn't going to

159
00:06:09,960 --> 00:06:14,789
break everything and then obviously once

160
00:06:13,680 --> 00:06:19,590
you've fixed everything you're going to

161
00:06:14,789 --> 00:06:22,229
report that you were successful another

162
00:06:19,590 --> 00:06:24,630
quick note about the working sessions we

163
00:06:22,229 --> 00:06:27,360
all forget things when we leave work so

164
00:06:24,630 --> 00:06:29,610
we should all take notes just in case we

165
00:06:27,360 --> 00:06:32,039
have some conflict on whether or not the

166
00:06:29,610 --> 00:06:33,780
attack was successful or not treat it

167
00:06:32,039 --> 00:06:35,310
like an incident or a pen test take the

168
00:06:33,780 --> 00:06:38,039
notes like you would during those phases

169
00:06:35,310 --> 00:06:39,719
and obviously record where you were

170
00:06:38,039 --> 00:06:41,669
running it because sometimes if you want

171
00:06:39,719 --> 00:06:46,800
to go back and do forensics on us

172
00:06:41,670 --> 00:06:48,660
you need to know where you did it before

173
00:06:46,800 --> 00:06:52,050
the actual first session you're going to

174
00:06:48,660 --> 00:06:53,460
need a dedicated environment so if you

175
00:06:52,050 --> 00:06:55,140
don't have the resources for that maybe

176
00:06:53,460 --> 00:06:56,430
consider putting off purple team until

177
00:06:55,140 --> 00:06:59,729
you're in a moment more mature

178
00:06:56,430 --> 00:07:01,380
organization the so you should focus on

179
00:06:59,730 --> 00:07:03,390
trying to get the most common operating

180
00:07:01,380 --> 00:07:05,159
systems in your environment be that

181
00:07:03,390 --> 00:07:07,260
Windows server a boon to just take your

182
00:07:05,160 --> 00:07:09,300
best guess and then from there you're

183
00:07:07,260 --> 00:07:11,550
gonna try to get the gold or standard

184
00:07:09,300 --> 00:07:14,400
images from your IT system as well if

185
00:07:11,550 --> 00:07:15,750
they don't have that then just try to

186
00:07:14,400 --> 00:07:19,080
have them make their best guess and

187
00:07:15,750 --> 00:07:20,190
configure something for you and you

188
00:07:19,080 --> 00:07:21,870
should also put this where your other

189
00:07:20,190 --> 00:07:25,200
server lives so if you're testing

190
00:07:21,870 --> 00:07:27,450
anything any malware that begins out you

191
00:07:25,200 --> 00:07:29,700
need to actually have firewall rules in

192
00:07:27,450 --> 00:07:35,010
place so that you're not testing on a

193
00:07:29,700 --> 00:07:35,880
system that doesn't have any rules as a

194
00:07:35,010 --> 00:07:38,810
red teamer

195
00:07:35,880 --> 00:07:41,640
I love testing in production obviously

196
00:07:38,810 --> 00:07:43,290
but our philosophy is also to tread

197
00:07:41,640 --> 00:07:44,940
carefully so if you are testing on

198
00:07:43,290 --> 00:07:46,920
production systems things do break

199
00:07:44,940 --> 00:07:49,469
sometimes and you need to be prepared

200
00:07:46,920 --> 00:07:50,940
for the consequences so on purple

201
00:07:49,470 --> 00:07:52,860
teaming you try not to use the images

202
00:07:50,940 --> 00:07:55,980
for anything else and you also try to

203
00:07:52,860 --> 00:07:57,570
use OPSEC safe tools so for example if

204
00:07:55,980 --> 00:08:00,900
you're testing power sploit they have

205
00:07:57,570 --> 00:08:02,909
the mayhem module which can set the

206
00:08:00,900 --> 00:08:04,830
Master Boot Record on Windows systems if

207
00:08:02,910 --> 00:08:06,780
you're planning on using these systems

208
00:08:04,830 --> 00:08:08,700
in the future for purple teaming don't

209
00:08:06,780 --> 00:08:10,049
use that module I actually read the

210
00:08:08,700 --> 00:08:13,710
scripts that you're running before you

211
00:08:10,050 --> 00:08:15,630
run them you can also try to isolate the

212
00:08:13,710 --> 00:08:18,659
boxes on your network but again if

213
00:08:15,630 --> 00:08:20,670
you're testing any situ anything you

214
00:08:18,660 --> 00:08:25,830
like pass the hash attack the results

215
00:08:20,670 --> 00:08:27,750
may be skewed so now you have your

216
00:08:25,830 --> 00:08:29,550
environment you have your team and you

217
00:08:27,750 --> 00:08:31,830
have your workflow now you need to

218
00:08:29,550 --> 00:08:34,350
actually know what test cases you want

219
00:08:31,830 --> 00:08:36,120
to run what's best for your business you

220
00:08:34,350 --> 00:08:37,740
want to do gap analysis using mightor's

221
00:08:36,120 --> 00:08:39,510
attack framework pretty much everybody

222
00:08:37,740 --> 00:08:41,250
knows about this but if you don't go

223
00:08:39,510 --> 00:08:43,919
read it it's basically like the InfoSec

224
00:08:41,250 --> 00:08:46,560
bible at this point it's a quick way to

225
00:08:43,919 --> 00:08:50,130
select and prioritize your tests for

226
00:08:46,560 --> 00:08:52,380
impactful results and if also a quick

227
00:08:50,130 --> 00:08:54,810
note if you're a more junior analyst or

228
00:08:52,380 --> 00:08:55,500
a junior pen tester you may want to

229
00:08:54,810 --> 00:08:57,180
bring in

230
00:08:55,500 --> 00:09:00,060
from the outside who's more familiar

231
00:08:57,180 --> 00:09:01,469
with the network landscape just so that

232
00:09:00,060 --> 00:09:07,949
you get better insights into your

233
00:09:01,470 --> 00:09:09,150
organization's security so first thing

234
00:09:07,950 --> 00:09:12,240
you want to do is start out with the

235
00:09:09,150 --> 00:09:13,850
entire framework the Mac the Windows and

236
00:09:12,240 --> 00:09:16,200
the Linux if it applies to you obviously

237
00:09:13,850 --> 00:09:18,030
don't put in anything that doesn't apply

238
00:09:16,200 --> 00:09:20,400
to your environment so if you're not

239
00:09:18,030 --> 00:09:22,770
mature enough to have two FA for example

240
00:09:20,400 --> 00:09:25,110
don't test it because it's not going to

241
00:09:22,770 --> 00:09:27,180
give you any results you can also add

242
00:09:25,110 --> 00:09:29,670
new TTP's that aren't mentioned so

243
00:09:27,180 --> 00:09:32,130
anything that any new attack vector that

244
00:09:29,670 --> 00:09:33,569
you want to try out super bad go ahead

245
00:09:32,130 --> 00:09:35,370
and add that in there it's supposed to

246
00:09:33,570 --> 00:09:38,090
be a resource for you and it's not

247
00:09:35,370 --> 00:09:38,090
actually the Bible

248
00:09:39,560 --> 00:09:44,520
so during gap analysis you want to try

249
00:09:42,510 --> 00:09:46,680
to rate your organization on each

250
00:09:44,520 --> 00:09:48,780
category from good to worst I've

251
00:09:46,680 --> 00:09:50,250
supplied this handy legend I think that

252
00:09:48,780 --> 00:09:52,500
it's pretty helpful for everybody here

253
00:09:50,250 --> 00:09:54,390
it keeps it helps you keep all your

254
00:09:52,500 --> 00:09:57,000
thoughts together when you're looking at

255
00:09:54,390 --> 00:09:58,650
back at it later and if you're in doubt

256
00:09:57,000 --> 00:10:00,870
just move on you don't have to rate

257
00:09:58,650 --> 00:10:02,699
every single category if you don't know

258
00:10:00,870 --> 00:10:04,380
where you stand on something it's

259
00:10:02,700 --> 00:10:07,610
probably better that you don't test it

260
00:10:04,380 --> 00:10:07,610
since you don't know what's going on

261
00:10:08,900 --> 00:10:13,230
let's see you've finally gone through

262
00:10:11,220 --> 00:10:15,470
everything and I'm just giving this

263
00:10:13,230 --> 00:10:18,030
credential access column as an example

264
00:10:15,470 --> 00:10:20,190
you want to select the category that you

265
00:10:18,030 --> 00:10:21,900
want to test first unless you have a

266
00:10:20,190 --> 00:10:23,430
really big team and the manpower to

267
00:10:21,900 --> 00:10:25,770
actually go through all these test cases

268
00:10:23,430 --> 00:10:29,699
at once you want to keep it simple at

269
00:10:25,770 --> 00:10:31,650
least for the first iteration so the

270
00:10:29,700 --> 00:10:36,330
first thing you want to do is prioritize

271
00:10:31,650 --> 00:10:38,220
by popularity so in this example we see

272
00:10:36,330 --> 00:10:40,280
that credential thumping is used by

273
00:10:38,220 --> 00:10:43,350
every garden-variety hacker out there

274
00:10:40,280 --> 00:10:45,839
it's super popular with both apts and

275
00:10:43,350 --> 00:10:49,530
skids so you want to make sure that you

276
00:10:45,840 --> 00:10:52,200
get that out of the way first and we're

277
00:10:49,530 --> 00:10:54,209
going to use the attack wiki to make

278
00:10:52,200 --> 00:10:58,890
test cases because it's actually a super

279
00:10:54,210 --> 00:11:02,550
verbose example of how to build test

280
00:10:58,890 --> 00:11:04,199
cases for example the credential dumping

281
00:11:02,550 --> 00:11:05,819
technique and the attack framework it

282
00:11:04,200 --> 00:11:08,430
has all these different ways to dump

283
00:11:05,820 --> 00:11:10,320
credentials in in window

284
00:11:08,430 --> 00:11:13,709
we're gonna take a look at the security

285
00:11:10,320 --> 00:11:16,290
accounts manager first so as you guys

286
00:11:13,710 --> 00:11:20,160
probably know the security accounts a

287
00:11:16,290 --> 00:11:21,959
way that it stores local accounts there

288
00:11:20,160 --> 00:11:25,260
are four really common tools out there

289
00:11:21,960 --> 00:11:29,010
already to dump it PW dump G sec dummy

290
00:11:25,260 --> 00:11:31,170
me cats and cred don't these are for

291
00:11:29,010 --> 00:11:32,850
test cases that were already online for

292
00:11:31,170 --> 00:11:35,339
you so you don't have to go through all

293
00:11:32,850 --> 00:11:37,110
the research yourself so definitely use

294
00:11:35,340 --> 00:11:41,790
this as a big resource when you're

295
00:11:37,110 --> 00:11:43,920
purple teaming now that you have all

296
00:11:41,790 --> 00:11:45,719
those four test cases maybe you want to

297
00:11:43,920 --> 00:11:47,430
go deeper and investigate what it

298
00:11:45,720 --> 00:11:50,700
actually takes to run me me cats in your

299
00:11:47,430 --> 00:11:52,589
environment for example a lot of Av is

300
00:11:50,700 --> 00:11:56,750
kind of touch-and-go on how mimi cats

301
00:11:52,590 --> 00:11:59,010
works so maybe try out some basic way of

302
00:11:56,750 --> 00:12:02,400
obfuscating it by using like a packer

303
00:11:59,010 --> 00:12:08,670
for example it's another handy training

304
00:12:02,400 --> 00:12:10,020
opportunity for red and blue alike so

305
00:12:08,670 --> 00:12:12,089
going further into the Mimi cat's

306
00:12:10,020 --> 00:12:14,360
example have your red teamer go ahead

307
00:12:12,090 --> 00:12:17,160
and clone the repo open visual studio

308
00:12:14,360 --> 00:12:19,710
maybe remove strings from the code that

309
00:12:17,160 --> 00:12:22,260
a lot of AV SIG's on it's pretty well

310
00:12:19,710 --> 00:12:24,860
documented that at least a couple of AVS

311
00:12:22,260 --> 00:12:28,050
used to sig on the gentle Kiwis string

312
00:12:24,860 --> 00:12:30,600
then go ahead and compile it and then

313
00:12:28,050 --> 00:12:32,099
pack it using either upx or --them Ida

314
00:12:30,600 --> 00:12:35,070
whatever you have lying around

315
00:12:32,100 --> 00:12:36,630
it may seem super simple to you guys but

316
00:12:35,070 --> 00:12:38,550
if you have like a baby hacker on your

317
00:12:36,630 --> 00:12:44,970
team this is going to be a super useful

318
00:12:38,550 --> 00:12:47,339
experience for them and let's say you

319
00:12:44,970 --> 00:12:49,890
decide to go further into it you want to

320
00:12:47,339 --> 00:12:51,180
see exactly what it takes to run mimi

321
00:12:49,890 --> 00:12:53,640
cats in your environment and you keep

322
00:12:51,180 --> 00:12:54,989
obvious gating it on it maybe stop

323
00:12:53,640 --> 00:12:57,300
before you start looking like that

324
00:12:54,990 --> 00:12:59,130
spongebob meme or it's kind of

325
00:12:57,300 --> 00:13:01,189
ridiculous and you don't know you can't

326
00:12:59,130 --> 00:13:04,370
read it what you're running anymore and

327
00:13:01,190 --> 00:13:07,890
you also want to put exactly how you

328
00:13:04,370 --> 00:13:15,390
obviously did it in your description in

329
00:13:07,890 --> 00:13:18,390
JIRA or your test case um handler from

330
00:13:15,390 --> 00:13:21,120
the bloop team side obviously you want

331
00:13:18,390 --> 00:13:22,050
to create meaningful improvements so

332
00:13:21,120 --> 00:13:23,850
that you're not just

333
00:13:22,050 --> 00:13:26,128
like throwing darts at a board seeing

334
00:13:23,850 --> 00:13:28,230
where they go you want to start out by

335
00:13:26,129 --> 00:13:29,819
analyzing to them the telemetry that you

336
00:13:28,230 --> 00:13:33,720
collected using either pokémon or s

337
00:13:29,819 --> 00:13:35,849
trace and you may even look into the

338
00:13:33,720 --> 00:13:38,429
hacking tool and see if you can find any

339
00:13:35,850 --> 00:13:40,439
unique behavior there from there you're

340
00:13:38,429 --> 00:13:42,238
going to use that unique behavior to sig

341
00:13:40,439 --> 00:13:43,439
on it and then you're going to tune it

342
00:13:42,239 --> 00:13:46,049
going through the workflow that I

343
00:13:43,439 --> 00:13:48,299
mentioned earlier I kept these

344
00:13:46,049 --> 00:13:50,009
suggestions super simple because a lot

345
00:13:48,299 --> 00:13:51,329
of tools out there are wildly different

346
00:13:50,009 --> 00:13:57,319
so I don't want to give something that's

347
00:13:51,329 --> 00:13:58,949
like to platform based so

348
00:13:57,319 --> 00:14:02,160
congratulations you've just finished

349
00:13:58,949 --> 00:14:03,420
your first purple team exercise moving

350
00:14:02,160 --> 00:14:05,759
forward you're probably going to start

351
00:14:03,420 --> 00:14:07,799
looking at what can I do to automate out

352
00:14:05,759 --> 00:14:08,939
some of the simple stuff because I'm

353
00:14:07,799 --> 00:14:12,209
lazy and I don't want to do it all

354
00:14:08,939 --> 00:14:13,980
myself however we don't have the

355
00:14:12,209 --> 00:14:16,258
capability to automate everything out

356
00:14:13,980 --> 00:14:19,079
and purple team yet it probably is in

357
00:14:16,259 --> 00:14:19,980
the future but we're just gonna look at

358
00:14:19,079 --> 00:14:25,019
some of the tools that are out there

359
00:14:19,980 --> 00:14:27,600
today these are just a few that we've

360
00:14:25,019 --> 00:14:29,189
tried in our organization there I think

361
00:14:27,600 --> 00:14:30,749
that there are a few more out there but

362
00:14:29,189 --> 00:14:32,998
I haven't tried them out yet so I don't

363
00:14:30,749 --> 00:14:35,519
want to give my own advice on those

364
00:14:32,999 --> 00:14:38,279
since I haven't run them first off we

365
00:14:35,519 --> 00:14:40,529
have miners caldera it's a pretty cool

366
00:14:38,279 --> 00:14:43,410
tool that they've developed it's only

367
00:14:40,529 --> 00:14:45,600
for Windows and it does need some kind

368
00:14:43,410 --> 00:14:47,249
of complicated setup you do need to

369
00:14:45,600 --> 00:14:49,860
dedicate a server to it and you will

370
00:14:47,249 --> 00:14:52,619
need to install client rats on your

371
00:14:49,860 --> 00:14:56,089
purple team inboxes however it does have

372
00:14:52,619 --> 00:14:58,589
a really sweet attack selection engine

373
00:14:56,089 --> 00:15:00,119
but again the setup is a pain so maybe

374
00:14:58,589 --> 00:15:01,670
evaluate whether or not it's worth it

375
00:15:00,119 --> 00:15:05,189
for you guys

376
00:15:01,670 --> 00:15:07,410
next is the atomic red team it's also

377
00:15:05,189 --> 00:15:09,059
really cool it's cross-platform which

378
00:15:07,410 --> 00:15:13,589
might be good for some of you people who

379
00:15:09,059 --> 00:15:15,509
have very chaotic environments however

380
00:15:13,589 --> 00:15:18,360
you will probably need to learn Ruby or

381
00:15:15,509 --> 00:15:20,669
PowerShell in order to make it work but

382
00:15:18,360 --> 00:15:24,269
again it does have pretty good coverage

383
00:15:20,669 --> 00:15:26,639
of the attack framework and then there's

384
00:15:24,269 --> 00:15:28,470
RTA arte is pretty cool because it's

385
00:15:26,639 --> 00:15:30,209
just a lot of scripts that you drop on

386
00:15:28,470 --> 00:15:32,100
to your purple saving boxes and then run

387
00:15:30,209 --> 00:15:34,169
so it's super simple you don't even have

388
00:15:32,100 --> 00:15:35,740
to really know Python in order to run it

389
00:15:34,169 --> 00:15:38,439
so again

390
00:15:35,740 --> 00:15:39,790
trivial setup it is only for Windows but

391
00:15:38,440 --> 00:15:45,130
it does give you a really decent

392
00:15:39,790 --> 00:15:47,310
coverage of the attack framework okay

393
00:15:45,130 --> 00:15:50,020
cool nice no thank you

394
00:15:47,310 --> 00:15:52,839
this is the coverage of RTA currently

395
00:15:50,020 --> 00:15:54,640
what I see on the github I went ahead

396
00:15:52,840 --> 00:15:56,470
and map this out so you guys can see

397
00:15:54,640 --> 00:15:58,720
it's pretty decent it doesn't have

398
00:15:56,470 --> 00:16:00,700
everything yet but if you're looking for

399
00:15:58,720 --> 00:16:02,080
something to automate out some of the

400
00:16:00,700 --> 00:16:04,480
categories that you don't want to work

401
00:16:02,080 --> 00:16:10,030
on or that you think early beneath you

402
00:16:04,480 --> 00:16:11,470
definitely try it out so to sum up just

403
00:16:10,030 --> 00:16:13,060
test out all the tools and select the

404
00:16:11,470 --> 00:16:14,710
one that works best in your environment

405
00:16:13,060 --> 00:16:16,540
if you're really bored go make one

406
00:16:14,710 --> 00:16:19,690
yourself definitely and put it out there

407
00:16:16,540 --> 00:16:21,459
for everybody else to use if you're

408
00:16:19,690 --> 00:16:22,990
running a lot of stuff in your

409
00:16:21,460 --> 00:16:25,390
environment again probably use atomic

410
00:16:22,990 --> 00:16:30,160
Red Team pure Windows maybe called error

411
00:16:25,390 --> 00:16:33,100
or ITA all right

412
00:16:30,160 --> 00:16:35,500
so to sum up I think that when done

413
00:16:33,100 --> 00:16:38,080
correctly purple team is everything it's

414
00:16:35,500 --> 00:16:40,750
chalked up to be it's just a matter of

415
00:16:38,080 --> 00:16:42,160
doing it right a lot of times it's

416
00:16:40,750 --> 00:16:44,680
complicated to bring all that where

417
00:16:42,160 --> 00:16:47,800
these resources that you see online into

418
00:16:44,680 --> 00:16:50,859
one vision that you can see so use these

419
00:16:47,800 --> 00:16:54,609
resources that I've compiled as kind of

420
00:16:50,860 --> 00:16:56,590
a map for you to build your own it

421
00:16:54,610 --> 00:16:58,060
purple team again can improve your

422
00:16:56,590 --> 00:16:59,700
security posture it can train your

423
00:16:58,060 --> 00:17:02,349
employees it can help you learn about

424
00:16:59,700 --> 00:17:04,089
weaknesses in your environment however

425
00:17:02,350 --> 00:17:07,060
you must stick to measurable and

426
00:17:04,089 --> 00:17:09,760
repeatable processes and don't try to

427
00:17:07,060 --> 00:17:12,208
automate yourself into a corner it's to

428
00:17:09,760 --> 00:17:17,230
be a resource to you not to replace you

429
00:17:12,209 --> 00:17:18,670
and I've compiled some resources here in

430
00:17:17,230 --> 00:17:20,620
case you're looking to build your own

431
00:17:18,670 --> 00:17:23,230
purple team or maybe improve on it and

432
00:17:20,619 --> 00:17:26,020
I've put some extra material for test

433
00:17:23,230 --> 00:17:27,490
cases I'll be dropping these slides to

434
00:17:26,020 --> 00:17:30,240
my Twitter later today and also my

435
00:17:27,490 --> 00:17:32,800
LinkedIn so you can check them out there

436
00:17:30,240 --> 00:17:34,840
all right I know I go I mean I know I

437
00:17:32,800 --> 00:17:37,000
went through that super quickly so if

438
00:17:34,840 --> 00:17:39,120
anybody has any questions please ask him

439
00:17:37,000 --> 00:17:39,120
now

440
00:17:40,610 --> 00:17:45,110
focus instead of actually focus so you

441
00:17:43,430 --> 00:17:46,610
give it when you're ready reach like you

442
00:17:45,110 --> 00:17:55,100
everything you can choose klaustreich do

443
00:17:46,610 --> 00:17:57,909
everything you can do with you know so

444
00:17:55,100 --> 00:18:01,550
we did that and initially we ran whole

445
00:17:57,910 --> 00:18:04,310
like whole red team exercises but in a

446
00:18:01,550 --> 00:18:08,360
day during sort of a wargaming exercise

447
00:18:04,310 --> 00:18:09,740
but we found that the blue team was kind

448
00:18:08,360 --> 00:18:12,110
of looking at the wrong tools for that

449
00:18:09,740 --> 00:18:14,120
and they got kind of confused so we

450
00:18:12,110 --> 00:18:15,800
decided to kind of like thumb it not

451
00:18:14,120 --> 00:18:19,129
dumb it down but like simplify it so

452
00:18:15,800 --> 00:18:23,360
that we could just run something test it

453
00:18:19,130 --> 00:18:25,970
run something yeah like you could you

454
00:18:23,360 --> 00:18:28,610
could theoretically do all like a whole

455
00:18:25,970 --> 00:18:48,710
attack chain in one day but it might

456
00:18:28,610 --> 00:18:50,360
like overwhelm you in my experience will

457
00:18:48,710 --> 00:18:51,110
go back and forth a million times to all

458
00:18:50,360 --> 00:18:52,459
come up with something you know

459
00:18:51,110 --> 00:18:54,639
signature don't forget your signature

460
00:18:52,460 --> 00:18:54,640
though

461
00:18:54,730 --> 00:18:59,049
yeah I mean we totally do that - during

462
00:18:56,860 --> 00:19:01,120
the purple team exercise I mean with me

463
00:18:59,049 --> 00:19:02,918
me cats for example I was able to like

464
00:19:01,120 --> 00:19:04,270
obvi scape my way around everything that

465
00:19:02,919 --> 00:19:06,130
the blue team was able to come up with

466
00:19:04,270 --> 00:19:09,460
so there's definitely a lot of like

467
00:19:06,130 --> 00:19:11,230
iteration through that um and a lot of a

468
00:19:09,460 --> 00:19:12,970
lot of attack framework actually is just

469
00:19:11,230 --> 00:19:15,100
specific tools that they say this is bad

470
00:19:12,970 --> 00:19:17,080
and then they give you test cases for it

471
00:19:15,100 --> 00:19:20,620
so a lot of those tools have different

472
00:19:17,080 --> 00:19:22,480
applications and I think that I think

473
00:19:20,620 --> 00:19:24,909
that your example probably could be a

474
00:19:22,480 --> 00:19:26,650
full purple team exercise like we hate

475
00:19:24,910 --> 00:19:28,390
pulp cobalt strike we don't want it to

476
00:19:26,650 --> 00:19:30,370
run anywhere and then you just do a

477
00:19:28,390 --> 00:19:32,230
purple team exercise on that I'm just

478
00:19:30,370 --> 00:19:34,389
thinking like if you're maybe like a

479
00:19:32,230 --> 00:19:35,950
younger security organization you

480
00:19:34,390 --> 00:19:38,970
probably don't want to tackle cobalt

481
00:19:35,950 --> 00:19:38,970
strike the first time around

482
00:19:40,679 --> 00:19:52,540
yeah it is super good so it depends fun

483
00:19:50,110 --> 00:19:55,330
how long it takes us to get through one

484
00:19:52,540 --> 00:19:57,820
so we really focus on blocking stuff

485
00:19:55,330 --> 00:19:59,500
we're like making sure it we know what

486
00:19:57,820 --> 00:20:02,439
it takes to actually run something so

487
00:19:59,500 --> 00:20:03,820
our our first one took like one month

488
00:20:02,440 --> 00:20:05,320
and then our second one took three

489
00:20:03,820 --> 00:20:07,750
months three months because we were

490
00:20:05,320 --> 00:20:09,700
tackling a lot more material so it

491
00:20:07,750 --> 00:20:11,679
really depends upon how fast it takes

492
00:20:09,700 --> 00:20:13,630
you to create alerts and what roadblocks

493
00:20:11,679 --> 00:20:15,520
that you find so for example if you

494
00:20:13,630 --> 00:20:16,990
don't have a lot of visibility into like

495
00:20:15,520 --> 00:20:18,370
save power shell that's being run in

496
00:20:16,990 --> 00:20:19,750
your environment you're probably not

497
00:20:18,370 --> 00:20:21,010
going to be able to create decent

498
00:20:19,750 --> 00:20:24,160
PowerShell SIG's

499
00:20:21,010 --> 00:20:24,160
[Music]

500
00:20:31,110 --> 00:20:36,000
sorry what sig Naturals basic Lisa

501
00:20:34,110 --> 00:20:38,340
Jarrett rules that you can use to damn

502
00:20:36,000 --> 00:20:41,100
map old alerts to different systems are

503
00:20:38,340 --> 00:20:42,840
used to valuable thing no no um I

504
00:20:41,100 --> 00:20:44,219
haven't actually heard of that before so

505
00:20:42,840 --> 00:20:46,370
I wouldn't be able to give you a good

506
00:20:44,220 --> 00:20:46,370
answer

507
00:20:48,840 --> 00:20:51,970
[Music]

508
00:20:54,350 --> 00:20:59,519
rules and basically they've used RF

509
00:20:57,090 --> 00:21:02,279
format you take that rule and then you

510
00:20:59,519 --> 00:21:04,500
can convert that into this blog or any

511
00:21:02,279 --> 00:21:06,860
of this sense of why not so it's a

512
00:21:04,500 --> 00:21:09,630
popular thing now that seems like you

513
00:21:06,860 --> 00:21:11,129
know that sounds really cool I feel like

514
00:21:09,630 --> 00:21:13,590
that'd be a really good weights for you

515
00:21:11,130 --> 00:21:25,139
to do purple teaming probably I think

516
00:21:13,590 --> 00:21:27,269
that I missed your question so actually

517
00:21:25,139 --> 00:21:29,309
fixing as many things as can be fixed is

518
00:21:27,269 --> 00:21:32,130
the purple team exercise we run the test

519
00:21:29,309 --> 00:21:34,049
cases as we're developing the fixes it's

520
00:21:32,130 --> 00:21:36,149
the workflow the workflow really

521
00:21:34,049 --> 00:21:38,399
encapsulates the iteration on building

522
00:21:36,149 --> 00:21:42,600
the alerts inside of the purple team

523
00:21:38,399 --> 00:21:45,449
exercise so I run in one test case we

524
00:21:42,600 --> 00:21:55,949
try to we try and alert we try the alert

525
00:21:45,450 --> 00:21:58,320
it doesn't work we try it again when we

526
00:21:55,950 --> 00:22:01,049
are confident in the alert really so we

527
00:21:58,320 --> 00:22:03,120
can talk with our project manager about

528
00:22:01,049 --> 00:22:04,440
like what bounds we have on it and

529
00:22:03,120 --> 00:22:07,289
that's really what we put into like

530
00:22:04,440 --> 00:22:10,049
selecting the test cases and how many

531
00:22:07,289 --> 00:22:12,200
test cases that we want to run does that

532
00:22:10,049 --> 00:22:12,200
make sense

533
00:22:13,580 --> 00:22:21,560
where you have a whole list of defects

534
00:22:16,990 --> 00:22:23,830
itu development teams go yeah yeah

535
00:22:21,560 --> 00:22:23,830
pretty much

536
00:22:26,970 --> 00:22:31,840
having a 1:1 ratio so are you

537
00:22:29,859 --> 00:22:33,549
cross-training your ribs and your booths

538
00:22:31,840 --> 00:22:34,928
so that they understand each other's

539
00:22:33,549 --> 00:22:37,539
language is a little bit better or you

540
00:22:34,929 --> 00:22:38,859
like given focus real hard on one side

541
00:22:37,539 --> 00:22:40,869
to the other like the red tangos and

542
00:22:38,859 --> 00:22:42,369
traps of something finds an example of

543
00:22:40,869 --> 00:22:43,959
one thing and just hand it to the blue

544
00:22:42,369 --> 00:22:44,859
team and the blue team come to bothers

545
00:22:43,960 --> 00:22:46,989
at once and while they're trying to

546
00:22:44,859 --> 00:22:48,639
figure out no so that's actually what's

547
00:22:46,989 --> 00:22:50,379
pretty cool about purple teaming I feel

548
00:22:48,639 --> 00:22:52,330
like is I've learned a ton about our

549
00:22:50,379 --> 00:22:53,769
blue team's tools and like how they go

550
00:22:52,330 --> 00:22:55,928
through incident response how they like

551
00:22:53,769 --> 00:22:58,389
build signatures I've already built a

552
00:22:55,929 --> 00:23:00,729
couple myself actually using the same

553
00:22:58,389 --> 00:23:02,199
tools that they've taught me I don't

554
00:23:00,729 --> 00:23:04,119
know if our blue team is really learning

555
00:23:02,200 --> 00:23:06,220
a lot about the malware since I mostly

556
00:23:04,119 --> 00:23:08,470
just take it and like do stuff with it

557
00:23:06,220 --> 00:23:10,479
and then run it but they do figure out

558
00:23:08,470 --> 00:23:12,399
sometimes House of obfuscated things

559
00:23:10,479 --> 00:23:17,590
while they're trying to figure out what

560
00:23:12,399 --> 00:23:18,070
to stick on for example that I saw your

561
00:23:17,590 --> 00:23:21,809
question

562
00:23:18,070 --> 00:23:21,809
okay cool anybody else

563
00:23:22,410 --> 00:23:31,990
okay thank you so much for having me

564
00:23:25,460 --> 00:23:31,990
[Applause]

