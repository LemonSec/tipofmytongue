1
00:00:03,200 --> 00:00:07,080
thank you for the war welcome and

2
00:00:07,080 --> 00:00:09,059
thank you guys thank you very much for

3
00:00:09,059 --> 00:00:11,639
joining us in this talk

4
00:00:11,639 --> 00:00:14,400
so we will be talking about the Mac OS

5
00:00:14,400 --> 00:00:17,160
malwares as well as since we are the

6
00:00:17,160 --> 00:00:19,740
Defenders side so we will also be

7
00:00:19,740 --> 00:00:21,480
talking about the detection Technologies

8
00:00:21,480 --> 00:00:24,480
and uh you know the tag that we have

9
00:00:24,480 --> 00:00:26,220
there and the improvements that we can

10
00:00:26,220 --> 00:00:27,119
make

11
00:00:27,119 --> 00:00:30,660
but before I start I would say that

12
00:00:30,660 --> 00:00:33,239
Optics is a very high Growth Company

13
00:00:33,239 --> 00:00:35,820
startup right now and we have lots of

14
00:00:35,820 --> 00:00:38,880
open positions so we can talk after this

15
00:00:38,880 --> 00:00:40,620
talk if you guys are interested in that

16
00:00:40,620 --> 00:00:41,760
yeah

17
00:00:41,760 --> 00:00:44,579
so with that I will start uh

18
00:00:44,579 --> 00:00:47,640
with the with the plan that we have for

19
00:00:47,640 --> 00:00:49,320
this presentation today

20
00:00:49,320 --> 00:00:51,539
so we'll talk about the Mac OS malware

21
00:00:51,539 --> 00:00:54,300
landscape uh in which we will describe

22
00:00:54,300 --> 00:00:55,920
like what type of the malware that we

23
00:00:55,920 --> 00:00:59,579
see in the field right now how is the uh

24
00:00:59,579 --> 00:01:01,440
you know the landscape looks like and

25
00:01:01,440 --> 00:01:02,699
then we will talk about the process

26
00:01:02,699 --> 00:01:05,339
Behavior based detection which is uh

27
00:01:05,339 --> 00:01:07,500
like you know in kind of a superior in

28
00:01:07,500 --> 00:01:10,500
terms of the the Legacy Technologies

29
00:01:10,500 --> 00:01:13,020
and then we also briefly talk about the

30
00:01:13,020 --> 00:01:15,060
OS query which is kind of a Defenders

31
00:01:15,060 --> 00:01:18,540
tool and uh you know how OS query can be

32
00:01:18,540 --> 00:01:20,580
used in order to detect the Mac OS

33
00:01:20,580 --> 00:01:22,439
malware and then we will talk about the

34
00:01:22,439 --> 00:01:24,960
some case studies of uh well-known

35
00:01:24,960 --> 00:01:26,700
malwarees that we have acquired through

36
00:01:26,700 --> 00:01:28,200
threat intelligence as well as the

37
00:01:28,200 --> 00:01:30,720
customer telemetry and then we will have

38
00:01:30,720 --> 00:01:33,240
the offensive tools also covered that

39
00:01:33,240 --> 00:01:35,520
are used by the apts or you know the the

40
00:01:35,520 --> 00:01:38,100
interesting things that they use and the

41
00:01:38,100 --> 00:01:40,259
you know commonly abused utilities on

42
00:01:40,259 --> 00:01:42,600
the Mac OS side as well as some of the

43
00:01:42,600 --> 00:01:44,340
things that are uncommonly abused

44
00:01:44,340 --> 00:01:45,900
meaning that they are either used by the

45
00:01:45,900 --> 00:01:48,479
threat actors or by the malware's all

46
00:01:48,479 --> 00:01:50,340
through our in-house red dimming

47
00:01:50,340 --> 00:01:51,420
activities

48
00:01:51,420 --> 00:01:53,700
yeah so that's the plan

49
00:01:53,700 --> 00:01:55,439
so I'll start with the Mac OS malware

50
00:01:55,439 --> 00:02:00,180
landscape uh so it is not as you know

51
00:02:00,180 --> 00:02:03,360
wide or glamorous I would say

52
00:02:03,360 --> 00:02:05,100
equivalent to the windows because in

53
00:02:05,100 --> 00:02:06,780
Windows side you have lots of uh

54
00:02:06,780 --> 00:02:08,880
sophisticated malware's also coming it's

55
00:02:08,880 --> 00:02:10,318
not like the sophistication does not

56
00:02:10,318 --> 00:02:12,480
exist on the macro side but in terms of

57
00:02:12,480 --> 00:02:14,520
the landscape it is not as wide as as

58
00:02:14,520 --> 00:02:15,780
the windows side

59
00:02:15,780 --> 00:02:19,140
but in the if we look at the data from

60
00:02:19,140 --> 00:02:21,120
last four to five years

61
00:02:21,120 --> 00:02:23,099
and

62
00:02:23,099 --> 00:02:25,980
okay

63
00:02:25,980 --> 00:02:28,620
so if you look at the

64
00:02:28,620 --> 00:02:30,780
four or five years of data and we see

65
00:02:30,780 --> 00:02:32,640
like how the landscape is changing in

66
00:02:32,640 --> 00:02:34,920
terms of the the commodity malware as

67
00:02:34,920 --> 00:02:36,780
well as the advanced all the targeted

68
00:02:36,780 --> 00:02:39,780
attacks we see that recently there is an

69
00:02:39,780 --> 00:02:42,720
increase in the targeted attacks on you

70
00:02:42,720 --> 00:02:45,480
know on the cross-platform apts as well

71
00:02:45,480 --> 00:02:47,280
as the malware's when I say

72
00:02:47,280 --> 00:02:49,680
cross-platform if it is it's meaning

73
00:02:49,680 --> 00:02:51,840
that primarily the apts that were

74
00:02:51,840 --> 00:02:53,280
targeting the the Windows operating

75
00:02:53,280 --> 00:02:56,599
systems earlier now they are basically

76
00:02:56,599 --> 00:03:00,239
exploiting the Mac OS also and you know

77
00:03:00,239 --> 00:03:01,860
there is a good evidence and interest

78
00:03:01,860 --> 00:03:04,680
that these guys are basically uh

79
00:03:04,680 --> 00:03:07,019
targeting the Mac OS as well now one of

80
00:03:07,019 --> 00:03:08,940
the interesting cases Lazarus Group

81
00:03:08,940 --> 00:03:12,360
which primarily targets the windows and

82
00:03:12,360 --> 00:03:14,580
is very active from quite some time and

83
00:03:14,580 --> 00:03:16,200
they have you know recently started

84
00:03:16,200 --> 00:03:18,360
targeting the Mac OS as well and same

85
00:03:18,360 --> 00:03:20,040
thing is with wild pressure which is

86
00:03:20,040 --> 00:03:22,140
normally the Middle East countries

87
00:03:22,140 --> 00:03:24,239
targeting the Middle East countries and

88
00:03:24,239 --> 00:03:26,459
storm cloud and you know the iron tiger

89
00:03:26,459 --> 00:03:28,680
which targets the Chinese speaking

90
00:03:28,680 --> 00:03:32,819
Nationals so from this we can say I mean

91
00:03:32,819 --> 00:03:34,920
if you look at these Trends we are

92
00:03:34,920 --> 00:03:37,019
pretty much in a state where we can say

93
00:03:37,019 --> 00:03:39,959
that you know going forward if you look

94
00:03:39,959 --> 00:03:43,080
at the the trend that is going to be uh

95
00:03:43,080 --> 00:03:45,360
largely the the APT and the malware are

96
00:03:45,360 --> 00:03:47,220
going to focus on the cross-platform

97
00:03:47,220 --> 00:03:48,959
things including the new technologies

98
00:03:48,959 --> 00:03:51,120
that are coming like go language and you

99
00:03:51,120 --> 00:03:52,560
know all these things that will get the

100
00:03:52,560 --> 00:03:55,080
traction from the uh the Malaysia

101
00:03:55,080 --> 00:03:56,099
sectors

102
00:03:56,099 --> 00:03:58,980
to add to this there is a uh you know

103
00:03:58,980 --> 00:04:00,360
silver Sparrow malware that was

104
00:04:00,360 --> 00:04:03,000
discovered by Red Canary I guess uh it

105
00:04:03,000 --> 00:04:04,739
is the first malware that targets the M1

106
00:04:04,739 --> 00:04:08,280
chip and uh Hammond chip is not you know

107
00:04:08,280 --> 00:04:10,920
it's it's very new chip from Apple it

108
00:04:10,920 --> 00:04:12,900
got you know it was released in I think

109
00:04:12,900 --> 00:04:16,079
January 2021 or so and within the six

110
00:04:16,079 --> 00:04:18,540
months we got this first malware that

111
00:04:18,540 --> 00:04:20,160
was basically using the M1 chip

112
00:04:20,160 --> 00:04:21,660
architecture right which is like

113
00:04:21,660 --> 00:04:23,520
different than the x86

114
00:04:23,520 --> 00:04:26,759
now here we can uh you know see that

115
00:04:26,759 --> 00:04:28,320
there is an interest it's not as

116
00:04:28,320 --> 00:04:30,600
sophisticated if you say that okay this

117
00:04:30,600 --> 00:04:32,220
is you know next level targeted attack

118
00:04:32,220 --> 00:04:34,680
or apt itself commodity malware with

119
00:04:34,680 --> 00:04:36,840
reasonable level of you know the you

120
00:04:36,840 --> 00:04:39,600
know the the threats or the techniques

121
00:04:39,600 --> 00:04:43,080
that it is using uh but from this we can

122
00:04:43,080 --> 00:04:45,600
see that there is an interest on uh on

123
00:04:45,600 --> 00:04:48,300
the Mac OS also as the new technology is

124
00:04:48,300 --> 00:04:50,400
coming the attackers are actually using

125
00:04:50,400 --> 00:04:51,960
that maybe for a testing purpose we

126
00:04:51,960 --> 00:04:54,900
don't know yet for sure and you know

127
00:04:54,900 --> 00:04:57,000
they might use that thing as a part of

128
00:04:57,000 --> 00:04:59,220
experimentation and then use later on

129
00:04:59,220 --> 00:05:01,500
so this is the breakup of the malware

130
00:05:01,500 --> 00:05:03,660
that we see as I said like it's not as

131
00:05:03,660 --> 00:05:05,520
fancy as you see it on the Windows side

132
00:05:05,520 --> 00:05:08,639
but on the macro side this data we have

133
00:05:08,639 --> 00:05:10,080
compiled through our in-house sandbox

134
00:05:10,080 --> 00:05:12,780
for Mac OS that we have as well as the

135
00:05:12,780 --> 00:05:14,940
customer Telemetry that comes to our you

136
00:05:14,940 --> 00:05:17,280
know the SAS platform

137
00:05:17,280 --> 00:05:19,380
and here we can clearly see in the

138
00:05:19,380 --> 00:05:21,600
commodity malware Slayer and bundler are

139
00:05:21,600 --> 00:05:24,539
the the top one that ranks very high in

140
00:05:24,539 --> 00:05:26,639
terms of Mac OS infections worldwide

141
00:05:26,639 --> 00:05:30,000
that we see there is a YT downloader

142
00:05:30,000 --> 00:05:31,800
also that we have seen in you know

143
00:05:31,800 --> 00:05:33,600
various customer telemetries and so

144
00:05:33,600 --> 00:05:36,900
which is a kind of active since the data

145
00:05:36,900 --> 00:05:39,060
is huge and Slayer and bundler mostly

146
00:05:39,060 --> 00:05:40,800
reads the pack so that that is not

147
00:05:40,800 --> 00:05:42,840
really visible in there but that's a

148
00:05:42,840 --> 00:05:45,900
interesting case the um the other thing

149
00:05:45,900 --> 00:05:48,180
that we are observing and it is in line

150
00:05:48,180 --> 00:05:49,800
with the other operating systems as well

151
00:05:49,800 --> 00:05:51,660
like in Windows it started a little bit

152
00:05:51,660 --> 00:05:55,680
uh before uh but on the Mac OS and Linux

153
00:05:55,680 --> 00:05:57,900
right uh like in Windows you have LOL

154
00:05:57,900 --> 00:05:59,880
bins that living off the land binaries

155
00:05:59,880 --> 00:06:01,979
that attackers use these things and in

156
00:06:01,979 --> 00:06:04,500
uh Linux you have GTFO bins that you can

157
00:06:04,500 --> 00:06:06,240
use and carry out the malicious activity

158
00:06:06,240 --> 00:06:08,460
similarly in the Mac OS we are calling

159
00:06:08,460 --> 00:06:10,320
it as a Mac OS bins and we see a

160
00:06:10,320 --> 00:06:12,840
increased usage of these utilities based

161
00:06:12,840 --> 00:06:16,020
on the data that we have uh like the

162
00:06:16,020 --> 00:06:17,820
attackers are using it

163
00:06:17,820 --> 00:06:19,620
along with this there is a new trend

164
00:06:19,620 --> 00:06:23,039
that we are you know uh noticing around

165
00:06:23,039 --> 00:06:25,139
these threat activities one is the open

166
00:06:25,139 --> 00:06:28,020
source tools so earlier you know back in

167
00:06:28,020 --> 00:06:29,699
the days malware's used to write their

168
00:06:29,699 --> 00:06:31,440
uh no sorry attackers used to write

169
00:06:31,440 --> 00:06:33,900
their own code for the malabares and all

170
00:06:33,900 --> 00:06:35,699
these kind of things but now that trend

171
00:06:35,699 --> 00:06:37,680
is Shifting to use the inbuilt system

172
00:06:37,680 --> 00:06:40,259
utilities so that they can use that for

173
00:06:40,259 --> 00:06:42,720
defensive agent or uh you know lower

174
00:06:42,720 --> 00:06:44,460
their footprint and from a detection

175
00:06:44,460 --> 00:06:47,400
side of view like the guy like us that

176
00:06:47,400 --> 00:06:49,199
are on the defender side it's become

177
00:06:49,199 --> 00:06:50,880
challenging also because if it's a

178
00:06:50,880 --> 00:06:52,500
system utility let's for example if you

179
00:06:52,500 --> 00:06:54,240
are using a screen capture it's

180
00:06:54,240 --> 00:06:55,979
practically no way to say whether the

181
00:06:55,979 --> 00:06:57,840
screen capture is used for malicious

182
00:06:57,840 --> 00:06:59,819
purpose or used for a you know a

183
00:06:59,819 --> 00:07:01,440
estimate purpose in that case right so

184
00:07:01,440 --> 00:07:03,180
that challenge is always there and for

185
00:07:03,180 --> 00:07:04,680
attacker they don't have to write the

186
00:07:04,680 --> 00:07:06,300
new code they are just using that you

187
00:07:06,300 --> 00:07:08,400
know Apple signed last image binary in

188
00:07:08,400 --> 00:07:10,800
in that environment right and open

189
00:07:10,800 --> 00:07:12,539
source tool again comes into multiple

190
00:07:12,539 --> 00:07:14,699
flowers some are python some are go and

191
00:07:14,699 --> 00:07:16,199
you know all these kind of things that

192
00:07:16,199 --> 00:07:17,580
are cross-platform in nature meaning

193
00:07:17,580 --> 00:07:20,520
that you can run on on Windows Linux and

194
00:07:20,520 --> 00:07:23,880
Mac OS as well so that trend is also

195
00:07:23,880 --> 00:07:25,919
increasing because uh majority of these

196
00:07:25,919 --> 00:07:27,660
tools are either created by the red team

197
00:07:27,660 --> 00:07:30,840
activity I think the talk just before us

198
00:07:30,840 --> 00:07:34,080
was around the right teaming activity on

199
00:07:34,080 --> 00:07:35,520
the Mac OS right

200
00:07:35,520 --> 00:07:38,520
so in in that we saw like you know the

201
00:07:38,520 --> 00:07:40,560
guy used the Mythic to actually

202
00:07:40,560 --> 00:07:42,419
compromise the Mac OS and stuff like

203
00:07:42,419 --> 00:07:44,340
that so those are open source tool and

204
00:07:44,340 --> 00:07:47,160
we see increased use usage of those

205
00:07:47,160 --> 00:07:48,960
tools into the advanced and targeted

206
00:07:48,960 --> 00:07:51,360
attacks as well right so that's you know

207
00:07:51,360 --> 00:07:55,740
overall Mac OS malware landscape now

208
00:07:55,740 --> 00:07:58,800
our talk is mostly on the technology

209
00:07:58,800 --> 00:08:01,440
that we have on the detection site

210
00:08:01,440 --> 00:08:03,960
because we work on the defense side of

211
00:08:03,960 --> 00:08:05,039
the story

212
00:08:05,039 --> 00:08:07,500
and in this one we have like process

213
00:08:07,500 --> 00:08:09,780
Behavior detection but the you know the

214
00:08:09,780 --> 00:08:12,000
kind of uh industry name for it like the

215
00:08:12,000 --> 00:08:13,620
EDR which is endpoint detection and

216
00:08:13,620 --> 00:08:15,720
response there are Legacy Technologies

217
00:08:15,720 --> 00:08:18,840
like static signatures now I call these

218
00:08:18,840 --> 00:08:21,240
as Legacy Technologies it does not mean

219
00:08:21,240 --> 00:08:24,240
that they are useless the the thing in

220
00:08:24,240 --> 00:08:27,000
security is that as we learn more and

221
00:08:27,000 --> 00:08:28,919
more attacks we try to define the

222
00:08:28,919 --> 00:08:31,259
solutions accordingly and as the

223
00:08:31,259 --> 00:08:33,419
solutions will come then attackers will

224
00:08:33,419 --> 00:08:34,799
try to bypass those Solutions

225
00:08:34,799 --> 00:08:36,779
accordingly right so the threat

226
00:08:36,779 --> 00:08:38,880
Landscaping security keeps changing very

227
00:08:38,880 --> 00:08:40,979
frequently for example if you look 10

228
00:08:40,979 --> 00:08:42,779
years back then the exploits were like

229
00:08:42,779 --> 00:08:44,940
pretty heavy exploit kits were pretty

230
00:08:44,940 --> 00:08:47,220
pretty well known and used right but if

231
00:08:47,220 --> 00:08:49,019
you see the level of exploitation right

232
00:08:49,019 --> 00:08:50,700
now it's extremely difficult because you

233
00:08:50,700 --> 00:08:52,380
have so many protection coming on onto

234
00:08:52,380 --> 00:08:54,000
the operating system you have so many

235
00:08:54,000 --> 00:08:56,160
protection coming on the processor and

236
00:08:56,160 --> 00:08:58,380
then you know memory management and all

237
00:08:58,380 --> 00:09:00,060
these kind of things right so it does

238
00:09:00,060 --> 00:09:01,680
not mean that the technologies that were

239
00:09:01,680 --> 00:09:03,600
there earlier developed to tackle those

240
00:09:03,600 --> 00:09:05,580
things are today useless but there might

241
00:09:05,580 --> 00:09:07,380
be different use cases for them like for

242
00:09:07,380 --> 00:09:09,779
example static signature might not be

243
00:09:09,779 --> 00:09:13,080
really useful in today's world for you

244
00:09:13,080 --> 00:09:13,740
know

245
00:09:13,740 --> 00:09:15,480
you know malware detection for example

246
00:09:15,480 --> 00:09:18,600
right but it is one thing that can be

247
00:09:18,600 --> 00:09:21,540
really good in terms of attribution for

248
00:09:21,540 --> 00:09:24,959
example that we have we can have a

249
00:09:24,959 --> 00:09:27,360
generic detection maybe it's an AIML or

250
00:09:27,360 --> 00:09:28,860
maybe it's a process Behavior based

251
00:09:28,860 --> 00:09:30,720
detections combined with the AI and ml

252
00:09:30,720 --> 00:09:32,700
but at the end of the day it will always

253
00:09:32,700 --> 00:09:34,980
say Hey you know this is we have

254
00:09:34,980 --> 00:09:36,600
detected this malicious technique based

255
00:09:36,600 --> 00:09:37,920
on the technique or tactic I will

256
00:09:37,920 --> 00:09:39,600
discuss about about the miter framework

257
00:09:39,600 --> 00:09:41,640
but that does not really attribute that

258
00:09:41,640 --> 00:09:43,860
thing to anybody but if you want an

259
00:09:43,860 --> 00:09:45,899
attribution let's say that hope which

260
00:09:45,899 --> 00:09:48,480
tool is this one is it lasagne that is

261
00:09:48,480 --> 00:09:50,339
used by the AP threat actors how many

262
00:09:50,339 --> 00:09:53,160
apt are using that thing or so we if we

263
00:09:53,160 --> 00:09:54,899
have to be specific then we have to use

264
00:09:54,899 --> 00:09:57,420
the static signatures right so it's not

265
00:09:57,420 --> 00:09:59,880
right now it's not very effective in

266
00:09:59,880 --> 00:10:01,380
terms of detection but it's good for

267
00:10:01,380 --> 00:10:04,019
attribution now similar stuff is with

268
00:10:04,019 --> 00:10:06,600
the network signatures uh it was

269
00:10:06,600 --> 00:10:08,580
designed in a hope that since the

270
00:10:08,580 --> 00:10:10,920
malware code the piece of code that you

271
00:10:10,920 --> 00:10:12,660
know we write signatures on keeps

272
00:10:12,660 --> 00:10:14,580
changing because of the the way

273
00:10:14,580 --> 00:10:16,500
polymorphism or even the code

274
00:10:16,500 --> 00:10:19,019
obfuscation works and it's pretty easy

275
00:10:19,019 --> 00:10:20,820
to obfuscate the code in pretty much any

276
00:10:20,820 --> 00:10:22,500
language whether it's a cc plus plus or

277
00:10:22,500 --> 00:10:24,240
you know JavaScript or or any other

278
00:10:24,240 --> 00:10:27,000
language so you can put the and each

279
00:10:27,000 --> 00:10:28,440
time that code would would be different

280
00:10:28,440 --> 00:10:30,420
so you would need a different signature

281
00:10:30,420 --> 00:10:32,459
and it's it will not really be a

282
00:10:32,459 --> 00:10:34,260
scalable option so the networks

283
00:10:34,260 --> 00:10:36,839
signatures were designed since the the

284
00:10:36,839 --> 00:10:38,760
CNC communication is going to be largely

285
00:10:38,760 --> 00:10:40,320
same across the binaries let's say if

286
00:10:40,320 --> 00:10:41,700
the attackers are creating some binaries

287
00:10:41,700 --> 00:10:43,620
then the network traffic is largely

288
00:10:43,620 --> 00:10:45,720
going to be the same there might be 1000

289
00:10:45,720 --> 00:10:48,180
or million hashes or the binary is

290
00:10:48,180 --> 00:10:50,519
associated with but the network you know

291
00:10:50,519 --> 00:10:52,019
kind of traffic is going to be the same

292
00:10:52,019 --> 00:10:54,180
but that thing is changing with the new

293
00:10:54,180 --> 00:10:56,519
technologies like Cloud we have you know

294
00:10:56,519 --> 00:10:58,079
the other technologies that are coming

295
00:10:58,079 --> 00:11:00,240
where attackers can host on the estimate

296
00:11:00,240 --> 00:11:03,180
uh you know infrastructure on the El

297
00:11:03,180 --> 00:11:05,519
estimate cloud service provider or the

298
00:11:05,519 --> 00:11:09,300
uh you know the stuff like that and now

299
00:11:09,300 --> 00:11:11,399
the encryption of the traffic is also

300
00:11:11,399 --> 00:11:13,380
making that thing challenging

301
00:11:13,380 --> 00:11:15,779
uh so this is also not solving the

302
00:11:15,779 --> 00:11:18,240
purpose the other technology that is

303
00:11:18,240 --> 00:11:20,519
much more closer to the process Behavior

304
00:11:20,519 --> 00:11:22,320
detection is the sandbox one

305
00:11:22,320 --> 00:11:24,899
and uh it's an interesting one uh

306
00:11:24,899 --> 00:11:26,820
because what you are doing in this

307
00:11:26,820 --> 00:11:28,320
technology is basically you have piece

308
00:11:28,320 --> 00:11:29,820
of code or the malware that you are

309
00:11:29,820 --> 00:11:32,519
getting and you are trying to

310
00:11:32,519 --> 00:11:34,920
detonate that malware by detonation

311
00:11:34,920 --> 00:11:36,420
means that you are trying to run that

312
00:11:36,420 --> 00:11:38,640
malware on a controlled environment to

313
00:11:38,640 --> 00:11:40,620
see what exactly the malware is behaving

314
00:11:40,620 --> 00:11:43,440
right how the malware will react meaning

315
00:11:43,440 --> 00:11:45,180
the binary will react and on the basis

316
00:11:45,180 --> 00:11:46,620
of that you will decide whether it's a

317
00:11:46,620 --> 00:11:48,600
malicious activity or is a banana an

318
00:11:48,600 --> 00:11:50,339
activity but there are challenges to the

319
00:11:50,339 --> 00:11:52,920
sandbox for example sandbox there are

320
00:11:52,920 --> 00:11:55,800
technique technology limitations meaning

321
00:11:55,800 --> 00:11:58,380
that inside box the scalability issues

322
00:11:58,380 --> 00:12:00,420
are there where you can you know you can

323
00:12:00,420 --> 00:12:03,360
have 200 300 or 400 virtual machines for

324
00:12:03,360 --> 00:12:05,160
different platforms but they will

325
00:12:05,160 --> 00:12:07,320
execute the number of influx samples

326
00:12:07,320 --> 00:12:09,120
that are coming they can execute those

327
00:12:09,120 --> 00:12:10,500
for let's say three minutes or four

328
00:12:10,500 --> 00:12:12,600
minutes and after that it won't be there

329
00:12:12,600 --> 00:12:14,880
but the attacks that are very

330
00:12:14,880 --> 00:12:16,860
sophisticated in nature requires

331
00:12:16,860 --> 00:12:18,660
multiple days of engagement right it's

332
00:12:18,660 --> 00:12:20,940
not just a piece of code you will get a

333
00:12:20,940 --> 00:12:22,380
piece of code maybe in the initial

334
00:12:22,380 --> 00:12:23,880
access phase or at some point in time

335
00:12:23,880 --> 00:12:25,440
but then there is a real guy who is

336
00:12:25,440 --> 00:12:27,000
behind the picture who is actually

337
00:12:27,000 --> 00:12:28,860
trying to uh you know fulfill the

338
00:12:28,860 --> 00:12:32,399
motives that he try to you know achieve

339
00:12:32,399 --> 00:12:34,440
so the problem with sandbox is that it

340
00:12:34,440 --> 00:12:36,480
can never emulate it can never ever

341
00:12:36,480 --> 00:12:38,940
emulate the real environment that is

342
00:12:38,940 --> 00:12:40,860
there on the end point right so that's

343
00:12:40,860 --> 00:12:42,779
the weakness of that and and because of

344
00:12:42,779 --> 00:12:45,000
that the process behavioral based

345
00:12:45,000 --> 00:12:47,100
detection came into the picture that why

346
00:12:47,100 --> 00:12:48,660
not have this type of Technology

347
00:12:48,660 --> 00:12:50,399
directly onto the endpoints right

348
00:12:50,399 --> 00:12:52,200
because then now the technology is much

349
00:12:52,200 --> 00:12:55,260
more uh you know scalable in terms of

350
00:12:55,260 --> 00:12:57,180
collection of the data because of the

351
00:12:57,180 --> 00:13:00,720
Big Data technology so the whole premise

352
00:13:00,720 --> 00:13:03,300
of this thinking is just exactly like

353
00:13:03,300 --> 00:13:05,940
sandbox but here we say that hey you

354
00:13:05,940 --> 00:13:07,200
know whatever the activity that is

355
00:13:07,200 --> 00:13:08,760
happening on the end point just collect

356
00:13:08,760 --> 00:13:10,980
that whether it's a process activity you

357
00:13:10,980 --> 00:13:13,380
know file activity socket activity just

358
00:13:13,380 --> 00:13:15,420
collect that thing right and then there

359
00:13:15,420 --> 00:13:16,980
are threat teams the detection teams

360
00:13:16,980 --> 00:13:18,779
that I analyze lots of palliates then

361
00:13:18,779 --> 00:13:20,399
they will try to write a rule all the

362
00:13:20,399 --> 00:13:22,740
threat models to basically find

363
00:13:22,740 --> 00:13:25,079
anomalies inside this streaming of data

364
00:13:25,079 --> 00:13:27,240
that is coming and then

365
00:13:27,240 --> 00:13:29,880
you know provide the detection now here

366
00:13:29,880 --> 00:13:32,040
the important thing is is the

367
00:13:32,040 --> 00:13:34,200
correlation because the events are

368
00:13:34,200 --> 00:13:36,959
streaming to you not in a singular way I

369
00:13:36,959 --> 00:13:38,760
mean not in a combined way like what

370
00:13:38,760 --> 00:13:40,800
exactly this process is doing but but in

371
00:13:40,800 --> 00:13:42,360
a singular way like as the event is

372
00:13:42,360 --> 00:13:43,680
happening it is coming to you as the

373
00:13:43,680 --> 00:13:45,060
event is happening it is coming to you

374
00:13:45,060 --> 00:13:48,060
so uh at a single event Point as I said

375
00:13:48,060 --> 00:13:51,540
like if you do a screen capture then it

376
00:13:51,540 --> 00:13:53,519
might not really suggest that this is a

377
00:13:53,519 --> 00:13:55,380
malicious activity because screen

378
00:13:55,380 --> 00:13:57,180
capture is pretty much a benign thing

379
00:13:57,180 --> 00:13:59,160
right but depending on the context it

380
00:13:59,160 --> 00:14:00,899
might be malicious so you have to have

381
00:14:00,899 --> 00:14:03,600
the correlation in such a way that you

382
00:14:03,600 --> 00:14:05,220
can correlate that activity that is

383
00:14:05,220 --> 00:14:06,899
coming and say that hey you know this

384
00:14:06,899 --> 00:14:08,700
looks like a suspicious malicious

385
00:14:08,700 --> 00:14:10,800
activity right so the correlation and

386
00:14:10,800 --> 00:14:12,300
then after the correlation attribution

387
00:14:12,300 --> 00:14:13,620
and detection will happen naturally

388
00:14:13,620 --> 00:14:15,360
because you have the correlation right

389
00:14:15,360 --> 00:14:19,500
now the one thing that really solves

390
00:14:19,500 --> 00:14:22,200
this problem at a framework level is the

391
00:14:22,200 --> 00:14:23,940
miter attack framework I'm not sure how

392
00:14:23,940 --> 00:14:25,680
like how many of you are aware about the

393
00:14:25,680 --> 00:14:27,180
miter attack framework

394
00:14:27,180 --> 00:14:30,180
but it's a nice framework in terms of uh

395
00:14:30,180 --> 00:14:31,019
you know

396
00:14:31,019 --> 00:14:33,720
providing a kind of infrastructure where

397
00:14:33,720 --> 00:14:35,339
you don't have to be a really

398
00:14:35,339 --> 00:14:37,139
sophisticated in the security meaning

399
00:14:37,139 --> 00:14:39,180
that you don't have to be a reverse

400
00:14:39,180 --> 00:14:41,220
engineer or you know know the

401
00:14:41,220 --> 00:14:42,720
architecture of a processor or another

402
00:14:42,720 --> 00:14:44,040
memory management how the operating

403
00:14:44,040 --> 00:14:46,260
system does its memory management all

404
00:14:46,260 --> 00:14:47,880
you have to do is just look at these

405
00:14:47,880 --> 00:14:50,220
techniques and the tactics that might

406
00:14:50,220 --> 00:14:52,019
has defined and then you can understand

407
00:14:52,019 --> 00:14:54,360
like what the stuff these attackers are

408
00:14:54,360 --> 00:14:55,500
doing right so it's basically a

409
00:14:55,500 --> 00:14:57,720
knowledge base for attacker ttps and how

410
00:14:57,720 --> 00:15:00,480
it helps the in the detection is like

411
00:15:00,480 --> 00:15:02,100
when you are collecting these singular

412
00:15:02,100 --> 00:15:04,440
events that are coming to you you can

413
00:15:04,440 --> 00:15:07,139
label those techniques we as per the

414
00:15:07,139 --> 00:15:09,120
miter specification like whether it's a

415
00:15:09,120 --> 00:15:10,980
persistence whether it's a defensive

416
00:15:10,980 --> 00:15:13,260
agent whether it's impact and by that

417
00:15:13,260 --> 00:15:16,199
you will if the correlation is in uh you

418
00:15:16,199 --> 00:15:17,820
know in good State then you will see the

419
00:15:17,820 --> 00:15:19,500
progression of attack through various

420
00:15:19,500 --> 00:15:22,139
stages and that's what differentiate a

421
00:15:22,139 --> 00:15:24,000
benign activity the analysis activity

422
00:15:24,000 --> 00:15:26,040
because in malicious you will have a lot

423
00:15:26,040 --> 00:15:27,899
more stuff going on during that time

424
00:15:27,899 --> 00:15:30,779
frame uh rather than a benign you know

425
00:15:30,779 --> 00:15:32,639
activity like if it is a screen capture

426
00:15:32,639 --> 00:15:34,560
then you probably took screen capture

427
00:15:34,560 --> 00:15:36,180
you just crossed you did nothing after

428
00:15:36,180 --> 00:15:39,300
that right but in a in a malware attack

429
00:15:39,300 --> 00:15:41,100
or you know in an advanced attack it

430
00:15:41,100 --> 00:15:42,720
might be you are doing a screen capture

431
00:15:42,720 --> 00:15:45,720
then you are doing a you know of

432
00:15:45,720 --> 00:15:47,639
whatever the data that you did and then

433
00:15:47,639 --> 00:15:49,680
you might be trying to exfiltrate that

434
00:15:49,680 --> 00:15:51,779
to you know some cloud services or so

435
00:15:51,779 --> 00:15:53,459
right so that's where the correlation

436
00:15:53,459 --> 00:15:55,199
and attribution also comes into the

437
00:15:55,199 --> 00:15:56,940
picture now the people that don't know

438
00:15:56,940 --> 00:15:59,820
uh about the miter I have this thing

439
00:15:59,820 --> 00:16:03,360
here this is the my attack framework and

440
00:16:03,360 --> 00:16:06,480
it basically all of these top buckets

441
00:16:06,480 --> 00:16:08,160
that you see these are known as tactics

442
00:16:08,160 --> 00:16:10,199
and everything that is inside it is

443
00:16:10,199 --> 00:16:12,300
known as techniques right and this is

444
00:16:12,300 --> 00:16:14,220
all platform based meaning that it is

445
00:16:14,220 --> 00:16:16,620
applicable to Mac OS Linux and windows

446
00:16:16,620 --> 00:16:19,320
but what it really does is like it

447
00:16:19,320 --> 00:16:21,480
really nicely uh you know say like for

448
00:16:21,480 --> 00:16:23,760
example scheduled task or job it means

449
00:16:23,760 --> 00:16:26,100
that somebody is trying to schedule a

450
00:16:26,100 --> 00:16:28,139
task on the system right and a job right

451
00:16:28,139 --> 00:16:30,540
but if you look at a single uh activity

452
00:16:30,540 --> 00:16:33,720
from here then scheduling a task cannot

453
00:16:33,720 --> 00:16:35,279
really be considered a malicious until

454
00:16:35,279 --> 00:16:37,199
or unless we have further evidence of

455
00:16:37,199 --> 00:16:38,820
saying that hey you know there is

456
00:16:38,820 --> 00:16:40,259
something else is also going for example

457
00:16:40,259 --> 00:16:41,699
might be persistence is also going

458
00:16:41,699 --> 00:16:43,560
somebody is scheduling a task then

459
00:16:43,560 --> 00:16:45,120
somebody is also creating an account on

460
00:16:45,120 --> 00:16:46,800
the system right and if these things are

461
00:16:46,800 --> 00:16:49,320
correlated to a same activity then boom

462
00:16:49,320 --> 00:16:50,639
we have a detection for those things

463
00:16:50,639 --> 00:16:52,320
right so it's a very nice framework in

464
00:16:52,320 --> 00:16:55,500
terms of uh you know providing that

465
00:16:55,500 --> 00:16:57,740
framework framework for detection

466
00:16:57,740 --> 00:16:59,279
now

467
00:16:59,279 --> 00:17:01,199
now the next obvious question will come

468
00:17:01,199 --> 00:17:03,180
like okay on Windows there are pretty

469
00:17:03,180 --> 00:17:05,220
mature products that you see there are

470
00:17:05,220 --> 00:17:06,839
lots of companies also that actually

471
00:17:06,839 --> 00:17:08,819
provide Windows uh you know maturity

472
00:17:08,819 --> 00:17:11,699
platforms uh what about the Mac OS or

473
00:17:11,699 --> 00:17:13,679
the Linux right look the Macos is not

474
00:17:13,679 --> 00:17:16,319
something that uh is very uh even in the

475
00:17:16,319 --> 00:17:18,780
landscape I as I you know shared it's

476
00:17:18,780 --> 00:17:21,599
not that much but there is a tool that

477
00:17:21,599 --> 00:17:23,579
Facebook actually published back in the

478
00:17:23,579 --> 00:17:26,520
days called OS query and it's a pretty

479
00:17:26,520 --> 00:17:28,319
amazing and pretty powerful tool so the

480
00:17:28,319 --> 00:17:29,940
people that don't know what exactly OS

481
00:17:29,940 --> 00:17:31,500
query is I will share the link you can

482
00:17:31,500 --> 00:17:33,720
go and then you can read about it but

483
00:17:33,720 --> 00:17:36,059
the premise of tool is that OS query

484
00:17:36,059 --> 00:17:37,559
meaning that operating operating system

485
00:17:37,559 --> 00:17:39,960
query so you can practically query

486
00:17:39,960 --> 00:17:41,820
anything on your operating system so you

487
00:17:41,820 --> 00:17:43,799
can just type a structured query like

488
00:17:43,799 --> 00:17:45,840
select star from processes and you will

489
00:17:45,840 --> 00:17:47,340
get all the running processes that are

490
00:17:47,340 --> 00:17:48,960
there right and that's an amazing

491
00:17:48,960 --> 00:17:50,880
technology right now the good thing

492
00:17:50,880 --> 00:17:52,860
about OS query is that it supports both

493
00:17:52,860 --> 00:17:54,720
events and scheduled query when I'm

494
00:17:54,720 --> 00:17:56,400
saying events events is more of a

495
00:17:56,400 --> 00:17:57,840
real-time activity let's say you are

496
00:17:57,840 --> 00:17:59,880
spawning a calculator or you're spawning

497
00:17:59,880 --> 00:18:01,799
a notepad or something like that right

498
00:18:01,799 --> 00:18:03,780
as that activity is happening it is

499
00:18:03,780 --> 00:18:05,640
being streamed depending on your

500
00:18:05,640 --> 00:18:07,380
technology you can do it in in either

501
00:18:07,380 --> 00:18:09,059
way or the endpoint or stream it to the

502
00:18:09,059 --> 00:18:11,640
cloud uh so that's the real-time event

503
00:18:11,640 --> 00:18:14,340
activity the schedule query pack are

504
00:18:14,340 --> 00:18:17,100
mostly uh you know useful in terms of

505
00:18:17,100 --> 00:18:19,620
when you have you don't really have the

506
00:18:19,620 --> 00:18:21,179
urgency of real time for example you

507
00:18:21,179 --> 00:18:22,860
want to just collect how many users are

508
00:18:22,860 --> 00:18:26,280
there onto the end point right so you

509
00:18:26,280 --> 00:18:27,840
can just say that select start from

510
00:18:27,840 --> 00:18:29,340
users and you will get the list of those

511
00:18:29,340 --> 00:18:30,419
things right

512
00:18:30,419 --> 00:18:33,120
the other thing about film uh OS query

513
00:18:33,120 --> 00:18:35,280
is that it also supports file Integrity

514
00:18:35,280 --> 00:18:37,760
monitoring meaning that you can specify

515
00:18:37,760 --> 00:18:41,940
your configuration of file that you want

516
00:18:41,940 --> 00:18:44,580
to get and not meaning the event if any

517
00:18:44,580 --> 00:18:47,520
changes happen to that file or the

518
00:18:47,520 --> 00:18:48,780
directory and it's a very powerful

519
00:18:48,780 --> 00:18:50,940
feature so I think in the red teaming

520
00:18:50,940 --> 00:18:53,640
session just before this talk there was

521
00:18:53,640 --> 00:18:56,700
a you know uh our friend basically used

522
00:18:56,700 --> 00:18:58,679
the method to compromise the Mac OS

523
00:18:58,679 --> 00:19:02,160
machine and then uh I think he's he's

524
00:19:02,160 --> 00:19:06,360
there but uh then AWS and uh you know

525
00:19:06,360 --> 00:19:09,000
openvpn configuration you know the

526
00:19:09,000 --> 00:19:10,440
normal extraction or password that

527
00:19:10,440 --> 00:19:11,940
happens through the configuration so you

528
00:19:11,940 --> 00:19:14,100
can have a film configuration that will

529
00:19:14,100 --> 00:19:16,140
say hey you know anybody if any time

530
00:19:16,140 --> 00:19:19,500
anybody touches these uh these

531
00:19:19,500 --> 00:19:21,419
configurations then send me a

532
00:19:21,419 --> 00:19:23,280
notification for that thing or send me

533
00:19:23,280 --> 00:19:24,660
an event right and then you will decide

534
00:19:24,660 --> 00:19:26,400
about that whether that that activity is

535
00:19:26,400 --> 00:19:27,900
malicious or not so it's very powerful

536
00:19:27,900 --> 00:19:30,059
feature in general in the Eventing It

537
00:19:30,059 --> 00:19:31,919
Sports both process events all the

538
00:19:31,919 --> 00:19:33,299
process events that you can get socket

539
00:19:33,299 --> 00:19:34,799
events and file events right and it's

540
00:19:34,799 --> 00:19:36,900
also cross-platform like Mac OS Linux

541
00:19:36,900 --> 00:19:38,760
and windows right

542
00:19:38,760 --> 00:19:40,200
so

543
00:19:40,200 --> 00:19:42,419
this is the website for the OS query you

544
00:19:42,419 --> 00:19:44,039
can go and you know read about there are

545
00:19:44,039 --> 00:19:46,559
lots of information around it uh so now

546
00:19:46,559 --> 00:19:48,360
uh we would like to jump on the case

547
00:19:48,360 --> 00:19:49,799
study that we have you know

548
00:19:49,799 --> 00:19:51,360
understanding of the field and whatever

549
00:19:51,360 --> 00:19:54,179
the data that we are collecting uh so I

550
00:19:54,179 --> 00:19:56,220
would like uh proceed to actually take

551
00:19:56,220 --> 00:19:58,380
care of this stuff as he is our malware

552
00:19:58,380 --> 00:20:00,660
research guy and he spent a lot of time

553
00:20:00,660 --> 00:20:04,400
on the on the malware for the match okay

554
00:20:08,340 --> 00:20:09,720
yeah

555
00:20:09,720 --> 00:20:13,440
yeah thank you Amit so we will just look

556
00:20:13,440 --> 00:20:15,620
into

557
00:20:16,500 --> 00:20:21,120
uh look into the Slayer malware so so uh

558
00:20:21,120 --> 00:20:23,460
we can try to correlate the things as

559
00:20:23,460 --> 00:20:26,100
Amit said like with one utility we

560
00:20:26,100 --> 00:20:28,020
cannot say that it's a malicious

561
00:20:28,020 --> 00:20:30,720
activity so we try to correlate this

562
00:20:30,720 --> 00:20:34,080
thing using the Slayer example so we are

563
00:20:34,080 --> 00:20:36,299
observing highest percentage in our Mac

564
00:20:36,299 --> 00:20:39,660
OS family and we have seen Telemetry in

565
00:20:39,660 --> 00:20:41,059
our customer

566
00:20:41,059 --> 00:20:46,200
so we have seen like it's spread by a

567
00:20:46,200 --> 00:20:48,900
fraudulent update so so it will pop up

568
00:20:48,900 --> 00:20:50,820
for the fraudulent update then you have

569
00:20:50,820 --> 00:20:52,559
to click on update then then malware

570
00:20:52,559 --> 00:20:55,440
will enters your machine and uh then the

571
00:20:55,440 --> 00:20:58,140
script will run and after that so

572
00:20:58,140 --> 00:21:01,559
malware has changing these variations

573
00:21:01,559 --> 00:21:04,559
so uh new variants like we have seen

574
00:21:04,559 --> 00:21:07,200
like this disables Gatekeepers uh

575
00:21:07,200 --> 00:21:10,380
notarization uh file quarantine security

576
00:21:10,380 --> 00:21:13,200
and X protect these kind of things

577
00:21:13,200 --> 00:21:15,419
uh so rather than Distributing the

578
00:21:15,419 --> 00:21:17,520
malowers by phishing attacks so malware

579
00:21:17,520 --> 00:21:20,460
as the time uh over the period of time

580
00:21:20,460 --> 00:21:24,120
so it's using uh popular events or

581
00:21:24,120 --> 00:21:27,419
popular website to distribute uh why

582
00:21:27,419 --> 00:21:28,919
these websites

583
00:21:28,919 --> 00:21:33,240
so it basically uses DMG file a fake

584
00:21:33,240 --> 00:21:35,720
flash flare installer you can see then

585
00:21:35,720 --> 00:21:38,820
if you click on the install then uh

586
00:21:38,820 --> 00:21:40,620
scripts will execute the things so

587
00:21:40,620 --> 00:21:43,380
script will contain uh MK MK time

588
00:21:43,380 --> 00:21:46,200
utility that is used to create a unique

589
00:21:46,200 --> 00:21:47,460
file

590
00:21:47,460 --> 00:21:49,799
uh after that utility is used to

591
00:21:49,799 --> 00:21:52,740
download the further payloads from C2

592
00:21:52,740 --> 00:21:54,900
that control and command system

593
00:21:54,900 --> 00:21:57,179
uh so the control and command system

594
00:21:57,179 --> 00:21:58,860
from there also the payload is an

595
00:21:58,860 --> 00:22:01,559
encrypted format so for that it uses

596
00:22:01,559 --> 00:22:04,799
open SSL utility with the base64

597
00:22:04,799 --> 00:22:08,280
encoding uh then the CH mode I'll know

598
00:22:08,280 --> 00:22:10,500
the system permission root permission we

599
00:22:10,500 --> 00:22:12,419
can give it to whatever the payload is

600
00:22:12,419 --> 00:22:15,960
for the execution of uh malware so after

601
00:22:15,960 --> 00:22:18,480
that killer utilities to kill the

602
00:22:18,480 --> 00:22:21,179
terminals after executing the malware

603
00:22:21,179 --> 00:22:24,419
and here is the uh before that it was

604
00:22:24,419 --> 00:22:27,900
using at our utility so as time goes its

605
00:22:27,900 --> 00:22:31,980
uses of unzip utility to extract the sum

606
00:22:31,980 --> 00:22:34,799
you can see their tail is command so

607
00:22:34,799 --> 00:22:37,980
some uh bytes of you can see the fight

608
00:22:37,980 --> 00:22:41,340
it some bytes and then it's piped with a

609
00:22:41,340 --> 00:22:43,620
password and then it will extract to the

610
00:22:43,620 --> 00:22:46,200
time directory so we can say that we

611
00:22:46,200 --> 00:22:48,780
look into that we can correlate this

612
00:22:48,780 --> 00:22:50,760
thing if the MK time is happening the CH

613
00:22:50,760 --> 00:22:53,940
mode the curl fund zip and often SSL we

614
00:22:53,940 --> 00:22:55,860
can combine it together and we can say

615
00:22:55,860 --> 00:22:57,780
like it's uh you can say that it's a

616
00:22:57,780 --> 00:22:59,520
Slayer malware

617
00:22:59,520 --> 00:23:02,460
uh so next we'll we have the exercise

618
00:23:02,460 --> 00:23:04,500
malware so

619
00:23:04,500 --> 00:23:08,480
uh it's also the famous uh exercise uh

620
00:23:08,480 --> 00:23:12,840
malware so in it's uh infected using

621
00:23:12,840 --> 00:23:16,260
xcode project uh it's malicious code is

622
00:23:16,260 --> 00:23:18,539
injected into local X protect uh it's

623
00:23:18,539 --> 00:23:20,460
basically affected to the xcode

624
00:23:20,460 --> 00:23:22,919
developer so while uh compiling the

625
00:23:22,919 --> 00:23:25,200
xcode projects from the ID so basically

626
00:23:25,200 --> 00:23:28,340
it will run the scripts

627
00:23:28,340 --> 00:23:31,559
have so much variation we have seen in

628
00:23:31,559 --> 00:23:35,460
the past years like uh 2021 it's adapter

629
00:23:35,460 --> 00:23:40,020
micros 11 and Mac M1 chips in 2021 it's

630
00:23:40,020 --> 00:23:42,080
also targeted the telegram and popular

631
00:23:42,080 --> 00:23:46,760
applications and in recent April uh 2022

632
00:23:46,760 --> 00:23:51,679
so uh it's adapted the Mac OS monetary

633
00:23:51,679 --> 00:23:55,860
uh for that also we have some commands

634
00:23:55,860 --> 00:23:57,960
for that you can see the curl activities

635
00:23:57,960 --> 00:24:02,340
to download a payload from any AWS C2 uh

636
00:24:02,340 --> 00:24:04,860
the next argument uh that will command

637
00:24:04,860 --> 00:24:08,340
will send the kill command to uh kill

638
00:24:08,340 --> 00:24:10,980
each PID passes to it as an argument

639
00:24:10,980 --> 00:24:14,760
then CH mode as I say and Osa compile is

640
00:24:14,760 --> 00:24:18,600
to compile uh application uh script

641
00:24:18,600 --> 00:24:21,240
uh yeah this is you can say also

642
00:24:21,240 --> 00:24:23,039
correlate these things

643
00:24:23,039 --> 00:24:25,679
so it's not actually a complete uh

644
00:24:25,679 --> 00:24:28,320
breakdown of malware so we identify some

645
00:24:28,320 --> 00:24:30,960
of this utility can be used by this XC

646
00:24:30,960 --> 00:24:31,740
set

647
00:24:31,740 --> 00:24:34,559
and the next uh we can talk it's the

648
00:24:34,559 --> 00:24:37,080
silver Sparrow we have uh it's a very

649
00:24:37,080 --> 00:24:39,720
also popular malware

650
00:24:39,720 --> 00:24:44,760
so in 2021 the more than 30 30

651
00:24:44,760 --> 00:24:46,980
000 main points are affected by this

652
00:24:46,980 --> 00:24:50,580
malware in and also the 159 countries

653
00:24:50,580 --> 00:24:53,580
you can say so it's basically targeted

654
00:24:53,580 --> 00:24:55,860
to the M1 chips

655
00:24:55,860 --> 00:24:58,440
uh actually the package is delivered to

656
00:24:58,440 --> 00:25:01,020
the same like DMG or APK file with

657
00:25:01,020 --> 00:25:02,940
inbuilt JavaScript is mainly say

658
00:25:02,940 --> 00:25:07,440
JavaScript is uh in between that Mac OS

659
00:25:07,440 --> 00:25:10,559
so there are multiple ways to uh create

660
00:25:10,559 --> 00:25:14,220
a PLS file it's dropping a PLS file and

661
00:25:14,220 --> 00:25:17,280
also is used as a circle utility uh from

662
00:25:17,280 --> 00:25:20,280
the SQL light so it uses sqlite command

663
00:25:20,280 --> 00:25:23,580
to get a history to download an URL that

664
00:25:23,580 --> 00:25:28,020
is used by uh any application

665
00:25:28,020 --> 00:25:30,659
then you can see the pl util is there it

666
00:25:30,659 --> 00:25:32,400
it will from the curl it can download

667
00:25:32,400 --> 00:25:34,980
the XML or Json file and then from using

668
00:25:34,980 --> 00:25:37,320
the plut it would convert it into the P

669
00:25:37,320 --> 00:25:38,940
list

670
00:25:38,940 --> 00:25:42,000
and also the launch CTL uh it's uses for

671
00:25:42,000 --> 00:25:44,880
the persistence and then you can see the

672
00:25:44,880 --> 00:25:48,059
peel is Buddy is uh utility inbuilt Mac

673
00:25:48,059 --> 00:25:49,740
OS utility

674
00:25:49,740 --> 00:25:53,940
so its users to check a syntax or uh you

675
00:25:53,940 --> 00:25:56,820
can say to create a playlist file it

676
00:25:56,820 --> 00:26:00,179
also uses a playlist buddy and the CH

677
00:26:00,179 --> 00:26:03,240
mode you know to give permission to the

678
00:26:03,240 --> 00:26:06,480
scripts that will execute

679
00:26:06,480 --> 00:26:09,539
uh yeah the basically this uh you can

680
00:26:09,539 --> 00:26:12,600
say that using the sqlite 3 curl and

681
00:26:12,600 --> 00:26:15,480
launch CTL and pl utility you can say

682
00:26:15,480 --> 00:26:18,360
that yeah it's a malicious activity

683
00:26:18,360 --> 00:26:22,740
uh yeah that's about uh uh males and uh

684
00:26:22,740 --> 00:26:24,600
you can say the correlation of all the

685
00:26:24,600 --> 00:26:26,940
utilities using utilities You can

686
00:26:26,940 --> 00:26:29,880
conclude that uh you can say it's a

687
00:26:29,880 --> 00:26:33,559
malicious malware yeah

688
00:26:35,700 --> 00:26:38,760
yeah so so basically the as we can see

689
00:26:38,760 --> 00:26:41,100
here these are like the the popular uh

690
00:26:41,100 --> 00:26:43,200
commodity malware from the Mac OS and we

691
00:26:43,200 --> 00:26:45,419
can see the the variation of the

692
00:26:45,419 --> 00:26:48,900
utilities being used here and our you

693
00:26:48,900 --> 00:26:50,760
know experience and data suggests that

694
00:26:50,760 --> 00:26:54,059
you know in a normal application that is

695
00:26:54,059 --> 00:26:56,400
you know benign application right you

696
00:26:56,400 --> 00:26:58,620
don't see the variations of these many

697
00:26:58,620 --> 00:27:01,380
utilities that does there are cases

698
00:27:01,380 --> 00:27:03,539
where these type of things happens from

699
00:27:03,539 --> 00:27:05,760
the benign applications also and we will

700
00:27:05,760 --> 00:27:07,440
talk about that in the conclusion like

701
00:27:07,440 --> 00:27:09,419
how you can you know deal with those

702
00:27:09,419 --> 00:27:11,640
things if it in your environment you are

703
00:27:11,640 --> 00:27:13,440
facing a false positive but the point

704
00:27:13,440 --> 00:27:14,820
being here is

705
00:27:14,820 --> 00:27:17,760
if we look at an individual level then

706
00:27:17,760 --> 00:27:19,679
these utilities are not really serious

707
00:27:19,679 --> 00:27:22,380
in nature right these are officially you

708
00:27:22,380 --> 00:27:25,740
know provided by by Apple and you know

709
00:27:25,740 --> 00:27:28,020
for real estimate uses but as you can

710
00:27:28,020 --> 00:27:30,000
see the the uh you know the malwarees

711
00:27:30,000 --> 00:27:31,799
are actually using these utilities to

712
00:27:31,799 --> 00:27:33,720
carry out their their stuff without

713
00:27:33,720 --> 00:27:35,940
writing their own code now this is about

714
00:27:35,940 --> 00:27:38,220
the malware but when we talk about the

715
00:27:38,220 --> 00:27:40,500
the advanced and you know the targeted

716
00:27:40,500 --> 00:27:42,840
attacks it's it's less actually less

717
00:27:42,840 --> 00:27:44,580
about the malware

718
00:27:44,580 --> 00:27:46,919
so malware might be used as an initial

719
00:27:46,919 --> 00:27:49,080
access point at you know the piece of

720
00:27:49,080 --> 00:27:51,120
code might be used with that but then

721
00:27:51,120 --> 00:27:53,220
there is a lot of things that happens

722
00:27:53,220 --> 00:27:56,039
behind the scene once the attackers you

723
00:27:56,039 --> 00:27:58,620
know gain the access and on the basis of

724
00:27:58,620 --> 00:28:00,600
that that access they do the post

725
00:28:00,600 --> 00:28:02,880
exploitation activities and then they

726
00:28:02,880 --> 00:28:05,400
move laterally inside the environment so

727
00:28:05,400 --> 00:28:07,080
the natural thing once you get an access

728
00:28:07,080 --> 00:28:09,779
is basically to deploy some sort of you

729
00:28:09,779 --> 00:28:11,760
know red that can have persistence over

730
00:28:11,760 --> 00:28:13,140
the time and you can have you know

731
00:28:13,140 --> 00:28:16,559
access to this machine and you know have

732
00:28:16,559 --> 00:28:18,419
some password extraction also so that

733
00:28:18,419 --> 00:28:20,940
you can you know have that long-term

734
00:28:20,940 --> 00:28:22,919
access to that the infrastructure or the

735
00:28:22,919 --> 00:28:25,559
machine so what we have seen is that

736
00:28:25,559 --> 00:28:28,860
Ballarat is is an open source Tool uh

737
00:28:28,860 --> 00:28:30,840
it's available on git it's written in

738
00:28:30,840 --> 00:28:32,460
Python and it's taking some traction

739
00:28:32,460 --> 00:28:34,919
from the the threat actors and fin 7 and

740
00:28:34,919 --> 00:28:37,740
Carbonic very high profile guys uh they

741
00:28:37,740 --> 00:28:41,159
have been seen a Bella you know using in

742
00:28:41,159 --> 00:28:42,360
their operations

743
00:28:42,360 --> 00:28:45,659
so so the Ballarat also uses several

744
00:28:45,659 --> 00:28:47,820
utilities that are there available with

745
00:28:47,820 --> 00:28:50,700
the system like for example CSR util is

746
00:28:50,700 --> 00:28:53,400
kind of provide you the uh sip status

747
00:28:53,400 --> 00:28:55,860
system Integrity protection is uh you

748
00:28:55,860 --> 00:28:57,960
know very sound feature from Apple and

749
00:28:57,960 --> 00:28:59,880
if it is enabled or disabled right it

750
00:28:59,880 --> 00:29:02,100
provides the status so it's more of a

751
00:29:02,100 --> 00:29:03,539
discovery call that you know the

752
00:29:03,539 --> 00:29:05,460
attackers can make to see what type of

753
00:29:05,460 --> 00:29:06,960
environment they have and then what

754
00:29:06,960 --> 00:29:09,179
extra stuff they can do there and launch

755
00:29:09,179 --> 00:29:11,100
CTL again it can be used for the

756
00:29:11,100 --> 00:29:13,260
persistence like plist file it's similar

757
00:29:13,260 --> 00:29:14,820
to the people that are familiar with the

758
00:29:14,820 --> 00:29:16,620
windows background it's similar to

759
00:29:16,620 --> 00:29:18,360
Registries like in registries you have

760
00:29:18,360 --> 00:29:20,700
lots of stuff that you can add run keys

761
00:29:20,700 --> 00:29:22,080
and all these kind for the persistence

762
00:29:22,080 --> 00:29:24,720
so it is in a similar way you have PLS

763
00:29:24,720 --> 00:29:27,240
file that defines as sort of schema and

764
00:29:27,240 --> 00:29:28,980
then you can use the launch CTL to

765
00:29:28,980 --> 00:29:31,320
basically load that thing uh to have the

766
00:29:31,320 --> 00:29:33,000
persistence right if you put that into

767
00:29:33,000 --> 00:29:34,440
launch agents or launch theme as the

768
00:29:34,440 --> 00:29:36,059
operating system will take care of it

769
00:29:36,059 --> 00:29:38,279
and the other utility that we see is the

770
00:29:38,279 --> 00:29:40,980
open SSL also now open SSL we all know

771
00:29:40,980 --> 00:29:42,840
that it's it can support the encryption

772
00:29:42,840 --> 00:29:45,600
all type of encryptions right and uh you

773
00:29:45,600 --> 00:29:47,039
know they can encrypt the payload and

774
00:29:47,039 --> 00:29:48,600
they can decrypt the payload so it makes

775
00:29:48,600 --> 00:29:51,360
sense uh of using the open SSL the

776
00:29:51,360 --> 00:29:53,580
another one is the airport uh Discovery

777
00:29:53,580 --> 00:29:56,039
where you can identify the Wi-Fi and you

778
00:29:56,039 --> 00:29:58,140
know the other related information and

779
00:29:58,140 --> 00:30:00,179
osc script is another interesting

780
00:30:00,179 --> 00:30:03,059
utility that actually can you know allow

781
00:30:03,059 --> 00:30:05,659
you to run the Apple script on your uh

782
00:30:05,659 --> 00:30:08,460
you know the desktop sometimes the

783
00:30:08,460 --> 00:30:11,220
attackers actually use the uh this Osa

784
00:30:11,220 --> 00:30:13,320
script like in this example you see uh

785
00:30:13,320 --> 00:30:15,659
it will kind of give you a pop-up to

786
00:30:15,659 --> 00:30:17,399
enter your password right so sometimes

787
00:30:17,399 --> 00:30:19,020
you know you get that pop-up you enter

788
00:30:19,020 --> 00:30:21,059
your password and then boom uh it might

789
00:30:21,059 --> 00:30:22,980
be with the attackers then and then

790
00:30:22,980 --> 00:30:24,960
obviously network setup Discovery so the

791
00:30:24,960 --> 00:30:27,480
the point is like belaret is a remote

792
00:30:27,480 --> 00:30:29,940
access tool and it also uses the system

793
00:30:29,940 --> 00:30:33,240
utilities so if we look at this type of

794
00:30:33,240 --> 00:30:35,580
execution from any application right and

795
00:30:35,580 --> 00:30:37,679
we call that thing again that will give

796
00:30:37,679 --> 00:30:39,240
us good confidence in saying that okay

797
00:30:39,240 --> 00:30:41,039
this is you know kind of malicious

798
00:30:41,039 --> 00:30:42,539
activity in that sense

799
00:30:42,539 --> 00:30:44,640
now the another tool that we have is

800
00:30:44,640 --> 00:30:46,980
lasagne because it's a it's a very

801
00:30:46,980 --> 00:30:49,260
favorite of apts on the other uh

802
00:30:49,260 --> 00:30:52,440
operating systems like uh the ones that

803
00:30:52,440 --> 00:30:54,299
targets mostly the windows but as I said

804
00:30:54,299 --> 00:30:56,220
the trend is to have kind of

805
00:30:56,220 --> 00:30:58,919
cross-platform and lasagna is a password

806
00:30:58,919 --> 00:31:01,980
extraction tool that is oftentimes used

807
00:31:01,980 --> 00:31:04,919
by the apts right now uh as it is

808
00:31:04,919 --> 00:31:06,779
cross-platform it can extract from the

809
00:31:06,779 --> 00:31:09,600
Linux also from Windows and Mac OS so in

810
00:31:09,600 --> 00:31:11,640
the Mac OS it can you know once you have

811
00:31:11,640 --> 00:31:13,260
the access then you can access the the

812
00:31:13,260 --> 00:31:15,600
users database and the passwords hashes

813
00:31:15,600 --> 00:31:18,240
and everything uh using this one if you

814
00:31:18,240 --> 00:31:20,340
have the sudo this is the command that

815
00:31:20,340 --> 00:31:22,080
it's using is using the defaults utility

816
00:31:22,080 --> 00:31:24,899
on the Mac OS and the uh it can also

817
00:31:24,899 --> 00:31:27,179
extract the Chrome password by using the

818
00:31:27,179 --> 00:31:30,179
SQL lite3 now maturity of the stuff that

819
00:31:30,179 --> 00:31:32,100
is whether it's your chat or you know

820
00:31:32,100 --> 00:31:34,020
the password that are being stored on

821
00:31:34,020 --> 00:31:36,480
Macos they are largely into an SQL

822
00:31:36,480 --> 00:31:38,820
database right so that's the format that

823
00:31:38,820 --> 00:31:43,020
Macos uses so any file that is DB your

824
00:31:43,020 --> 00:31:44,880
deals normally with the with the

825
00:31:44,880 --> 00:31:47,279
passwords you can actually access that

826
00:31:47,279 --> 00:31:49,500
thing through sqlite3 and sqlite3 is

827
00:31:49,500 --> 00:31:51,600
anyway comes in built with with the Mac

828
00:31:51,600 --> 00:31:53,640
OS right so this is an example where you

829
00:31:53,640 --> 00:31:55,679
can read actually the username and

830
00:31:55,679 --> 00:31:58,140
password from stored uh you know the

831
00:31:58,140 --> 00:32:01,140
Chrome uh Chrome data store

832
00:32:01,140 --> 00:32:03,299
so

833
00:32:03,299 --> 00:32:05,580
so that's uh about the malware's and the

834
00:32:05,580 --> 00:32:08,460
uh you know the offensive tools now here

835
00:32:08,460 --> 00:32:10,919
is you know based on the intelligence

836
00:32:10,919 --> 00:32:12,840
that we gather from our uh you know

837
00:32:12,840 --> 00:32:15,299
customer Telemetry as well as from the

838
00:32:15,299 --> 00:32:17,399
sandbox in-house sandbox that we have

839
00:32:17,399 --> 00:32:19,860
for Mac OS malwares this is the breakup

840
00:32:19,860 --> 00:32:22,559
of the top uh you know the utilities

841
00:32:22,559 --> 00:32:25,200
being often used or abused by the uh by

842
00:32:25,200 --> 00:32:27,659
the threat actors or the malwarees now

843
00:32:27,659 --> 00:32:30,360
you see a high usage of open SSL and

844
00:32:30,360 --> 00:32:32,940
kill kill all here because it's uh you

845
00:32:32,940 --> 00:32:34,440
know as I said like Slayer and bundler

846
00:32:34,440 --> 00:32:37,860
is the top most uh in the game and it

847
00:32:37,860 --> 00:32:39,960
uses heavily this for their payload

848
00:32:39,960 --> 00:32:41,580
decryption as well as to you know kill

849
00:32:41,580 --> 00:32:43,200
all the terminals that are there right

850
00:32:43,200 --> 00:32:46,620
but in general curl is also often used

851
00:32:46,620 --> 00:32:48,600
to download the second stage payload or

852
00:32:48,600 --> 00:32:50,279
to carry out those type of activities

853
00:32:50,279 --> 00:32:52,020
right so it's also very popular and then

854
00:32:52,020 --> 00:32:54,419
I O reactor base64 all of these things

855
00:32:54,419 --> 00:32:57,659
deals with the uh either Discovery or

856
00:32:57,659 --> 00:33:00,720
you know the uh Archive of a file or

857
00:33:00,720 --> 00:33:02,340
encoding and decoding again the launch

858
00:33:02,340 --> 00:33:04,260
CTL is make sense because with the

859
00:33:04,260 --> 00:33:06,360
launch CTL you can make the persistence

860
00:33:06,360 --> 00:33:09,000
you can load the plist file and then you

861
00:33:09,000 --> 00:33:11,340
have ch mode and CH on as well now you

862
00:33:11,340 --> 00:33:12,480
might be wondering like why the hell

863
00:33:12,480 --> 00:33:14,640
amid you are putting CH mode and CH on

864
00:33:14,640 --> 00:33:16,679
they are the utilities that are used but

865
00:33:16,679 --> 00:33:18,360
they are pretty benign I mean pretty

866
00:33:18,360 --> 00:33:20,519
much everybody is using CH mode and ch1

867
00:33:20,519 --> 00:33:22,500
but for the people that don't know like

868
00:33:22,500 --> 00:33:25,080
Mac OS also has this shell where you can

869
00:33:25,080 --> 00:33:26,640
run all of these commands as well right

870
00:33:26,640 --> 00:33:29,640
so it's not uh the shell is similar to

871
00:33:29,640 --> 00:33:31,799
like what you have seen on the Unix or

872
00:33:31,799 --> 00:33:33,860
Linux site right

873
00:33:33,860 --> 00:33:37,140
but the point is as uh you know from the

874
00:33:37,140 --> 00:33:38,880
beginning I'm making it's the the point

875
00:33:38,880 --> 00:33:40,679
is not to look at a single activity

876
00:33:40,679 --> 00:33:43,320
whether it's a CH mode or Chon but the

877
00:33:43,320 --> 00:33:45,120
point is to look at from a correlation

878
00:33:45,120 --> 00:33:46,980
perspective that hey you know these this

879
00:33:46,980 --> 00:33:49,200
type of activities are happening when we

880
00:33:49,200 --> 00:33:50,880
look at a single event we don't know

881
00:33:50,880 --> 00:33:53,399
exactly whether that activity is benign

882
00:33:53,399 --> 00:33:56,460
or malicious but if we correlate that

883
00:33:56,460 --> 00:33:58,799
thing uh with you know depending on the

884
00:33:58,799 --> 00:34:00,179
correlation mechanism you are using

885
00:34:00,179 --> 00:34:02,460
whether it's based on on a user account

886
00:34:02,460 --> 00:34:04,080
or whether it's based on you know the

887
00:34:04,080 --> 00:34:05,700
process hierarchy or you know other

888
00:34:05,700 --> 00:34:08,699
elements then you can say you know with

889
00:34:08,699 --> 00:34:10,379
some significant confidence that hey you

890
00:34:10,379 --> 00:34:12,179
know this looks like analysis activity

891
00:34:12,179 --> 00:34:14,280
because there is a variations in the

892
00:34:14,280 --> 00:34:16,679
attack that that is happening right

893
00:34:16,679 --> 00:34:18,599
these are some of the uncommonly

894
00:34:18,599 --> 00:34:21,060
utilities that we say abused by the

895
00:34:21,060 --> 00:34:22,859
attackers these are some some of them

896
00:34:22,859 --> 00:34:26,699
are actually based on uh you know our

897
00:34:26,699 --> 00:34:29,280
experience when we do some sort of uh

898
00:34:29,280 --> 00:34:31,440
you know Elementary uh red teaming

899
00:34:31,440 --> 00:34:34,379
exercises or we have seen you know other

900
00:34:34,379 --> 00:34:36,599
people using these things in their red

901
00:34:36,599 --> 00:34:38,460
teaming attacks or or the you know the

902
00:34:38,460 --> 00:34:40,260
attackers or malware have used this one

903
00:34:40,260 --> 00:34:43,379
like PV copy PV paste is is very uh you

904
00:34:43,379 --> 00:34:44,940
know interesting utility in which you

905
00:34:44,940 --> 00:34:47,159
can have anything copied to your

906
00:34:47,159 --> 00:34:48,899
clipboard like you you can do command

907
00:34:48,899 --> 00:34:50,760
C's similar to on Windows you can do the

908
00:34:50,760 --> 00:34:53,879
control C and control uh you know uh to

909
00:34:53,879 --> 00:34:56,219
copy any element so you can run this

910
00:34:56,219 --> 00:34:59,220
utility to copy anything to your

911
00:34:59,220 --> 00:35:01,080
clipboard and then PV Paste can actually

912
00:35:01,080 --> 00:35:02,940
extract anything that you have copied to

913
00:35:02,940 --> 00:35:05,820
your clipboard now these things can be

914
00:35:05,820 --> 00:35:07,680
used in a in a case where let's say

915
00:35:07,680 --> 00:35:10,320
majority of us we copy the password we

916
00:35:10,320 --> 00:35:11,880
enters into different applications right

917
00:35:11,880 --> 00:35:14,400
we have those things and if there is

918
00:35:14,400 --> 00:35:15,839
anything something like that in the

919
00:35:15,839 --> 00:35:17,339
clipboard then PV Paste can actually

920
00:35:17,339 --> 00:35:19,260
extract behind the scene right and then

921
00:35:19,260 --> 00:35:21,720
you have dscl which can be used for lots

922
00:35:21,720 --> 00:35:24,180
of Discovery it can if your Mac machine

923
00:35:24,180 --> 00:35:26,400
is connected to ad then that can really

924
00:35:26,400 --> 00:35:28,980
help you in in that way also so there

925
00:35:28,980 --> 00:35:30,839
are lots of things that you can do with

926
00:35:30,839 --> 00:35:31,920
the dscl

927
00:35:31,920 --> 00:35:34,740
TM util is again very interesting in a

928
00:35:34,740 --> 00:35:38,280
sense like you know on Windows you have

929
00:35:38,280 --> 00:35:40,200
esic admin that can delete the the

930
00:35:40,200 --> 00:35:42,599
backups and you know all these type of

931
00:35:42,599 --> 00:35:44,940
things uh that you can do with the VSS

932
00:35:44,940 --> 00:35:47,339
admin it's a equivalent uh kind of

933
00:35:47,339 --> 00:35:51,000
utility on the uh Mac OS em util in

934
00:35:51,000 --> 00:35:52,200
which you can create and delete the

935
00:35:52,200 --> 00:35:53,700
backups right on the back West then

936
00:35:53,700 --> 00:35:55,920
there is a caffeinate uh that can be

937
00:35:55,920 --> 00:35:58,020
used by the quiet Miner and you know

938
00:35:58,020 --> 00:36:00,060
there are one or two coin miners that we

939
00:36:00,060 --> 00:36:02,220
have seen actually using this one so it

940
00:36:02,220 --> 00:36:04,440
can allow your laptop not to sleep or

941
00:36:04,440 --> 00:36:06,359
your server not to sleep so so that it

942
00:36:06,359 --> 00:36:08,579
can you know basically keep running and

943
00:36:08,579 --> 00:36:11,099
then you know mind the coins and

944
00:36:11,099 --> 00:36:13,140
similarly fungi pendito these are

945
00:36:13,140 --> 00:36:14,579
interesting utilities like for example

946
00:36:14,579 --> 00:36:17,700
detail can be another utility that can

947
00:36:17,700 --> 00:36:20,040
be used with the CP and MV right so you

948
00:36:20,040 --> 00:36:21,780
have CP and MD to move the files then

949
00:36:21,780 --> 00:36:24,000
you can use the ditto as well now CP and

950
00:36:24,000 --> 00:36:25,859
MV are more kind of pretty much

951
00:36:25,859 --> 00:36:28,619
everybody knows but dito is is an you

952
00:36:28,619 --> 00:36:30,540
know as an alternator attackers can use

953
00:36:30,540 --> 00:36:34,200
as a part of that that thing right

954
00:36:34,200 --> 00:36:36,180
now

955
00:36:36,180 --> 00:36:38,880
now since we know that we are mostly

956
00:36:38,880 --> 00:36:40,619
talking about the process Behavior based

957
00:36:40,619 --> 00:36:43,859
detection and you know the as I said

958
00:36:43,859 --> 00:36:46,500
earlier like detecting on the or saying

959
00:36:46,500 --> 00:36:48,780
any you know making any conclusion on

960
00:36:48,780 --> 00:36:50,940
the basis of a single activity

961
00:36:50,940 --> 00:36:53,280
it's not possible that we we say it like

962
00:36:53,280 --> 00:36:55,859
okay this is malicious or not so what we

963
00:36:55,859 --> 00:36:57,780
have to do we we have to have a strong

964
00:36:57,780 --> 00:37:00,300
correlation in terms of you know

965
00:37:00,300 --> 00:37:01,740
correlating all of all of these

966
00:37:01,740 --> 00:37:03,660
activities to say that hey you know this

967
00:37:03,660 --> 00:37:06,180
is something malicious going on right

968
00:37:06,180 --> 00:37:08,280
and correlation can be based on anything

969
00:37:08,280 --> 00:37:10,500
it can be on user it can be on you know

970
00:37:10,500 --> 00:37:12,480
process hierarchy it can be on the other

971
00:37:12,480 --> 00:37:14,460
elements of the the metadata that you

972
00:37:14,460 --> 00:37:15,839
get with the with the Telemetry

973
00:37:15,839 --> 00:37:17,880
depending on how much metadata you are

974
00:37:17,880 --> 00:37:19,440
extracting and what type of metadata you

975
00:37:19,440 --> 00:37:21,480
extract depending on that you can you

976
00:37:21,480 --> 00:37:23,359
know have that correlation ready in that

977
00:37:23,359 --> 00:37:25,680
the other thing in the correlation will

978
00:37:25,680 --> 00:37:27,839
come as as part of like okay what should

979
00:37:27,839 --> 00:37:29,579
be the time for the correlation I mean

980
00:37:29,579 --> 00:37:31,440
should you know that I can go for seven

981
00:37:31,440 --> 00:37:33,900
days it can go for years so how you will

982
00:37:33,900 --> 00:37:35,640
correlate the Telemetry for a year now

983
00:37:35,640 --> 00:37:39,240
the journal uh you know the stuff that

984
00:37:39,240 --> 00:37:42,240
we have seen so far is that attackers

985
00:37:42,240 --> 00:37:44,520
might do some activity and they might do

986
00:37:44,520 --> 00:37:47,880
that periodically in a sense sorry they

987
00:37:47,880 --> 00:37:49,680
might do periodically in a sense but

988
00:37:49,680 --> 00:37:52,140
there is going to be a significant

989
00:37:52,140 --> 00:37:54,000
amount of activity at some particular

990
00:37:54,000 --> 00:37:55,980
point in time so we don't have to

991
00:37:55,980 --> 00:37:58,200
correct let's say one year that can

992
00:37:58,200 --> 00:38:00,300
might that might come as a part of a

993
00:38:00,300 --> 00:38:02,700
separate correlation strategy but when

994
00:38:02,700 --> 00:38:04,320
that activity is happening at least we

995
00:38:04,320 --> 00:38:06,060
can take some good time buffer off let's

996
00:38:06,060 --> 00:38:08,280
say maybe 30 40 minutes or maybe in one

997
00:38:08,280 --> 00:38:11,160
hour where you can you know kind of you

998
00:38:11,160 --> 00:38:13,500
know correlate that activity and see uh

999
00:38:13,500 --> 00:38:16,500
whether you know we are

1000
00:38:16,500 --> 00:38:18,960
classifying that as a malicious or not

1001
00:38:18,960 --> 00:38:21,300
now one of the biggest thing that will

1002
00:38:21,300 --> 00:38:23,880
come with the with the behavior based

1003
00:38:23,880 --> 00:38:25,440
detection is the false positive and

1004
00:38:25,440 --> 00:38:26,880
false positive is a critical thing

1005
00:38:26,880 --> 00:38:29,220
because in a false positive you are

1006
00:38:29,220 --> 00:38:30,420
saying something that is not really

1007
00:38:30,420 --> 00:38:32,700
malicious you are basically making a

1008
00:38:32,700 --> 00:38:35,339
benign uh thing as malicious which can

1009
00:38:35,339 --> 00:38:37,380
really cause lots of problems

1010
00:38:37,380 --> 00:38:39,660
and it's a serious problem in terms of

1011
00:38:39,660 --> 00:38:41,880
because as I said like the behavior can

1012
00:38:41,880 --> 00:38:43,380
be done by El estimate application or

1013
00:38:43,380 --> 00:38:45,300
less Mate user as well and we are

1014
00:38:45,300 --> 00:38:47,640
detecting that as malicious right now it

1015
00:38:47,640 --> 00:38:49,859
entirely depends on so there are a

1016
00:38:49,859 --> 00:38:51,540
couple of things that we have to keep in

1017
00:38:51,540 --> 00:38:53,520
mind is like effective correlation is

1018
00:38:53,520 --> 00:38:55,800
one that we have to do that can solve

1019
00:38:55,800 --> 00:38:58,619
this problem uh but apart from the

1020
00:38:58,619 --> 00:39:00,180
effective correlation we have to have

1021
00:39:00,180 --> 00:39:02,880
environment specific noise reduction uh

1022
00:39:02,880 --> 00:39:05,099
strategy also when I'm saying

1023
00:39:05,099 --> 00:39:06,720
environment specific noise reduction

1024
00:39:06,720 --> 00:39:07,920
meaning

1025
00:39:07,920 --> 00:39:10,920
that the the way the security is

1026
00:39:10,920 --> 00:39:12,780
evolving and if you look at from the

1027
00:39:12,780 --> 00:39:14,160
operating system perspective also

1028
00:39:14,160 --> 00:39:16,500
whether it's a Windows or Mac OS you

1029
00:39:16,500 --> 00:39:17,760
know there are not many things on the

1030
00:39:17,760 --> 00:39:20,040
Linux side but if you look at from that

1031
00:39:20,040 --> 00:39:22,079
side then you know without a user

1032
00:39:22,079 --> 00:39:24,300
feedback you cannot really solve the

1033
00:39:24,300 --> 00:39:26,700
detection problem right whether it's you

1034
00:39:26,700 --> 00:39:28,140
are the owner of a laptop or you are

1035
00:39:28,140 --> 00:39:29,940
owner of an organization that that is

1036
00:39:29,940 --> 00:39:32,579
looking at you know 10 000 machines now

1037
00:39:32,579 --> 00:39:34,740
if you look at the Apple Apple basically

1038
00:39:34,740 --> 00:39:36,359
provides you notification on pretty much

1039
00:39:36,359 --> 00:39:38,220
anything that you will do that this is

1040
00:39:38,220 --> 00:39:39,720
happening this is happening so they are

1041
00:39:39,720 --> 00:39:41,280
taking a constant feedback from you

1042
00:39:41,280 --> 00:39:43,440
whether that activity is happening as

1043
00:39:43,440 --> 00:39:45,480
per your requirement or not right so

1044
00:39:45,480 --> 00:39:47,160
going forward the detection technologies

1045
00:39:47,160 --> 00:39:49,020
that are going to come and I feel like

1046
00:39:49,020 --> 00:39:51,480
that is the only way to kind of solve

1047
00:39:51,480 --> 00:39:53,280
the problem because you know generically

1048
00:39:53,280 --> 00:39:55,619
we cannot really solve anything we have

1049
00:39:55,619 --> 00:39:57,060
to have some sort of feedback coming

1050
00:39:57,060 --> 00:39:58,560
from the organization infrastructure

1051
00:39:58,560 --> 00:40:00,599
where say they you know this is kind of

1052
00:40:00,599 --> 00:40:03,119
our Baseline that says yeah this type of

1053
00:40:03,119 --> 00:40:05,460
activity is like known to me I know that

1054
00:40:05,460 --> 00:40:06,960
these applications make that type of

1055
00:40:06,960 --> 00:40:09,000
activity but if there is any application

1056
00:40:09,000 --> 00:40:12,119
is actually behaving randomly it it is

1057
00:40:12,119 --> 00:40:14,520
not supposed to behave in that then why

1058
00:40:14,520 --> 00:40:16,020
that anomaly is happening in there like

1059
00:40:16,020 --> 00:40:17,640
for example it might be a Winword

1060
00:40:17,640 --> 00:40:20,040
application and in your environment it

1061
00:40:20,040 --> 00:40:21,540
might be that Winward application has

1062
00:40:21,540 --> 00:40:23,760
never spawned anything as a child

1063
00:40:23,760 --> 00:40:25,619
process but suddenly the windward

1064
00:40:25,619 --> 00:40:27,119
application is spawning a child process

1065
00:40:27,119 --> 00:40:28,380
then why the hell that is happening

1066
00:40:28,380 --> 00:40:30,480
right but it might be in your finance

1067
00:40:30,480 --> 00:40:32,520
department where the people are using of

1068
00:40:32,520 --> 00:40:34,980
other tools where you have a win word

1069
00:40:34,980 --> 00:40:36,780
application that oftentimes sponsor

1070
00:40:36,780 --> 00:40:39,240
cmd.exe or maybe you know the Excel

1071
00:40:39,240 --> 00:40:42,300
files and do do other stuff and in that

1072
00:40:42,300 --> 00:40:44,339
case that activity would be benign but

1073
00:40:44,339 --> 00:40:45,599
you would be catching that thing right

1074
00:40:45,599 --> 00:40:48,599
so the so the you know the way I think

1075
00:40:48,599 --> 00:40:50,940
this can be solved is to have some sort

1076
00:40:50,940 --> 00:40:53,579
of feedback coming from the user also

1077
00:40:53,579 --> 00:40:55,560
who are using the technology or who are

1078
00:40:55,560 --> 00:40:58,079
designing the technology to have that

1079
00:40:58,079 --> 00:41:00,240
feedback into the system and then system

1080
00:41:00,240 --> 00:41:02,040
will basically improve in in some way

1081
00:41:02,040 --> 00:41:04,619
that stuff right

1082
00:41:04,619 --> 00:41:08,280
so so this is a like a uh you know the

1083
00:41:08,280 --> 00:41:10,800
the complete list of the utilities that

1084
00:41:10,800 --> 00:41:13,380
we feel are used by the uh the attackers

1085
00:41:13,380 --> 00:41:15,599
or the malware so far or there is a

1086
00:41:15,599 --> 00:41:17,520
possibility that these utilities can be

1087
00:41:17,520 --> 00:41:19,740
used in the future uh by the attackers

1088
00:41:19,740 --> 00:41:21,359
for malware depending on their behavior

1089
00:41:21,359 --> 00:41:22,920
type so we have compiled a list of all

1090
00:41:22,920 --> 00:41:25,380
the macro bins and uh you can take a

1091
00:41:25,380 --> 00:41:27,060
look at that you know later on after the

1092
00:41:27,060 --> 00:41:28,680
presentation and we will share the

1093
00:41:28,680 --> 00:41:30,780
presentation also so all of these things

1094
00:41:30,780 --> 00:41:33,780
so we have around four or five slides

1095
00:41:33,780 --> 00:41:36,119
just to list down all of the utilities

1096
00:41:36,119 --> 00:41:38,160
on the Macos right so in your

1097
00:41:38,160 --> 00:41:40,320
environment you can pretty much uh you

1098
00:41:40,320 --> 00:41:43,440
know monitor these type of utilities and

1099
00:41:43,440 --> 00:41:45,240
any anything that deals with anything

1100
00:41:45,240 --> 00:41:46,859
suspicious files depending on your

1101
00:41:46,859 --> 00:41:49,140
environment and I I think that should

1102
00:41:49,140 --> 00:41:50,700
you you know provide you a kind of

1103
00:41:50,700 --> 00:41:52,380
Baseline to detect the anomalies in your

1104
00:41:52,380 --> 00:41:54,660
environment to have the detection right

1105
00:41:54,660 --> 00:41:58,079
so that's pretty much from our side

1106
00:41:58,079 --> 00:42:00,119
yeah any questions or anything we can

1107
00:42:00,119 --> 00:42:01,260
take

1108
00:42:01,260 --> 00:42:03,920
thank you

1109
00:42:09,660 --> 00:42:13,520
hello do we have any questions

1110
00:42:15,920 --> 00:42:18,540
so I I believe most of this correlation

1111
00:42:18,540 --> 00:42:20,700
is retrospective right like you analyze

1112
00:42:20,700 --> 00:42:22,859
the malware and then you fit that in the

1113
00:42:22,859 --> 00:42:25,800
miter framework to say okay technique to

1114
00:42:25,800 --> 00:42:30,480
use evasion was this calling to model or

1115
00:42:30,480 --> 00:42:32,220
technique to use persistence or

1116
00:42:32,220 --> 00:42:33,359
something else

1117
00:42:33,359 --> 00:42:35,700
is there any method to do proactive

1118
00:42:35,700 --> 00:42:39,180
correlation without having to know what

1119
00:42:39,180 --> 00:42:40,800
the next malware is going to behave like

1120
00:42:40,800 --> 00:42:43,020
and be able to come to some correlation

1121
00:42:43,020 --> 00:42:46,680
to say this is somewhat of a anomalous

1122
00:42:46,680 --> 00:42:49,020
set of commands that are running and

1123
00:42:49,020 --> 00:42:51,839
could potentially be malicious

1124
00:42:51,839 --> 00:42:53,640
correct so so there are two ways to

1125
00:42:53,640 --> 00:42:55,740
tackle that one way is that whatever the

1126
00:42:55,740 --> 00:42:57,060
uh

1127
00:42:57,060 --> 00:42:58,800
the data that we have right now whatever

1128
00:42:58,800 --> 00:43:01,140
the malwarees are using right now we can

1129
00:43:01,140 --> 00:43:03,540
have a singular you know detection for

1130
00:43:03,540 --> 00:43:06,000
those things and the correlation really

1131
00:43:06,000 --> 00:43:09,060
happens not in a defined method manner

1132
00:43:09,060 --> 00:43:10,800
meaning that we don't have like these

1133
00:43:10,800 --> 00:43:13,020
steps okay this utility this utility and

1134
00:43:13,020 --> 00:43:15,960
this utility but we have like separate

1135
00:43:15,960 --> 00:43:18,359
these events that are coming and then

1136
00:43:18,359 --> 00:43:20,339
you have correlation of these things at

1137
00:43:20,339 --> 00:43:22,020
when you are detecting these utilities

1138
00:43:22,020 --> 00:43:24,660
rights it means that in any order these

1139
00:43:24,660 --> 00:43:26,520
utilities will come by that you will be

1140
00:43:26,520 --> 00:43:28,440
able to detect that thing uh you you

1141
00:43:28,440 --> 00:43:29,819
know inside that thing right so that's

1142
00:43:29,819 --> 00:43:30,780
one

1143
00:43:30,780 --> 00:43:33,540
the second method that can be uh there

1144
00:43:33,540 --> 00:43:37,319
is around the um that you have basically

1145
00:43:37,319 --> 00:43:39,000
we have to do the red teaming and you

1146
00:43:39,000 --> 00:43:41,280
know find out what is there in inside

1147
00:43:41,280 --> 00:43:44,520
the uh you know the Mac OS and see what

1148
00:43:44,520 --> 00:43:46,140
is possible there like some of the

1149
00:43:46,140 --> 00:43:48,480
example like for example ditto it's

1150
00:43:48,480 --> 00:43:50,520
something that nobody's uses right but

1151
00:43:50,520 --> 00:43:53,220
dito has a pretty good chance to be a

1152
00:43:53,220 --> 00:43:55,680
replacement for mvncp in terms of that

1153
00:43:55,680 --> 00:43:59,180
right so that's how

1154
00:44:00,060 --> 00:44:01,200
okay

1155
00:44:01,200 --> 00:44:04,339
anyone else

1156
00:44:04,980 --> 00:44:06,960
last call

1157
00:44:06,960 --> 00:44:08,520
any questions

1158
00:44:08,520 --> 00:44:11,060
okay

