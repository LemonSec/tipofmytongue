1
00:00:03,490 --> 00:00:08,000
good morning so some technical

2
00:00:06,200 --> 00:00:09,469
difficulties first track hearing this

3
00:00:08,000 --> 00:00:12,500
morning and I have to remember not to

4
00:00:09,469 --> 00:00:15,410
walk in front of the projector so I'm

5
00:00:12,500 --> 00:00:17,090
here to tell you about this huge alarm I

6
00:00:15,410 --> 00:00:19,910
was a bit worried trying to get it into

7
00:00:17,090 --> 00:00:25,640
the country but here it is nice nice

8
00:00:19,910 --> 00:00:27,410
little metal box so this is me you who

9
00:00:25,640 --> 00:00:29,360
don't know me I work at possible

10
00:00:27,410 --> 00:00:31,880
security I'm lead Richard researcher

11
00:00:29,360 --> 00:00:33,559
there we do pen testing consulting you

12
00:00:31,880 --> 00:00:38,030
know all the usual stuff that the

13
00:00:33,559 --> 00:00:43,540
company does now I do spend quite a lot

14
00:00:38,030 --> 00:00:48,560
of time with my Coby so bliss is here

15
00:00:43,540 --> 00:00:51,200
oops so Network flow analysis is one of

16
00:00:48,560 --> 00:00:52,790
my hobbies because I moved into IT

17
00:00:51,200 --> 00:00:55,100
security from networks from computer

18
00:00:52,790 --> 00:00:56,629
networks in this case this is an alarm

19
00:00:55,100 --> 00:00:57,980
network it's a different kind of network

20
00:00:56,630 --> 00:01:00,200
but I have analyzed it nonetheless

21
00:00:57,980 --> 00:01:02,779
reverse engineering goals are one of my

22
00:01:00,200 --> 00:01:04,070
favorites I'm working I'm working on

23
00:01:02,780 --> 00:01:05,960
reversing everything as well social

24
00:01:04,069 --> 00:01:07,369
engineering legal dimension and please

25
00:01:05,960 --> 00:01:10,000
do follow me on Twitter I tweet a lot

26
00:01:07,370 --> 00:01:13,400
it's all in English so IT security stuff

27
00:01:10,000 --> 00:01:14,840
now I don't think so but do we have any

28
00:01:13,400 --> 00:01:17,960
people in the audience who have seen the

29
00:01:14,840 --> 00:01:19,670
previous version of the talk no ok

30
00:01:17,960 --> 00:01:22,009
well luckily for you are included two

31
00:01:19,670 --> 00:01:24,140
topics from the previous version so

32
00:01:22,010 --> 00:01:26,630
general alarm alarm system intro and

33
00:01:24,140 --> 00:01:29,510
about the paradox systems the company

34
00:01:26,630 --> 00:01:32,060
that made this not so highly secure

35
00:01:29,510 --> 00:01:34,159
device but I also added new stuff of

36
00:01:32,060 --> 00:01:39,740
course and the research has been carried

37
00:01:34,159 --> 00:01:42,260
out between last November and today is I

38
00:01:39,740 --> 00:01:44,060
dug into the remote protocol a bit so

39
00:01:42,260 --> 00:01:46,479
there's a nice remote that you can click

40
00:01:44,060 --> 00:01:49,100
to actually arm and disarm the system I

41
00:01:46,479 --> 00:01:51,650
was planning to present a demo on that

42
00:01:49,100 --> 00:01:53,689
as well but unfortunately as I

43
00:01:51,650 --> 00:01:56,420
understand India doesn't like unlicensed

44
00:01:53,689 --> 00:01:58,339
radio devices in their country so but I

45
00:01:56,420 --> 00:02:00,619
have other demos for you but I'll show

46
00:01:58,340 --> 00:02:03,619
you some specs for the remote that I

47
00:02:00,619 --> 00:02:06,140
discovered then I also made an attack

48
00:02:03,619 --> 00:02:07,880
tool now in previous version we had to

49
00:02:06,140 --> 00:02:09,530
have a laptop we had to have a whole rig

50
00:02:07,880 --> 00:02:10,758
to actually attack the system in this

51
00:02:09,530 --> 00:02:13,639
case you will see it on the screen I

52
00:02:10,758 --> 00:02:15,409
hope when the demo comes I made an

53
00:02:13,639 --> 00:02:16,170
attack tool that is a small 5 by 5

54
00:02:15,409 --> 00:02:18,660
centimeter box

55
00:02:16,170 --> 00:02:22,440
that you can actually use to attack the

56
00:02:18,660 --> 00:02:25,590
system and I also looked at firmware

57
00:02:22,440 --> 00:02:27,569
which is nearing so I try to understand

58
00:02:25,590 --> 00:02:28,860
is it easy for this specific device will

59
00:02:27,569 --> 00:02:32,750
I be able to reverse-engineer the

60
00:02:28,860 --> 00:02:32,750
firmware and if not what else can I do

61
00:02:32,900 --> 00:02:37,200
security alarm systems in general right

62
00:02:35,190 --> 00:02:39,000
just the definition here what I'm

63
00:02:37,200 --> 00:02:40,619
talking about is the system you can have

64
00:02:39,000 --> 00:02:43,410
in your office or in your home where you

65
00:02:40,620 --> 00:02:45,150
put a chip card where you put a pin code

66
00:02:43,410 --> 00:02:47,489
and locks down the alarm sounds and

67
00:02:45,150 --> 00:02:49,680
someone enters right and security alarm

68
00:02:47,489 --> 00:02:54,000
systems have gotten pretty pretty good

69
00:02:49,680 --> 00:02:55,620
in preventing bad guys from getting to

70
00:02:54,000 --> 00:02:58,500
your stuff here's an example of a

71
00:02:55,620 --> 00:03:01,560
security alarm system that is equipped

72
00:02:58,500 --> 00:03:04,470
with special devices that produces smoke

73
00:03:01,560 --> 00:03:05,970
when alarm is tripped so and as I say

74
00:03:04,470 --> 00:03:08,069
you can't steal what you can't see right

75
00:03:05,970 --> 00:03:11,160
so depending on the configuration

76
00:03:08,069 --> 00:03:13,798
security alarm is what actually stops

77
00:03:11,160 --> 00:03:16,049
the attacker right I don't know how it

78
00:03:13,799 --> 00:03:18,180
works in India in in Europe and the

79
00:03:16,049 --> 00:03:21,930
states usually 16 alarm system is

80
00:03:18,180 --> 00:03:23,700
installed by a third party by a company

81
00:03:21,930 --> 00:03:25,769
which means they also go to the site and

82
00:03:23,700 --> 00:03:27,690
try to arrest whoever is doing the bad

83
00:03:25,769 --> 00:03:29,250
stuff right but it usually takes some

84
00:03:27,690 --> 00:03:30,750
time to get there driving from the

85
00:03:29,250 --> 00:03:32,910
airport to here it took me like more

86
00:03:30,750 --> 00:03:36,180
than an hour for example he said what

87
00:03:32,910 --> 00:03:38,430
could go wrong with an alarm system one

88
00:03:36,180 --> 00:03:40,680
of the things that could go wrong we

89
00:03:38,430 --> 00:03:45,540
have your code right the code is usually

90
00:03:40,680 --> 00:03:47,910
four digits it's relatively short so if

91
00:03:45,540 --> 00:03:50,940
attacker were to try many many possible

92
00:03:47,910 --> 00:03:54,950
codes he might end up with getting the

93
00:03:50,940 --> 00:03:58,709
red code eventually how many of you have

94
00:03:54,950 --> 00:04:00,328
worked and I mean used with an alarm

95
00:03:58,709 --> 00:04:04,019
system in the past months like at work

96
00:04:00,329 --> 00:04:07,230
or at home anyone okay like four or five

97
00:04:04,019 --> 00:04:09,660
people Oh a bit more so if you've ever

98
00:04:07,230 --> 00:04:11,670
entered the round code like five times

99
00:04:09,660 --> 00:04:13,319
you will be in trouble right maybe some

100
00:04:11,670 --> 00:04:14,850
of you have experienced that system will

101
00:04:13,319 --> 00:04:19,680
lock out and will not allow you to guess

102
00:04:14,850 --> 00:04:23,969
the code but here if it is done by robot

103
00:04:19,680 --> 00:04:26,490
let's say over a period of 30 days or 60

104
00:04:23,970 --> 00:04:29,240
days the robot can do that slowly enough

105
00:04:26,490 --> 00:04:33,259
as to not trip

106
00:04:29,240 --> 00:04:36,380
the protection of brute force another

107
00:04:33,259 --> 00:04:37,819
thing let's look at this example here we

108
00:04:36,380 --> 00:04:39,889
have a storage building so large

109
00:04:37,819 --> 00:04:41,389
building work may be hotel like this

110
00:04:39,889 --> 00:04:43,550
right but hotel is a public place so

111
00:04:41,389 --> 00:04:45,710
that private private your private house

112
00:04:43,550 --> 00:04:47,810
was a huge house or a storage building

113
00:04:45,710 --> 00:04:51,049
and you have installed an alarm in it

114
00:04:47,810 --> 00:04:53,360
you have of course your keypad at the

115
00:04:51,050 --> 00:04:55,599
entry you have of course one more key

116
00:04:53,360 --> 00:04:57,500
but because it's a huge building and

117
00:04:55,599 --> 00:04:59,180
sounds the people and through from

118
00:04:57,500 --> 00:05:01,780
different direction you don't want to

119
00:04:59,180 --> 00:05:04,220
walk all around the building right I

120
00:05:01,780 --> 00:05:08,030
once stayed in this hotel in Tallinn and

121
00:05:04,220 --> 00:05:10,340
the hotel is literally 900 meters long

122
00:05:08,030 --> 00:05:12,080
and if you get to the wrong side you

123
00:05:10,340 --> 00:05:14,330
can't get in because this entrance is

124
00:05:12,080 --> 00:05:16,240
only from other side so for large

125
00:05:14,330 --> 00:05:18,710
buildings it is not unusual to have an

126
00:05:16,240 --> 00:05:21,949
extra keypad installed on some other

127
00:05:18,710 --> 00:05:23,960
places and we of course have different

128
00:05:21,949 --> 00:05:26,990
sensors those can be by the infrared

129
00:05:23,960 --> 00:05:29,599
sensors or sensors that trip the wire

130
00:05:26,990 --> 00:05:31,460
when windows opened and so on now let's

131
00:05:29,599 --> 00:05:34,909
say one of the keypads is not really

132
00:05:31,460 --> 00:05:38,448
used is there you installed it but no

133
00:05:34,909 --> 00:05:41,210
people actually use it so what that

134
00:05:38,449 --> 00:05:42,949
means is it's abandoned it still works

135
00:05:41,210 --> 00:05:45,680
you can still use it to access the

136
00:05:42,949 --> 00:05:47,150
system but no one uses it daily so what

137
00:05:45,680 --> 00:05:49,729
happens if an attacker get access is a

138
00:05:47,150 --> 00:05:51,710
key pad can't the attacker do something

139
00:05:49,729 --> 00:05:53,419
bad like extract information about your

140
00:05:51,710 --> 00:05:55,219
movement about where you are in the

141
00:05:53,419 --> 00:05:57,289
building about where the sensors are

142
00:05:55,219 --> 00:05:59,599
being tripped or maybe can the attacker

143
00:05:57,289 --> 00:06:03,380
exfiltrate a code that you're entering

144
00:05:59,599 --> 00:06:05,240
on the other keypad so that's what I'm

145
00:06:03,380 --> 00:06:10,580
gonna show today just part of what I'm

146
00:06:05,240 --> 00:06:12,919
gonna show today so paradox security

147
00:06:10,580 --> 00:06:18,198
systems right it's a Canadian company

148
00:06:12,919 --> 00:06:19,549
it's founded in 1989 and they make

149
00:06:18,199 --> 00:06:20,659
alarms just like this one of course

150
00:06:19,550 --> 00:06:21,860
usually they're installed in the

151
00:06:20,659 --> 00:06:24,080
building this is just a portable case

152
00:06:21,860 --> 00:06:25,340
for demonstration purposes I guess that

153
00:06:24,080 --> 00:06:27,409
intermission this kind of demonstration

154
00:06:25,340 --> 00:06:28,849
when they made this case so its module

155
00:06:27,409 --> 00:06:30,979
of secure alarms and they have three

156
00:06:28,849 --> 00:06:34,789
different kinds connect at the entry

157
00:06:30,979 --> 00:06:37,130
level called spectrum they have the card

158
00:06:34,789 --> 00:06:40,219
security an access system called ever

159
00:06:37,130 --> 00:06:42,199
this is the one here and they also have

160
00:06:40,219 --> 00:06:43,009
Megalon which is wireless and these days

161
00:06:42,199 --> 00:06:44,930
you don't want

162
00:06:43,009 --> 00:06:46,909
to ruin your fancy apartment or a fancy

163
00:06:44,930 --> 00:06:48,110
office with a lot of wires so what you

164
00:06:46,909 --> 00:06:51,169
actually want is usually using the

165
00:06:48,110 --> 00:06:52,759
wireless system and it's on my to-do

166
00:06:51,169 --> 00:06:54,318
list actually look at that because I'm

167
00:06:52,759 --> 00:06:54,589
I'm a bit worried about what I might

168
00:06:54,319 --> 00:06:56,960
find

169
00:06:54,589 --> 00:06:58,430
anyway so I've chosen here the mo the

170
00:06:56,960 --> 00:07:00,529
current security and access system for

171
00:06:58,430 --> 00:07:02,899
more challenge so what does the system

172
00:07:00,529 --> 00:07:04,699
consist of is only approximately 10 a

173
00:07:02,899 --> 00:07:06,469
few have actually used the system

174
00:07:04,699 --> 00:07:09,289
I imagine that almost none of you have

175
00:07:06,469 --> 00:07:12,139
installed one so the brains of the

176
00:07:09,289 --> 00:07:14,389
system may look like that it's like a

177
00:07:12,139 --> 00:07:17,029
small board that's installed in some

178
00:07:14,389 --> 00:07:20,029
hard-to-reach place in a building right

179
00:07:17,029 --> 00:07:21,949
it's a panel and we also have some

180
00:07:20,029 --> 00:07:24,199
ancillary switch are not too important

181
00:07:21,949 --> 00:07:25,999
for our purposes but without which the

182
00:07:24,199 --> 00:07:29,749
system will not be functional enough

183
00:07:25,999 --> 00:07:32,919
right battery power supply siren to

184
00:07:29,749 --> 00:07:37,699
alert when the system is tripped right

185
00:07:32,919 --> 00:07:40,729
and for paradox systems we have what's

186
00:07:37,699 --> 00:07:42,139
called combust slaves device it fried

187
00:07:40,729 --> 00:07:44,529
two-way communication for example a

188
00:07:42,139 --> 00:07:48,379
keypad if you look at a keypad right

189
00:07:44,529 --> 00:07:52,069
we'd not only type in the code in the

190
00:07:48,379 --> 00:07:55,339
key part we would also want to see the

191
00:07:52,069 --> 00:07:57,259
status of the system so it happened to

192
00:07:55,339 --> 00:07:58,669
me numerous times maybe not this keypad

193
00:07:57,259 --> 00:08:00,519
here which has physical buttons but the

194
00:07:58,669 --> 00:08:03,740
other keeper that they have that have

195
00:08:00,519 --> 00:08:06,080
touch buttons I press the wrong button

196
00:08:03,740 --> 00:08:07,969
and I don't have feedback because I

197
00:08:06,080 --> 00:08:10,779
don't see the the digits that have

198
00:08:07,969 --> 00:08:13,248
pressed on the screen it's hidden so

199
00:08:10,779 --> 00:08:14,539
it's important for this device to

200
00:08:13,249 --> 00:08:17,389
actually be able to show if the code is

201
00:08:14,539 --> 00:08:19,009
correct in the end or not if the system

202
00:08:17,389 --> 00:08:21,289
is armed or not if you have moment or

203
00:08:19,009 --> 00:08:23,120
not so it's two-way communication and

204
00:08:21,289 --> 00:08:24,649
they also provide some fun modules that

205
00:08:23,120 --> 00:08:26,240
you can use like expansion print or

206
00:08:24,649 --> 00:08:28,309
listening modules this is a printer

207
00:08:26,240 --> 00:08:30,499
module you can connect a parallel port

208
00:08:28,309 --> 00:08:32,959
printer serial port printer and a USB

209
00:08:30,499 --> 00:08:36,199
printer to the comm bus and then you can

210
00:08:32,958 --> 00:08:38,059
print your logs live or whatever there's

211
00:08:36,198 --> 00:08:40,429
also listening module which is a fun one

212
00:08:38,059 --> 00:08:42,679
you can call into your alarm system

213
00:08:40,429 --> 00:08:44,388
remotely or your company's installed it

214
00:08:42,679 --> 00:08:45,979
can call it remotely and listen in

215
00:08:44,389 --> 00:08:47,750
what's happening in the building or

216
00:08:45,980 --> 00:08:50,089
wherever that modules installed so

217
00:08:47,750 --> 00:08:51,500
that's an interesting one they have but

218
00:08:50,089 --> 00:08:54,500
anyway we're working with combos here

219
00:08:51,500 --> 00:08:55,790
now but of course no alarm system could

220
00:08:54,500 --> 00:08:56,570
work without the so-called zone

221
00:08:55,790 --> 00:08:58,300
interrupt devices

222
00:08:56,570 --> 00:09:02,120
those are the sensors so to speak

223
00:08:58,300 --> 00:09:04,310
passive infrared sensors tripwires and

224
00:09:02,120 --> 00:09:06,830
so on right you've seen those on doors

225
00:09:04,310 --> 00:09:10,130
or windows for example or or these over

226
00:09:06,830 --> 00:09:12,950
here right so basically all it does is

227
00:09:10,130 --> 00:09:14,660
it measures resistance of the connection

228
00:09:12,950 --> 00:09:15,920
of the circuit and as soon as it changes

229
00:09:14,660 --> 00:09:18,079
to a pretty different level or a

230
00:09:15,920 --> 00:09:20,180
different level it will leave your trips

231
00:09:18,080 --> 00:09:22,100
alarm or trip the fault

232
00:09:20,180 --> 00:09:24,739
meaning that sensor has been damaged and

233
00:09:22,100 --> 00:09:26,270
either of those would result in alarm

234
00:09:24,740 --> 00:09:28,870
and security company coming in if the

235
00:09:26,270 --> 00:09:32,420
system is locked at that specific time

236
00:09:28,870 --> 00:09:35,600
but packing the assistance is at the

237
00:09:32,420 --> 00:09:38,990
sensor is a bit hard because they

238
00:09:35,600 --> 00:09:41,600
measure resistance and trying to switch

239
00:09:38,990 --> 00:09:43,670
quickly enough like removing a device

240
00:09:41,600 --> 00:09:46,310
and replacing it with a fake sensor

241
00:09:43,670 --> 00:09:47,930
that's always safe position you can't

242
00:09:46,310 --> 00:09:49,880
really do that because of the timings so

243
00:09:47,930 --> 00:09:51,319
there are other things you can do and

244
00:09:49,880 --> 00:09:56,390
we're going to take a look at them here

245
00:09:51,320 --> 00:10:00,040
now so this is the device that we are

246
00:09:56,390 --> 00:10:02,420
actually using here it's a one nine to

247
00:10:00,040 --> 00:10:04,130
one of the highest that they have they

248
00:10:02,420 --> 00:10:07,040
also have mo HD which is a bit newer

249
00:10:04,130 --> 00:10:12,170
model but this is this is the second

250
00:10:07,040 --> 00:10:13,760
best they have so it has 192 zones as a

251
00:10:12,170 --> 00:10:16,040
maximum that's where the name comes from

252
00:10:13,760 --> 00:10:18,439
so what do we see on the panel here we

253
00:10:16,040 --> 00:10:21,380
see the input words for for example

254
00:10:18,440 --> 00:10:22,760
power supply that's where we connected

255
00:10:21,380 --> 00:10:24,320
to the mains we have the battery

256
00:10:22,760 --> 00:10:26,420
connector right because we don't want

257
00:10:24,320 --> 00:10:28,130
the bad guys cutting off the power and

258
00:10:26,420 --> 00:10:29,630
getting in we want the system to still

259
00:10:28,130 --> 00:10:31,430
work for some time after the power has

260
00:10:29,630 --> 00:10:33,170
been lost and a real time clock battery

261
00:10:31,430 --> 00:10:34,880
for the clocks of the date is corrected

262
00:10:33,170 --> 00:10:37,670
it literally does nothing else it just

263
00:10:34,880 --> 00:10:39,320
keeps a date correct and I don't have it

264
00:10:37,670 --> 00:10:41,150
on my system for tribal reasons and

265
00:10:39,320 --> 00:10:44,510
that's why I have trouble saying there's

266
00:10:41,150 --> 00:10:47,030
no TT batteries the compass this is what

267
00:10:44,510 --> 00:10:49,819
we are discussing here today so wires

268
00:10:47,030 --> 00:10:51,589
from here will go to all well smart

269
00:10:49,820 --> 00:10:53,450
devices but not IOT kind of smart

270
00:10:51,590 --> 00:10:54,890
devices right smart devices where we

271
00:10:53,450 --> 00:10:57,530
have feedback where we have two-way

272
00:10:54,890 --> 00:11:00,020
communication and zones will happen here

273
00:10:57,530 --> 00:11:04,280
say Z 1 to Z 8 these are the zones and

274
00:11:00,020 --> 00:11:05,750
we can expand them of course for an

275
00:11:04,280 --> 00:11:07,910
attacker or should I say for an

276
00:11:05,750 --> 00:11:10,250
installer that install the system there

277
00:11:07,910 --> 00:11:11,900
is also a need connect

278
00:11:10,250 --> 00:11:13,970
you can use to connect to these four

279
00:11:11,900 --> 00:11:15,470
pins it's called service keypad if you

280
00:11:13,970 --> 00:11:16,700
actually get to the device you can like

281
00:11:15,470 --> 00:11:19,400
the right ena you don't have to fiddle

282
00:11:16,700 --> 00:11:20,780
with wires like I did here but we're

283
00:11:19,400 --> 00:11:23,510
going to do that because you know we are

284
00:11:20,780 --> 00:11:25,040
simulating an attack we also have a

285
00:11:23,510 --> 00:11:26,510
serial port the classical one it's

286
00:11:25,040 --> 00:11:28,610
usually not connected then we have mem

287
00:11:26,510 --> 00:11:30,770
key port this is a fun one you can

288
00:11:28,610 --> 00:11:33,050
connect the special USB flash it is a

289
00:11:30,770 --> 00:11:34,699
special connector flash drive and it

290
00:11:33,050 --> 00:11:37,490
will copy all the configuration into the

291
00:11:34,700 --> 00:11:41,050
flash so that's an interesting one right

292
00:11:37,490 --> 00:11:44,840
if you get your hands on the panel so

293
00:11:41,050 --> 00:11:47,660
the radio part the one that I can't demo

294
00:11:44,840 --> 00:11:53,060
here today but the one that I still

295
00:11:47,660 --> 00:11:55,430
won't talk about a bit so this is one of

296
00:11:53,060 --> 00:11:57,229
the remote that they have one of the top

297
00:11:55,430 --> 00:11:58,400
level remote it's a two-way

298
00:11:57,230 --> 00:12:01,610
communication remote it also has

299
00:11:58,400 --> 00:12:04,880
feedback they have a bit cheaper remotes

300
00:12:01,610 --> 00:12:07,790
that not not that feature full but this

301
00:12:04,880 --> 00:12:09,500
one here it has feedback it has led LED

302
00:12:07,790 --> 00:12:11,630
over here and it actually can light up

303
00:12:09,500 --> 00:12:13,730
the buttons as well in different colors

304
00:12:11,630 --> 00:12:16,670
here so when you press a button you can

305
00:12:13,730 --> 00:12:18,920
see feedback so naturally I thought how

306
00:12:16,670 --> 00:12:21,229
does it communicate right where do I get

307
00:12:18,920 --> 00:12:23,540
it what would be the first thing you do

308
00:12:21,230 --> 00:12:28,760
if you want to reverse really a

309
00:12:23,540 --> 00:12:32,420
frequency device so most manuals online

310
00:12:28,760 --> 00:12:34,490
talk about getting to FCC website and

311
00:12:32,420 --> 00:12:37,370
looking at the FCC ID and then you get

312
00:12:34,490 --> 00:12:40,010
the spec now the thing is paradox is a

313
00:12:37,370 --> 00:12:41,450
Canadian company and even though they

314
00:12:40,010 --> 00:12:44,569
sell their stuff to us

315
00:12:41,450 --> 00:12:46,970
apparently they custom tailor make it so

316
00:12:44,570 --> 00:12:48,740
this one has been sold to Latvian not to

317
00:12:46,970 --> 00:12:51,530
say yes and I couldn't find an FCC ID

318
00:12:48,740 --> 00:12:54,560
anywhere so I've had to do it other way

319
00:12:51,530 --> 00:12:56,329
I opened it up looked for the iccid of

320
00:12:54,560 --> 00:12:57,670
course nothing there this is everything

321
00:12:56,330 --> 00:13:00,170
that we have in there we have a battery

322
00:12:57,670 --> 00:13:03,829
we have a couple buttons a bunch of LEDs

323
00:13:00,170 --> 00:13:07,040
some more LEDs over here and two chips

324
00:13:03,830 --> 00:13:08,360
oh there's a really ingenious thing that

325
00:13:07,040 --> 00:13:11,750
doesn't have anything to do with this

326
00:13:08,360 --> 00:13:13,670
but it's really it's really so so

327
00:13:11,750 --> 00:13:15,830
imaginative that they made it so the

328
00:13:13,670 --> 00:13:17,689
battery connector also acts as ground

329
00:13:15,830 --> 00:13:19,110
for the speaker there speaker on the

330
00:13:17,690 --> 00:13:20,550
other side and

331
00:13:19,110 --> 00:13:21,930
and it connects via the battery

332
00:13:20,550 --> 00:13:24,300
connector one of the two terminals

333
00:13:21,930 --> 00:13:26,760
that's what engineers anyway so what we

334
00:13:24,300 --> 00:13:29,519
see here we have programmable controller

335
00:13:26,760 --> 00:13:31,350
so a micro controller here it's an 8-bit

336
00:13:29,519 --> 00:13:34,730
one it's not I think yeah it's not too

337
00:13:31,350 --> 00:13:36,899
powerful and we have a transmitter

338
00:13:34,730 --> 00:13:38,899
transceiver actually so it can transmit

339
00:13:36,899 --> 00:13:42,380
or receive on the frequency of

340
00:13:38,899 --> 00:13:44,760
developers choice between these two

341
00:13:42,380 --> 00:13:47,189
frequencies so what we do we look up

342
00:13:44,760 --> 00:13:48,450
spec sheet and we listen in and on

343
00:13:47,190 --> 00:13:51,480
listening this is what we see when I

344
00:13:48,450 --> 00:13:52,649
press the button so hopefully some of

345
00:13:51,480 --> 00:13:55,890
you have worked with reindeers before

346
00:13:52,649 --> 00:14:00,570
what we see is we see communication

347
00:13:55,890 --> 00:14:02,880
around 43 3.9 megahertz and we see some

348
00:14:00,570 --> 00:14:04,459
echoes of it to the left as well so this

349
00:14:02,880 --> 00:14:06,930
is where the main communication happens

350
00:14:04,459 --> 00:14:09,829
but we have to look closer to understand

351
00:14:06,930 --> 00:14:11,670
what the protocol is right so by the way

352
00:14:09,829 --> 00:14:13,399
hacking is all about learning new things

353
00:14:11,670 --> 00:14:16,649
so in case you want to go into there

354
00:14:13,399 --> 00:14:17,970
this is from program called GQ oryx all

355
00:14:16,649 --> 00:14:20,550
right you can take a look at that if you

356
00:14:17,970 --> 00:14:24,800
if you tracking radios so this picture

357
00:14:20,550 --> 00:14:27,540
here is from urh universal radio hacker

358
00:14:24,800 --> 00:14:29,490
we go in closer we turn on the frequency

359
00:14:27,540 --> 00:14:31,050
and we take a look at how how the

360
00:14:29,490 --> 00:14:32,310
specific frequency looks how the

361
00:14:31,050 --> 00:14:33,709
amplitude owns looks this is how it

362
00:14:32,310 --> 00:14:38,279
looks I press the button three times

363
00:14:33,709 --> 00:14:41,160
here so it's four three three point one

364
00:14:38,279 --> 00:14:43,200
megahertz and I see that transmitter

365
00:14:41,160 --> 00:14:45,180
esteem Scherz Scherz the same channel

366
00:14:43,200 --> 00:14:47,370
how they see it I see it because of this

367
00:14:45,180 --> 00:14:50,160
spike here if I press the button with

368
00:14:47,370 --> 00:14:53,490
the system turned off I don't get the

369
00:14:50,160 --> 00:14:55,980
spike I just get these eight packets set

370
00:14:53,490 --> 00:14:58,260
sent right even the system is on it

371
00:14:55,980 --> 00:15:00,360
replies and two more pebbles powerful

372
00:14:58,260 --> 00:15:02,699
transmitter because it doesn't work on a

373
00:15:00,360 --> 00:15:04,770
small battery and we see the reply there

374
00:15:02,699 --> 00:15:10,290
is one reply from the system all right

375
00:15:04,770 --> 00:15:13,079
so that's what we see here now we need

376
00:15:10,290 --> 00:15:15,480
to look even more closely or saw sparks

377
00:15:13,079 --> 00:15:18,959
edits and we have to look at the date

378
00:15:15,480 --> 00:15:21,329
inside so when we zoom in this is this

379
00:15:18,959 --> 00:15:23,040
is what we see so one of those adverts

380
00:15:21,329 --> 00:15:24,689
this is how it looks this is beginning

381
00:15:23,040 --> 00:15:28,380
of it right it's a bit longer as you

382
00:15:24,690 --> 00:15:30,690
didn't want you to to copy my Mikey so I

383
00:15:28,380 --> 00:15:32,189
just included the first part and we

384
00:15:30,690 --> 00:15:32,730
already see something similar to those

385
00:15:32,190 --> 00:15:34,649
of us who

386
00:15:32,730 --> 00:15:37,320
work with radio right we see the

387
00:15:34,649 --> 00:15:39,600
preamble here for example 0 1 0 1 0 1 0

388
00:15:37,320 --> 00:15:41,070
1 right and then some ones and zeros so

389
00:15:39,600 --> 00:15:43,230
it looks it looks quite simple right

390
00:15:41,070 --> 00:15:46,709
what we see is one level amplitude shift

391
00:15:43,230 --> 00:15:48,690
keying meaning that when transmitter is

392
00:15:46,709 --> 00:15:51,869
on it's a one wench is no resolve it to

393
00:15:48,690 --> 00:15:55,019
zero and the bit length if we zoom even

394
00:15:51,870 --> 00:15:57,649
more close here is 200 microseconds all

395
00:15:55,019 --> 00:16:00,510
right so that's just this part here

396
00:15:57,649 --> 00:16:03,839
zoomed in we have one zero one zero one

397
00:16:00,510 --> 00:16:07,350
zero zero bunch of ones and so on right

398
00:16:03,839 --> 00:16:09,149
so that's that's how it works well

399
00:16:07,350 --> 00:16:11,670
unfortunately this is about where where

400
00:16:09,149 --> 00:16:14,430
I have to end this part since I can't

401
00:16:11,670 --> 00:16:18,420
show the demo but so the structure the

402
00:16:14,430 --> 00:16:19,709
unit is four ones is just four for

403
00:16:18,420 --> 00:16:22,410
anyone who may want to carry this

404
00:16:19,709 --> 00:16:26,160
further on in transition tramble twelve

405
00:16:22,410 --> 00:16:33,899
twelve sets of 0 and 1 and packet

406
00:16:26,160 --> 00:16:37,110
lengths so data is 120 bits so I will

407
00:16:33,899 --> 00:16:41,579
return to this in in a country that

408
00:16:37,110 --> 00:16:43,709
doesn't forbid import off of ready

409
00:16:41,579 --> 00:16:46,859
equipment that not not quite licensed

410
00:16:43,709 --> 00:16:49,138
and yeah but for now let's look at what

411
00:16:46,860 --> 00:16:51,600
I actually can demo here with you today

412
00:16:49,139 --> 00:16:54,209
and it's an attack tool before them all

413
00:16:51,600 --> 00:16:56,579
let's talk about it how I made it

414
00:16:54,209 --> 00:16:58,529
m5 stack is what I decided to base my

415
00:16:56,579 --> 00:16:59,959
attack tool on so once again if we go

416
00:16:58,529 --> 00:17:03,089
back a bit

417
00:16:59,959 --> 00:17:05,040
then what I had in the previous

418
00:17:03,089 --> 00:17:07,110
iteration of this research is I had my

419
00:17:05,040 --> 00:17:10,740
laptop I had some wires going through

420
00:17:07,109 --> 00:17:15,208
the laptop via an Arduino and I was able

421
00:17:10,740 --> 00:17:19,500
to see what codes user would type on a

422
00:17:15,209 --> 00:17:21,240
different keypad now this time I thought

423
00:17:19,500 --> 00:17:22,410
my laptop over here and my attack tool

424
00:17:21,240 --> 00:17:27,000
over here you will see that on the

425
00:17:22,410 --> 00:17:28,740
screen in a minute or two and it doesn't

426
00:17:27,000 --> 00:17:30,809
require a laptop anymore so it's much

427
00:17:28,740 --> 00:17:31,350
more easy easy to use my short

428
00:17:30,809 --> 00:17:34,889
concealable

429
00:17:31,350 --> 00:17:37,620
this is m5 stack so it's 5 by 5

430
00:17:34,890 --> 00:17:39,570
centimeters and the car two times I

431
00:17:37,620 --> 00:17:42,689
stock anyone heard of or used a five

432
00:17:39,570 --> 00:17:44,549
stack okay you should you can try it out

433
00:17:42,690 --> 00:17:46,200
for prototyping it's quite a good the

434
00:17:44,549 --> 00:17:48,239
only bad thing about it is power

435
00:17:46,200 --> 00:17:50,580
consumption when it's all foreign sidles

436
00:17:48,239 --> 00:17:53,009
herbal but other than that it's it's

437
00:17:50,580 --> 00:17:55,199
quite a neat device so ESP 32 which

438
00:17:53,009 --> 00:17:57,029
means basically or do you know Wi-Fi

439
00:17:55,200 --> 00:17:58,529
bluetooth he already have a bunch of

440
00:17:57,029 --> 00:18:00,830
stuff right

441
00:17:58,529 --> 00:18:04,499
we have antennae of course we have

442
00:18:00,830 --> 00:18:09,149
button we have a USBC connector we have

443
00:18:04,499 --> 00:18:11,609
a groove port here we have micro SD card

444
00:18:09,149 --> 00:18:14,008
connector here we have a speaker even

445
00:18:11,609 --> 00:18:15,389
and we have an expansion port where we

446
00:18:14,009 --> 00:18:16,440
can stack it up that's why that's why

447
00:18:15,389 --> 00:18:19,229
it's called stack we can stack up

448
00:18:16,440 --> 00:18:20,999
different modules one over over another

449
00:18:19,230 --> 00:18:22,980
and and that's not look so it can be

450
00:18:20,999 --> 00:18:24,600
stack up quite quite high on the front

451
00:18:22,980 --> 00:18:27,179
we have this plain button so it's quite

452
00:18:24,600 --> 00:18:29,100
nice device for prototyping here I think

453
00:18:27,179 --> 00:18:37,200
it's it still has power here for me so

454
00:18:29,100 --> 00:18:39,090
that's good so how I did it the compass

455
00:18:37,200 --> 00:18:41,190
the one we already discussed the one we

456
00:18:39,090 --> 00:18:42,809
saw on the panel in the in the back of

457
00:18:41,190 --> 00:18:49,259
the panel the picture that we had has

458
00:18:42,809 --> 00:18:53,309
four wires it has red red black green

459
00:18:49,259 --> 00:18:56,549
and yellow and this as are the layers of

460
00:18:53,309 --> 00:18:58,470
combos that I myself decided upon

461
00:18:56,549 --> 00:18:59,940
because there are no official specs for

462
00:18:58,470 --> 00:19:01,950
combos maybe they are if you sign an NDA

463
00:18:59,940 --> 00:19:03,989
I did the Tal reverse engineering from

464
00:19:01,950 --> 00:19:07,139
zero so maybe maybe those are different

465
00:19:03,989 --> 00:19:09,029
but this is a bit similar to how I saw

466
00:19:07,139 --> 00:19:10,949
oh say standards for network works right

467
00:19:09,029 --> 00:19:12,809
we have electrical layer signal air

468
00:19:10,950 --> 00:19:15,960
packet command and payload layer right

469
00:19:12,809 --> 00:19:18,720
so looking into electro layer it's quite

470
00:19:15,960 --> 00:19:20,759
easy we have of course our forward bus

471
00:19:18,720 --> 00:19:23,369
we have black and red foreground and

472
00:19:20,759 --> 00:19:25,409
power this is the key part here we can

473
00:19:23,369 --> 00:19:27,330
connect over here of course yellow is

474
00:19:25,409 --> 00:19:29,340
pluck and green is data so that's that's

475
00:19:27,330 --> 00:19:32,249
how far I've got right here we can see

476
00:19:29,340 --> 00:19:33,480
an example any any experienced engineer

477
00:19:32,249 --> 00:19:35,190
will immediately tell you that this

478
00:19:33,480 --> 00:19:38,450
looks like a clock the yellow one and

479
00:19:35,190 --> 00:19:41,369
the green one looks more like data but

480
00:19:38,450 --> 00:19:43,320
the thing is it's also a two-way

481
00:19:41,369 --> 00:19:44,879
communication protocol remember we need

482
00:19:43,320 --> 00:19:47,399
the keypad to be able to receive the

483
00:19:44,879 --> 00:19:49,799
status of the system not only receive

484
00:19:47,399 --> 00:19:53,939
the code or commands not only sends the

485
00:19:49,799 --> 00:19:56,620
code and commands from there so how it

486
00:19:53,940 --> 00:20:00,299
works is that clock is used

487
00:19:56,620 --> 00:20:03,129
both part of the phase when it's high

488
00:20:00,299 --> 00:20:05,379
then slave is able to communicate and

489
00:20:03,130 --> 00:20:06,789
when it's low then master is

490
00:20:05,380 --> 00:20:10,299
communicating so depending on the clock

491
00:20:06,789 --> 00:20:11,710
here the bit the respective bit is who

492
00:20:10,299 --> 00:20:13,840
is communicating and this is how it

493
00:20:11,710 --> 00:20:16,900
works master pulls up to send one and

494
00:20:13,840 --> 00:20:20,350
sly pulls down to send one so it's a

495
00:20:16,900 --> 00:20:24,100
reverse scheme in such a way so this is

496
00:20:20,350 --> 00:20:28,689
the hardware setup here this is our fi

497
00:20:24,100 --> 00:20:30,490
stack this connects to our comm bus so

498
00:20:28,690 --> 00:20:31,960
we have black wire green wire and yellow

499
00:20:30,490 --> 00:20:35,890
wire it's just an X directly to combos

500
00:20:31,960 --> 00:20:37,750
and well it's not as neat as I wanted it

501
00:20:35,890 --> 00:20:41,289
to be I still need to order one more

502
00:20:37,750 --> 00:20:42,909
expansion board where I can solder the

503
00:20:41,289 --> 00:20:44,919
resistors but basically we have a couple

504
00:20:42,909 --> 00:20:47,169
of resistors there for those of you who

505
00:20:44,919 --> 00:20:51,149
want to repeat this and the code will be

506
00:20:47,169 --> 00:20:55,000
published on github in today or tomorrow

507
00:20:51,149 --> 00:20:57,370
so what we have here we have the ground

508
00:20:55,000 --> 00:20:59,500
is connected via a 300 ohm resistor and

509
00:20:57,370 --> 00:21:01,689
I have to warn you that the resistor

510
00:20:59,500 --> 00:21:06,429
values still need fine-tuning but mostly

511
00:21:01,690 --> 00:21:07,809
it works so it's a isolated here so that

512
00:21:06,429 --> 00:21:12,190
has not be interfere with quite a

513
00:21:07,809 --> 00:21:15,779
sensitive protocol and then we have we

514
00:21:12,190 --> 00:21:18,970
have a pulldown resistor here between

515
00:21:15,779 --> 00:21:21,520
the green one the data line and the

516
00:21:18,970 --> 00:21:27,730
ground because the Arduino inside here

517
00:21:21,520 --> 00:21:30,370
he cannot provide cannot provide enough

518
00:21:27,730 --> 00:21:34,960
power to actually do that by itself but

519
00:21:30,370 --> 00:21:36,340
this works quite neatly so and when we

520
00:21:34,960 --> 00:21:38,950
actually intercept the packet this is

521
00:21:36,340 --> 00:21:41,760
what we see when master the panel

522
00:21:38,950 --> 00:21:44,200
communicates to the keypad we can see

523
00:21:41,760 --> 00:21:47,590
commands like this red for example here

524
00:21:44,200 --> 00:21:48,760
we have a command the command byte we

525
00:21:47,590 --> 00:21:51,970
have command content and we have a

526
00:21:48,760 --> 00:21:54,549
section right or here we see the panel

527
00:21:51,970 --> 00:21:57,130
sending in time it just sent clock all

528
00:21:54,549 --> 00:21:59,950
the time to all the keypads this is the

529
00:21:57,130 --> 00:22:01,750
default packet that it sends every pulse

530
00:21:59,950 --> 00:22:03,760
if it has nothing else to send this live

531
00:22:01,750 --> 00:22:04,270
on their hands here is channel request

532
00:22:03,760 --> 00:22:06,850
command

533
00:22:04,270 --> 00:22:08,740
it basically says I want to talk I'm the

534
00:22:06,850 --> 00:22:10,389
keypad or whatever and I want to

535
00:22:08,740 --> 00:22:12,970
communicate please let me communicate

536
00:22:10,390 --> 00:22:14,980
right as you know this the length is the

537
00:22:12,970 --> 00:22:18,070
same so monsters and this slave replies

538
00:22:14,980 --> 00:22:21,130
with this for example and this one here

539
00:22:18,070 --> 00:22:23,350
is a command or slave enter the pin code

540
00:22:21,130 --> 00:22:24,670
it says okay so I've another big code

541
00:22:23,350 --> 00:22:27,370
here's the code this is where I'm from

542
00:22:24,670 --> 00:22:29,320
and here's a checksum if you want to

543
00:22:27,370 --> 00:22:32,110
take a deeper look into how this is made

544
00:22:29,320 --> 00:22:35,320
you can pull up my old presentation and

545
00:22:32,110 --> 00:22:37,780
it's all in there now for checksum it's

546
00:22:35,320 --> 00:22:40,540
really really really a checksum so it

547
00:22:37,780 --> 00:22:41,740
just sounds everything and takes modules

548
00:22:40,540 --> 00:22:44,500
100 in hex

549
00:22:41,740 --> 00:22:48,280
so it's it's it's it's super easy right

550
00:22:44,500 --> 00:22:50,020
and checksum of course so that I should

551
00:22:48,280 --> 00:22:51,970
note begins at the yellow one right it

552
00:22:50,020 --> 00:22:55,740
begins at the yellow yellow byte it

553
00:22:51,970 --> 00:22:58,090
doesn't include what's before there so

554
00:22:55,740 --> 00:23:00,190
now that we have that let's look at

555
00:22:58,090 --> 00:23:02,290
payloads the payloads that I discovered

556
00:23:00,190 --> 00:23:06,160
they have no encryption for this my

557
00:23:02,290 --> 00:23:10,659
security system for this mo 192 text is

558
00:23:06,160 --> 00:23:14,590
usually a fixed length often 16 bytes

559
00:23:10,660 --> 00:23:16,930
long and 0 20 or space characters used

560
00:23:14,590 --> 00:23:19,689
as a filler right for example here we

561
00:23:16,930 --> 00:23:22,840
can see panel informing all the keypads

562
00:23:19,690 --> 00:23:27,790
that there is a zone called door 0 1 and

563
00:23:22,840 --> 00:23:30,340
here it is it's its ID right numbers are

564
00:23:27,790 --> 00:23:32,889
usually packed binary coded decimal so

565
00:23:30,340 --> 00:23:35,409
that is what easy and there's one more

566
00:23:32,890 --> 00:23:38,500
hat so 0 in a number is usually

567
00:23:35,410 --> 00:23:42,430
converted to a in BCD you know we have

568
00:23:38,500 --> 00:23:44,980
if we have a number for example 29 then

569
00:23:42,430 --> 00:23:47,980
it would look at hex as hex 29 on the

570
00:23:44,980 --> 00:23:49,750
channel or in the data here if the

571
00:23:47,980 --> 00:23:52,240
numbers for example 20 it would be to a

572
00:23:49,750 --> 00:23:54,220
instead of 2-0 right in in hex that's

573
00:23:52,240 --> 00:23:55,780
what they did but so at least you have a

574
00:23:54,220 --> 00:23:59,940
sophistication even though there is no

575
00:23:55,780 --> 00:24:07,110
real encryption let's now take a look at

576
00:23:59,940 --> 00:24:12,120
demo so yes please please come here so

577
00:24:07,110 --> 00:24:12,120
let's see yeah let's start there if it's

578
00:24:13,020 --> 00:24:26,139
yeah no signal huh oh nice nice nice

579
00:24:22,020 --> 00:24:31,690
perfect perfect so this is the F I've

580
00:24:26,140 --> 00:24:33,309
stacked over here yes so you know then

581
00:24:31,690 --> 00:24:35,559
we have everything over here and the

582
00:24:33,309 --> 00:24:37,830
cable here goes to the keypad connector

583
00:24:35,559 --> 00:24:40,418
right and the wire goes into the barrel

584
00:24:37,830 --> 00:24:42,490
so and the key part is connected to one

585
00:24:40,419 --> 00:24:46,480
end so what we're simulating here is

586
00:24:42,490 --> 00:24:48,039
that we have a keypad that is not used

587
00:24:46,480 --> 00:24:49,960
that is abandoned and then tack or

588
00:24:48,039 --> 00:24:51,400
manages to connect to it and without

589
00:24:49,960 --> 00:24:51,970
interrupting the function into the

590
00:24:51,400 --> 00:24:54,220
device

591
00:24:51,970 --> 00:24:56,409
the attacker leaves the device attached

592
00:24:54,220 --> 00:24:58,720
over there and no one uses the keypad so

593
00:24:56,409 --> 00:25:02,440
no one notices and we can offer keypad

594
00:24:58,720 --> 00:25:04,419
over here that are the ones actually

595
00:25:02,440 --> 00:25:09,880
being used right so for example if I

596
00:25:04,419 --> 00:25:12,460
were to type in a pin code then if you

597
00:25:09,880 --> 00:25:14,080
look over here now like what no not

598
00:25:12,460 --> 00:25:17,140
luckily a program did to repeat itself

599
00:25:14,080 --> 00:25:19,570
if I press this button here it registers

600
00:25:17,140 --> 00:25:22,510
the pin code that was typed and it also

601
00:25:19,570 --> 00:25:26,020
shows it in red meaning that it was an

602
00:25:22,510 --> 00:25:28,360
incorrect pin code right so let's now

603
00:25:26,020 --> 00:25:32,320
type the correct one let's hope it is

604
00:25:28,360 --> 00:25:33,879
the correct one okay and it is asking me

605
00:25:32,320 --> 00:25:36,520
what way when I all right I'll say I'll

606
00:25:33,880 --> 00:25:38,049
stay in I'll be staying inside and it's

607
00:25:36,520 --> 00:25:40,210
arming in thread now and we can see here

608
00:25:38,049 --> 00:25:43,450
on this keypad over here it's exit delay

609
00:25:40,210 --> 00:25:45,640
right now over here hopefully if I look

610
00:25:43,450 --> 00:25:47,140
at the last code sent we see it's green

611
00:25:45,640 --> 00:25:51,190
so it was actually accepted by the

612
00:25:47,140 --> 00:25:53,200
system and this module knows that and so

613
00:25:51,190 --> 00:25:56,679
that's the first part right we have it

614
00:25:53,200 --> 00:26:00,370
here it remembers the last pin code mmm

615
00:25:56,679 --> 00:26:02,830
and that's how it works now we will

616
00:26:00,370 --> 00:26:03,840
return back to a different demo after

617
00:26:02,830 --> 00:26:12,549
some more slides

618
00:26:03,840 --> 00:26:14,799
the system is meanwhile arming so um

619
00:26:12,549 --> 00:26:16,900
this is basically I just took what I had

620
00:26:14,799 --> 00:26:18,730
in my in my laptop the code that had in

621
00:26:16,900 --> 00:26:20,559
there and I moved it into into the house

622
00:26:18,730 --> 00:26:21,909
I've stacked nothing nothing magical

623
00:26:20,559 --> 00:26:23,379
even though it's a nice device that you

624
00:26:21,909 --> 00:26:24,820
can actually go and sell on the black

625
00:26:23,380 --> 00:26:28,240
market somewhere not that I would do

626
00:26:24,820 --> 00:26:30,850
that um but I did want to do something

627
00:26:28,240 --> 00:26:33,340
more I wanted to actually for attacker

628
00:26:30,850 --> 00:26:35,049
to also be able to use this device to

629
00:26:33,340 --> 00:26:38,678
talk to the system not just

630
00:26:35,049 --> 00:26:44,080
see the codes that have been used but

631
00:26:38,679 --> 00:26:46,269
also send its own data so the question

632
00:26:44,080 --> 00:26:49,059
of course is why why would we need that

633
00:26:46,269 --> 00:26:53,590
what would be the use of this rogue

634
00:26:49,059 --> 00:26:55,989
device sending in some data well one

635
00:26:53,590 --> 00:26:58,480
thing I already mentioned if we want to

636
00:26:55,989 --> 00:26:59,139
brute force let's say a code slowly we

637
00:26:58,480 --> 00:27:01,779
can do that

638
00:26:59,139 --> 00:27:05,110
the device has a clock in it it's not

639
00:27:01,779 --> 00:27:08,169
RTC I think but it has ability to count

640
00:27:05,110 --> 00:27:11,678
time and it can time the attempt and

641
00:27:08,169 --> 00:27:14,679
test let's say a hundred codes per day

642
00:27:11,679 --> 00:27:18,119
right which means in three months we got

643
00:27:14,679 --> 00:27:21,519
at least one wallet for distinct codes

644
00:27:18,119 --> 00:27:23,379
we can also do protocol fuzzing now all

645
00:27:21,519 --> 00:27:26,320
these devices here all the keypads

646
00:27:23,379 --> 00:27:27,998
they are made by the manufacturer and

647
00:27:26,320 --> 00:27:30,428
they adhere to the protocol precisely

648
00:27:27,999 --> 00:27:34,299
and as you know one of the problems with

649
00:27:30,429 --> 00:27:37,269
protocols is that the developer usually

650
00:27:34,299 --> 00:27:39,249
thinks that they're closed this is my

651
00:27:37,269 --> 00:27:41,169
device it doesn't have to be Hardware

652
00:27:39,249 --> 00:27:43,570
right this is my webpage it will send me

653
00:27:41,169 --> 00:27:45,759
this HTTP request it will have this form

654
00:27:43,570 --> 00:27:47,590
data in it and this is my server side

655
00:27:45,759 --> 00:27:49,419
this will process the data and it's all

656
00:27:47,590 --> 00:27:51,340
closed ecosystem then a hacker comes and

657
00:27:49,419 --> 00:27:53,830
makes their own web page that sends

658
00:27:51,340 --> 00:27:56,439
different kind of data so not unlike

659
00:27:53,830 --> 00:27:58,629
here the developer thought of course we

660
00:27:56,440 --> 00:28:00,309
have these devices they communicate but

661
00:27:58,629 --> 00:28:02,769
with this device here we can actually

662
00:28:00,309 --> 00:28:05,529
try to fuzz the protocol we can try to

663
00:28:02,769 --> 00:28:09,970
put our own data see what happens if we

664
00:28:05,529 --> 00:28:13,659
send a packet with all zeros or of's and

665
00:28:09,970 --> 00:28:17,679
so on we also can do replay attacks so

666
00:28:13,659 --> 00:28:19,330
we can just for example record that

667
00:28:17,679 --> 00:28:22,450
something is happening we can record the

668
00:28:19,330 --> 00:28:24,939
whole day of people moving around the

669
00:28:22,450 --> 00:28:26,379
building and then we also press in a

670
00:28:24,940 --> 00:28:27,789
press of a button we can actually reply

671
00:28:26,379 --> 00:28:29,709
that to the system and the system will

672
00:28:27,789 --> 00:28:32,109
say thinking that the movement is the

673
00:28:29,710 --> 00:28:34,299
same for example on Sunday right you

674
00:28:32,109 --> 00:28:37,059
record Thursday and on Sunday you press

675
00:28:34,299 --> 00:28:38,080
a button and the system logs all the

676
00:28:37,059 --> 00:28:41,830
movement even though there's no one

677
00:28:38,080 --> 00:28:43,600
there and maybe open-source keypads

678
00:28:41,830 --> 00:28:45,490
right if you want to instead of using a

679
00:28:43,600 --> 00:28:46,899
closed source one from the manufacturer

680
00:28:45,490 --> 00:28:48,160
we can actually build around keypad as

681
00:28:46,899 --> 00:28:51,250
well using this

682
00:28:48,160 --> 00:28:54,130
so the questions here is can we do that

683
00:28:51,250 --> 00:28:55,600
and yeah the answer is of course that is

684
00:28:54,130 --> 00:29:02,350
that is why I'm going to show you them

685
00:28:55,600 --> 00:29:04,030
out here so let's hope that works neatly

686
00:29:02,350 --> 00:29:09,610
as well

687
00:29:04,030 --> 00:29:12,190
so let's put it over here so we can see

688
00:29:09,610 --> 00:29:14,500
here it says stay that means it stay

689
00:29:12,190 --> 00:29:17,110
armed meaning that if I were to open a

690
00:29:14,500 --> 00:29:19,120
door over here it would the alarm sound

691
00:29:17,110 --> 00:29:21,310
we don't want that right now at least

692
00:29:19,120 --> 00:29:22,989
let's try let's try to disarm it first

693
00:29:21,310 --> 00:29:26,889
let's move over here so we have our

694
00:29:22,990 --> 00:29:28,780
attack device over here and we will

695
00:29:26,890 --> 00:29:30,340
press the middle button and let's hope

696
00:29:28,780 --> 00:29:31,810
it works this is the first time I

697
00:29:30,340 --> 00:29:34,449
actually made a recording of my live

698
00:29:31,810 --> 00:29:36,700
demo I never do that but this time it's

699
00:29:34,450 --> 00:29:40,470
also finicky that I have a video if it

700
00:29:36,700 --> 00:29:40,470
doesn't work let's let's try that yeah

701
00:29:41,520 --> 00:29:48,910
nice it's green if you look back at the

702
00:29:44,110 --> 00:29:50,740
panel here it says disarmed so we

703
00:29:48,910 --> 00:29:52,720
managed to unlock the system just by

704
00:29:50,740 --> 00:29:56,580
pressing the buttons here we can try

705
00:29:52,720 --> 00:29:56,580
doing that again oh let's see

706
00:29:56,670 --> 00:30:11,350
mmm Oh let's lock it down let's use this

707
00:30:08,890 --> 00:30:12,880
army here so it's arming now you know

708
00:30:11,350 --> 00:30:14,350
when you actually the building it it

709
00:30:12,880 --> 00:30:17,080
does that so you know how much time we

710
00:30:14,350 --> 00:30:18,939
have left to arm it um get moved over

711
00:30:17,080 --> 00:30:23,800
here again let's see if we can cancel

712
00:30:18,940 --> 00:30:26,860
that arming yeah and we cancelled the

713
00:30:23,800 --> 00:30:29,710
arming zone so this is how it works in a

714
00:30:26,860 --> 00:30:32,709
nutshell right and I haven't tested it

715
00:30:29,710 --> 00:30:41,090
but I think even if you even if you

716
00:30:32,710 --> 00:30:43,940
would so even if

717
00:30:41,090 --> 00:30:49,129
would trip the alarm oh I shouldn't have

718
00:30:43,940 --> 00:30:51,920
done that it's disarmament hey let's use

719
00:30:49,130 --> 00:30:53,480
the other one that is not so noisy even

720
00:30:51,920 --> 00:30:58,250
if you tripped the alarm you should be

721
00:30:53,480 --> 00:30:59,920
able to actually to actually close it

722
00:30:58,250 --> 00:31:02,000
off and and cancel using this device

723
00:30:59,920 --> 00:31:04,000
which I'm going to try in a second but

724
00:31:02,000 --> 00:31:07,430
we don't need the camera for that so

725
00:31:04,000 --> 00:31:09,410
that's for the demos if you later on you

726
00:31:07,430 --> 00:31:12,260
can come on and take a look around

727
00:31:09,410 --> 00:31:13,610
around all the hardware if you want if

728
00:31:12,260 --> 00:31:20,060
you want more but I still have some

729
00:31:13,610 --> 00:31:23,810
stuff to tell you and the next topic I

730
00:31:20,060 --> 00:31:25,610
want to talk about is forever now for

731
00:31:23,810 --> 00:31:27,379
Fermat I told you I did some preliminary

732
00:31:25,610 --> 00:31:31,459
work to see if it's possible to register

733
00:31:27,380 --> 00:31:33,710
it and I'm committed on on continuing

734
00:31:31,460 --> 00:31:37,580
that work but it seems it might be a bit

735
00:31:33,710 --> 00:31:42,590
card so this is how this is a close-up

736
00:31:37,580 --> 00:31:46,129
of the panel we see some some chips that

737
00:31:42,590 --> 00:31:47,570
are that are quite telltale here and we

738
00:31:46,130 --> 00:31:51,410
can talk about what the ships are and

739
00:31:47,570 --> 00:31:56,720
what to expect but before that so our

740
00:31:51,410 --> 00:31:59,330
system has armed now it is it is locked

741
00:31:56,720 --> 00:32:01,070
right with instant locked let's try to

742
00:31:59,330 --> 00:32:03,830
open the door and hope that we don't

743
00:32:01,070 --> 00:32:06,560
have too much noise from the system so

744
00:32:03,830 --> 00:32:10,399
I'm gonna simulate opening the door and

745
00:32:06,560 --> 00:32:12,649
the alarm should go off right yeah okay

746
00:32:10,400 --> 00:32:15,200
so arm goes off long we're gonna try

747
00:32:12,650 --> 00:32:17,300
pressing the muffins here again and yeah

748
00:32:15,200 --> 00:32:20,060
nice so I didn't test that one before

749
00:32:17,300 --> 00:32:21,860
but even that works nice so okay back to

750
00:32:20,060 --> 00:32:23,750
the firmware part right we have we have

751
00:32:21,860 --> 00:32:25,850
this shipped over here what do we see

752
00:32:23,750 --> 00:32:28,100
I'm word I ordered them by the size of

753
00:32:25,850 --> 00:32:30,050
memory right so first of all we have

754
00:32:28,100 --> 00:32:34,429
this real-time clock chip over here it

755
00:32:30,050 --> 00:32:36,590
has 56 bytes of non-volatile Ram so

756
00:32:34,430 --> 00:32:38,270
nothing too interesting specs say that

757
00:32:36,590 --> 00:32:40,310
it only actually stores information

758
00:32:38,270 --> 00:32:43,520
related to the clock so we shouldn't

759
00:32:40,310 --> 00:32:44,750
expect to find much there where else

760
00:32:43,520 --> 00:32:45,889
could data be stored so what you're

761
00:32:44,750 --> 00:32:48,650
looking for are two things we were

762
00:32:45,890 --> 00:32:50,870
looking for the code that they made to

763
00:32:48,650 --> 00:32:54,020
actually take a look at how it works if

764
00:32:50,870 --> 00:32:56,389
there are any possible bugs you know do

765
00:32:54,020 --> 00:32:58,490
reverse engineering and code analysis on

766
00:32:56,390 --> 00:33:01,940
that another thing we're looking for is

767
00:32:58,490 --> 00:33:04,910
configuration codes all right if we were

768
00:33:01,940 --> 00:33:07,540
able to say get the six digit installer

769
00:33:04,910 --> 00:33:10,790
code you might be able to actually

770
00:33:07,540 --> 00:33:14,659
attack the system reconfigure the system

771
00:33:10,790 --> 00:33:18,350
as we wanted so the next one here is an

772
00:33:14,660 --> 00:33:22,520
EEPROM it's 32 kilobytes a page size is

773
00:33:18,350 --> 00:33:25,100
64 bytes so in 32 kilobytes we already

774
00:33:22,520 --> 00:33:26,780
can store enough so that might be one of

775
00:33:25,100 --> 00:33:29,899
the memories where user data is actually

776
00:33:26,780 --> 00:33:32,300
stored by the way important note when

777
00:33:29,900 --> 00:33:34,130
program in the system and you use a

778
00:33:32,300 --> 00:33:36,470
graphical panel like one of these one

779
00:33:34,130 --> 00:33:39,340
it's quite easy if you use a classical

780
00:33:36,470 --> 00:33:43,220
panel like this one here for example

781
00:33:39,340 --> 00:33:45,649
right you all you have is a small screen

782
00:33:43,220 --> 00:33:48,320
and a bunch of digits and you program it

783
00:33:45,650 --> 00:33:50,480
using using a programming sheet and it

784
00:33:48,320 --> 00:33:52,850
says for example if you want to add a

785
00:33:50,480 --> 00:33:54,679
new zone you write to this address this

786
00:33:52,850 --> 00:33:56,178
number right so basically we already

787
00:33:54,679 --> 00:33:58,490
have all the addresses in sense tellers

788
00:33:56,179 --> 00:34:00,309
manual so maybe they will match up that

789
00:33:58,490 --> 00:34:03,410
would be nice

790
00:34:00,309 --> 00:34:06,200
there's one more Ypres it's two times

791
00:34:03,410 --> 00:34:08,540
larger it's 64 kilobytes look at it

792
00:34:06,200 --> 00:34:12,590
right over here but the hard part is

793
00:34:08,540 --> 00:34:17,090
actually the microcontroller the micro

794
00:34:12,590 --> 00:34:20,570
micro controller is renesis r5 F and it

795
00:34:17,090 --> 00:34:23,330
also has memory it has 128 kilobytes

796
00:34:20,570 --> 00:34:24,770
plus 16 kilobytes of memory luckily

797
00:34:23,330 --> 00:34:27,679
according to the spec it's read-only

798
00:34:24,770 --> 00:34:30,199
memory meaning that at best all stores

799
00:34:27,679 --> 00:34:31,790
is the code it will not store in

800
00:34:30,199 --> 00:34:34,339
configuration because of it being a

801
00:34:31,790 --> 00:34:38,029
read-only memory it has a 4 kilobyte

802
00:34:34,340 --> 00:34:40,100
flash though but then again I guess that

803
00:34:38,030 --> 00:34:41,750
is why we have the eproms here for user

804
00:34:40,100 --> 00:34:44,299
data to be stored not the flash in here

805
00:34:41,750 --> 00:34:47,020
and it has 12 kilobytes of RAM which is

806
00:34:44,300 --> 00:34:49,730
average for an embedded device right

807
00:34:47,020 --> 00:34:51,320
some devices have kilobyte maybe 2

808
00:34:49,730 --> 00:34:54,290
kilobytes this one has 12 kilobytes of

809
00:34:51,320 --> 00:34:58,010
RAM so it can run some reasonable code

810
00:34:54,290 --> 00:35:01,310
now what we might get from that we might

811
00:34:58,010 --> 00:35:03,830
get the code that actually provides the

812
00:35:01,310 --> 00:35:06,770
radio communication because that is the

813
00:35:03,830 --> 00:35:09,200
non port right now how to

814
00:35:06,770 --> 00:35:10,640
fully replicate their idea how to

815
00:35:09,200 --> 00:35:15,649
understand what's inside instead of just

816
00:35:10,640 --> 00:35:19,720
reading a replay attack so next steps

817
00:35:15,650 --> 00:35:23,570
here are known but they are not easy so

818
00:35:19,720 --> 00:35:26,750
dump the data using a buff pirate use

819
00:35:23,570 --> 00:35:29,510
radar to my favorite I'll reverse

820
00:35:26,750 --> 00:35:31,850
engineering tool and probably it will

821
00:35:29,510 --> 00:35:33,950
also involve coding missing support for

822
00:35:31,850 --> 00:35:36,200
the processor because as far as I see

823
00:35:33,950 --> 00:35:39,980
radar doesn't have support for renesis

824
00:35:36,200 --> 00:35:43,879
r5 instruction sets so I might end up

825
00:35:39,980 --> 00:35:45,140
having to code some plugins for for Adar

826
00:35:43,880 --> 00:35:47,180
which is which I'm not really looking

827
00:35:45,140 --> 00:35:49,460
forward to too much but at the very

828
00:35:47,180 --> 00:35:51,919
least what we can do here is we can pull

829
00:35:49,460 --> 00:35:53,570
out the data out of the prompts and the

830
00:35:51,920 --> 00:35:55,010
data being data we can take a look at it

831
00:35:53,570 --> 00:35:57,710
using programmer sheet and we can

832
00:35:55,010 --> 00:36:00,040
actually fetch some useful information

833
00:35:57,710 --> 00:36:06,230
out of there

834
00:36:00,040 --> 00:36:08,240
so in summary I've had to put this slide

835
00:36:06,230 --> 00:36:11,270
in here this is a quote from their

836
00:36:08,240 --> 00:36:13,009
webpage digit Plex and each place

837
00:36:11,270 --> 00:36:14,810
AeroSystems provide the highest level of

838
00:36:13,010 --> 00:36:17,180
protection for bank's high-security

839
00:36:14,810 --> 00:36:18,710
military and government sites luxurious

840
00:36:17,180 --> 00:36:20,089
residential homes and any place for

841
00:36:18,710 --> 00:36:22,160
maximum security is essential this is

842
00:36:20,090 --> 00:36:23,630
this is text that you can get when you

843
00:36:22,160 --> 00:36:25,190
click on on the name of the panel in

844
00:36:23,630 --> 00:36:27,320
their webpage so that's the high

845
00:36:25,190 --> 00:36:29,350
security you get right low encryption

846
00:36:27,320 --> 00:36:32,540
know nothing and unlock it easily

847
00:36:29,350 --> 00:36:35,089
so what's has been done results um we

848
00:36:32,540 --> 00:36:37,310
created an f5 stack attack tool based

849
00:36:35,090 --> 00:36:38,810
based on types enter stack right for

850
00:36:37,310 --> 00:36:40,820
this paradox combos protocol

851
00:36:38,810 --> 00:36:43,070
it also supports like the keypad

852
00:36:40,820 --> 00:36:45,680
emulation it will be expanded to do more

853
00:36:43,070 --> 00:36:48,440
right now it can unlock the system from

854
00:36:45,680 --> 00:36:51,290
whichever state it's in we tested some

855
00:36:48,440 --> 00:36:53,600
RF attacks some are successful some are

856
00:36:51,290 --> 00:36:56,000
not sorry again that I couldn't demo it

857
00:36:53,600 --> 00:36:58,730
here today but I look forward to

858
00:36:56,000 --> 00:37:01,190
actually completing the other RF attacks

859
00:36:58,730 --> 00:37:05,810
as well a firmer reverse engineering is

860
00:37:01,190 --> 00:37:08,270
unlikely because of the whoa he's at

861
00:37:05,810 --> 00:37:10,340
Eric Prosser let's say so not not too

862
00:37:08,270 --> 00:37:12,890
popular in in reverse engineer community

863
00:37:10,340 --> 00:37:15,830
right now however EEPROM can be read and

864
00:37:12,890 --> 00:37:18,080
that's what I'm gonna do speaking of the

865
00:37:15,830 --> 00:37:19,460
I'm gonna do the tool over here right if

866
00:37:18,080 --> 00:37:21,589
I if I

867
00:37:19,460 --> 00:37:24,500
take it it's it's not too modular it's

868
00:37:21,589 --> 00:37:27,140
much better than those before but you

869
00:37:24,500 --> 00:37:29,569
know it's it still still could use some

870
00:37:27,140 --> 00:37:30,740
improvements so I'm gonna I'm gonna

871
00:37:29,569 --> 00:37:32,500
probably make it more modular and

872
00:37:30,740 --> 00:37:35,000
eliminate this part and put it aside

873
00:37:32,500 --> 00:37:38,000
that's one thing I'm looking forward to

874
00:37:35,000 --> 00:37:39,740
doing for the next I'm gonna try to find

875
00:37:38,000 --> 00:37:42,829
the right resistors so that it works

876
00:37:39,740 --> 00:37:45,348
100% of the time not 90% of the time and

877
00:37:42,829 --> 00:37:47,240
continue testing RF attacks and pull

878
00:37:45,349 --> 00:37:51,890
configuration including installer code

879
00:37:47,240 --> 00:37:54,618
and other codes from the EEPROM finally

880
00:37:51,890 --> 00:37:56,299
combos over radio now if anyone wants to

881
00:37:54,619 --> 00:37:58,970
sponsor me a similar kit for maggle on

882
00:37:56,300 --> 00:38:00,950
the wireless system I'd be happy to take

883
00:37:58,970 --> 00:38:03,439
it and then do a presentation on it

884
00:38:00,950 --> 00:38:05,509
because we looked at combos here I

885
00:38:03,440 --> 00:38:08,059
showed you what's inside combos and you

886
00:38:05,510 --> 00:38:09,980
saw that it's all mostly unencrypted and

887
00:38:08,059 --> 00:38:13,010
there's an attack tool for attacking

888
00:38:09,980 --> 00:38:15,980
kombis now come bus as you remember is

889
00:38:13,010 --> 00:38:18,770
the protocol that connects a keypad with

890
00:38:15,980 --> 00:38:20,720
the panel in a wireless system the

891
00:38:18,770 --> 00:38:23,809
keypad as well as all the other devices

892
00:38:20,720 --> 00:38:25,308
are connected wirelessly the question I

893
00:38:23,809 --> 00:38:27,109
have is that I don't have the answer to

894
00:38:25,309 --> 00:38:30,400
yet because I don't have the Nagaland

895
00:38:27,109 --> 00:38:32,950
system is if the protocol is the same

896
00:38:30,400 --> 00:38:36,890
have they actually taken this insecure

897
00:38:32,950 --> 00:38:38,930
protocol and made Wireless so that is

898
00:38:36,890 --> 00:38:41,089
the question that I have and that is

899
00:38:38,930 --> 00:38:44,319
something I'd really like to take a look

900
00:38:41,089 --> 00:38:50,119
at so slides will be available on my

901
00:38:44,319 --> 00:38:52,029
page today tools are available there it

902
00:38:50,119 --> 00:38:54,260
will be updated in a couple of days and

903
00:38:52,030 --> 00:38:55,700
also as I said I'm on Twitter and you

904
00:38:54,260 --> 00:38:57,589
can you can follow me for other

905
00:38:55,700 --> 00:38:58,578
conferences or refer the presentations

906
00:38:57,589 --> 00:39:01,040
over there

907
00:38:58,579 --> 00:39:02,930
Kiril sword also has a bunch of slides

908
00:39:01,040 --> 00:39:04,520
from from all over the world well aware

909
00:39:02,930 --> 00:39:06,470
are given different presentation

910
00:39:04,520 --> 00:39:10,579
different topics including some on this

911
00:39:06,470 --> 00:39:12,529
topic so I think we have just maybe time

912
00:39:10,579 --> 00:39:22,700
for one or two questions if there are

913
00:39:12,530 --> 00:39:25,400
any okay then you're welcome to come

914
00:39:22,700 --> 00:39:27,618
here I have to let the new speaker come

915
00:39:25,400 --> 00:39:29,420
set up but we have two or three minutes

916
00:39:27,619 --> 00:39:31,369
to take a look at this here if you want

917
00:39:29,420 --> 00:39:33,890
to you can come talk to me and thank you

918
00:39:31,369 --> 00:39:37,520
once again for being here

919
00:39:33,890 --> 00:39:37,520
[Applause]

