1
00:00:00,180 --> 00:00:03,399
[Music]

2
00:00:20,990 --> 00:00:29,238
[Music]

3
00:00:33,920 --> 00:00:36,920
okay

4
00:00:56,879 --> 00:00:59,839
oh

5
00:01:00,960 --> 00:01:04,000
hi everybody uh thanks for skipping

6
00:01:04,000 --> 00:01:05,438
dinner or having dinner early i'm not

7
00:01:05,438 --> 00:01:07,119
sure what you did but you stuck it

8
00:01:07,119 --> 00:01:09,840
through so um i i did offer you know if

9
00:01:09,840 --> 00:01:12,000
everybody's kind of sleepy and uh in

10
00:01:12,000 --> 00:01:14,000
sort of a food coma we could like do a

11
00:01:14,000 --> 00:01:16,159
guided meditation instead if you want or

12
00:01:16,159 --> 00:01:18,159
maybe do a little power nap it's up to

13
00:01:18,159 --> 00:01:21,680
you but um if not i'll go ahead and get

14
00:01:21,680 --> 00:01:23,680
started

15
00:01:23,680 --> 00:01:26,159
got my pointer so i'm robert wagner hi

16
00:01:26,159 --> 00:01:27,360
um

17
00:01:27,360 --> 00:01:29,520
mr minion on the twitters uh and you can

18
00:01:29,520 --> 00:01:31,280
find me on linkedin as well

19
00:01:31,280 --> 00:01:34,400
uh i um uh just did a quick introduction

20
00:01:34,400 --> 00:01:35,360
to about

21
00:01:35,360 --> 00:01:37,920
uh 50 i'm closer to 20 years of the

22
00:01:37,920 --> 00:01:40,400
infosec experience now my first job uh

23
00:01:40,400 --> 00:01:42,640
in a mosaic was as a third shift stock

24
00:01:42,640 --> 00:01:45,840
analyst uh where we were running a 24x7

25
00:01:45,840 --> 00:01:48,399
sock with only four people in one player

26
00:01:48,399 --> 00:01:51,600
um so uh things were probably not as

27
00:01:51,600 --> 00:01:52,960
difficult back then right we were

28
00:01:52,960 --> 00:01:54,960
dealing with like slammer and sasser and

29
00:01:54,960 --> 00:01:57,600
beagle and netsky but um i'm a

30
00:01:57,600 --> 00:01:59,600
co-founder of hack for kids where you

31
00:01:59,600 --> 00:02:01,119
may have seen our table over in one of

32
00:02:01,119 --> 00:02:03,520
the villages uh we're a charity that

33
00:02:03,520 --> 00:02:05,600
teaches kids about internet safety

34
00:02:05,600 --> 00:02:08,399
security and ethics we use the lure of

35
00:02:08,399 --> 00:02:10,800
hacking because hacking's cool to trick

36
00:02:10,800 --> 00:02:13,680
them into stem sort of stuff right

37
00:02:13,680 --> 00:02:14,800
amanda

38
00:02:14,800 --> 00:02:16,879
and they love it um i'm on the board of

39
00:02:16,879 --> 00:02:18,959
uh i say chicago

40
00:02:18,959 --> 00:02:21,520
i love all things dogs motorcycles and

41
00:02:21,520 --> 00:02:23,840
scuba and you can see i've even

42
00:02:23,840 --> 00:02:25,920
points married two of my lups together

43
00:02:25,920 --> 00:02:26,640
so

44
00:02:26,640 --> 00:02:28,720
that's my 50 pound dog he's no longer

45
00:02:28,720 --> 00:02:30,560
with this but he rode motorcycle for 14

46
00:02:30,560 --> 00:02:34,160
years with me and was awesome um the

47
00:02:34,160 --> 00:02:36,160
honorary wolf pup dad too those are some

48
00:02:36,160 --> 00:02:39,200
wolf pups at wolf park that i honorarily

49
00:02:39,200 --> 00:02:40,879
adopted which means i got to visit him

50
00:02:40,879 --> 00:02:43,040
once and as you can tell i had bacon in

51
00:02:43,040 --> 00:02:45,440
my pockets because they weren't all for

52
00:02:45,440 --> 00:02:47,920
me um so

53
00:02:47,920 --> 00:02:50,640
but getting on to the actual talk so

54
00:02:50,640 --> 00:02:53,680
this talk is based on a a living deck

55
00:02:53,680 --> 00:02:55,680
that was formed out of notes that i

56
00:02:55,680 --> 00:02:58,080
started taking back when i was that

57
00:02:58,080 --> 00:03:00,080
third shift sock analyst right and i

58
00:03:00,080 --> 00:03:01,920
started to run into a problem that i

59
00:03:01,920 --> 00:03:03,760
think everybody starts to run in which

60
00:03:03,760 --> 00:03:06,959
was there was never enough budget to buy

61
00:03:06,959 --> 00:03:08,560
the things we needed right it was like

62
00:03:08,560 --> 00:03:10,480
boss there's a new problem and we need a

63
00:03:10,480 --> 00:03:12,239
new person or a new tool or something

64
00:03:12,239 --> 00:03:14,480
like that to cover it and boss would say

65
00:03:14,480 --> 00:03:15,519
yeah

66
00:03:15,519 --> 00:03:17,440
it's you know first month into the

67
00:03:17,440 --> 00:03:18,879
fiscal year and we've already spent all

68
00:03:18,879 --> 00:03:20,959
the budget so you're gonna have to wait

69
00:03:20,959 --> 00:03:23,280
until next year comes around

70
00:03:23,280 --> 00:03:24,959
make do with what you can

71
00:03:24,959 --> 00:03:26,799
and that happens everywhere right we

72
00:03:26,799 --> 00:03:29,440
need free easy ways to fill our gaps

73
00:03:29,440 --> 00:03:30,879
unless you're lucky enough to have like

74
00:03:30,879 --> 00:03:32,879
a really great breach right i mean

75
00:03:32,879 --> 00:03:34,640
who what's a company here in milwaukee

76
00:03:34,640 --> 00:03:36,000
that uh had a

77
00:03:36,000 --> 00:03:37,920
huge breach and they got a blank check

78
00:03:37,920 --> 00:03:39,360
after that to get all the security they

79
00:03:39,360 --> 00:03:41,840
want yeah it's nobody nobody gets a

80
00:03:41,840 --> 00:03:44,319
white check to do everything they want

81
00:03:44,319 --> 00:03:45,680
um so

82
00:03:45,680 --> 00:03:48,159
so as i was going hacker cons and uh and

83
00:03:48,159 --> 00:03:49,599
i would be listening to talking someone

84
00:03:49,599 --> 00:03:51,760
saying and if they had just done this

85
00:03:51,760 --> 00:03:53,439
well i was like well i'm writing that

86
00:03:53,439 --> 00:03:56,239
down um so this is a collection of all

87
00:03:56,239 --> 00:03:57,760
those things that you know some of them

88
00:03:57,760 --> 00:03:59,120
are common sense some of them if you're

89
00:03:59,120 --> 00:04:01,200
new to infosec or if you weren't at that

90
00:04:01,200 --> 00:04:02,000
talk

91
00:04:02,000 --> 00:04:04,000
maybe uh maybe it's a little jump for

92
00:04:04,000 --> 00:04:06,879
you to take home um but uh but first

93
00:04:06,879 --> 00:04:08,799
thing that i noticed as i was talking

94
00:04:08,799 --> 00:04:10,400
with my various peers in their

95
00:04:10,400 --> 00:04:12,319
organizations was that the most

96
00:04:12,319 --> 00:04:14,560
successful teams always started by

97
00:04:14,560 --> 00:04:16,720
focusing on the most important tool

98
00:04:16,720 --> 00:04:18,320
security tool in the in their

99
00:04:18,320 --> 00:04:20,720
organization first um it's the best

100
00:04:20,720 --> 00:04:22,400
place to start it's the tool everybody

101
00:04:22,400 --> 00:04:24,320
has in their organization what's that

102
00:04:24,320 --> 00:04:25,360
tool

103
00:04:25,360 --> 00:04:27,680
yeah it's you not to call you guys tools

104
00:04:27,680 --> 00:04:30,000
that's not my intent um but

105
00:04:30,000 --> 00:04:32,479
uh i noticed that teams that worked

106
00:04:32,479 --> 00:04:34,880
together to teach each other stuff um

107
00:04:34,880 --> 00:04:36,960
that had bosses that let them go to

108
00:04:36,960 --> 00:04:38,960
hacker conferences and stuff like that

109
00:04:38,960 --> 00:04:42,000
did way more than the than the the tool

110
00:04:42,000 --> 00:04:44,800
heavy shops right i saw a team of five

111
00:04:44,800 --> 00:04:48,160
out security a team of 25 because the 25

112
00:04:48,160 --> 00:04:50,240
had you know just like push button tools

113
00:04:50,240 --> 00:04:51,680
and that's all they know how to do where

114
00:04:51,680 --> 00:04:53,759
the other guys were teaching uh men and

115
00:04:53,759 --> 00:04:55,360
women were teaching each other how to

116
00:04:55,360 --> 00:04:58,479
script and how to write um like their

117
00:04:58,479 --> 00:05:01,360
own root kit for point of sales devices

118
00:05:01,360 --> 00:05:03,199
and all sorts of stuff like that and

119
00:05:03,199 --> 00:05:06,479
that team was fantastic so um

120
00:05:06,479 --> 00:05:09,520
and when we talked about uh yeah who

121
00:05:09,520 --> 00:05:11,759
here hates this venn diagram i hate this

122
00:05:11,759 --> 00:05:13,360
venn diagram because like every sales

123
00:05:13,360 --> 00:05:15,280
person in the world uses it but i also

124
00:05:15,280 --> 00:05:17,280
hate it because it never looks like this

125
00:05:17,280 --> 00:05:19,919
we never have this beautiful balance of

126
00:05:19,919 --> 00:05:21,759
people process and technology and we

127
00:05:21,759 --> 00:05:22,720
give

128
00:05:22,720 --> 00:05:24,560
equal amounts of tension attention and

129
00:05:24,560 --> 00:05:26,320
dollars to all of them now

130
00:05:26,320 --> 00:05:28,800
instead we tend to do what we focus on

131
00:05:28,800 --> 00:05:30,880
technology and what does that do to your

132
00:05:30,880 --> 00:05:32,960
infosec program makes it look like this

133
00:05:32,960 --> 00:05:35,759
and nobody wants this is a description

134
00:05:35,759 --> 00:05:38,320
for the rhythmosac program right so how

135
00:05:38,320 --> 00:05:41,280
can we avoid that

136
00:05:42,080 --> 00:05:44,240
so how do we avoid that and again how do

137
00:05:44,240 --> 00:05:45,919
we avoid that when when our boss has

138
00:05:45,919 --> 00:05:47,039
been telling us yeah there's no more

139
00:05:47,039 --> 00:05:49,039
budget left for this year so let's start

140
00:05:49,039 --> 00:05:50,479
with the people

141
00:05:50,479 --> 00:05:52,880
um some group so

142
00:05:52,880 --> 00:05:54,880
i know everybody here probably knows

143
00:05:54,880 --> 00:05:56,720
about us people that may be watching

144
00:05:56,720 --> 00:05:59,600
this later especially managers pay

145
00:05:59,600 --> 00:06:02,160
attention because there is so many free

146
00:06:02,160 --> 00:06:04,240
and cheap resources to level up your

147
00:06:04,240 --> 00:06:07,360
people right um a quick thanks to many

148
00:06:07,360 --> 00:06:09,520
of the people that uh that i got this

149
00:06:09,520 --> 00:06:11,919
information from their every major

150
00:06:11,919 --> 00:06:14,800
conference has their talks out on

151
00:06:14,800 --> 00:06:17,280
typically youtube these days um hacker

152
00:06:17,280 --> 00:06:20,479
cons like b-sides are cheap i when we

153
00:06:20,479 --> 00:06:22,800
were trying to get trained up um i mean

154
00:06:22,800 --> 00:06:25,280
i love sans sans classes are freaking

155
00:06:25,280 --> 00:06:27,919
great right but back then they were like

156
00:06:27,919 --> 00:06:29,280
four or five thousand dollars and

157
00:06:29,280 --> 00:06:31,280
they're more expensive now so the boss

158
00:06:31,280 --> 00:06:33,360
would be like well three of you get to

159
00:06:33,360 --> 00:06:35,440
go this year and three of you right and

160
00:06:35,440 --> 00:06:38,000
we all had to take turns um so but at

161
00:06:38,000 --> 00:06:40,160
the same time i learned so much from

162
00:06:40,160 --> 00:06:42,240
events like this so if you're a manager

163
00:06:42,240 --> 00:06:44,800
and you're not letting your whole team

164
00:06:44,800 --> 00:06:47,360
seriously go to an event like this where

165
00:06:47,360 --> 00:06:48,400
it's like

166
00:06:48,400 --> 00:06:50,319
a hundred bucks or so

167
00:06:50,319 --> 00:06:51,759
for some of them but for the b-sides

168
00:06:51,759 --> 00:06:54,080
even cheaper like 20 or free you are

169
00:06:54,080 --> 00:06:56,160
pissing your nobody minds swear words

170
00:06:56,160 --> 00:06:58,240
here right it's okay yeah okay if you

171
00:06:58,240 --> 00:07:00,080
hate sword words say no don't say

172
00:07:00,080 --> 00:07:03,520
anything no i'm sorry

173
00:07:03,520 --> 00:07:05,520
but really you're you're you need to be

174
00:07:05,520 --> 00:07:08,160
encouraging your teams to go to events

175
00:07:08,160 --> 00:07:09,759
like this and giving them the time to do

176
00:07:09,759 --> 00:07:11,840
it i i knew one company it was big

177
00:07:11,840 --> 00:07:16,520
financial um they their cso would let

178
00:07:16,520 --> 00:07:19,520
180 people take the day off to do an

179
00:07:19,520 --> 00:07:22,720
internal ctf once every year freaking

180
00:07:22,720 --> 00:07:25,120
amazing i mean other people

181
00:07:25,120 --> 00:07:26,639
new to the industry they're just trying

182
00:07:26,639 --> 00:07:28,240
to get really good at their job and

183
00:07:28,240 --> 00:07:29,440
they're like hey why didn't you come to

184
00:07:29,440 --> 00:07:30,720
the meet up or whatever and they're like

185
00:07:30,720 --> 00:07:32,160
oh yeah my boss wouldn't give me like

186
00:07:32,160 --> 00:07:33,919
the three hours in the afternoon off to

187
00:07:33,919 --> 00:07:36,479
go to issa or one of the other meetups

188
00:07:36,479 --> 00:07:38,240
that's ridiculous and that's how you

189
00:07:38,240 --> 00:07:40,960
burn people out so don't do that um lots

190
00:07:40,960 --> 00:07:43,120
of great people here to learn from a

191
00:07:43,120 --> 00:07:45,199
quick list of just some of the people

192
00:07:45,199 --> 00:07:47,360
that that have been really

193
00:07:47,360 --> 00:07:50,240
uh great resources of information for me

194
00:07:50,240 --> 00:07:52,080
hacks for pancakes and i know you all

195
00:07:52,080 --> 00:07:54,639
know but she just puts out so much

196
00:07:54,639 --> 00:07:56,639
information out there for free to help

197
00:07:56,639 --> 00:07:58,879
people out as does everybody else i

198
00:07:58,879 --> 00:08:01,199
started getting into some api security

199
00:08:01,199 --> 00:08:03,039
and i found a couple of api resources

200
00:08:03,039 --> 00:08:04,800
recently as well so check those people

201
00:08:04,800 --> 00:08:07,280
out and jesus mig douglas puts out these

202
00:08:07,280 --> 00:08:09,520
like amazing twitter threads of like

203
00:08:09,520 --> 00:08:12,720
just awesome common sense security stuff

204
00:08:12,720 --> 00:08:14,720
so uh so read his threads if you get a

205
00:08:14,720 --> 00:08:15,599
chance

206
00:08:15,599 --> 00:08:18,960
um but how do we know so that's us like

207
00:08:18,960 --> 00:08:20,960
our you know our teams how do we level

208
00:08:20,960 --> 00:08:22,960
up our users right we fight for the

209
00:08:22,960 --> 00:08:24,560
users um

210
00:08:24,560 --> 00:08:26,479
one of the best ways i've ever seen was

211
00:08:26,479 --> 00:08:29,599
a presentation by ben 10 ben 0xa

212
00:08:29,599 --> 00:08:33,440
and he did this at derbycon like 2012

213
00:08:33,440 --> 00:08:35,440
2014 somewhere around there but the idea

214
00:08:35,440 --> 00:08:38,640
was genius instead of forcing people to

215
00:08:38,640 --> 00:08:40,958
watch those freaking security videos

216
00:08:40,958 --> 00:08:43,200
that you'd rather rub glass in your eyes

217
00:08:43,200 --> 00:08:44,880
than actually pay attention to he

218
00:08:44,880 --> 00:08:48,160
decided to gamify security awareness so

219
00:08:48,160 --> 00:08:50,000
he just it was simple he just made a

220
00:08:50,000 --> 00:08:52,320
quick announcement to his uh his

221
00:08:52,320 --> 00:08:54,000
organization he was a ciso there and he

222
00:08:54,000 --> 00:08:55,680
said hey you know we're gonna have a

223
00:08:55,680 --> 00:08:57,519
security contest you're gonna start

224
00:08:57,519 --> 00:08:59,279
seeing some of those things that maybe

225
00:08:59,279 --> 00:09:00,320
you would have learned about if you

226
00:09:00,320 --> 00:09:02,800
would actually watch the video uh and

227
00:09:02,800 --> 00:09:05,200
every person that reports any particular

228
00:09:05,200 --> 00:09:06,800
thing the first person report this

229
00:09:06,800 --> 00:09:08,399
particular incident or whatever

230
00:09:08,399 --> 00:09:10,000
gets maybe i don't know five dollar gift

231
00:09:10,000 --> 00:09:11,839
certificate to dunkin donuts he's going

232
00:09:11,839 --> 00:09:14,160
to keep score at the end of the week 200

233
00:09:14,160 --> 00:09:16,160
bucks to the person who did the best

234
00:09:16,160 --> 00:09:17,120
right

235
00:09:17,120 --> 00:09:19,760
by midweek people were trashed up you're

236
00:09:19,760 --> 00:09:22,240
going down i'm totally gonna get more

237
00:09:22,240 --> 00:09:23,839
points than you they start reporting

238
00:09:23,839 --> 00:09:25,440
like the cfo for not wearing their

239
00:09:25,440 --> 00:09:27,279
badges they're walking through the uh

240
00:09:27,279 --> 00:09:29,600
the organization um somebody called

241
00:09:29,600 --> 00:09:31,680
really quickly to report this strange

242
00:09:31,680 --> 00:09:33,680
black box that was just outside one of

243
00:09:33,680 --> 00:09:35,519
the side doors yeah it was a rodent

244
00:09:35,519 --> 00:09:37,519
control box but still

245
00:09:37,519 --> 00:09:39,200
people were paying attention in the best

246
00:09:39,200 --> 00:09:42,240
one 15 minutes after he starts he gets a

247
00:09:42,240 --> 00:09:43,600
call from a woman who's very excited

248
00:09:43,600 --> 00:09:45,279
she's like ben ben i found one of those

249
00:09:45,279 --> 00:09:46,800
things and he's like

250
00:09:46,800 --> 00:09:48,320
what things she's like the things that

251
00:09:48,320 --> 00:09:50,399
you said with the security and the stuff

252
00:09:50,399 --> 00:09:51,600
and he's like

253
00:09:51,600 --> 00:09:54,160
we haven't started yet

254
00:09:54,160 --> 00:09:55,760
what are you seeing she's like oh this

255
00:09:55,760 --> 00:09:57,440
thing pops up on my computer every once

256
00:09:57,440 --> 00:09:58,480
in a while and says you know click here

257
00:09:58,480 --> 00:10:00,080
to authorize i don't know what it is but

258
00:10:00,080 --> 00:10:01,519
it's something like that just click here

259
00:10:01,519 --> 00:10:04,320
to say okay yeah 15 minutes in he had a

260
00:10:04,320 --> 00:10:06,240
real security incident he had turned his

261
00:10:06,240 --> 00:10:07,680
people into carbon-based intrusion

262
00:10:07,680 --> 00:10:10,720
detection sensors and it was beautiful

263
00:10:10,720 --> 00:10:12,560
word of warning i did talk to a company

264
00:10:12,560 --> 00:10:14,160
that actually tried this as well they

265
00:10:14,160 --> 00:10:16,320
had a few users that were a little over

266
00:10:16,320 --> 00:10:18,079
ambitious they started downloading

267
00:10:18,079 --> 00:10:19,839
nessus and scanning for vulnerabilities

268
00:10:19,839 --> 00:10:21,600
to really like yeah

269
00:10:21,600 --> 00:10:22,640
and if your

270
00:10:22,640 --> 00:10:24,800
users can do that you also have a bigger

271
00:10:24,800 --> 00:10:26,160
problem right they shouldn't be

272
00:10:26,160 --> 00:10:28,000
downloading necessary caps onto the

273
00:10:28,000 --> 00:10:30,800
computers but i love the ambition right

274
00:10:30,800 --> 00:10:33,680
so leverage it um

275
00:10:33,680 --> 00:10:36,160
so uh okay uh so that's some people how

276
00:10:36,160 --> 00:10:38,000
about process let's talk about process

277
00:10:38,000 --> 00:10:39,680
um i

278
00:10:39,680 --> 00:10:41,360
stumbled across this um there's a

279
00:10:41,360 --> 00:10:42,560
presentation

280
00:10:42,560 --> 00:10:44,160
about so we

281
00:10:44,160 --> 00:10:46,800
using chaos engineering and security so

282
00:10:46,800 --> 00:10:49,040
chaos security engineering and it's

283
00:10:49,040 --> 00:10:50,480
brilliant so most of you heard of gas

284
00:10:50,480 --> 00:10:52,399
engineering right netflix has been doing

285
00:10:52,399 --> 00:10:54,079
a ton of stuff with it they've got chaos

286
00:10:54,079 --> 00:10:56,560
monkey and the idea in chaos engineering

287
00:10:56,560 --> 00:10:57,200
is

288
00:10:57,200 --> 00:10:59,279
randomly break and make sure the

289
00:10:59,279 --> 00:11:01,760
company still stays operational and the

290
00:11:01,760 --> 00:11:03,279
fact that netflix is like yeah you can

291
00:11:03,279 --> 00:11:04,720
do that you can totally do that you can

292
00:11:04,720 --> 00:11:06,399
bring anything you want on purpose and

293
00:11:06,399 --> 00:11:09,040
we better stay up and running brilliant

294
00:11:09,040 --> 00:11:11,440
so how do we apply this to security so

295
00:11:11,440 --> 00:11:15,680
uh so the ieee and uh uh kennedy takura

296
00:11:15,680 --> 00:11:19,200
um published an entire uh white paper

297
00:11:19,200 --> 00:11:22,959
about this um called cloud strike um he

298
00:11:22,959 --> 00:11:25,120
presented on it besides berlin i was not

299
00:11:25,120 --> 00:11:26,079
there for that one but that would have

300
00:11:26,079 --> 00:11:28,320
been cool but in any event um he

301
00:11:28,320 --> 00:11:29,760
presented a whole idea and how do we

302
00:11:29,760 --> 00:11:32,240
apply that same kind of chaos to infosec

303
00:11:32,240 --> 00:11:35,440
um so the the concept simple instead of

304
00:11:35,440 --> 00:11:38,800
breaking stuff we're gonna inject flaws

305
00:11:38,800 --> 00:11:41,040
into our process and into our

306
00:11:41,040 --> 00:11:43,200
infrastructure and stuff so you create

307
00:11:43,200 --> 00:11:46,399
user bob and then maybe you um

308
00:11:46,399 --> 00:11:49,120
accidentally apply a policy to him that

309
00:11:49,120 --> 00:11:51,279
he shouldn't have giving him more access

310
00:11:51,279 --> 00:11:53,279
right and then you see how far you can

311
00:11:53,279 --> 00:11:54,880
get into the organization if that

312
00:11:54,880 --> 00:11:56,639
mistake happens because of course that

313
00:11:56,639 --> 00:11:58,720
mistake would never really happen right

314
00:11:58,720 --> 00:12:02,000
we wouldn't really apply a bad policy to

315
00:12:02,000 --> 00:12:04,720
someone um and it's a great idea and the

316
00:12:04,720 --> 00:12:06,399
framework that they created has a whole

317
00:12:06,399 --> 00:12:08,800
scoring system um they've created uh

318
00:12:08,800 --> 00:12:11,279
much like minor has categories for all

319
00:12:11,279 --> 00:12:12,560
the different kind of things that you

320
00:12:12,560 --> 00:12:15,680
can inject as flaws into your security

321
00:12:15,680 --> 00:12:17,440
and then see how bad it can get and if

322
00:12:17,440 --> 00:12:18,880
you've got a red team

323
00:12:18,880 --> 00:12:20,399
leverage them tell you know tell them

324
00:12:20,399 --> 00:12:22,079
we're going to start making bad things

325
00:12:22,079 --> 00:12:24,240
happen in whatever environment and then

326
00:12:24,240 --> 00:12:25,680
you know see if you can see if you can

327
00:12:25,680 --> 00:12:29,120
find them and get in it's great

328
00:12:29,120 --> 00:12:33,279
so passwords why why our passwords still

329
00:12:33,279 --> 00:12:35,200
really the bane of our existence

330
00:12:35,200 --> 00:12:36,560
hopefully you saw some of the wolf's

331
00:12:36,560 --> 00:12:39,120
stuff over uh in in the tracks just

332
00:12:39,120 --> 00:12:41,200
before this but not only does one simply

333
00:12:41,200 --> 00:12:43,120
not use the same um

334
00:12:43,120 --> 00:12:46,079
password for banking and twitter but how

335
00:12:46,079 --> 00:12:47,839
many of you think you've got like domain

336
00:12:47,839 --> 00:12:50,160
admins that are like oh i i have to

337
00:12:50,160 --> 00:12:53,200
make a really strong password for my

338
00:12:53,200 --> 00:12:54,880
banking account or home depot or

339
00:12:54,880 --> 00:12:57,519
whatever um and i've already memorized

340
00:12:57,519 --> 00:12:58,240
this

341
00:12:58,240 --> 00:13:00,959
random character 18 character random

342
00:13:00,959 --> 00:13:03,120
password for domain admin because i want

343
00:13:03,120 --> 00:13:05,279
it to be really strong and then they

344
00:13:05,279 --> 00:13:06,959
need another one so they go and use it

345
00:13:06,959 --> 00:13:09,279
out on the internet yeah um and then i

346
00:13:09,279 --> 00:13:11,120
was uh i'm not a domain admin i was a

347
00:13:11,120 --> 00:13:12,639
server admin and i certainly did that

348
00:13:12,639 --> 00:13:14,079
 right it took me a long time to

349
00:13:14,079 --> 00:13:18,079
memorize 18 random characters so um so

350
00:13:18,079 --> 00:13:20,079
uh obviously the real answer for this

351
00:13:20,079 --> 00:13:22,240
right now is is mfa right now and maybe

352
00:13:22,240 --> 00:13:23,839
like what was saying maybe some

353
00:13:23,839 --> 00:13:27,440
passwordless authentication but

354
00:13:27,440 --> 00:13:30,079
why in god's name did it take over 20

355
00:13:30,079 --> 00:13:32,560
years for a cartoon to teach us that

356
00:13:32,560 --> 00:13:34,720
this is wrong right this whole leap

357
00:13:34,720 --> 00:13:37,360
speak kind of thing um this cartoon at

358
00:13:37,360 --> 00:13:39,120
this point who's seen the sex actually

359
00:13:39,120 --> 00:13:42,000
yeah right we love it but it choke out

360
00:13:42,000 --> 00:13:44,160
cartoon to teach our bosses it and we're

361
00:13:44,160 --> 00:13:45,199
still

362
00:13:45,199 --> 00:13:46,800
they still won't change in many

363
00:13:46,800 --> 00:13:48,639
organizations their their typical

364
00:13:48,639 --> 00:13:51,839
password policy from 20 years ago so 20

365
00:13:51,839 --> 00:13:53,760
20 years ago

366
00:13:53,760 --> 00:13:55,519
eight years ago when this was when this

367
00:13:55,519 --> 00:13:58,880
came out um what it took about uh three

368
00:13:58,880 --> 00:14:00,639
days to guess that troubadour elite

369
00:14:00,639 --> 00:14:02,880
speak

370
00:14:03,199 --> 00:14:05,040
these days especially if you've got the

371
00:14:05,040 --> 00:14:07,760
hash we're talking like milliseconds on

372
00:14:07,760 --> 00:14:09,120
some of this stuff right it's just

373
00:14:09,120 --> 00:14:12,320
terrible so i i have suggested in scene

374
00:14:12,320 --> 00:14:14,240
organizations go you know what

375
00:14:14,240 --> 00:14:17,360
if you just do a pass phrase and if you

376
00:14:17,360 --> 00:14:19,120
when i'm suggesting it to just like home

377
00:14:19,120 --> 00:14:21,920
users i'm like go and find

378
00:14:21,920 --> 00:14:23,920
uh your take your favorite song go three

379
00:14:23,920 --> 00:14:26,560
lines down go maybe a couple of words in

380
00:14:26,560 --> 00:14:28,160
and the next five words that's your

381
00:14:28,160 --> 00:14:30,160
passphrase you'll never forget it right

382
00:14:30,160 --> 00:14:32,320
um and organizations are saying if you

383
00:14:32,320 --> 00:14:33,839
do that if you've got a passphrase it's

384
00:14:33,839 --> 00:14:35,920
like 24 characters long you don't gotta

385
00:14:35,920 --> 00:14:38,079
change it for the next year right

386
00:14:38,079 --> 00:14:40,240
absolutely fantastic now

387
00:14:40,240 --> 00:14:42,320
of course we don't want them to use them

388
00:14:42,320 --> 00:14:44,480
on all sorts of different machines right

389
00:14:44,480 --> 00:14:46,880
but that's so much better than you have

390
00:14:46,880 --> 00:14:49,519
to change your password every 30 days

391
00:14:49,519 --> 00:14:52,560
and yeah it's it's a mess now

392
00:14:52,560 --> 00:14:54,880
keepass is free um

393
00:14:54,880 --> 00:14:56,959
password vaults are a good stopgap

394
00:14:56,959 --> 00:14:59,199
measure until we can get multi-factors

395
00:14:59,199 --> 00:15:01,120
not free right unfortunately there's off

396
00:15:01,120 --> 00:15:02,959
the out there i've seen people use it

397
00:15:02,959 --> 00:15:05,519
for personal use i've never seen authy

398
00:15:05,519 --> 00:15:08,240
deployed at scale so has anybody seen me

399
00:15:08,240 --> 00:15:09,760
out i'm not right

400
00:15:09,760 --> 00:15:11,440
it's a good tool but i've never seen it

401
00:15:11,440 --> 00:15:13,360
used in an enterprise so

402
00:15:13,360 --> 00:15:15,440
my red team friends and i will argue

403
00:15:15,440 --> 00:15:17,360
about this because they're like yeah but

404
00:15:17,360 --> 00:15:19,839
if i fish my way onto their laptop and

405
00:15:19,839 --> 00:15:21,440
keep asses there i've got all their

406
00:15:21,440 --> 00:15:24,160
passwords i'm like yeah and if i sneak

407
00:15:24,160 --> 00:15:25,519
in with the smokers through the back

408
00:15:25,519 --> 00:15:27,440
door and they have one password for

409
00:15:27,440 --> 00:15:29,440
everything and it's on a sticky note i

410
00:15:29,440 --> 00:15:31,680
still have all the passwords so i think

411
00:15:31,680 --> 00:15:33,600
and most people i've talked to agree

412
00:15:33,600 --> 00:15:35,360
getting a password vault at least is a

413
00:15:35,360 --> 00:15:38,240
free stopgap measure for this

414
00:15:38,240 --> 00:15:39,680
i wish there were easier ones like i

415
00:15:39,680 --> 00:15:41,279
wish there was a password ball i could

416
00:15:41,279 --> 00:15:43,120
give my grandma and it would just like

417
00:15:43,120 --> 00:15:45,040
work everywhere right but

418
00:15:45,040 --> 00:15:47,120
there's a bit of a learning curve

419
00:15:47,120 --> 00:15:48,639
um so

420
00:15:48,639 --> 00:15:50,560
people process great now let's talk a

421
00:15:50,560 --> 00:15:53,519
little bit about technology so

422
00:15:53,519 --> 00:15:54,720
who here

423
00:15:54,720 --> 00:15:58,639
has java 6 running somewhere

424
00:15:58,639 --> 00:16:01,040
in their organization yeah thank you for

425
00:16:01,040 --> 00:16:02,399
being honest those of you that didn't

426
00:16:02,399 --> 00:16:03,920
raise your hands if you're working at

427
00:16:03,920 --> 00:16:06,000
any organization of size you're either

428
00:16:06,000 --> 00:16:09,839
lying to me or even worse you don't know

429
00:16:09,839 --> 00:16:12,639
because i guarantee you if you have

430
00:16:12,639 --> 00:16:14,639
if you live work in a large company

431
00:16:14,639 --> 00:16:16,800
there it's there somewhere and it's the

432
00:16:16,800 --> 00:16:18,560
thing that makes the company all their

433
00:16:18,560 --> 00:16:20,720
money it runs in the back

434
00:16:20,720 --> 00:16:22,639
it's what i'll create what makes all the

435
00:16:22,639 --> 00:16:24,480
money for the organization uh the

436
00:16:24,480 --> 00:16:27,120
developer died 10 years ago no one knows

437
00:16:27,120 --> 00:16:28,480
how to fix it

438
00:16:28,480 --> 00:16:31,040
and that's a problem so

439
00:16:31,040 --> 00:16:33,360
um until we can get someone to fix it

440
00:16:33,360 --> 00:16:34,959
what can we do because we've got now

441
00:16:34,959 --> 00:16:36,320
we've got this old java you have to have

442
00:16:36,320 --> 00:16:38,320
these old java agents or versions of

443
00:16:38,320 --> 00:16:40,240
java to connect to it where it doesn't

444
00:16:40,240 --> 00:16:42,240
work and that's where a problem happens

445
00:16:42,240 --> 00:16:43,759
right it's when that java connects to

446
00:16:43,759 --> 00:16:46,560
the internet because then your own so a

447
00:16:46,560 --> 00:16:47,920
lot of people don't know this but every

448
00:16:47,920 --> 00:16:50,800
one of those java installs uh the

449
00:16:50,800 --> 00:16:52,000
client side

450
00:16:52,000 --> 00:16:54,959
has a user agent string and you can

451
00:16:54,959 --> 00:16:57,040
block that user agent string at the

452
00:16:57,040 --> 00:16:58,720
proxy so

453
00:16:58,720 --> 00:17:00,880
it's not a perfect solution obviously my

454
00:17:00,880 --> 00:17:02,959
laptop goes off the network you're gonna

455
00:17:02,959 --> 00:17:04,880
have to put a gpo out there that says

456
00:17:04,880 --> 00:17:07,119
when off the network java doesn't run at

457
00:17:07,119 --> 00:17:08,720
all um

458
00:17:08,720 --> 00:17:10,319
either that or backhaul everybody

459
00:17:10,319 --> 00:17:12,480
through the vpn but you know

460
00:17:12,480 --> 00:17:13,919
if you really want the network people to

461
00:17:13,919 --> 00:17:16,959
hate you you could do that

462
00:17:16,959 --> 00:17:18,559
so you really don't need java going

463
00:17:18,559 --> 00:17:21,119
outside the organization um

464
00:17:21,119 --> 00:17:23,039
either get a dev to fix that code

465
00:17:23,039 --> 00:17:24,720
eventually or

466
00:17:24,720 --> 00:17:26,480
yeah just you know

467
00:17:26,480 --> 00:17:29,840
anyway um okay good uh so this is from

468
00:17:29,840 --> 00:17:31,520
bluetumor.blogspot.com

469
00:17:31,520 --> 00:17:32,400
this is

470
00:17:32,400 --> 00:17:35,760
every uh executable extension that you

471
00:17:35,760 --> 00:17:38,160
should be blocking at your email gateway

472
00:17:38,160 --> 00:17:40,799
and i don't mean some of them

473
00:17:40,799 --> 00:17:43,679
be like nike and just freaking do it now

474
00:17:43,679 --> 00:17:44,640
i know what you're going to say you can

475
00:17:44,640 --> 00:17:46,960
sing with robert roberts i've got some

476
00:17:46,960 --> 00:17:49,520
people that might need a mas file what

477
00:17:49,520 --> 00:17:52,720
would it do and to that i say if apple

478
00:17:52,720 --> 00:17:54,480
can tell us we can do without a freaking

479
00:17:54,480 --> 00:17:56,160
headset jacket we're just going to like

480
00:17:56,160 --> 00:17:56,880
it

481
00:17:56,880 --> 00:17:58,400
then we can

482
00:17:58,400 --> 00:18:00,960
now the key here is a really nimble

483
00:18:00,960 --> 00:18:02,960
exception policy right there will be a

484
00:18:02,960 --> 00:18:04,480
few people that can get it and you'll

485
00:18:04,480 --> 00:18:06,480
put them a little domain group and those

486
00:18:06,480 --> 00:18:08,320
people get permissions for that file and

487
00:18:08,320 --> 00:18:10,080
that's freaking it that's those are the

488
00:18:10,080 --> 00:18:12,240
only people that get it i once uh once

489
00:18:12,240 --> 00:18:15,360
had uh up appear that for his hr people

490
00:18:15,360 --> 00:18:17,679
who had to open up pdfs all the time he

491
00:18:17,679 --> 00:18:19,440
gave them all ipads he's like you can

492
00:18:19,440 --> 00:18:22,720
read pdfs on an ipad and that's it

493
00:18:22,720 --> 00:18:24,160
maybe a chromebook might work for that

494
00:18:24,160 --> 00:18:26,000
as well these days but

495
00:18:26,000 --> 00:18:28,240
but there are ways to limit the exposure

496
00:18:28,240 --> 00:18:29,919
you don't have to give everybody the

497
00:18:29,919 --> 00:18:32,320
access to this um and trust me the

498
00:18:32,320 --> 00:18:34,960
moment you put that block list in place

499
00:18:34,960 --> 00:18:36,960
you'll know who actually needs it right

500
00:18:36,960 --> 00:18:38,080
it'll be whack-a-mole it'll start

501
00:18:38,080 --> 00:18:39,440
popping up and you bang them down it'll

502
00:18:39,440 --> 00:18:40,640
be great

503
00:18:40,640 --> 00:18:42,960
so antivirus

504
00:18:42,960 --> 00:18:44,000
um

505
00:18:44,000 --> 00:18:44,880
yeah

506
00:18:44,880 --> 00:18:47,679
um just about as helpful as uh yeah

507
00:18:47,679 --> 00:18:50,960
right um so it it's not completely

508
00:18:50,960 --> 00:18:52,720
useless slow uh enterprise doesn't do a

509
00:18:52,720 --> 00:18:54,240
whole lot for us at this point but it's

510
00:18:54,240 --> 00:18:56,559
not completely useless one nice thing is

511
00:18:56,559 --> 00:18:59,120
every major av vendor out there will

512
00:18:59,120 --> 00:19:01,919
allow you to put in your own iocs so if

513
00:19:01,919 --> 00:19:03,679
you you know if you're back here and

514
00:19:03,679 --> 00:19:05,840
you're dropping these in you

515
00:19:05,840 --> 00:19:07,679
the best threat feed is your the one you

516
00:19:07,679 --> 00:19:09,280
make yourself right so if you're

517
00:19:09,280 --> 00:19:11,679
dropping these into like um cuckoo or

518
00:19:11,679 --> 00:19:13,039
something like that you're extracting

519
00:19:13,039 --> 00:19:15,039
your own ifcs even if you don't have

520
00:19:15,039 --> 00:19:17,679
like a reverse engineer this is a good

521
00:19:17,679 --> 00:19:19,200
start you know so you pull out your

522
00:19:19,200 --> 00:19:22,640
ifc's you drop those into your antivirus

523
00:19:22,640 --> 00:19:23,840
and then you start looking to see if

524
00:19:23,840 --> 00:19:25,919
those ifcs are out there now you could

525
00:19:25,919 --> 00:19:28,400
do this with your phone scanner too

526
00:19:28,400 --> 00:19:30,240
provided that you're authenticating to

527
00:19:30,240 --> 00:19:32,000
every device out there

528
00:19:32,000 --> 00:19:33,919
that's traditionally been really hard

529
00:19:33,919 --> 00:19:36,160
for a lot of companies i don't know any

530
00:19:36,160 --> 00:19:38,000
any company that successfully has just

531
00:19:38,000 --> 00:19:39,919
gotten in everywhere i see some gummies

532
00:19:39,919 --> 00:19:41,679
that get most of it and that's great but

533
00:19:41,679 --> 00:19:43,919
indeed just by policy has to be

534
00:19:43,919 --> 00:19:46,320
everywhere right so leverage that

535
00:19:46,320 --> 00:19:47,520
um

536
00:19:47,520 --> 00:19:50,080
heuristics it was the first attempt to

537
00:19:50,080 --> 00:19:52,559
do things without a signature right um

538
00:19:52,559 --> 00:19:54,880
it's often a lot of places and i suspect

539
00:19:54,880 --> 00:19:57,039
because it can be really freaking noisy

540
00:19:57,039 --> 00:19:58,480
and the id people didn't want to have to

541
00:19:58,480 --> 00:20:01,039
tweak that so they just turned it off um

542
00:20:01,039 --> 00:20:03,120
but it can still find some low-hanging

543
00:20:03,120 --> 00:20:05,039
fruit last but not least is anybody

544
00:20:05,039 --> 00:20:06,480
actually checking

545
00:20:06,480 --> 00:20:08,559
the av alerts so many of my red team

546
00:20:08,559 --> 00:20:10,640
friends have like stumped through like a

547
00:20:10,640 --> 00:20:12,960
trans arts rex just banging on left

548
00:20:12,960 --> 00:20:15,039
and right nobody's checking the alerts

549
00:20:15,039 --> 00:20:16,000
so

550
00:20:16,000 --> 00:20:19,760
yeah nobody sees it um

551
00:20:26,000 --> 00:20:28,720
um it can be really hard to deploy like

552
00:20:28,720 --> 00:20:31,280
it'll break everything in your freaking

553
00:20:31,280 --> 00:20:34,480
organization if you're not careful um

554
00:20:34,480 --> 00:20:35,840
it's designed to protect the memory of

555
00:20:35,840 --> 00:20:38,320
our apps there are bypasses for it like

556
00:20:38,320 --> 00:20:41,280
rock chains and stuff and yes it was end

557
00:20:41,280 --> 00:20:44,559
of life back in 20 freaking 18.

558
00:20:44,559 --> 00:20:45,840
but tell me

559
00:20:45,840 --> 00:20:48,480
what does every atm in north america

560
00:20:48,480 --> 00:20:50,559
still run on right now

561
00:20:50,559 --> 00:20:52,320
does anybody know

562
00:20:52,320 --> 00:20:56,080
 xp yeah um so um so there are

563
00:20:56,080 --> 00:21:01,158
places that still might help you um

564
00:21:04,880 --> 00:21:06,799
oh my god um actually that was probably

565
00:21:06,799 --> 00:21:08,880
more secure because nobody was riding

566
00:21:08,880 --> 00:21:11,360
the airplane going for reward for um so

567
00:21:11,360 --> 00:21:14,480
um so and as well as you know how much a

568
00:21:14,480 --> 00:21:17,039
windsor 2012 is still maybe freaking out

569
00:21:17,039 --> 00:21:20,880
there um so you can leverage it test the

570
00:21:20,880 --> 00:21:24,000
hell out of it and not in production uh

571
00:21:24,000 --> 00:21:26,400
and it'll reduce the number of tools

572
00:21:26,400 --> 00:21:29,600
that an attacker can use um so uh you

573
00:21:29,600 --> 00:21:30,799
you're just making it harder for the

574
00:21:30,799 --> 00:21:32,159
attacker to win

575
00:21:32,159 --> 00:21:34,720
ah so i love this next section this is

576
00:21:34,720 --> 00:21:38,159
all about land mines deception practices

577
00:21:38,159 --> 00:21:39,919
canaries whatever you want to call them

578
00:21:39,919 --> 00:21:41,520
but they're freaking barely and they're

579
00:21:41,520 --> 00:21:44,640
so easy so very first one is so these

580
00:21:44,640 --> 00:21:46,159
are like honey tokens choose what you've

581
00:21:46,159 --> 00:21:48,400
got honey files is a brilliant way to

582
00:21:48,400 --> 00:21:50,480
get started so you get together with the

583
00:21:50,480 --> 00:21:53,120
it admins you put a hidden file into the

584
00:21:53,120 --> 00:21:55,760
golden image you bury it deep down into

585
00:21:55,760 --> 00:21:58,320
the os you drop it on everybody's box

586
00:21:58,320 --> 00:22:00,080
push it out with ws or whatever

587
00:22:00,080 --> 00:22:03,120
microsoft calls it today um and um and

588
00:22:03,120 --> 00:22:06,159
then you make it juicy you start naming

589
00:22:06,159 --> 00:22:08,400
that file something like password list

590
00:22:08,400 --> 00:22:10,960
or pwd list or something like that maybe

591
00:22:10,960 --> 00:22:13,840
even randomize that um but most

592
00:22:13,840 --> 00:22:15,520
attackers will not be able to resist

593
00:22:15,520 --> 00:22:17,200
that when they see it now there is some

594
00:22:17,200 --> 00:22:18,880
chances for false positives right if

595
00:22:18,880 --> 00:22:20,480
someone drops to the command line and

596
00:22:20,480 --> 00:22:22,480
does a dirt slash s which i have not

597
00:22:22,480 --> 00:22:24,960
seen a user do in a hell a long time but

598
00:22:24,960 --> 00:22:26,720
um but that could trigger it you got to

599
00:22:26,720 --> 00:22:28,400
make sure that you know your av doesn't

600
00:22:28,400 --> 00:22:29,200
uh

601
00:22:29,200 --> 00:22:30,720
trip it off or that your phone scanner

602
00:22:30,720 --> 00:22:32,880
doesn't touch it either but just doing

603
00:22:32,880 --> 00:22:34,080
this alone

604
00:22:34,080 --> 00:22:36,720
you can be monitoring for at least some

605
00:22:36,720 --> 00:22:39,760
evil throughout your entire user base

606
00:22:39,760 --> 00:22:42,080
with one file right this one file you

607
00:22:42,080 --> 00:22:44,720
alert on access to this file

608
00:22:44,720 --> 00:22:47,280
you you you either have you know a minor

609
00:22:47,280 --> 00:22:49,360
chance of a false positive or you've got

610
00:22:49,360 --> 00:22:51,679
someone trying to lurk through your file

611
00:22:51,679 --> 00:22:53,760
systems um

612
00:22:53,760 --> 00:22:55,840
so honey accounts even better better

613
00:22:55,840 --> 00:22:59,120
fidelity on this um put a put an account

614
00:22:59,120 --> 00:23:02,559
in the domain call it domain admin x um

615
00:23:02,559 --> 00:23:05,840
in the um in the description itself

616
00:23:05,840 --> 00:23:08,640
put literally the text the password is

617
00:23:08,640 --> 00:23:10,000
and some numbers password that you're

618
00:23:10,000 --> 00:23:11,360
never actually going to use it doesn't

619
00:23:11,360 --> 00:23:14,480
matter um but uh but when someone uses

620
00:23:14,480 --> 00:23:16,880
their um domain enumerating tools to

621
00:23:16,880 --> 00:23:18,720
pull back the entire freaking domain

622
00:23:18,720 --> 00:23:20,080
they're going to see this and they're

623
00:23:20,080 --> 00:23:22,320
going to think you are the dumbest mcse

624
00:23:22,320 --> 00:23:25,360
that has ever walked on the earth but

625
00:23:25,360 --> 00:23:26,960
they're the dumbest hacker that's ever

626
00:23:26,960 --> 00:23:28,480
walked on the earth because you're gonna

627
00:23:28,480 --> 00:23:29,760
put that in the admins group you're

628
00:23:29,760 --> 00:23:31,280
gonna make sure no one can use it oh

629
00:23:31,280 --> 00:23:34,480
sorry i went too far um and uh and if

630
00:23:34,480 --> 00:23:36,240
someone tell you again you're just

631
00:23:36,240 --> 00:23:38,159
monitoring for one tiny little thing

632
00:23:38,159 --> 00:23:39,840
we're talking like less than a k worth

633
00:23:39,840 --> 00:23:42,000
of vlogs here someone trips on that

634
00:23:42,000 --> 00:23:44,000
account you know you've probably got

635
00:23:44,000 --> 00:23:46,080
someone either looking around or someone

636
00:23:46,080 --> 00:23:47,840
really needed domain admin so that they

637
00:23:47,840 --> 00:23:51,120
can get out watch those cat videos uh so

638
00:23:51,120 --> 00:23:53,840
um more on mines who here is actually a

639
00:23:53,840 --> 00:23:55,360
dba

640
00:23:55,360 --> 00:23:57,520
oh thank god because they are such prima

641
00:23:57,520 --> 00:23:59,760
donnas right well you can't mess with my

642
00:23:59,760 --> 00:24:03,600
freaking iops um and doing like database

643
00:24:03,600 --> 00:24:05,840
monitoring stuff like that usually a big

644
00:24:05,840 --> 00:24:07,120
project

645
00:24:07,120 --> 00:24:09,919
so instead we make something like uh you

646
00:24:09,919 --> 00:24:11,120
get together with

647
00:24:11,120 --> 00:24:14,080
one or two of your ddas you make a

648
00:24:14,080 --> 00:24:15,760
either a database or maybe even just a

649
00:24:15,760 --> 00:24:17,600
table again call it something juicy

650
00:24:17,600 --> 00:24:19,039
something that someone would want to

651
00:24:19,039 --> 00:24:21,600
steal from you credit cards some sort of

652
00:24:21,600 --> 00:24:23,679
intellectual property maybe blueprints

653
00:24:23,679 --> 00:24:25,360
if you're in a manufacturing firm

654
00:24:25,360 --> 00:24:27,840
something that they're going to want

655
00:24:27,840 --> 00:24:29,440
and then you don't publish a scheme

656
00:24:29,440 --> 00:24:31,520
anywhere nobody knows about this

657
00:24:31,520 --> 00:24:33,360
table or database and then you just

658
00:24:33,360 --> 00:24:36,240
alert again on access very simple very

659
00:24:36,240 --> 00:24:38,320
fast if you get hints on it

660
00:24:38,320 --> 00:24:40,080
on any of these things really now you

661
00:24:40,080 --> 00:24:42,320
can come back around boston and go we

662
00:24:42,320 --> 00:24:44,720
found evidence of some

663
00:24:44,720 --> 00:24:47,120
it's probably it's like cockroaches

664
00:24:47,120 --> 00:24:49,360
right if we found this there's probably

665
00:24:49,360 --> 00:24:51,440
a lot more of it we need to start taking

666
00:24:51,440 --> 00:24:53,840
a deeper look at things um and then this

667
00:24:53,840 --> 00:24:54,960
last one

668
00:24:54,960 --> 00:24:57,360
so beautiful in simplicity uh this is

669
00:24:57,360 --> 00:25:00,320
invoke run as you can get from github it

670
00:25:00,320 --> 00:25:02,960
actually loads a fake set of credentials

671
00:25:02,960 --> 00:25:04,640
into memory on every system that it's

672
00:25:04,640 --> 00:25:06,240
running on you put in the startup

673
00:25:06,240 --> 00:25:08,159
routine on all uh all your all your

674
00:25:08,159 --> 00:25:10,720
windows boxes really um and then if

675
00:25:10,720 --> 00:25:12,240
anybody tries to use that account the

676
00:25:12,240 --> 00:25:14,640
domain you'll you alert on use unless

677
00:25:14,640 --> 00:25:16,400
you actually have users that are trying

678
00:25:16,400 --> 00:25:17,840
to win that competition by using

679
00:25:17,840 --> 00:25:21,120
mimikatz to scrape off creds um which is

680
00:25:21,120 --> 00:25:22,320
the only way i can see this false

681
00:25:22,320 --> 00:25:24,320
positivity you've got evil

682
00:25:24,320 --> 00:25:27,039
unlock in the network for sure um

683
00:25:27,039 --> 00:25:29,679
so oh and uh yeah so these eventually so

684
00:25:29,679 --> 00:25:31,200
i just found out there's uh honey tokens

685
00:25:31,200 --> 00:25:33,039
for the cloud now well not just not a

686
00:25:33,039 --> 00:25:34,720
little while ago um so there's some

687
00:25:34,720 --> 00:25:38,080
caveats with it um so project space crab

688
00:25:38,080 --> 00:25:41,600
was released back in 2018 uh it was a

689
00:25:41,600 --> 00:25:45,520
way to mass manufacture honey tokens for

690
00:25:45,520 --> 00:25:48,080
cloud and it was brilliant until about

691
00:25:48,080 --> 00:25:50,080
six months later when rhino security

692
00:25:50,080 --> 00:25:53,520
labs found a way to detect booby trap

693
00:25:53,520 --> 00:25:55,279
tokens now that means your attacker

694
00:25:55,279 --> 00:25:56,799
still has to know that there's a

695
00:25:56,799 --> 00:25:59,840
detection and actually try for it so you

696
00:25:59,840 --> 00:26:01,919
still might be able to leverage it and

697
00:26:01,919 --> 00:26:04,320
this is for mass produced tokens right

698
00:26:04,320 --> 00:26:07,760
the issue was um there's some club trail

699
00:26:07,760 --> 00:26:08,960
uh

700
00:26:08,960 --> 00:26:10,400
parts of the college trail that don't

701
00:26:10,400 --> 00:26:13,440
log certain niche services um and

702
00:26:13,440 --> 00:26:15,520
apparently because amazon's own error

703
00:26:15,520 --> 00:26:18,080
messages were tipping off um if you if

704
00:26:18,080 --> 00:26:19,279
you if you're triggering them the right

705
00:26:19,279 --> 00:26:22,159
way that the the token was booby-trapped

706
00:26:22,159 --> 00:26:24,640
um but for uh for like a manually

707
00:26:24,640 --> 00:26:26,960
created um token you know honey token to

708
00:26:26,960 --> 00:26:29,600
booby trap i i believe that still works

709
00:26:29,600 --> 00:26:31,120
it was just the mass-produced ones that

710
00:26:31,120 --> 00:26:32,559
seem to have this issue

711
00:26:32,559 --> 00:26:36,000
um so um yes uh other quick down and

712
00:26:36,000 --> 00:26:37,840
dirty ways to stop attackers in their

713
00:26:37,840 --> 00:26:40,080
tracks so just using a web form and

714
00:26:40,080 --> 00:26:41,679
having people authenticate it just once

715
00:26:41,679 --> 00:26:44,880
a day when they first log in um you know

716
00:26:44,880 --> 00:26:46,240
maybe a little more difficult with

717
00:26:46,240 --> 00:26:48,080
everybody working from home

718
00:26:48,080 --> 00:26:49,039
if you're

719
00:26:49,039 --> 00:26:50,240
really

720
00:26:50,240 --> 00:26:52,240
you know top secret kind of place you

721
00:26:52,240 --> 00:26:54,880
might even ask your users to just allow

722
00:26:54,880 --> 00:26:57,200
a particular site once per day so like

723
00:26:57,200 --> 00:26:59,200
the first person that goes to google

724
00:26:59,200 --> 00:27:02,159
that day gets a pop-up and it says is it

725
00:27:02,159 --> 00:27:04,000
okay to go to google and that user says

726
00:27:04,000 --> 00:27:06,559
yes now i know that sounds crazy

727
00:27:06,559 --> 00:27:08,799
but it doesn't matter well you know if

728
00:27:08,799 --> 00:27:10,720
the user answers yes to everything the

729
00:27:10,720 --> 00:27:13,440
intent is to stop scripted things from

730
00:27:13,440 --> 00:27:14,799
finding their way out they're not going

731
00:27:14,799 --> 00:27:17,200
to the script isn't going to understand

732
00:27:17,200 --> 00:27:19,279
this this pop-up that asks for

733
00:27:19,279 --> 00:27:21,840
validation um there's a

734
00:27:21,840 --> 00:27:24,640
a person in the middle attack um in

735
00:27:24,640 --> 00:27:27,200
w-pad those two no routes uh depending

736
00:27:27,200 --> 00:27:30,080
on your ip v4 or v6 should take care of

737
00:27:30,080 --> 00:27:33,039
that and as long as you gotta do that

738
00:27:33,039 --> 00:27:37,039
anyway i want you to disable netbios

739
00:27:37,039 --> 00:27:39,679
i know it's just like that freaking java

740
00:27:39,679 --> 00:27:41,760
6 that's out there right somewhere in

741
00:27:41,760 --> 00:27:44,559
the organization you got to have netbios

742
00:27:44,559 --> 00:27:46,960
running because some important service

743
00:27:46,960 --> 00:27:49,200
is going to go down that's fine but you

744
00:27:49,200 --> 00:27:51,520
need to have a plan whether it's a one

745
00:27:51,520 --> 00:27:54,320
year plan five year plan that has

746
00:27:54,320 --> 00:27:56,640
got to go who here is either heard of or

747
00:27:56,640 --> 00:27:59,840
used responder in an organization

748
00:27:59,840 --> 00:28:02,799
yeah responders loves net bios because

749
00:28:02,799 --> 00:28:04,640
responder amongst many things that it

750
00:28:04,640 --> 00:28:06,720
does sits there and waits for netbios

751
00:28:06,720 --> 00:28:08,640
broadcast and as soon as it hears one

752
00:28:08,640 --> 00:28:11,120
goes yes yes i am the server you're

753
00:28:11,120 --> 00:28:13,919
looking for just hand everything to me

754
00:28:13,919 --> 00:28:17,120
it'll be fine um it is one of the first

755
00:28:17,120 --> 00:28:19,600
tools many red teamers will deploy onto

756
00:28:19,600 --> 00:28:21,440
a compromised system

757
00:28:21,440 --> 00:28:24,640
and netbios makes it very easy to to to

758
00:28:24,640 --> 00:28:26,240
leverage that tool

759
00:28:26,240 --> 00:28:28,399
along with you know nd lan man and all

760
00:28:28,399 --> 00:28:31,039
that kind of stuff but um give her a bio

761
00:28:31,039 --> 00:28:34,320
see we really don't need it anymore um

762
00:28:34,320 --> 00:28:36,159
making the internal name servers not do

763
00:28:36,159 --> 00:28:38,000
recursive lookups to

764
00:28:38,000 --> 00:28:39,679
external uh

765
00:28:39,679 --> 00:28:40,559
sites

766
00:28:40,559 --> 00:28:43,279
another good plan that's the proxy's job

767
00:28:43,279 --> 00:28:45,039
right internal name servers should be

768
00:28:45,039 --> 00:28:47,279
resolving names internally

769
00:28:47,279 --> 00:28:49,360
and again the idea here is just to make

770
00:28:49,360 --> 00:28:52,080
it difficult for scripted things to get

771
00:28:52,080 --> 00:28:53,279
out because they don't know about the

772
00:28:53,279 --> 00:28:54,799
freaking proxy especially if it's one

773
00:28:54,799 --> 00:28:56,240
that you have to authenticate to once a

774
00:28:56,240 --> 00:29:00,640
day um laughs so who here is still

775
00:29:00,640 --> 00:29:03,120
running on some systems somewhere yeah

776
00:29:03,120 --> 00:29:06,559
oh god now are you using laps too

777
00:29:06,559 --> 00:29:09,360
yeah is it working right for you

778
00:29:09,360 --> 00:29:11,039
see that's fantastic

779
00:29:11,039 --> 00:29:13,760
um so it's something in security that

780
00:29:13,760 --> 00:29:16,080
microsoft did that works

781
00:29:16,080 --> 00:29:19,200
which is a weird sentence to say but it

782
00:29:19,200 --> 00:29:20,640
works pretty damn well there are some

783
00:29:20,640 --> 00:29:22,559
bypasses for it but the idea is simple

784
00:29:22,559 --> 00:29:24,480
if you've got local admin on every

785
00:29:24,480 --> 00:29:27,200
system it just randomizes the password

786
00:29:27,200 --> 00:29:29,440
on every system running local admin so

787
00:29:29,440 --> 00:29:31,360
we can't get instantaneous lateral

788
00:29:31,360 --> 00:29:34,720
movement using local admin um so works

789
00:29:34,720 --> 00:29:36,480
pretty well if you if you're forced to

790
00:29:36,480 --> 00:29:39,039
use local admin deploy this

791
00:29:39,039 --> 00:29:40,399
it should be free

792
00:29:40,399 --> 00:29:42,559
if it's if your sales rep like tries to

793
00:29:42,559 --> 00:29:44,000
charge you for it like kick him in the

794
00:29:44,000 --> 00:29:45,679
ass or something like that because this

795
00:29:45,679 --> 00:29:47,200
this should just come with your uh your

796
00:29:47,200 --> 00:29:50,480
license um and then uh and then

797
00:29:50,480 --> 00:29:52,480
this last one got this from dave kennedy

798
00:29:52,480 --> 00:29:55,120
uh in a talk that he did um it's a

799
00:29:55,120 --> 00:29:58,559
simple gpo that just says deny access to

800
00:29:58,559 --> 00:30:00,240
this system all your

801
00:30:00,240 --> 00:30:02,799
all your workstations and laptops from

802
00:30:02,799 --> 00:30:05,200
the network and you just apply it to

803
00:30:05,200 --> 00:30:06,640
everything out there and obviously not

804
00:30:06,640 --> 00:30:09,440
your servers but there's no reason ever

805
00:30:09,440 --> 00:30:11,279
that anybody should have to connect to

806
00:30:11,279 --> 00:30:13,440
my workstation or my laptop right

807
00:30:13,440 --> 00:30:16,480
if it needs to it's a gpo they can

808
00:30:16,480 --> 00:30:19,360
change the damn gpa um so

809
00:30:19,360 --> 00:30:21,440
deploying that out makes dave's life

810
00:30:21,440 --> 00:30:23,200
miserable because then he has to start

811
00:30:23,200 --> 00:30:26,159
spearfishing each and every target one

812
00:30:26,159 --> 00:30:28,000
at a time in the organization unless

813
00:30:28,000 --> 00:30:29,520
there's some bones out there that he can

814
00:30:29,520 --> 00:30:32,080
uh that can leverage so i'm so friendly

815
00:30:32,080 --> 00:30:33,919
with our groups that really is my dog by

816
00:30:33,919 --> 00:30:35,279
the way i had this prop pipe sitting

817
00:30:35,279 --> 00:30:37,039
around and when coving hit and i'm like

818
00:30:37,039 --> 00:30:39,440
i got to teach my dog a new trick

819
00:30:39,440 --> 00:30:41,360
that was it

820
00:30:41,360 --> 00:30:43,039
she's a ham

821
00:30:43,039 --> 00:30:44,000
but

822
00:30:44,000 --> 00:30:46,480
um so three tools that will essentially

823
00:30:46,480 --> 00:30:48,159
get you the same thing here so there's

824
00:30:48,159 --> 00:30:50,559
something called r um you can also

825
00:30:50,559 --> 00:30:52,720
leverage scipy and with maybe some

826
00:30:52,720 --> 00:30:55,120
tableau or some other visualization tool

827
00:30:55,120 --> 00:30:56,720
or you can apply for the splunk

828
00:30:56,720 --> 00:30:58,640
developer's license and and do it with

829
00:30:58,640 --> 00:31:00,399
splunk as well i actually learned this

830
00:31:00,399 --> 00:31:02,159
one as it splunk but it's really clever

831
00:31:02,159 --> 00:31:05,760
so um everybody wants to like sell you

832
00:31:05,760 --> 00:31:07,760
their awesome freaking machine learning

833
00:31:07,760 --> 00:31:09,200
stuff right

834
00:31:09,200 --> 00:31:11,120
don't do it until you've had a chance to

835
00:31:11,120 --> 00:31:13,039
actually play with just some raw machine

836
00:31:13,039 --> 00:31:14,240
learning and see if it's going to be

837
00:31:14,240 --> 00:31:15,679
helpful for you so here's a great

838
00:31:15,679 --> 00:31:17,519
example

839
00:31:17,519 --> 00:31:19,679
if you go to cms.gov and you go to that

840
00:31:19,679 --> 00:31:22,159
button that says research statistics all

841
00:31:22,159 --> 00:31:24,320
the way over on the right um you can

842
00:31:24,320 --> 00:31:25,679
download

843
00:31:25,679 --> 00:31:28,240
all sorts of healthcare data like

844
00:31:28,240 --> 00:31:30,399
prescriptions now hipaa says that you're

845
00:31:30,399 --> 00:31:31,679
not going to know who that prescription

846
00:31:31,679 --> 00:31:33,279
was for

847
00:31:33,279 --> 00:31:36,000
but you can get everything else

848
00:31:36,000 --> 00:31:37,919
who wrote it what it was for when it was

849
00:31:37,919 --> 00:31:40,240
written anything pretty much everything

850
00:31:40,240 --> 00:31:42,080
else on that prescription other than the

851
00:31:42,080 --> 00:31:44,399
person that got it is available in data

852
00:31:44,399 --> 00:31:46,159
so so some of the guys doing some

853
00:31:46,159 --> 00:31:48,960
research downloaded um a year's worth of

854
00:31:48,960 --> 00:31:51,760
data prescription data specifically and

855
00:31:51,760 --> 00:31:54,720
then they filtered it out for just the

856
00:31:54,720 --> 00:31:57,279
opioid prescriptions figuring there

857
00:31:57,279 --> 00:31:59,120
might be something interesting there

858
00:31:59,120 --> 00:32:01,120
right now at this point they didn't know

859
00:32:01,120 --> 00:32:02,480
what they were going to find but all

860
00:32:02,480 --> 00:32:04,159
they did was run it through two simple

861
00:32:04,159 --> 00:32:06,159
algorithms it's an algorithm available

862
00:32:06,159 --> 00:32:07,600
in all those different tools that i told

863
00:32:07,600 --> 00:32:10,240
you about so the first algorithm uh is

864
00:32:10,240 --> 00:32:13,679
called pca and what pca does is it takes

865
00:32:13,679 --> 00:32:16,559
all of the uh all the different um

866
00:32:16,559 --> 00:32:18,320
columns basically that you have there

867
00:32:18,320 --> 00:32:21,360
and reduce it down to x number of points

868
00:32:21,360 --> 00:32:23,039
so that uh the first three that you see

869
00:32:23,039 --> 00:32:25,360
there pc one pc two species that's the

870
00:32:25,360 --> 00:32:27,600
algorithm figuring out okay i can reduce

871
00:32:27,600 --> 00:32:31,039
this data down to x number of points and

872
00:32:31,039 --> 00:32:33,200
we said 3 because you can plot it on a

873
00:32:33,200 --> 00:32:35,840
3d graph so that gives you your

874
00:32:35,840 --> 00:32:36,960
reduction

875
00:32:36,960 --> 00:32:39,600
and then you pass that output through

876
00:32:39,600 --> 00:32:41,760
just one more algorithm it's called

877
00:32:41,760 --> 00:32:44,159
k-means it's a common clustering

878
00:32:44,159 --> 00:32:46,240
algorithm and that's where we get this

879
00:32:46,240 --> 00:32:49,519
um this uh 3d graph where you see most

880
00:32:49,519 --> 00:32:51,200
of the things clusters so those are all

881
00:32:51,200 --> 00:32:52,640
prescriptions they're all clustered

882
00:32:52,640 --> 00:32:54,399
around several centroids and then you

883
00:32:54,399 --> 00:32:56,720
see some trailing outliers now again

884
00:32:56,720 --> 00:32:58,559
didn't know why there were outliers at

885
00:32:58,559 --> 00:33:00,880
this moment but a little research and

886
00:33:00,880 --> 00:33:02,559
you'll find that the second line down

887
00:33:02,559 --> 00:33:04,159
here john couch

888
00:33:04,159 --> 00:33:06,640
john's in jail for 240 months for

889
00:33:06,640 --> 00:33:08,799
prescription fraud right and the reason

890
00:33:08,799 --> 00:33:11,039
why he stood out was that he was writing

891
00:33:11,039 --> 00:33:13,679
far more prescriptions than his peers if

892
00:33:13,679 --> 00:33:15,120
i was able to scroll down we'd find

893
00:33:15,120 --> 00:33:17,279
another doctor down there that um

894
00:33:17,279 --> 00:33:19,760
actually the reason that doc is also in

895
00:33:19,760 --> 00:33:21,840
jail by the way um for prescription

896
00:33:21,840 --> 00:33:24,720
fraud but the reason he was an outlier

897
00:33:24,720 --> 00:33:27,360
was that he was a pediatrician

898
00:33:27,360 --> 00:33:29,600
and i don't know too many two-year-olds

899
00:33:29,600 --> 00:33:31,919
that need oxycontin on a monthly basis

900
00:33:31,919 --> 00:33:33,679
although every time i fly

901
00:33:33,679 --> 00:33:36,960
there's always one um so

902
00:33:36,960 --> 00:33:39,279
uh obviously he was not giving drugs to

903
00:33:39,279 --> 00:33:41,120
kids he was writing it so that the

904
00:33:41,120 --> 00:33:44,000
parents could abuse uh oxycontin but um

905
00:33:44,000 --> 00:33:46,399
uh so think so think about how you could

906
00:33:46,399 --> 00:33:50,080
just apply this to your own the best

907
00:33:50,080 --> 00:33:52,480
machine learning that you can do is on

908
00:33:52,480 --> 00:33:54,480
stuff that no data scientists would have

909
00:33:54,480 --> 00:33:56,320
ever thought of because it's particular

910
00:33:56,320 --> 00:33:58,720
to your organization so if you start

911
00:33:58,720 --> 00:34:00,720
there and just kind of learn about what

912
00:34:00,720 --> 00:34:02,799
you could find then you can maybe move

913
00:34:02,799 --> 00:34:04,159
up to a commercial tool when you're

914
00:34:04,159 --> 00:34:05,919
ready because you know exactly what it

915
00:34:05,919 --> 00:34:07,919
is you want to be looking for um so what

916
00:34:07,919 --> 00:34:09,359
about the long driver you used to work

917
00:34:09,359 --> 00:34:12,159
at splunk uh so pass the hash detection

918
00:34:12,159 --> 00:34:14,079
um and by the way these slides will be

919
00:34:14,079 --> 00:34:17,440
available to everybody nobody yeah

920
00:34:17,440 --> 00:34:19,599
not to comment anymore right but i would

921
00:34:19,599 --> 00:34:21,280
uh if you haven't used this before i

922
00:34:21,280 --> 00:34:23,359
would run it against your history right

923
00:34:23,359 --> 00:34:25,520
just see if people were passing the hash

924
00:34:25,520 --> 00:34:27,520
in the old logs and it still may turn up

925
00:34:27,520 --> 00:34:30,560
um depending on your environment um

926
00:34:30,560 --> 00:34:33,199
finding unauthorized dns dns in general

927
00:34:33,199 --> 00:34:34,639
if you want to start looking for proof

928
00:34:34,639 --> 00:34:36,719
of evil in your environment dns is a

929
00:34:36,719 --> 00:34:38,879
great place to start so you can start by

930
00:34:38,879 --> 00:34:41,040
um looking for unauthorized dns this is

931
00:34:41,040 --> 00:34:43,520
just three ways to write the same query

932
00:34:43,520 --> 00:34:46,159
um you can look for dns spoofing

933
00:34:46,159 --> 00:34:49,599
activity uh the second one there finding

934
00:34:49,599 --> 00:34:51,839
clients connecting to multiple dns

935
00:34:51,839 --> 00:34:53,199
servers that was kind of brilliant one

936
00:34:53,199 --> 00:34:55,918
of my peers wrote that one um and i was

937
00:34:55,918 --> 00:34:59,440
like why oh yeah so how many dns servers

938
00:34:59,440 --> 00:35:01,359
does any one host particularly know

939
00:35:01,359 --> 00:35:02,480
about

940
00:35:02,480 --> 00:35:04,720
usually two right yeah i mean you might

941
00:35:04,720 --> 00:35:06,400
be round robin in your dns but by

942
00:35:06,400 --> 00:35:08,400
default they know about too if it's

943
00:35:08,400 --> 00:35:10,400
connecting to all sorts of dns servers

944
00:35:10,400 --> 00:35:12,079
and it's not part of the round-robin

945
00:35:12,079 --> 00:35:13,200
sequence

946
00:35:13,200 --> 00:35:15,119
that's going to be weird check that out

947
00:35:15,119 --> 00:35:17,599
um extremely long dns

948
00:35:17,599 --> 00:35:19,839
right this is this is data exfiltration

949
00:35:19,839 --> 00:35:21,839
um the numbers in here like two standard

950
00:35:21,839 --> 00:35:23,760
deeds two characters long that's not a

951
00:35:23,760 --> 00:35:25,599
magic number it's a place to start

952
00:35:25,599 --> 00:35:26,800
you're gonna have to tweak it up and

953
00:35:26,800 --> 00:35:28,240
down but you should be able to

954
00:35:28,240 --> 00:35:30,640
especially if you're seeing lots of

955
00:35:30,640 --> 00:35:33,280
super long dns queries coming from the

956
00:35:33,280 --> 00:35:34,800
same host that's probably data

957
00:35:34,800 --> 00:35:37,119
exfiltration

958
00:35:37,119 --> 00:35:38,960
so i've been doing like i said uh some

959
00:35:38,960 --> 00:35:41,920
some research into api this is really

960
00:35:41,920 --> 00:35:45,839
great api dat joke um

961
00:35:45,839 --> 00:35:47,359
some cool things that i found out here

962
00:35:47,359 --> 00:35:49,200
that you can start doing for free so

963
00:35:49,200 --> 00:35:52,160
first is um one of the big so it's

964
00:35:52,160 --> 00:35:54,240
amazing you would have thought we would

965
00:35:54,240 --> 00:35:56,640
have learned all of our faults when web

966
00:35:56,640 --> 00:35:58,880
apps were the big problem 20 freaking

967
00:35:58,880 --> 00:36:01,760
years ago right but instead we're making

968
00:36:01,760 --> 00:36:04,079
the exact same mistakes in the api space

969
00:36:04,079 --> 00:36:06,400
now that apis are blowing up so there's

970
00:36:06,400 --> 00:36:08,800
a tool called kite runner it's free katy

971
00:36:08,800 --> 00:36:10,800
packson fear has a youtube video on how

972
00:36:10,800 --> 00:36:12,400
to use it it's amazing

973
00:36:12,400 --> 00:36:15,040
you give it a place to start and start

974
00:36:15,040 --> 00:36:18,480
scanning for api endpoints which confuse

975
00:36:18,480 --> 00:36:19,760
me at first because i'm like endpoints

976
00:36:19,760 --> 00:36:21,280
that's like a certain area you know

977
00:36:21,280 --> 00:36:24,320
oaks right no endpoints are just a path

978
00:36:24,320 --> 00:36:27,280
in an api and each thing that the

979
00:36:27,280 --> 00:36:28,800
application does is one of those

980
00:36:28,800 --> 00:36:31,599
endpoints so um but what they've done is

981
00:36:31,599 --> 00:36:33,440
they scan the whole freaking internet

982
00:36:33,440 --> 00:36:36,240
for apis to look for

983
00:36:36,240 --> 00:36:39,440
uh word lists to create patterns because

984
00:36:39,440 --> 00:36:41,839
the naming conventions and api paths

985
00:36:41,839 --> 00:36:43,839
tend to follow kind of the same thing it

986
00:36:43,839 --> 00:36:47,040
would be like this app v1

987
00:36:47,040 --> 00:36:49,520
get and yeah so um

988
00:36:49,520 --> 00:36:52,000
so you can run that against your

989
00:36:52,000 --> 00:36:55,359
your existing to remember we also talked

990
00:36:55,359 --> 00:36:57,520
about shadow i.t and it was like you

991
00:36:57,520 --> 00:36:59,520
know the i.t guys that needed to stand

992
00:36:59,520 --> 00:37:01,119
up some stuff really quick so they throw

993
00:37:01,119 --> 00:37:02,800
a server under somebody's desk or

994
00:37:02,800 --> 00:37:06,079
whatever i even did i i i snuck down in

995
00:37:06,079 --> 00:37:08,000
the data center and put some taps in

996
00:37:08,000 --> 00:37:09,680
when nobody was looking because they

997
00:37:09,680 --> 00:37:11,119
wouldn't freaking do it for me and i

998
00:37:11,119 --> 00:37:12,880
needed to monitor that line

999
00:37:12,880 --> 00:37:16,800
but but now shadow i.t seems to be the

1000
00:37:16,800 --> 00:37:19,599
devs the devs are putting apis out in

1001
00:37:19,599 --> 00:37:21,280
the cloud faster than you can keep up

1002
00:37:21,280 --> 00:37:22,960
with them a lot of people concerned

1003
00:37:22,960 --> 00:37:26,240
about shadow api so kite run will get

1004
00:37:26,240 --> 00:37:28,000
for you if you're allowed to scan the

1005
00:37:28,000 --> 00:37:29,760
environment if you're not allowed to

1006
00:37:29,760 --> 00:37:31,520
scan the environment i've got a second

1007
00:37:31,520 --> 00:37:33,680
tip there but that'll at least tell you

1008
00:37:33,680 --> 00:37:35,599
what you're dealing with um and if

1009
00:37:35,599 --> 00:37:37,839
you're dealing with thousands more than

1010
00:37:37,839 --> 00:37:41,040
you expected that's a big problem um and

1011
00:37:41,040 --> 00:37:43,280
now and then the really sad thing is

1012
00:37:43,280 --> 00:37:45,760
there are free tools for the devs to

1013
00:37:45,760 --> 00:37:47,440
document their apis they don't even have

1014
00:37:47,440 --> 00:37:49,520
to lift a freaking finger so if they

1015
00:37:49,520 --> 00:37:51,040
don't know about it help them find those

1016
00:37:51,040 --> 00:37:53,200
free tools drop it into the cicd

1017
00:37:53,200 --> 00:37:55,440
pipeline everybody will be happy and

1018
00:37:55,440 --> 00:37:57,280
it's no extra work for them

1019
00:37:57,280 --> 00:37:59,119
web scanners traditional web scanners

1020
00:37:59,119 --> 00:38:01,839
not so great at testing the phones in

1021
00:38:01,839 --> 00:38:04,480
apis so there's a

1022
00:38:04,480 --> 00:38:06,320
here's three and there's a couple more

1023
00:38:06,320 --> 00:38:07,440
as well

1024
00:38:07,440 --> 00:38:10,800
free open source vulnerable apis to test

1025
00:38:10,800 --> 00:38:13,680
your testing tools with so to stand one

1026
00:38:13,680 --> 00:38:15,599
of those up um some of them are hosted

1027
00:38:15,599 --> 00:38:16,880
on the internet others you're gonna have

1028
00:38:16,880 --> 00:38:18,960
to pop a vm up or something like that

1029
00:38:18,960 --> 00:38:21,680
but if you run like your

1030
00:38:21,680 --> 00:38:24,079
white hat or your qualis or your ness's

1031
00:38:24,079 --> 00:38:26,240
against these apis and you get very

1032
00:38:26,240 --> 00:38:27,680
little back

1033
00:38:27,680 --> 00:38:30,079
you are missing a ton of out there

1034
00:38:30,079 --> 00:38:32,720
because these are very vulnerable apis

1035
00:38:32,720 --> 00:38:34,320
and you should come back with a lot of

1036
00:38:34,320 --> 00:38:35,599
results

1037
00:38:35,599 --> 00:38:36,880
so if you don't get vulnerabilities come

1038
00:38:36,880 --> 00:38:38,400
back and check

1039
00:38:38,400 --> 00:38:40,640
postman can be used to configure

1040
00:38:40,640 --> 00:38:43,200
security tests just as easily it is to

1041
00:38:43,200 --> 00:38:45,920
test for just the quality of the api or

1042
00:38:45,920 --> 00:38:48,160
functionality the happy path love happy

1043
00:38:48,160 --> 00:38:49,440
path i found out about happy path a

1044
00:38:49,440 --> 00:38:51,839
while ago i'm like yeah dads do a lot of

1045
00:38:51,839 --> 00:38:52,960
good stuff

1046
00:38:52,960 --> 00:38:54,079
um but

1047
00:38:54,079 --> 00:38:55,280
um

1048
00:38:55,280 --> 00:38:56,960
deception practices will actually work

1049
00:38:56,960 --> 00:38:59,119
here too so do things like create

1050
00:38:59,119 --> 00:39:01,359
endpoints not in your swagger or your

1051
00:39:01,359 --> 00:39:02,960
spec file

1052
00:39:02,960 --> 00:39:05,359
then put deceptive comments in the

1053
00:39:05,359 --> 00:39:07,280
messages that come back like oh yeah

1054
00:39:07,280 --> 00:39:10,160
your admin path is here or admin equal

1055
00:39:10,160 --> 00:39:11,760
true making them think that there might

1056
00:39:11,760 --> 00:39:14,480
be an admin that can be turned on

1057
00:39:14,480 --> 00:39:16,240
you can even replace like if you're

1058
00:39:16,240 --> 00:39:18,160
doing a little bit of proxy interception

1059
00:39:18,160 --> 00:39:21,040
you can release for replace 400 to 500

1060
00:39:21,040 --> 00:39:24,000
codes with a fake 200 code and say yeah

1061
00:39:24,000 --> 00:39:25,359
dude this is cool you also want to check

1062
00:39:25,359 --> 00:39:26,960
out this stuff over here

1063
00:39:26,960 --> 00:39:28,480
if anybody attempts to interact with

1064
00:39:28,480 --> 00:39:30,400
those honey endpoints you've probably

1065
00:39:30,400 --> 00:39:32,400
got someone at least trying to abuse

1066
00:39:32,400 --> 00:39:33,839
your api

1067
00:39:33,839 --> 00:39:36,400
um so how much time do i have left here

1068
00:39:36,400 --> 00:39:37,359
uh

1069
00:39:37,359 --> 00:39:39,040
oh we have a little extra time i was

1070
00:39:39,040 --> 00:39:41,920
gonna finish but i'm gonna jump ahead um

1071
00:39:41,920 --> 00:39:43,440
there's a couple other tips and tricks

1072
00:39:43,440 --> 00:39:45,359
that i can i can give you all that i

1073
00:39:45,359 --> 00:39:47,200
didn't know if i'd have time for

1074
00:39:47,200 --> 00:39:50,720
so let's see here

1075
00:39:51,040 --> 00:39:51,440
um

1076
00:39:51,440 --> 00:39:54,400
[Music]

1077
00:39:54,400 --> 00:39:56,960
yeah uh so uh when i was at splunk we

1078
00:39:56,960 --> 00:40:00,240
were working on a thing called um rba uh

1079
00:40:00,240 --> 00:40:02,880
very clever way to leverage any indexing

1080
00:40:02,880 --> 00:40:04,880
tool so whether it's splunk or gray log

1081
00:40:04,880 --> 00:40:06,319
or whatever

1082
00:40:06,319 --> 00:40:08,720
the concept is pretty simple when you're

1083
00:40:08,720 --> 00:40:11,440
writing those alerts to your index

1084
00:40:11,440 --> 00:40:13,839
um don't just write them to the index

1085
00:40:13,839 --> 00:40:15,200
also

1086
00:40:15,200 --> 00:40:17,119
the index where all the alerts are also

1087
00:40:17,119 --> 00:40:19,440
write them to a risk index and every

1088
00:40:19,440 --> 00:40:21,920
time you do a write into that index

1089
00:40:21,920 --> 00:40:22,800
either

1090
00:40:22,800 --> 00:40:26,240
both apply some points of risk and

1091
00:40:26,240 --> 00:40:28,480
there's whole write-ups on it on uh some

1092
00:40:28,480 --> 00:40:30,319
math that you can use it's all freely

1093
00:40:30,319 --> 00:40:33,599
available um apply some points of risk

1094
00:40:33,599 --> 00:40:35,680
and then also map it to whatever minor

1095
00:40:35,680 --> 00:40:37,760
tactic or technique that uh that it

1096
00:40:37,760 --> 00:40:40,560
would map to um and then

1097
00:40:40,560 --> 00:40:42,720
one you know every five minutes every

1098
00:40:42,720 --> 00:40:44,720
day whatever it makes sense for the

1099
00:40:44,720 --> 00:40:46,079
handful of rules that you're gonna have

1100
00:40:46,079 --> 00:40:47,520
to write um you're gonna write some

1101
00:40:47,520 --> 00:40:49,680
rules that say hey in the last 24 hours

1102
00:40:49,680 --> 00:40:52,960
did any host or person exceed so many

1103
00:40:52,960 --> 00:40:54,640
points of risk and you can make those

1104
00:40:54,640 --> 00:40:56,240
points different for different ou's

1105
00:40:56,240 --> 00:40:58,400
stuff like that if someone or something

1106
00:40:58,400 --> 00:41:01,200
goes over that threshold alert on that

1107
00:41:01,200 --> 00:41:03,760
because that's and this is like this is

1108
00:41:03,760 --> 00:41:05,520
so much more effective than a lot of the

1109
00:41:05,520 --> 00:41:07,680
uva stuff that's out there right

1110
00:41:07,680 --> 00:41:10,079
because when it accrues enough points of

1111
00:41:10,079 --> 00:41:11,839
risk and you'll have to tweak

1112
00:41:11,839 --> 00:41:14,400
that's too weird to be normal for that

1113
00:41:14,400 --> 00:41:16,079
environment nobody else is popping off

1114
00:41:16,079 --> 00:41:17,839
like that if

1115
00:41:17,839 --> 00:41:19,920
our second rule that you could write is

1116
00:41:19,920 --> 00:41:23,760
hey in the last three weeks has any host

1117
00:41:23,760 --> 00:41:24,960
exhibited

1118
00:41:24,960 --> 00:41:27,440
alerts that touch more than three or

1119
00:41:27,440 --> 00:41:29,280
whatever you have to tweak it to

1120
00:41:29,280 --> 00:41:31,680
minor tactics or techniques which is

1121
00:41:31,680 --> 00:41:33,440
much better than just trying i mean

1122
00:41:33,440 --> 00:41:35,040
typically when uh when a host starts

1123
00:41:35,040 --> 00:41:36,240
popping off a lot of alerts it's the

1124
00:41:36,240 --> 00:41:38,400
same one going over and over again right

1125
00:41:38,400 --> 00:41:40,960
um by doing it this way we filter out

1126
00:41:40,960 --> 00:41:43,359
all that duplication and instead we're

1127
00:41:43,359 --> 00:41:45,920
just looking for the oddities that come

1128
00:41:45,920 --> 00:41:48,480
out right um so very effective way in

1129
00:41:48,480 --> 00:41:50,560
just some simple testing we saw true

1130
00:41:50,560 --> 00:41:52,960
positive rates go way up um and false

1131
00:41:52,960 --> 00:41:56,079
positive rates drop considerably um

1132
00:41:56,079 --> 00:41:56,960
the

1133
00:41:56,960 --> 00:41:58,880
quick uh quick example of it here so

1134
00:41:58,880 --> 00:42:00,880
this is what you would see in a typical

1135
00:42:00,880 --> 00:42:03,200
alert dashboard in any sim oh what

1136
00:42:03,200 --> 00:42:05,119
did i just do um

1137
00:42:05,119 --> 00:42:06,240
oh

1138
00:42:06,240 --> 00:42:09,280
no there we go um so

1139
00:42:09,280 --> 00:42:12,000
when when we apply risk into this risk

1140
00:42:12,000 --> 00:42:14,000
index a separate index just for

1141
00:42:14,000 --> 00:42:15,760
accumulating risk

1142
00:42:15,760 --> 00:42:17,760
what we get is something like this where

1143
00:42:17,760 --> 00:42:21,359
you've got a typical phishing compromise

1144
00:42:21,359 --> 00:42:24,160
this uh this host gets compromised

1145
00:42:24,160 --> 00:42:26,880
starts connecting to other servers

1146
00:42:26,880 --> 00:42:28,880
there were

1147
00:42:28,880 --> 00:42:30,800
alerts that indicated on possibly things

1148
00:42:30,800 --> 00:42:33,839
like powershell um and uh scheduled

1149
00:42:33,839 --> 00:42:37,119
tasks other oddities that by themselves

1150
00:42:37,119 --> 00:42:38,400
maybe would not have caught your

1151
00:42:38,400 --> 00:42:40,400
attention but all together

1152
00:42:40,400 --> 00:42:41,920
you end up with these

1153
00:42:41,920 --> 00:42:43,920
basically super alerts

1154
00:42:43,920 --> 00:42:45,200
where uh

1155
00:42:45,200 --> 00:42:47,359
you can see like a 24-hour threshold or

1156
00:42:47,359 --> 00:42:48,880
a certain number of minor tactics and

1157
00:42:48,880 --> 00:42:50,800
techniques and what the analyst gets and

1158
00:42:50,800 --> 00:42:52,400
god i hope you can see that what the

1159
00:42:52,400 --> 00:42:54,960
analyst gets is a

1160
00:42:54,960 --> 00:42:58,319
set of alerts that even like your intern

1161
00:42:58,319 --> 00:42:59,839
should be able to look at this and

1162
00:42:59,839 --> 00:43:02,880
go whoa okay so we saw a net share we

1163
00:43:02,880 --> 00:43:06,000
saw some who am i some who am i um some

1164
00:43:06,000 --> 00:43:07,599
uh

1165
00:43:07,599 --> 00:43:09,040
a service uh

1166
00:43:09,040 --> 00:43:11,119
account was targeted this should send

1167
00:43:11,119 --> 00:43:13,440
anybody spiky sense tingling right and

1168
00:43:13,440 --> 00:43:14,880
you can do all sorts of things like that

1169
00:43:14,880 --> 00:43:17,200
like um who am i plus a couple other

1170
00:43:17,200 --> 00:43:19,839
commands scene that an attacker would

1171
00:43:19,839 --> 00:43:21,920
usually run that's a great super alert

1172
00:43:21,920 --> 00:43:23,280
right the

1173
00:43:23,280 --> 00:43:25,119
any one of those things like just seeing

1174
00:43:25,119 --> 00:43:27,280
who am i maybe not such a big deal but

1175
00:43:27,280 --> 00:43:28,880
if they're doing who am i and then a net

1176
00:43:28,880 --> 00:43:30,640
stat and then something else well either

1177
00:43:30,640 --> 00:43:32,880
someone's troubleshooting or someone's

1178
00:43:32,880 --> 00:43:34,640
on your system trying to figure out what

1179
00:43:34,640 --> 00:43:37,920
they've got um

1180
00:43:38,800 --> 00:43:41,119
so that's a good one

1181
00:43:41,119 --> 00:43:43,520
uh you can even then map things out

1182
00:43:43,520 --> 00:43:44,720
because you're basically creating

1183
00:43:44,720 --> 00:43:46,880
relationships between everything

1184
00:43:46,880 --> 00:43:48,400
and

1185
00:43:48,400 --> 00:43:52,960
wow okay and that's yeah that's it um so

1186
00:43:52,960 --> 00:43:56,000
with that um don't forget hopefully i've

1187
00:43:56,000 --> 00:44:00,800
given you a lot of great information

1188
00:44:01,280 --> 00:44:04,960
oh come on please

1189
00:44:05,119 --> 00:44:06,160
there we go

1190
00:44:06,160 --> 00:44:07,760
hopefully i've given you a lot of great

1191
00:44:07,760 --> 00:44:10,400
information

1192
00:44:12,720 --> 00:44:14,720
crap all right so

1193
00:44:14,720 --> 00:44:17,280
because only yo can prevent infosec

1194
00:44:17,280 --> 00:44:21,400
dumpster virus thank you very much

1195
00:44:25,119 --> 00:44:28,160
so any questions or even better anybody

1196
00:44:28,160 --> 00:44:30,960
else that's had to like you know

1197
00:44:30,960 --> 00:44:33,359
think of like a clever way to get around

1198
00:44:33,359 --> 00:44:34,800
the fact that we don't have budget to

1199
00:44:34,800 --> 00:44:36,960
secure up a particular environment or a

1200
00:44:36,960 --> 00:44:38,800
particular problem or anything like that

1201
00:44:38,800 --> 00:44:40,800
and or any questions

1202
00:44:40,800 --> 00:44:43,119
no no clever idea there we go okay thank

1203
00:44:43,119 --> 00:44:44,400
you

1204
00:44:44,400 --> 00:44:46,640
what would be your advice on

1205
00:44:46,640 --> 00:44:48,319
documenting some of the honeypots and

1206
00:44:48,319 --> 00:44:49,440
things that you make so that when

1207
00:44:49,440 --> 00:44:51,200
somebody comes in in the future trying

1208
00:44:51,200 --> 00:44:53,520
to fix a problem for like doing pen

1209
00:44:53,520 --> 00:44:54,960
testing

1210
00:44:54,960 --> 00:44:58,240
oh right yeah good point well so for one

1211
00:44:58,240 --> 00:44:59,599
unless you've got a really advanced team

1212
00:44:59,599 --> 00:45:01,119
i wouldn't even go with the honey pots

1213
00:45:01,119 --> 00:45:04,000
there's so much freaking work um oh but

1214
00:45:04,000 --> 00:45:06,000
what i would suggest even better honey

1215
00:45:06,000 --> 00:45:08,079
people so one of my friends came up with

1216
00:45:08,079 --> 00:45:10,640
this idea of creating people like you

1217
00:45:10,640 --> 00:45:12,560
know payroll people on linkedin and

1218
00:45:12,560 --> 00:45:13,440
stuff

1219
00:45:13,440 --> 00:45:16,000
and then when people try to do the oh

1220
00:45:16,000 --> 00:45:17,920
i'm the ceo and you've got to send me

1221
00:45:17,920 --> 00:45:20,160
some money then they'll be like

1222
00:45:20,160 --> 00:45:22,079
okay and it's one of the security guys

1223
00:45:22,079 --> 00:45:23,839
that's having the conversation with them

1224
00:45:23,839 --> 00:45:25,760
and then they'll actually try and log

1225
00:45:25,760 --> 00:45:26,720
into

1226
00:45:26,720 --> 00:45:28,319
the the site that they're going to use

1227
00:45:28,319 --> 00:45:31,040
to try and either do the um the money

1228
00:45:31,040 --> 00:45:32,800
transfer or try and get someone to log

1229
00:45:32,800 --> 00:45:34,560
in or whatever and then they'll say oh

1230
00:45:34,560 --> 00:45:35,920
it's not working

1231
00:45:35,920 --> 00:45:37,839
oh yeah it's our and then they'll give

1232
00:45:37,839 --> 00:45:39,280
them a different environment you know

1233
00:45:39,280 --> 00:45:41,040
like their backup one they're oh yeah

1234
00:45:41,040 --> 00:45:42,720
that's someone didn't you get the money

1235
00:45:42,720 --> 00:45:45,200
yet it's not working

1236
00:45:45,200 --> 00:45:46,800
and they're starting to now enumerate

1237
00:45:46,800 --> 00:45:49,200
the attackers as far as documenting like

1238
00:45:49,200 --> 00:45:51,520
some of the honey token stuff out there

1239
00:45:51,520 --> 00:45:52,400
um

1240
00:45:52,400 --> 00:45:54,720
if if you've got like some sort of sim

1241
00:45:54,720 --> 00:45:56,000
or something like that that would

1242
00:45:56,000 --> 00:45:57,839
probably be the easiest way to annotate

1243
00:45:57,839 --> 00:45:59,599
it because you could just attach the

1244
00:45:59,599 --> 00:46:02,400
notation to uh whatever's significant

1245
00:46:02,400 --> 00:46:04,400
the ip address or the database or

1246
00:46:04,400 --> 00:46:06,960
whatever it is that you've honey token

1247
00:46:06,960 --> 00:46:08,960
and then that should be something

1248
00:46:08,960 --> 00:46:11,280
prominent in the alerts itself so that

1249
00:46:11,280 --> 00:46:12,079
the

1250
00:46:12,079 --> 00:46:14,000
so if you start getting alerts on it

1251
00:46:14,000 --> 00:46:16,319
nobody knows what it is i think that'd

1252
00:46:16,319 --> 00:46:17,599
be probably the easiest place to

1253
00:46:17,599 --> 00:46:19,040
document that right because it will

1254
00:46:19,040 --> 00:46:20,480
always be there

1255
00:46:20,480 --> 00:46:24,000
um great question though anyone else

1256
00:46:24,240 --> 00:46:26,160
nope all right well i think i'm the only

1257
00:46:26,160 --> 00:46:28,560
thing between you and beer so i'm not

1258
00:46:28,560 --> 00:46:30,400
going to stand there very long

1259
00:46:30,400 --> 00:46:32,240
thanks everyone

1260
00:46:32,240 --> 00:46:34,800
and feel free to drop me a note i can

1261
00:46:34,800 --> 00:46:36,240
always get you i think they're going to

1262
00:46:36,240 --> 00:46:38,000
post the slides but i'll happy to send

1263
00:46:38,000 --> 00:46:40,480
it to you too if you want so thanks and

1264
00:46:40,480 --> 00:46:43,839
have a good night

1265
00:46:55,440 --> 00:46:58,440
okay

1266
00:47:10,880 --> 00:47:14,119
thank you

1267
00:47:17,100 --> 00:47:20,350
[Music]

1268
00:47:27,040 --> 00:47:29,119
you

