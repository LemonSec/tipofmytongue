1
00:00:20,500 --> 00:00:24,410
So I'm Johnny Christmas, this is Sam Crowther, we're from Kasada if you couldn't

2
00:00:24,410 --> 00:00:29,060
figure that out, it's pretty obvious.
That's too soon

3
00:00:29,060 --> 00:00:35,330
audience, oh who here works for the
red team in some capacity? Awesome.  About

4
00:00:35,330 --> 00:00:42,339
average. Who's blue team? Who's something completely different? Very cool.

5
00:00:42,340 --> 00:00:45,880
I always like doing the penetration testing, offensive security

6
00:00:45,880 --> 00:00:49,120
talks and seeing how many blue teamers
show up. This amazing because, in reality

7
00:00:49,129 --> 00:00:54,559
you're the guys that this is for. So we
work for a company that is able to

8
00:00:54,560 --> 00:00:58,550
detect the presence of automation
client-side and determine if automation

9
00:00:58,550 --> 00:01:03,160
is being used to leverage an HTTP based
attack against your web applications.

10
00:01:03,160 --> 00:01:08,960
This is the predominant method of attack
on the Internet. Pretty much everything

11
00:01:08,960 --> 00:01:12,919
is automated. Pen detect ,even if it's a
penetration tester. Or you know, human

12
00:01:12,920 --> 00:01:16,700
attacker, they're still using automation
tool kits of some sort to your leverage these

13
00:01:16,700 --> 00:01:20,899
attacks because holy crap, typing an
individual credit card number is super

14
00:01:20,899 --> 00:01:26,119
boring. And we build something really
cool that's able to detect and defend

15
00:01:26,119 --> 00:01:30,320
against that on the very first HTTP
request. And I'm not gonna make this a

16
00:01:30,320 --> 00:01:33,350
sales pitch because we're gonna be
talking about high bypass WAF.

17
00:01:33,350 --> 00:01:41,750
So, super quick, can everybody see this okay? Yeah, I was worried about that. They can't

18
00:01:41,750 --> 00:01:45,350
do anything about the lighting on here
unfortunately. However, I will have the

19
00:01:45,350 --> 00:01:49,939
entire slide deck up, which is super
nutrient rich on my github. I have links

20
00:01:49,939 --> 00:01:53,059
at the end. You guys can try and zoom in,
take pictures, do what you can about this.

21
00:01:53,060 --> 00:01:56,360
In the meantime, we're gonna really
discuss every bullet point that's up here

22
00:01:56,360 --> 00:02:00,320
so, you can't see the slides it means you
get to take some notes because we're

23
00:02:00,320 --> 00:02:06,820
adults, I've been told. Here's a slide on me.
I'm Johnny Christmas, who doesn't know me?

24
00:02:06,820 --> 00:02:10,820
Wow, that's three hands. That's weird, usually it's like half the room.

25
00:02:10,820 --> 00:02:14,810
So, I've done pretty much everything
there is to do from network engineer

26
00:02:14,810 --> 00:02:18,680
to systems engineer, to InfoSec engineer.
InfoSec consultants. Have spent many years as a

27
00:02:18,680 --> 00:02:23,870
penetration tester. And then I spent the
last year or so in the industrial space

28
00:02:23,870 --> 00:02:28,510
as a ICS researcher. Super cool and fun. Every

29
00:02:28,510 --> 00:02:31,329
time I switch jobs, I try to switch
careers and do something I've never done

30
00:02:31,330 --> 00:02:36,040
before. So now I'm working in the vendor
space because Sanic Casada has something

31
00:02:36,040 --> 00:02:41,049
really freaking cool that I wanted to be
apart of. So such I say,  there's some

32
00:02:41,050 --> 00:02:43,360
links on the side if you want to be able
to find me again.

33
00:02:43,360 --> 00:02:46,390
Pictures are totally cool. I do highly
recommend you grab some pictures of

34
00:02:46,390 --> 00:02:49,540
these slides because there's a lot of
information in them. And your phone might

35
00:02:49,540 --> 00:02:55,599
be able to see easier than you can. So Sam, you want to give a brief rundown? -Yeah. My name is Sam. I grew up a few miles

36
00:02:55,599 --> 00:03:07,440
south of the border. [Audience laughs] - Like the Singapore border. - I got started in my career

37
00:03:07,440 --> 00:03:11,680
fortunate enough to work with one of the
groups that do some fun problems.

38
00:03:11,680 --> 00:03:18,280
government and then how many letters did
three years around town might be

39
00:03:18,280 --> 00:03:22,510
allegedly that's what they told me I
thought I was a security engineer and a

40
00:03:22,510 --> 00:03:27,040
rate team up well one of the big
investment banks back in Australia where

41
00:03:27,040 --> 00:03:34,560
I cry every single time I need a test
because miserable and then I left

42
00:03:35,100 --> 00:03:42,370
so let's talk about what website are in
a modern context because the concept of

43
00:03:42,370 --> 00:03:45,870
wife has been around since I want to say
the early 90s I was dealing with wife's

44
00:03:45,870 --> 00:03:53,650
as an armchair hacker 94 95 they've been
around as long as computers about public

45
00:03:53,650 --> 00:03:59,410
IP addresses more or less a lot of us
are really familiar with this kind of

46
00:03:59,410 --> 00:04:05,709
basic law it's usually in that box that
you have on Prem it's it's effectively

47
00:04:05,709 --> 00:04:09,910
using the same methodology that it has
always been using since the 90s which is

48
00:04:09,910 --> 00:04:13,530
it does inspection of your post body
content and it looks for

49
00:04:13,530 --> 00:04:17,370
suspicious-looking strings of
information to say alright is this

50
00:04:17,370 --> 00:04:24,090
simply sqli something like that and then
it just alerts you most mostly all it

51
00:04:24,090 --> 00:04:28,799
can do is just do some IP blacklisting
at absolute best or it just lets you

52
00:04:28,800 --> 00:04:32,070
know and then all you do is you go and
blacklist the a piece of your firewall

53
00:04:32,070 --> 00:04:37,020
which you know we all know is the most
irritating thing to have to do because

54
00:04:37,020 --> 00:04:39,510
you know it's not going to do anything
it's gonna stop they're gonna come back

55
00:04:39,510 --> 00:04:42,780
from somewhere else but that's what your
incident response process says you

56
00:04:42,780 --> 00:04:47,130
should do this we're gonna do do and
then who here spends most of their days

57
00:04:47,130 --> 00:04:52,770
playing IP address black whack-a-mole
just right and it's working on game yeah

58
00:04:52,770 --> 00:04:57,419
it's a great game got me this far I
guess I made me the all-time high score

59
00:04:57,419 --> 00:05:03,240
it just it it's stupid it doesn't work
and we'll get into my later it does it

60
00:05:03,240 --> 00:05:06,539
can sometimes do very basic behavioral
analysis and that's you know you're

61
00:05:06,539 --> 00:05:10,740
talking frequency analysis you're
talking hey this we've seen this IP

62
00:05:10,740 --> 00:05:15,600
address make five posts in the last
three seconds that's probably something

63
00:05:15,600 --> 00:05:19,350
automated that's probably an attack you
should probably do something about it

64
00:05:19,350 --> 00:05:21,870
and that's the best you're going to get
out of this is just guessing based on

65
00:05:21,870 --> 00:05:27,599
that it'll do some kind of fake
fingerprinting based on like user agent

66
00:05:27,599 --> 00:05:31,740
and I think she DB header order and
content and say like oh we know this is

67
00:05:31,740 --> 00:05:35,520
the same person because the user agents
the same or it's not the same person

68
00:05:35,520 --> 00:05:38,849
because the user agent changed so
there's no way it could be the same

69
00:05:38,849 --> 00:05:43,200
person right what you can't make user
agents know is that maybe we'll talk

70
00:05:43,200 --> 00:05:48,300
about that later but we'll dive into
that weird fuzzy realm of faking HTTP

71
00:05:48,300 --> 00:05:55,110
header data later it gets crazy kids but
overall they're they're extremely

72
00:05:55,110 --> 00:05:59,070
trivial to bypass in most cases because
you can just go low and slow and head

73
00:05:59,070 --> 00:06:06,030
right in you can do plenty really cool
obfuscation of your post data to bypass

74
00:06:06,030 --> 00:06:09,510
the screen inspections of the lots are
doing on my favorite examples is who's

75
00:06:09,510 --> 00:06:16,349
he's asking on that great super simple
excellent SQL

76
00:06:16,349 --> 00:06:20,339
who's who's used the loft bypass
mechanism with an SQL map we've seen

77
00:06:20,339 --> 00:06:24,960
this it check it out just do it for no
reason it's a it's a quick switch next

78
00:06:24,960 --> 00:06:27,930
time you're running SQL map just turn on
the waffle option station or the waffle

79
00:06:27,930 --> 00:06:33,389
I know something station I know it's
really hard to tell here this now that's

80
00:06:33,389 --> 00:06:41,839
even worse coolest thing so basically it
just it adds in all kinds of

81
00:06:41,839 --> 00:06:46,889
uninterpreted data in the strings that
the waffle look said it goes nope that's

82
00:06:46,889 --> 00:06:50,639
deaf but it doesn't look like this girl
needs probably fine go ahead and come on

83
00:06:50,639 --> 00:06:54,990
in so i'm brown basic wasps aren't
really useful anymore they're just been

84
00:06:54,990 --> 00:07:06,240
annoying stats up your day but doesn't
mean i'm compliant insecure yes the more

85
00:07:06,240 --> 00:07:11,430
sophisticated class we've been seeing
yes so there was you know a big surge

86
00:07:11,430 --> 00:07:15,449
and stuff like cloud-based wafts right
when we realized going prem on sucks and

87
00:07:15,449 --> 00:07:19,889
it's not scalable a few companies decide
the right let's let's put this in the

88
00:07:19,889 --> 00:07:23,490
cloud because that's how we solve every
single problem these days you want to

89
00:07:23,490 --> 00:07:31,050
list a few that may know what okay
because i'm a shit on my yeah yeah so

90
00:07:31,050 --> 00:07:34,439
it's a mostly mostly reverse proxy
sometimes you know they're more

91
00:07:34,439 --> 00:07:38,159
sophisticated dollar bob check that you
know you can set HTTP headers because

92
00:07:38,159 --> 00:07:42,300
again only browsers can responsibly set
cookies and other headers that they're

93
00:07:42,300 --> 00:07:48,149
they're challenged for and they'll cream
also piece together fingerprints on

94
00:07:48,149 --> 00:07:52,050
particularly the HTTP layers so looking
at right wall you know this has you know

95
00:07:52,050 --> 00:07:56,759
content type except user agent and then
whatever header that's kind of finger

96
00:07:56,759 --> 00:08:00,389
grid on that mint see if we can track
them around again you're trying to track

97
00:08:00,389 --> 00:08:04,139
someone based on something that can be
changed with a single line of code

98
00:08:04,139 --> 00:08:07,409
yeah they're creating fingerprinting
based on things that are they used to be

99
00:08:07,409 --> 00:08:10,680
smooth and easily rotated with every
single request or could easily come from

100
00:08:10,680 --> 00:08:15,269
maturity different companies you may see
this kind of block built into maybe the

101
00:08:15,269 --> 00:08:17,560
CDN that you have already the hive kind
of

102
00:08:17,560 --> 00:08:20,650
they're whatever they call it off when
you turn that and it's like now I have a

103
00:08:20,650 --> 00:08:25,120
wife I guess and fun fact they usually
reversible and what security was it

104
00:08:25,120 --> 00:08:29,950
almost all of the apps are actually one
security with a few custom rules yeah

105
00:08:29,950 --> 00:08:34,689
and a few extra rules and a few extra
line items on your bill yeah it's just

106
00:08:34,690 --> 00:08:40,630
not security so this is predominantly
over or we could be talking about okay

107
00:08:40,630 --> 00:08:49,779
but yet either or they're both pretty
much useless these days for the reasons

108
00:08:49,779 --> 00:08:54,040
that we mentioned they rely on
information willingly provided by the

109
00:08:54,040 --> 00:08:58,360
client which we should always assume is
malicious and then they trust it and

110
00:08:58,360 --> 00:09:04,029
they go no this looks fine to me problem
must be somewhere else so let's let's

111
00:09:04,029 --> 00:09:10,920
talk about how to fight best things as a
penetration tester or something else

112
00:09:10,920 --> 00:09:14,560
someone who's testing your defenses for
one reason or another we're not going to

113
00:09:14,560 --> 00:09:17,890
ask you guys why you're doing this but
you're all here because we're super

114
00:09:17,890 --> 00:09:21,279
interested in that here's the bare
minimums you need this is something you

115
00:09:21,279 --> 00:09:25,900
should be doing every single time
against every single external target

116
00:09:25,900 --> 00:09:29,890
that you have regardless of your
knowledge of what's going on there

117
00:09:29,890 --> 00:09:33,250
this is when you're writing your curl
scripts this is when you're writing your

118
00:09:33,250 --> 00:09:36,010
Python request script something like
this this is what you just need to

119
00:09:36,010 --> 00:09:41,130
always do and I'll go through some
examples but I think you have to see

120
00:09:41,130 --> 00:09:49,360
step first up here who here has a
without business that totally lets them

121
00:09:49,360 --> 00:09:57,070
block residential IDs don't be shy it's
literally nobody right nobody's business

122
00:09:57,070 --> 00:10:01,300
is going on the clock residential I
think why because the potential for that

123
00:10:01,300 --> 00:10:06,550
being a paying customer is super high so
what should we be doing if we're trying

124
00:10:06,550 --> 00:10:11,319
to break into somewhere use residential
I'd nice well how my residential it

125
00:10:11,320 --> 00:10:15,350
means what's that residual IP cost like
for you what kind

126
00:10:15,350 --> 00:10:23,270
suppose Comcast want that 60 bucks per
ID per month it's insane for this we're

127
00:10:23,270 --> 00:10:27,140
like one Comcast and then public I'd be
at the game I drop these Comcast

128
00:10:27,140 --> 00:10:31,250
business and she's like 100 bucks a
month minimum and then you got a five to

129
00:10:31,250 --> 00:10:35,080
ten bucks per that's nuts so then the
other got one I beat to our piece well

130
00:10:35,080 --> 00:10:41,150
something else you can do is just rent
an entire IP block from any other

131
00:10:41,150 --> 00:10:46,970
companies that are out there that let
you least those two of my favorites are

132
00:10:46,970 --> 00:10:53,300
monkey socks and who wants to guess
where monkey socks Illuminati get the

133
00:10:53,300 --> 00:10:59,870
residential a piece from free VPN three
free VPNs we're gonna wait it's not

134
00:10:59,870 --> 00:11:03,590
malware what do we call that this
potentially unwanted program

135
00:11:03,590 --> 00:11:07,280
so is he most of us the service did you
agree to it he said yes yes crawl to me

136
00:11:07,280 --> 00:11:10,520
check the checkbox this is super easy
check the Terms of Service we'll check

137
00:11:10,520 --> 00:11:14,329
the Terms of Service and everything you
run right that's that's every Monday and

138
00:11:14,330 --> 00:11:17,410
Tuesday my weakest is reading the Terms
of Service and whether or not they

139
00:11:17,410 --> 00:11:21,890
monkey socks Illuminati have some really
fun ones that say by using personnel

140
00:11:21,890 --> 00:11:27,110
illuminati wishes says who is hold on
BPM goodness hole up at the end it's

141
00:11:27,110 --> 00:11:31,040
commonly used to get television shows in
other countries most often especially if

142
00:11:31,040 --> 00:11:35,439
you're watching sports cricket football

143
00:11:35,710 --> 00:11:40,460
part of the Terms of Service says hey by
using our free VPN you agree to let us

144
00:11:40,460 --> 00:11:45,470
use your computer as effectively a
negative exit note just like a tor exit

145
00:11:45,470 --> 00:11:51,170
note so that random crap comes out of it
you're effectively allowing botnets to

146
00:11:51,170 --> 00:11:54,290
use you as one of their sources you're
hosting malware

147
00:11:54,290 --> 00:11:57,170
you're hosting malicious activity from
your home and you have no idea because

148
00:11:57,170 --> 00:12:02,270
you're just watching a cricket match in
India monkey socks is super cool because

149
00:12:02,270 --> 00:12:07,819
they actually have an SDK that they sell
and then if you want to make a free app

150
00:12:07,820 --> 00:12:11,870
firt and you know the free android app
but you still want to monetize it you

151
00:12:11,870 --> 00:12:14,420
throw the money monkey socks SDK in and
what it does

152
00:12:14,420 --> 00:12:20,269
that re uses existing connections in
your phone to also do this thing then

153
00:12:20,269 --> 00:12:23,990
they use as an exit node for these
botnets so this is how like so many

154
00:12:23,990 --> 00:12:28,339
Android phones are operating as these
botnet appeals like how is it happening

155
00:12:28,339 --> 00:12:33,320
but Bauman's not infected the phones
aren't infected you agree to install

156
00:12:33,320 --> 00:12:36,500
this software in that the app is
required to put this little blurb inside

157
00:12:36,500 --> 00:12:40,699
that's easier by you to check the monkey
stocks XDK it actually provides the text

158
00:12:40,699 --> 00:12:43,729
early clue that says please add this two
terms of service that's the most

159
00:12:43,730 --> 00:12:47,870
terrifying thing and it makes the hair
the bathroom that bristle this is going

160
00:12:47,870 --> 00:12:52,399
on so they may be so illuminati is jolla
VPN so you go to them you got a monkey

161
00:12:52,399 --> 00:12:55,699
socks you go I need X number of
residential like these for this amount

162
00:12:55,699 --> 00:13:00,769
of time you came a couple of bucks and
now you are loaded up with effectively

163
00:13:00,769 --> 00:13:05,540
on black list of all my keys eventually
Goethe says bars to give you a refund

164
00:13:05,540 --> 00:13:10,819
easy are enemies of laws and you can pay
me more and get mobile of residential

165
00:13:10,820 --> 00:13:31,070
networks as well yeah guaranteed that's
great if you look at a request that

166
00:13:31,070 --> 00:13:34,100
comes through the hole of a peon yeah
there's literally an X that's all ahead

167
00:13:34,100 --> 00:13:39,740
up so it's very difficult to detect if
you want to block the whole uh VPN

168
00:13:39,740 --> 00:13:43,699
appease you can look for that next
sexuality being hunter but you're still

169
00:13:43,699 --> 00:13:47,120
at risk of running into the business
because also locking Hannah's used for

170
00:13:47,120 --> 00:13:51,500
legitimate legitimate purposes very good
you are at risk of blocking users so

171
00:13:51,500 --> 00:13:55,850
that's it have fun fighting that fight
so now we have effectively have an

172
00:13:55,850 --> 00:14:00,890
infinite number of unblockable IDs we've
defeated the only line of defense pretty

173
00:14:00,890 --> 00:14:04,040
much everyone in this room said they
have against this is the IP waggle your

174
00:14:04,040 --> 00:14:08,779
dad okay I think you leave loominatee is
super easy to like plug into almost any

175
00:14:08,779 --> 00:14:14,360
app that you build like even burning
during the job plumbing which is

176
00:14:14,360 --> 00:14:17,450
phenomenal
yeah it's it's the best there's there's

177
00:14:17,450 --> 00:14:21,080
JavaScript libraries it's Python
libraries for loominatee don't worry

178
00:14:21,080 --> 00:14:24,500
about it I'm not even going to demo the
code it's super simple and also you know

179
00:14:24,500 --> 00:14:32,839
there's time after that make sure you're
rotating your user agent this is a thing

180
00:14:32,839 --> 00:14:38,660
you can do who does so like everyone's
smooth their user agent right there's

181
00:14:38,660 --> 00:14:41,930
like an infinite number of plug-ins for
every single browser out there that lets

182
00:14:41,930 --> 00:14:46,339
you create your user agent who knows how
many use valid user agents there are

183
00:14:46,339 --> 00:14:52,459
known to be out there me neither it's in
the thousands I compile the list it's um

184
00:14:52,459 --> 00:14:56,540
I give up so you need a list of all user
agents at a flight text for minutes I

185
00:14:56,540 --> 00:15:04,939
make it happen later because I use it
rotate that so much loft based

186
00:15:04,940 --> 00:15:09,770
blacklisting go and whitelisting
operates just based on user agent or

187
00:15:09,770 --> 00:15:16,310
user agent and one other easily smooth
the whole thing so you can hide yourself

188
00:15:16,310 --> 00:15:20,270
from being detected as like the same
person so you're dodging behavioral

189
00:15:20,270 --> 00:15:24,620
analysis by every time you send a new
request is from a new ID with a new user

190
00:15:24,620 --> 00:15:28,430
agent header nothing catches it or if
everything you're doing is getting

191
00:15:28,430 --> 00:15:34,099
blocked you may be attacking a very
lockdown edge device that may have user

192
00:15:34,100 --> 00:15:38,029
agent whitelisting set up where they're
expecting only say some kind of

193
00:15:38,029 --> 00:15:42,050
automated process that they've built to
connect which as a custom user agent or

194
00:15:42,050 --> 00:15:47,510
uses some penance it's very specific
user agent you can scroll through 4,000

195
00:15:47,510 --> 00:15:53,980
user agents until you find the ones that
are a lot there and then go from there

196
00:15:53,980 --> 00:16:00,770
typically monitoring software is a good
place to start with that oh yeah yeah

197
00:16:00,770 --> 00:16:04,130
any kind of like heart be there uptime
monitoring software smooth those smooth

198
00:16:04,130 --> 00:16:06,430
those user agents because everyone
whiteness

199
00:16:06,430 --> 00:16:09,729
because we need them to get in to make
sure our websites out well now you're

200
00:16:09,730 --> 00:16:12,899
telling them but that's who I am and
they just blindly trust this crap

201
00:16:12,899 --> 00:16:18,100
because they use it before the symposium
as well and again rotate all of this

202
00:16:18,100 --> 00:16:21,880
every time you make a request if it's
possible for what you're doing sometimes

203
00:16:21,880 --> 00:16:26,649
that'll break a few things but
definitely give it a try also this is

204
00:16:26,649 --> 00:16:31,510
something I see a lot of people miss U's
cookies and there's there's that so

205
00:16:31,510 --> 00:16:39,040
that's a wide recommendation authorized
sessions so the sessions you can walk to

206
00:16:39,040 --> 00:16:43,390
and then get you know your session
cookie from that often has a lot more

207
00:16:43,390 --> 00:16:47,649
lenient behavioral analytics going on
behind that you can often get away get

208
00:16:47,649 --> 00:16:52,320
away with a lot more requests per IP or
this and that if you have a valid

209
00:16:52,320 --> 00:16:58,029
authenticated cookie going on there and
usually it's as easy as just putting a

210
00:16:58,029 --> 00:17:01,320
fake account on whatever the site is and
then grab them to Cody in rolling

211
00:17:01,320 --> 00:17:04,630
sometimes there are certain session
cookies that are absolutely required or

212
00:17:04,630 --> 00:17:08,980
you're not getting anything so that's of
course critical but also watch out for

213
00:17:08,980 --> 00:17:14,410
these sneaky sophisticated web cookies
that a few vendors use where they'll

214
00:17:14,410 --> 00:17:17,319
inject them into the responses and then
your browser will start using them

215
00:17:17,319 --> 00:17:21,220
regularly and then actually helps them
track your behavior so even if you are

216
00:17:21,220 --> 00:17:25,240
rotating everything else the fact that
you keep sending back this cookie with

217
00:17:25,240 --> 00:17:29,110
every single request lets them know hey
this is still the same person and it

218
00:17:29,110 --> 00:17:32,709
starts wrapping up your analytics totals
and then you're going to be busted so

219
00:17:32,710 --> 00:17:35,710
that takes a little inspection and
eyeballing of the traffic that you have

220
00:17:35,710 --> 00:17:40,540
going back and forth but that's very
much one of the options that simply want

221
00:17:40,540 --> 00:17:45,070
to use and sometimes it is as simple as
just making sure you don't provide that

222
00:17:45,070 --> 00:17:48,970
cookie when you send the next require
for requesting like certain cloud-based

223
00:17:48,970 --> 00:17:53,860
watch providers or just if they cookies
not there it assumes you're new but then

224
00:17:53,860 --> 00:17:56,860
again some requirement so this is where
it takes a little bit of playing around

225
00:17:56,860 --> 00:18:01,449
I think the end of that yeah we'll talk
about in a bit but you can call them

226
00:18:01,450 --> 00:18:03,429
they sweeten something like a phantom
cast or

227
00:18:03,429 --> 00:18:06,489
like endless growth a puppet to you
where you can what page hopefully

228
00:18:06,489 --> 00:18:09,639
because outlet shopping straight into
another tool

229
00:18:09,639 --> 00:18:15,488
yeah well that's look at that later on
so this is again this is all the basic

230
00:18:15,489 --> 00:18:19,539
stuff this is what you should at least
be doing and this is in any code you're

231
00:18:19,539 --> 00:18:23,049
writing this is your little JavaScript
your curly or Python whatever at the

232
00:18:23,049 --> 00:18:27,789
very least do this and this is going to
bypass what percentage of these

233
00:18:27,789 --> 00:18:34,450
sophisticated locks I think basically
all of them it's it's ridiculous this is

234
00:18:34,450 --> 00:18:38,349
something that we discovered recently
and it's just it's ridiculous how many

235
00:18:38,349 --> 00:18:42,609
people don't try this how many attacks
out there a human at Bob are just not

236
00:18:42,609 --> 00:18:47,080
employing these tactics that are super
easy to do and then they go up I guess

237
00:18:47,080 --> 00:18:50,619
they have defenses that we can't get
past and they just go away if we saw

238
00:18:50,619 --> 00:18:54,668
someone try to bring false credentials
on website which they should have

239
00:18:54,669 --> 00:18:57,999
probably Samantha needs to make
literally using Python as the easier and

240
00:18:57,999 --> 00:19:04,960
you know yeah just do the fuck you ain't
for Python request library so what I

241
00:19:04,960 --> 00:19:09,099
will do for you here and I know it's
kind of hard to see but I'm gonna try

242
00:19:09,099 --> 00:19:13,779
walking through to anyway I have who was
anybody half cuz Canada last year

243
00:19:13,779 --> 00:19:20,729
probably not that's it so I was at
Heco's Canada last November and I

244
00:19:21,539 --> 00:19:39,789
computers I know this is tough but I'll
just okay so I've got an open mic github

245
00:19:39,789 --> 00:19:44,799
there is a Python script I wrote so you
scrape the fentanyl public few remembers

246
00:19:44,799 --> 00:19:48,729
the whole fennel debacle that happened
last summer where the everyone was like

247
00:19:48,729 --> 00:19:53,229
oh my god the feed is public I can
everyone can see what I'm spending money

248
00:19:53,229 --> 00:19:58,360
on and who I'm sending money to and then
I was like yes

249
00:19:58,360 --> 00:20:04,449
like fine and all the media got on them
and memo was like yeah the users want us

250
00:20:04,450 --> 00:20:07,899
to stop it we'll stop it and then they
didn't anyway so I wrote it to a bet

251
00:20:07,899 --> 00:20:12,489
we'll scrape that public feed but venmo
has a lot of controls going on to

252
00:20:12,490 --> 00:20:19,210
prevent you from doing them because that
okay so if you check out my github look

253
00:20:19,210 --> 00:20:22,929
at the deep end mo Michael it's been
more than even a scraper and in there

254
00:20:22,929 --> 00:20:27,039
you'll see not only I wrote a system
here on top that goes in and

255
00:20:27,039 --> 00:20:32,740
authenticates against their login page
and actually exploit something I found

256
00:20:32,740 --> 00:20:38,230
where they will issue an authenticated
session token prior to a new account

257
00:20:38,230 --> 00:20:44,110
being confirmed so effectively you can
just flooded with new account creation

258
00:20:44,110 --> 00:20:49,059
all day and it will give you valid
session tokens even if you don't go into

259
00:20:49,059 --> 00:20:52,120
your email and confirm it so you flood
it which is fake email addresses and

260
00:20:52,120 --> 00:20:56,860
fake information you do need a phone
number that hasn't been used over and I

261
00:20:56,860 --> 00:20:59,529
you can go look at my head cuz can't
even talk it really goes through this

262
00:20:59,529 --> 00:21:03,100
but I ended up accidentally blacklisting
wait just thousands of people's phone

263
00:21:03,100 --> 00:21:07,360
numbers so if you try to find register
for Bend on your phone it was like this

264
00:21:07,360 --> 00:21:16,719
numbers already in use apologies I hope
any event owe you another cookie and

265
00:21:16,720 --> 00:21:21,240
then he used that and I found that that
let me use way more requests to the API

266
00:21:21,240 --> 00:21:25,809
per IP address versus not having that so
it makes you have to rotate those like

267
00:21:25,809 --> 00:21:32,379
diesel s less which is super handy and
then further down can you guys see this

268
00:21:32,380 --> 00:21:34,169
at all there's this a total waste of
time

269
00:21:34,169 --> 00:21:38,230
okay well so I need for the way down
there's another function in there that

270
00:21:38,230 --> 00:21:41,649
shows you that rotates on the user-agent
header so you can go ahead and grab that

271
00:21:41,649 --> 00:21:45,189
for my code and plug that into whatever
you have you can grab most of this and

272
00:21:45,190 --> 00:21:48,340
plug that into whatever you have and
it's going to be useful and I even have

273
00:21:48,340 --> 00:21:53,769
the full list of like 5,000 some user
agents inside that github so you can

274
00:21:53,769 --> 00:21:56,919
just literally grab this block of code
and now that's your user agents which

275
00:21:56,919 --> 00:22:01,750
are rotator I did that for you so that's
enough of the super boring code demo

276
00:22:01,750 --> 00:22:07,720
that no one can see let's let's go back
to time I wonder what's next is this

277
00:22:07,720 --> 00:22:10,870
useful you guys digging this yeah are
you guys surprised at how easy is that

278
00:22:10,870 --> 00:22:17,549
this is and upset no I like to know who

279
00:22:20,309 --> 00:22:25,360
already has ideas of what they're gonna
use this for now I didn't know when he

280
00:22:25,360 --> 00:22:30,668
wants to put a hand up alright so like
that's all your basic stuff that's

281
00:22:30,669 --> 00:22:34,870
that's gonna get you past well I guess
we said it literally everything

282
00:22:34,870 --> 00:22:40,959
basically everything but anyway let's
talk about some advanced stuff you can

283
00:22:40,960 --> 00:22:57,880
do in 2021 then stuff no longer works I
guess I don't know they disrupt so when

284
00:22:57,880 --> 00:23:04,720
someone disrupts this industry like
someone we know who has a new idea of

285
00:23:04,720 --> 00:23:09,250
how to defend against these attacks
maybe we'll talk about that later Hoshi

286
00:23:09,250 --> 00:23:12,580
you see this is the the man they busted
into the convenience store with a bunch

287
00:23:12,580 --> 00:23:17,799
of ostriches and Lucien are craftsmen
totally expected how do you fight

288
00:23:17,799 --> 00:23:20,790
against it even if you are armed and
ready for someone to break in

289
00:23:20,790 --> 00:23:25,790
a luchador busting with a bunch of
ostriches you're not ready you just

290
00:23:25,790 --> 00:23:32,550
don't understand splitting this workout
yeah this is enough so yeah so the trick

291
00:23:32,550 --> 00:23:38,419
is the trick here is to be both Volusion
torn and the ostriches write that down

292
00:23:38,420 --> 00:23:47,190
we come at them with everything that was
not expected so say you're up against

293
00:23:47,190 --> 00:23:51,060
something that you just can't get around
you can't figure out how it's blocking

294
00:23:51,060 --> 00:23:56,669
in this is going to be basically your
attempt at this is going to be the hard

295
00:23:56,670 --> 00:24:00,440
and slow path but it's got to be what's
necessary at this point this is

296
00:24:00,440 --> 00:24:07,250
information that's what you're looking
at mostly here is your general edge

297
00:24:07,250 --> 00:24:13,380
enumeration process and then even before
the event esters in here cool think it's

298
00:24:13,380 --> 00:24:18,030
more over here that's me
so this is this is a contempt if you're

299
00:24:18,030 --> 00:24:21,000
not familiar all these this is not a
figure out what's going on on the

300
00:24:21,000 --> 00:24:25,380
clients edge and everybody's running
blue team you just need inventory this

301
00:24:25,380 --> 00:24:28,830
is also something you should be doing
instead of just trusting what IT gives

302
00:24:28,830 --> 00:24:32,970
you as a list of servers they have this
thing to the internet you gonna want to

303
00:24:32,970 --> 00:24:37,590
find the essence that the target owns
and you can usually do that by two to

304
00:24:37,590 --> 00:24:41,730
three really quick errand well because
we know Zarin this should be everybody

305
00:24:41,730 --> 00:24:45,810
so Aaron is the american Registry of
Internet numbers that keeps track of who

306
00:24:45,810 --> 00:24:50,250
owns what IP addresses mostly so it's a
great place for the query for Americans

307
00:24:50,250 --> 00:24:54,870
at least you find domains owned by the
target and then you plug them back in

308
00:24:54,870 --> 00:24:57,510
Aaron again you just compile all these
IP blocks that they have but he just

309
00:24:57,510 --> 00:25:01,650
kind of lives like you've lost and will
get everything that's out there and then

310
00:25:01,650 --> 00:25:04,770
you maneuvering everything that's up
that as a web web server listening

311
00:25:04,770 --> 00:25:08,120
because we're talking about HTTP here
we're talking about layer seven class

312
00:25:08,120 --> 00:25:14,729
and then you go from there
I wrote a tool and a couple of companies

313
00:25:14,730 --> 00:25:18,050
ago called stand here again scam
Canada's up on my github

314
00:25:18,050 --> 00:25:23,120
to do most of this enumeration when
you're dealing with massive global

315
00:25:23,120 --> 00:25:27,709
entities so it's up there and you can
use that and it does the air lookups and

316
00:25:27,710 --> 00:25:32,030
it gives you a whole ton of flat classes
here's all the web servers and you can

317
00:25:32,030 --> 00:25:34,910
take that list of web servers and you
can plug it into an audit some

318
00:25:34,910 --> 00:25:37,280
automation your browser to load all
those pages and then what you're going

319
00:25:37,280 --> 00:25:40,580
to do is going to look for the forms
you're going to look for whatever you're

320
00:25:40,580 --> 00:25:45,439
trying to exploit is it a login portal
is it a customer loyalty program portal

321
00:25:45,440 --> 00:25:48,620
is it something where you have a text
box where you just want to fill out a

322
00:25:48,620 --> 00:25:54,429
bunch of information into that site
you're going to go through DNS as well

323
00:25:54,430 --> 00:25:59,960
and this is pretty much the same thing
but then you've got your reverse lookup

324
00:25:59,960 --> 00:26:03,680
on the IPS that you discover that are
listening you find out keys that are up

325
00:26:03,680 --> 00:26:07,430
in those air locks your reverse up keys
to find domain or subdomain that were

326
00:26:07,430 --> 00:26:11,180
registered to those and start doing this
process again against no see where those

327
00:26:11,180 --> 00:26:16,250
ended ups and then also like look at the
nomenclature used in these can you guess

328
00:26:16,250 --> 00:26:20,150
other server names that might this
company might use based on the ones

329
00:26:20,150 --> 00:26:24,170
you're already looking and trying
furring a lot of this stuff look at gns

330
00:26:24,170 --> 00:26:27,380
history look at try to do dns zone
transfers who knows what a sudden

331
00:26:27,380 --> 00:26:32,720
transference this is super common you
can believe how many public DNS servers

332
00:26:32,720 --> 00:26:37,450
are susceptible to its own transfers
effectively allows you to dump every

333
00:26:37,450 --> 00:26:40,970
registered name for every IP address
that they have you just ask for it it

334
00:26:40,970 --> 00:26:46,130
goes to there you go and so there you go
and then you and then you can even start

335
00:26:46,130 --> 00:26:49,160
doing your dad's name fuzzing there's no
end of tools out there that'll let you

336
00:26:49,160 --> 00:26:52,820
do that and that's just literally
punching like throwing everything in a

337
00:26:52,820 --> 00:26:56,629
DNS server and seeing what responds to
the purpose of this is we're trying to

338
00:26:56,630 --> 00:27:02,150
find the the actual edge of this company
not that reported edge you're trying to

339
00:27:02,150 --> 00:27:06,740
find the origin servers because you're
going to try to attack those directly

340
00:27:06,740 --> 00:27:09,860
instead of having your traffic forced
through the wall so what you're doing is

341
00:27:09,860 --> 00:27:13,010
you've got the super-complicated wofe
that's just stopping every attempt you

342
00:27:13,010 --> 00:27:17,750
have so go around it figure out how to
route your traffic around it by doing

343
00:27:17,750 --> 00:27:22,070
this if you can find an origin and if
you can get a packet to that virgin you

344
00:27:22,070 --> 00:27:24,789
beat the lock it's used
it's out of the picture you're talking

345
00:27:24,789 --> 00:27:28,150
right to the origin and that's a real
common to because a lot of people don't

346
00:27:28,150 --> 00:27:32,350
put up proper firewall rules in front of
those origins they say oh we got a lock

347
00:27:32,350 --> 00:27:35,709
protecting this web server now and all
that traffic goes through there and it

348
00:27:35,710 --> 00:27:40,360
stops all the bots but they didn't think
to make sure only that wall can talk to

349
00:27:40,360 --> 00:27:52,979
the origin so I could just go to the
origin done do you have this one yeah

350
00:27:53,429 --> 00:28:00,760
rabbit notes is super useful
when some of your attacks again through

351
00:28:00,760 --> 00:28:06,129
but you know optimally like 10 or 15
requests they stop when you build a

352
00:28:06,130 --> 00:28:09,669
distributed system it's very very
difficult you know you can literally the

353
00:28:09,669 --> 00:28:14,860
global system to actually sync every
single edge node from like a just

354
00:28:14,860 --> 00:28:19,120
something as simple as how many requests
in a Chinese name so if you can map out

355
00:28:19,120 --> 00:28:25,299
all the edge notes for a given
cloud-based solution and smash them

356
00:28:25,299 --> 00:28:29,559
sequentially as soon as one gets locked
you may or may not find that you will

357
00:28:29,559 --> 00:28:33,940
get more requests through than you
initially put you shouldn't and some of

358
00:28:33,940 --> 00:28:38,500
these may be up like a 15 minute
rotation and you may be able to do again

359
00:28:38,500 --> 00:28:41,260
every 15 minutes
yeah so it's not actual round-robin were

360
00:28:41,260 --> 00:28:44,890
you sending one request per note per
woth know that you found each time

361
00:28:44,890 --> 00:28:48,340
you're sending all them to one and then
once that starts blocking then you send

362
00:28:48,340 --> 00:28:52,480
it to the next because of that delay in
syncing all of the block information

363
00:28:52,480 --> 00:28:55,809
between the three of them and that's
usually they're not 15 minutes well for

364
00:28:55,809 --> 00:29:00,789
somebody who's on it's a 15-minute delay
that sync happens every 15 minutes so

365
00:29:00,789 --> 00:29:06,129
you can plug the first lock moment get
blocked just go to the next one who has

366
00:29:06,130 --> 00:29:09,580
no idea that that same vendor has
blocked you

367
00:29:09,580 --> 00:29:13,060
elsewhere because they only sync every
15 minutes and then this negative sign

368
00:29:13,060 --> 00:29:16,179
because it's often like I'm massive list
and as you just need to paint one

369
00:29:16,180 --> 00:29:21,970
additional Center UID and you do it all
again on the emptiness origin side of

370
00:29:21,970 --> 00:29:24,730
things as well that's probably the one
of the best techniques like if you could

371
00:29:24,730 --> 00:29:30,250
use DNS these three chicks and figure
out what the origin server may be there

372
00:29:30,250 --> 00:29:35,380
may be other ways to do it if you do
some googly but yes it's very reasonable

373
00:29:35,380 --> 00:29:39,430
because doesn't matter how good you want
in black bees if you can just access

374
00:29:39,430 --> 00:29:46,350
that stuff directly talking about your
LDAP rules themselves

375
00:29:46,350 --> 00:29:50,230
CBN's who who managed the CDN der has
managed a CDN in the past you're

376
00:29:50,230 --> 00:29:55,000
familiar with the CDN set up not many
people go what if you're a real quick

377
00:29:55,000 --> 00:30:04,030
CBN's are content they're basically used
to take the load off your origin servers

378
00:30:04,030 --> 00:30:07,270
they cache a whole bunch of stuff but
it's it's your images and videos and

379
00:30:07,270 --> 00:30:10,990
crap that you don't want to have to
constantly serve as these high bandwidth

380
00:30:10,990 --> 00:30:15,100
items then also don't change that
outside of your website so your traffic

381
00:30:15,100 --> 00:30:19,030
will hit the CDN first and the CDN will
give them all the images and prepa that

382
00:30:19,030 --> 00:30:21,850
would be for and then it will send the
rest of the requests that it can fulfill

383
00:30:21,850 --> 00:30:26,649
that's your word it knows what I mean by
origin by the way that's so origin means

384
00:30:26,650 --> 00:30:30,550
the web servers the web's the actual web
server running on your edge that serves

385
00:30:30,550 --> 00:30:35,139
that when you update the website that's
the thing that gets updated yeah one of

386
00:30:35,140 --> 00:30:38,890
these simians have gone really really
sophisticated and people have started

387
00:30:38,890 --> 00:30:43,630
putting their whacks at that same way up
one of them will get some problems but

388
00:30:43,630 --> 00:30:47,160
common implementation profiles which is
something you definitely check for is

389
00:30:47,160 --> 00:30:51,010
different particles maybe hitting
different origin zones will be treated

390
00:30:51,010 --> 00:30:53,790
slightly differently in more than not
they'll actually have different

391
00:30:53,790 --> 00:30:59,200
configurations for amount of security
and blogging perspective so if you can

392
00:30:59,200 --> 00:31:03,460
test many /login may be treated
completely differently to slash register

393
00:31:03,460 --> 00:31:06,730
for example if they different back-end
apps yeah what he's saying is there's

394
00:31:06,730 --> 00:31:10,990
rules per URL path and
CDNs and oftentimes those are

395
00:31:10,990 --> 00:31:15,280
implemented to troubleshoot an issue
like given a web application you find

396
00:31:15,280 --> 00:31:20,320
that when the requests were coming
through the CDN it wasn't fulfilling

397
00:31:20,320 --> 00:31:24,909
them properly so you quickly one listed
it in your CD and slash web so that it

398
00:31:24,910 --> 00:31:28,600
would just work anyone stopping any
customers and you'll get to that later

399
00:31:28,600 --> 00:31:32,139
or the web app team is currently trying
to figure out what the problem is it in

400
00:31:32,140 --> 00:31:35,410
the meantime we've white listed all of
that and so you can use that to find

401
00:31:35,410 --> 00:31:39,790
these natural white listed URL paths so
you can follow us through individual URL

402
00:31:39,790 --> 00:31:46,570
paths and find that oh wait my traffic
gets through of my hip this look for so

403
00:31:46,570 --> 00:31:51,909
look for other wordles
or other pages or paths within that same

404
00:31:51,910 --> 00:31:56,470
domain and maybe hosting something else
you can use for your goal so say you're

405
00:31:56,470 --> 00:32:01,870
trying to find a login that you want a
brief force look for other portals on

406
00:32:01,870 --> 00:32:06,370
that domain that may have these white
listed path rules going on so you might

407
00:32:06,370 --> 00:32:09,370
be getting blocked at one and they find
something else in it small things in the

408
00:32:09,370 --> 00:32:13,510
same database so that's great and then
also it's been white listed for whatever

409
00:32:13,510 --> 00:32:17,770
reason maybe it's a super old portal
that was created to support your your

410
00:32:17,770 --> 00:32:23,820
ie6 users which are still out there and
you come across these things bananas and

411
00:32:23,820 --> 00:32:27,220
long story short for whatever reason you
had to whitelist it

412
00:32:27,220 --> 00:32:30,910
so like fuzzing URL paths the super
important here don't don't give up just

413
00:32:30,910 --> 00:32:34,929
because you're getting blocked right out
of the gate again some may be accidental

414
00:32:34,929 --> 00:32:40,090
or intentionally unprotected we've all
accidentally made whitelisting rules

415
00:32:40,090 --> 00:32:45,399
right with all accidentally made it
blacklisting rules that let way too many

416
00:32:45,400 --> 00:32:49,570
people in or stop too many people from
getting in we've all done it it happens

417
00:32:49,570 --> 00:32:54,040
a lot it's out there assume it's out
there go find it the other side of it as

418
00:32:54,040 --> 00:32:58,300
well as most of the time at least in
organizations I've been a part of is

419
00:32:58,300 --> 00:33:01,649
whenever there's a new code push the
wife I'll have to go back

420
00:33:01,650 --> 00:33:07,440
learning mode because there may be use
data and like boy you feel Stinson if

421
00:33:07,440 --> 00:33:10,740
you can figure out what your
organization's doing these pushes that

422
00:33:10,740 --> 00:33:14,730
could be put up to time you will attest
because that all behavioral analytics

423
00:33:14,730 --> 00:33:18,150
just set back to zero
and you can start again yeah fun stuff

424
00:33:18,150 --> 00:33:23,340
and then like finally try to find a name
like if you're trying to say this is

425
00:33:23,340 --> 00:33:26,520
mostly for scraping data but also can't
often and use for authentication

426
00:33:26,520 --> 00:33:32,550
sometimes or pretty much anything if
there's an API that lets you do what you

427
00:33:32,550 --> 00:33:35,550
want to do try hitting the API instead
write something that interacts directly

428
00:33:35,550 --> 00:33:41,280
that API often times you'll find that
API is not protected the full website

429
00:33:41,280 --> 00:33:45,720
the web application will be protected
and then the API is just completely open

430
00:33:45,720 --> 00:33:49,679
facing the internet because they don't
expect you to connect to it because only

431
00:33:49,679 --> 00:33:52,740
mobile app is supposed to protect her
only the register official mobile app is

432
00:33:52,740 --> 00:33:55,140
supposed to connect to this API so we
don't have to protect it

433
00:33:55,140 --> 00:33:58,290
there's a lot of class that can't even
fill some API traffic like they just

434
00:33:58,290 --> 00:34:04,020
like on JSON what it's meant to be
application code of Jason he's the guy

435
00:34:04,020 --> 00:34:09,719
with the app so it's fine let Jason it's
great yeah so look with the API I'm like

436
00:34:09,719 --> 00:34:14,279
yeah like Sam said oftentimes it's
geared or the clients or the customers

437
00:34:14,280 --> 00:34:21,929
may not support API protection don't hit
it that's it then you hit that with curl

438
00:34:21,929 --> 00:34:32,460
at that point you don't have to write
take shit yeah or do whatever do

439
00:34:32,460 --> 00:34:36,210
whatever you want yeah like again most
mobile apps use an API that has to be

440
00:34:36,210 --> 00:34:40,379
hosted on the Internet and everyone's
going to be mobile apps for stupid

441
00:34:40,379 --> 00:34:49,440
reasons now so let's see what we're
gonna find the origins we talked about

442
00:34:49,440 --> 00:34:53,659
that you're using tips for finding the
or

443
00:34:53,659 --> 00:35:00,920
a lot of times these origins are
obfuscated and they can be outdated by

444
00:35:00,920 --> 00:35:05,780
using 1/2 or some kind of UUID and so if
you can at least find a few of these

445
00:35:05,780 --> 00:35:09,290
when you're doing this DNS lookups this
DNS zone transfers whatever it is where

446
00:35:09,290 --> 00:35:13,220
are these weird ripples or characters
there's probably intentionally an

447
00:35:13,220 --> 00:35:17,810
obfuscated origin server trying to
figure out what the nomenclature is for

448
00:35:17,810 --> 00:35:20,570
that is it a type of passionately
generate then you can you know start

449
00:35:20,570 --> 00:35:25,130
just generating hashes and brute forcing
it at that point if it's you're kind of

450
00:35:25,130 --> 00:35:28,430
pushing your luck at this point but it's
something you can do yeah if they're

451
00:35:28,430 --> 00:35:31,940
running on like a public cloud provider
what you can also do is just smash that

452
00:35:31,940 --> 00:35:36,320
public cloud providers IP space below
balances with the HTTP host him that

453
00:35:36,320 --> 00:35:41,180
you're expecting to send or from them
what eventually you'll get a hit and

454
00:35:41,180 --> 00:35:47,720
then this gets this gets a little weird
because it's contradictory like I said

455
00:35:47,720 --> 00:35:52,279
before you can look for and block these
a lot of these wasps will inject

456
00:35:52,280 --> 00:35:56,030
JavaScript into the responses that are
fingerprinting mechanisms or something

457
00:35:56,030 --> 00:36:00,740
of that sort and they required those to
be run to prove that you're an actual

458
00:36:00,740 --> 00:36:03,859
human being inside a real browser
instead of curl instead of Python

459
00:36:03,860 --> 00:36:07,400
requests oh thanks in the example mean
when cloud flies that need to be

460
00:36:07,400 --> 00:36:10,580
checking your browser yeah the little
three bouncing falls it takes like eight

461
00:36:10,580 --> 00:36:14,540
years to complete that's what that's
doing it's running some JavaScript in

462
00:36:14,540 --> 00:36:18,710
your browser to make sure your browser
the browser if you can find that and

463
00:36:18,710 --> 00:36:23,570
just make it not run sometimes depending
on the vendor it just lets you in just

464
00:36:23,570 --> 00:36:26,630
goes cool so you know you're running to
the whole thing just say when you see

465
00:36:26,630 --> 00:36:32,960
this just ignore or some of them require
you to run that JavaScript so try that

466
00:36:32,960 --> 00:36:36,500
as well it's right not blocking and
actually executing it and then it'll

467
00:36:36,500 --> 00:36:40,220
often give you back a cookie for your
session for completing that little task

468
00:36:40,220 --> 00:36:42,459
and then you have to
sure that she provide that cookie that

469
00:36:42,460 --> 00:36:50,560
you were given with every session so try
that or unleash the box this is bliss is

470
00:36:50,560 --> 00:37:03,150
way creepier you can't see in a super
demon tariff make you stare at this so

471
00:37:03,150 --> 00:37:08,470
failing all that you're scripting isn't
working your JavaScript your etc just

472
00:37:08,470 --> 00:37:12,129
you can't figure out what's going on
something else you can do is actually

473
00:37:12,130 --> 00:37:17,770
just try automating an actual browser
and there's a lot of cool stuff out

474
00:37:17,770 --> 00:37:23,860
there that does this zombie chance and
phantom jsr zombie James I think is no

475
00:37:23,860 --> 00:37:29,140
longer supported Vantage asks is I think
that supported by their creators anymore

476
00:37:29,140 --> 00:37:34,270
but still super widely used tons of
documentation out there tons are good

477
00:37:34,270 --> 00:37:38,380
with Google information and how to use
is out there headless chrome is probably

478
00:37:38,380 --> 00:37:41,830
the most popular it's a yeah headless
carbon puppet to you yeah headless

479
00:37:41,830 --> 00:37:45,700
chrome and puppeteer learn to use these
too this is this is devastating because

480
00:37:45,700 --> 00:37:52,509
headless pro is an effectively chrome
but head listen okay and then puppeteers

481
00:37:52,510 --> 00:37:57,070
an external utility that feeds headless
from instructions on how to operate and

482
00:37:57,070 --> 00:38:00,940
to most everything getting the requests
from endless growth it just appears it's

483
00:38:00,940 --> 00:38:04,780
a normal human being using Chrome does
everything prune does it processes the

484
00:38:04,780 --> 00:38:07,990
JavaScript it responds properly it
accepts the cookies it properly sends

485
00:38:07,990 --> 00:38:11,620
those cookies back when needed it does
it does anything that JavaScript tells

486
00:38:11,620 --> 00:38:17,290
it it's super hard to detect that it's a
headless chrome version instead of an

487
00:38:17,290 --> 00:38:23,170
actual chrome version unless you're us
so yeah that's just try ever who's used

488
00:38:23,170 --> 00:38:27,520
to tender scrub before anyone how that's
cool yeah isn't it devastating doesn't

489
00:38:27,520 --> 00:38:32,620
it just work it's great stuff highly
recommended scriptable is about

490
00:38:32,620 --> 00:38:38,440
expertise on campus good you can spin up
effective leaves many instances as you

491
00:38:38,440 --> 00:38:43,120
have system resources for so you can
have a hundred thousand separate browser

492
00:38:43,120 --> 00:38:46,190
assistance coming from
and that doesn't necessarily look like

493
00:38:46,190 --> 00:38:49,640
weird behaviors because when you think
about say a college campus or a hotel

494
00:38:49,640 --> 00:38:52,700
chain or something you're going to get
hundreds of thousands of connections

495
00:38:52,700 --> 00:38:55,460
coming from a single IP so it's not that
big of a deal

496
00:38:55,460 --> 00:38:59,089
and we definitely see that a lot I
mentioned the rent man because I'm used

497
00:38:59,089 --> 00:39:03,890
to rap back that's me because they most
people never hear this and they really

498
00:39:03,890 --> 00:39:10,460
like it but I recognize is a it's a web
app vulnerability scanner that uses fans

499
00:39:10,460 --> 00:39:15,650
of j/s to do all the stuff to bypass a
lot of that stuff and look like a real

500
00:39:15,650 --> 00:39:19,220
human beings here even if we get a lot
more accurate data but our data out of

501
00:39:19,220 --> 00:39:22,578
website you're scanning versus something
that would have things in front of it to

502
00:39:22,579 --> 00:39:29,270
stop it from doing this and again the
puppeteer in this garden is also

503
00:39:29,270 --> 00:39:37,940
plug-ins for Illuminati say you yeah
Illuminati has that business model down

504
00:39:37,940 --> 00:39:41,359
like they said yeah we'll give you some
places will give you a public IP or

505
00:39:41,359 --> 00:39:46,160
residential IPs and say they're here
here's an undocumented ABI maybe I need

506
00:39:46,160 --> 00:39:49,730
to hit to get them good luck before I
don't know we'll just give you some

507
00:39:49,730 --> 00:39:52,869
numbers and they're years and you have
to figure out what to do at this point

508
00:39:52,869 --> 00:39:57,410
so many people use Illuminati but
there's been so many tools and libraries

509
00:39:57,410 --> 00:40:02,089
to just leverage it so that even like
the most beginner of engineers can stick

510
00:40:02,089 --> 00:40:07,790
that into whatever script they're using
so check it out but also they snuck in I

511
00:40:07,790 --> 00:40:15,319
hate them so like now that you've got
this like phantom Jas puppets here

512
00:40:15,319 --> 00:40:20,540
headless chrome nonsense attacking you
that nothing that you currently own can

513
00:40:20,540 --> 00:40:28,940
detect and block what can you do about
this you can use this is super - no

514
00:40:28,940 --> 00:40:33,260
switch we've created a product and
Cassata called poly form that is so

515
00:40:33,260 --> 00:40:39,140
insanely good at fingerprinting the the
the client-side environment on the very

516
00:40:39,140 --> 00:40:43,790
first HTTP requests that it can tell if
any of these tools are being used and

517
00:40:43,790 --> 00:40:48,619
also any automation tools that we're not
aware of something home them we can

518
00:40:48,619 --> 00:40:52,030
detect gift
something is being automated client-side

519
00:40:52,030 --> 00:40:56,500
on that first request and that's really
important to prevent against scrapers if

520
00:40:56,500 --> 00:41:01,619
you guys work for a retail site a list
excitement car listings hotel listings

521
00:41:01,619 --> 00:41:06,910
if you're selling Easy's that sort of
thing we can catch those price scrapers

522
00:41:06,910 --> 00:41:09,879
and stop them right out of the gate and
then some secret sauce I know I'm not

523
00:41:09,880 --> 00:41:12,400
getting any sales pitch up here if you
want to talk about their hangout later

524
00:41:12,400 --> 00:41:15,819
I'll do some business cards up here so
you can grab them that's awful but

525
00:41:15,819 --> 00:41:21,520
that's what you have to do you have to
do something to fingerprint and find the

526
00:41:21,520 --> 00:41:24,549
automation that's running client site
and you have to look for that you can't

527
00:41:24,549 --> 00:41:29,890
trust the data provided in the HTTP
headers you can't trust anything

528
00:41:29,890 --> 00:41:33,788
willingly provided clients item you
can't we come up with a number of people

529
00:41:33,789 --> 00:41:37,750
who have built some really interesting
in-house protections against this but in

530
00:41:37,750 --> 00:41:41,920
the end they come up short because we've
spent years and literally millions of

531
00:41:41,920 --> 00:41:46,059
dollars figuring this problem oh but but
but that's the end the bottom line is

532
00:41:46,059 --> 00:41:49,480
don't trust the information you're
willingly provided to go get the

533
00:41:49,480 --> 00:41:53,799
information you need and don't get it by
asking get it by figuring it out

534
00:41:53,799 --> 00:41:58,480
client-side and that's the most coos I
can give you on that so if you want to

535
00:41:58,480 --> 00:42:02,470
find out what exactly the defenses you
are also currently running and Fred of

536
00:42:02,470 --> 00:42:05,319
your websites are able to handle what
they're not able to handle so that you

537
00:42:05,319 --> 00:42:08,859
can at least start focusing your efforts
where they need to be we're gonna drop

538
00:42:08,859 --> 00:42:16,119
this today this is super fun we've made
this website called bat or bot Bank so

539
00:42:16,119 --> 00:42:20,289
Mac is a common female name in Australia
I just love this name it's backer bot

540
00:42:20,289 --> 00:42:27,190
and you can throw in any website you
like down there and on our end it spins

541
00:42:27,190 --> 00:42:31,329
up a whole bunch of instances of various
types of attacks everything from your

542
00:42:31,329 --> 00:42:35,410
basic purl bot all the way up to
sophisticated puppeteer running headless

543
00:42:35,410 --> 00:42:38,710
Chrome and it'll spit you guys who try
to send your phone right now the mobile

544
00:42:38,710 --> 00:42:44,319
site totally works it's back to our lot
dot Quezada dot IO Becker Bob decided

545
00:42:44,319 --> 00:42:47,788
that IO
I'll show you guys how this works we've

546
00:42:47,789 --> 00:42:51,210
been playing this for a few dates here
just waiting to satisfying to just run

547
00:42:51,210 --> 00:42:58,619
on random websites yeah so only run this
on websites you oh sorry that was the

548
00:42:58,619 --> 00:43:04,920
actual website okay there it is
only one of this on websites you have

549
00:43:04,920 --> 00:43:12,909
permission to run it as you want me and
I just work here

550
00:43:17,900 --> 00:43:24,839
what a question
try that yes give it a shot she wants

551
00:43:24,839 --> 00:43:28,710
that time build a bomb to maybe Daniel
and then once you're sufficiently

552
00:43:28,710 --> 00:43:34,170
furious give me a call
so yes it stand there and then sixty few

553
00:43:34,170 --> 00:43:38,819
seconds it spins up a whole bunch of
crap and attacks the site and then watch

554
00:43:38,819 --> 00:43:45,269
how simple this output this is so we see
that heritage Network totally random

555
00:43:45,269 --> 00:43:49,979
site that I just guessed a word
equipment it's an actual site sorry I

556
00:43:49,980 --> 00:43:52,579
didn't mean to do that

557
00:43:52,910 --> 00:43:57,029
so we see here it's acceptable the
simple bots attacks that's your curl

558
00:43:57,029 --> 00:44:01,589
that's your Python that's literally a
commis agent hello yeah this is yeah

559
00:44:01,589 --> 00:44:06,210
this is the most like this is that we
did nothing to discuss what we were

560
00:44:06,210 --> 00:44:12,480
doing attack it did blog fake a
Googlebot so there's tons of stuff out

561
00:44:12,480 --> 00:44:17,130
there that pretends to be SEO bots given
them failed everything else I'm

562
00:44:17,130 --> 00:44:21,130
wondering if this site actually should
intentionally walking SEO BOTS maybe

563
00:44:21,130 --> 00:44:27,130
yeah and then it is susceptible to fake
browser tab which is like your phantom

564
00:44:27,130 --> 00:44:32,410
jets etc and then it's acceptable cut
the heavens chrome attack so these

565
00:44:32,410 --> 00:44:35,440
people are hosed they have almost no
defenses against any kind of like

566
00:44:35,440 --> 00:44:40,630
automated scripting going on I don't
know it's fine don't worry about it

567
00:44:40,630 --> 00:44:46,900
yeah and so this tool we have is it can
protect against all these things it's

568
00:44:46,900 --> 00:44:51,490
insanely effective it's hilarious I've
estimated I spend about 28 percent of my

569
00:44:51,490 --> 00:44:57,129
day laughing and all of the bots that we
stop all the automation so we say BOTS

570
00:44:57,130 --> 00:45:01,180
but it's really any kind of automated
tool tool kids that are going on so got

571
00:45:01,180 --> 00:45:05,740
its we have our product up in front of
Kassadin and io go ahead and try a look

572
00:45:05,740 --> 00:45:12,459
at it if you find a way around it
you win the prize hit me up to find out

573
00:45:12,460 --> 00:45:17,440
what the prices might involve a black
bag and a knight and a ride a really

574
00:45:17,440 --> 00:45:22,690
cool car but yeah take a crack at it and
if you would like to have that

575
00:45:22,690 --> 00:45:25,869
production front of your site definitely
it's not gonna throw some business cards

576
00:45:25,869 --> 00:45:28,569
up here and we'll be on the hall to talk
later and answer any questions you guys

577
00:45:28,569 --> 00:45:32,380
got because we're totally out of time so
I hope this was useful overall thank you

578
00:45:32,380 --> 00:45:37,319
guys so much and I will see you the rest
of Cybercom

579
00:46:29,440 --> 00:46:31,500
you

