1
00:00:20,200 --> 00:00:23,869
Today we're gonna be talking to you
about remote wireless pentesting. Just

2
00:00:23,870 --> 00:00:31,400
in an a nutshell and a little bit
about what we do. I'm Eric, I'm Matt and yeah.

3
00:00:31,400 --> 00:00:36,140
We hate PowerPoint. We don't make
slides. So, pretty much is just gonna be a

4
00:00:36,140 --> 00:00:44,390
bunch of pictures. -Time stamp on this is
about four minutes ago. It's real. -Not

5
00:00:44,390 --> 00:00:51,290
really. - We tried. -  Right.
- So a quick tidbit about us, I work for

6
00:00:51,290 --> 00:00:55,280
Secureworks,  so does Matt. We like to do
wireless pentesting and all other sorts

7
00:00:55,280 --> 00:01:00,860
of pentesting. We got our start at
Barracuda way long ago. We started

8
00:01:00,860 --> 00:01:04,940
competing in the DEF CON wireless
capture the flag and won of three years

9
00:01:04,940 --> 00:01:09,410
in a row. And then they told us that we
can't play their reindeer games anymore.

10
00:01:09,410 --> 00:01:13,160
And so we're banned from playing the
walls capture the flag at Def Con. S o we

11
00:01:13,160 --> 00:01:16,429
decided that we're gonna start our own
here and stuff. You guys come over to

12
00:01:16,430 --> 00:01:20,630
201A we're gonna be running the walls
capture the flag all night, and yeah it'll

13
00:01:20,630 --> 00:01:25,429
it'll be really fun. I don't know, what
else?  - That's it. That's it, that's

14
00:01:25,430 --> 00:01:31,640
everything. - What about you Matt? What
about you? - Uh, I'm 6'2", 170 pounds. I'm

15
00:01:31,640 --> 00:01:38,450
happily married.
I have kids. I like my house. The French

16
00:01:38,450 --> 00:01:49,280
horn is my favorite instrument. Yeah, next.
- OK, you go first. - So, we work with

17
00:01:49,280 --> 00:01:57,200
SecureWorks adversary group. We're net
pen which is kind of vague. Basically, we

18
00:01:57,200 --> 00:02:02,000
attack people's computer we're pen testers,
and we break into things. We have a bunch

19
00:02:02,000 --> 00:02:09,470
of people too smarter than Eric and I on
our team. Which we... Hello? I can talk

20
00:02:09,470 --> 00:02:15,530
really loud until this microphone starts
working again. We break into people's

21
00:02:15,530 --> 00:02:22,610
stuff. When we started, we were doing
Wireless engagements. We weren't doing

22
00:02:22,610 --> 00:02:26,269
them in a way where we were breaking
into people's stuff. We, they were, they

23
00:02:26,269 --> 00:02:33,890
were more assessments, than pentests.
That's, that's boring right for pen

24
00:02:33,890 --> 00:02:38,630
testers? And it's boring for people who
are paying for pentests. So, we wanted to

25
00:02:38,630 --> 00:02:51,680
change that up. I think that is a good
segue into our next slide. - Yes, - Key,

26
00:02:51,680 --> 00:02:56,930
keyword hashtag slide. - So how we got
started on this, like I said, we did the

27
00:02:56,930 --> 00:02:59,750
DEF CON Wireless capture the flag and we
realized you know what? When you're

28
00:02:59,750 --> 00:03:03,110
chasing down a fox, or you're trying to
break an access point, or be in any way,

29
00:03:03,110 --> 00:03:07,250
shape or form covert. It doesn't really
work if you have a laptop with a bunch

30
00:03:07,250 --> 00:03:10,519
of different antennas hanging off of end
people are looking by you and taking

31
00:03:10,519 --> 00:03:14,900
pictures of you at Def Con and you know
you stand out a lot and so somebody's

32
00:03:14,900 --> 00:03:17,959
trying to have a little bit of OPSEC and
stay away from you you just stick out

33
00:03:17,959 --> 00:03:21,920
like a sore thumb and so because of that
we built our initial piece of this

34
00:03:21,920 --> 00:03:27,048
platform off of a Raspberry Pi hella
cheap because we were not it was our

35
00:03:27,049 --> 00:03:30,590
personal funding right so it wasn't a
lot of money maybe $60 of stuff off of

36
00:03:30,590 --> 00:03:36,140
Amazon that's a like lipo battery $10 on
Amazon wireless adapters 14 the

37
00:03:36,140 --> 00:03:40,010
Raspberry Pi was like what maybe 30
they're even cheaper now so that's how

38
00:03:40,010 --> 00:03:43,160
we started and basically this was used
because we could stick that in our

39
00:03:43,160 --> 00:03:47,420
pocket and then run everything off of a
terminal kline on our phone and so that

40
00:03:47,420 --> 00:03:51,440
we are really covert everything was nice
and quiet it was super cheap well within

41
00:03:51,440 --> 00:03:56,690
my budget and so then instead of having
a laptop in front of us so so sorry No

42
00:03:56,690 --> 00:03:59,510
so the difference matters there if
you're walking around with a laptop

43
00:03:59,510 --> 00:04:05,600
doing a wireless assessment you're
ridiculously obvious people don't walk

44
00:04:05,600 --> 00:04:11,420
around typing on a laptop right if you
have a PI in your backpack with a bunch

45
00:04:11,420 --> 00:04:17,889
of antennas relatively concealed and all
you need is an ssh client on your phone

46
00:04:17,889 --> 00:04:25,850
you look like every other sheep walking
around on their phone like you blend

47
00:04:25,850 --> 00:04:31,220
right right it matters if you're a pen
tester it matters anything you can do to

48
00:04:31,220 --> 00:04:38,510
blend in with the people around you
helps you so don't the the PI is not the

49
00:04:38,510 --> 00:04:44,070
best platform it's a good platform but
the phone versus a laptop

50
00:04:44,070 --> 00:04:50,550
is is a game changer for your ability to
blend into the people on to the next

51
00:04:50,550 --> 00:04:56,820
slide so I'd whoa that yeah so the
problem of the tablet is that the

52
00:04:56,820 --> 00:04:59,849
hardware there's typically weird drivers
in there the operating system and kind

53
00:04:59,850 --> 00:05:03,690
of processors it on everything in the
world has been made on a Raspberry Pi so

54
00:05:03,690 --> 00:05:07,800
it's easy platform just plug things in
there's USB ports you can expand those

55
00:05:07,800 --> 00:05:10,680
ports out if you add additional power
and you don't want your low voltage

56
00:05:10,680 --> 00:05:15,090
drops so yeah tablets are another option
but how expensive is a tablet when

57
00:05:15,090 --> 00:05:18,330
everybody else has a phone right
they do sell you know purpose-built

58
00:05:18,330 --> 00:05:22,590
pentesting tablets but this is just
honestly just cheaper in and it's more

59
00:05:22,590 --> 00:05:26,369
customizable from my perspective anyways
and you can kind of see this like what I

60
00:05:26,370 --> 00:05:30,300
see on my phone so that's typical iPhone
keyboard will show an Android one later

61
00:05:30,300 --> 00:05:35,040
and that's air dump running caching a
handshake just off of my phone just just

62
00:05:35,040 --> 00:05:38,640
sitting there right so that's that's
kind of the power here is that you have

63
00:05:38,640 --> 00:05:42,539
the power of a full computer completely
customizable you can script up whatever

64
00:05:42,540 --> 00:05:45,990
you want on that pie when you're at home
and then go to your phone run your

65
00:05:45,990 --> 00:05:50,250
scripts and do all this stuff I mean
we've we've been tested some very large

66
00:05:50,250 --> 00:05:56,340
areas where there are lots of people and
we walk around and nobody knows that we

67
00:05:56,340 --> 00:06:01,409
aren't tourists you know if visiting
that spot we're just nice and covert in

68
00:06:01,410 --> 00:06:06,660
fact this is this is Matt's backpacking
tell you about it yeah so literally a

69
00:06:06,660 --> 00:06:12,110
backpack it's there's not that much to
say but you can see down down one side

70
00:06:12,110 --> 00:06:16,830
there's just a an alpha 2.4 the green
alpha cards any of you guys have done

71
00:06:16,830 --> 00:06:21,599
Wireless you know those cards there's
these fat card cases and they're stupid

72
00:06:21,600 --> 00:06:27,690
so we popped we popped them out and just
3d printed cases that fit that board in

73
00:06:27,690 --> 00:06:31,680
it's it's a half size board relative to
the case that it's in so we pop them out

74
00:06:31,680 --> 00:06:38,610
of the cases printed boards you it looks
it looks like it's something you would

75
00:06:38,610 --> 00:06:43,560
notice there I can tell you I walk
around with a 9 DB alpha antenna which

76
00:06:43,560 --> 00:06:49,560
is about 14 inches long on my backpack
all the time through TSA and through an

77
00:06:49,560 --> 00:06:57,680
airport literally no one has ever ever
ever ever asked me about it so as

78
00:06:57,680 --> 00:07:02,699
sort of obvious as that seems it isn't
especially when you consider the

79
00:07:02,699 --> 00:07:06,930
alternative of walking around with a
laptop typing like looking up at the

80
00:07:06,930 --> 00:07:10,860
ceiling for APS
right it's it's a and and the other part

81
00:07:10,860 --> 00:07:13,169
too is that it's really easy to see that
one cuz they're two little brass

82
00:07:13,169 --> 00:07:15,748
connectors right there but you probably
also didn't see the black one right

83
00:07:15,749 --> 00:07:18,900
behind it eyes of one of the pandas
sitting right there so it's one of those

84
00:07:18,900 --> 00:07:22,799
things those are all hanging off of it
and unless you're really looking you

85
00:07:22,800 --> 00:07:26,639
there's there's to mix on there yeah you
and you you can't even see it and that's

86
00:07:26,639 --> 00:07:29,669
on the outside that's not even on the
inside if you really wanted to be

87
00:07:29,669 --> 00:07:32,938
extremely covert you just put all in the
backpack nobody knows I'm just gonna go

88
00:07:32,939 --> 00:07:37,919
from there this is what it looks like on
the inside of it so you can see that

89
00:07:37,919 --> 00:07:42,029
that's basically just two raspberry PI's
we just if you need more if you need to

90
00:07:42,029 --> 00:07:46,099
capture more channels more bandwidth
just you plug it in more they run off of

91
00:07:46,099 --> 00:07:50,370
10k milliamp hour batteries off the
shelf yeah all off-the-shelf stuff you

92
00:07:50,370 --> 00:07:53,819
buy it off Amazon and you know it's like
20 bucks

93
00:07:53,819 --> 00:07:57,389
and those 10k million power batteries
can run it for probably about 20 hours

94
00:07:57,389 --> 00:08:02,370
that's doing you know caps on multiple
cards the entire time so it's its

95
00:08:02,370 --> 00:08:07,199
backpack is more expensive than the
hardware that's yeah that that's a 100%

96
00:08:07,199 --> 00:08:14,159
true Oh proud they're so proud of those
bags with the loops oh how do you feel

97
00:08:14,159 --> 00:08:17,969
about this alright so we're gonna talk a
little bit about the benefits of

98
00:08:17,969 --> 00:08:21,330
wireless attacks and this is this is one
of the things that I like to just kind

99
00:08:21,330 --> 00:08:25,349
of talk to clients about is hey you know
you could buy a fancy a fancy-schmancy

100
00:08:25,349 --> 00:08:28,349
red team and it will cost a lot of money
and we will definitely break into your

101
00:08:28,349 --> 00:08:32,968
company but a wireless contest has the
benefit of I can be sitting on that park

102
00:08:32,969 --> 00:08:37,680
bench right there and I don't need any
physical access to your facility at all

103
00:08:37,679 --> 00:08:42,269
I can you know put up a nice directional
antenna and have the same level of

104
00:08:42,269 --> 00:08:44,179
access as if I were sitting in your
Lobby

105
00:08:44,179 --> 00:08:48,149
and so that's one of those things that a
lot of people just think oh well you

106
00:08:48,149 --> 00:08:52,440
know what my my wireless signal only
propagates you know just in the parking

107
00:08:52,440 --> 00:08:55,380
lot because that's how far my iPhone
goes what they don't realize is that

108
00:08:55,380 --> 00:08:58,860
with different antennas and different
hardware you can extend that range

109
00:08:58,860 --> 00:09:03,540
hundreds and hundreds and hundreds of
yards especially in open air and so you

110
00:09:03,540 --> 00:09:08,219
can do a pen test without ever you know
creating a fingerprint ever getting on

111
00:09:08,220 --> 00:09:12,600
camera or even being in the same really
and what we're gonna talk about is some

112
00:09:12,600 --> 00:09:15,930
of the hardware that we can do that with
that we can be thousands of miles away

113
00:09:15,930 --> 00:09:20,010
and still perform the same Wireless pen
test and arguably give give a much

114
00:09:20,010 --> 00:09:27,830
better product I think to the client
agreed yeah next you next suite slide

115
00:09:27,830 --> 00:09:33,780
slide so again one of the things that we
do often is rogue access points contrary

116
00:09:33,780 --> 00:09:38,910
to popular belief wpa2 PSK would
probably all of your your home you know

117
00:09:38,910 --> 00:09:42,240
access points are running right now
that's actually really secure if you

118
00:09:42,240 --> 00:09:46,260
have a good passphrase oftentimes we'll
catch a handshake for a client and if

119
00:09:46,260 --> 00:09:50,819
it's of any reasonable size we're
probably not going to crack it and we

120
00:09:50,820 --> 00:09:56,010
have multiple multiple dedicated
purpose-built devices that basically

121
00:09:56,010 --> 00:10:02,189
have eight you know 1080 Titan 1080 Ti
Titans that can crack hashes at billions

122
00:10:02,190 --> 00:10:05,730
and billions of hashes the second word
again how do you say that better

123
00:10:05,730 --> 00:10:09,390
we don't crack very much wpa2 PSK what
he said

124
00:10:09,390 --> 00:10:15,410
it's not a fast hash to crack if you
have a heart you know 1215 characters

125
00:10:15,410 --> 00:10:19,110
pseudo-random like even if they're
dictionary words and you substitute

126
00:10:19,110 --> 00:10:23,970
appropriately those are way harder
you're you're more secure with that than

127
00:10:23,970 --> 00:10:29,790
you are with WPA enterprise unless you
check every single box getting WPA

128
00:10:29,790 --> 00:10:34,589
enterprise right and your and your users
aren't local admins and can't install

129
00:10:34,590 --> 00:10:41,640
certs PSK is harder period and that's
and that's where rogue access points

130
00:10:41,640 --> 00:10:44,880
come in because what I do is I stand up
a rogue access point that's the same

131
00:10:44,880 --> 00:10:49,439
name as your Wi-Fi router it's an open
network I nuke your Wi-Fi so that you

132
00:10:49,440 --> 00:10:52,410
can't connect to it I just D off all of
your devices from it you say whoa

133
00:10:52,410 --> 00:10:56,250
there's a problem with my Wi-Fi I don't
know what's going on you look on your

134
00:10:56,250 --> 00:11:00,180
iPhone and you say oh I'm not connected
to Wi-Fi I'm going to connect to the one

135
00:11:00,180 --> 00:11:04,500
that has the strongest signal guess who
has the strongest signal we do so you

136
00:11:04,500 --> 00:11:08,940
connect to us and this is a screen of a
bunch of people connecting to us and we

137
00:11:08,940 --> 00:11:13,500
serve them up a captive portal which
looks surprisingly like what their

138
00:11:13,500 --> 00:11:18,570
prompt is to put in their wireless
password so so some of this is some of

139
00:11:18,570 --> 00:11:24,620
this is like pentester stuff that that
we probably take for granted

140
00:11:24,620 --> 00:11:28,860
when you're when you're working like on
a on a machine that's wired into your

141
00:11:28,860 --> 00:11:33,149
network there's this concept of a
broadcast domain right those are the

142
00:11:33,149 --> 00:11:41,160
other machines sharing your locality
right in a map sense you're limited in

143
00:11:41,160 --> 00:11:45,750
your exposure there right your servers
are going to be in a different broadcast

144
00:11:45,750 --> 00:11:51,570
domain than your desktops wireless is
not like that everything is your

145
00:11:51,570 --> 00:11:57,600
broadcast the air is your broadcast
domain in wireless so just just some

146
00:11:57,600 --> 00:12:01,709
context to back this up like these
attacks can be perpetrated against

147
00:12:01,709 --> 00:12:06,479
anybody using the wireless access points
that you connect to

148
00:12:06,480 --> 00:12:12,029
there is no isolation in a broadcast
domain everybody is just yelling as loud

149
00:12:12,029 --> 00:12:20,640
as they can and and we have tools so we
can yell pun intended because I'm

150
00:12:20,640 --> 00:12:27,930
yelling uh we can yell really loud right
I I have to amp wireless amplifiers that

151
00:12:27,930 --> 00:12:34,050
would put my wireless signal on the top
of everyone in this room probably

152
00:12:34,050 --> 00:12:40,399
everyone on this blocks list of access
points so broadcast it matters and I

153
00:12:40,399 --> 00:12:45,060
that's ten gentle to what Eric is
talking about but it but it uh it

154
00:12:45,060 --> 00:12:48,689
matters those gaps it matters because
basically what it means is you're gonna

155
00:12:48,690 --> 00:12:51,360
connect to us
you're gonna submit your password to us

156
00:12:51,360 --> 00:12:55,020
since we're running the webserver and
this is all our stuff when it comes to

157
00:12:55,020 --> 00:12:58,709
us it's in clear text you typed in your
password you just gave it to us in clear

158
00:12:58,709 --> 00:13:02,819
text I don't need to crack anything I
don't need any fancy you know rig that

159
00:13:02,820 --> 00:13:05,760
has all these graphics cards in it you
just gave it to me and clear he typed it

160
00:13:05,760 --> 00:13:09,300
yeah you just typed it to me and gave it
to me without knowing it and so then

161
00:13:09,300 --> 00:13:12,750
what the script basically does is it
shuts down says I got a working you know

162
00:13:12,750 --> 00:13:16,380
I got a working the password so I'm
gonna stop doing everything and you

163
00:13:16,380 --> 00:13:20,550
think sweet well I just reconnected
Wi-Fi now everything works that is

164
00:13:20,550 --> 00:13:23,279
awesome
but really everything works and now I'm

165
00:13:23,279 --> 00:13:26,550
on your network and that's that's the
differentiator there and that's really

166
00:13:26,550 --> 00:13:30,149
how you break PSK or you know what your
typical home Wi-Fi is is when you

167
00:13:30,149 --> 00:13:34,110
accidentally give it up to somebody
crypto cryptographically speaking it's

168
00:13:34,110 --> 00:13:38,210
just secure it's secure and so this is
an example

169
00:13:38,210 --> 00:13:41,600
you were to try to do the same thing on
like a Windows 10 computer you try to

170
00:13:41,600 --> 00:13:44,839
connect to the internet and you're like
man I can't connect what's going on

171
00:13:44,839 --> 00:13:48,560
you can't connect really this this isn't
a no internet connection page that

172
00:13:48,560 --> 00:13:53,540
served up my windows this is my website
that we that we run on the Raspberry Pi

173
00:13:53,540 --> 00:13:59,180
and that's you trying to connect you
enter your password and when you hit

174
00:13:59,180 --> 00:14:03,890
next you're actually just submitting
that to my web server and now so so

175
00:14:03,890 --> 00:14:07,459
we're gonna talk about so that's that's
why those pentesting right we're going

176
00:14:07,459 --> 00:14:12,760
to talk about how we do it remotely and
why we did it remotely and so that's why

177
00:14:12,760 --> 00:14:17,750
we we really did it for this one or like
but this is my daughter she just turned

178
00:14:17,750 --> 00:14:23,240
a year old wireless pentesting
traditionally required that I needed to

179
00:14:23,240 --> 00:14:27,860
go on site I I don't like going on site
I have a baby home I have a wife at home

180
00:14:27,860 --> 00:14:31,459
I want to stay and hang out with them
when Matt said he likes his house I like

181
00:14:31,459 --> 00:14:35,359
my house a lot too and I want to stay
there that's why we developed this box

182
00:14:35,360 --> 00:14:40,399
which is basically an emo cane with a
bunch of not basically it is 18 am okay

183
00:14:40,399 --> 00:14:43,700
I am okay with electronics inside with
raspberry PI's inside it's that little

184
00:14:43,700 --> 00:14:47,060
portable thing that we had but basically
just jammed into there not basically it

185
00:14:47,060 --> 00:14:51,709
is jammed into there and we did it just
so that we can hang out and be at home

186
00:14:51,709 --> 00:14:56,180
and this is our version one and I made
it it worked but it's ugly as you're

187
00:14:56,180 --> 00:15:01,040
about to see on the inside yeah so I
mean basically what you don't see is

188
00:15:01,040 --> 00:15:05,060
that on that top right image I just
packed that full of packing foam like

189
00:15:05,060 --> 00:15:08,689
that's all it was it was not like you
know there was no like good heat seats

190
00:15:08,690 --> 00:15:11,720
in there there was no airflow that was
just packed tight full of foam and

191
00:15:11,720 --> 00:15:14,270
probably a fire hazard but nothing
happened so we're good

192
00:15:14,270 --> 00:15:18,920
and then Matt was nice enough to add on
the bottom left one the nice little

193
00:15:18,920 --> 00:15:24,439
Shelly adversary group sticker to our
Ethernet jack which gives us a little

194
00:15:24,440 --> 00:15:29,060
bit more capability or a tough so so
Erik brought over Erik and I work

195
00:15:29,060 --> 00:15:35,180
together on a lot of stuff Erik is an
optimist which is really good because I

196
00:15:35,180 --> 00:15:42,880
am cynical his optimism allows him to
take on projects that I know are a

197
00:15:42,880 --> 00:15:48,560
stupid waste of time
and then he shows up at my house and

198
00:15:48,560 --> 00:15:55,189
it's like look it works sometimes and
I'm like oh god you're the worst like

199
00:15:55,190 --> 00:16:00,650
okay so he brings this box over to me
and it's literally some crap and some

200
00:16:00,650 --> 00:16:04,730
foam and some crap and some foam and
he's like it works it works

201
00:16:04,730 --> 00:16:08,450
and he and he demonstrates that it works
and I throw it off my patio on the

202
00:16:08,450 --> 00:16:14,240
second floor and it breaks open and
everything dumps out on my driveway and

203
00:16:14,240 --> 00:16:18,250
he was like what are you doing and I was
like we have to ship it somewhere right

204
00:16:18,250 --> 00:16:23,170
because we're not pen testing my house

205
00:16:23,800 --> 00:16:30,979
so we so we took his thing that worked
that he proved was worth some time and

206
00:16:30,980 --> 00:16:38,570
and did a whole bunch of 3d nonsense
printing like whoohoo like cool maker

207
00:16:38,570 --> 00:16:44,930
stuff and like got it into a format that
we could ship out to clients and it

208
00:16:44,930 --> 00:16:52,310
would arrive mostly working we put two
of everything in because I come from a

209
00:16:52,310 --> 00:16:58,339
world of running backups right where two
is one and one is none so we put two of

210
00:16:58,340 --> 00:17:04,040
everything in the box and we shipped it
and we have yet to have an instance

211
00:17:04,040 --> 00:17:08,530
where the box would arrive in such a
dilapidated state that we could not test

212
00:17:08,530 --> 00:17:14,540
frequently it's it's a little hodge
podge some things made it so we we kept

213
00:17:14,540 --> 00:17:19,849
sort of iterating on the box and and we
have a nicer version now we would like

214
00:17:19,849 --> 00:17:24,948
to have brought one but they're so
booked through our our Wireless practice

215
00:17:24,949 --> 00:17:33,380
that we don't have any to spare I built
to the day before we flew here to ship

216
00:17:33,380 --> 00:17:37,850
I don't we we literally couldn't take
one out of circulation that's how in

217
00:17:37,850 --> 00:17:43,850
demand they are you want a pop pop
forward yes so a little bit about what's

218
00:17:43,850 --> 00:17:47,120
on what's in it this is like definitely
not the limited size deck but these are

219
00:17:47,120 --> 00:17:50,419
the main tools that we go to we use air
crack if you're not familiar with that

220
00:17:50,420 --> 00:17:53,540
that's like the main suite of tools that
allows you to or like are these live now

221
00:17:53,540 --> 00:17:56,320
whoa they're live

222
00:17:57,200 --> 00:18:01,649
so so air crack is the main is the main
tool that we pretty much use the cat

223
00:18:01,649 --> 00:18:05,899
handshakes to see what's going on in the
air space it takes some some you know

224
00:18:05,899 --> 00:18:10,260
decently I it takes some stuff off
Amazon that you can use like wireless

225
00:18:10,260 --> 00:18:14,158
cards to be able to scan the airspace
and see what's there we use EEP Amer

226
00:18:14,159 --> 00:18:19,620
that's what we use pretty much all the
time to break into wpa2 enterprise we

227
00:18:19,620 --> 00:18:22,199
have Wi-Fi Fisher that's what I was
showing you before if we don't know your

228
00:18:22,200 --> 00:18:26,510
Wi-Fi password we're gonna try and fish
it from you it's fishing but with Wi-Fi

229
00:18:26,510 --> 00:18:30,690
that we also have GTC downgrade I
haven't seen that a long time but that's

230
00:18:30,690 --> 00:18:35,340
also long they're just you never know an
MD k3 that's basically Deon saying that

231
00:18:35,340 --> 00:18:39,149
that can nuke all wireless you know I
could kick everybody in this room off of

232
00:18:39,149 --> 00:18:44,879
all Wi-Fi networks with just that one
tool and Raspberry Pi so again on top of

233
00:18:44,880 --> 00:18:48,450
all these we also have all of our
typical net pen tools when I say net pen

234
00:18:48,450 --> 00:18:52,529
if we're gonna run a general network
penetration test you know we have stuff

235
00:18:52,529 --> 00:18:56,730
to do element our NetBIOS poisoning we
have crack map exec we have all of our

236
00:18:56,730 --> 00:19:01,679
a/b stuff to test your Active Directory
because the angle is not just to break

237
00:19:01,679 --> 00:19:06,539
into your Wi-Fi network the end goal of
this is to become domain admin or get to

238
00:19:06,539 --> 00:19:10,679
whatever you know the client deems are
their crown jewels that's where this

239
00:19:10,679 --> 00:19:15,029
ends it's not just a oh we knew where
this assessment it really just comes

240
00:19:15,029 --> 00:19:19,830
down to it is a part of your external
printer people do external penetration

241
00:19:19,830 --> 00:19:23,220
tests all the time of what they have
publicly exposed to the internet but

242
00:19:23,220 --> 00:19:27,899
they almost never do a wireless pen test
of what somebody could do if they're you

243
00:19:27,899 --> 00:19:31,309
know local even close and what we'll
show you is thousands of miles away

244
00:19:31,309 --> 00:19:38,580
anyone know today so I'm going to talk a
little bit about the version one and

245
00:19:38,580 --> 00:19:43,230
some of the design considerations I had
some ammo cans laying around so I use

246
00:19:43,230 --> 00:19:47,010
the ammo can be pretty rugged at the
time so hey it worked out

247
00:19:47,010 --> 00:19:51,330
there was there's dual serial onboard so
raspberry PI's if you don't know they

248
00:19:51,330 --> 00:19:54,750
can connect to each other like you can
plug one into the other and they can

249
00:19:54,750 --> 00:19:58,440
like talk to each other back and forth
no network it's just direct like almost

250
00:19:58,440 --> 00:20:02,010
keyboard to keyboard talking with one
another the nice part about that is if

251
00:20:02,010 --> 00:20:05,549
one Raspberry Pi doesn't come up you can
troubleshoot it from the other one so

252
00:20:05,549 --> 00:20:08,250
there's redundancy built in there you
should go to the next slide

253
00:20:08,250 --> 00:20:11,280
yeah cuz it does it explain all right oh
yeah that is a lot better slide yeah

254
00:20:11,280 --> 00:20:13,918
anyway this is what it looks like so
there's the ammo can you can see

255
00:20:13,919 --> 00:20:17,130
everything that little green square
that's what's in the box so both of

256
00:20:17,130 --> 00:20:19,799
those raspberry PI's they can talk to
each other independent of any network

257
00:20:19,799 --> 00:20:23,610
connection then you have tune that
you're healthy modems in they're both

258
00:20:23,610 --> 00:20:28,199
running different different cell signal
different services basically so we're in

259
00:20:28,200 --> 00:20:31,409
an area where hey Verizon is crap we
can't use it it will use t-mobile

260
00:20:31,409 --> 00:20:35,130
t-mobile's crap inverse and we can
troubleshoot it so if something's

261
00:20:35,130 --> 00:20:39,240
happening we can go back through any one
of those ways the other thing that's

262
00:20:39,240 --> 00:20:43,049
nice about it too is this all phones
home directly to our Open VPN pen web

263
00:20:43,049 --> 00:20:48,030
that we use to do all of our pen test
from so when somebody plugs in that wire

264
00:20:48,030 --> 00:20:52,110
or you know somebody plugs in the am
okay and empower it automatically comes

265
00:20:52,110 --> 00:20:55,678
up connects the cell towers and then
it'll even send us a text message saying

266
00:20:55,679 --> 00:20:59,940
hey I'm up here's where I am here's the
networks that I see and hear all you

267
00:20:59,940 --> 00:21:03,960
basically hear all the statistics of it
so I know before the client even emails

268
00:21:03,960 --> 00:21:09,720
me now that device has been plugged in
so agronomy the the emoji ins or the

269
00:21:09,720 --> 00:21:14,760
most secure devices on the clients
network and that's and thats thanks

270
00:21:14,760 --> 00:21:19,230
thanks to another member of our team
who's sitting up here in the green yeah

271
00:21:19,230 --> 00:21:26,190
john miller way to yeah yeah that guy
the guy who come along he doesn't all

272
00:21:26,190 --> 00:21:28,700
the magic

273
00:21:29,580 --> 00:21:33,600
anyway so that was version one that's
basically how it's designed and the base

274
00:21:33,600 --> 00:21:37,500
the base bits of it are a little bit the
same but then that made everything

275
00:21:37,500 --> 00:21:44,549
really nice for me oh isn't that big
doesn't that make your OCD just feel

276
00:21:44,549 --> 00:21:50,250
amazing I just I just have a moment of
silence and we consider the ammo can

277
00:21:50,250 --> 00:21:55,980
foam debacle that arrived at my house
like Oh kinda works and then we look at

278
00:21:55,980 --> 00:22:00,299
that you can shake it and it doesn't
make a sound

279
00:22:00,299 --> 00:22:06,599
you can shake it hard I throw them off
my patio to test them before we ship

280
00:22:06,599 --> 00:22:16,830
them that's okay we're just gonna show
him another picture they're really good

281
00:22:16,830 --> 00:22:25,769
yeah yeah oh right right
so we got rid of the him okay nose buddy

282
00:22:25,769 --> 00:22:33,499
I just went looking for an appropriately
volumed case to ship these in and I

283
00:22:33,499 --> 00:22:40,709
bought a pistol case it was not my
intention when Eric's kind of a gun nut

284
00:22:40,709 --> 00:22:46,289
I'm not really a gun nut but you
couldn't tell from my Pig like we went

285
00:22:46,289 --> 00:22:53,219
from ammo cans to gun cases I don't know
if it's enough grade aside grade we went

286
00:22:53,219 --> 00:22:58,320
with black because orange is a little
too alarming and when you sticks out a

287
00:22:58,320 --> 00:23:04,049
lot and when you put all six antennas on
them they look nefarious yeah I think we

288
00:23:04,049 --> 00:23:07,349
can picture the all set since I was
coming up we only ship them don't take

289
00:23:07,349 --> 00:23:22,559
them on an airplane it'll go bad you'll
there would be searches in places so

290
00:23:22,559 --> 00:23:27,389
this slide is out of order
yeah but it's appropriate that's my

291
00:23:27,389 --> 00:23:36,149
phone running IPE Merc which is a wpa2
enterprise certificate attack where we

292
00:23:36,149 --> 00:23:40,349
basically spoof the certificate for the
wireless network we're attacking and

293
00:23:40,349 --> 00:23:49,668
just scream really really loud and every
AP and client how about my cert

294
00:23:49,669 --> 00:23:55,889
eventually someone accepts it when they
do they held that off and we have clear

295
00:23:55,889 --> 00:24:03,779
clear text or net and Kayla right
crackable hashes it it always wins like

296
00:24:03,779 --> 00:24:08,909
that that tool right there if you do
wireless you should know that too

297
00:24:08,909 --> 00:24:15,340
and if
it that's why wpa2 enterprise is less

298
00:24:15,340 --> 00:24:23,439
secure than wpa2 PSK just period yeah
and I mean to just go off promo film

299
00:24:23,440 --> 00:24:27,159
yeah yeah exactly that's the best kicker
there right all of this is happening

300
00:24:27,159 --> 00:24:32,289
from a phone in his backpack and that's
just when he's in sight you know if if

301
00:24:32,289 --> 00:24:36,129
this is all happening from our home
through their open VPN connection back

302
00:24:36,130 --> 00:24:42,250
to it this is all happening when we are
this is this is all happening to us you

303
00:24:42,250 --> 00:24:46,029
know when we're sitting at home we're in
our nice comfortable spot we really like

304
00:24:46,029 --> 00:24:49,390
it we have all of our monitors we're not
crammed into some random cubicle from

305
00:24:49,390 --> 00:24:53,200
the person that left the week before at
a client's site so we have we have

306
00:24:53,200 --> 00:25:01,590
really spread out and run a growth it in
this slide I think is that order do I

307
00:25:01,590 --> 00:25:07,709
need a root for they're awesome yeah
usb-to-serial it's great thank you

308
00:25:07,710 --> 00:25:14,230
mm-hmm all right so let's talk a little
bit about the value of this so a lot of

309
00:25:14,230 --> 00:25:16,690
times people really want to send
somebody on site they want to see

310
00:25:16,690 --> 00:25:21,100
pentester doing pen testing things with
you know antennas and and all their

311
00:25:21,100 --> 00:25:25,719
doodads and gizmos and they really like
that image in like what they're getting

312
00:25:25,720 --> 00:25:29,380
but really that's not the full story
what they really want at the end of the

313
00:25:29,380 --> 00:25:33,460
day is a solid pen test done that
assesses all of their security and make

314
00:25:33,460 --> 00:25:37,659
sure that we can't get in in any way
shape or form now if you if you hire a

315
00:25:37,659 --> 00:25:40,390
single person to come on site you're
paying for meals you're paying for hotel

316
00:25:40,390 --> 00:25:44,320
you're paying for travel all that jazz
but you're also only getting one person

317
00:25:44,320 --> 00:25:48,939
the cost of a pen test if you were to
say have 7/10 however many people you

318
00:25:48,940 --> 00:25:54,010
need it on it would be astronomical to
have that many people at one time at one

319
00:25:54,010 --> 00:25:59,230
site so really what this allows us to do
it this is basically a gateway into the

320
00:25:59,230 --> 00:26:04,270
wireless space of that client so even
though I'll be the primary on wireless

321
00:26:04,270 --> 00:26:08,440
engagement the seconds that I break into
say their main wireless network and I

322
00:26:08,440 --> 00:26:11,980
see a web app I'm gonna be calling Jared
and say hey Jared can you look at this

323
00:26:11,980 --> 00:26:15,370
web application I don't know anything
about web security but we're on their

324
00:26:15,370 --> 00:26:19,239
network you can happen the VPN and he
can now pen test through the same device

325
00:26:19,240 --> 00:26:22,809
so really what you're doing is opening
the floodgates for all of our pen

326
00:26:22,809 --> 00:26:27,428
testers all which have really
specialized you know skill sets they can

327
00:26:27,429 --> 00:26:30,909
all use it at the same time so you may
not be getting one pen tester for 40

328
00:26:30,909 --> 00:26:34,659
hours you're getting ten pen testers
that do what they're great at for four

329
00:26:34,659 --> 00:26:39,639
hours at a time if if you're in here and
you're a secure works pen tester raise

330
00:26:39,639 --> 00:26:47,320
your hand please that's the door that we
bring when we drop a wrt and your

331
00:26:47,320 --> 00:26:53,980
network yeah all of those guys including
us are there and yeah there's the

332
00:26:53,980 --> 00:26:58,779
flexibility there are times where for
whatever reason I can't go on-site I

333
00:26:58,779 --> 00:27:02,500
can't you know fly across the country to
go do a pen test but this will get the

334
00:27:02,500 --> 00:27:06,010
flexibility to say hey client we're just
gonna mail you this box you plug it into

335
00:27:06,010 --> 00:27:10,360
power great scheduling done we don't
have to worry about that you know it

336
00:27:10,360 --> 00:27:15,070
allows it allows for all of our
basically people he even want to learn

337
00:27:15,070 --> 00:27:18,610
so all of our pen testers that are like
hey we wanted to get in Wireless you

338
00:27:18,610 --> 00:27:21,789
know in the wireless Dan themes how do
they do that hey you can just shadow

339
00:27:21,789 --> 00:27:26,440
along with somebody they don't need to
come out on site to learn to basically

340
00:27:26,440 --> 00:27:33,159
learn the ropes right right and the up
set of that is ridiculous right with we

341
00:27:33,159 --> 00:27:42,880
have 70 or 80 of the biggest nightmares
that you've ever met on our team and and

342
00:27:42,880 --> 00:27:47,409
we're basically affording them all of
them the opportunity to extend their

343
00:27:47,409 --> 00:27:54,639
ICS SCADA web app whatever horrible
things they know a lot about into

344
00:27:54,639 --> 00:28:02,439
wireless and and then you wind up with a
bunch of people who are real multi

345
00:28:02,440 --> 00:28:09,330
thread folks and and they don't even
have to be at your place

346
00:28:09,330 --> 00:28:15,399
to perform your Wireless assessment like
their knowledge is just parallel to

347
00:28:15,399 --> 00:28:20,739
whoever the wireless pen tester is
that's working your project it

348
00:28:20,740 --> 00:28:29,379
it's a ridiculous it's a ridiculous
model you get if you want a pen test and

349
00:28:29,379 --> 00:28:34,649
you want to see really what can happen
with your wireless

350
00:28:35,050 --> 00:28:39,790
it's the it's the only way when one guy
on your site it doesn't matter how much

351
00:28:39,790 --> 00:28:44,710
one person can know right it's still
just one person they're not some

352
00:28:44,710 --> 00:28:48,870
Interdisciplinary you can't have the
same person who has ten years of

353
00:28:48,870 --> 00:28:54,189
developer experience SCADA ICS that one
person doesn't bring all of that to you

354
00:28:54,190 --> 00:28:58,720
right and that was always the trap of
wireless pen testing before somebody

355
00:28:58,720 --> 00:29:06,280
figured out a way to leverage the group
the hive mind sort of approach to pen

356
00:29:06,280 --> 00:29:12,149
testing it's like oh cool we got into
Wireless what's what's next and now

357
00:29:12,150 --> 00:29:17,830
regardless of what the answer to that
question is we we bring the whole suite

358
00:29:17,830 --> 00:29:25,090
of tools like the the full force to bear
like whatever over-the-top a movie promo

359
00:29:25,090 --> 00:29:30,879
voice guy you can imagine if it was a
time and like we have all of those

360
00:29:30,880 --> 00:29:35,800
people and we put them on your network
through your wireless and and we've seen

361
00:29:35,800 --> 00:29:40,540
it just just in the past year of hey
before wireless pen test oh we caught a

362
00:29:40,540 --> 00:29:44,530
hash code in CRAC - bummer
like yep stamp of approval they're good

363
00:29:44,530 --> 00:29:50,590
to go in in this past year past that and
having all the people that we have there

364
00:29:50,590 --> 00:29:56,169
is regularly in fact I can only think of
one two times where we haven't basically

365
00:29:56,170 --> 00:30:00,730
compromised the entire domain from the
wireless and that's that's really just

366
00:30:00,730 --> 00:30:04,480
out of we have a lot of really good
people and this platform allows us to

367
00:30:04,480 --> 00:30:09,160
use all of them
that's how - probably 50 assessments so

368
00:30:09,160 --> 00:30:15,550
- out of 50 we didn't get in and these
aren't small companies yeah they're not

369
00:30:15,550 --> 00:30:20,139
this is all this is not your dentist and
and I think this is like the appropriate

370
00:30:20,140 --> 00:30:23,200
portion of this where we go into kind of
some story time about this is the real

371
00:30:23,200 --> 00:30:27,430
this is the real talk the slides were
just so that cypher con let us come back

372
00:30:27,430 --> 00:30:29,790
next year

373
00:30:33,780 --> 00:30:44,889
so so just sort of partly into story
time in the past

374
00:30:44,890 --> 00:30:48,760
a wireless pen test has been a guy who
shows up at your place and he probably

375
00:30:48,760 --> 00:30:54,340
knows about wireless
he's probably got three to five days to

376
00:30:54,340 --> 00:31:02,649
walk around your site everybody knows
he's coming and he's in a bubble right

377
00:31:02,650 --> 00:31:06,670
he has some communications but it's not
the communications he would have if he

378
00:31:06,670 --> 00:31:10,810
was at his house with his regular tool
set on his regular machines everything

379
00:31:10,810 --> 00:31:20,679
is mobile everything is sort of awkward
and uncomfortable at best and and we're

380
00:31:20,680 --> 00:31:29,980
a shop that that has a lot of people who
are familiar with Wireless we've taken

381
00:31:29,980 --> 00:31:35,470
teams to CTFs Wireless suggests that we
have a lot of sharp people

382
00:31:35,470 --> 00:31:41,020
you put one person out on their own
on-site sort of out of their element and

383
00:31:41,020 --> 00:31:46,660
you compound the pentest problem which
is representing what of what a resource

384
00:31:46,660 --> 00:31:53,800
threat has over a year into what a pen
tester with with limited access has in a

385
00:31:53,800 --> 00:31:56,080
week
right if if you're a pen tester you're

386
00:31:56,080 --> 00:32:00,399
familiar with that problem of trying to
represent what a nation-state might be

387
00:32:00,400 --> 00:32:04,990
able to do over the course of several
years where they can find a foothold and

388
00:32:04,990 --> 00:32:12,310
sit and watch versus what a person can
do in a week and and there's no way to

389
00:32:12,310 --> 00:32:18,340
overcome that right there just there
just isn't I can't sit there and watch

390
00:32:18,340 --> 00:32:24,730
all your traffic for a year to figure
out your network even if I know even if

391
00:32:24,730 --> 00:32:27,340
I can call you and you can tell me
things that you think will help it's not

392
00:32:27,340 --> 00:32:33,100
the same and really the box that we
built that allows us to do things

393
00:32:33,100 --> 00:32:37,360
remotely the remote part is cool and
that's where like you get to drop

394
00:32:37,360 --> 00:32:42,020
acronyms alte and
and WPA and all this stuff that that

395
00:32:42,020 --> 00:32:51,039
sounds neat but but the real
game-changing part of that is that we

396
00:32:51,039 --> 00:32:59,390
can leverage that to bring a real
pentest like like when we saw all those

397
00:32:59,390 --> 00:33:06,200
security folks in here throw their hands
up you get 20 guys whoever the best

398
00:33:06,200 --> 00:33:11,809
person is for whatever we're attacking
that's the person we pull in to attack

399
00:33:11,809 --> 00:33:18,168
you so you really do that's the best way
to close the gap between what you can do

400
00:33:18,169 --> 00:33:24,440
in a week and what a nation-state could
do is it's all about scale right and

401
00:33:24,440 --> 00:33:30,470
that's really you like we can save
people money we get flexibility we get

402
00:33:30,470 --> 00:33:40,309
to stay home the real value is you get
the full force of what 80 hackers who do

403
00:33:40,309 --> 00:33:48,590
this as a job can deliver through your
wireless network and and past that I

404
00:33:48,590 --> 00:33:52,189
mean you saw everything that was in
there it's all stuff we bought off

405
00:33:52,190 --> 00:33:56,480
Amazon like this is not this is one of
those things that you guys just sitting

406
00:33:56,480 --> 00:33:59,990
there right now could order all of this
stuff and have your own platform up all

407
00:33:59,990 --> 00:34:04,640
the tools we use are all open-source git
clone all of them and install them and

408
00:34:04,640 --> 00:34:08,149
they're there and then you can learn it
too I mean that's that's the other part

409
00:34:08,149 --> 00:34:12,859
of this is that this is something we
built because we were hackers that you

410
00:34:12,859 --> 00:34:16,969
know saw a better way but this is also
to say that you guys can do basically

411
00:34:16,969 --> 00:34:21,739
the same thing that's the real story
time Iliad news story time real surgeon

412
00:34:21,739 --> 00:34:26,178
okay so you want to go first you have
your first what I get to I got two

413
00:34:26,179 --> 00:34:29,330
really good ones
all right you go get your first one okay

414
00:34:29,330 --> 00:34:37,909
so we had a client who had a gosh a
thousand sites in the u.s. probably more

415
00:34:37,909 --> 00:34:47,679
than that we we picked six to test over
two weeks

416
00:34:47,770 --> 00:34:53,259
I'm gonna drop all of the pretenses of
remote versus on site for this because

417
00:34:53,260 --> 00:34:56,290
it doesn't it doesn't really matter
we're talking more about Wireless and

418
00:34:56,290 --> 00:35:01,630
why Wireless is a is a reasonable thing
to test and quit talking about like some

419
00:35:01,630 --> 00:35:06,730
some redheaded stepchild of your network
it's joined to your network it's part of

420
00:35:06,730 --> 00:35:15,010
your network I showed up at the clients
first site on Monday morning I got there

421
00:35:15,010 --> 00:35:19,690
at about seven thirty forty thirty
meeting through a my regular little set

422
00:35:19,690 --> 00:35:23,640
up from my phone in a rental car in
their parking lot

423
00:35:23,640 --> 00:35:28,029
caught a hash sent it to one of the guys
on our team who has access to our

424
00:35:28,030 --> 00:35:32,500
cracking rig remotely crack the hash
send it to me I walk into the first

425
00:35:32,500 --> 00:35:38,670
meeting with the client on-site on a
Monday morning with local admin access

426
00:35:38,670 --> 00:35:45,940
on their network they were not ready
they were not ready for that

427
00:35:45,940 --> 00:35:54,280
and this client they're one of my
favorite clients they they're their lead

428
00:35:54,280 --> 00:36:02,740
security officer came from from ta oh
right so so nsa-level Ops blue team guy

429
00:36:02,740 --> 00:36:11,339
he knew what he was doing he knew his
exposure and he was not ready for that

430
00:36:11,340 --> 00:36:18,640
like he really didn't I went in
shake hands hey POC 1 POC - nice to meet

431
00:36:18,640 --> 00:36:23,890
you guys I'm almost doing admin on your
wireless network pen test from your

432
00:36:23,890 --> 00:36:31,900
parking lot in 20 minutes like it's a
it's a mic drop like I can't there's a

433
00:36:31,900 --> 00:36:36,070
stand and I appreciate the sound guy so
I'm not gonna do it but it's a mic drop

434
00:36:36,070 --> 00:36:40,450
moment right they they they respond to
that exactly how we would to think and

435
00:36:40,450 --> 00:36:45,879
they start to think about their wireless
network like a real network like it's

436
00:36:45,880 --> 00:36:51,580
easy it's easy to throw this bubble
around oh but it's wireless it's like

437
00:36:51,580 --> 00:36:56,410
mmm
do they login with LDAP cuz that's your

438
00:36:56,410 --> 00:37:03,109
network I that that model of Wireless is
thing that we think about after we've

439
00:37:03,110 --> 00:37:09,320
tested the the RealNetworks
is dumb like it's been done for a long

440
00:37:09,320 --> 00:37:15,860
time we can prove that it's dumb now
so real Wireless is it's it's a thing

441
00:37:15,860 --> 00:37:21,650
your users use it your LDAP uses it and
that and that's a legit company with

442
00:37:21,650 --> 00:37:26,360
really really really smart people
running they have a sock they have a

443
00:37:26,360 --> 00:37:31,130
blue team they have spunk
they have carbon black they have all of

444
00:37:31,130 --> 00:37:36,410
the things that you would deploy to
defend your network and we did it from a

445
00:37:36,410 --> 00:37:41,029
rental car in a parking lot in 15
minutes it's a good story

446
00:37:41,030 --> 00:37:45,590
what's artwork is hardware from Amazon
that's the nono specialized stuff on

447
00:37:45,590 --> 00:37:50,510
there hundred fifty bucks yeah we look
that up for them alright so so my story

448
00:37:50,510 --> 00:37:56,660
this is a this was a really fun one show
up there's a you know there enterprise

449
00:37:56,660 --> 00:37:59,509
network was was rock-solid there was
nothing there that I was gonna really

450
00:37:59,510 --> 00:38:04,130
touch so what I did is the hey I hopped
on guess you know they're guest Wi-Fi

451
00:38:04,130 --> 00:38:07,940
cuz they provide it to everybody and
then I proceeded to kick everybody off

452
00:38:07,940 --> 00:38:12,110
of their enterprise network so what
happens people need internet they need

453
00:38:12,110 --> 00:38:16,700
to work they all hop on guests just to
get out to the normal Internet I'm

454
00:38:16,700 --> 00:38:21,169
sitting there and I'm just catching all
of their network track traffic as it

455
00:38:21,170 --> 00:38:26,180
goes through capture some hashes again
we crack the hashes I compromise their

456
00:38:26,180 --> 00:38:31,399
device their laptop and then I stop stop
you know after I compromise their device

457
00:38:31,400 --> 00:38:34,970
I stop nuking their corporate Wi-Fi so
everything goes back to normal

458
00:38:34,970 --> 00:38:39,830
they reconnect to their corporate Wi-Fi
which was rock-solid mind you but now

459
00:38:39,830 --> 00:38:45,470
that laptop is mine and it's on their
corporate network and in probably less

460
00:38:45,470 --> 00:38:48,669
than a couple hours it was a complete
compromise of their internal domain

461
00:38:48,670 --> 00:38:53,360
again it was all from just the fact that
no you know everybody has firewalls for

462
00:38:53,360 --> 00:38:56,330
their external stuff that's on the
internet everybody has firewalls

463
00:38:56,330 --> 00:39:00,980
everybody has you know all their metrics
and logs and all that stuff nobody has

464
00:39:00,980 --> 00:39:04,640
any of that for Wi-Fi you know if they
would have been alerted that you know

465
00:39:04,640 --> 00:39:08,000
there's crazy nefarious things going on
with Wi-Fi that would been the first

466
00:39:08,000 --> 00:39:11,210
tip-off if they had been alerted that a
rogue access point had been stood up

467
00:39:11,210 --> 00:39:14,380
that would have been another tip off but
nobody implements these

468
00:39:14,380 --> 00:39:18,760
and because of it it's really just you
know it's a huge glaring chink in the

469
00:39:18,760 --> 00:39:24,760
armor that is a huge blind spot really
and I mean have you ever done ideas or

470
00:39:24,760 --> 00:39:29,970
maybe is warning Wireless I've never
ever had one and then one of my house

471
00:39:29,970 --> 00:39:35,230
I've never had one from a client it's
never happened and and and that's not to

472
00:39:35,230 --> 00:39:37,720
say Oh Matt has like the most robust
gear in the world

473
00:39:37,720 --> 00:39:42,160
it's like stock yeah it's just love the
thing that like people don't turn on

474
00:39:42,160 --> 00:39:44,740
because it creates a lot of alerts and
you have to get to know your wireless

475
00:39:44,740 --> 00:39:47,890
airspace and a lot of people think like
now that's after like whatever I'm not

476
00:39:47,890 --> 00:39:51,129
gonna do that it doesn't really matter
no one's actually gonna come on-site and

477
00:39:51,130 --> 00:39:57,010
actually do this it's a soft outer
Millie for corporate networks the outer

478
00:39:57,010 --> 00:40:01,150
belly is dangerous you know you don't
see a lot of outer bellies the inner

479
00:40:01,150 --> 00:40:04,210
bellies what we don't talk about those a
soft underside right that's what an

480
00:40:04,210 --> 00:40:08,460
internal pentest is your wireless
network is your soft outer belly

481
00:40:08,460 --> 00:40:15,420
I'm coining that hashtag outer belly
2019 Cybercom 2019

482
00:40:15,420 --> 00:40:24,000
sorry you want to go into another one or
no more so so I got one more yeah so

483
00:40:24,000 --> 00:40:31,210
just it just to demonstrate Eric's
really smart Eric is a civil engineer by

484
00:40:31,210 --> 00:40:36,100
trade who happened in depend testing
he's had his master's degree in civil

485
00:40:36,100 --> 00:40:39,940
engineering since he was 25 which people
don't I don't know about civil

486
00:40:39,940 --> 00:40:42,970
engineering because nobody will talk to
me about it because I'm not smart enough

487
00:40:42,970 --> 00:40:48,370
to be talked about or talked to about
there's clauses and semicolons in there

488
00:40:48,370 --> 00:40:56,700
um I'm not I'm an old I'm 40 years old I
can't depend testing late in my life

489
00:40:56,700 --> 00:41:04,980
anybody can learn this stuff this is not
hard if you have eight to ten months and

490
00:41:04,980 --> 00:41:09,580
I'm not saying that as like you should
all be pen testers because I like my job

491
00:41:09,580 --> 00:41:13,390
and it's really good
I don't want to compete against you I'm

492
00:41:13,390 --> 00:41:19,690
saying it because that's your threat
model like you got you got a bus stop by

493
00:41:19,690 --> 00:41:29,080
you where some are high school kids ride
to work that's that's not high bar you

494
00:41:29,080 --> 00:41:33,759
don't have to be very smart to know this
Eric wins because he's clever

495
00:41:33,760 --> 00:41:43,210
I went by attrition I I can't
I had the OCD you saw the box you heard

496
00:41:43,210 --> 00:41:49,480
the sounds I made when I look at the box
it's a problem it's wheel and that box

497
00:41:49,480 --> 00:41:53,980
on your network and then we can we can
literally put so if you're sitting next

498
00:41:53,980 --> 00:41:56,770
to one of the SecureWorks guys who raise
their hand

499
00:41:56,770 --> 00:42:03,790
look at them when I say the next name we
can put people like Viet on their

500
00:42:03,790 --> 00:42:14,529
network if via is China and that's not
in like an Asian centric way like that

501
00:42:14,530 --> 00:42:21,730
guy will destroy you he is the smartest
person I've ever talked to and he's

502
00:42:21,730 --> 00:42:26,380
really nice and when he shows up on your
site he'll take all of your things away

503
00:42:26,380 --> 00:42:34,200
from you and now we can put him on your
site from his house in Grand Rapids and

504
00:42:34,200 --> 00:42:40,000
and on the Viet node to Viet just went
on the wireless gig and he and he just

505
00:42:40,000 --> 00:42:43,120
asked hey Matt can you make me another
one of these wireless RTA's so that

506
00:42:43,120 --> 00:42:48,400
might can be in two places at once
here guys all right gate on site so that

507
00:42:48,400 --> 00:42:54,940
he could be attacking on site and bring
the other 30 guys in this room on site

508
00:42:54,940 --> 00:43:01,600
with him right it's it's like cheap
airfare it's a it's bad news in Viet

509
00:43:01,600 --> 00:43:05,350
needs no help
he thought she's actually smarter than

510
00:43:05,350 --> 00:43:10,240
Eric a lot of people aren't so good he
won't go into questions do you want to

511
00:43:10,240 --> 00:43:20,839
do yeah just open it up yeah Russians
okay um since you're using off-the-shelf

512
00:43:20,839 --> 00:43:26,460
components it would seem that your
system would be vulnerable awesome and

513
00:43:26,460 --> 00:43:39,780
what do you do with all the open source
stuff you should talk to John right

514
00:43:39,780 --> 00:43:44,520
there in the green shirt he makes all
those problems go away for us well and

515
00:43:44,520 --> 00:43:48,450
the other the other part of that too is
that that device is a under completely

516
00:43:48,450 --> 00:43:52,830
under our control we have you know we
put we do security practices on it so we

517
00:43:52,830 --> 00:43:57,690
put everything in place cert based on
thank you - yeah you know you'd have to

518
00:43:57,690 --> 00:44:03,510
get our private SSH keys and and and
access it from our VPN and it's going

519
00:44:03,510 --> 00:44:08,310
over LTE so there's multiple layers of
encryption just it getting to us and

520
00:44:08,310 --> 00:44:13,349
there's a new one for every client that
we have so if if somebody were to just

521
00:44:13,349 --> 00:44:18,930
steal it and go home with it then
technically there should be anything on

522
00:44:18,930 --> 00:44:22,440
it at all like it like there's nothing
there and it's unique to even that

523
00:44:22,440 --> 00:44:25,920
client so if the network admin wanted to
like pull it as B cards out and mount

524
00:44:25,920 --> 00:44:30,060
them great that's all their own network
data anyways and that's and that's one

525
00:44:30,060 --> 00:44:33,240
of those arguments that kind of works
both ways right like the open source

526
00:44:33,240 --> 00:44:36,450
thing is always complicated you're like
oh it's open source so people can see

527
00:44:36,450 --> 00:44:42,419
the source code oh it's open source so
it's always pen tested it's it it's one

528
00:44:42,420 --> 00:45:00,930
of those it's all gray right it's it's
hard to say yeah you yes yes so so

529
00:45:00,930 --> 00:45:06,270
initially we were printing these in PLA
we use a 3d printer for all of the

530
00:45:06,270 --> 00:45:13,950
fabrication PLA has a melting point at
about a hundred and sixty Celsius which

531
00:45:13,950 --> 00:45:20,279
is hotter than the maximum operating
temperature of a PI but close enough

532
00:45:20,280 --> 00:45:24,810
that we were getting warp so we wound up
changing the materials that we were

533
00:45:24,810 --> 00:45:30,930
using first to ABS which is like Lego
plastic that same same material they

534
00:45:30,930 --> 00:45:33,839
used to print like over
still a little soft and we had some

535
00:45:33,840 --> 00:45:43,110
warping issues so we went to PT PT plus
which is mmm like a water bottle plastic

536
00:45:43,110 --> 00:45:46,170
yeah thank you
right there you you know what the

537
00:45:46,170 --> 00:45:50,940
acronyms mean that's huge
I have no idea I just press buttons but

538
00:45:50,940 --> 00:45:54,030
it has it has a melting temperature of
printing temperature of about 220

539
00:45:54,030 --> 00:46:02,550
degrees Celsius and Eric Wright Lee was
initially concerned about fire we proved

540
00:46:02,550 --> 00:46:07,710
that we could not burn a box down
because the pies would completely stop

541
00:46:07,710 --> 00:46:13,320
functioning way below the point where
the materials would catch on fire it's

542
00:46:13,320 --> 00:46:18,690
that's a real test that we did I bought
some cool stuff to do that test Thank

543
00:46:18,690 --> 00:46:33,720
You SecureWorks yeah yeah uh we have
their 2-1 they even sell for watt

544
00:46:33,720 --> 00:46:37,589
injectors on Amazon sour Dick donk
yeah that's a fire if you turn that on

545
00:46:37,590 --> 00:46:40,410
it's gonna get hot it's gonna draw a lot
of power and people might knock on your

546
00:46:40,410 --> 00:46:46,100
door the two watts will nuke everything

547
00:46:46,130 --> 00:46:50,900
yes yeah absolutely 100%

548
00:46:53,329 --> 00:47:13,730
no comment we can talk after the talk
went back mm that is a great question uh

549
00:47:15,859 --> 00:47:20,190
gosh
yeah we're just like doing that the

550
00:47:20,190 --> 00:47:27,410
mental math 500 dollars in 30 years
you know the plumber joke

551
00:47:27,410 --> 00:47:33,930
he just just say the Plumber Joe the
plumber plumber shows up your house it's

552
00:47:33,930 --> 00:47:37,680
like oh I got a leak cool let's see he
looks at it he does some stuff you don't

553
00:47:37,680 --> 00:47:43,410
understand what he's doing it seems like
magic he has really fixed in 20 minutes

554
00:47:43,410 --> 00:47:46,170
any walks out and he gives you a bill
for $300

555
00:47:46,170 --> 00:47:55,349
you're like $300 for 20 minutes and he
says 20 minutes in 46 years so I totally

556
00:47:55,349 --> 00:47:59,220
get your question and I would be happy
to talk to you outside of outside of the

557
00:47:59,220 --> 00:48:24,439
amplified Tommy we're having here it's
it's affordable but it's work so yeah no

558
00:48:24,440 --> 00:48:29,130
no they have to ship them back and then
we wrote a bunch of scripts up to shred

559
00:48:29,130 --> 00:48:33,990
everything so that when they ship them
back the boxes won't boot again that it

560
00:48:33,990 --> 00:48:37,979
is destroyed yeah before they should
back that was the thing that we didn't

561
00:48:37,980 --> 00:48:43,609
add to later oh the elder gentleman in
the center

562
00:48:50,570 --> 00:48:54,870
that's the best question I'm gonna let
every game so this one and I'm gonna

563
00:48:54,870 --> 00:49:06,660
move over here don't don't take cheap
lipo fat or don't take lipo batteries

564
00:49:06,660 --> 00:49:14,580
that don't have a case on them to an
airport why because if if you so as you

565
00:49:14,580 --> 00:49:23,400
as much look at them so wrong way just
start the beginning Dobson Garrick Nick

566
00:49:23,400 --> 00:49:28,350
all right all right so no thank you
Michael was my boss at the time of this

567
00:49:28,350 --> 00:49:32,310
incident I had a lipo battery in my
backpack we just come back from

568
00:49:32,310 --> 00:49:36,420
engagements in Orlando International
Airport and something happened to that

569
00:49:36,420 --> 00:49:40,020
battery it malfunctioned I don't know it
wasn't plugged in any super cheap it

570
00:49:40,020 --> 00:49:46,470
wasn't it was sayin dollars in anyways
so it started smoking when I was in line

571
00:49:46,470 --> 00:49:52,049
for TSA and so like that's bad enough
and so I knew what's happened it's like

572
00:49:52,050 --> 00:49:55,590
oh the battery spending so I grab some
TSA genomic hey battery spending like

573
00:49:55,590 --> 00:49:59,280
boats to go outside left my backpack
there which lots of residual steam

574
00:49:59,280 --> 00:50:05,070
coming out of it so people in lying is
no that wasn't steam that was smoked s

575
00:50:05,070 --> 00:50:07,910
factory smoke

576
00:50:10,100 --> 00:50:16,549
and so everybody scattered knocked over
some of the like the line dividing

577
00:50:16,550 --> 00:50:21,260
pylons which sounded apparently like
gunshots so today and and airplanes that

578
00:50:21,260 --> 00:50:30,020
were flying in the air and the TSA agent
got here gun gunfire and said shots

579
00:50:30,020 --> 00:50:39,890
fired over the radio yeah so everybody
scattered yeah yeah everybody ran people

580
00:50:39,890 --> 00:50:45,020
ran through security the opposite way
into all the gates and so what they had

581
00:50:45,020 --> 00:50:49,070
to do is they they couldn't be sure that
those planes that were in air didn't

582
00:50:49,070 --> 00:50:52,220
have people that had jumped through
security and so they had to turn those

583
00:50:52,220 --> 00:50:55,700
planes around you know because maybe I
was creating a diversion you know that's

584
00:50:55,700 --> 00:50:59,509
what that's what they were thinking
which is reasonable right and so they

585
00:50:59,510 --> 00:51:04,190
turn those planes around cancel all the
other flights and then they had to flush

586
00:51:04,190 --> 00:51:08,000
everybody that had already gone through
security back out and around through

587
00:51:08,000 --> 00:51:11,570
security in so if you think you've seen
TSA and it's worse that was it's worse

588
00:51:11,570 --> 00:51:21,650
was everybody going back I'm working on
three that was these guys are doing the

589
00:51:21,650 --> 00:51:26,870
wireless India we're also helping do
part of the capture time we have some

590
00:51:26,870 --> 00:51:36,740
challenge flowing so if you win
CTF yes

591
00:51:36,740 --> 00:51:39,740
so everybody come play when I capture
the flag if you don't have beer don't

592
00:51:39,740 --> 00:51:44,899
worry we have gear that you can borrow
and we will teach you things if you can

593
00:51:44,900 --> 00:51:48,560
turn on a laptop you can play our
Wireless capture the flag in fact I

594
00:51:48,560 --> 00:51:53,870
think they're actually a couple of
wireless foxes in this room - so what

595
00:51:53,870 --> 00:52:01,589
hey we just finished a fight

596
00:52:51,470 --> 00:52:53,529
you

