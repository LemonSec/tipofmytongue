1
00:00:39,360 --> 00:00:41,360
welcome to the fun session hiding in the

2
00:00:41,360 --> 00:00:43,680
clouds how attacker can use applications

3
00:00:43,680 --> 00:00:46,719
for persistence and how to find it i'm

4
00:00:46,719 --> 00:00:48,800
gloria lee and i'm with my beautiful

5
00:00:48,800 --> 00:00:51,440
colleague oana inoke we're program

6
00:00:51,440 --> 00:00:53,280
managers in the identity division at

7
00:00:53,280 --> 00:00:55,760
microsoft we're responsible for azure

8
00:00:55,760 --> 00:00:57,520
active directory active directory

9
00:00:57,520 --> 00:01:00,239
federation services and we work on teams

10
00:01:00,239 --> 00:01:01,600
that works with

11
00:01:01,600 --> 00:01:04,400
many many customers on their deployments

12
00:01:04,400 --> 00:01:06,560
of azure active directory and we take

13
00:01:06,560 --> 00:01:08,240
those learnings and the feedback from

14
00:01:08,240 --> 00:01:10,320
those deployments we'll get back into

15
00:01:10,320 --> 00:01:12,000
the product to make it easier and better

16
00:01:12,000 --> 00:01:13,200
for everyone

17
00:01:13,200 --> 00:01:16,000
so if you have office 365 and people

18
00:01:16,000 --> 00:01:17,920
here probably attending in the security

19
00:01:17,920 --> 00:01:19,759
conference sometimes don't spend a lot

20
00:01:19,759 --> 00:01:22,479
of time in identity space like on myself

21
00:01:22,479 --> 00:01:24,799
but if you do have office 365 you have

22
00:01:24,799 --> 00:01:26,880
azure active directory as we work with a

23
00:01:26,880 --> 00:01:28,799
lot of customers on this issue so i

24
00:01:28,799 --> 00:01:30,799
think you may also known or heard that

25
00:01:30,799 --> 00:01:32,880
we have some good stuff here so

26
00:01:32,880 --> 00:01:35,759
let's take a look at the agenda slide

27
00:01:35,759 --> 00:01:37,360
we're going to share so what we're going

28
00:01:37,360 --> 00:01:39,680
to first cover here is what is

29
00:01:39,680 --> 00:01:41,600
application consent and why should you

30
00:01:41,600 --> 00:01:44,079
care about it if you aren't already and

31
00:01:44,079 --> 00:01:45,280
i'm going to talk about some of those

32
00:01:45,280 --> 00:01:46,799
key permissions you should be looking

33
00:01:46,799 --> 00:01:49,360
for and oana is going to find some of

34
00:01:49,360 --> 00:01:51,360
the stuff in your environment with you

35
00:01:51,360 --> 00:01:53,439
during the demo and then lastly we're

36
00:01:53,439 --> 00:01:55,119
going to cover some best practices and

37
00:01:55,119 --> 00:01:57,119
then things that you can go do so

38
00:01:57,119 --> 00:01:58,799
there's a lot of fun stuff in this talk

39
00:01:58,799 --> 00:02:00,560
we're going to make the slides available

40
00:02:00,560 --> 00:02:02,719
at the very end hopefully we have lots

41
00:02:02,719 --> 00:02:04,479
of good things you can go back and do in

42
00:02:04,479 --> 00:02:07,040
your environment to protect yourself

43
00:02:07,040 --> 00:02:08,720
why should you care about applications

44
00:02:08,720 --> 00:02:10,878
if you haven't been doing so already

45
00:02:10,878 --> 00:02:13,280
on average an organization will have 140

46
00:02:13,280 --> 00:02:15,760
apps but this can be a number that

47
00:02:15,760 --> 00:02:17,920
varies greatly depending on the size of

48
00:02:17,920 --> 00:02:19,840
your organization so some of the

49
00:02:19,840 --> 00:02:21,440
customers that we work with are

50
00:02:21,440 --> 00:02:24,000
extremely large and it's not uncommon to

51
00:02:24,000 --> 00:02:25,360
have thousands and thousands of

52
00:02:25,360 --> 00:02:26,640
applications

53
00:02:26,640 --> 00:02:28,319
one of the customer our team is working

54
00:02:28,319 --> 00:02:29,920
with is modernizing all their

55
00:02:29,920 --> 00:02:32,239
applications to move the azure id if you

56
00:02:32,239 --> 00:02:34,480
take a guess how long it would take

57
00:02:34,480 --> 00:02:35,840
they think it's going to take them

58
00:02:35,840 --> 00:02:37,760
anywhere from seven to nine years to

59
00:02:37,760 --> 00:02:39,440
move all the application

60
00:02:39,440 --> 00:02:42,239
to modernize authentication

61
00:02:42,239 --> 00:02:45,440
so 140 is just kind of like a low number

62
00:02:45,440 --> 00:02:47,840
but you probably know better than anyone

63
00:02:47,840 --> 00:02:49,599
how many applications you have in your

64
00:02:49,599 --> 00:02:50,879
environment

65
00:02:50,879 --> 00:02:53,280
87 percent of the user today can consent

66
00:02:53,280 --> 00:02:55,920
to applications in the act of consenting

67
00:02:55,920 --> 00:02:58,319
to an application which we will get to

68
00:02:58,319 --> 00:02:59,680
hear shortly

69
00:02:59,680 --> 00:03:02,640
isn't necessarily bad or malicious but

70
00:03:02,640 --> 00:03:04,080
there are some things that allowed

71
00:03:04,080 --> 00:03:06,239
application to do in your environment

72
00:03:06,239 --> 00:03:09,200
which you may or may not want them to do

73
00:03:09,200 --> 00:03:11,760
as blue teamers as defenders we really

74
00:03:11,760 --> 00:03:14,080
care about these offenses

75
00:03:14,080 --> 00:03:16,640
so you may not be aware of these

76
00:03:16,640 --> 00:03:18,560
uprising threats with the application

77
00:03:18,560 --> 00:03:21,280
consent but you do you do need to

78
00:03:21,280 --> 00:03:24,159
uh as architects as security folks blue

79
00:03:24,159 --> 00:03:26,319
team or defenders

80
00:03:26,319 --> 00:03:28,080
because just because you can consent an

81
00:03:28,080 --> 00:03:30,640
application means application can do

82
00:03:30,640 --> 00:03:33,200
stuff you may or may not want it to do

83
00:03:33,200 --> 00:03:34,560
depending on your environment your

84
00:03:34,560 --> 00:03:36,959
organization risk tolerance and things

85
00:03:36,959 --> 00:03:39,280
like that from our learning we see

86
00:03:39,280 --> 00:03:42,080
eighty percent of employees are using

87
00:03:42,080 --> 00:03:44,319
not approved apps when working and you

88
00:03:44,319 --> 00:03:46,159
probably heard about this term called

89
00:03:46,159 --> 00:03:48,799
shadow i.t then again shadow i.t doesn't

90
00:03:48,799 --> 00:03:50,319
mean it's malicious

91
00:03:50,319 --> 00:03:52,879
doesn't mean that they are intended to

92
00:03:52,879 --> 00:03:55,280
do bad things but if you don't pay

93
00:03:55,280 --> 00:03:57,519
attention it could cause compromise or

94
00:03:57,519 --> 00:04:00,000
security incident in your environment so

95
00:04:00,000 --> 00:04:01,840
if you haven't start paying attention

96
00:04:01,840 --> 00:04:03,840
you really really should

97
00:04:03,840 --> 00:04:06,159
what is an application consent i'm going

98
00:04:06,159 --> 00:04:09,280
to move this light here

99
00:04:09,760 --> 00:04:12,239
you're probably familiar with this

100
00:04:12,239 --> 00:04:14,879
with your mobile phone you can add an

101
00:04:14,879 --> 00:04:17,358
application from the app store when you

102
00:04:17,358 --> 00:04:19,519
add the application it's going to be

103
00:04:19,519 --> 00:04:21,680
started asking a bunch of permissions

104
00:04:21,680 --> 00:04:23,759
that it wants to be able to do

105
00:04:23,759 --> 00:04:26,560
so it wants to maybe access your camera

106
00:04:26,560 --> 00:04:28,800
because it's going to take your picture

107
00:04:28,800 --> 00:04:31,199
and it needs modification permissions

108
00:04:31,199 --> 00:04:33,440
because you may want to put funny faces

109
00:04:33,440 --> 00:04:36,800
or uh editing or write messages whatever

110
00:04:36,800 --> 00:04:38,240
that you're going to do

111
00:04:38,240 --> 00:04:39,520
the application wants to access your

112
00:04:39,520 --> 00:04:42,000
photo library so you can edit the photos

113
00:04:42,000 --> 00:04:44,320
and also once access your contacts so

114
00:04:44,320 --> 00:04:46,320
that way you can send the funny photo

115
00:04:46,320 --> 00:04:48,160
directly from the application to your

116
00:04:48,160 --> 00:04:50,320
co-workers friends or family things like

117
00:04:50,320 --> 00:04:52,560
that so the application consent model in

118
00:04:52,560 --> 00:04:55,199
azure id and most cloud applications are

119
00:04:55,199 --> 00:04:58,080
as such well i'm not going to talk about

120
00:04:58,080 --> 00:05:00,320
from azure ad perspective but this

121
00:05:00,320 --> 00:05:02,639
applies to any oauth open id connect

122
00:05:02,639 --> 00:05:05,039
application as well not just specific to

123
00:05:05,039 --> 00:05:06,880
azure ad

124
00:05:06,880 --> 00:05:08,160
so this is where we're going to talk

125
00:05:08,160 --> 00:05:10,400
from our point of view the consent model

126
00:05:10,400 --> 00:05:11,520
of the application consent and

127
00:05:11,520 --> 00:05:12,639
permission

128
00:05:12,639 --> 00:05:14,560
very very similar model in azure active

129
00:05:14,560 --> 00:05:17,520
directory so we have an application that

130
00:05:17,520 --> 00:05:19,360
is going to want to have access to

131
00:05:19,360 --> 00:05:21,600
organization data and the organization

132
00:05:21,600 --> 00:05:23,919
data is going to be exposed via resource

133
00:05:23,919 --> 00:05:25,840
apis and there's different permission

134
00:05:25,840 --> 00:05:28,080
levels for those apis so we're going to

135
00:05:28,080 --> 00:05:30,000
get into all of that in a little bit and

136
00:05:30,000 --> 00:05:32,240
those permissions can be granted through

137
00:05:32,240 --> 00:05:34,800
the process called application consent

138
00:05:34,800 --> 00:05:36,560
and we have two different type of

139
00:05:36,560 --> 00:05:38,880
consent we have an admin consent and we

140
00:05:38,880 --> 00:05:42,080
have a user end user consent so let's go

141
00:05:42,080 --> 00:05:45,359
over some key terms here

142
00:05:47,039 --> 00:05:49,039
let's talk about these different terms

143
00:05:49,039 --> 00:05:51,120
it's going to be high level but it

144
00:05:51,120 --> 00:05:53,120
allows us to dig in to align ourselves

145
00:05:53,120 --> 00:05:56,319
to open id oauth type of specs so the

146
00:05:56,319 --> 00:05:58,160
first thing here is we have a term

147
00:05:58,160 --> 00:06:00,319
called client application this is going

148
00:06:00,319 --> 00:06:03,120
to be like the mobile app web app and it

149
00:06:03,120 --> 00:06:04,560
can be an application that's running in

150
00:06:04,560 --> 00:06:06,080
the background that is going to be

151
00:06:06,080 --> 00:06:08,800
requesting data on behalf of that user

152
00:06:08,800 --> 00:06:11,199
then we have the resource application

153
00:06:11,199 --> 00:06:13,840
which is going to be usually a web api

154
00:06:13,840 --> 00:06:18,479
that exposes this data or functionality

155
00:06:19,120 --> 00:06:21,360
it is called microsoft graph and then we

156
00:06:21,360 --> 00:06:23,199
have permissions which is what the

157
00:06:23,199 --> 00:06:25,919
client application is asking to be able

158
00:06:25,919 --> 00:06:28,319
to perform on that data owned by that

159
00:06:28,319 --> 00:06:29,440
resource

160
00:06:29,440 --> 00:06:31,680
here we have a screenshot of this take a

161
00:06:31,680 --> 00:06:33,280
look you may have seen this in your

162
00:06:33,280 --> 00:06:35,680
environment where we have an application

163
00:06:35,680 --> 00:06:38,000
here and this one is called contoso test

164
00:06:38,000 --> 00:06:38,720
app

165
00:06:38,720 --> 00:06:40,639
this application would like to read and

166
00:06:40,639 --> 00:06:42,960
share user contacts sign in and read

167
00:06:42,960 --> 00:06:45,199
user profile read and share user

168
00:06:45,199 --> 00:06:47,039
calendars this is going through

169
00:06:47,039 --> 00:06:48,400
microsoft graph

170
00:06:48,400 --> 00:06:50,479
another example is onedrive some

171
00:06:50,479 --> 00:06:52,560
application wants to read your files in

172
00:06:52,560 --> 00:06:54,479
the onedrive box this is kind of like

173
00:06:54,479 --> 00:06:56,000
the dialogues box and it's going to look

174
00:06:56,000 --> 00:06:58,240
like so on i will be showing you a demo

175
00:06:58,240 --> 00:07:00,800
later and walk through these

176
00:07:00,800 --> 00:07:03,039
now next we need to take a look at the

177
00:07:03,039 --> 00:07:04,720
consent terms

178
00:07:04,720 --> 00:07:07,520
because it's also very important as we

179
00:07:07,520 --> 00:07:08,960
walk through this if you've never seen

180
00:07:08,960 --> 00:07:11,199
this before but let's talk about these

181
00:07:11,199 --> 00:07:12,639
terminology

182
00:07:12,639 --> 00:07:14,319
these dialect box that we just showed

183
00:07:14,319 --> 00:07:16,560
you earlier it's called consent prompt

184
00:07:16,560 --> 00:07:19,199
and then we have the act of saying yes

185
00:07:19,199 --> 00:07:21,599
it's called consent grant it is pretty

186
00:07:21,599 --> 00:07:23,599
straightforward

187
00:07:23,599 --> 00:07:25,360
but here's what's going to be different

188
00:07:25,360 --> 00:07:26,319
a little

189
00:07:26,319 --> 00:07:28,080
bit of it you know the phone type of

190
00:07:28,080 --> 00:07:30,400
model that we talked about you may or

191
00:07:30,400 --> 00:07:32,560
may not be used to i'm guessing here

192
00:07:32,560 --> 00:07:34,960
everyone is probably used to that model

193
00:07:34,960 --> 00:07:35,840
so

194
00:07:35,840 --> 00:07:37,759
in the process of an administrator

195
00:07:37,759 --> 00:07:40,319
consent is when someone with

196
00:07:40,319 --> 00:07:42,000
administrative permissions is going to

197
00:07:42,000 --> 00:07:44,400
be granting access to an application

198
00:07:44,400 --> 00:07:46,479
and we do this because of two different

199
00:07:46,479 --> 00:07:47,520
reasons

200
00:07:47,520 --> 00:07:49,440
the first reason is the application may

201
00:07:49,440 --> 00:07:51,280
be asking for permissions that are

202
00:07:51,280 --> 00:07:53,360
highly privileged and we don't want the

203
00:07:53,360 --> 00:07:55,680
end users to have the ability to say

204
00:07:55,680 --> 00:07:56,879
that's okay

205
00:07:56,879 --> 00:07:58,800
because they may not take time to

206
00:07:58,800 --> 00:08:01,039
understand the permissions being asked

207
00:08:01,039 --> 00:08:03,280
they don't understand the risk it could

208
00:08:03,280 --> 00:08:06,080
be exposed to the business and so they

209
00:08:06,080 --> 00:08:07,759
shouldn't be able to do this

210
00:08:07,759 --> 00:08:09,440
so the application may be asking for the

211
00:08:09,440 --> 00:08:11,039
ability to rewrite all to all the

212
00:08:11,039 --> 00:08:13,599
mailboxes maybe the reason is because

213
00:08:13,599 --> 00:08:16,400
it's an e-discovery app right so we

214
00:08:16,400 --> 00:08:18,240
don't want any user to be able to say

215
00:08:18,240 --> 00:08:19,840
that it's okay

216
00:08:19,840 --> 00:08:22,560
because that is a lot of permissions

217
00:08:22,560 --> 00:08:25,120
and instead the admins will have to go

218
00:08:25,120 --> 00:08:27,520
in there and say well this is a very

219
00:08:27,520 --> 00:08:29,199
privileged operation

220
00:08:29,199 --> 00:08:32,000
but as an admin we're going to say okay

221
00:08:32,000 --> 00:08:34,479
before we can add it to our directory

222
00:08:34,479 --> 00:08:36,159
the other reason why you might do this

223
00:08:36,159 --> 00:08:37,839
an administrator is because when

224
00:08:37,839 --> 00:08:40,320
administrator does consent to grant from

225
00:08:40,320 --> 00:08:42,080
an application they're actually

226
00:08:42,080 --> 00:08:44,640
consenting this application to all the

227
00:08:44,640 --> 00:08:47,040
users in their directory so then the

228
00:08:47,040 --> 00:08:49,600
user will not see the consent dialog box

229
00:08:49,600 --> 00:08:51,200
so the first example that i can think

230
00:08:51,200 --> 00:08:54,080
about this to help is that the native

231
00:08:54,080 --> 00:08:56,480
male client and ios or in fact any other

232
00:08:56,480 --> 00:08:59,279
mail app so say you're going to use the

233
00:08:59,279 --> 00:09:02,080
email client with exchange online the

234
00:09:02,080 --> 00:09:04,320
user opens up the mail app they put

235
00:09:04,320 --> 00:09:06,800
their username and password in and they

236
00:09:06,800 --> 00:09:09,279
do this whole authentication flow

237
00:09:09,279 --> 00:09:10,959
then the application prompts them for

238
00:09:10,959 --> 00:09:12,959
the consent grant experience

239
00:09:12,959 --> 00:09:15,279
wants to be able to like read to their

240
00:09:15,279 --> 00:09:17,519
mailbox read their calendars like basic

241
00:09:17,519 --> 00:09:20,480
stuff the user can say yes i can do that

242
00:09:20,480 --> 00:09:22,640
and they go ahead and click through now

243
00:09:22,640 --> 00:09:24,959
the native mail app on their ios device

244
00:09:24,959 --> 00:09:26,240
gets mail

245
00:09:26,240 --> 00:09:28,720
but before we can say as administrator

246
00:09:28,720 --> 00:09:31,440
or defenders we can say we review and

247
00:09:31,440 --> 00:09:33,760
trust this application we're okay if

248
00:09:33,760 --> 00:09:35,920
people use that and we want to improve

249
00:09:35,920 --> 00:09:38,640
end user experience we're going to go in

250
00:09:38,640 --> 00:09:40,640
in there as administrator and do

251
00:09:40,640 --> 00:09:42,480
administrative consent for this

252
00:09:42,480 --> 00:09:45,279
application now the next person that

253
00:09:45,279 --> 00:09:47,120
goes to use the native mail app for the

254
00:09:47,120 --> 00:09:49,279
first time they will not have to consent

255
00:09:49,279 --> 00:09:51,519
to the application any longer because as

256
00:09:51,519 --> 00:09:53,839
administrator we've already done we've

257
00:09:53,839 --> 00:09:56,560
already done that consent

258
00:09:56,560 --> 00:09:58,800
let's go into some permission terms here

259
00:09:58,800 --> 00:10:00,800
which will help us understand the

260
00:10:00,800 --> 00:10:03,760
different type of the permission models

261
00:10:03,760 --> 00:10:05,120
so there are two different type of

262
00:10:05,120 --> 00:10:07,440
permission that application can consent

263
00:10:07,440 --> 00:10:08,160
to

264
00:10:08,160 --> 00:10:10,560
but the first one here is what we want

265
00:10:10,560 --> 00:10:12,880
most application to be using

266
00:10:12,880 --> 00:10:14,800
which is called delegated permission

267
00:10:14,800 --> 00:10:16,720
model the requirement for the

268
00:10:16,720 --> 00:10:18,560
application to work in the delegated

269
00:10:18,560 --> 00:10:20,640
permission model is that the user must

270
00:10:20,640 --> 00:10:22,800
be signed in and present for the

271
00:10:22,800 --> 00:10:24,720
application to make calls on behalf of

272
00:10:24,720 --> 00:10:25,839
that user

273
00:10:25,839 --> 00:10:27,920
so this is what most end users can

274
00:10:27,920 --> 00:10:29,120
consent to

275
00:10:29,120 --> 00:10:31,040
and if it's a higher privilege

276
00:10:31,040 --> 00:10:33,360
permission it can also require admin to

277
00:10:33,360 --> 00:10:34,959
get involved to consent to this

278
00:10:34,959 --> 00:10:36,640
application

279
00:10:36,640 --> 00:10:38,399
now this is where people tend to get a

280
00:10:38,399 --> 00:10:40,640
little tripped up or confused because

281
00:10:40,640 --> 00:10:43,360
of the effective permission model of the

282
00:10:43,360 --> 00:10:45,040
delegated permission

283
00:10:45,040 --> 00:10:47,040
it is like the intersection of the

284
00:10:47,040 --> 00:10:49,760
user's underlying permissions

285
00:10:49,760 --> 00:10:52,320
and what the application can be granted

286
00:10:52,320 --> 00:10:54,720
to do what do i mean by that

287
00:10:54,720 --> 00:10:57,279
let's say this application is like the

288
00:10:57,279 --> 00:10:59,519
best search application ever it's the

289
00:10:59,519 --> 00:11:01,440
best thing for searching sharepoint

290
00:11:01,440 --> 00:11:03,600
sites and it's asking for the ability to

291
00:11:03,600 --> 00:11:05,920
read all sharepoint sites

292
00:11:05,920 --> 00:11:08,399
and the user consent to this let's say

293
00:11:08,399 --> 00:11:10,399
user has permission to

294
00:11:10,399 --> 00:11:11,360
do

295
00:11:11,360 --> 00:11:14,000
uh consenting the permission they can

296
00:11:14,000 --> 00:11:15,680
send the application they're going to

297
00:11:15,680 --> 00:11:16,720
use it

298
00:11:16,720 --> 00:11:19,120
and they're not getting the ability to

299
00:11:19,120 --> 00:11:21,440
search all these sharepoint sites

300
00:11:21,440 --> 00:11:24,240
because the effective model is the

301
00:11:24,240 --> 00:11:27,200
intersection of the application so that

302
00:11:27,200 --> 00:11:29,519
user only has the ability to read

303
00:11:29,519 --> 00:11:31,279
certain sharepoint sites when they're

304
00:11:31,279 --> 00:11:33,519
using this application

305
00:11:33,519 --> 00:11:36,160
they too again only have the ability to

306
00:11:36,160 --> 00:11:38,480
use that search on the sharepoint sites

307
00:11:38,480 --> 00:11:40,640
that they have access to so i'm trying

308
00:11:40,640 --> 00:11:42,640
to say is you're not really granting

309
00:11:42,640 --> 00:11:44,880
people more permissions than they

310
00:11:44,880 --> 00:11:47,120
normally would have used in this

311
00:11:47,120 --> 00:11:49,200
delegation permission model

312
00:11:49,200 --> 00:11:51,600
it still is what the user has and what

313
00:11:51,600 --> 00:11:53,920
the application is able to do this

314
00:11:53,920 --> 00:11:56,720
sometimes is called scopes oauth2

315
00:11:56,720 --> 00:11:59,040
permission grants or app plus user

316
00:11:59,040 --> 00:12:00,160
permissions

317
00:12:00,160 --> 00:12:02,560
we really really want you to use the

318
00:12:02,560 --> 00:12:05,200
applications that is using the delegated

319
00:12:05,200 --> 00:12:08,079
permission model now the second type of

320
00:12:08,079 --> 00:12:09,680
the permission model is called

321
00:12:09,680 --> 00:12:10,800
application

322
00:12:10,800 --> 00:12:13,760
permissions and these are used by apps

323
00:12:13,760 --> 00:12:15,920
without anyone being signed in our

324
00:12:15,920 --> 00:12:17,920
presence these can run fully in the

325
00:12:17,920 --> 00:12:20,160
background no user required and whatever

326
00:12:20,160 --> 00:12:21,519
permission that you grant to the

327
00:12:21,519 --> 00:12:23,279
application in the application

328
00:12:23,279 --> 00:12:25,519
permission model is the permission the

329
00:12:25,519 --> 00:12:28,000
application has the ability to do so if

330
00:12:28,000 --> 00:12:29,680
there's some permission that is asking

331
00:12:29,680 --> 00:12:31,760
for the ability to do directory rewrite

332
00:12:31,760 --> 00:12:34,560
all the application has the ability to

333
00:12:34,560 --> 00:12:36,720
do directory rewrite all there's no

334
00:12:36,720 --> 00:12:39,200
intersection whatsoever like what we've

335
00:12:39,200 --> 00:12:41,600
granted application can do

336
00:12:41,600 --> 00:12:43,519
so think about these are really

337
00:12:43,519 --> 00:12:45,600
extremely powerful permissions that we

338
00:12:45,600 --> 00:12:47,600
want to make sure we understand why

339
00:12:47,600 --> 00:12:49,440
application needs those permissions and

340
00:12:49,440 --> 00:12:52,240
why it has to have this permission model

341
00:12:52,240 --> 00:12:54,079
we really really want to use the

342
00:12:54,079 --> 00:12:56,720
delegated permission model with the

343
00:12:56,720 --> 00:13:00,160
intersection application permissions

344
00:13:00,160 --> 00:13:02,560
and the application permissions are

345
00:13:02,560 --> 00:13:05,120
always also always required for admins

346
00:13:05,120 --> 00:13:07,680
to consent and users cannot consent to

347
00:13:07,680 --> 00:13:10,079
this this is sometimes called roles app

348
00:13:10,079 --> 00:13:12,480
rules or app only permissions

349
00:13:12,480 --> 00:13:14,720
all right let's dig into the permission

350
00:13:14,720 --> 00:13:17,279
types here

351
00:13:17,279 --> 00:13:19,519
so we have this nice slide here that

352
00:13:19,519 --> 00:13:21,440
tells you about the different permission

353
00:13:21,440 --> 00:13:23,600
types it is kind of a summary of

354
00:13:23,600 --> 00:13:25,760
everything to recap it is a lot of

355
00:13:25,760 --> 00:13:27,600
information that if you ever looked at

356
00:13:27,600 --> 00:13:29,680
this before we have two type of

357
00:13:29,680 --> 00:13:31,600
permissions we have delegated

358
00:13:31,600 --> 00:13:33,760
application permissions in the delegated

359
00:13:33,760 --> 00:13:36,320
model is going to be those mobile apps

360
00:13:36,320 --> 00:13:38,800
those web apps and the single page

361
00:13:38,800 --> 00:13:40,160
applications

362
00:13:40,160 --> 00:13:42,399
both end users or admins can grant to

363
00:13:42,399 --> 00:13:45,519
this admins can consent to all those to

364
00:13:45,519 --> 00:13:47,279
those for all the users in the

365
00:13:47,279 --> 00:13:49,760
organization and this requires a user to

366
00:13:49,760 --> 00:13:51,760
be signed in and present it is the

367
00:13:51,760 --> 00:13:53,440
effective permission model which is a

368
00:13:53,440 --> 00:13:56,000
combination of what the end user has as

369
00:13:56,000 --> 00:13:58,240
well as what the application has the

370
00:13:58,240 --> 00:14:00,000
other permission model which is the

371
00:14:00,000 --> 00:14:02,720
application permission model is when run

372
00:14:02,720 --> 00:14:04,800
as a service and only can be consented

373
00:14:04,800 --> 00:14:06,959
by an administrator whatever permissions

374
00:14:06,959 --> 00:14:09,360
we grant that is what the application

375
00:14:09,360 --> 00:14:11,440
has the ability to do so very very

376
00:14:11,440 --> 00:14:14,079
powerful we want applications to use the

377
00:14:14,079 --> 00:14:15,839
delegated permission model not the

378
00:14:15,839 --> 00:14:17,839
application permissions if we can help

379
00:14:17,839 --> 00:14:18,880
it

380
00:14:18,880 --> 00:14:21,519
with that owana is going to show you a

381
00:14:21,519 --> 00:14:24,000
quick demo of this consent framework

382
00:14:24,000 --> 00:14:27,440
framework anna

383
00:14:28,320 --> 00:14:30,240
thank you so much gloria i think that

384
00:14:30,240 --> 00:14:32,320
was great we had i think maybe 10

385
00:14:32,320 --> 00:14:34,000
minutes of talking about the different

386
00:14:34,000 --> 00:14:35,760
terms and it's time to see that in

387
00:14:35,760 --> 00:14:38,320
action so i'm going to show you both the

388
00:14:38,320 --> 00:14:40,079
end user experience and the admin

389
00:14:40,079 --> 00:14:42,320
experience and see what exactly looks

390
00:14:42,320 --> 00:14:44,560
like when an application is requesting

391
00:14:44,560 --> 00:14:47,680
um consent so here i will start by

392
00:14:47,680 --> 00:14:49,600
showing you the end user experience i

393
00:14:49,600 --> 00:14:52,399
have here my user alice smith and i'm

394
00:14:52,399 --> 00:14:55,040
trying to access an application that i

395
00:14:55,040 --> 00:14:58,639
never tried to uh to access before um

396
00:14:58,639 --> 00:15:01,120
and i see that i need approval in order

397
00:15:01,120 --> 00:15:04,320
to access this application so um

398
00:15:04,320 --> 00:15:06,959
i see also that there is a good mix of

399
00:15:06,959 --> 00:15:09,199
application permissions and delegated

400
00:15:09,199 --> 00:15:11,680
permissions so i say first sign in and

401
00:15:11,680 --> 00:15:13,920
read user profile well maybe that's

402
00:15:13,920 --> 00:15:16,000
that's something that most applications

403
00:15:16,000 --> 00:15:17,279
are requesting

404
00:15:17,279 --> 00:15:20,800
but i also see a list of um application

405
00:15:20,800 --> 00:15:22,560
permissions so having full controls on

406
00:15:22,560 --> 00:15:24,720
all site collections having that read

407
00:15:24,720 --> 00:15:26,240
write

408
00:15:26,240 --> 00:15:28,160
access to

409
00:15:28,160 --> 00:15:30,240
old site collections

410
00:15:30,240 --> 00:15:33,519
and i see that i actually need to

411
00:15:33,519 --> 00:15:36,240
request or access and also give a

412
00:15:36,240 --> 00:15:39,600
justification so i will need to send my

413
00:15:39,600 --> 00:15:40,480
admin

414
00:15:40,480 --> 00:15:43,839
um a reason for why i need to to access

415
00:15:43,839 --> 00:15:45,680
this application

416
00:15:45,680 --> 00:15:48,720
and if there's anything that the user

417
00:15:48,720 --> 00:15:50,720
may find suspicious about this

418
00:15:50,720 --> 00:15:53,279
application we also have the reported

419
00:15:53,279 --> 00:15:54,480
here button

420
00:15:54,480 --> 00:15:55,440
where

421
00:15:55,440 --> 00:15:58,240
the user can provide more information

422
00:15:58,240 --> 00:16:00,560
about why this application doesn't

423
00:16:00,560 --> 00:16:02,530
necessarily look right or

424
00:16:02,530 --> 00:16:04,000
[Music]

425
00:16:04,000 --> 00:16:06,240
maybe request a higher number of

426
00:16:06,240 --> 00:16:10,000
permissions than than expected

427
00:16:10,000 --> 00:16:12,399
so let's see how that would look like

428
00:16:12,399 --> 00:16:15,120
from an admin perspective

429
00:16:15,120 --> 00:16:16,160
um

430
00:16:16,160 --> 00:16:19,360
give me one moment to move this over to

431
00:16:19,360 --> 00:16:21,680
this screen so here i'm logged in with

432
00:16:21,680 --> 00:16:24,160
the global admin and i'm trying to

433
00:16:24,160 --> 00:16:26,320
access the same application

434
00:16:26,320 --> 00:16:28,560
and i no longer see that approval

435
00:16:28,560 --> 00:16:31,120
required but actually right now i see

436
00:16:31,120 --> 00:16:33,440
well this application is requiring this

437
00:16:33,440 --> 00:16:37,440
permissions um and if i consent so if i

438
00:16:37,440 --> 00:16:39,360
accept this application will be

439
00:16:39,360 --> 00:16:41,839
registered in the tenant and other users

440
00:16:41,839 --> 00:16:44,880
will be able to access it uh without

441
00:16:44,880 --> 00:16:46,880
seeing this screen so without seeing

442
00:16:46,880 --> 00:16:49,600
that approval is required screen

443
00:16:49,600 --> 00:16:50,480
um

444
00:16:50,480 --> 00:16:53,040
something else besides the of

445
00:16:53,040 --> 00:16:55,199
the permissions again you can see the

446
00:16:55,199 --> 00:16:56,880
same list of permissions and you can

447
00:16:56,880 --> 00:17:00,639
drill into what the exact um

448
00:17:00,639 --> 00:17:03,120
permission that's required

449
00:17:03,120 --> 00:17:04,720
but something else that i wanted to call

450
00:17:04,720 --> 00:17:08,400
out here is also that this application

451
00:17:08,400 --> 00:17:10,480
is not a microsoft registered

452
00:17:10,480 --> 00:17:12,959
application or is not what we call

453
00:17:12,959 --> 00:17:14,799
publisher verified

454
00:17:14,799 --> 00:17:17,119
and we will talk about this um a little

455
00:17:17,119 --> 00:17:19,839
bit more in later in the presentation

456
00:17:19,839 --> 00:17:22,000
but what it means is that application

457
00:17:22,000 --> 00:17:24,640
this application is not microsoft vetted

458
00:17:24,640 --> 00:17:27,599
so it hasn't been registered using a

459
00:17:27,599 --> 00:17:30,080
microsoft partner account so that's the

460
00:17:30,080 --> 00:17:33,360
other thing that as an admin you can

461
00:17:33,360 --> 00:17:36,799
you can verify and and see if this is a

462
00:17:36,799 --> 00:17:40,320
um if this is a legitimate application

463
00:17:40,320 --> 00:17:41,760
and

464
00:17:41,760 --> 00:17:43,520
also similarly to the end user

465
00:17:43,520 --> 00:17:46,240
experience as an admin you can go ahead

466
00:17:46,240 --> 00:17:48,480
and report the application if you think

467
00:17:48,480 --> 00:17:50,880
that this is an application that

468
00:17:50,880 --> 00:17:53,600
shouldn't that that should be disabled

469
00:17:53,600 --> 00:17:55,200
and um

470
00:17:55,200 --> 00:17:57,360
it shouldn't have the ability to be

471
00:17:57,360 --> 00:17:58,960
registered to other

472
00:17:58,960 --> 00:18:00,799
tenants or

473
00:18:00,799 --> 00:18:02,960
if everything looks good you can decide

474
00:18:02,960 --> 00:18:03,840
to

475
00:18:03,840 --> 00:18:05,919
go ahead and and accept those

476
00:18:05,919 --> 00:18:08,880
permissions which means that all users

477
00:18:08,880 --> 00:18:10,799
moving forward from this moment will be

478
00:18:10,799 --> 00:18:13,440
able to access this application um

479
00:18:13,440 --> 00:18:17,200
without seeing that consent screen

480
00:18:17,200 --> 00:18:21,120
okay so let's talk a little bit uh about

481
00:18:21,120 --> 00:18:24,160
what happened there so we saw the the

482
00:18:24,160 --> 00:18:26,160
experience you're probably familiar with

483
00:18:26,160 --> 00:18:28,720
applications requiring consent but what

484
00:18:28,720 --> 00:18:30,880
happened behind the scenes

485
00:18:30,880 --> 00:18:33,200
um when we talk about applications and

486
00:18:33,200 --> 00:18:35,760
what forms an application we have the

487
00:18:35,760 --> 00:18:37,760
application object and the service

488
00:18:37,760 --> 00:18:39,360
principle object

489
00:18:39,360 --> 00:18:41,520
when you think about the the application

490
00:18:41,520 --> 00:18:43,840
object well that will always reside in

491
00:18:43,840 --> 00:18:46,559
the home tenant so that's the first

492
00:18:46,559 --> 00:18:48,400
tenant where the application has been

493
00:18:48,400 --> 00:18:51,679
registered and you can think about the

494
00:18:51,679 --> 00:18:53,520
definition about that application so

495
00:18:53,520 --> 00:18:56,559
think application logo application name

496
00:18:56,559 --> 00:18:59,120
uh optional claims that you may add to

497
00:18:59,120 --> 00:19:00,880
to that application

498
00:19:00,880 --> 00:19:03,600
um while service principle service

499
00:19:03,600 --> 00:19:06,240
principle can reside in multiple tenants

500
00:19:06,240 --> 00:19:07,679
and it

501
00:19:07,679 --> 00:19:10,320
it contains the configuration of that

502
00:19:10,320 --> 00:19:12,080
application so think

503
00:19:12,080 --> 00:19:15,600
your own sign-on urls or reply urls that

504
00:19:15,600 --> 00:19:18,000
are specific to your tenant

505
00:19:18,000 --> 00:19:20,880
um and just to give a real-life example

506
00:19:20,880 --> 00:19:21,919
so

507
00:19:21,919 --> 00:19:23,760
let's say gloria and i have this

508
00:19:23,760 --> 00:19:25,679
timekeeping application

509
00:19:25,679 --> 00:19:28,559
and we have registered it in our tenant

510
00:19:28,559 --> 00:19:31,039
so if you're familiar with the azure id

511
00:19:31,039 --> 00:19:33,120
portal we have a blade which is called

512
00:19:33,120 --> 00:19:35,600
which is called app registrations and

513
00:19:35,600 --> 00:19:37,919
that's where you would register

514
00:19:37,919 --> 00:19:39,520
you will go and register your

515
00:19:39,520 --> 00:19:40,880
application

516
00:19:40,880 --> 00:19:42,160
and

517
00:19:42,160 --> 00:19:44,320
both application and service principal

518
00:19:44,320 --> 00:19:47,120
objects are residing uh right now in in

519
00:19:47,120 --> 00:19:49,760
our tenant but then we decide to sell it

520
00:19:49,760 --> 00:19:52,799
or publish it to the azure id gallery

521
00:19:52,799 --> 00:19:54,720
if someone else registers this

522
00:19:54,720 --> 00:19:56,799
application in their tenant only the

523
00:19:56,799 --> 00:19:59,600
service principle representation of our

524
00:19:59,600 --> 00:20:01,919
application will be

525
00:20:01,919 --> 00:20:05,679
installed in the other tenants

526
00:20:05,679 --> 00:20:08,559
why is it also important to to have this

527
00:20:08,559 --> 00:20:10,880
differentiation between application and

528
00:20:10,880 --> 00:20:13,559
service principle objects is because

529
00:20:13,559 --> 00:20:15,679
authentication will always happen

530
00:20:15,679 --> 00:20:17,919
against the service principle object so

531
00:20:17,919 --> 00:20:19,440
it cannot happen

532
00:20:19,440 --> 00:20:20,799
against the

533
00:20:20,799 --> 00:20:24,240
the application object so here

534
00:20:24,240 --> 00:20:25,919
we

535
00:20:25,919 --> 00:20:29,280
we can give a few examples about

536
00:20:29,280 --> 00:20:32,400
what we see in customers environments

537
00:20:32,400 --> 00:20:34,480
for example so if we start looking at

538
00:20:34,480 --> 00:20:37,760
service principles we can see uh when

539
00:20:37,760 --> 00:20:41,039
investigating or monitoring applications

540
00:20:41,039 --> 00:20:42,960
inside the environment we can see that

541
00:20:42,960 --> 00:20:44,400
some of these service principles

542
00:20:44,400 --> 00:20:45,280
actually

543
00:20:45,280 --> 00:20:47,840
hold some

544
00:20:47,840 --> 00:20:49,840
privileges sometimes they have azure

545
00:20:49,840 --> 00:20:51,840
role assignments or directory role

546
00:20:51,840 --> 00:20:53,039
assignments so

547
00:20:53,039 --> 00:20:56,480
think of things like global admin so

548
00:20:56,480 --> 00:20:58,720
you have right now a service principle

549
00:20:58,720 --> 00:21:01,120
that holds the keys to the kingdom

550
00:21:01,120 --> 00:21:04,400
right um or if you if one maybe make an

551
00:21:04,400 --> 00:21:07,280
analogy to active directory where we had

552
00:21:07,280 --> 00:21:09,039
service accounts and service accounts

553
00:21:09,039 --> 00:21:12,720
could maybe run scheduled tasks or um

554
00:21:12,720 --> 00:21:15,679
run services such as sql services very

555
00:21:15,679 --> 00:21:17,520
similarly

556
00:21:17,520 --> 00:21:19,840
service principles can have that type of

557
00:21:19,840 --> 00:21:23,520
a privilege um in in azure ad too

558
00:21:23,520 --> 00:21:26,320
and if they are holding things like

559
00:21:26,320 --> 00:21:28,559
application permission grants well that

560
00:21:28,559 --> 00:21:31,679
means that that service principle can

561
00:21:31,679 --> 00:21:36,159
make changes um and and can act um

562
00:21:36,159 --> 00:21:39,520
as a as a non-human identity and can

563
00:21:39,520 --> 00:21:42,159
make changes without having without

564
00:21:42,159 --> 00:21:44,880
requiring any sign in a signed end user

565
00:21:44,880 --> 00:21:47,039
and if you couple that again with with

566
00:21:47,039 --> 00:21:49,440
high privileged brands you can

567
00:21:49,440 --> 00:21:52,320
understand why why we care so much about

568
00:21:52,320 --> 00:21:54,720
uh well first understanding the service

569
00:21:54,720 --> 00:21:56,640
principle usage in your environment and

570
00:21:56,640 --> 00:21:58,320
then making sure that you're also

571
00:21:58,320 --> 00:22:01,600
governing access to service principles

572
00:22:01,600 --> 00:22:04,480
very closely

573
00:22:05,440 --> 00:22:06,880
yes

574
00:22:06,880 --> 00:22:08,720
so i know somebody here right now is

575
00:22:08,720 --> 00:22:10,720
probably thinking just like grandpa

576
00:22:10,720 --> 00:22:12,880
simpson and like i know the cloud was

577
00:22:12,880 --> 00:22:15,120
problem from the start it's trouble and

578
00:22:15,120 --> 00:22:16,720
now i have all these applications in my

579
00:22:16,720 --> 00:22:19,120
tenant i don't know how they get there i

580
00:22:19,120 --> 00:22:21,600
don't know who assigned their access i

581
00:22:21,600 --> 00:22:24,480
don't know who can access and who cannot

582
00:22:24,480 --> 00:22:26,000
so i have all these permissions the

583
00:22:26,000 --> 00:22:27,520
application can do things in my

584
00:22:27,520 --> 00:22:29,120
directory i have no idea how this

585
00:22:29,120 --> 00:22:31,440
happened like i know this is klaus fault

586
00:22:31,440 --> 00:22:33,520
and we should never have done this cloud

587
00:22:33,520 --> 00:22:35,039
thing to begin with

588
00:22:35,039 --> 00:22:37,600
so it's really not as bad as it seems

589
00:22:37,600 --> 00:22:39,760
well we have some stuff some tools that

590
00:22:39,760 --> 00:22:41,760
will give you guys help this make this

591
00:22:41,760 --> 00:22:45,280
easier turning some doorknobs um but we

592
00:22:45,280 --> 00:22:48,000
dare to ask the same question here right

593
00:22:48,000 --> 00:22:50,400
it's actually for most customers worse

594
00:22:50,400 --> 00:22:53,520
on-premises because on-premises

595
00:22:53,520 --> 00:22:55,360
do you have a centralized place where

596
00:22:55,360 --> 00:22:57,440
the applications coming through it's

597
00:22:57,440 --> 00:22:59,360
worse because we don't know who's

598
00:22:59,360 --> 00:23:01,600
accessing those application on premises

599
00:23:01,600 --> 00:23:03,360
it's worse because we actually don't

600
00:23:03,360 --> 00:23:04,880
know what permissions the application

601
00:23:04,880 --> 00:23:07,039
that's asking for and the application

602
00:23:07,039 --> 00:23:08,640
may have asked for something like domain

603
00:23:08,640 --> 00:23:10,640
admin and then what permission is it

604
00:23:10,640 --> 00:23:12,400
really using

605
00:23:12,400 --> 00:23:14,880
can you even tell what you don't know so

606
00:23:14,880 --> 00:23:17,760
things like that probably it's worse

607
00:23:17,760 --> 00:23:20,559
than prime however in the cloud we have

608
00:23:20,559 --> 00:23:22,480
some good stuff that is going to help

609
00:23:22,480 --> 00:23:25,520
you with this so why are we even talking

610
00:23:25,520 --> 00:23:27,360
a lot about this

611
00:23:27,360 --> 00:23:28,559
well

612
00:23:28,559 --> 00:23:32,559
because we have definitely

613
00:23:32,559 --> 00:23:36,799
crazy malware campaigns that is evolving

614
00:23:36,799 --> 00:23:38,320
um

615
00:23:38,320 --> 00:23:39,600
you know

616
00:23:39,600 --> 00:23:42,320
since covet it's really been explosive

617
00:23:42,320 --> 00:23:45,440
and um it's really got you know to run

618
00:23:45,440 --> 00:23:46,960
the users to click on the phishing

619
00:23:46,960 --> 00:23:50,640
emails and you know run those macros

620
00:23:50,640 --> 00:23:54,159
and cause into the illicit consent grant

621
00:23:54,159 --> 00:23:56,000
because the users don't know what

622
00:23:56,000 --> 00:23:58,159
they're consenting

623
00:23:58,159 --> 00:24:02,640
it is becoming a evolving uh landscape

624
00:24:02,640 --> 00:24:06,080
threat here and um we wanted you to you

625
00:24:06,080 --> 00:24:08,400
know to point out here that uh an

626
00:24:08,400 --> 00:24:10,480
attacker right they registered an app

627
00:24:10,480 --> 00:24:13,440
with oauth 2.0 providers such as azure

628
00:24:13,440 --> 00:24:15,279
active directory and the app is

629
00:24:15,279 --> 00:24:17,360
configured in a trustworthy like using a

630
00:24:17,360 --> 00:24:19,520
name of a popular product that some

631
00:24:19,520 --> 00:24:22,159
ecosystem the attacker gets a link in

632
00:24:22,159 --> 00:24:23,120
front of

633
00:24:23,120 --> 00:24:24,640
um

634
00:24:24,640 --> 00:24:26,080
users which may be done through

635
00:24:26,080 --> 00:24:27,919
conventional email based phishing and

636
00:24:27,919 --> 00:24:29,440
the non-malicious website or other

637
00:24:29,440 --> 00:24:31,200
techniques right then then user clicks

638
00:24:31,200 --> 00:24:33,440
on it is shown like authentic consent

639
00:24:33,440 --> 00:24:35,120
prompt that's asking them to grant

640
00:24:35,120 --> 00:24:37,360
malicious app permissions to data

641
00:24:37,360 --> 00:24:39,600
if a user clicks to accept they'll grant

642
00:24:39,600 --> 00:24:41,440
the app permissions to access sensitive

643
00:24:41,440 --> 00:24:44,159
data in the appgas authorization code

644
00:24:44,159 --> 00:24:46,159
which it redeems from an access token

645
00:24:46,159 --> 00:24:48,400
and potentially a refresh token the

646
00:24:48,400 --> 00:24:50,880
access token is used to make api calls

647
00:24:50,880 --> 00:24:52,720
on behalf of that user

648
00:24:52,720 --> 00:24:57,520
yes so it's actually pretty crazy well

649
00:24:57,520 --> 00:25:00,640
with that we're gonna have awana to look

650
00:25:00,640 --> 00:25:03,279
through uh with you guys to talk about

651
00:25:03,279 --> 00:25:05,360
actually the key permissions

652
00:25:05,360 --> 00:25:07,679
and then oana is also gonna take you

653
00:25:07,679 --> 00:25:11,360
through another great demo to um

654
00:25:11,360 --> 00:25:14,000
work on how to investigate illicit

655
00:25:14,000 --> 00:25:16,080
consent grants with that i'm going to

656
00:25:16,080 --> 00:25:18,960
give it to anna

657
00:25:20,159 --> 00:25:22,720
thanks so much gloria and yeah you

658
00:25:22,720 --> 00:25:24,480
mentioned that you have all these

659
00:25:24,480 --> 00:25:27,120
applications and you don't know where

660
00:25:27,120 --> 00:25:29,200
how did they get there in the first

661
00:25:29,200 --> 00:25:31,279
place right and let's say you have them

662
00:25:31,279 --> 00:25:33,279
there and then how do you start going

663
00:25:33,279 --> 00:25:35,600
about permissions and what are the

664
00:25:35,600 --> 00:25:37,279
permissions that you should be looking

665
00:25:37,279 --> 00:25:40,000
for those so these are all fair and and

666
00:25:40,000 --> 00:25:42,880
legitimate questions because if we think

667
00:25:42,880 --> 00:25:45,360
of all the permissions that are out

668
00:25:45,360 --> 00:25:47,039
there maybe there are hundreds or

669
00:25:47,039 --> 00:25:49,679
thousands of permissions it it will be

670
00:25:49,679 --> 00:25:52,400
so hard to just stay and sift through

671
00:25:52,400 --> 00:25:56,000
them all or maybe try to classify all of

672
00:25:56,000 --> 00:25:58,640
them up front that probably is just not

673
00:25:58,640 --> 00:26:02,159
feasible so that's why just looking at

674
00:26:02,159 --> 00:26:04,640
our our own research and what we're

675
00:26:04,640 --> 00:26:05,520
seeing

676
00:26:05,520 --> 00:26:07,520
when working with so many customers

677
00:26:07,520 --> 00:26:10,320
around the world is probably the these

678
00:26:10,320 --> 00:26:12,799
permissions on the left hand side are

679
00:26:12,799 --> 00:26:16,080
probably being used in in 90

680
00:26:16,080 --> 00:26:17,120
of the

681
00:26:17,120 --> 00:26:18,000
of the

682
00:26:18,000 --> 00:26:20,240
consent related or phishing related

683
00:26:20,240 --> 00:26:23,760
attacks so whether that's male star um

684
00:26:23,760 --> 00:26:26,720
contact star and when when we put when

685
00:26:26,720 --> 00:26:29,360
we're putting these root permissions

686
00:26:29,360 --> 00:26:31,440
it's actually all the permutations of

687
00:26:31,440 --> 00:26:33,760
these permissions it can be contacts

688
00:26:33,760 --> 00:26:36,480
read contacts read write contacts read

689
00:26:36,480 --> 00:26:39,200
write shared um so

690
00:26:39,200 --> 00:26:40,159
it's

691
00:26:40,159 --> 00:26:43,039
and maybe some of these are not

692
00:26:43,039 --> 00:26:45,840
you wouldn't consider them risky because

693
00:26:45,840 --> 00:26:48,960
male read is is a common one right

694
00:26:48,960 --> 00:26:52,640
but what we're noticing is that usually

695
00:26:52,640 --> 00:26:53,840
um

696
00:26:53,840 --> 00:26:56,159
attackers are not necessarily going

697
00:26:56,159 --> 00:26:57,360
after

698
00:26:57,360 --> 00:27:00,240
after admins or or those high

699
00:27:00,240 --> 00:27:03,279
permissions where admins maybe might pay

700
00:27:03,279 --> 00:27:06,480
more attention or be more educated about

701
00:27:06,480 --> 00:27:08,880
what that permissions means but actually

702
00:27:08,880 --> 00:27:10,320
also try to

703
00:27:10,320 --> 00:27:11,520
to

704
00:27:11,520 --> 00:27:14,480
access or to request access to these

705
00:27:14,480 --> 00:27:20,480
benign uh permissions and um and then uh

706
00:27:20,480 --> 00:27:23,279
eventually moving laterally from there

707
00:27:23,279 --> 00:27:26,720
so that's why we we do want it to call

708
00:27:26,720 --> 00:27:28,960
out everything that is related to mail

709
00:27:28,960 --> 00:27:30,480
or everything that is related to

710
00:27:30,480 --> 00:27:33,679
contacts or people or files so that is

711
00:27:33,679 --> 00:27:36,320
hosting really um that contains

712
00:27:36,320 --> 00:27:40,399
information pii information um

713
00:27:40,399 --> 00:27:44,799
to to also uh pay uh or pay attention to

714
00:27:44,799 --> 00:27:47,360
and take a closer look to and then on

715
00:27:47,360 --> 00:27:50,720
the right hand side um talking about uh

716
00:27:50,720 --> 00:27:53,039
application permissions or domain read

717
00:27:53,039 --> 00:27:55,440
write all permissions so these

718
00:27:55,440 --> 00:27:58,000
permissions that

719
00:27:58,000 --> 00:28:00,559
in case they were abused that could have

720
00:28:00,559 --> 00:28:04,000
a catastrophic impact right and no one

721
00:28:04,000 --> 00:28:06,720
else better than yourselves no know the

722
00:28:06,720 --> 00:28:09,520
environment so if you know that maybe

723
00:28:09,520 --> 00:28:12,399
this high um

724
00:28:12,399 --> 00:28:15,200
high level uh i don't know hr person or

725
00:28:15,200 --> 00:28:16,880
a finance

726
00:28:16,880 --> 00:28:18,559
person um

727
00:28:18,559 --> 00:28:20,559
has consented to this type of

728
00:28:20,559 --> 00:28:22,480
permissions well maybe there there is

729
00:28:22,480 --> 00:28:26,080
something that that you should look into

730
00:28:26,080 --> 00:28:27,679
and

731
00:28:27,679 --> 00:28:31,919
on the opposite side you can have uh

732
00:28:31,919 --> 00:28:34,720
you can have maybe requesting admin

733
00:28:34,720 --> 00:28:37,200
consent for everything even for for

734
00:28:37,200 --> 00:28:39,039
things that are already inside the

735
00:28:39,039 --> 00:28:41,440
tokens when the user sign signs in so

736
00:28:41,440 --> 00:28:44,159
maybe something like open id or email or

737
00:28:44,159 --> 00:28:47,200
their profile so things that are are

738
00:28:47,200 --> 00:28:49,760
already there when the user is signing

739
00:28:49,760 --> 00:28:52,159
in so maybe these are the let's say the

740
00:28:52,159 --> 00:28:54,799
the safer ones or the ones that you

741
00:28:54,799 --> 00:28:57,360
could consider low risk and maybe allow

742
00:28:57,360 --> 00:29:00,159
users to to consent this type of applica

743
00:29:00,159 --> 00:29:02,399
to this type of permission so you don't

744
00:29:02,399 --> 00:29:07,200
overwhelm admins with every single um

745
00:29:07,200 --> 00:29:10,320
access request to applications

746
00:29:10,320 --> 00:29:12,640
so let's just um

747
00:29:12,640 --> 00:29:15,840
see how how that looks like right in in

748
00:29:15,840 --> 00:29:17,840
just in the portal how we are looking at

749
00:29:17,840 --> 00:29:19,279
applications and

750
00:29:19,279 --> 00:29:21,679
and here here i'm logged in with my

751
00:29:21,679 --> 00:29:25,760
admin user and i just want to um to

752
00:29:25,760 --> 00:29:28,080
enterprise applications and then i

753
00:29:28,080 --> 00:29:30,960
noticed first that this application is

754
00:29:30,960 --> 00:29:32,960
misspelled that's definitely not how my

755
00:29:32,960 --> 00:29:35,200
how my tenant is spelled so i i decide

756
00:29:35,200 --> 00:29:36,720
to take a closer look at this

757
00:29:36,720 --> 00:29:39,600
application and you see your massive

758
00:29:39,600 --> 00:29:42,559
list of uh of permissions the mix of

759
00:29:42,559 --> 00:29:44,480
delegated but mostly application

760
00:29:44,480 --> 00:29:46,240
permissions and remember these

761
00:29:46,240 --> 00:29:48,080
application permissions

762
00:29:48,080 --> 00:29:51,120
um don't require signed in user to make

763
00:29:51,120 --> 00:29:53,600
changes or to do whatever

764
00:29:53,600 --> 00:29:56,240
these permission grants them access to

765
00:29:56,240 --> 00:29:58,640
so just to take a few examples read all

766
00:29:58,640 --> 00:30:00,960
users authentication methods or if you

767
00:30:00,960 --> 00:30:02,559
we scroll down read and write all

768
00:30:02,559 --> 00:30:05,039
applications so just this application

769
00:30:05,039 --> 00:30:07,679
can go and create other applications

770
00:30:07,679 --> 00:30:10,159
without having any signed in signed in

771
00:30:10,159 --> 00:30:12,000
users so that's

772
00:30:12,000 --> 00:30:15,279
that's where it is important to to take

773
00:30:15,279 --> 00:30:17,120
a look at

774
00:30:17,120 --> 00:30:19,600
applications that that you have

775
00:30:19,600 --> 00:30:22,159
registered in your environment and then

776
00:30:22,159 --> 00:30:23,120
uh

777
00:30:23,120 --> 00:30:25,440
look also the the permissions that are

778
00:30:25,440 --> 00:30:26,240
um

779
00:30:26,240 --> 00:30:27,919
that are associated to to these

780
00:30:27,919 --> 00:30:30,399
applications and we will also show other

781
00:30:30,399 --> 00:30:32,159
approaches of doing this we we

782
00:30:32,159 --> 00:30:34,399
understand that it might not be feasible

783
00:30:34,399 --> 00:30:36,960
for every single customer to to look in

784
00:30:36,960 --> 00:30:40,080
the azure id portal and just go through

785
00:30:40,080 --> 00:30:42,480
every single application so we we will

786
00:30:42,480 --> 00:30:44,640
also show you how you can add a little

787
00:30:44,640 --> 00:30:46,640
bit of automation to that

788
00:30:46,640 --> 00:30:49,440
but just before doing that i also the

789
00:30:49,440 --> 00:30:51,440
other thing that i wanted to illustrate

790
00:30:51,440 --> 00:30:52,960
here um

791
00:30:52,960 --> 00:30:54,559
when when talking about application

792
00:30:54,559 --> 00:30:56,000
permission so

793
00:30:56,000 --> 00:30:57,760
let's take the example of microsoft

794
00:30:57,760 --> 00:30:59,760
graph because we know that's that's a

795
00:30:59,760 --> 00:31:02,240
common one uh it has application

796
00:31:02,240 --> 00:31:04,720
permissions so it can it can make

797
00:31:04,720 --> 00:31:06,880
changes without having a any signed in

798
00:31:06,880 --> 00:31:11,120
user so here you you could be

799
00:31:11,360 --> 00:31:12,960
signed in to

800
00:31:12,960 --> 00:31:16,000
or this could be an application

801
00:31:16,000 --> 00:31:17,600
having this type of application

802
00:31:17,600 --> 00:31:20,720
permissions like microsoft graph and

803
00:31:20,720 --> 00:31:22,880
let's say we take the example of my user

804
00:31:22,880 --> 00:31:25,440
alice smith and i want to go and and

805
00:31:25,440 --> 00:31:27,600
just make changes and

806
00:31:27,600 --> 00:31:30,320
just so that you remember that apps can

807
00:31:30,320 --> 00:31:34,159
can can do this i'll um just change the

808
00:31:34,159 --> 00:31:37,039
the display name to this i'll change the

809
00:31:37,039 --> 00:31:39,760
operation to patch and

810
00:31:39,760 --> 00:31:42,000
then i'll go ahead and run my query and

811
00:31:42,000 --> 00:31:44,720
just to show you that worked um i'll

812
00:31:44,720 --> 00:31:48,640
then do again and uh see that um the

813
00:31:48,640 --> 00:31:50,480
display name has changed so this is an

814
00:31:50,480 --> 00:31:53,760
example of an application having uh

815
00:31:53,760 --> 00:31:55,600
application permissions that can make

816
00:31:55,600 --> 00:31:58,159
changes without having any signed in

817
00:31:58,159 --> 00:31:59,919
users

818
00:31:59,919 --> 00:32:01,200
and

819
00:32:01,200 --> 00:32:03,760
again understanding why why it is

820
00:32:03,760 --> 00:32:05,440
important to

821
00:32:05,440 --> 00:32:08,000
pay a closer attention to this type of

822
00:32:08,000 --> 00:32:10,559
permissions and only

823
00:32:10,559 --> 00:32:12,080
allow them

824
00:32:12,080 --> 00:32:14,000
when when it's absolutely needed and

825
00:32:14,000 --> 00:32:16,399
absolutely necessary

826
00:32:16,399 --> 00:32:19,360
okay so without i'll just go back to to

827
00:32:19,360 --> 00:32:22,880
the presentation and just cover how you

828
00:32:22,880 --> 00:32:25,360
can investigate how you can discover

829
00:32:25,360 --> 00:32:27,120
these applications and the permissions

830
00:32:27,120 --> 00:32:29,519
that are associated to them

831
00:32:29,519 --> 00:32:32,799
so a few options um if you are mainly

832
00:32:32,799 --> 00:32:37,120
using office 365 then probably the o365

833
00:32:37,120 --> 00:32:39,279
portal is a is a good place to start

834
00:32:39,279 --> 00:32:41,600
where you can look for what we call

835
00:32:41,600 --> 00:32:44,399
indicators of compromise iocs

836
00:32:44,399 --> 00:32:45,519
um

837
00:32:45,519 --> 00:32:47,840
and a good place to start probably is

838
00:32:47,840 --> 00:32:50,960
admin content uh is set to true so that

839
00:32:50,960 --> 00:32:53,760
means that there was a global admin that

840
00:32:53,760 --> 00:32:55,519
consented for that

841
00:32:55,519 --> 00:32:57,279
application

842
00:32:57,279 --> 00:33:01,519
so just having a list of or or looking

843
00:33:01,519 --> 00:33:03,600
at the applications that

844
00:33:03,600 --> 00:33:06,159
required admin consent would be a good

845
00:33:06,159 --> 00:33:08,799
place to start and this can work this

846
00:33:08,799 --> 00:33:11,200
approach can work again if you're mostly

847
00:33:11,200 --> 00:33:14,000
using office 365 and maybe you don't

848
00:33:14,000 --> 00:33:16,799
have yet a lot of sas applications

849
00:33:16,799 --> 00:33:19,279
registered in your tenant

850
00:33:19,279 --> 00:33:22,159
if you do so if you do

851
00:33:22,159 --> 00:33:24,320
have applications in azure id and if you

852
00:33:24,320 --> 00:33:27,200
want and and register different apps

853
00:33:27,200 --> 00:33:27,919
or

854
00:33:27,919 --> 00:33:28,720
um

855
00:33:28,720 --> 00:33:30,720
having multi-tenant applications for

856
00:33:30,720 --> 00:33:33,039
example so consenting to register

857
00:33:33,039 --> 00:33:35,279
applications in your tenant then the

858
00:33:35,279 --> 00:33:37,600
azure id portal can also be an option so

859
00:33:37,600 --> 00:33:40,880
just like i did a few minutes ago

860
00:33:40,880 --> 00:33:44,159
looking at the enterprise blade and um

861
00:33:44,159 --> 00:33:46,320
selecting the application in question

862
00:33:46,320 --> 00:33:48,320
and starting looking at the permissions

863
00:33:48,320 --> 00:33:50,159
that are assigned to it

864
00:33:50,159 --> 00:33:52,080
but again that depending on the number

865
00:33:52,080 --> 00:33:54,720
of applications that that may not be a

866
00:33:54,720 --> 00:33:56,480
feasible thing to do

867
00:33:56,480 --> 00:33:59,039
um so that's why probably the the one if

868
00:33:59,039 --> 00:34:02,159
we're going from good better

869
00:34:02,159 --> 00:34:03,279
um

870
00:34:03,279 --> 00:34:05,279
powershell would be the better

871
00:34:05,279 --> 00:34:08,480
option uh and this is where

872
00:34:08,480 --> 00:34:10,320
we um

873
00:34:10,320 --> 00:34:12,800
our colleagues have developed um

874
00:34:12,800 --> 00:34:14,000
a script

875
00:34:14,000 --> 00:34:17,040
that actually goes through every service

876
00:34:17,040 --> 00:34:18,879
principle and the permissions that are

877
00:34:18,879 --> 00:34:21,679
associated to it and not only gives you

878
00:34:21,679 --> 00:34:24,079
that data but also it has some nice

879
00:34:24,079 --> 00:34:28,000
reports uh pre-can reports uh that

880
00:34:28,000 --> 00:34:30,000
you can go analyze

881
00:34:30,000 --> 00:34:32,560
that that makes your investigation

882
00:34:32,560 --> 00:34:34,879
easier because you will see things like

883
00:34:34,879 --> 00:34:37,839
high risk apps or high users high risk

884
00:34:37,839 --> 00:34:39,199
users

885
00:34:39,199 --> 00:34:41,199
that consented maybe to risky

886
00:34:41,199 --> 00:34:42,560
permissions

887
00:34:42,560 --> 00:34:44,000
or

888
00:34:44,000 --> 00:34:45,760
applications that are not microsoft

889
00:34:45,760 --> 00:34:48,000
registered or that are not microsoft

890
00:34:48,000 --> 00:34:49,520
first party

891
00:34:49,520 --> 00:34:51,839
um so and and that's the one that i will

892
00:34:51,839 --> 00:34:54,000
show you uh in a minute just how the

893
00:34:54,000 --> 00:34:56,560
export looks like and how uh you can

894
00:34:56,560 --> 00:34:58,480
really benefit from

895
00:34:58,480 --> 00:35:01,040
from that type of analysis

896
00:35:01,040 --> 00:35:03,280
and if we're going to the best uh option

897
00:35:03,280 --> 00:35:05,280
probably it will be microsoft cloud app

898
00:35:05,280 --> 00:35:08,640
security or a caspy appliance

899
00:35:08,640 --> 00:35:11,599
uh because that will also allow you to

900
00:35:11,599 --> 00:35:14,800
tie some automation you're probably

901
00:35:14,800 --> 00:35:16,800
won't have time you probably don't have

902
00:35:16,800 --> 00:35:19,440
staff lying around um just waiting for

903
00:35:19,440 --> 00:35:21,599
the bus to go off and then

904
00:35:21,599 --> 00:35:23,839
investigate those applications so you

905
00:35:23,839 --> 00:35:26,240
you probably want some automation around

906
00:35:26,240 --> 00:35:27,760
it so that

907
00:35:27,760 --> 00:35:28,880
if

908
00:35:28,880 --> 00:35:30,640
a risky permissions

909
00:35:30,640 --> 00:35:33,680
permission is being requested or

910
00:35:33,680 --> 00:35:34,720
if

911
00:35:34,720 --> 00:35:37,599
the the application itself doesn't match

912
00:35:37,599 --> 00:35:38,400
uh

913
00:35:38,400 --> 00:35:40,000
what you are allowed what you're

914
00:35:40,000 --> 00:35:41,839
allowing for your organization in terms

915
00:35:41,839 --> 00:35:43,520
of which applications can be registered

916
00:35:43,520 --> 00:35:46,560
then then they can just uh be

917
00:35:46,560 --> 00:35:48,240
um

918
00:35:48,240 --> 00:35:50,720
disabled or they

919
00:35:50,720 --> 00:35:53,680
don't even have the ability to be

920
00:35:53,680 --> 00:35:55,599
registered in your tenant or all the

921
00:35:55,599 --> 00:35:57,920
grants are being revoked so probably

922
00:35:57,920 --> 00:36:00,800
that that's the um that's the best

923
00:36:00,800 --> 00:36:04,079
option to to make sure that you have

924
00:36:04,079 --> 00:36:07,040
that kind of automatic response in case

925
00:36:07,040 --> 00:36:09,920
something bad happens

926
00:36:09,920 --> 00:36:10,800
um

927
00:36:10,800 --> 00:36:14,560
okay so also related to to the export

928
00:36:14,560 --> 00:36:16,640
what where do you start okay so we

929
00:36:16,640 --> 00:36:18,880
talked about high risk costs that's

930
00:36:18,880 --> 00:36:22,880
great high risk users but what else what

931
00:36:22,880 --> 00:36:26,000
what else if you have gone through the

932
00:36:26,000 --> 00:36:28,000
the list of high-risk applications and

933
00:36:28,000 --> 00:36:30,240
high high-risk users

934
00:36:30,240 --> 00:36:33,119
what are other um iocs that you can look

935
00:36:33,119 --> 00:36:36,240
for um so maybe um

936
00:36:36,240 --> 00:36:37,839
the permission so

937
00:36:37,839 --> 00:36:40,000
looking at the applications that have

938
00:36:40,000 --> 00:36:42,640
application permissions or delegated old

939
00:36:42,640 --> 00:36:45,520
principles which means that that uh

940
00:36:45,520 --> 00:36:48,880
applications has permissions for uh and

941
00:36:48,880 --> 00:36:51,200
has been consented for all users in the

942
00:36:51,200 --> 00:36:53,839
directory that's probably another um

943
00:36:53,839 --> 00:36:56,240
another thing that you would like to uh

944
00:36:56,240 --> 00:36:59,839
you may want to take a closer look at

945
00:36:59,839 --> 00:37:02,160
okay so i i promised you that i uh that

946
00:37:02,160 --> 00:37:04,560
i will show you that export so um i

947
00:37:04,560 --> 00:37:06,400
actually did um

948
00:37:06,400 --> 00:37:09,760
did run the the export uh earlier

949
00:37:09,760 --> 00:37:14,400
um and and this is how it looks like

950
00:37:14,400 --> 00:37:16,880
so i ran the script uh from the slide

951
00:37:16,880 --> 00:37:19,920
before in my tenant earlier and this is

952
00:37:19,920 --> 00:37:22,079
the first tab that you will see which is

953
00:37:22,079 --> 00:37:24,960
just the the raw raw data so probably a

954
00:37:24,960 --> 00:37:26,960
few hundreds of applications here your

955
00:37:26,960 --> 00:37:29,440
organization may have less or more but

956
00:37:29,440 --> 00:37:30,560
still

957
00:37:30,560 --> 00:37:32,880
probably pretty hard to

958
00:37:32,880 --> 00:37:35,280
make sense of this data or save through

959
00:37:35,280 --> 00:37:39,200
the applications so that's where i think

960
00:37:39,200 --> 00:37:40,079
this

961
00:37:40,079 --> 00:37:42,160
uh pivot table

962
00:37:42,160 --> 00:37:45,599
is really valuable because here you have

963
00:37:45,599 --> 00:37:48,000
different filters that that you can

964
00:37:48,000 --> 00:37:50,720
apply just to know where where to start

965
00:37:50,720 --> 00:37:53,680
maybe even from from seeing the the list

966
00:37:53,680 --> 00:37:55,680
of permissions so you see low risk

967
00:37:55,680 --> 00:37:58,400
permissions some that are unranked and

968
00:37:58,400 --> 00:38:01,280
just as i as i mentioned before because

969
00:38:01,280 --> 00:38:03,520
there are so many permissions out there

970
00:38:03,520 --> 00:38:06,320
is just not feasible to classify every

971
00:38:06,320 --> 00:38:08,480
single one so you will still see some

972
00:38:08,480 --> 00:38:11,040
that are on ranked and also the high

973
00:38:11,040 --> 00:38:13,119
risk permissions and that will

974
00:38:13,119 --> 00:38:14,320
definitely be

975
00:38:14,320 --> 00:38:16,320
will usually be the the application

976
00:38:16,320 --> 00:38:18,160
permissions delegated all principal

977
00:38:18,160 --> 00:38:20,240
permissions and also

978
00:38:20,240 --> 00:38:22,400
one of the the ones that i was showing

979
00:38:22,400 --> 00:38:24,880
you in in the previous slides the key

980
00:38:24,880 --> 00:38:27,200
permissions to to look for

981
00:38:27,200 --> 00:38:30,000
so if i want here for example to only

982
00:38:30,000 --> 00:38:33,119
look maybe a high risk permissions you

983
00:38:33,119 --> 00:38:35,440
could you could go and select only high

984
00:38:35,440 --> 00:38:38,560
risk permissions and that way you should

985
00:38:38,560 --> 00:38:41,280
can shrink the the amount of data that

986
00:38:41,280 --> 00:38:44,160
that you can start with and again maybe

987
00:38:44,160 --> 00:38:45,599
there are some that that you're

988
00:38:45,599 --> 00:38:47,599
expecting to be they're like microsoft

989
00:38:47,599 --> 00:38:49,839
graph windows azure id azure keyboard

990
00:38:49,839 --> 00:38:51,200
maybe that that's

991
00:38:51,200 --> 00:38:54,720
that's good but maybe you you don't know

992
00:38:54,720 --> 00:38:59,280
um you know the aip on behalf of or um

993
00:38:59,280 --> 00:39:00,720
the um

994
00:39:00,720 --> 00:39:03,040
i don't know look out mtp or would grow

995
00:39:03,040 --> 00:39:05,599
it get you know your environment better

996
00:39:05,599 --> 00:39:07,760
than anyone else and

997
00:39:07,760 --> 00:39:10,880
just by seeing these um these uh

998
00:39:10,880 --> 00:39:13,359
application names and services that they

999
00:39:13,359 --> 00:39:16,400
have access to may um may already give

1000
00:39:16,400 --> 00:39:18,240
you some information about you what you

1001
00:39:18,240 --> 00:39:20,960
should be looking at next

1002
00:39:20,960 --> 00:39:23,839
um the the other tab that i wanted to

1003
00:39:23,839 --> 00:39:26,079
show you that was mentioned before is

1004
00:39:26,079 --> 00:39:26,880
the

1005
00:39:26,880 --> 00:39:28,800
high risk users tab

1006
00:39:28,800 --> 00:39:32,240
so here you will have the list of users

1007
00:39:32,240 --> 00:39:34,560
that have consented to high risk

1008
00:39:34,560 --> 00:39:35,839
permissions

1009
00:39:35,839 --> 00:39:36,640
and

1010
00:39:36,640 --> 00:39:40,240
uh these applica and usually these um

1011
00:39:40,240 --> 00:39:42,320
these permissions are also available to

1012
00:39:42,320 --> 00:39:45,280
all users so they there has been an

1013
00:39:45,280 --> 00:39:47,680
admin that has granted consent on behalf

1014
00:39:47,680 --> 00:39:50,160
of the entire organization for this

1015
00:39:50,160 --> 00:39:51,440
application

1016
00:39:51,440 --> 00:39:53,500
um so here's um

1017
00:39:53,500 --> 00:39:54,880
[Music]

1018
00:39:54,880 --> 00:39:56,320
where

1019
00:39:56,320 --> 00:39:59,119
knowing your environment and knowing uh

1020
00:39:59,119 --> 00:40:01,680
the maybe the people from the leadership

1021
00:40:01,680 --> 00:40:02,640
team

1022
00:40:02,640 --> 00:40:05,280
um you can start looking at

1023
00:40:05,280 --> 00:40:08,319
those users or we can start um with

1024
00:40:08,319 --> 00:40:11,760
analyzing or looking at more information

1025
00:40:11,760 --> 00:40:13,839
or more applications that those users

1026
00:40:13,839 --> 00:40:15,839
have consented to

1027
00:40:15,839 --> 00:40:17,680
instead of just

1028
00:40:17,680 --> 00:40:19,440
starting analyzing every single

1029
00:40:19,440 --> 00:40:23,040
application or every single

1030
00:40:23,040 --> 00:40:27,119
high profile user in your organization

1031
00:40:27,119 --> 00:40:29,920
and the other one that i also wanted to

1032
00:40:29,920 --> 00:40:32,240
show you because i think it also gives

1033
00:40:32,240 --> 00:40:35,520
you that that view the of

1034
00:40:35,520 --> 00:40:37,440
the applications that are classified as

1035
00:40:37,440 --> 00:40:39,440
high risk in your environment

1036
00:40:39,440 --> 00:40:41,200
by looking at

1037
00:40:41,200 --> 00:40:42,160
three

1038
00:40:42,160 --> 00:40:45,200
key indicators uh so the first one will

1039
00:40:45,200 --> 00:40:46,800
be

1040
00:40:46,800 --> 00:40:48,640
high risk permissions

1041
00:40:48,640 --> 00:40:51,119
uh then it will be the user's assigned

1042
00:40:51,119 --> 00:40:52,800
count so again applications that are

1043
00:40:52,800 --> 00:40:54,480
assigned to all users

1044
00:40:54,480 --> 00:40:57,520
and whether or not that's a microsoft

1045
00:40:57,520 --> 00:41:00,240
first party application so microsoft

1046
00:41:00,240 --> 00:41:02,000
registered application and you will see

1047
00:41:02,000 --> 00:41:06,319
that in all these cases that um

1048
00:41:06,319 --> 00:41:07,839
we are looking at

1049
00:41:07,839 --> 00:41:09,520
applications that are not microsoft

1050
00:41:09,520 --> 00:41:10,640
registered

1051
00:41:10,640 --> 00:41:11,599
um

1052
00:41:11,599 --> 00:41:14,240
and again you you can take a look here

1053
00:41:14,240 --> 00:41:16,319
and and see well maybe there are

1054
00:41:16,319 --> 00:41:19,200
applications with misspelled names or

1055
00:41:19,200 --> 00:41:22,000
um i don't know bland names like like

1056
00:41:22,000 --> 00:41:23,760
email or

1057
00:41:23,760 --> 00:41:25,520
things that

1058
00:41:25,520 --> 00:41:28,319
you you weren't aware of and

1059
00:41:28,319 --> 00:41:30,640
just because they are um

1060
00:41:30,640 --> 00:41:32,319
um they are

1061
00:41:32,319 --> 00:41:34,640
appearing in this list that's a a big

1062
00:41:34,640 --> 00:41:37,599
motivator to to just take a closer look

1063
00:41:37,599 --> 00:41:39,520
at what that application actually does

1064
00:41:39,520 --> 00:41:42,720
and who consented to it

1065
00:41:42,720 --> 00:41:43,839
um

1066
00:41:43,839 --> 00:41:44,880
okay so

1067
00:41:44,880 --> 00:41:46,720
hopefully this was useful and i hope

1068
00:41:46,720 --> 00:41:50,240
that you will go um ahead and uh and try

1069
00:41:50,240 --> 00:41:52,319
the script and also give us feedback

1070
00:41:52,319 --> 00:41:54,400
because we're also looking at ways

1071
00:41:54,400 --> 00:41:57,839
um of improving it

1072
00:41:57,839 --> 00:41:59,839
so in terms of um

1073
00:41:59,839 --> 00:42:03,119
other things to to look at when uh when

1074
00:42:03,119 --> 00:42:05,800
analyzing that export and when

1075
00:42:05,800 --> 00:42:08,000
investigating consent grants in our

1076
00:42:08,000 --> 00:42:09,520
environment

1077
00:42:09,520 --> 00:42:10,240
so

1078
00:42:10,240 --> 00:42:12,319
apart from the misspell names that we

1079
00:42:12,319 --> 00:42:14,800
saw were planned names

1080
00:42:14,800 --> 00:42:18,000
you can also look um at application

1081
00:42:18,000 --> 00:42:21,280
activity and user activity so maybe you

1082
00:42:21,280 --> 00:42:24,079
have you know that this application can

1083
00:42:24,079 --> 00:42:25,760
only be accessed from this type of

1084
00:42:25,760 --> 00:42:28,560
device uh at this type of at this time

1085
00:42:28,560 --> 00:42:29,599
of the day

1086
00:42:29,599 --> 00:42:30,400
and

1087
00:42:30,400 --> 00:42:33,839
you have policies for that um if there

1088
00:42:33,839 --> 00:42:36,160
is uh there were access of requests

1089
00:42:36,160 --> 00:42:37,839
maybe outside of those policy

1090
00:42:37,839 --> 00:42:39,920
constraints maybe that's something that

1091
00:42:39,920 --> 00:42:42,480
you should take a closer look at and

1092
00:42:42,480 --> 00:42:45,920
similarly from um the the user's side

1093
00:42:45,920 --> 00:42:49,040
right if this user usually works nine to

1094
00:42:49,040 --> 00:42:51,040
five and right now all of a sudden is

1095
00:42:51,040 --> 00:42:53,119
trying to log in um

1096
00:42:53,119 --> 00:42:55,839
at two a.m from paris when they're

1097
00:42:55,839 --> 00:42:58,960
actually uh in seattle maybe that's

1098
00:42:58,960 --> 00:43:00,720
that's something else that that you

1099
00:43:00,720 --> 00:43:03,680
should take a closer look at

1100
00:43:03,680 --> 00:43:04,720
um

1101
00:43:04,720 --> 00:43:07,839
and if you suspect maybe that that's

1102
00:43:07,839 --> 00:43:10,560
something that you have malicious

1103
00:43:10,560 --> 00:43:14,000
activity in your tenant um just know

1104
00:43:14,000 --> 00:43:16,240
looking at when that application got

1105
00:43:16,240 --> 00:43:19,760
created and maybe if it was created

1106
00:43:19,760 --> 00:43:21,119
um

1107
00:43:21,119 --> 00:43:23,680
in a time that it was close to to the

1108
00:43:23,680 --> 00:43:26,319
moment of uh of compromise or where you

1109
00:43:26,319 --> 00:43:29,440
suspect compromise that can also be

1110
00:43:29,440 --> 00:43:30,880
a key

1111
00:43:30,880 --> 00:43:33,119
indicator and a key piece of information

1112
00:43:33,119 --> 00:43:34,560
that can help

1113
00:43:34,560 --> 00:43:36,560
you understand whether or not that

1114
00:43:36,560 --> 00:43:40,319
application is actually a legitimate app

1115
00:43:40,319 --> 00:43:43,359
and why we care about that is is

1116
00:43:43,359 --> 00:43:46,560
understanding the blast radius right

1117
00:43:46,560 --> 00:43:47,680
when you

1118
00:43:47,680 --> 00:43:49,839
you probably have heard about micro

1119
00:43:49,839 --> 00:43:53,040
segmentation and as much as possible

1120
00:43:53,040 --> 00:43:55,520
trying to to build those walls so that

1121
00:43:55,520 --> 00:43:57,599
in case something blows up well the

1122
00:43:57,599 --> 00:44:00,720
damage is done only only there only

1123
00:44:00,720 --> 00:44:03,520
within those constraints so if you know

1124
00:44:03,520 --> 00:44:06,400
for example that the the compromise

1125
00:44:06,400 --> 00:44:07,440
happened

1126
00:44:07,440 --> 00:44:10,000
in office 365

1127
00:44:10,000 --> 00:44:12,800
exchange well then um

1128
00:44:12,800 --> 00:44:15,359
you can start looking there and and

1129
00:44:15,359 --> 00:44:17,359
start from there because that will save

1130
00:44:17,359 --> 00:44:18,720
you uh

1131
00:44:18,720 --> 00:44:21,040
that will save you time rather than just

1132
00:44:21,040 --> 00:44:22,960
trying to look everywhere

1133
00:44:22,960 --> 00:44:25,680
um and just because we're talking uh

1134
00:44:25,680 --> 00:44:29,200
about exchange online something um that

1135
00:44:29,200 --> 00:44:30,079
that

1136
00:44:30,079 --> 00:44:33,520
you can you can take a look at is um

1137
00:44:33,520 --> 00:44:36,560
also things like male forwarding rules

1138
00:44:36,560 --> 00:44:38,800
right gloria was mentioning earlier in

1139
00:44:38,800 --> 00:44:41,040
case that's turned on well we know that

1140
00:44:41,040 --> 00:44:42,079
even

1141
00:44:42,079 --> 00:44:44,240
maybe identifying the compromise and

1142
00:44:44,240 --> 00:44:47,920
maybe disabling signing or or trying to

1143
00:44:47,920 --> 00:44:50,400
address it will will not

1144
00:44:50,400 --> 00:44:52,240
also

1145
00:44:52,240 --> 00:44:55,280
help with a with the damage that could

1146
00:44:55,280 --> 00:44:59,119
have been done in other places

1147
00:44:59,680 --> 00:45:01,119
so

1148
00:45:01,119 --> 00:45:02,960
i think this is a

1149
00:45:02,960 --> 00:45:05,200
this is a good time probably to to talk

1150
00:45:05,200 --> 00:45:06,400
about

1151
00:45:06,400 --> 00:45:09,760
what do we do when when compromise is um

1152
00:45:09,760 --> 00:45:12,800
is confirmed so when you identified uh

1153
00:45:12,800 --> 00:45:15,119
the compromise what what happens next

1154
00:45:15,119 --> 00:45:17,520
and and we were talking about trying to

1155
00:45:17,520 --> 00:45:19,920
identify the blast radius rise of the

1156
00:45:19,920 --> 00:45:22,319
containment and then

1157
00:45:22,319 --> 00:45:23,920
well trying to

1158
00:45:23,920 --> 00:45:26,000
to remediate it

1159
00:45:26,000 --> 00:45:27,520
and there are

1160
00:45:27,520 --> 00:45:30,000
different ways that you can you can go

1161
00:45:30,000 --> 00:45:32,240
about doing that whether you have

1162
00:45:32,240 --> 00:45:34,880
identified the the service principle

1163
00:45:34,880 --> 00:45:35,920
that's a

1164
00:45:35,920 --> 00:45:37,520
legitimate or malicious service

1165
00:45:37,520 --> 00:45:40,560
principle well you can go and disable it

1166
00:45:40,560 --> 00:45:43,839
uh or revoke all the permission grants

1167
00:45:43,839 --> 00:45:44,960
that

1168
00:45:44,960 --> 00:45:46,960
have been assigned to that

1169
00:45:46,960 --> 00:45:49,760
to that service principles or in case

1170
00:45:49,760 --> 00:45:53,119
there are april assignments deleting um

1171
00:45:53,119 --> 00:45:56,560
and removing those april assignments um

1172
00:45:56,560 --> 00:45:59,359
if you know the uh uh the the account

1173
00:45:59,359 --> 00:46:01,760
was compromised then you are sure that

1174
00:46:01,760 --> 00:46:04,079
you uh you you would like to just

1175
00:46:04,079 --> 00:46:06,240
disable sign in to that user until you

1176
00:46:06,240 --> 00:46:09,440
have a better idea about the well what

1177
00:46:09,440 --> 00:46:11,839
happened in the plan um and the

1178
00:46:11,839 --> 00:46:14,079
remediation plan you can disable

1179
00:46:14,079 --> 00:46:15,920
temporarily disable sign-in for that

1180
00:46:15,920 --> 00:46:17,040
account

1181
00:46:17,040 --> 00:46:18,880
and the most important one again that

1182
00:46:18,880 --> 00:46:21,119
that we see that is skipped because

1183
00:46:21,119 --> 00:46:22,560
probably is the

1184
00:46:22,560 --> 00:46:27,680
the hardest one is uh trying to find um

1185
00:46:27,680 --> 00:46:29,760
persistence so

1186
00:46:29,760 --> 00:46:32,560
the attacker tries to abuse trust maybe

1187
00:46:32,560 --> 00:46:34,240
through a malicious

1188
00:46:34,240 --> 00:46:35,920
malicious application

1189
00:46:35,920 --> 00:46:37,119
and

1190
00:46:37,119 --> 00:46:39,200
depending on maybe what permissions that

1191
00:46:39,200 --> 00:46:42,960
application had we can start looking

1192
00:46:42,960 --> 00:46:45,920
into into the into other different areas

1193
00:46:45,920 --> 00:46:49,200
such as uh male forwarding rules

1194
00:46:49,200 --> 00:46:53,359
okay so i hope i i didn't scare um

1195
00:46:53,359 --> 00:46:55,839
you all uh too much because we do have

1196
00:46:55,839 --> 00:46:58,319
some best practices coming up next that

1197
00:46:58,319 --> 00:47:00,880
uh can help you protect yourself from

1198
00:47:00,880 --> 00:47:04,160
this type of attack

1199
00:47:06,720 --> 00:47:09,839
okay we'll cover some best practices so

1200
00:47:09,839 --> 00:47:11,920
what are some of the best practices here

1201
00:47:11,920 --> 00:47:14,400
let's see

1202
00:47:15,440 --> 00:47:16,960
well first thing

1203
00:47:16,960 --> 00:47:19,599
set policies inside the azure portal you

1204
00:47:19,599 --> 00:47:21,200
can decide who can consent to

1205
00:47:21,200 --> 00:47:23,520
applications within your organization as

1206
00:47:23,520 --> 00:47:25,200
you can see in the screenshot on the

1207
00:47:25,200 --> 00:47:27,520
left you have three buttons you can

1208
00:47:27,520 --> 00:47:29,599
prohibit your users from consenting to

1209
00:47:29,599 --> 00:47:32,240
applications whatsoever allow your user

1210
00:47:32,240 --> 00:47:34,720
to consent to all the apps both of these

1211
00:47:34,720 --> 00:47:37,359
are not the best decisions what we do

1212
00:47:37,359 --> 00:47:39,920
recommend is allow users to consent to

1213
00:47:39,920 --> 00:47:42,319
apps that are from verified publishers

1214
00:47:42,319 --> 00:47:44,319
and for selected permissions that you

1215
00:47:44,319 --> 00:47:46,000
decide as an organization that are

1216
00:47:46,000 --> 00:47:48,480
considered safe or low impact

1217
00:47:48,480 --> 00:47:50,400
another option show on the right hand

1218
00:47:50,400 --> 00:47:53,119
side of the screenshot if you have mcas

1219
00:47:53,119 --> 00:47:55,359
or other

1220
00:47:55,359 --> 00:47:57,839
kaspy tools so mcas is the microsoft

1221
00:47:57,839 --> 00:48:00,160
cloud app security tool you can set up

1222
00:48:00,160 --> 00:48:02,240
app permissions policies which will

1223
00:48:02,240 --> 00:48:05,119
automatically revoke an app or a user of

1224
00:48:05,119 --> 00:48:07,680
an app based on certain risk detected in

1225
00:48:07,680 --> 00:48:10,399
your environment

1226
00:48:11,119 --> 00:48:12,720
let's see

1227
00:48:12,720 --> 00:48:15,520
all right so let's talk about the

1228
00:48:15,520 --> 00:48:18,720
risk-based users step-up consent the

1229
00:48:18,720 --> 00:48:21,119
second best practice that it is to use

1230
00:48:21,119 --> 00:48:24,400
the track um for you to track race uh

1231
00:48:24,400 --> 00:48:26,960
risk-based user consent it is currently

1232
00:48:26,960 --> 00:48:28,640
enabled by default

1233
00:48:28,640 --> 00:48:31,119
so what is a step of consent when a

1234
00:48:31,119 --> 00:48:34,319
risky request is detected the request

1235
00:48:34,319 --> 00:48:36,079
will be stepped up to require ammon

1236
00:48:36,079 --> 00:48:38,640
approval users and admins will see the

1237
00:48:38,640 --> 00:48:41,280
warning but admins will have the ability

1238
00:48:41,280 --> 00:48:44,240
to actually approve it when this happens

1239
00:48:44,240 --> 00:48:47,440
an audit event will be logged as we all

1240
00:48:47,440 --> 00:48:50,000
know logs are only useful if we check

1241
00:48:50,000 --> 00:48:51,839
them and take action

1242
00:48:51,839 --> 00:48:53,440
if there is an ad requesting

1243
00:48:53,440 --> 00:48:56,160
applications you don't know about this

1244
00:48:56,160 --> 00:48:58,160
can be an indicator that the user has

1245
00:48:58,160 --> 00:49:00,800
been phished this may have come as an

1246
00:49:00,800 --> 00:49:03,200
email attachment but you end up catching

1247
00:49:03,200 --> 00:49:06,160
it here assignments you want to have a

1248
00:49:06,160 --> 00:49:08,480
process in place when these requests

1249
00:49:08,480 --> 00:49:11,200
comes in that they don't just hang there

1250
00:49:11,200 --> 00:49:13,200
it is important to assign owners and

1251
00:49:13,200 --> 00:49:15,440
take action based on what you see in

1252
00:49:15,440 --> 00:49:18,319
your auto locks

1253
00:49:18,319 --> 00:49:20,400
let's talk about how to detect those

1254
00:49:20,400 --> 00:49:24,079
risky oauth apps

1255
00:49:24,640 --> 00:49:27,200
all right so next how do we detect them

1256
00:49:27,200 --> 00:49:29,280
right so how do we detect these apps we

1257
00:49:29,280 --> 00:49:31,040
just talked about

1258
00:49:31,040 --> 00:49:33,119
um you know apply to the new

1259
00:49:33,119 --> 00:49:35,119
applications that's coming through the

1260
00:49:35,119 --> 00:49:37,440
environment so now how do we look at

1261
00:49:37,440 --> 00:49:38,960
what's already happened in our

1262
00:49:38,960 --> 00:49:41,839
environment so the first one there oana

1263
00:49:41,839 --> 00:49:44,000
had to walk us through is a really

1264
00:49:44,000 --> 00:49:46,319
really nice script the script will dump

1265
00:49:46,319 --> 00:49:48,319
out all those permissions you can look

1266
00:49:48,319 --> 00:49:50,559
through it the the pivot tables all

1267
00:49:50,559 --> 00:49:52,319
kinds of good stuff it's a good place to

1268
00:49:52,319 --> 00:49:55,200
start it's free but requires some manual

1269
00:49:55,200 --> 00:49:56,720
work to be done

1270
00:49:56,720 --> 00:49:58,880
run description environment comb through

1271
00:49:58,880 --> 00:50:01,200
the app and permissions it'll help you

1272
00:50:01,200 --> 00:50:03,280
identify anything that looks over

1273
00:50:03,280 --> 00:50:05,920
privileged or questionable better yet we

1274
00:50:05,920 --> 00:50:08,400
recommend using azure monitor to set up

1275
00:50:08,400 --> 00:50:10,800
alerts to automate the process for you

1276
00:50:10,800 --> 00:50:13,280
for example send notification when an

1277
00:50:13,280 --> 00:50:16,160
oauth app requires high permissions or

1278
00:50:16,160 --> 00:50:18,079
authorized for significant chunk of

1279
00:50:18,079 --> 00:50:19,119
users

1280
00:50:19,119 --> 00:50:22,240
the ideal option is to do some risky app

1281
00:50:22,240 --> 00:50:24,880
hunting with caspy solutions such as

1282
00:50:24,880 --> 00:50:28,160
mcas or other tools you can use filters

1283
00:50:28,160 --> 00:50:30,240
to find apps that are potentially very

1284
00:50:30,240 --> 00:50:32,240
risky where users may have

1285
00:50:32,240 --> 00:50:35,040
underestimated the risk

1286
00:50:35,040 --> 00:50:37,200
some of the things you can filter on is

1287
00:50:37,200 --> 00:50:40,400
high permissions right not common use or

1288
00:50:40,400 --> 00:50:43,760
authorization by external users

1289
00:50:43,760 --> 00:50:45,599
all right the next thing here we're

1290
00:50:45,599 --> 00:50:48,319
going to get started in front of this is

1291
00:50:48,319 --> 00:50:50,000
with your developers

1292
00:50:50,000 --> 00:50:53,520
i'm going to advance a slide here

1293
00:50:53,680 --> 00:50:56,079
well so the develop the developers that

1294
00:50:56,079 --> 00:50:57,839
you're currently working with which are

1295
00:50:57,839 --> 00:50:59,760
going to be your internal developers as

1296
00:50:59,760 --> 00:51:02,559
well as external developers um we're

1297
00:51:02,559 --> 00:51:04,960
putting out new permissions all the time

1298
00:51:04,960 --> 00:51:07,040
making it easy to scope app with

1299
00:51:07,040 --> 00:51:09,359
granular permissions one of the common

1300
00:51:09,359 --> 00:51:12,240
things we see with line of business apps

1301
00:51:12,240 --> 00:51:14,480
is that devs are not following the least

1302
00:51:14,480 --> 00:51:15,520
privilege

1303
00:51:15,520 --> 00:51:18,079
in my previous life managing on-premises

1304
00:51:18,079 --> 00:51:21,200
active directory many times i get asked

1305
00:51:21,200 --> 00:51:24,160
to provide asset access to the line of

1306
00:51:24,160 --> 00:51:26,400
business apps so

1307
00:51:26,400 --> 00:51:28,240
and many times i get asked to assign

1308
00:51:28,240 --> 00:51:30,079
domain name and permissions not because

1309
00:51:30,079 --> 00:51:32,559
it's intentional but because it is just

1310
00:51:32,559 --> 00:51:34,960
simply easier and most likely the

1311
00:51:34,960 --> 00:51:36,880
developers are not aware the least

1312
00:51:36,880 --> 00:51:38,880
privileged concept and the security

1313
00:51:38,880 --> 00:51:41,680
risks associated with it so this is you

1314
00:51:41,680 --> 00:51:44,319
know by no means a new problem however

1315
00:51:44,319 --> 00:51:46,240
we really want to encourage developers

1316
00:51:46,240 --> 00:51:48,480
to follow the least privilege so only

1317
00:51:48,480 --> 00:51:50,480
ask for what is necessary

1318
00:51:50,480 --> 00:51:52,160
so take a look at those guidance we have

1319
00:51:52,160 --> 00:51:54,000
highlighted here they're excellent

1320
00:51:54,000 --> 00:51:56,880
resources to help educate the developers

1321
00:51:56,880 --> 00:51:59,200
especially the identity platform

1322
00:51:59,200 --> 00:52:02,000
checklist highly recommended

1323
00:52:02,000 --> 00:52:04,160
as microsoft teams is becoming more and

1324
00:52:04,160 --> 00:52:05,440
more popular

1325
00:52:05,440 --> 00:52:07,520
you want to make sure if you're using it

1326
00:52:07,520 --> 00:52:09,520
that the app can only access the teams

1327
00:52:09,520 --> 00:52:11,760
that they need take a look at the team

1328
00:52:11,760 --> 00:52:13,920
specific permissions we have included

1329
00:52:13,920 --> 00:52:16,480
the link here in the deck to get started

1330
00:52:16,480 --> 00:52:19,599
last but not least we recommend both it

1331
00:52:19,599 --> 00:52:22,400
pros and devs to watch the identity dev

1332
00:52:22,400 --> 00:52:25,520
series that we created so go to ak.ms

1333
00:52:25,520 --> 00:52:27,839
identity developer series about two and

1334
00:52:27,839 --> 00:52:30,160
a half hours of youtube video you will

1335
00:52:30,160 --> 00:52:31,760
not regret it

1336
00:52:31,760 --> 00:52:34,160
if you're cyber security or defenders

1337
00:52:34,160 --> 00:52:36,400
definitely should watch this we receive

1338
00:52:36,400 --> 00:52:39,200
so many great feedback that it pros and

1339
00:52:39,200 --> 00:52:41,920
dev pros learn so much from this video

1340
00:52:41,920 --> 00:52:44,800
series and it goes deeper into api calls

1341
00:52:44,800 --> 00:52:46,960
to microsoft graph permissions and

1342
00:52:46,960 --> 00:52:49,760
scopes access tokens client credential

1343
00:52:49,760 --> 00:52:52,480
flow and all very valuable for both it

1344
00:52:52,480 --> 00:52:54,880
pros and devs

1345
00:52:54,880 --> 00:52:57,440
last thing here if you see anything say

1346
00:52:57,440 --> 00:53:00,559
something well let me against the side

1347
00:53:00,559 --> 00:53:02,160
if you see an application and look

1348
00:53:02,160 --> 00:53:04,800
suspicious you can report it through or

1349
00:53:04,800 --> 00:53:07,839
consent screen as well so the check box

1350
00:53:07,839 --> 00:53:10,000
right there below for the admins here

1351
00:53:10,000 --> 00:53:12,400
you can report those applications that

1352
00:53:12,400 --> 00:53:14,960
you think are fishing or suspicious to

1353
00:53:14,960 --> 00:53:15,760
us

1354
00:53:15,760 --> 00:53:17,760
and we will take a look at it and we'll

1355
00:53:17,760 --> 00:53:20,559
take action remove them for everybody

1356
00:53:20,559 --> 00:53:23,440
so if you see something please please

1357
00:53:23,440 --> 00:53:25,599
take action

1358
00:53:25,599 --> 00:53:26,960
all right

1359
00:53:26,960 --> 00:53:29,359
so let's recap

1360
00:53:29,359 --> 00:53:31,200
on some go do's here

1361
00:53:31,200 --> 00:53:32,319
shall we

1362
00:53:32,319 --> 00:53:34,800
well first go back to the bare minimum

1363
00:53:34,800 --> 00:53:36,880
run that powershell script look at your

1364
00:53:36,880 --> 00:53:39,200
applications look for those dangerous

1365
00:53:39,200 --> 00:53:41,760
permissions look for those risky users

1366
00:53:41,760 --> 00:53:44,000
investigate fix it set the right

1367
00:53:44,000 --> 00:53:45,119
permissions

1368
00:53:45,119 --> 00:53:46,880
do inventory of your applications their

1369
00:53:46,880 --> 00:53:49,359
permissions is always always important

1370
00:53:49,359 --> 00:53:51,760
to know what is in your environment

1371
00:53:51,760 --> 00:53:54,400
automate threat responds where possible

1372
00:53:54,400 --> 00:53:56,640
educate your organization about consent

1373
00:53:56,640 --> 00:53:57,839
tactics

1374
00:53:57,839 --> 00:53:59,839
we are not here to scare you we don't

1375
00:53:59,839 --> 00:54:01,520
want to but

1376
00:54:01,520 --> 00:54:03,280
we have not seen

1377
00:54:03,280 --> 00:54:04,800
these attacks

1378
00:54:04,800 --> 00:54:07,599
a ton yet but because it's emerging we

1379
00:54:07,599 --> 00:54:09,200
see customers who are being hit with

1380
00:54:09,200 --> 00:54:11,119
these types of tax we want to make sure

1381
00:54:11,119 --> 00:54:12,800
you're aware of how to watch out for

1382
00:54:12,800 --> 00:54:13,839
them

1383
00:54:13,839 --> 00:54:16,480
educate your developers right to ensure

1384
00:54:16,480 --> 00:54:19,200
that they follow best security practices

1385
00:54:19,200 --> 00:54:21,440
around using least privilege we have

1386
00:54:21,440 --> 00:54:24,400
some links for you especially aka.ms

1387
00:54:24,400 --> 00:54:26,800
azure 80 secops guide it gives you a

1388
00:54:26,800 --> 00:54:29,599
detailed step toward how to monitor more

1389
00:54:29,599 --> 00:54:32,319
applications there are so much more to

1390
00:54:32,319 --> 00:54:35,359
talk about on this topic we can talk all

1391
00:54:35,359 --> 00:54:37,119
day well

1392
00:54:37,119 --> 00:54:39,839
the time is gonna come to end so lastly

1393
00:54:39,839 --> 00:54:42,160
we've included some extra resources

1394
00:54:42,160 --> 00:54:44,160
links so when you get the slides you'll

1395
00:54:44,160 --> 00:54:46,559
be able to access them

1396
00:54:46,559 --> 00:54:49,920
and again my name is gloria lee and uh

1397
00:54:49,920 --> 00:54:51,760
you know with my beautiful colleague on

1398
00:54:51,760 --> 00:54:54,480
inoke and you can contact us either you

1399
00:54:54,480 --> 00:54:57,119
know via twitter uh email we're also on

1400
00:54:57,119 --> 00:54:59,280
linkedin but we're here to really help

1401
00:54:59,280 --> 00:55:01,359
you guys um you know any follow-up

1402
00:55:01,359 --> 00:55:03,040
questions and feel free to you know

1403
00:55:03,040 --> 00:55:05,680
reach out and peeing and let's make sure

1404
00:55:05,680 --> 00:55:07,520
that you guys do take those best

1405
00:55:07,520 --> 00:55:09,839
practice and go do's and you know make a

1406
00:55:09,839 --> 00:55:14,520
difference in your environment thank you

