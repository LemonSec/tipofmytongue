1
00:00:00,160 --> 00:00:01,599
hey everybody

2
00:00:01,599 --> 00:00:03,919
good to be with you at least virtually

3
00:00:03,919 --> 00:00:05,920
sorry i couldn't be there in person

4
00:00:05,920 --> 00:00:08,000
i was really hoping i'd be able to but

5
00:00:08,000 --> 00:00:09,200
things didn't work out for this this

6
00:00:09,200 --> 00:00:11,599
year to be a texas cybercon so happy to

7
00:00:11,599 --> 00:00:14,080
be here talk about threat hunting

8
00:00:14,080 --> 00:00:16,079
becoming a threat hunter and i started

9
00:00:16,079 --> 00:00:17,760
to look at this go this is the way and

10
00:00:17,760 --> 00:00:19,279
then i realized no it's really not the

11
00:00:19,279 --> 00:00:21,279
way it is just one way of becoming a

12
00:00:21,279 --> 00:00:23,039
threat hunter that i wanted to talk to

13
00:00:23,039 --> 00:00:25,039
you all about today

14
00:00:25,039 --> 00:00:26,640
as a little bit of background about

15
00:00:26,640 --> 00:00:28,720
myself my name is jason wood i'm a

16
00:00:28,720 --> 00:00:31,679
senior researcher on the overwatch

17
00:00:31,679 --> 00:00:34,000
threat hunting team

18
00:00:34,000 --> 00:00:35,920
basically what we call our outreach team

19
00:00:35,920 --> 00:00:37,440
actually as part of overwatch that

20
00:00:37,440 --> 00:00:39,200
allows me to get out and do conferences

21
00:00:39,200 --> 00:00:41,680
like this and participate uh in the

22
00:00:41,680 --> 00:00:44,399
public a bit more and so i really

23
00:00:44,399 --> 00:00:45,840
enjoyed this opportunity to be here with

24
00:00:45,840 --> 00:00:46,719
you

25
00:00:46,719 --> 00:00:49,360
as far as my past background i was one

26
00:00:49,360 --> 00:00:51,199
of the threat hunters on the overwatch

27
00:00:51,199 --> 00:00:53,920
team focused on e-crime

28
00:00:53,920 --> 00:00:56,640
and i've been in penetration testing and

29
00:00:56,640 --> 00:00:58,640
worked as a sys admin and then later a

30
00:00:58,640 --> 00:01:00,320
security engineer

31
00:01:00,320 --> 00:01:02,480
i also do podcasting you can catch me on

32
00:01:02,480 --> 00:01:05,519
security weekly news most weeks

33
00:01:05,519 --> 00:01:07,760
where i do commentary there and you can

34
00:01:07,760 --> 00:01:09,920
always get a hold of me on twitter

35
00:01:09,920 --> 00:01:12,479
at jason underscore wood

36
00:01:12,479 --> 00:01:13,520
so here's what we're going to cover

37
00:01:13,520 --> 00:01:14,479
today

38
00:01:14,479 --> 00:01:15,920
we're going to start off with getting

39
00:01:15,920 --> 00:01:17,439
started doing threat hunting what are

40
00:01:17,439 --> 00:01:19,040
some of the preparatory steps we're

41
00:01:19,040 --> 00:01:20,159
going to do we're going to talk about

42
00:01:20,159 --> 00:01:22,320
the lab what environment do you want to

43
00:01:22,320 --> 00:01:24,880
practice in and what's some options out

44
00:01:24,880 --> 00:01:26,000
here for you and i've got a pretty good

45
00:01:26,000 --> 00:01:27,200
one i think you'd be interested in

46
00:01:27,200 --> 00:01:28,960
trying out we're going to discuss the

47
00:01:28,960 --> 00:01:30,880
attacks and yes i'm referring to mitre

48
00:01:30,880 --> 00:01:32,720
attack and how we can use that to dig

49
00:01:32,720 --> 00:01:34,720
into what adversaries are doing we'll

50
00:01:34,720 --> 00:01:36,000
talk a little bit about some threat

51
00:01:36,000 --> 00:01:38,640
intel there and how that can inform

52
00:01:38,640 --> 00:01:41,600
us to to give us basically hypotheses to

53
00:01:41,600 --> 00:01:43,759
go hunting for and how we can practice

54
00:01:43,759 --> 00:01:45,600
that and then we're going to do the hunt

55
00:01:45,600 --> 00:01:46,960
we're going to take a look at just an

56
00:01:46,960 --> 00:01:48,399
example i'm going to try and do my best

57
00:01:48,399 --> 00:01:49,920
here to work through that on a virtual

58
00:01:49,920 --> 00:01:50,880
machine

59
00:01:50,880 --> 00:01:54,960
and demonstrate some basic hunting and

60
00:01:54,960 --> 00:01:57,280
look you know considerations around that

61
00:01:57,280 --> 00:01:58,399
and then finally we're going to talk

62
00:01:58,399 --> 00:02:00,159
about next steps and really here to talk

63
00:02:00,159 --> 00:02:01,600
about you know where we go from there

64
00:02:01,600 --> 00:02:02,960
how do we maybe some things we're

65
00:02:02,960 --> 00:02:04,640
looking for and threat hunters that

66
00:02:04,640 --> 00:02:06,799
maybe could help you uh move into that

67
00:02:06,799 --> 00:02:09,840
type of position if you like

68
00:02:10,800 --> 00:02:12,640
so one of the things i always like to

69
00:02:12,640 --> 00:02:15,200
stop and talk about is what is threat

70
00:02:15,200 --> 00:02:16,800
hunting itself

71
00:02:16,800 --> 00:02:18,640
because well marketing's gotten a hold

72
00:02:18,640 --> 00:02:20,400
of this thing and

73
00:02:20,400 --> 00:02:22,239
it can mean just about anything to any

74
00:02:22,239 --> 00:02:23,360
company

75
00:02:23,360 --> 00:02:24,239
um

76
00:02:24,239 --> 00:02:25,120
you know

77
00:02:25,120 --> 00:02:26,800
it depends on who you're talking to

78
00:02:26,800 --> 00:02:29,280
really threat hunting is the idea that

79
00:02:29,280 --> 00:02:30,800
and we've got a formal definition you

80
00:02:30,800 --> 00:02:32,879
can see here but threat hunting is the

81
00:02:32,879 --> 00:02:35,760
idea that adversaries get around

82
00:02:35,760 --> 00:02:38,480
defenses they we have clever thinking ad

83
00:02:38,480 --> 00:02:40,319
you know opponents out there on the

84
00:02:40,319 --> 00:02:42,720
other side uh trying to break into our

85
00:02:42,720 --> 00:02:44,879
environments trying to do ransomware

86
00:02:44,879 --> 00:02:46,480
trying to collect information steal

87
00:02:46,480 --> 00:02:49,040
intellectual property all kinds of stuff

88
00:02:49,040 --> 00:02:50,400
and you know they figure out how to get

89
00:02:50,400 --> 00:02:52,640
around security software threat hunters

90
00:02:52,640 --> 00:02:54,560
their goal is to actively go out and

91
00:02:54,560 --> 00:02:56,959
look for them and you know basically

92
00:02:56,959 --> 00:02:58,400
assume a breach

93
00:02:58,400 --> 00:03:00,800
and look for the techniques the tactics

94
00:03:00,800 --> 00:03:03,440
used by adversaries and and hunt through

95
00:03:03,440 --> 00:03:05,760
their environment looking for that now

96
00:03:05,760 --> 00:03:07,120
there's three different ways that we can

97
00:03:07,120 --> 00:03:08,640
do that we're going to be talking mostly

98
00:03:08,640 --> 00:03:11,360
about the hypothesis side of things but

99
00:03:11,360 --> 00:03:14,159
uh we're there's still some useful you

100
00:03:14,159 --> 00:03:15,280
know we're going to talk about threat

101
00:03:15,280 --> 00:03:17,200
intelligence as well now one here at

102
00:03:17,200 --> 00:03:18,800
crowdstrike we use a lot of statistical

103
00:03:18,800 --> 00:03:21,040
methods and and analysis

104
00:03:21,040 --> 00:03:22,720
uh because we collect a lot of data and

105
00:03:22,720 --> 00:03:24,480
we're able to

106
00:03:24,480 --> 00:03:26,959
basically helps us find the outliers uh

107
00:03:26,959 --> 00:03:27,840
but

108
00:03:27,840 --> 00:03:29,120
that's not going to really probably help

109
00:03:29,120 --> 00:03:30,480
us in our lab environment here for

110
00:03:30,480 --> 00:03:32,239
practicing so what we're going to focus

111
00:03:32,239 --> 00:03:34,080
on is kind of the hypothesis type of

112
00:03:34,080 --> 00:03:35,599
testing where you're like hey here's our

113
00:03:35,599 --> 00:03:37,120
adversary's

114
00:03:37,120 --> 00:03:39,120
attack systems let's see if we can find

115
00:03:39,120 --> 00:03:40,239
that

116
00:03:40,239 --> 00:03:42,959
and then the behaviors the techniques

117
00:03:42,959 --> 00:03:45,440
the the tactics the tactics techniques

118
00:03:45,440 --> 00:03:47,519
and procedures and we'll also talk a

119
00:03:47,519 --> 00:03:48,879
little bit about you know some thread

120
00:03:48,879 --> 00:03:51,040
intel and how that can help us out

121
00:03:51,040 --> 00:03:52,879
but that's that's what we do use here

122
00:03:52,879 --> 00:03:54,319
inside of crowdstrike these are the kind

123
00:03:54,319 --> 00:03:55,840
of the three things that we use in

124
00:03:55,840 --> 00:03:58,480
overwatch for our threat hunting

125
00:03:58,480 --> 00:04:01,439
really at scale 24 7.

126
00:04:01,439 --> 00:04:02,959
now when we talk about what thread

127
00:04:02,959 --> 00:04:04,400
hunting is maybe we should talk a little

128
00:04:04,400 --> 00:04:06,000
bit about what it's not this is not a

129
00:04:06,000 --> 00:04:08,080
sock we're not waiting for something to

130
00:04:08,080 --> 00:04:10,319
go red and tell us hey

131
00:04:10,319 --> 00:04:12,319
something malicious has happened here

132
00:04:12,319 --> 00:04:15,200
we're actually out proactively looking

133
00:04:15,200 --> 00:04:16,399
for things even though the environment

134
00:04:16,399 --> 00:04:18,320
may be quiet and socks are really

135
00:04:18,320 --> 00:04:19,918
focused on the idea of hey they won't

136
00:04:19,918 --> 00:04:22,560
they do not want false positives they if

137
00:04:22,560 --> 00:04:24,560
something goes red it better be

138
00:04:24,560 --> 00:04:25,759
malicious

139
00:04:25,759 --> 00:04:27,360
threat hunting

140
00:04:27,360 --> 00:04:29,520
we are willing to accept more noise in

141
00:04:29,520 --> 00:04:31,280
what we're doing we're willing to to

142
00:04:31,280 --> 00:04:34,000
spend time hunting on a technique only

143
00:04:34,000 --> 00:04:35,440
to come up dry and realize okay we

144
00:04:35,440 --> 00:04:36,880
didn't have that in our environment

145
00:04:36,880 --> 00:04:39,040
that's good let's step back and see if

146
00:04:39,040 --> 00:04:40,880
we can form a new hypothesis and go

147
00:04:40,880 --> 00:04:43,360
again you know so this is what we're

148
00:04:43,360 --> 00:04:44,880
doing we're not reacting to things we're

149
00:04:44,880 --> 00:04:47,360
out here actively looking for

150
00:04:47,360 --> 00:04:49,840
for adversaries in our environments

151
00:04:49,840 --> 00:04:51,280
this isn't part of the schedule just

152
00:04:51,280 --> 00:04:52,960
looking through logs and just kind of

153
00:04:52,960 --> 00:04:55,600
just check check check

154
00:04:55,600 --> 00:04:57,759
again we'll use logs we'll use things

155
00:04:57,759 --> 00:04:59,919
that are in event logs or or whatever

156
00:04:59,919 --> 00:05:02,560
and events that are occurring on systems

157
00:05:02,560 --> 00:05:04,880
but we're not going to be use this this

158
00:05:04,880 --> 00:05:08,160
is not part of log review process

159
00:05:08,160 --> 00:05:09,759
now when we look at threat hunters

160
00:05:09,759 --> 00:05:11,039
really we come from all kinds of

161
00:05:11,039 --> 00:05:12,560
different backgrounds we've got the blue

162
00:05:12,560 --> 00:05:14,400
teamers who come from either being

163
00:05:14,400 --> 00:05:16,240
systems administrators

164
00:05:16,240 --> 00:05:18,720
or security engineers security analysts

165
00:05:18,720 --> 00:05:20,720
they're you know actively tasked with

166
00:05:20,720 --> 00:05:23,520
doing um

167
00:05:23,520 --> 00:05:25,919
defense in their environments uh

168
00:05:25,919 --> 00:05:28,639
forensics folks for example and you know

169
00:05:28,639 --> 00:05:30,479
the that's that's one side of where we

170
00:05:30,479 --> 00:05:31,759
can get into threat hunting the other

171
00:05:31,759 --> 00:05:33,280
side this is kind of where i came into

172
00:05:33,280 --> 00:05:36,080
threat hunting was from the the red team

173
00:05:36,080 --> 00:05:38,000
side of things or the offense i was

174
00:05:38,000 --> 00:05:39,680
actually doing penetration testing did

175
00:05:39,680 --> 00:05:41,440
that for quite a while i was really

176
00:05:41,440 --> 00:05:42,639
pretty familiar with the attacks but i

177
00:05:42,639 --> 00:05:44,240
wanted to look on the other side and see

178
00:05:44,240 --> 00:05:46,400
hey how do we hunt for adversaries and

179
00:05:46,400 --> 00:05:48,479
environments so we do come from all

180
00:05:48,479 --> 00:05:50,000
kinds of backgrounds to get to this

181
00:05:50,000 --> 00:05:51,520
point and i don't think there's any one

182
00:05:51,520 --> 00:05:54,160
way or one any one background is more

183
00:05:54,160 --> 00:05:56,080
right than any other to get into threat

184
00:05:56,080 --> 00:05:58,000
hunting there are some different things

185
00:05:58,000 --> 00:06:00,319
that we have uh you know as far as our

186
00:06:00,319 --> 00:06:03,280
backgrounds that help us in that process

187
00:06:03,280 --> 00:06:05,199
blue team we really kind of know what

188
00:06:05,199 --> 00:06:06,400
environments are already supposed to

189
00:06:06,400 --> 00:06:07,759
look like how are they supposed to

190
00:06:07,759 --> 00:06:10,160
operate what's going on here you know

191
00:06:10,160 --> 00:06:12,639
this is expected or it's not expected

192
00:06:12,639 --> 00:06:14,560
you know because we've set this up and

193
00:06:14,560 --> 00:06:16,960
work or we're constantly monitoring our

194
00:06:16,960 --> 00:06:18,400
environment so we kind of know what the

195
00:06:18,400 --> 00:06:21,120
normal noise level is

196
00:06:21,120 --> 00:06:23,840
but you know what there are always gaps

197
00:06:23,840 --> 00:06:26,240
things systems out there that

198
00:06:26,240 --> 00:06:28,639
we didn't know existed they get found by

199
00:06:28,639 --> 00:06:30,390
adversaries sometimes

200
00:06:30,390 --> 00:06:31,919
[Music]

201
00:06:31,919 --> 00:06:35,039
and and they get in so you know we're

202
00:06:35,039 --> 00:06:37,199
looking for gaps in our monitoring gaps

203
00:06:37,199 --> 00:06:39,520
and in in our inventory of devices

204
00:06:39,520 --> 00:06:41,360
things like that to try and hunt things

205
00:06:41,360 --> 00:06:42,319
down

206
00:06:42,319 --> 00:06:45,039
and you know on defense

207
00:06:45,039 --> 00:06:47,440
we hear about a lot of these attacks we

208
00:06:47,440 --> 00:06:48,800
hear the explanation about what they're

209
00:06:48,800 --> 00:06:50,319
for but maybe we're not quite as

210
00:06:50,319 --> 00:06:52,720
familiar what they are

211
00:06:52,720 --> 00:06:55,280
and maybe not even more so familiar with

212
00:06:55,280 --> 00:06:57,039
what the attacks that adversaries are

213
00:06:57,039 --> 00:06:58,479
actually using because there is a little

214
00:06:58,479 --> 00:07:00,080
bit of a difference between

215
00:07:00,080 --> 00:07:02,160
tax we get tossed around and that are

216
00:07:02,160 --> 00:07:03,919
really cool and neat and then tacks that

217
00:07:03,919 --> 00:07:05,440
are just kind of adversaries bread and

218
00:07:05,440 --> 00:07:07,759
butter

219
00:07:08,960 --> 00:07:10,720
we also may not know what they look like

220
00:07:10,720 --> 00:07:12,960
inside of our monitoring right so that

221
00:07:12,960 --> 00:07:14,560
is also something we want to take a look

222
00:07:14,560 --> 00:07:15,840
at

223
00:07:15,840 --> 00:07:17,360
now the red team side of things we're

224
00:07:17,360 --> 00:07:19,120
much more familiar with the attacks

225
00:07:19,120 --> 00:07:20,400
themselves

226
00:07:20,400 --> 00:07:23,199
and you know we know really how to use

227
00:07:23,199 --> 00:07:25,520
them and we know we can do with them and

228
00:07:25,520 --> 00:07:27,840
that's great but we may not be familiar

229
00:07:27,840 --> 00:07:29,280
with how they appear in the monitoring

230
00:07:29,280 --> 00:07:31,599
side of things that was my experience i

231
00:07:31,599 --> 00:07:33,440
came in as a penetration tester i knew

232
00:07:33,440 --> 00:07:34,720
how these tools

233
00:07:34,720 --> 00:07:36,319
worked i knew what i could do with them

234
00:07:36,319 --> 00:07:39,440
and why it was dangerous if this worked

235
00:07:39,440 --> 00:07:42,560
but how does it show up in an event log

236
00:07:42,560 --> 00:07:44,560
well i don't know or i didn't know and

237
00:07:44,560 --> 00:07:45,840
so i had to dig into that and do some

238
00:07:45,840 --> 00:07:47,919
research to prepare myself to become a

239
00:07:47,919 --> 00:07:50,240
threat hunter and honestly you know we

240
00:07:50,240 --> 00:07:52,240
get used to what we use and what works

241
00:07:52,240 --> 00:07:54,560
and what's really clever or whatnot in

242
00:07:54,560 --> 00:07:57,199
our testing uh adversaries again you

243
00:07:57,199 --> 00:07:58,400
know they have what they're going to be

244
00:07:58,400 --> 00:08:00,400
using and sometimes i was really

245
00:08:00,400 --> 00:08:02,160
surprised as you look at

246
00:08:02,160 --> 00:08:03,840
adversaries and how they operate how

247
00:08:03,840 --> 00:08:05,039
different it was from what i did in

248
00:08:05,039 --> 00:08:08,879
penetration testing because um

249
00:08:08,879 --> 00:08:10,080
you know just what they were willing to

250
00:08:10,080 --> 00:08:11,840
do or what they found was work they they

251
00:08:11,840 --> 00:08:13,360
didn't have to be clever it just had to

252
00:08:13,360 --> 00:08:16,639
be good enough to to be successful

253
00:08:16,639 --> 00:08:19,039
so our goal here to become a threat

254
00:08:19,039 --> 00:08:20,720
hunter is we need to get familiar with

255
00:08:20,720 --> 00:08:22,560
the attacks that adversaries are

256
00:08:22,560 --> 00:08:23,840
actually using

257
00:08:23,840 --> 00:08:25,360
we need to know what they look like in

258
00:08:25,360 --> 00:08:26,879
the monitoring

259
00:08:26,879 --> 00:08:28,639
systems we have we need to know whether

260
00:08:28,639 --> 00:08:29,840
the

261
00:08:29,840 --> 00:08:32,240
detections or the information not even

262
00:08:32,240 --> 00:08:34,958
detections but the the events the that

263
00:08:34,958 --> 00:08:36,640
are related to that where are they being

264
00:08:36,640 --> 00:08:38,719
locked are they being picked up in

265
00:08:38,719 --> 00:08:40,799
zeek with you know some network

266
00:08:40,799 --> 00:08:42,559
telemetry and session information or

267
00:08:42,559 --> 00:08:44,399
whatnot or is it showing up in the

268
00:08:44,399 --> 00:08:47,440
windows event log or syslog file on our

269
00:08:47,440 --> 00:08:48,880
endpoints

270
00:08:48,880 --> 00:08:50,480
and we need to become this is really

271
00:08:50,480 --> 00:08:52,240
important we need to become

272
00:08:52,240 --> 00:08:54,000
comfortable with how we're looking for

273
00:08:54,000 --> 00:08:55,760
them threat hunting takes a lot of work

274
00:08:55,760 --> 00:08:57,279
it takes a lot of practice to get

275
00:08:57,279 --> 00:08:59,360
familiar with that so we need to get

276
00:08:59,360 --> 00:09:01,600
used to digging into that that means you

277
00:09:01,600 --> 00:09:02,880
know hey we need to know what the

278
00:09:02,880 --> 00:09:07,279
resulting data is if i run

279
00:09:07,839 --> 00:09:10,640
a command to do reconnaissance on the

280
00:09:10,640 --> 00:09:12,800
computers and environment what does that

281
00:09:12,800 --> 00:09:14,320
look like

282
00:09:14,320 --> 00:09:15,760
you know you know

283
00:09:15,760 --> 00:09:17,600
and where would i find that

284
00:09:17,600 --> 00:09:19,519
what tools am i going to use for to find

285
00:09:19,519 --> 00:09:20,959
them now we're going to look some tools

286
00:09:20,959 --> 00:09:23,040
in the lab itself

287
00:09:23,040 --> 00:09:24,480
but you know really we're going to be

288
00:09:24,480 --> 00:09:27,360
focus i want to get used to the process

289
00:09:27,360 --> 00:09:28,959
so that you can take this and then turn

290
00:09:28,959 --> 00:09:30,560
it into whatever tools you're using

291
00:09:30,560 --> 00:09:31,920
inside of your environment or you can

292
00:09:31,920 --> 00:09:33,680
adapt that let's say you become a

293
00:09:33,680 --> 00:09:35,360
full-time threat hunter somewhere you

294
00:09:35,360 --> 00:09:36,880
can adapt that to the tool set that

295
00:09:36,880 --> 00:09:40,000
you're using in that environment

296
00:09:40,000 --> 00:09:41,360
so that's kind of our background we're

297
00:09:41,360 --> 00:09:43,120
getting started here now we need to have

298
00:09:43,120 --> 00:09:44,800
an environment to actually test this

299
00:09:44,800 --> 00:09:47,519
stuff out in and and

300
00:09:47,519 --> 00:09:50,240
try out some hunting so the lab we're

301
00:09:50,240 --> 00:09:53,120
going to use is called detection lab and

302
00:09:53,120 --> 00:09:54,800
it's a great project built by a

303
00:09:54,800 --> 00:09:56,640
gentleman named chris long

304
00:09:56,640 --> 00:09:57,600
and

305
00:09:57,600 --> 00:09:58,880
the reason why i really like this

306
00:09:58,880 --> 00:10:00,880
environment or this build is because it

307
00:10:00,880 --> 00:10:03,200
allows us to automatically build a

308
00:10:03,200 --> 00:10:05,200
windows domain environment gives us a

309
00:10:05,200 --> 00:10:07,600
domain controller event collection

310
00:10:07,600 --> 00:10:09,279
system

311
00:10:09,279 --> 00:10:11,279
on windows it gives us windows 10

312
00:10:11,279 --> 00:10:14,399
desktop and then a linux logging system

313
00:10:14,399 --> 00:10:16,399
that has a lot of tools for us to use to

314
00:10:16,399 --> 00:10:18,720
collect that data

315
00:10:18,720 --> 00:10:21,040
and and do some analysis on that we can

316
00:10:21,040 --> 00:10:23,200
deploy this into a desktop using

317
00:10:23,200 --> 00:10:25,519
whatever virtualization you like or you

318
00:10:25,519 --> 00:10:28,800
can deploy it out to aws or microsoft

319
00:10:28,800 --> 00:10:31,360
azure so really useful there we just

320
00:10:31,360 --> 00:10:32,880
spin this up and get it going it's

321
00:10:32,880 --> 00:10:34,800
basically built with vagrant

322
00:10:34,800 --> 00:10:36,399
i'm not going to dive into that for the

323
00:10:36,399 --> 00:10:38,880
purposes of this talk but

324
00:10:38,880 --> 00:10:40,959
this is what we're going to be using

325
00:10:40,959 --> 00:10:42,640
now here are the machines and the roles

326
00:10:42,640 --> 00:10:44,079
that we have in this environment we've

327
00:10:44,079 --> 00:10:45,440
got the logger

328
00:10:45,440 --> 00:10:47,360
logger is the host name it's running

329
00:10:47,360 --> 00:10:50,160
splunk enterprise with a limit on how

330
00:10:50,160 --> 00:10:51,920
much data it can ingest per day but it's

331
00:10:51,920 --> 00:10:54,320
free and ready to go you've got surakata

332
00:10:54,320 --> 00:10:56,480
and zeek for network information and

333
00:10:56,480 --> 00:10:58,959
guacamole allows us apache guacamole

334
00:10:58,959 --> 00:11:01,200
allows us to do some remote desktop from

335
00:11:01,200 --> 00:11:02,320
the linux

336
00:11:02,320 --> 00:11:03,680
from a web interface running on the

337
00:11:03,680 --> 00:11:05,279
linux system into our different

338
00:11:05,279 --> 00:11:06,959
environments

339
00:11:06,959 --> 00:11:09,600
we've also got the wef server and that

340
00:11:09,600 --> 00:11:12,079
one's running microsoft ata or advanced

341
00:11:12,079 --> 00:11:14,720
threat analytics and it's a domain

342
00:11:14,720 --> 00:11:17,760
member server it's a part of the domain

343
00:11:17,760 --> 00:11:19,360
we've got the domain controller it's got

344
00:11:19,360 --> 00:11:21,360
a pre-built active directory domain

345
00:11:21,360 --> 00:11:23,200
ready to go for us it's also got a

346
00:11:23,200 --> 00:11:24,800
number of tools deployed into it like

347
00:11:24,800 --> 00:11:27,360
atomic red team and mimikats and et

348
00:11:27,360 --> 00:11:29,440
cetera and so this is a

349
00:11:29,440 --> 00:11:31,040
you know where we can look at setting up

350
00:11:31,040 --> 00:11:33,519
tools to run as well as on the windows

351
00:11:33,519 --> 00:11:35,680
10 machine it's also a member of the

352
00:11:35,680 --> 00:11:37,920
domain and it's just a basic windows 10

353
00:11:37,920 --> 00:11:40,399
host got tools we can deploy out on it

354
00:11:40,399 --> 00:11:42,320
test our attacks out see how they show

355
00:11:42,320 --> 00:11:45,200
up inside of our logging data

356
00:11:45,200 --> 00:11:47,120
so with that you know we'll take a look

357
00:11:47,120 --> 00:11:48,959
at those machines here in a bit when we

358
00:11:48,959 --> 00:11:51,040
get to maybe a little bit of a demo but

359
00:11:51,040 --> 00:11:52,399
that's our environment we're going to be

360
00:11:52,399 --> 00:11:54,480
operating in next let's take a look at

361
00:11:54,480 --> 00:11:57,360
the attacks that we're going to

362
00:11:57,360 --> 00:11:59,279
to be learning about here and learning

363
00:11:59,279 --> 00:12:00,880
how to hunt

364
00:12:00,880 --> 00:12:02,720
and so we're going to focus

365
00:12:02,720 --> 00:12:05,519
initially here are on mitre attack and

366
00:12:05,519 --> 00:12:07,279
this is a really cool project you've

367
00:12:07,279 --> 00:12:08,720
probably heard it all over the place

368
00:12:08,720 --> 00:12:10,360
from marketing

369
00:12:10,360 --> 00:12:11,839
[Music]

370
00:12:11,839 --> 00:12:13,600
but we use it a lot here inside of

371
00:12:13,600 --> 00:12:15,519
overwatch because it allows us to track

372
00:12:15,519 --> 00:12:17,440
what adversary is doing and give us a

373
00:12:17,440 --> 00:12:20,000
common language to talk to folks about

374
00:12:20,000 --> 00:12:22,320
it about what adversaries are doing how

375
00:12:22,320 --> 00:12:25,279
are they operating what is their goal

376
00:12:25,279 --> 00:12:26,880
and things like that a lot of great

377
00:12:26,880 --> 00:12:28,880
information in there helps us to answer

378
00:12:28,880 --> 00:12:31,200
questions like hey how did the adversary

379
00:12:31,200 --> 00:12:32,959
get in so you know there are techniques

380
00:12:32,959 --> 00:12:35,200
that allow us to map to that again i can

381
00:12:35,200 --> 00:12:37,279
describe that what a commands that they

382
00:12:37,279 --> 00:12:39,360
execute in there and how do they execute

383
00:12:39,360 --> 00:12:41,519
them inside of the environment

384
00:12:41,519 --> 00:12:43,200
how do they go about maintaining

385
00:12:43,200 --> 00:12:45,120
persistence in the environment what do

386
00:12:45,120 --> 00:12:47,279
they do to a fade defenses

387
00:12:47,279 --> 00:12:48,880
and you know finally the other day what

388
00:12:48,880 --> 00:12:51,279
do they actually do i mean like

389
00:12:51,279 --> 00:12:52,800
what what what goals were they trying to

390
00:12:52,800 --> 00:12:53,920
accomplish were they trying to get

391
00:12:53,920 --> 00:12:56,399
collect credentials or exfiltrate data

392
00:12:56,399 --> 00:12:58,959
and or and ransomware a system you know

393
00:12:58,959 --> 00:13:00,959
so so what is it that they they actually

394
00:13:00,959 --> 00:13:02,800
try to do

395
00:13:02,800 --> 00:13:05,360
so let's go ahead and take a look at the

396
00:13:05,360 --> 00:13:07,600
attack the mitre attack website real

397
00:13:07,600 --> 00:13:10,600
quick

398
00:13:22,399 --> 00:13:23,839
so this is the

399
00:13:23,839 --> 00:13:26,480
miter attack

400
00:13:26,480 --> 00:13:29,120
matrix if you will it is absolutely

401
00:13:29,120 --> 00:13:31,760
ginormous and it got bigger last year

402
00:13:31,760 --> 00:13:33,360
when they added sub techniques but that

403
00:13:33,360 --> 00:13:35,440
helped us get more granular and what it

404
00:13:35,440 --> 00:13:37,120
is we're tracking on the adversaries but

405
00:13:37,120 --> 00:13:38,720
you can see it starts out here from

406
00:13:38,720 --> 00:13:40,560
reconnaissance resource development

407
00:13:40,560 --> 00:13:42,800
initial access execution how they do

408
00:13:42,800 --> 00:13:44,079
persistence

409
00:13:44,079 --> 00:13:46,880
privilege escalation etc etc defense

410
00:13:46,880 --> 00:13:49,440
evasion and then you know finally we get

411
00:13:49,440 --> 00:13:50,880
out here over to how they did command

412
00:13:50,880 --> 00:13:53,279
and control and exfiltrate data and what

413
00:13:53,279 --> 00:13:54,639
was the impact to

414
00:13:54,639 --> 00:13:56,560
the environment and we can dig down into

415
00:13:56,560 --> 00:13:58,880
this like let's say

416
00:13:58,880 --> 00:13:59,839
for

417
00:13:59,839 --> 00:14:01,839
credential harvesting they went for

418
00:14:01,839 --> 00:14:03,920
operating system credential dumping we

419
00:14:03,920 --> 00:14:05,199
can dig into that and this is where you

420
00:14:05,199 --> 00:14:06,639
get into the techniques around

421
00:14:06,639 --> 00:14:07,839
harvesting

422
00:14:07,839 --> 00:14:10,720
credentials through lsas memory space or

423
00:14:10,720 --> 00:14:13,279
from ntds the active directory

424
00:14:13,279 --> 00:14:14,800
environment let's say we're looking at

425
00:14:14,800 --> 00:14:16,320
lsas memory because we're going to kind

426
00:14:16,320 --> 00:14:18,240
of focus on that a little bit here in

427
00:14:18,240 --> 00:14:19,279
our demo

428
00:14:19,279 --> 00:14:21,519
and so i click on lsas memory has a

429
00:14:21,519 --> 00:14:23,600
description of how this can be done it

430
00:14:23,600 --> 00:14:25,600
gives you some tips on how

431
00:14:25,600 --> 00:14:27,120
you know commands that can be run by

432
00:14:27,120 --> 00:14:29,440
adversaries and i see this all the time

433
00:14:29,440 --> 00:14:31,440
to be quite honest with you uh you know

434
00:14:31,440 --> 00:14:33,680
here we've got proc dump being used or

435
00:14:33,680 --> 00:14:38,880
we got mimi cats uh run dll32 to do it

436
00:14:38,880 --> 00:14:40,160
and then finally we get down here

437
00:14:40,160 --> 00:14:41,519
towards the bottom and we have the

438
00:14:41,519 --> 00:14:43,440
examples of threat actors that are

439
00:14:43,440 --> 00:14:46,079
actually using on using this and so

440
00:14:46,079 --> 00:14:48,240
let's say apt41

441
00:14:48,240 --> 00:14:50,639
okay they've used hash dump mimikats and

442
00:14:50,639 --> 00:14:52,639
windows credential editor to get access

443
00:14:52,639 --> 00:14:54,160
to it well what else have they done

444
00:14:54,160 --> 00:14:55,440
because i'm kind of interested in

445
00:14:55,440 --> 00:14:57,279
hunting on what they did

446
00:14:57,279 --> 00:14:59,839
well now i can look at the group

447
00:14:59,839 --> 00:15:01,040
and then here are all the different

448
00:15:01,040 --> 00:15:03,120
techniques associated with them and

449
00:15:03,120 --> 00:15:05,360
again we can use that to inform us back

450
00:15:05,360 --> 00:15:06,880
over to

451
00:15:06,880 --> 00:15:08,959
what the

452
00:15:08,959 --> 00:15:10,639
the different techniques are and then we

453
00:15:10,639 --> 00:15:12,240
can look at how examples look for

454
00:15:12,240 --> 00:15:15,040
examples of those commands turn around

455
00:15:15,040 --> 00:15:17,440
play them inside of detection lab and

456
00:15:17,440 --> 00:15:18,800
then

457
00:15:18,800 --> 00:15:20,880
we're off we can we can get familiar

458
00:15:20,880 --> 00:15:22,480
with how the commands run how they

459
00:15:22,480 --> 00:15:23,839
execute

460
00:15:23,839 --> 00:15:25,440
that helps us become better defenders

461
00:15:25,440 --> 00:15:26,880
because we understand what's going on

462
00:15:26,880 --> 00:15:28,560
and what the impact of these tools are

463
00:15:28,560 --> 00:15:30,240
but also see how they look in the

464
00:15:30,240 --> 00:15:33,040
defensive side and then we can refine

465
00:15:33,040 --> 00:15:35,279
our hunt on that so that's what we can

466
00:15:35,279 --> 00:15:37,759
do there with mitre attack again this is

467
00:15:37,759 --> 00:15:39,279
you'll see this used all over the place

468
00:15:39,279 --> 00:15:40,959
but it's really you know just gives us

469
00:15:40,959 --> 00:15:43,279
this verbiage to talk about hey what did

470
00:15:43,279 --> 00:15:45,040
the adversary do

471
00:15:45,040 --> 00:15:47,199
you know what what type of stuff do they

472
00:15:47,199 --> 00:15:49,600
do to to infiltrate this environment and

473
00:15:49,600 --> 00:15:51,920
we could say okay well they got in

474
00:15:51,920 --> 00:15:55,519
via let's say a phishing attack and they

475
00:15:55,519 --> 00:15:56,800
used the

476
00:15:56,800 --> 00:15:58,399
command and a commanded scripting

477
00:15:58,399 --> 00:16:00,959
interpreter to launch powershell from

478
00:16:00,959 --> 00:16:02,800
there they did credential harvesting

479
00:16:02,800 --> 00:16:04,720
using lsas

480
00:16:04,720 --> 00:16:07,440
they did some discovery commands and

481
00:16:07,440 --> 00:16:10,320
let's see they exfiltrated the data

482
00:16:10,320 --> 00:16:11,519
out over

483
00:16:11,519 --> 00:16:14,320
uh the c2 channel for example so that's

484
00:16:14,320 --> 00:16:16,079
you know kind of gives us a flow to talk

485
00:16:16,079 --> 00:16:18,480
about this so that's why i like to use

486
00:16:18,480 --> 00:16:19,920
this and what i would recommend you

487
00:16:19,920 --> 00:16:21,279
doing is like i said just go through

488
00:16:21,279 --> 00:16:22,800
this flow you could even go up here to

489
00:16:22,800 --> 00:16:25,040
groups and say hey i want to focus on a

490
00:16:25,040 --> 00:16:27,199
particular threat actor group

491
00:16:27,199 --> 00:16:29,440
and let's go after

492
00:16:29,440 --> 00:16:32,240
apt 12 here and we can click into that

493
00:16:32,240 --> 00:16:34,000
and again see all the techniques

494
00:16:34,000 --> 00:16:35,519
associated with them

495
00:16:35,519 --> 00:16:36,959
that have been recorded and then we

496
00:16:36,959 --> 00:16:39,279
could pivot back up to see you know what

497
00:16:39,279 --> 00:16:41,519
techniques could we try out so with some

498
00:16:41,519 --> 00:16:44,560
familiarity around the attack framework

499
00:16:44,560 --> 00:16:46,800
and the matrix associated with it

500
00:16:46,800 --> 00:16:48,480
let's take a look at some thread intel

501
00:16:48,480 --> 00:16:50,560
or where we can rather get thread intel

502
00:16:50,560 --> 00:16:52,320
to help guide us on what attackers are

503
00:16:52,320 --> 00:16:54,639
doing and really a lot of security

504
00:16:54,639 --> 00:16:57,440
companies are producing uh thread intel

505
00:16:57,440 --> 00:16:59,440
or threat hunting reports that we can

506
00:16:59,440 --> 00:17:01,440
then turn around and use to just kind of

507
00:17:01,440 --> 00:17:04,240
get a picture of hey what is currently

508
00:17:04,240 --> 00:17:05,839
happening and can you give me some

509
00:17:05,839 --> 00:17:08,400
examples of it so you know this is going

510
00:17:08,400 --> 00:17:09,760
to be one thing to keep in mind as

511
00:17:09,760 --> 00:17:11,119
you're looking at the reports for a

512
00:17:11,119 --> 00:17:12,640
given company this is going to be the

513
00:17:12,640 --> 00:17:14,959
data that they can see that they have

514
00:17:14,959 --> 00:17:17,439
access to now that may be through threat

515
00:17:17,439 --> 00:17:19,760
hunting uh activity that they're

516
00:17:19,760 --> 00:17:20,959
monitoring let's say as part of a

517
00:17:20,959 --> 00:17:23,199
managed service like overwatch or you

518
00:17:23,199 --> 00:17:25,919
may get something like uh a threaded

519
00:17:25,919 --> 00:17:28,480
purely a thread intel platform where

520
00:17:28,480 --> 00:17:30,960
people have you know honey pots and

521
00:17:30,960 --> 00:17:32,480
other systems out there

522
00:17:32,480 --> 00:17:34,720
and methods of

523
00:17:34,720 --> 00:17:37,120
seeing what adversaries are up to

524
00:17:37,120 --> 00:17:38,799
um

525
00:17:38,799 --> 00:17:40,720
and talking about the different types of

526
00:17:40,720 --> 00:17:42,720
techniques or the the motives or the

527
00:17:42,720 --> 00:17:44,240
trends that they're seeing there

528
00:17:44,240 --> 00:17:45,600
regardless all of this is just going to

529
00:17:45,600 --> 00:17:47,280
be what each of these companies can see

530
00:17:47,280 --> 00:17:48,559
and you're going to see some variants

531
00:17:48,559 --> 00:17:50,000
between the different companies based on

532
00:17:50,000 --> 00:17:52,000
that data set which is pretty reasonable

533
00:17:52,000 --> 00:17:53,600
and expected

534
00:17:53,600 --> 00:17:55,039
typically in these reports you're going

535
00:17:55,039 --> 00:17:57,919
to see examples of the actual attacks

536
00:17:57,919 --> 00:17:59,679
and what do they look like how do they

537
00:17:59,679 --> 00:18:02,320
play out um

538
00:18:02,320 --> 00:18:04,240
and they'll tell you you know hey here's

539
00:18:04,240 --> 00:18:05,520
kind of you know what we saw the

540
00:18:05,520 --> 00:18:07,600
attacker achieve with this or what they

541
00:18:07,600 --> 00:18:09,679
attempted to achieve with this here's

542
00:18:09,679 --> 00:18:11,520
where we're able to get in ahead of that

543
00:18:11,520 --> 00:18:13,360
certainly you know on our team we're

544
00:18:13,360 --> 00:18:15,120
focused on trying to get ahead of the

545
00:18:15,120 --> 00:18:17,840
adversary accomplishing their objective

546
00:18:17,840 --> 00:18:19,760
that is our goal as threat hunters i

547
00:18:19,760 --> 00:18:21,440
don't care where you are you want to

548
00:18:21,440 --> 00:18:22,880
stop the adversary before they

549
00:18:22,880 --> 00:18:24,799
accomplish their objective and so you

550
00:18:24,799 --> 00:18:26,799
know how were they able to do that and

551
00:18:26,799 --> 00:18:28,799
so you'll see those types of discussions

552
00:18:28,799 --> 00:18:30,400
and the examples and the trends that

553
00:18:30,400 --> 00:18:31,520
they're talking about can be really

554
00:18:31,520 --> 00:18:32,880
useful for that

555
00:18:32,880 --> 00:18:34,400
now i'll throw out a couple of reports

556
00:18:34,400 --> 00:18:36,000
here from crowdstrike that you can go

557
00:18:36,000 --> 00:18:38,320
ahead and take a look at

558
00:18:38,320 --> 00:18:40,000
we've got the global threat report this

559
00:18:40,000 --> 00:18:41,919
comes out typically at the beginning of

560
00:18:41,919 --> 00:18:46,000
every year usually around february or so

561
00:18:46,000 --> 00:18:48,799
i you know here is the link to last

562
00:18:48,799 --> 00:18:50,240
year's threat report or rather this

563
00:18:50,240 --> 00:18:53,600
year's threat report in early 2021 a new

564
00:18:53,600 --> 00:18:55,520
one will be coming out here obviously

565
00:18:55,520 --> 00:18:57,280
early 2022

566
00:18:57,280 --> 00:19:00,000
and then back in september just last

567
00:19:00,000 --> 00:19:02,240
month uh the overwatch team and the team

568
00:19:02,240 --> 00:19:04,240
that i'm on specifically we wrote and

569
00:19:04,240 --> 00:19:07,039
released the know where to hide 2021

570
00:19:07,039 --> 00:19:10,240
hunting report and you can get that from

571
00:19:10,240 --> 00:19:12,320
this url here these will be in the

572
00:19:12,320 --> 00:19:15,039
slides um that should be going out with

573
00:19:15,039 --> 00:19:16,799
this so you can just go ahead and

574
00:19:16,799 --> 00:19:18,480
download them from there

575
00:19:18,480 --> 00:19:20,000
uh either way you're gonna be looking at

576
00:19:20,000 --> 00:19:21,919
examples of what we've seen and it's

577
00:19:21,919 --> 00:19:24,000
just and you know another one of these

578
00:19:24,000 --> 00:19:25,440
these reports out here that you can use

579
00:19:25,440 --> 00:19:27,280
like i said plenty of companies have

580
00:19:27,280 --> 00:19:29,440
them um and i would recommend hitting

581
00:19:29,440 --> 00:19:31,440
them all and that you can find and just

582
00:19:31,440 --> 00:19:32,720
trying to

583
00:19:32,720 --> 00:19:35,120
go what's of interest to you and and

584
00:19:35,120 --> 00:19:37,520
what you can hunt on uh you know what

585
00:19:37,520 --> 00:19:39,440
you can adapt to use inside of your

586
00:19:39,440 --> 00:19:41,600
environment

587
00:19:41,600 --> 00:19:43,600
so here's some examples now this is

588
00:19:43,600 --> 00:19:45,360
terribly not

589
00:19:45,360 --> 00:19:47,678
very

590
00:19:47,760 --> 00:19:50,080
elite you know right just all they're

591
00:19:50,080 --> 00:19:51,760
doing is just dumping

592
00:19:51,760 --> 00:19:53,600
the sam registry hive out and you'll

593
00:19:53,600 --> 00:19:56,000
just see reg save hklm sam and then

594
00:19:56,000 --> 00:19:57,440
they'll save it out to whatever file

595
00:19:57,440 --> 00:19:59,440
name that they choose in this case

596
00:19:59,440 --> 00:20:00,960
sam.out

597
00:20:00,960 --> 00:20:02,559
this one's a little more complex this is

598
00:20:02,559 --> 00:20:04,640
a powershell command more of a discovery

599
00:20:04,640 --> 00:20:06,480
command the actor gets into an

600
00:20:06,480 --> 00:20:08,480
environment honestly most threat actors

601
00:20:08,480 --> 00:20:09,440
i mean when they get into environment

602
00:20:09,440 --> 00:20:10,559
they don't know anything about it so

603
00:20:10,559 --> 00:20:11,919
they've got to start doing discovery to

604
00:20:11,919 --> 00:20:13,600
figure out where they are

605
00:20:13,600 --> 00:20:15,360
what system is this do i need to get to

606
00:20:15,360 --> 00:20:17,679
another system for it to be interesting

607
00:20:17,679 --> 00:20:19,679
and so they'll do commands like this in

608
00:20:19,679 --> 00:20:21,919
this case we're harvesting for computers

609
00:20:21,919 --> 00:20:23,760
inside of the environment and we've got

610
00:20:23,760 --> 00:20:25,600
looking for ip addresses operating

611
00:20:25,600 --> 00:20:28,080
system service pack level and then it's

612
00:20:28,080 --> 00:20:30,640
dumping it out to a table for them to

613
00:20:30,640 --> 00:20:32,799
use you know it's basically a list so a

614
00:20:32,799 --> 00:20:35,039
little bit more complex

615
00:20:35,039 --> 00:20:37,360
but you know this is this

616
00:20:37,360 --> 00:20:38,640
you know this is something we could hunt

617
00:20:38,640 --> 00:20:40,720
on how often does this really occur in

618
00:20:40,720 --> 00:20:42,640
our environment and if it does happen

619
00:20:42,640 --> 00:20:44,080
regularly let's say from a sub piece of

620
00:20:44,080 --> 00:20:46,480
software that uses this type of

621
00:20:46,480 --> 00:20:48,799
command to regular regularly

622
00:20:48,799 --> 00:20:50,640
poll our environment for information we

623
00:20:50,640 --> 00:20:52,240
can filter that out and then focus on

624
00:20:52,240 --> 00:20:53,760
where it's not occurring

625
00:20:53,760 --> 00:20:55,600
here's another example attack creating a

626
00:20:55,600 --> 00:20:58,000
service so in this case uh they're

627
00:20:58,000 --> 00:20:59,840
creating a service we redacted the name

628
00:20:59,840 --> 00:21:02,559
to avoid giving anything away

629
00:21:02,559 --> 00:21:04,240
but they have got this thing to start

630
00:21:04,240 --> 00:21:07,600
automatically here is the binary path

631
00:21:07,600 --> 00:21:09,200
basically launching under a command

632
00:21:09,200 --> 00:21:12,000
prompt and then here is the exe

633
00:21:12,000 --> 00:21:13,600
and the path to that and i did it under

634
00:21:13,600 --> 00:21:16,640
c windows slash resources and then the

635
00:21:16,640 --> 00:21:18,720
name of the exe so these are all things

636
00:21:18,720 --> 00:21:20,240
i can hunt on now there are things that

637
00:21:20,240 --> 00:21:21,919
i want we'll talk about when we do the

638
00:21:21,919 --> 00:21:24,640
hunt that we want to be careful of as we

639
00:21:24,640 --> 00:21:26,480
set up our queries to make sure that we

640
00:21:26,480 --> 00:21:27,520
aren't

641
00:21:27,520 --> 00:21:31,520
being too narrow so that we can

642
00:21:31,520 --> 00:21:33,120
catch as many things as possible and

643
00:21:33,120 --> 00:21:34,559
give us the best chance of catching an

644
00:21:34,559 --> 00:21:36,960
adversary in the acts

645
00:21:36,960 --> 00:21:38,640
so with that discussed let's go ahead

646
00:21:38,640 --> 00:21:40,400
and switch over to the virtual machines

647
00:21:40,400 --> 00:21:41,840
and we're going to do a little hunting

648
00:21:41,840 --> 00:21:45,480
and see what we can find

649
00:21:56,320 --> 00:21:57,679
so we've got two systems we're going to

650
00:21:57,679 --> 00:22:00,640
be using here for detection lab uh in

651
00:22:00,640 --> 00:22:03,200
particular uh just for a quick little

652
00:22:03,200 --> 00:22:04,880
demo again this is just kind of

653
00:22:04,880 --> 00:22:06,400
scratching the surface about how we

654
00:22:06,400 --> 00:22:08,240
would go about hunting this and maybe

655
00:22:08,240 --> 00:22:10,320
some points on what i would recommend

656
00:22:10,320 --> 00:22:11,039
for

657
00:22:11,039 --> 00:22:12,400
as you're practicing and learning

658
00:22:12,400 --> 00:22:14,480
yourself now i'm going to focus on using

659
00:22:14,480 --> 00:22:15,840
our domain controller this is where i'm

660
00:22:15,840 --> 00:22:17,840
going to execute the attacks

661
00:22:17,840 --> 00:22:19,520
i could do this though on the windows 10

662
00:22:19,520 --> 00:22:21,919
machine as well i suppose but i'm going

663
00:22:21,919 --> 00:22:23,280
to run it on the domain controller and

664
00:22:23,280 --> 00:22:24,799
then we'll switch over to windows 10

665
00:22:24,799 --> 00:22:26,799
where i've got splunk enterprise opened

666
00:22:26,799 --> 00:22:28,400
up and then we're going to take a look

667
00:22:28,400 --> 00:22:29,360
at

668
00:22:29,360 --> 00:22:31,440
really just the the basic

669
00:22:31,440 --> 00:22:33,600
search functionality there's a lot of

670
00:22:33,600 --> 00:22:36,640
tools in here to to dig into and see

671
00:22:36,640 --> 00:22:38,159
they've created some dashboards and

672
00:22:38,159 --> 00:22:40,400
stuff like that to help spot bad

673
00:22:40,400 --> 00:22:42,320
behavior that is certainly useful as

674
00:22:42,320 --> 00:22:43,760
well you could turn in and fire off

675
00:22:43,760 --> 00:22:46,400
atomic red team and let it run and then

676
00:22:46,400 --> 00:22:48,000
go in and look at that dashboard and

677
00:22:48,000 --> 00:22:50,559
then dig into what those command lines

678
00:22:50,559 --> 00:22:52,960
look like and then use that to inform

679
00:22:52,960 --> 00:22:54,400
what you're hunting for

680
00:22:54,400 --> 00:22:56,159
but i still would prefer and recommend

681
00:22:56,159 --> 00:22:57,520
as you're getting familiar with this

682
00:22:57,520 --> 00:22:59,120
stuff go look at a threat report look at

683
00:22:59,120 --> 00:23:00,720
what adversaries are doing how does this

684
00:23:00,720 --> 00:23:01,919
tool used

685
00:23:01,919 --> 00:23:04,480
fire it off in this environment and then

686
00:23:04,480 --> 00:23:06,640
go look for it inside of splunk so you

687
00:23:06,640 --> 00:23:08,080
get familiar with how you're going to

688
00:23:08,080 --> 00:23:10,000
query it and we're going to use splunk

689
00:23:10,000 --> 00:23:11,440
here but it could be cabana or whatever

690
00:23:11,440 --> 00:23:12,720
you use in your environment we're just

691
00:23:12,720 --> 00:23:16,640
using this as our our log interface here

692
00:23:16,640 --> 00:23:18,640
so i am already in

693
00:23:18,640 --> 00:23:22,720
uh c tools mimi for mimikatz x64

694
00:23:22,720 --> 00:23:26,159
we can see that i've got uh mimikatz in

695
00:23:26,159 --> 00:23:30,080
here maybe cats.exe i've got another

696
00:23:30,080 --> 00:23:31,919
executable named gimme

697
00:23:31,919 --> 00:23:33,679
exe that's actually just a copy of

698
00:23:33,679 --> 00:23:36,000
mimikatz with a different name now if

699
00:23:36,000 --> 00:23:37,600
i'm going to run mimikatz what this is

700
00:23:37,600 --> 00:23:39,440
going to do is cl capture whatever

701
00:23:39,440 --> 00:23:41,600
passwords it can from memory on this

702
00:23:41,600 --> 00:23:42,640
system

703
00:23:42,640 --> 00:23:45,039
and so to run it and you probably want

704
00:23:45,039 --> 00:23:46,960
to reference this and do some lookups on

705
00:23:46,960 --> 00:23:48,000
it because i constantly forget the

706
00:23:48,000 --> 00:23:51,360
syntax but it is just

707
00:23:51,360 --> 00:23:54,400
mimi cats.exe

708
00:23:54,400 --> 00:23:57,520
and then we're going to say

709
00:23:57,600 --> 00:24:01,279
do us double quotes privileges

710
00:24:01,279 --> 00:24:04,320
two colons debug

711
00:24:04,320 --> 00:24:06,000
another double quote and then we're

712
00:24:06,000 --> 00:24:08,320
going to do

713
00:24:08,320 --> 00:24:10,960
this is going to be sec url

714
00:24:10,960 --> 00:24:13,039
sa

715
00:24:13,039 --> 00:24:16,320
double colon again and then we want log

716
00:24:16,320 --> 00:24:17,200
on

717
00:24:17,200 --> 00:24:19,520
passwords which is going to give us

718
00:24:19,520 --> 00:24:21,120
anything it can really and then we're

719
00:24:21,120 --> 00:24:22,640
going to tell mimikatz to just go ahead

720
00:24:22,640 --> 00:24:25,120
and exit out and so if i

721
00:24:25,120 --> 00:24:28,880
can type this will should give us all of

722
00:24:28,880 --> 00:24:31,120
the execution of mimi cats

723
00:24:31,120 --> 00:24:32,960
for last little bit

724
00:24:32,960 --> 00:24:34,720
or excuse me should do execute maybe

725
00:24:34,720 --> 00:24:35,600
cats

726
00:24:35,600 --> 00:24:37,600
and sure enough it runs and i haven't

727
00:24:37,600 --> 00:24:39,279
done any hardening on this system this

728
00:24:39,279 --> 00:24:41,120
is just straight out from the vagrant

729
00:24:41,120 --> 00:24:43,039
build and so you can see here are

730
00:24:43,039 --> 00:24:44,880
passwords you can see they're terrible

731
00:24:44,880 --> 00:24:47,360
passwords you know the the built-in

732
00:24:47,360 --> 00:24:49,120
administrator account for domain admin

733
00:24:49,120 --> 00:24:51,600
is one password to exclamation point and

734
00:24:51,600 --> 00:24:54,320
that's horrible um

735
00:24:54,320 --> 00:24:56,400
but you know

736
00:24:56,400 --> 00:24:57,919
that so we've got that side of things

737
00:24:57,919 --> 00:25:00,159
let's say attacker got into the system

738
00:25:00,159 --> 00:25:01,840
they pulled down mimi cats and they

739
00:25:01,840 --> 00:25:03,679
executed it on the system

740
00:25:03,679 --> 00:25:05,600
and they got started getting credits

741
00:25:05,600 --> 00:25:07,520
okay so we're over here on the windows

742
00:25:07,520 --> 00:25:08,880
10 system

743
00:25:08,880 --> 00:25:11,279
uh inside of splunk

744
00:25:11,279 --> 00:25:12,400
we're going to go ahead and just click

745
00:25:12,400 --> 00:25:14,640
on the search and reporting

746
00:25:14,640 --> 00:25:17,120
link here

747
00:25:17,120 --> 00:25:18,720
and the first thing we need to start out

748
00:25:18,720 --> 00:25:21,200
with is hey where is what index are we

749
00:25:21,200 --> 00:25:22,320
looking at

750
00:25:22,320 --> 00:25:23,840
and there's documentation to tell you

751
00:25:23,840 --> 00:25:25,600
what indexes are here but in this case

752
00:25:25,600 --> 00:25:27,919
we're going to focus on the win

753
00:25:27,919 --> 00:25:29,919
event log

754
00:25:29,919 --> 00:25:30,880
okay

755
00:25:30,880 --> 00:25:32,400
and there are a couple of ways we could

756
00:25:32,400 --> 00:25:33,919
do this now it might be tempting to come

757
00:25:33,919 --> 00:25:35,360
in here and say hey

758
00:25:35,360 --> 00:25:38,400
this is great uh just let's just search

759
00:25:38,400 --> 00:25:40,240
for mimikats

760
00:25:40,240 --> 00:25:44,400
right exe this will be wonderful

761
00:25:44,400 --> 00:25:47,760
there's a comma e x e there we go and

762
00:25:47,760 --> 00:25:50,320
i'm gonna change this to the last oh 15

763
00:25:50,320 --> 00:25:52,720
minutes because i just executed it

764
00:25:52,720 --> 00:25:54,320
and boom

765
00:25:54,320 --> 00:25:56,159
hey there we go we can see mimikatz

766
00:25:56,159 --> 00:25:58,159
being run in this environment we can see

767
00:25:58,159 --> 00:26:00,080
here is the command line

768
00:26:00,080 --> 00:26:01,679
right here

769
00:26:01,679 --> 00:26:04,559
uh that it captured now to do this to

770
00:26:04,559 --> 00:26:06,240
have it be worked obviously to have it

771
00:26:06,240 --> 00:26:08,159
work you have to have your active

772
00:26:08,159 --> 00:26:10,960
directory environment set to log command

773
00:26:10,960 --> 00:26:13,440
lines and you can do that check out the

774
00:26:13,440 --> 00:26:16,080
you know just do a search on how to

775
00:26:16,080 --> 00:26:18,880
do enable audit logging for command

776
00:26:18,880 --> 00:26:21,120
lines that's going to add a lot of

777
00:26:21,120 --> 00:26:22,320
information

778
00:26:22,320 --> 00:26:24,799
and so be prepared for that uh don't

779
00:26:24,799 --> 00:26:26,960
just blast that out in your environment

780
00:26:26,960 --> 00:26:28,559
but if you can do this this is really

781
00:26:28,559 --> 00:26:30,480
useful and i'll be honest being you know

782
00:26:30,480 --> 00:26:32,640
with what i work with i definitely focus

783
00:26:32,640 --> 00:26:34,880
on uh the command lines because i've got

784
00:26:34,880 --> 00:26:36,480
a view into every command that the

785
00:26:36,480 --> 00:26:38,559
actor's running so okay great

786
00:26:38,559 --> 00:26:40,000
we spotted that

787
00:26:40,000 --> 00:26:42,480
but let's say what happens if the actor

788
00:26:42,480 --> 00:26:44,720
does something else they say well

789
00:26:44,720 --> 00:26:46,240
i know that they're probably looking for

790
00:26:46,240 --> 00:26:48,640
me me cats so instead we're going to use

791
00:26:48,640 --> 00:26:51,039
a custom version of mimi cats

792
00:26:51,039 --> 00:26:53,200
and all right i just renamed it but we

793
00:26:53,200 --> 00:26:57,200
certainly have seen actors do that

794
00:26:57,200 --> 00:26:59,600
um

795
00:26:59,679 --> 00:27:01,760
there it is give me.exe

796
00:27:01,760 --> 00:27:03,120
we've certainly where they have compiled

797
00:27:03,120 --> 00:27:04,720
their own versions and stuff like that

798
00:27:04,720 --> 00:27:07,440
doesn't match hatches or file names or

799
00:27:07,440 --> 00:27:09,200
all kinds of stuff and so we're just

800
00:27:09,200 --> 00:27:11,919
going to run the same command again

801
00:27:11,919 --> 00:27:14,400
privileges

802
00:27:14,400 --> 00:27:16,960
debug

803
00:27:17,120 --> 00:27:19,760
double quote again double quote

804
00:27:19,760 --> 00:27:23,360
sec url sa

805
00:27:25,440 --> 00:27:30,399
double quotes and log on passwords

806
00:27:30,399 --> 00:27:32,960
and finally exit and so we run this and

807
00:27:32,960 --> 00:27:35,360
sure enough we get the same results

808
00:27:35,360 --> 00:27:38,000
but if i go over here

809
00:27:38,000 --> 00:27:41,279
and we see the timestamp was 1206 and 23

810
00:27:41,279 --> 00:27:43,279
seconds am

811
00:27:43,279 --> 00:27:45,360
if i was just searching for mimikatz

812
00:27:45,360 --> 00:27:46,880
obviously this isn't going to work out

813
00:27:46,880 --> 00:27:49,760
real well because

814
00:27:49,760 --> 00:27:51,840
it didn't catch the latest version the

815
00:27:51,840 --> 00:27:53,600
latest execution because it doesn't

816
00:27:53,600 --> 00:27:55,600
match what we're looking for so we could

817
00:27:55,600 --> 00:27:57,360
step back and maybe be a little bit more

818
00:27:57,360 --> 00:28:00,000
general and say well what about sec url

819
00:28:00,000 --> 00:28:01,760
sa because that's one of the command

820
00:28:01,760 --> 00:28:03,360
options in there

821
00:28:03,360 --> 00:28:07,039
maybe we could find something like that

822
00:28:07,039 --> 00:28:08,960
aha there we go now we can see that in

823
00:28:08,960 --> 00:28:10,480
the last 15 minutes we've got this

824
00:28:10,480 --> 00:28:11,919
execution

825
00:28:11,919 --> 00:28:13,200
of

826
00:28:13,200 --> 00:28:15,200
oh it didn't show up what on earth are

827
00:28:15,200 --> 00:28:19,720
you doing did not make it in here yet

828
00:28:41,760 --> 00:28:43,279
there we go

829
00:28:43,279 --> 00:28:44,720
all right just took a second for that to

830
00:28:44,720 --> 00:28:46,559
show up

831
00:28:46,559 --> 00:28:48,640
so now we can see here is our

832
00:28:48,640 --> 00:28:52,640
our previous one 1206 and 23 seconds

833
00:28:52,640 --> 00:28:55,440
well now we've got it at 12 10 and 23

834
00:28:55,440 --> 00:28:57,760
seconds again oddly enough

835
00:28:57,760 --> 00:28:58,880
anyhow

836
00:28:58,880 --> 00:29:00,799
we can see that this time it was gimme

837
00:29:00,799 --> 00:29:02,399
that was being run but we picked up on

838
00:29:02,399 --> 00:29:05,200
the sec urlsa so that's one way we could

839
00:29:05,200 --> 00:29:08,080
look at doing this but what if the actor

840
00:29:08,080 --> 00:29:10,240
did mimi cats a slightly different way

841
00:29:10,240 --> 00:29:13,840
let's see what that looks like again

842
00:29:13,840 --> 00:29:16,159
so we'll go back over here and i have

843
00:29:16,159 --> 00:29:19,120
this saved up

844
00:29:19,120 --> 00:29:21,520
where we are going to just

845
00:29:21,520 --> 00:29:23,440
look for it

846
00:29:23,440 --> 00:29:27,000
with a

847
00:29:27,039 --> 00:29:29,760
powershell download command it's going

848
00:29:29,760 --> 00:29:33,360
to pull down a powershell

849
00:29:35,520 --> 00:29:38,559
script and execute in

850
00:29:38,559 --> 00:29:40,799
my environment so we're going to pull it

851
00:29:40,799 --> 00:29:42,880
down from github this is coming from the

852
00:29:42,880 --> 00:29:44,880
empire project

853
00:29:44,880 --> 00:29:47,600
actually let me

854
00:29:47,679 --> 00:29:49,200
put it up here to the top where we can

855
00:29:49,200 --> 00:29:50,399
see that

856
00:29:50,399 --> 00:29:51,679
there we go

857
00:29:51,679 --> 00:29:53,360
and we're going to do that now so if

858
00:29:53,360 --> 00:29:54,960
this works it's going to go out download

859
00:29:54,960 --> 00:29:57,679
mimics from github and then invoke it on

860
00:29:57,679 --> 00:29:59,279
the system and hopefully dump our

861
00:29:59,279 --> 00:30:00,640
credentials out

862
00:30:00,640 --> 00:30:02,240
and there we go

863
00:30:02,240 --> 00:30:04,559
now how did that end up looking well we

864
00:30:04,559 --> 00:30:06,480
can scroll up here to the top we can see

865
00:30:06,480 --> 00:30:09,760
the output that was done

866
00:30:09,760 --> 00:30:11,360
and you know

867
00:30:11,360 --> 00:30:14,080
it appears that we still have this we we

868
00:30:14,080 --> 00:30:16,240
launched this sec url

869
00:30:16,240 --> 00:30:17,360
sa

870
00:30:17,360 --> 00:30:19,840
inside of the mimi cat shell so

871
00:30:19,840 --> 00:30:22,320
let's see what we find are we able to

872
00:30:22,320 --> 00:30:24,080
find this over here on the

873
00:30:24,080 --> 00:30:25,679
inside of splunk

874
00:30:25,679 --> 00:30:27,840
we may not be able to find it just this

875
00:30:27,840 --> 00:30:28,720
way

876
00:30:28,720 --> 00:30:31,200
and so you start out here we want to

877
00:30:31,200 --> 00:30:33,120
look for mimikats executing in an

878
00:30:33,120 --> 00:30:34,159
environment

879
00:30:34,159 --> 00:30:36,080
so we refresh our query that we found

880
00:30:36,080 --> 00:30:38,000
that worked for all of this stuff

881
00:30:38,000 --> 00:30:40,640
and it doesn't look like we're going to

882
00:30:40,640 --> 00:30:44,720
get it so let's do in

883
00:30:45,440 --> 00:30:47,279
invoke mimi

884
00:30:47,279 --> 00:30:49,440
cats like this

885
00:30:49,440 --> 00:30:51,760
and let's see that if that shows up in

886
00:30:51,760 --> 00:30:53,840
the last 15 minutes let's show see what

887
00:30:53,840 --> 00:30:55,360
that looks like

888
00:30:55,360 --> 00:30:57,120
okay so here we go now we can see that

889
00:30:57,120 --> 00:30:59,279
this is showing up

890
00:30:59,279 --> 00:31:01,120
we actually have several commands being

891
00:31:01,120 --> 00:31:02,799
executed here

892
00:31:02,799 --> 00:31:04,640
events being logged for this but we can

893
00:31:04,640 --> 00:31:06,080
expand this out

894
00:31:06,080 --> 00:31:07,840
and see okay well that's this showed up

895
00:31:07,840 --> 00:31:10,960
differently we didn't see sec url sa

896
00:31:10,960 --> 00:31:12,640
necessarily

897
00:31:12,640 --> 00:31:14,320
and so this is going to have to change

898
00:31:14,320 --> 00:31:16,240
how we hunt a little bit

899
00:31:16,240 --> 00:31:18,080
and essentially what you want to do is

900
00:31:18,080 --> 00:31:19,840
as you're doing this you find all of

901
00:31:19,840 --> 00:31:22,720
these variations here is just one type

902
00:31:22,720 --> 00:31:25,279
of attack uh run two well three

903
00:31:25,279 --> 00:31:26,960
different ways right just vanilla

904
00:31:26,960 --> 00:31:30,159
download from from the mimikatz project

905
00:31:30,159 --> 00:31:32,720
a renamed version of so we've kind of

906
00:31:32,720 --> 00:31:34,880
obscured something a little bit and then

907
00:31:34,880 --> 00:31:36,960
a powershell execution and you can see

908
00:31:36,960 --> 00:31:38,399
that we want to make sure we're not

909
00:31:38,399 --> 00:31:40,039
getting too specific so looking for

910
00:31:40,039 --> 00:31:42,080
mimikats.exe let's focus on something

911
00:31:42,080 --> 00:31:43,519
that's kind of broad

912
00:31:43,519 --> 00:31:46,080
go for secure lsa that should catch most

913
00:31:46,080 --> 00:31:50,480
command line executions uh at least um

914
00:31:50,480 --> 00:31:52,480
and then oh they do this via powershell

915
00:31:52,480 --> 00:31:55,440
as well so i need to add another

916
00:31:55,440 --> 00:31:58,159
bit of another query to this type of

917
00:31:58,159 --> 00:31:59,679
hunting and so then you can build that

918
00:31:59,679 --> 00:32:01,440
out so now you you know you want also

919
00:32:01,440 --> 00:32:02,880
look at how you tweak your queries i

920
00:32:02,880 --> 00:32:05,360
mean at this point we've got two queries

921
00:32:05,360 --> 00:32:07,279
uh to to

922
00:32:07,279 --> 00:32:10,240
basically find these detail these events

923
00:32:10,240 --> 00:32:12,080
obviously if i'm hunting mimikatz i want

924
00:32:12,080 --> 00:32:13,760
to try and combine this up as much as i

925
00:32:13,760 --> 00:32:14,399
can

926
00:32:14,399 --> 00:32:16,799
without getting super specific but also

927
00:32:16,799 --> 00:32:18,080
take into account some of these

928
00:32:18,080 --> 00:32:20,640
variations so maybe i want to you know

929
00:32:20,640 --> 00:32:21,919
let's let's mess with this a little bit

930
00:32:21,919 --> 00:32:23,760
i can always do an or statement in here

931
00:32:23,760 --> 00:32:26,840
and say well okay we're sick

932
00:32:26,840 --> 00:32:30,320
urlsa right and and do another search

933
00:32:30,320 --> 00:32:31,360
for that

934
00:32:31,360 --> 00:32:33,440
and then we'll scroll down here's i mean

935
00:32:33,440 --> 00:32:34,960
we've got the invoke mimi cats from

936
00:32:34,960 --> 00:32:36,320
powershell that's great we've got a

937
00:32:36,320 --> 00:32:37,919
whole bunch of executions of that

938
00:32:37,919 --> 00:32:39,840
occurring and then

939
00:32:39,840 --> 00:32:41,279
yep here finally at the bottom and this

940
00:32:41,279 --> 00:32:44,559
is where we see gimme uh.exe with secure

941
00:32:44,559 --> 00:32:46,480
lsa in there

942
00:32:46,480 --> 00:32:50,080
and so that starts to give us you know

943
00:32:50,080 --> 00:32:52,559
tiny tiny a little bit more complex

944
00:32:52,559 --> 00:32:53,519
query

945
00:32:53,519 --> 00:32:55,360
but it allows us to catch more of these

946
00:32:55,360 --> 00:32:56,720
in one place and so what i would

947
00:32:56,720 --> 00:32:58,320
recommend doing is you're looking at a

948
00:32:58,320 --> 00:33:00,960
particular type of attack let's say mimi

949
00:33:00,960 --> 00:33:02,000
cats

950
00:33:02,000 --> 00:33:03,840
and i would focus it on maybe tools or

951
00:33:03,840 --> 00:33:07,120
specific behaviors

952
00:33:08,000 --> 00:33:09,360
so i'm not trying to combine like

953
00:33:09,360 --> 00:33:11,200
multiple ways of creating harvesting

954
00:33:11,200 --> 00:33:13,440
credentials into one uber query but you

955
00:33:13,440 --> 00:33:14,480
know let's okay we're going to dig into

956
00:33:14,480 --> 00:33:15,919
mimikat so what are the different ways i

957
00:33:15,919 --> 00:33:17,519
can execute that and let me see if i can

958
00:33:17,519 --> 00:33:19,919
build a query to catch most of these

959
00:33:19,919 --> 00:33:21,279
variations and then you want to

960
00:33:21,279 --> 00:33:23,440
periodically go back and you know okay

961
00:33:23,440 --> 00:33:25,039
fine i've got this query it's built it's

962
00:33:25,039 --> 00:33:26,559
looking good this is what i'm going to

963
00:33:26,559 --> 00:33:28,720
use but then go back and keep testing so

964
00:33:28,720 --> 00:33:30,159
you can find other edge cases you know

965
00:33:30,159 --> 00:33:31,919
other ways of executing it

966
00:33:31,919 --> 00:33:34,720
typically adversaries i mean they do a

967
00:33:34,720 --> 00:33:36,480
lot of cut some places will do a lot of

968
00:33:36,480 --> 00:33:38,000
organ groups will do a lot of

969
00:33:38,000 --> 00:33:40,320
customization of the tools uh others

970
00:33:40,320 --> 00:33:42,399
will just flat out i mean you'll see

971
00:33:42,399 --> 00:33:43,919
adversaries launch tools and they're

972
00:33:43,919 --> 00:33:45,440
downloading it from github just like you

973
00:33:45,440 --> 00:33:46,640
saw me do

974
00:33:46,640 --> 00:33:49,440
um and there it is so

975
00:33:49,440 --> 00:33:51,039
you know just kind of get familiar with

976
00:33:51,039 --> 00:33:52,880
how that works

977
00:33:52,880 --> 00:33:54,880
and then and just keep tuning it for

978
00:33:54,880 --> 00:33:57,440
your environment and and and keep

979
00:33:57,440 --> 00:34:00,799
learning and seeing you know

980
00:34:01,519 --> 00:34:02,799
how you can apply this to your

981
00:34:02,799 --> 00:34:04,480
organization and then you know you would

982
00:34:04,480 --> 00:34:06,159
save this query and then come back and

983
00:34:06,159 --> 00:34:08,239
run it periodically maybe have it run

984
00:34:08,239 --> 00:34:09,199
every

985
00:34:09,199 --> 00:34:10,879
few minutes and then say an email

986
00:34:10,879 --> 00:34:12,560
notification or something like that if

987
00:34:12,560 --> 00:34:14,879
it happens that's another way of of just

988
00:34:14,879 --> 00:34:16,560
kind of running things in the background

989
00:34:16,560 --> 00:34:18,159
when you can't be there

990
00:34:18,159 --> 00:34:21,800
at the keyboard itself

991
00:34:22,320 --> 00:34:23,839
all right so let's let's go ahead and

992
00:34:23,839 --> 00:34:26,239
take a look at one more uh technique

993
00:34:26,239 --> 00:34:28,800
that you see we see adversaries do

994
00:34:28,800 --> 00:34:30,560
fairly often again i'm going to focus

995
00:34:30,560 --> 00:34:31,918
around credentials just to kind of stay

996
00:34:31,918 --> 00:34:33,918
on that theme here a little bit we'll go

997
00:34:33,918 --> 00:34:36,159
back over to our domain controller here

998
00:34:36,159 --> 00:34:38,159
and we've got this

999
00:34:38,159 --> 00:34:40,639
text file here handy-dandy of my

1000
00:34:40,639 --> 00:34:43,520
commands that i'm going to use and let's

1001
00:34:43,520 --> 00:34:45,440
just grab this one right here

1002
00:34:45,440 --> 00:34:46,839
in this case

1003
00:34:46,839 --> 00:34:49,520
uh one of the things adversaries will

1004
00:34:49,520 --> 00:34:51,679
look at doing is they need to get a hold

1005
00:34:51,679 --> 00:34:52,800
of

1006
00:34:52,800 --> 00:34:55,760
credentials but the host isn't set to

1007
00:34:55,760 --> 00:34:58,079
store credentials in clear text uh

1008
00:34:58,079 --> 00:34:59,599
basically it's already been hardened for

1009
00:34:59,599 --> 00:35:01,359
that and so the adversary will come back

1010
00:35:01,359 --> 00:35:02,960
in and say oh my goodness this isn't

1011
00:35:02,960 --> 00:35:05,440
working um let me try

1012
00:35:05,440 --> 00:35:06,240
uh

1013
00:35:06,240 --> 00:35:09,280
modifying w digest and

1014
00:35:09,280 --> 00:35:12,880
setting it basically to um use log

1015
00:35:12,880 --> 00:35:14,480
adding the registry key use logon

1016
00:35:14,480 --> 00:35:17,200
credential and set the value to one

1017
00:35:17,200 --> 00:35:20,879
essentially configuring

1018
00:35:21,200 --> 00:35:23,599
the system to now store credentials in

1019
00:35:23,599 --> 00:35:26,079
memory and so we'll run that

1020
00:35:26,079 --> 00:35:28,079
and it completed successfully and then

1021
00:35:28,079 --> 00:35:29,520
sometimes you'll see the adversaries go

1022
00:35:29,520 --> 00:35:30,800
away for a little while and then they'll

1023
00:35:30,800 --> 00:35:33,440
come back to see hey did anybody log in

1024
00:35:33,440 --> 00:35:35,680
did i capture anything

1025
00:35:35,680 --> 00:35:37,040
because it's not going to go back and

1026
00:35:37,040 --> 00:35:38,400
decrypt anything obviously it's going to

1027
00:35:38,400 --> 00:35:40,480
have to wait till until somebody puts

1028
00:35:40,480 --> 00:35:42,320
something into memory by logging into

1029
00:35:42,320 --> 00:35:43,359
the host

1030
00:35:43,359 --> 00:35:45,920
so if we're going to hunt on that sort

1031
00:35:45,920 --> 00:35:49,920
of attack let's say we're interested in

1032
00:35:49,920 --> 00:35:52,480
the w digest type of thing so we hunt

1033
00:35:52,480 --> 00:35:55,119
for w

1034
00:35:56,160 --> 00:36:02,560
w digest and go ahead and search on that

1035
00:36:02,560 --> 00:36:04,480
and let's see what we've got we can find

1036
00:36:04,480 --> 00:36:07,599
the execution

1037
00:36:11,520 --> 00:36:13,160
we got here so this was the

1038
00:36:13,160 --> 00:36:15,599
[Music]

1039
00:36:15,599 --> 00:36:19,119
command it looks like

1040
00:36:19,280 --> 00:36:21,280
nope

1041
00:36:21,280 --> 00:36:22,960
haven't shown it up yet hasn't shown up

1042
00:36:22,960 --> 00:36:25,280
yet all right hang on one second we'll

1043
00:36:25,280 --> 00:36:27,040
refresh that again

1044
00:36:27,040 --> 00:36:28,480
there it is okay so it just took a

1045
00:36:28,480 --> 00:36:31,599
second for it to arrive in our logging

1046
00:36:31,599 --> 00:36:33,200
so here you can see the command that i

1047
00:36:33,200 --> 00:36:35,680
just ran

1048
00:36:35,680 --> 00:36:37,359
we've got the command line showing up

1049
00:36:37,359 --> 00:36:38,320
here

1050
00:36:38,320 --> 00:36:40,480
um

1051
00:36:40,480 --> 00:36:43,119
adding you know to hkey local syste

1052
00:36:43,119 --> 00:36:45,359
local machine system et cetera et cetera

1053
00:36:45,359 --> 00:36:47,920
security providers w digest and actually

1054
00:36:47,920 --> 00:36:49,680
add some information here saying hey

1055
00:36:49,680 --> 00:36:52,720
this is what's going on uh you know some

1056
00:36:52,720 --> 00:36:54,560
background information to this this

1057
00:36:54,560 --> 00:36:56,640
particular type of event and so we could

1058
00:36:56,640 --> 00:36:58,960
hunt on that sort of thing um but you

1059
00:36:58,960 --> 00:37:00,640
know honestly depending on how your

1060
00:37:00,640 --> 00:37:02,880
environment looks and what's going on

1061
00:37:02,880 --> 00:37:05,599
uh maybe we want to just watch for any

1062
00:37:05,599 --> 00:37:09,119
changes to the security providers at all

1063
00:37:09,119 --> 00:37:12,240
and so instead of being so specific on w

1064
00:37:12,240 --> 00:37:14,800
digest maybe we back up and just

1065
00:37:14,800 --> 00:37:16,079
you know we look at that and think well

1066
00:37:16,079 --> 00:37:18,400
you know let's let's instead let's just

1067
00:37:18,400 --> 00:37:20,560
let's grab this

1068
00:37:20,560 --> 00:37:23,599
and instead of being too specific here

1069
00:37:23,599 --> 00:37:24,640
and

1070
00:37:24,640 --> 00:37:28,000
we'll paste in security providers

1071
00:37:28,000 --> 00:37:30,400
and go ahead and search on that okay

1072
00:37:30,400 --> 00:37:31,680
that actually cut out a lot of the

1073
00:37:31,680 --> 00:37:33,119
previous other noise that had been in

1074
00:37:33,119 --> 00:37:33,920
here

1075
00:37:33,920 --> 00:37:35,200
and we can see

1076
00:37:35,200 --> 00:37:37,920
you know any changes into this key or

1077
00:37:37,920 --> 00:37:40,560
under this this registry key at all

1078
00:37:40,560 --> 00:37:42,480
and so this is another way of just you

1079
00:37:42,480 --> 00:37:44,480
just kind of dig into that and you know

1080
00:37:44,480 --> 00:37:46,720
all i did to come up with this this was

1081
00:37:46,720 --> 00:37:48,079
literally just

1082
00:37:48,079 --> 00:37:49,760
coming off of

1083
00:37:49,760 --> 00:37:52,480
the miter attack framework so we'll just

1084
00:37:52,480 --> 00:37:56,359
go back to attack.mitre.org

1085
00:37:58,079 --> 00:38:00,960
and

1086
00:38:03,599 --> 00:38:05,760
this would be the credential harvesting

1087
00:38:05,760 --> 00:38:07,520
i can never remember which sub key it's

1088
00:38:07,520 --> 00:38:08,960
under so i'm just going to expand them

1089
00:38:08,960 --> 00:38:11,440
all for

1090
00:38:11,440 --> 00:38:17,800
credential access and where are you

1091
00:38:22,240 --> 00:38:23,839
oh it doesn't have it in here as far as

1092
00:38:23,839 --> 00:38:26,000
w digest you know you can just come up

1093
00:38:26,000 --> 00:38:29,200
here let's search for w dye

1094
00:38:29,200 --> 00:38:32,640
just from the interface for attack

1095
00:38:32,640 --> 00:38:35,440
search box for it and here we go

1096
00:38:35,440 --> 00:38:37,760
so modify the registry key

1097
00:38:37,760 --> 00:38:40,400
and so all right so this would be

1098
00:38:40,400 --> 00:38:42,400
this particular attack would have been

1099
00:38:42,400 --> 00:38:43,680
technique would have been more about

1100
00:38:43,680 --> 00:38:45,680
modifying the registry because we are

1101
00:38:45,680 --> 00:38:48,400
softening the attackers softening up the

1102
00:38:48,400 --> 00:38:52,240
system and reconfiguring it and so i was

1103
00:38:52,240 --> 00:38:54,160
just kind of looking in the wrong spot

1104
00:38:54,160 --> 00:38:56,640
anyhow um so in this case you can come

1105
00:38:56,640 --> 00:38:58,079
in here and see what's going on with

1106
00:38:58,079 --> 00:39:01,599
this uh who are the actors that use this

1107
00:39:01,599 --> 00:39:03,200
and then you can see

1108
00:39:03,200 --> 00:39:05,599
let's see if we can find w digest in

1109
00:39:05,599 --> 00:39:07,920
here

1110
00:39:08,480 --> 00:39:10,560
there you go there's one entry about it

1111
00:39:10,560 --> 00:39:13,599
about a particular tool

1112
00:39:13,599 --> 00:39:16,160
okay enables the digest by changing the

1113
00:39:16,160 --> 00:39:20,160
registry value from zero to one

1114
00:39:20,160 --> 00:39:21,280
now

1115
00:39:21,280 --> 00:39:23,680
404 off the link in the

1116
00:39:23,680 --> 00:39:26,240
site so

1117
00:39:27,119 --> 00:39:28,960
there you go here's the registry key

1118
00:39:28,960 --> 00:39:30,960
that i was interested in wizard spider

1119
00:39:30,960 --> 00:39:32,880
modifies the registry key to this and so

1120
00:39:32,880 --> 00:39:35,440
this just kind of informs me uh of what

1121
00:39:35,440 --> 00:39:37,680
this is and then i would just kind of

1122
00:39:37,680 --> 00:39:39,760
okay well how do i want to how would

1123
00:39:39,760 --> 00:39:42,880
this be executed

1124
00:39:42,960 --> 00:39:44,800
and so you just you know check that out

1125
00:39:44,800 --> 00:39:46,720
and and do a quick google search on that

1126
00:39:46,720 --> 00:39:48,480
and then pivot along figure out how the

1127
00:39:48,480 --> 00:39:50,560
commands work and again like i said this

1128
00:39:50,560 --> 00:39:54,240
is where you just come back to your lab

1129
00:39:54,720 --> 00:39:57,680
run it here in your tac system and then

1130
00:39:57,680 --> 00:39:59,040
jump over to

1131
00:39:59,040 --> 00:40:00,000
your

1132
00:40:00,000 --> 00:40:01,440
your logging interface and start

1133
00:40:01,440 --> 00:40:02,720
figuring out how to query on it this one

1134
00:40:02,720 --> 00:40:04,800
was really easy of course uh you know

1135
00:40:04,800 --> 00:40:06,640
there are other many many other ways we

1136
00:40:06,640 --> 00:40:08,800
could we could go after this and there

1137
00:40:08,800 --> 00:40:10,319
are different things that you want to

1138
00:40:10,319 --> 00:40:11,839
ask yourself as you're coming up with

1139
00:40:11,839 --> 00:40:14,720
your hypothesis about how does this work

1140
00:40:14,720 --> 00:40:17,280
well how would an attacker go after my

1141
00:40:17,280 --> 00:40:18,640
organization

1142
00:40:18,640 --> 00:40:22,720
well i run a lot of iis web servers so

1143
00:40:22,720 --> 00:40:24,640
one possible thing that an attacker

1144
00:40:24,640 --> 00:40:26,400
might do is i might think okay well

1145
00:40:26,400 --> 00:40:27,920
maybe an attacker gets a command

1146
00:40:27,920 --> 00:40:29,119
injection

1147
00:40:29,119 --> 00:40:30,240
uh

1148
00:40:30,240 --> 00:40:32,319
finds a command injection flaw they're

1149
00:40:32,319 --> 00:40:35,599
exploiting it in my environment and you

1150
00:40:35,599 --> 00:40:37,119
know again they get onto the box they

1151
00:40:37,119 --> 00:40:38,960
got to figure out where they are

1152
00:40:38,960 --> 00:40:40,240
you know what privileges are they

1153
00:40:40,240 --> 00:40:41,599
running as

1154
00:40:41,599 --> 00:40:43,680
what's the ip address of this thing so

1155
00:40:43,680 --> 00:40:45,599
you might seem like you know or want to

1156
00:40:45,599 --> 00:40:46,480
harvest

1157
00:40:46,480 --> 00:40:48,640
harvest accounts you know do discovery

1158
00:40:48,640 --> 00:40:50,880
on user accounts so they do

1159
00:40:50,880 --> 00:40:54,160
net user slash domain or they go back to

1160
00:40:54,160 --> 00:40:55,599
that powershell they try and execute

1161
00:40:55,599 --> 00:40:58,240
that powershell command that i ran or

1162
00:40:58,240 --> 00:41:00,960
showed earlier from the

1163
00:41:00,960 --> 00:41:02,800
our threat hunting report about where it

1164
00:41:02,800 --> 00:41:04,240
extracted all that information from

1165
00:41:04,240 --> 00:41:05,280
active

1166
00:41:05,280 --> 00:41:07,040
directory and grab the host the ip

1167
00:41:07,040 --> 00:41:09,440
address and and the operating system and

1168
00:41:09,440 --> 00:41:11,200
stuff like that and so then you could

1169
00:41:11,200 --> 00:41:12,640
come in here and just start building

1170
00:41:12,640 --> 00:41:14,480
queries for that and start going after

1171
00:41:14,480 --> 00:41:17,200
and see okay can i find this in my

1172
00:41:17,200 --> 00:41:20,720
environment and if so you know is this

1173
00:41:20,720 --> 00:41:23,040
expected for my environment and if it is

1174
00:41:23,040 --> 00:41:24,480
you'll typically see a lot of noise

1175
00:41:24,480 --> 00:41:26,079
associated with it and you can filter

1176
00:41:26,079 --> 00:41:28,640
that out and and then start to look for

1177
00:41:28,640 --> 00:41:30,480
the unusual behaviors

1178
00:41:30,480 --> 00:41:31,920
and one thing that gets kind of daunting

1179
00:41:31,920 --> 00:41:33,200
at first when you start this is you'll

1180
00:41:33,200 --> 00:41:36,160
run into a lot of noise

1181
00:41:36,160 --> 00:41:38,319
keep at it because what i find and what

1182
00:41:38,319 --> 00:41:40,800
i found in my own experience was as i

1183
00:41:40,800 --> 00:41:43,040
was

1184
00:41:43,200 --> 00:41:44,560
working in my own environment back when

1185
00:41:44,560 --> 00:41:46,079
i was a security engineer it was

1186
00:41:46,079 --> 00:41:48,319
overwhelming there was so much happening

1187
00:41:48,319 --> 00:41:49,920
but then i started filtering things okay

1188
00:41:49,920 --> 00:41:51,920
this is expected for this application

1189
00:41:51,920 --> 00:41:53,839
this is over here that's fine so we'll

1190
00:41:53,839 --> 00:41:55,839
move that out of my view and then i got

1191
00:41:55,839 --> 00:41:58,000
to where i could spot the unusual

1192
00:41:58,000 --> 00:42:01,119
behaviors in my org my network and that

1193
00:42:01,119 --> 00:42:03,359
allowed me to be basically a better

1194
00:42:03,359 --> 00:42:05,920
defender and it you know

1195
00:42:05,920 --> 00:42:07,280
and thread hunter

1196
00:42:07,280 --> 00:42:09,040
so those are just some ways to look at

1197
00:42:09,040 --> 00:42:12,000
doing this and to to do some brief quick

1198
00:42:12,000 --> 00:42:14,240
threat hunting really light top of the

1199
00:42:14,240 --> 00:42:16,240
top surface but it shows the process

1200
00:42:16,240 --> 00:42:18,160
here and that's really what we're after

1201
00:42:18,160 --> 00:42:19,920
let's go ahead and take a jump back over

1202
00:42:19,920 --> 00:42:22,720
to our slides

1203
00:42:23,599 --> 00:42:25,760
and talk about some next steps

1204
00:42:25,760 --> 00:42:27,040
you know you're in here you're

1205
00:42:27,040 --> 00:42:28,480
practicing you're doing this you're

1206
00:42:28,480 --> 00:42:30,000
getting familiar with it what are some

1207
00:42:30,000 --> 00:42:32,000
things you can do next

1208
00:42:32,000 --> 00:42:35,040
one i advocate just keep repeating and

1209
00:42:35,040 --> 00:42:36,880
learning this takes a lot of practice to

1210
00:42:36,880 --> 00:42:38,960
get used to it's like a lot of other

1211
00:42:38,960 --> 00:42:41,440
things inside of it and security it's a

1212
00:42:41,440 --> 00:42:43,839
perishable skill if you don't lose it it

1213
00:42:43,839 --> 00:42:45,359
atrophies and you have to go back and

1214
00:42:45,359 --> 00:42:48,000
relearn how to do it like the 97th time

1215
00:42:48,000 --> 00:42:50,640
that i've learned how to use python and

1216
00:42:50,640 --> 00:42:52,079
and script

1217
00:42:52,079 --> 00:42:53,920
out stuff there

1218
00:42:53,920 --> 00:42:55,920
so dedicate regular time to go out and

1219
00:42:55,920 --> 00:42:57,280
do a little hunting you don't have to do

1220
00:42:57,280 --> 00:42:58,560
a ton

1221
00:42:58,560 --> 00:43:00,880
uh just to to get familiar with it and

1222
00:43:00,880 --> 00:43:02,960
get started right you just dedicated

1223
00:43:02,960 --> 00:43:05,280
that regular time let's say an hour

1224
00:43:05,280 --> 00:43:07,440
or two hours three times a week or

1225
00:43:07,440 --> 00:43:09,599
whatever it is you can carve out you see

1226
00:43:09,599 --> 00:43:12,400
do that you do some practicing on that

1227
00:43:12,400 --> 00:43:14,000
figure out how to go from that thread

1228
00:43:14,000 --> 00:43:16,240
intel down to a hunt

1229
00:43:16,240 --> 00:43:18,880
uh go out there read those those hunting

1230
00:43:18,880 --> 00:43:21,599
reports those uh thread intel uh reports

1231
00:43:21,599 --> 00:43:23,760
are out there look at those techniques

1232
00:43:23,760 --> 00:43:27,280
turn around use those as a tipper if you

1233
00:43:27,280 --> 00:43:28,960
will to use inside of your hunts turn

1234
00:43:28,960 --> 00:43:31,440
around and plug that tool into detection

1235
00:43:31,440 --> 00:43:33,599
lab run it okay what does it take for me

1236
00:43:33,599 --> 00:43:34,720
to find it

1237
00:43:34,720 --> 00:43:35,599
right

1238
00:43:35,599 --> 00:43:37,280
and so yeah you just turn around you run

1239
00:43:37,280 --> 00:43:39,680
it in the lab and then go for it

1240
00:43:39,680 --> 00:43:41,599
and then refine your process and

1241
00:43:41,599 --> 00:43:44,079
document what you're doing uh you know

1242
00:43:44,079 --> 00:43:46,079
make note of what each of these commands

1243
00:43:46,079 --> 00:43:47,119
are

1244
00:43:47,119 --> 00:43:48,800
or these queries are so that you can go

1245
00:43:48,800 --> 00:43:50,560
back and pick up on them again later and

1246
00:43:50,560 --> 00:43:52,640
you're not just starting over each time

1247
00:43:52,640 --> 00:43:54,720
so just keep going this is something you

1248
00:43:54,720 --> 00:43:55,760
all if you want to be a good threat

1249
00:43:55,760 --> 00:43:57,440
hunter you always have to learn i can

1250
00:43:57,440 --> 00:43:58,880
tell you when i started threat hunting

1251
00:43:58,880 --> 00:44:01,599
at crowdstrike three years ago what we

1252
00:44:01,599 --> 00:44:03,280
were hunting on and what adversaries

1253
00:44:03,280 --> 00:44:05,359
were doing was different than what we

1254
00:44:05,359 --> 00:44:06,960
see them doing today or at least what

1255
00:44:06,960 --> 00:44:08,480
they're predominantly doing you see

1256
00:44:08,480 --> 00:44:10,640
trends and changes i mean yeah there's a

1257
00:44:10,640 --> 00:44:12,880
lot of overlap but you know different

1258
00:44:12,880 --> 00:44:14,640
campaigns that we're really raging then

1259
00:44:14,640 --> 00:44:16,240
aren't so much we're seeing other things

1260
00:44:16,240 --> 00:44:18,480
now

1261
00:44:18,480 --> 00:44:20,079
now if you are wanting to get into

1262
00:44:20,079 --> 00:44:21,520
thrunt hunting i'm going to assume that

1263
00:44:21,520 --> 00:44:23,680
you want to look for a job

1264
00:44:23,680 --> 00:44:26,000
right you want to get into this role and

1265
00:44:26,000 --> 00:44:27,680
so i wanted to spend a couple minutes

1266
00:44:27,680 --> 00:44:29,599
talking about what we look for inside of

1267
00:44:29,599 --> 00:44:33,200
overwatch as far as in our hunters

1268
00:44:33,200 --> 00:44:34,880
one we're looking for experience in

1269
00:44:34,880 --> 00:44:36,960
people and this can be blue team or red

1270
00:44:36,960 --> 00:44:38,480
team like i said we come from different

1271
00:44:38,480 --> 00:44:40,800
backgrounds uh you don't have to

1272
00:44:40,800 --> 00:44:43,920
necessarily be a dedicated threat hunter

1273
00:44:43,920 --> 00:44:45,280
to be what we're looking for though we

1274
00:44:45,280 --> 00:44:47,680
love to see that um but if you come in

1275
00:44:47,680 --> 00:44:49,359
you're like a solid forensic person

1276
00:44:49,359 --> 00:44:50,960
you're like hey i know how these

1277
00:44:50,960 --> 00:44:52,400
commands look and stuff like that but i

1278
00:44:52,400 --> 00:44:55,760
want to get out ahead of this instead of

1279
00:44:55,760 --> 00:44:57,599
you know diagnosing the carnage after

1280
00:44:57,599 --> 00:44:59,760
the fact let me get in here and see if i

1281
00:44:59,760 --> 00:45:01,200
can hunt it down and we can interrupt

1282
00:45:01,200 --> 00:45:02,960
them before they get going so that's

1283
00:45:02,960 --> 00:45:04,640
stuff that we want to see you know

1284
00:45:04,640 --> 00:45:06,480
that's a great background for a threat

1285
00:45:06,480 --> 00:45:09,040
hunter we also look for curiosity

1286
00:45:09,040 --> 00:45:11,040
because again we've got to constantly be

1287
00:45:11,040 --> 00:45:14,079
learning and so we we have to have that

1288
00:45:14,079 --> 00:45:16,240
inborn curiosity to keep driving us

1289
00:45:16,240 --> 00:45:18,480
forward so that we can keep researching

1290
00:45:18,480 --> 00:45:20,560
what adversaries are up to

1291
00:45:20,560 --> 00:45:22,800
we want to be persistent as well threat

1292
00:45:22,800 --> 00:45:24,960
hunting is can be really frustrating

1293
00:45:24,960 --> 00:45:26,319
because you go out you spend a bunch of

1294
00:45:26,319 --> 00:45:28,079
time you may spend several hours hunting

1295
00:45:28,079 --> 00:45:29,200
something down in your environment and

1296
00:45:29,200 --> 00:45:31,520
just come away and say man i got nothing

1297
00:45:31,520 --> 00:45:34,560
it just doesn't it's not happening here

1298
00:45:34,560 --> 00:45:36,480
that's good right we don't want to see

1299
00:45:36,480 --> 00:45:37,920
that happening in our environments but

1300
00:45:37,920 --> 00:45:39,359
at the same time it's frustrating to us

1301
00:45:39,359 --> 00:45:41,359
doing the hunt because we're hoping to

1302
00:45:41,359 --> 00:45:42,960
find something

1303
00:45:42,960 --> 00:45:45,040
so you got to be persistent so be

1304
00:45:45,040 --> 00:45:47,760
prepared to for that uh you know if this

1305
00:45:47,760 --> 00:45:49,839
sounds like you then you are potentially

1306
00:45:49,839 --> 00:45:51,440
a really good threat hunter or a good

1307
00:45:51,440 --> 00:45:53,440
candidate for threat hunting

1308
00:45:53,440 --> 00:45:55,760
and then document your practicing you

1309
00:45:55,760 --> 00:45:57,440
know trying to get that experience

1310
00:45:57,440 --> 00:45:59,359
demonstrated that experience is really

1311
00:45:59,359 --> 00:46:00,720
you know one of the things we're always

1312
00:46:00,720 --> 00:46:02,640
going to get asked this in interviews so

1313
00:46:02,640 --> 00:46:04,240
do things like record videos that you're

1314
00:46:04,240 --> 00:46:05,520
doing in the detection lab and then

1315
00:46:05,520 --> 00:46:07,040
publish them up to youtube and then

1316
00:46:07,040 --> 00:46:09,440
practice presenting what's going on

1317
00:46:09,440 --> 00:46:12,000
write it up put it into a blog post and

1318
00:46:12,000 --> 00:46:13,119
write it up and you sit there and think

1319
00:46:13,119 --> 00:46:14,640
well that's kind of okay but who's going

1320
00:46:14,640 --> 00:46:16,560
to read this thing well maybe nobody

1321
00:46:16,560 --> 00:46:20,400
reads it but to be honest with you

1322
00:46:20,400 --> 00:46:21,920
this gives you confidence in how you

1323
00:46:21,920 --> 00:46:23,920
talk about it you can do conference

1324
00:46:23,920 --> 00:46:25,599
presentations i used to like to do this

1325
00:46:25,599 --> 00:46:26,880
all the time i want to learn about

1326
00:46:26,880 --> 00:46:28,800
something or other so go research into

1327
00:46:28,800 --> 00:46:30,319
it and then turn around and do a

1328
00:46:30,319 --> 00:46:32,800
conference presentation

1329
00:46:32,800 --> 00:46:34,880
and then internally if you're hunting at

1330
00:46:34,880 --> 00:46:36,880
work document how you're doing your

1331
00:46:36,880 --> 00:46:39,040
hunting at work but we're not publishing

1332
00:46:39,040 --> 00:46:41,920
that to the outside world right keep

1333
00:46:41,920 --> 00:46:43,520
this internal into your company share it

1334
00:46:43,520 --> 00:46:45,200
amongst your team members let's say

1335
00:46:45,200 --> 00:46:47,839
you're a sys admin or security engineer

1336
00:46:47,839 --> 00:46:49,920
you're doing some hunting document that

1337
00:46:49,920 --> 00:46:52,160
and and spread the information around

1338
00:46:52,160 --> 00:46:54,720
amongst your team members

1339
00:46:54,720 --> 00:46:56,640
now again benefits of documenting

1340
00:46:56,640 --> 00:46:58,319
everything out helps you talk about it

1341
00:46:58,319 --> 00:46:59,839
during the interview you can just turn

1342
00:46:59,839 --> 00:47:01,200
around and tell stories while i was

1343
00:47:01,200 --> 00:47:02,000
looking

1344
00:47:02,000 --> 00:47:05,119
for uh some reconnaissance or discovery

1345
00:47:05,119 --> 00:47:07,200
type of commands in my environment and i

1346
00:47:07,200 --> 00:47:09,359
found where an apache server was

1347
00:47:09,359 --> 00:47:11,280
compromised and i could see the actor

1348
00:47:11,280 --> 00:47:13,440
turn around and look at bash underscore

1349
00:47:13,440 --> 00:47:15,200
history and trying to get credentials

1350
00:47:15,200 --> 00:47:16,880
that way and you can just tell these

1351
00:47:16,880 --> 00:47:19,520
stories uh so but you'll have that ready

1352
00:47:19,520 --> 00:47:21,119
of mine because you spent the time to

1353
00:47:21,119 --> 00:47:22,640
work at it not only hunt it down but

1354
00:47:22,640 --> 00:47:25,040
write it up

1355
00:47:25,040 --> 00:47:26,400
and honestly even if you're doing this

1356
00:47:26,400 --> 00:47:28,559
at work and your current job you know

1357
00:47:28,559 --> 00:47:30,160
you can talk about how you've applied

1358
00:47:30,160 --> 00:47:31,920
that sort of stuff into your current job

1359
00:47:31,920 --> 00:47:33,440
and the results you got there because

1360
00:47:33,440 --> 00:47:35,599
that's fair game in an interview

1361
00:47:35,599 --> 00:47:37,520
so these are all useful things to help

1362
00:47:37,520 --> 00:47:40,000
you get going and get into your first

1363
00:47:40,000 --> 00:47:42,800
job as a threat hunter i can't recommend

1364
00:47:42,800 --> 00:47:44,400
this type of stuff enough you know

1365
00:47:44,400 --> 00:47:46,079
really just doing the work writing it

1366
00:47:46,079 --> 00:47:48,400
down and digging into it

1367
00:47:48,400 --> 00:47:50,400
talking about it really helps you out

1368
00:47:50,400 --> 00:47:51,839
when it comes time to get into that

1369
00:47:51,839 --> 00:47:53,280
interview and demonstrate your

1370
00:47:53,280 --> 00:47:55,280
experience

1371
00:47:55,280 --> 00:47:56,720
now with that we're going to open this

1372
00:47:56,720 --> 00:47:59,280
up to q a via discord and thank you very

1373
00:47:59,280 --> 00:48:01,040
much really appreciate you spending the

1374
00:48:01,040 --> 00:48:03,760
time here listening to me today i look

1375
00:48:03,760 --> 00:48:04,960
forward to hearing from you talk to you

1376
00:48:04,960 --> 00:48:07,839
later thanks

