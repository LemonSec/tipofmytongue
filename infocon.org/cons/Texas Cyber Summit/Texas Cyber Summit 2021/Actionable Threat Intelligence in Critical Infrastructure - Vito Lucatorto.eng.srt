1
00:00:01,599 --> 00:00:04,560
hello everybody uh it's a great pleasure

2
00:00:04,560 --> 00:00:06,240
for me to be here

3
00:00:06,240 --> 00:00:07,919
i hope that

4
00:00:07,919 --> 00:00:09,519
what i'm going to show you can be

5
00:00:09,519 --> 00:00:12,160
applied in your realities

6
00:00:12,160 --> 00:00:14,400
what i'm going to tell you

7
00:00:14,400 --> 00:00:16,480
about is the application of actionable

8
00:00:16,480 --> 00:00:18,960
threat intelligence in italian critical

9
00:00:18,960 --> 00:00:21,119
infrastructure

10
00:00:21,119 --> 00:00:24,560
first of all uh i'm visual torto and now

11
00:00:24,560 --> 00:00:28,080
i'm live in italy i recently changed the

12
00:00:28,080 --> 00:00:31,039
company where i work and this project

13
00:00:31,039 --> 00:00:33,840
was done and carried out in the previous

14
00:00:33,840 --> 00:00:34,880
company

15
00:00:34,880 --> 00:00:37,600
i'm a cyber security engineer and a

16
00:00:37,600 --> 00:00:39,280
threat intelligence lead

17
00:00:39,280 --> 00:00:42,559
i'm co-founder of

18
00:00:42,559 --> 00:00:45,520
an independent cyber security community

19
00:00:45,520 --> 00:00:47,680
called the cyber strategy initiative

20
00:00:47,680 --> 00:00:50,480
below you can see our logo

21
00:00:50,480 --> 00:00:51,680
and

22
00:00:51,680 --> 00:00:54,239
i'm interested in threat intelligence

23
00:00:54,239 --> 00:00:57,680
and apt analysis and i usually try a new

24
00:00:57,680 --> 00:00:59,920
cyber offensive and the same defensive

25
00:00:59,920 --> 00:01:01,680
technique

26
00:01:01,680 --> 00:01:04,080
if you want to follow me or our

27
00:01:04,080 --> 00:01:06,400
non-profits association please check

28
00:01:06,400 --> 00:01:09,280
this link below

29
00:01:09,280 --> 00:01:12,000
before starting this speech i give you a

30
00:01:12,000 --> 00:01:14,400
very short definition of threat

31
00:01:14,400 --> 00:01:15,600
intelligence

32
00:01:15,600 --> 00:01:18,320
threat intelligence is

33
00:01:18,320 --> 00:01:21,040
knowledge that allows you to prevent or

34
00:01:21,040 --> 00:01:23,360
mitigate cyber attack threat

35
00:01:23,360 --> 00:01:26,240
intelligence is the sum of the knowledge

36
00:01:26,240 --> 00:01:29,680
of the context tactic and resources of

37
00:01:29,680 --> 00:01:31,360
the cyber threats

38
00:01:31,360 --> 00:01:34,320
what is the context context provides a

39
00:01:34,320 --> 00:01:37,200
better understanding of the threats and

40
00:01:37,200 --> 00:01:40,320
what it means to your environment

41
00:01:40,320 --> 00:01:42,320
tactics means

42
00:01:42,320 --> 00:01:44,640
knowing how an attacker moves what

43
00:01:44,640 --> 00:01:47,840
skills he has and what goals he must

44
00:01:47,840 --> 00:01:49,119
achieve

45
00:01:49,119 --> 00:01:52,560
resources is understand how much

46
00:01:52,560 --> 00:01:56,079
firepower an attacker has in economic

47
00:01:56,079 --> 00:01:57,360
computational

48
00:01:57,360 --> 00:02:00,240
and human power

49
00:02:00,240 --> 00:02:03,759
gti or cyber threat intelligence can be

50
00:02:03,759 --> 00:02:07,040
seen as a circular process the process

51
00:02:07,040 --> 00:02:09,360
starts with an hypothesis

52
00:02:09,360 --> 00:02:10,800
question as

53
00:02:10,800 --> 00:02:13,599
uh i've been compromised

54
00:02:13,599 --> 00:02:15,760
there is an alert in a cm

55
00:02:15,760 --> 00:02:18,400
how can i prevent attack

56
00:02:18,400 --> 00:02:21,280
or i have read a bulletin of an

57
00:02:21,280 --> 00:02:24,160
intelligence report report

58
00:02:24,160 --> 00:02:26,080
the second step is

59
00:02:26,080 --> 00:02:29,520
to collect data reliability data uh can

60
00:02:29,520 --> 00:02:32,959
be found from oziint closing social

61
00:02:32,959 --> 00:02:36,400
media dark web telegram

62
00:02:36,400 --> 00:02:39,280
or simply googling

63
00:02:39,280 --> 00:02:41,760
after having a collected

64
00:02:41,760 --> 00:02:46,000
a sufficient amount of data for you

65
00:02:46,000 --> 00:02:48,000
this data must be processed by

66
00:02:48,000 --> 00:02:49,599
normalizing them

67
00:02:49,599 --> 00:02:52,720
a fundamental aspect is to understand

68
00:02:52,720 --> 00:02:54,720
which data

69
00:02:54,720 --> 00:02:57,680
are useful in our context

70
00:02:57,680 --> 00:02:59,040
imagine

71
00:02:59,040 --> 00:03:01,760
an egg malware campaign involving and

72
00:03:01,760 --> 00:03:04,560
compromise of the swift banking system

73
00:03:04,560 --> 00:03:08,239
may be a little little significance

74
00:03:08,239 --> 00:03:11,680
when you work for a hospital

75
00:03:11,680 --> 00:03:13,680
if the previous step

76
00:03:13,680 --> 00:03:16,000
have been carried out correctly

77
00:03:16,000 --> 00:03:19,120
analyzing the data means finding answers

78
00:03:19,120 --> 00:03:20,800
to the hypothesis

79
00:03:20,800 --> 00:03:23,680
after having formulated a thesis it is

80
00:03:23,680 --> 00:03:26,000
necessary to share this information with

81
00:03:26,000 --> 00:03:27,680
the stakeholders

82
00:03:27,680 --> 00:03:29,040
and

83
00:03:29,040 --> 00:03:30,480
finally

84
00:03:30,480 --> 00:03:33,280
wait for the feedback

85
00:03:33,280 --> 00:03:36,720
in case of positive of negative outcome

86
00:03:36,720 --> 00:03:39,120
the cycle will have to resume to

87
00:03:39,120 --> 00:03:42,319
reformulate a new hypothesis to improve

88
00:03:42,319 --> 00:03:45,200
the previous analysis or start another

89
00:03:45,200 --> 00:03:47,200
one

90
00:03:47,200 --> 00:03:49,120
let me show you the difference between

91
00:03:49,120 --> 00:03:51,519
the tactical and operational threat

92
00:03:51,519 --> 00:03:52,720
intelligence

93
00:03:52,720 --> 00:03:55,599
the tactical threat intelligence focuses

94
00:03:55,599 --> 00:03:58,319
on the managing the iocs

95
00:03:58,319 --> 00:03:59,040
no

96
00:03:59,040 --> 00:04:00,480
the ttip

97
00:04:00,480 --> 00:04:02,879
of the attackers

98
00:04:02,879 --> 00:04:05,760
dtp means static technique and

99
00:04:05,760 --> 00:04:07,519
procedures

100
00:04:07,519 --> 00:04:11,200
and respond directly to threats

101
00:04:11,200 --> 00:04:12,799
the operational threat intelligence

102
00:04:12,799 --> 00:04:15,599
deals with ongoing cyber attacks events

103
00:04:15,599 --> 00:04:16,880
and campaigns

104
00:04:16,880 --> 00:04:19,519
ancient response teams insight on

105
00:04:19,519 --> 00:04:22,720
attacks and the speed up processes and

106
00:04:22,720 --> 00:04:26,800
make informed decision

107
00:04:27,199 --> 00:04:29,840
what do you think are the outputs of the

108
00:04:29,840 --> 00:04:32,560
tactical threat intelligence all of you

109
00:04:32,560 --> 00:04:34,160
all of you

110
00:04:34,160 --> 00:04:37,360
will say the ioc it's simple

111
00:04:37,360 --> 00:04:41,840
i see our email metadata domains url

112
00:04:41,840 --> 00:04:44,560
financial data as eban number of credit

113
00:04:44,560 --> 00:04:48,560
card file metadata ep address

114
00:04:48,560 --> 00:04:50,320
this indicator are the technical

115
00:04:50,320 --> 00:04:52,880
evidence of possible compromise of a

116
00:04:52,880 --> 00:04:53,840
system

117
00:04:53,840 --> 00:04:57,680
it's essential to have a rebel variable

118
00:04:57,680 --> 00:04:58,720
and

119
00:04:58,720 --> 00:05:02,400
the contextualized clues or indicators

120
00:05:02,400 --> 00:05:04,240
as they allow you to speed up the

121
00:05:04,240 --> 00:05:08,080
process of threat intelligence

122
00:05:08,080 --> 00:05:10,080
treat intelligence to be functional and

123
00:05:10,080 --> 00:05:12,960
efficient need to have multiple teams

124
00:05:12,960 --> 00:05:14,880
cooperate all together

125
00:05:14,880 --> 00:05:17,440
what do the groups do

126
00:05:17,440 --> 00:05:20,000
in chat response team is the group that

127
00:05:20,000 --> 00:05:22,479
is responsible from responding to and

128
00:05:22,479 --> 00:05:25,360
eradicating any cyber threats

129
00:05:25,360 --> 00:05:29,280
the real-time security monitoring teams

130
00:05:29,280 --> 00:05:31,120
is the group that helps

131
00:05:31,120 --> 00:05:34,080
the the uh threat intelligence analyst

132
00:05:34,080 --> 00:05:36,639
to integrate feats and intelligence

133
00:05:36,639 --> 00:05:38,720
information into cm

134
00:05:38,720 --> 00:05:40,960
and analyze them

135
00:05:40,960 --> 00:05:42,800
the threat hunter team

136
00:05:42,800 --> 00:05:44,080
guarantee

137
00:05:44,080 --> 00:05:45,840
continuous monitoring and the

138
00:05:45,840 --> 00:05:48,960
possibility of using new techniques and

139
00:05:48,960 --> 00:05:52,800
monitoring based on the new attacks

140
00:05:52,800 --> 00:05:53,919
and last

141
00:05:53,919 --> 00:05:56,639
cyber security device management

142
00:05:56,639 --> 00:05:58,639
deals with the management of the

143
00:05:58,639 --> 00:06:01,759
security systems

144
00:06:01,759 --> 00:06:05,120
after these seven theories like this

145
00:06:05,120 --> 00:06:07,199
let's start presenting where we made

146
00:06:07,199 --> 00:06:10,080
what i'm about to show you

147
00:06:10,080 --> 00:06:14,479
the company has over 83 000 employees

148
00:06:14,479 --> 00:06:17,120
it's a large corporate group that have

149
00:06:17,120 --> 00:06:20,720
15 companies and the turnover of 2020

150
00:06:20,720 --> 00:06:21,720
was

151
00:06:21,720 --> 00:06:23,680
10.8.8

152
00:06:23,680 --> 00:06:25,120
billion

153
00:06:25,120 --> 00:06:28,319
the headquarter is in rome

154
00:06:28,319 --> 00:06:29,120
and

155
00:06:29,120 --> 00:06:32,479
this heart the other fearing office in

156
00:06:32,479 --> 00:06:35,360
the world

157
00:06:35,360 --> 00:06:37,440
it's a leading company in the rail

158
00:06:37,440 --> 00:06:39,440
transport in italy

159
00:06:39,440 --> 00:06:42,639
and the company moves passengers but

160
00:06:42,639 --> 00:06:44,240
also goods

161
00:06:44,240 --> 00:06:46,880
manage all manages older railway

162
00:06:46,880 --> 00:06:50,400
stations some italian motorways ferris

163
00:06:50,400 --> 00:06:53,359
android transport

164
00:06:53,840 --> 00:06:55,919
before starting this project this is a

165
00:06:55,919 --> 00:06:58,880
nicer presentation how what we found

166
00:06:58,880 --> 00:07:00,880
chaos panic

167
00:07:00,880 --> 00:07:04,080
we had various teams producing tons of

168
00:07:04,080 --> 00:07:05,759
ios

169
00:07:05,759 --> 00:07:08,720
the information traveled by immense by

170
00:07:08,720 --> 00:07:13,199
voice in front of excellent coffees

171
00:07:13,199 --> 00:07:15,919
there was a basic threat intelligence

172
00:07:15,919 --> 00:07:19,280
platform where ballets were loaded

173
00:07:19,280 --> 00:07:22,479
automatically and

174
00:07:22,479 --> 00:07:25,599
the related iocs ended up in a list to

175
00:07:25,599 --> 00:07:29,280
be loaded into the cm

176
00:07:29,440 --> 00:07:32,080
requests to blocks iocs were send via

177
00:07:32,080 --> 00:07:35,199
mail or via voice

178
00:07:35,199 --> 00:07:37,440
the threat intelligence platform was the

179
00:07:37,440 --> 00:07:40,560
results of the internal development

180
00:07:40,560 --> 00:07:44,960
sufficient to fulfill this task

181
00:07:44,960 --> 00:07:47,280
so one day we run to the chef

182
00:07:47,280 --> 00:07:49,120
information security officer and

183
00:07:49,120 --> 00:07:52,560
disclaimed hey man we have an idea

184
00:07:52,560 --> 00:07:54,400
he has worked us in a most classic

185
00:07:54,400 --> 00:07:56,160
italian way

186
00:07:56,160 --> 00:08:00,720
our idea was to do less better

187
00:08:00,720 --> 00:08:02,639
we have decided to grow and set

188
00:08:02,639 --> 00:08:04,720
challenging goals to improve the threat

189
00:08:04,720 --> 00:08:06,960
intelligence process the primary goal

190
00:08:06,960 --> 00:08:09,840
was to defend societies as critical the

191
00:08:09,840 --> 00:08:12,319
second is give value to every single

192
00:08:12,319 --> 00:08:14,879
iosis

193
00:08:15,520 --> 00:08:18,000
was important also reduce the false

194
00:08:18,000 --> 00:08:20,960
positive and improve the information

195
00:08:20,960 --> 00:08:24,479
sharing and team coordination process

196
00:08:24,479 --> 00:08:28,639
all of these by automating um as much

197
00:08:28,639 --> 00:08:32,958
possible and defining cleared processes

198
00:08:32,958 --> 00:08:35,039
before embarking on this beautiful

199
00:08:35,039 --> 00:08:36,320
journey

200
00:08:36,320 --> 00:08:39,039
we analyzed all the problems we want to

201
00:08:39,039 --> 00:08:40,719
solve

202
00:08:40,719 --> 00:08:43,360
you can see them in this timeline

203
00:08:43,360 --> 00:08:46,720
we have identified six focal points in

204
00:08:46,720 --> 00:08:48,560
our project

205
00:08:48,560 --> 00:08:52,320
now let's go through them one by one

206
00:08:52,320 --> 00:08:53,519
the first step

207
00:08:53,519 --> 00:08:56,240
is to identify the requirements and the

208
00:08:56,240 --> 00:08:57,519
gap

209
00:08:57,519 --> 00:08:59,920
and non-standard management of the feed

210
00:08:59,920 --> 00:09:03,279
by the various team sending via mail

211
00:09:03,279 --> 00:09:05,200
chat voice

212
00:09:05,200 --> 00:09:09,680
a basic and not unified taxonomy

213
00:09:09,680 --> 00:09:12,959
the concept of automated ioc decay is

214
00:09:12,959 --> 00:09:14,320
not present

215
00:09:14,320 --> 00:09:17,519
iuc managed in a not harmonious or

216
00:09:17,519 --> 00:09:21,680
automated way and led to duplicates with

217
00:09:21,680 --> 00:09:24,800
waste of time and computing resources

218
00:09:24,800 --> 00:09:27,600
management of force positive only after

219
00:09:27,600 --> 00:09:29,200
detection

220
00:09:29,200 --> 00:09:32,160
it may happen that in some bulletin or

221
00:09:32,160 --> 00:09:34,800
feeds there are clear foods positives

222
00:09:34,800 --> 00:09:37,040
you know and

223
00:09:37,040 --> 00:09:39,120
a basic deep threat intelligence

224
00:09:39,120 --> 00:09:41,680
platform with integration with the cm

225
00:09:41,680 --> 00:09:45,920
and enrichment of iocs not present and

226
00:09:45,920 --> 00:09:48,080
last another distribution and the

227
00:09:48,080 --> 00:09:51,360
sharing of iocs

228
00:09:51,360 --> 00:09:52,720
before choosing

229
00:09:52,720 --> 00:09:54,959
the threat intelligence platform we

230
00:09:54,959 --> 00:09:57,200
studied some open source and pay

231
00:09:57,200 --> 00:09:58,480
projects

232
00:09:58,480 --> 00:10:00,720
in the end the shoes fell

233
00:10:00,720 --> 00:10:03,360
on the miss platform because there is

234
00:10:03,360 --> 00:10:05,600
the possibility of having a various way

235
00:10:05,600 --> 00:10:08,160
of importing data there is a tag and

236
00:10:08,160 --> 00:10:10,480
organization management system

237
00:10:10,480 --> 00:10:13,120
um the api

238
00:10:13,120 --> 00:10:16,160
are available and well documented

239
00:10:16,160 --> 00:10:17,279
exists

240
00:10:17,279 --> 00:10:21,200
and the ioc decay features

241
00:10:21,200 --> 00:10:23,600
the possibility of using the sighting

242
00:10:23,600 --> 00:10:25,760
closely linked to the concept of the

243
00:10:25,760 --> 00:10:28,160
decay that we will see

244
00:10:28,160 --> 00:10:30,480
shortly

245
00:10:30,480 --> 00:10:33,760
the downside are the lack of the support

246
00:10:33,760 --> 00:10:36,399
with sla

247
00:10:36,399 --> 00:10:39,279
the time consuming customization and we

248
00:10:39,279 --> 00:10:41,920
had to invent integration system with

249
00:10:41,920 --> 00:10:46,160
the third part never experience it

250
00:10:46,160 --> 00:10:47,920
after choosing the threat intelligence

251
00:10:47,920 --> 00:10:49,680
platform

252
00:10:49,680 --> 00:10:51,839
we decide to improve it

253
00:10:51,839 --> 00:10:53,920
how can we do it

254
00:10:53,920 --> 00:10:56,560
creating an automating messenger system

255
00:10:56,560 --> 00:10:59,360
differentiate by organization

256
00:10:59,360 --> 00:11:01,839
and operational groups

257
00:11:01,839 --> 00:11:04,720
by creating a backward search system

258
00:11:04,720 --> 00:11:06,000
with the cm

259
00:11:06,000 --> 00:11:09,200
at the time of loading the iocs

260
00:11:09,200 --> 00:11:12,160
and advanced white listing system to

261
00:11:12,160 --> 00:11:14,560
avoid false positives

262
00:11:14,560 --> 00:11:17,040
and an automatic tagging system based on

263
00:11:17,040 --> 00:11:19,760
the fixed variables or analyzing a

264
00:11:19,760 --> 00:11:21,760
natural language

265
00:11:21,760 --> 00:11:25,920
and if enrichment systems

266
00:11:25,920 --> 00:11:28,800
as a first step we coordinated the three

267
00:11:28,800 --> 00:11:32,880
teams anti-matters ancient response and

268
00:11:32,880 --> 00:11:35,200
trend hunter teams

269
00:11:35,200 --> 00:11:37,680
with the aim of producing

270
00:11:37,680 --> 00:11:40,640
a standardized and normalized output

271
00:11:40,640 --> 00:11:41,840
according to our schemes

272
00:11:41,840 --> 00:11:43,279
[Music]

273
00:11:43,279 --> 00:11:44,880
as a second steps

274
00:11:44,880 --> 00:11:46,480
we have created

275
00:11:46,480 --> 00:11:48,160
an

276
00:11:48,160 --> 00:11:53,440
sftp server that can accept xml json

277
00:11:53,440 --> 00:11:55,680
pdf

278
00:11:55,680 --> 00:11:58,880
s v files and malware samples

279
00:11:58,880 --> 00:12:02,000
so far with good communication

280
00:12:02,000 --> 00:12:04,480
and a simple knowledge of the sftp

281
00:12:04,480 --> 00:12:08,560
server we have solved two huge problems

282
00:12:08,560 --> 00:12:12,240
so now team analysis results can flow in

283
00:12:12,240 --> 00:12:15,839
a single point as well as the sftp

284
00:12:15,839 --> 00:12:17,360
server

285
00:12:17,360 --> 00:12:21,839
what is now this colorful brain

286
00:12:21,839 --> 00:12:24,480
it's a series a bash

287
00:12:24,480 --> 00:12:26,880
python chrome tab script and a bit of

288
00:12:26,880 --> 00:12:29,200
luck

289
00:12:29,600 --> 00:12:31,360
automation script take care of

290
00:12:31,360 --> 00:12:34,000
extracting mirror samples previously

291
00:12:34,000 --> 00:12:37,680
uploaded by team from the sftp server

292
00:12:37,680 --> 00:12:40,639
after this the big brain starts sending

293
00:12:40,639 --> 00:12:42,639
the samples

294
00:12:42,639 --> 00:12:44,800
to the various boxes present in the

295
00:12:44,800 --> 00:12:47,279
various companies

296
00:12:47,279 --> 00:12:51,200
detonating and executing the samples

297
00:12:51,200 --> 00:12:52,399
produced

298
00:12:52,399 --> 00:12:55,680
other iocs that are immediately sent to

299
00:12:55,680 --> 00:12:57,600
the protection systems

300
00:12:57,600 --> 00:12:59,600
such navigation proxy

301
00:12:59,600 --> 00:13:01,440
and anti-spam

302
00:13:01,440 --> 00:13:03,200
all these

303
00:13:03,200 --> 00:13:05,440
allow to accelerate

304
00:13:05,440 --> 00:13:08,000
the contrast of the possible malware

305
00:13:08,000 --> 00:13:10,480
campaign

306
00:13:10,720 --> 00:13:12,560
as an improvement of

307
00:13:12,560 --> 00:13:13,920
this project

308
00:13:13,920 --> 00:13:16,399
we are developing a system

309
00:13:16,399 --> 00:13:18,959
to be able to distribute the houses

310
00:13:18,959 --> 00:13:21,920
obtained from the sandbox analysis

311
00:13:21,920 --> 00:13:25,519
also on the clients

312
00:13:25,839 --> 00:13:28,399
during the definition of sex boxes

313
00:13:28,399 --> 00:13:29,519
mirror

314
00:13:29,519 --> 00:13:32,800
files containing iocs produced by the

315
00:13:32,800 --> 00:13:35,279
security teams

316
00:13:35,279 --> 00:13:37,839
are evaluated by automatic internal

317
00:13:37,839 --> 00:13:39,120
whitelist

318
00:13:39,120 --> 00:13:42,720
to avoid possible false positives

319
00:13:42,720 --> 00:13:46,720
due to errors or oversight

320
00:13:46,720 --> 00:13:48,480
how does the check work

321
00:13:48,480 --> 00:13:51,519
imagine that an analyst accidentally

322
00:13:51,519 --> 00:13:53,920
entered the google domain in the list of

323
00:13:53,920 --> 00:13:55,440
diocese

324
00:13:55,440 --> 00:13:57,760
if this domain were considered as

325
00:13:57,760 --> 00:14:01,120
malicious and therefore to be blocked

326
00:14:01,120 --> 00:14:03,839
it could generate many false positive

327
00:14:03,839 --> 00:14:07,519
and possibly even the service

328
00:14:07,519 --> 00:14:09,760
this is because if

329
00:14:09,760 --> 00:14:11,920
a domain is included

330
00:14:11,920 --> 00:14:13,600
in a list of diocese

331
00:14:13,600 --> 00:14:15,440
this will be loaded on the cm's

332
00:14:15,440 --> 00:14:18,240
automatically to generate alerts and

333
00:14:18,240 --> 00:14:20,320
blocked on the protection system such a

334
00:14:20,320 --> 00:14:23,920
navigation proxy firewall

335
00:14:23,920 --> 00:14:26,480
to differentiate if a domain must be

336
00:14:26,480 --> 00:14:28,959
blocked and loaded

337
00:14:28,959 --> 00:14:31,600
on the cm we use the flag present of the

338
00:14:31,600 --> 00:14:35,920
misp called uh two ids equal three

339
00:14:35,920 --> 00:14:38,079
so taking this consideration into

340
00:14:38,079 --> 00:14:39,279
account

341
00:14:39,279 --> 00:14:43,920
uh if a domain is detected with our list

342
00:14:43,920 --> 00:14:46,639
the single domain is set with the flag

343
00:14:46,639 --> 00:14:49,040
2ds equal false

344
00:14:49,040 --> 00:14:50,959
and therefore

345
00:14:50,959 --> 00:14:53,680
will not be load on the cm and on the

346
00:14:53,680 --> 00:14:56,079
protection system

347
00:14:56,079 --> 00:14:59,519
this system does limit false positive

348
00:14:59,519 --> 00:15:01,440
of course it's important to have a

349
00:15:01,440 --> 00:15:04,959
constantly update whitelist

350
00:15:04,959 --> 00:15:06,880
the magic continues thanks to the

351
00:15:06,880 --> 00:15:08,959
enrichment of the iocs

352
00:15:08,959 --> 00:15:10,639
some arrangements

353
00:15:10,639 --> 00:15:13,680
we do involve using the voice service

354
00:15:13,680 --> 00:15:16,800
dns information ssl certificates and

355
00:15:16,800 --> 00:15:20,160
more after that the scripts proceed with

356
00:15:20,160 --> 00:15:21,839
an automatic tagging

357
00:15:21,839 --> 00:15:24,399
tagging an event is a very important

358
00:15:24,399 --> 00:15:27,760
phrase because it allows use

359
00:15:27,760 --> 00:15:30,880
to run queries in the immediately future

360
00:15:30,880 --> 00:15:33,600
aggregate additional information

361
00:15:33,600 --> 00:15:35,519
about the campaign and

362
00:15:35,519 --> 00:15:38,880
filter others

363
00:15:38,880 --> 00:15:41,360
for those unfamiliar with misp the

364
00:15:41,360 --> 00:15:43,759
platform give the possibility to add

365
00:15:43,759 --> 00:15:46,800
information in the form of tags

366
00:15:46,800 --> 00:15:47,600
now

367
00:15:47,600 --> 00:15:49,279
imagine that

368
00:15:49,279 --> 00:15:51,440
the anti-malware teams have just

369
00:15:51,440 --> 00:15:56,000
uploaded on the sftp server a report

370
00:15:56,000 --> 00:15:59,600
relating to the ursnip malware campaign

371
00:15:59,600 --> 00:16:00,480
and

372
00:16:00,480 --> 00:16:02,800
and immediately following one attribute

373
00:16:02,800 --> 00:16:04,519
to the

374
00:16:04,519 --> 00:16:06,399
apt-28

375
00:16:06,399 --> 00:16:08,800
the script interprets

376
00:16:08,800 --> 00:16:11,440
the information contained

377
00:16:11,440 --> 00:16:15,199
into the report and applies the correct

378
00:16:15,199 --> 00:16:17,519
tags previously mapped

379
00:16:17,519 --> 00:16:20,079
to the misp events

380
00:16:20,079 --> 00:16:23,279
we add additional uh logic based on the

381
00:16:23,279 --> 00:16:25,279
tag called only detection

382
00:16:25,279 --> 00:16:28,480
um if one event uh as

383
00:16:28,480 --> 00:16:31,360
these type of tag

384
00:16:31,360 --> 00:16:34,399
the iocs contained in event are sent

385
00:16:34,399 --> 00:16:37,360
only for monitoring on the cm

386
00:16:37,360 --> 00:16:39,120
without blocking the iocs on the

387
00:16:39,120 --> 00:16:41,199
perimeter system

388
00:16:41,199 --> 00:16:44,000
this can be useful in the analysis

389
00:16:44,000 --> 00:16:44,880
phrase

390
00:16:44,880 --> 00:16:47,440
for those sizes that can be used in the

391
00:16:47,440 --> 00:16:50,399
correlation phrase on cm such as third

392
00:16:50,399 --> 00:16:52,720
nodes

393
00:16:53,199 --> 00:16:55,680
at the end of the steps

394
00:16:55,680 --> 00:16:58,959
the brain is concerned with preparing a

395
00:16:58,959 --> 00:17:01,680
report where it shares all the

396
00:17:01,680 --> 00:17:04,640
information uploaded and summarized

397
00:17:04,640 --> 00:17:06,959
all the ioc is uploaded

398
00:17:06,959 --> 00:17:09,119
by the various teams

399
00:17:09,119 --> 00:17:11,599
with their sample their enrichment and

400
00:17:11,599 --> 00:17:15,439
controls are automatically automatically

401
00:17:15,439 --> 00:17:19,520
uploaded to the miss

402
00:17:19,520 --> 00:17:21,359
let me show you how we have developed

403
00:17:21,359 --> 00:17:23,679
the engine capable of understanding how

404
00:17:23,679 --> 00:17:27,439
to manage iocs according to our rules

405
00:17:27,439 --> 00:17:28,880
i will show you

406
00:17:28,880 --> 00:17:30,880
how we have improved the prevention

407
00:17:30,880 --> 00:17:33,840
systems how we have distributed the

408
00:17:33,840 --> 00:17:36,400
iocs on the security system of the

409
00:17:36,400 --> 00:17:38,400
companies and the sharing with

410
00:17:38,400 --> 00:17:40,880
operational groups

411
00:17:40,880 --> 00:17:43,280
we have scheduled some ground up

412
00:17:43,280 --> 00:17:46,640
based api queries capable of extracting

413
00:17:46,640 --> 00:17:50,640
different ioc lists from the misp

414
00:17:50,640 --> 00:17:53,679
the first list provides that isd must

415
00:17:53,679 --> 00:17:58,640
black flex as to a 2ds equal true

416
00:17:58,640 --> 00:18:01,120
it's the first icon the

417
00:18:01,120 --> 00:18:04,160
only detection tag does not assist the

418
00:18:04,160 --> 00:18:06,640
attack that we have seen before

419
00:18:06,640 --> 00:18:09,919
and they have not decayed and

420
00:18:09,919 --> 00:18:13,200
have been checked in the white list

421
00:18:13,200 --> 00:18:15,360
in the right section of the slide you

422
00:18:15,360 --> 00:18:18,000
can see the real example of api

423
00:18:18,000 --> 00:18:19,600
invocation

424
00:18:19,600 --> 00:18:22,000
when the list is returned the big brain

425
00:18:22,000 --> 00:18:24,320
take care of processing the list and

426
00:18:24,320 --> 00:18:27,360
normalizing it according

427
00:18:27,360 --> 00:18:29,840
to the standards of the security system

428
00:18:29,840 --> 00:18:31,360
vendors

429
00:18:31,360 --> 00:18:33,600
you know for example that some vendors

430
00:18:33,600 --> 00:18:36,080
require a different specifications or to

431
00:18:36,080 --> 00:18:38,480
block some words

432
00:18:38,480 --> 00:18:43,039
for this we have developed a normalizer

433
00:18:43,039 --> 00:18:45,440
and under the right side

434
00:18:45,440 --> 00:18:47,679
you can see two different ways of

435
00:18:47,679 --> 00:18:50,000
uploading urls

436
00:18:50,000 --> 00:18:52,960
to different vendors

437
00:18:52,960 --> 00:18:55,840
after normalizing normalizing the data

438
00:18:55,840 --> 00:18:58,559
the ioc lists are sent and uploaded to

439
00:18:58,559 --> 00:19:02,640
the perimeter systems using the rest api

440
00:19:02,640 --> 00:19:04,160
we have developed the

441
00:19:04,160 --> 00:19:06,480
different connectors for the different

442
00:19:06,480 --> 00:19:08,720
vendors present in a corporate

443
00:19:08,720 --> 00:19:10,720
environment

444
00:19:10,720 --> 00:19:12,160
at the same time

445
00:19:12,160 --> 00:19:15,440
we have exposed the ioc lists on the web

446
00:19:15,440 --> 00:19:18,080
servers in such a way

447
00:19:18,080 --> 00:19:19,120
to make

448
00:19:19,120 --> 00:19:21,440
this list always accessible to the other

449
00:19:21,440 --> 00:19:25,039
internal et and security teams

450
00:19:25,039 --> 00:19:27,280
after telling you about the prevention

451
00:19:27,280 --> 00:19:29,840
part let's move on the detection

452
00:19:29,840 --> 00:19:31,760
thanks to the ioc list downloaded

453
00:19:31,760 --> 00:19:34,240
previously script can load this list on

454
00:19:34,240 --> 00:19:37,360
the cm in a way

455
00:19:37,760 --> 00:19:40,000
in the cm the data is enriched with

456
00:19:40,000 --> 00:19:42,240
context information deriving from the

457
00:19:42,240 --> 00:19:45,840
misp and the metadata is normalized

458
00:19:45,840 --> 00:19:48,160
also in this case we have scheduled an

459
00:19:48,160 --> 00:19:50,400
api queries short crown tab

460
00:19:50,400 --> 00:19:53,280
the query is constructed in such a way

461
00:19:53,280 --> 00:19:56,559
as to return all the iocs with flag to

462
00:19:56,559 --> 00:19:58,080
ids equal to

463
00:19:58,080 --> 00:20:01,120
the tag only detection false

464
00:20:01,120 --> 00:20:04,080
they are not decayed and the white list

465
00:20:04,080 --> 00:20:06,320
is verified

466
00:20:06,320 --> 00:20:11,120
the ioc are then sent to the cm

467
00:20:11,120 --> 00:20:13,280
now let's see what's happened when an ic

468
00:20:13,280 --> 00:20:15,600
loaded on the cm is detected while a

469
00:20:15,600 --> 00:20:18,240
client do a web browsing

470
00:20:18,240 --> 00:20:20,640
the client in question has just visited

471
00:20:20,640 --> 00:20:23,520
visit the domain circuit in red

472
00:20:23,520 --> 00:20:26,240
the navigation log is sent to the cm

473
00:20:26,240 --> 00:20:29,600
and after a few moments the cm create an

474
00:20:29,600 --> 00:20:33,120
incident on the centralized glc system

475
00:20:33,120 --> 00:20:35,440
where it shows the information take from

476
00:20:35,440 --> 00:20:37,440
the navigation log

477
00:20:37,440 --> 00:20:40,960
addiction context information is entered

478
00:20:40,960 --> 00:20:43,440
such as the name of campaign source of

479
00:20:43,440 --> 00:20:46,720
the region of the housing the type of

480
00:20:46,720 --> 00:20:48,960
the threats and the date of the first

481
00:20:48,960 --> 00:20:51,840
discovery of the threat

482
00:20:51,840 --> 00:20:54,080
the additional information is marked in

483
00:20:54,080 --> 00:20:56,480
yellow

484
00:20:56,480 --> 00:20:57,760
we have

485
00:20:57,760 --> 00:20:59,280
we then come

486
00:20:59,280 --> 00:21:01,520
to the retraction phrase

487
00:21:01,520 --> 00:21:02,400
this phrase

488
00:21:02,400 --> 00:21:04,400
is closely linked to the concept of the

489
00:21:04,400 --> 00:21:07,840
decay that we will see shortly

490
00:21:07,840 --> 00:21:10,720
we introduce the concept of sighting

491
00:21:10,720 --> 00:21:13,360
cycling is a collaborative system used

492
00:21:13,360 --> 00:21:15,200
within the mist

493
00:21:15,200 --> 00:21:17,840
the basic idea is to have a community

494
00:21:17,840 --> 00:21:19,440
connected between multiple missed

495
00:21:19,440 --> 00:21:20,720
distances

496
00:21:20,720 --> 00:21:22,960
and to have users

497
00:21:22,960 --> 00:21:25,840
vote through three button if an ic is

498
00:21:25,840 --> 00:21:28,640
readable if an iss is dope full of is a

499
00:21:28,640 --> 00:21:30,880
false positive

500
00:21:30,880 --> 00:21:33,600
so we broke this concept that the site

501
00:21:33,600 --> 00:21:35,840
link can be done by a user and we

502
00:21:35,840 --> 00:21:38,960
applied it to an automatic system

503
00:21:38,960 --> 00:21:41,280
uh in this case we

504
00:21:41,280 --> 00:21:45,760
went and an ioc is detected in a cm cm

505
00:21:45,760 --> 00:21:50,559
invokes the misp cycling fashion via api

506
00:21:50,559 --> 00:21:51,679
we use

507
00:21:51,679 --> 00:21:53,280
this command not to improve the

508
00:21:53,280 --> 00:21:55,760
rehabilitative concept of the ics

509
00:21:55,760 --> 00:21:59,840
but to update the decay time

510
00:22:00,159 --> 00:22:03,200
let's try to explain the detection flow

511
00:22:03,200 --> 00:22:05,600
against from cm symbol

512
00:22:05,600 --> 00:22:08,640
so remember the only condition for which

513
00:22:08,640 --> 00:22:11,039
an incident can be created are

514
00:22:11,039 --> 00:22:14,400
summarized in the yellow box flag to yes

515
00:22:14,400 --> 00:22:18,480
must be true only detection tag must

516
00:22:18,480 --> 00:22:21,120
must not exist and

517
00:22:21,120 --> 00:22:24,840
the iuc must not be delay decayed

518
00:22:24,840 --> 00:22:26,880
and uh warning

519
00:22:26,880 --> 00:22:28,799
wait list

520
00:22:28,799 --> 00:22:31,280
will check

521
00:22:31,840 --> 00:22:33,280
the alert

522
00:22:33,280 --> 00:22:36,240
will uh will then be managed by the

523
00:22:36,240 --> 00:22:38,880
incident respawn team in soc and when

524
00:22:38,880 --> 00:22:42,400
the alert is triggered the cm report ioc

525
00:22:42,400 --> 00:22:45,600
sighting to the misp

526
00:22:46,000 --> 00:22:48,080
from the technical point of view what's

527
00:22:48,080 --> 00:22:48,960
happened

528
00:22:48,960 --> 00:22:52,480
the alert generates an incident within

529
00:22:52,480 --> 00:22:55,360
the glc which will provide for

530
00:22:55,360 --> 00:22:57,600
management according to the relevant

531
00:22:57,600 --> 00:23:00,480
procedures in order to verify impact and

532
00:23:00,480 --> 00:23:03,520
procedure remediation

533
00:23:03,520 --> 00:23:06,480
this cm

534
00:23:07,440 --> 00:23:08,480
has

535
00:23:08,480 --> 00:23:11,120
has been configured to invoke the missed

536
00:23:11,120 --> 00:23:13,520
api in order to report the sighting of

537
00:23:13,520 --> 00:23:15,360
the ioc

538
00:23:15,360 --> 00:23:17,679
near the api icon you can see the

539
00:23:17,679 --> 00:23:21,280
original api used

540
00:23:21,440 --> 00:23:24,320
uh from the miss site we will then have

541
00:23:24,320 --> 00:23:26,080
an event that will contain the

542
00:23:26,080 --> 00:23:30,000
attributes including the malicious url

543
00:23:30,000 --> 00:23:32,960
you can see how under the eating cycling

544
00:23:32,960 --> 00:23:35,280
there is a graph showing the number of

545
00:23:35,280 --> 00:23:38,000
cyclings related to the events

546
00:23:38,000 --> 00:23:41,360
in general and then another graph near

547
00:23:41,360 --> 00:23:45,279
the single ic indicating five cyclings

548
00:23:45,279 --> 00:23:48,000
in addition

549
00:23:48,080 --> 00:23:49,120
sorry

550
00:23:49,120 --> 00:23:51,360
a representation of the temporal trend

551
00:23:51,360 --> 00:23:54,960
of sighting is also available again at

552
00:23:54,960 --> 00:23:57,520
event level

553
00:23:57,520 --> 00:24:00,159
let's face it we love having ioc like

554
00:24:00,159 --> 00:24:02,799
diamonds how many times

555
00:24:02,799 --> 00:24:03,600
you

556
00:24:03,600 --> 00:24:06,240
do you hear that companies collect the

557
00:24:06,240 --> 00:24:09,360
millions of ioc tons of the url ashes

558
00:24:09,360 --> 00:24:12,320
eps without a context

559
00:24:12,320 --> 00:24:15,760
when we produce or insert ioc into our

560
00:24:15,760 --> 00:24:17,919
system we have to ask ourselves a few

561
00:24:17,919 --> 00:24:19,279
questions

562
00:24:19,279 --> 00:24:20,880
when an ioc

563
00:24:20,880 --> 00:24:24,159
is to be considered expired how can we

564
00:24:24,159 --> 00:24:26,960
avoid overloading our defense or

565
00:24:26,960 --> 00:24:30,720
detection systems why collect 100

566
00:24:30,720 --> 00:24:33,679
billions iocs without being aware of

567
00:24:33,679 --> 00:24:35,039
what they are

568
00:24:35,039 --> 00:24:38,559
and what they indicate

569
00:24:39,039 --> 00:24:41,760
let's take a practical example

570
00:24:41,760 --> 00:24:43,279
let's imagine that

571
00:24:43,279 --> 00:24:45,520
the url

572
00:24:45,520 --> 00:24:48,799
has been entered in our misp today

573
00:24:48,799 --> 00:24:51,440
with the standard decay algorithm in 13

574
00:24:51,440 --> 00:24:55,039
days the url will be considered expired

575
00:24:55,039 --> 00:24:56,640
this is a simple case

576
00:24:56,640 --> 00:24:58,880
the second case at the harder hands is

577
00:24:58,880 --> 00:25:02,320
this the url we had previously uploaded

578
00:25:02,320 --> 00:25:06,240
is detected after 10 days in the scene

579
00:25:06,240 --> 00:25:07,840
the automatism

580
00:25:07,840 --> 00:25:10,880
starts the sighting process this change

581
00:25:10,880 --> 00:25:12,640
the decay score

582
00:25:12,640 --> 00:25:14,799
looking at the timeline

583
00:25:14,799 --> 00:25:18,480
at time t 0 is when we load the url into

584
00:25:18,480 --> 00:25:22,559
the cm into the misp sorry

585
00:25:22,559 --> 00:25:23,679
at time

586
00:25:23,679 --> 00:25:25,679
t 0 plus x

587
00:25:25,679 --> 00:25:30,240
is the time it took before being cited

588
00:25:30,240 --> 00:25:33,200
t1 is all the decay time

589
00:25:33,200 --> 00:25:37,679
at t1 plus 6 is the updated decay time

590
00:25:37,679 --> 00:25:41,200
in conclusion the expired time for our

591
00:25:41,200 --> 00:25:44,799
url will be not more than 13 days but 13

592
00:25:44,799 --> 00:25:48,480
days plus 10 days

593
00:25:49,039 --> 00:25:51,919
therefore on the 40th day

594
00:25:51,919 --> 00:25:54,559
the decay of the ics is propagated on

595
00:25:54,559 --> 00:25:56,880
all previously connected system

596
00:25:56,880 --> 00:25:58,880
providing an always updated list of

597
00:25:58,880 --> 00:26:01,039
diocese

598
00:26:01,039 --> 00:26:04,240
thanked thanks to the integrations we

599
00:26:04,240 --> 00:26:06,480
update the block list on the prevention

600
00:26:06,480 --> 00:26:07,679
device

601
00:26:07,679 --> 00:26:10,400
both on the detection component and

602
00:26:10,400 --> 00:26:13,039
therefore on the sim side

603
00:26:13,039 --> 00:26:16,320
uh furthermore automatics mates

604
00:26:16,320 --> 00:26:18,799
have been defined to internal teams that

605
00:26:18,799 --> 00:26:20,799
have access to the previously introduced

606
00:26:20,799 --> 00:26:23,039
web service

607
00:26:23,039 --> 00:26:25,919
to allow all these it was necessary to

608
00:26:25,919 --> 00:26:28,880
carry out various phrases of study and

609
00:26:28,880 --> 00:26:31,039
the research

610
00:26:31,039 --> 00:26:32,240
above all

611
00:26:32,240 --> 00:26:35,520
collaboration between people

612
00:26:35,520 --> 00:26:37,200
capable of creating

613
00:26:37,200 --> 00:26:40,080
this bridge between management processes

614
00:26:40,080 --> 00:26:44,080
of completely different systems

615
00:26:44,080 --> 00:26:46,480
speaking on the future scenarios

616
00:26:46,480 --> 00:26:47,840
the main idea

617
00:26:47,840 --> 00:26:50,000
is always to go to the mars

618
00:26:50,000 --> 00:26:52,400
improve the process improve yourself

619
00:26:52,400 --> 00:26:54,960
save the world and more

620
00:26:54,960 --> 00:26:57,440
uh practically speaking the next step in

621
00:26:57,440 --> 00:26:59,679
the pipeline are to create dashboards

622
00:26:59,679 --> 00:27:02,000
and an advanced reporting system to top

623
00:27:02,000 --> 00:27:04,400
management a very interesting

624
00:27:04,400 --> 00:27:06,559
integration is to develop an

625
00:27:06,559 --> 00:27:08,559
authorization system based on the tlp

626
00:27:08,559 --> 00:27:09,760
standard

627
00:27:09,760 --> 00:27:11,120
next step is to improve the

628
00:27:11,120 --> 00:27:14,559
prioritization of incidents

629
00:27:14,559 --> 00:27:18,240
currently all incidents created in grc

630
00:27:18,240 --> 00:27:20,399
have the same priority level in near

631
00:27:20,399 --> 00:27:22,000
future no more

632
00:27:22,000 --> 00:27:23,039
and

633
00:27:23,039 --> 00:27:25,039
due to the fragmentation of the

634
00:27:25,039 --> 00:27:27,679
societies uh we are still slow to

635
00:27:27,679 --> 00:27:29,919
disseminate information as soon as

636
00:27:29,919 --> 00:27:31,039
possible

637
00:27:31,039 --> 00:27:32,960
and lastly

638
00:27:32,960 --> 00:27:35,039
we are working on integration system

639
00:27:35,039 --> 00:27:38,320
with the various cloud provider

640
00:27:38,320 --> 00:27:41,520
uh that's all folk um it's uh

641
00:27:41,520 --> 00:27:44,640
it was a real pleasure for me to share

642
00:27:44,640 --> 00:27:47,600
my experience i hope it can help you and

643
00:27:47,600 --> 00:27:49,120
can motivate you to be creative and

644
00:27:49,120 --> 00:27:51,200
collaborative um

645
00:27:51,200 --> 00:27:53,600
these are my personal contacts and those

646
00:27:53,600 --> 00:27:56,080
of the non-profit association

647
00:27:56,080 --> 00:27:57,520
the photo instead are the place where i

648
00:27:57,520 --> 00:28:00,399
live call it apulia if you pass by here

649
00:28:00,399 --> 00:28:03,039
feel free to contact me to

650
00:28:03,039 --> 00:28:05,200
let us you explore this magic client

651
00:28:05,200 --> 00:28:06,159
together

652
00:28:06,159 --> 00:28:09,039
thank you

