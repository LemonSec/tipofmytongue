1
00:00:06,720 --> 00:00:08,320
hello and welcome to active defense

2
00:00:08,320 --> 00:00:10,400
scenarios a quarterly exercise that

3
00:00:10,400 --> 00:00:12,639
promotes security posture

4
00:00:12,639 --> 00:00:14,480
today i'll be your presenter my name is

5
00:00:14,480 --> 00:00:17,359
robert moody let's dive right in

6
00:00:17,359 --> 00:00:18,800
agenda so what are we going to be

7
00:00:18,800 --> 00:00:21,199
talking about today so i have you for

8
00:00:21,199 --> 00:00:23,600
approximately the next hour

9
00:00:23,600 --> 00:00:25,519
i will provide you disclaimer about the

10
00:00:25,519 --> 00:00:27,439
content in this presentation i'll give

11
00:00:27,439 --> 00:00:29,039
you an introduction to who i am as your

12
00:00:29,039 --> 00:00:31,679
speaker walk you through the threats all

13
00:00:31,679 --> 00:00:33,840
around us talk about what is active

14
00:00:33,840 --> 00:00:36,640
defense the phases of active defense and

15
00:00:36,640 --> 00:00:38,399
diving into those phases we'll talk a

16
00:00:38,399 --> 00:00:40,079
little bit about mission selection and

17
00:00:40,079 --> 00:00:41,040
planning

18
00:00:41,040 --> 00:00:42,719
threat hunting and establishing a

19
00:00:42,719 --> 00:00:45,039
baseline security control validation

20
00:00:45,039 --> 00:00:47,440
testing security control hardening

21
00:00:47,440 --> 00:00:50,239
validation retesting and lastly

22
00:00:50,239 --> 00:00:52,079
reporting and lessons learned then i'll

23
00:00:52,079 --> 00:00:54,480
open it up over to you all to ask any

24
00:00:54,480 --> 00:00:56,000
questions you have and

25
00:00:56,000 --> 00:00:57,360
to the best of my ability i'll give you

26
00:00:57,360 --> 00:00:59,359
some answers

27
00:00:59,359 --> 00:01:00,960
so disclaimer

28
00:01:00,960 --> 00:01:02,160
all content contained in this

29
00:01:02,160 --> 00:01:03,600
presentation are solely the views of the

30
00:01:03,600 --> 00:01:04,799
presenters

31
00:01:04,799 --> 00:01:06,880
and do not represent the opinions belief

32
00:01:06,880 --> 00:01:08,720
experiences policy or operating

33
00:01:08,720 --> 00:01:10,240
agreements of any of the organizations

34
00:01:10,240 --> 00:01:12,159
the speaker currently works for or has

35
00:01:12,159 --> 00:01:14,320
worked for in the past

36
00:01:14,320 --> 00:01:15,520
now that we've knocked that one out of

37
00:01:15,520 --> 00:01:17,759
the way

38
00:01:17,759 --> 00:01:20,240
my name is robert moody i've worked in

39
00:01:20,240 --> 00:01:22,000
intelligence and incident response

40
00:01:22,000 --> 00:01:23,759
digital forensics cyber security in

41
00:01:23,759 --> 00:01:27,759
general for almost a decade now i lead

42
00:01:27,759 --> 00:01:29,680
the cyber threat intelligence team at

43
00:01:29,680 --> 00:01:31,119
the home depot

44
00:01:31,119 --> 00:01:32,960
we're charged with defending the threat

45
00:01:32,960 --> 00:01:35,040
landscape identifying threats for all of

46
00:01:35,040 --> 00:01:37,920
north america and our subsidiaries

47
00:01:37,920 --> 00:01:40,560
i have the cism certification

48
00:01:40,560 --> 00:01:44,479
cisa certification cdpse certification

49
00:01:44,479 --> 00:01:47,840
crtia certification a master's degree

50
00:01:47,840 --> 00:01:50,799
and an emba

51
00:01:50,799 --> 00:01:52,880
my background really was in defending

52
00:01:52,880 --> 00:01:54,479
critical infrastructure including

53
00:01:54,479 --> 00:01:56,640
manufacturing banking finance

54
00:01:56,640 --> 00:02:00,880
telecommunication retail and energy

55
00:02:00,880 --> 00:02:03,360
so threats all around us

56
00:02:03,360 --> 00:02:05,840
uh i know personally i feel whenever i

57
00:02:05,840 --> 00:02:07,680
turn on the news hop on a bleeping

58
00:02:07,680 --> 00:02:10,000
computer or even just watch mainstream

59
00:02:10,000 --> 00:02:13,120
things like msnbc or cnn you start to

60
00:02:13,120 --> 00:02:16,000
see more and more on cyber attacks

61
00:02:16,000 --> 00:02:17,360
breaking news

62
00:02:17,360 --> 00:02:19,200
this cute cartoon really says it

63
00:02:19,200 --> 00:02:20,640
perfectly it's

64
00:02:20,640 --> 00:02:22,560
cyber attacks are everywhere

65
00:02:22,560 --> 00:02:25,200
we whether it's happening

66
00:02:25,200 --> 00:02:27,120
the us government blaming china and its

67
00:02:27,120 --> 00:02:29,200
allies for

68
00:02:29,200 --> 00:02:31,360
targeting exchange servers and that hack

69
00:02:31,360 --> 00:02:33,920
going after the vulnerabilities and

70
00:02:33,920 --> 00:02:34,879
really

71
00:02:34,879 --> 00:02:36,319
being one of the worst cyber attacks

72
00:02:36,319 --> 00:02:38,800
we've had on u.s soil in a long time

73
00:02:38,800 --> 00:02:40,800
whether it's accenture being hit by lock

74
00:02:40,800 --> 00:02:42,560
the lock bit gang using their new lock

75
00:02:42,560 --> 00:02:44,800
bit 2.0 ransomware

76
00:02:44,800 --> 00:02:46,879
ransom exxx

77
00:02:46,879 --> 00:02:49,280
and apt targeting hotels

78
00:02:49,280 --> 00:02:51,599
or hackers breaching the colonial

79
00:02:51,599 --> 00:02:53,920
pipeline i know the gas price on my

80
00:02:53,920 --> 00:02:56,239
truck went up significantly because of

81
00:02:56,239 --> 00:02:57,120
that

82
00:02:57,120 --> 00:02:57,920
and

83
00:02:57,920 --> 00:02:59,680
this is just part of the story of what's

84
00:02:59,680 --> 00:03:00,879
going on

85
00:03:00,879 --> 00:03:02,959
there's so

86
00:03:02,959 --> 00:03:05,760
cyber attacks are big money big business

87
00:03:05,760 --> 00:03:07,519
organizations worldwide are having

88
00:03:07,519 --> 00:03:09,920
issues to try to defend it

89
00:03:09,920 --> 00:03:12,080
these actor groups or advance persistent

90
00:03:12,080 --> 00:03:13,920
threats cyber adversaries however you

91
00:03:13,920 --> 00:03:15,440
want to call them

92
00:03:15,440 --> 00:03:17,599
they are getting more advanced they're

93
00:03:17,599 --> 00:03:19,840
learning new tactics and techniques and

94
00:03:19,840 --> 00:03:22,480
it's hard for the the defense sector to

95
00:03:22,480 --> 00:03:24,000
keep up with them

96
00:03:24,000 --> 00:03:26,080
and change and adapt to their novel

97
00:03:26,080 --> 00:03:29,120
techniques and procedures

98
00:03:29,120 --> 00:03:32,560
bear spiders and kittens oh my

99
00:03:32,560 --> 00:03:34,319
there's vendors out there putting fancy

100
00:03:34,319 --> 00:03:36,319
names on the different actors and

101
00:03:36,319 --> 00:03:38,239
adversary groups these tie out to

102
00:03:38,239 --> 00:03:39,599
different things if you're using

103
00:03:39,599 --> 00:03:42,159
crowdstrike lingo bears would be

104
00:03:42,159 --> 00:03:45,120
uh russian or eastern european linked

105
00:03:45,120 --> 00:03:47,680
adversaries spiders would be your

106
00:03:47,680 --> 00:03:49,519
organized crime or financially motivated

107
00:03:49,519 --> 00:03:51,519
groups and kittens would be your groups

108
00:03:51,519 --> 00:03:53,120
coming out of iran

109
00:03:53,120 --> 00:03:56,000
it really is become such a big business

110
00:03:56,000 --> 00:03:57,680
around naming these actors and

111
00:03:57,680 --> 00:03:58,959
adversaries

112
00:03:58,959 --> 00:04:00,799
doesn't help the

113
00:04:00,799 --> 00:04:02,400
doesn't help the end consumer it doesn't

114
00:04:02,400 --> 00:04:04,159
help the cyber defense it doesn't help

115
00:04:04,159 --> 00:04:06,000
those of us who work in a soft and try

116
00:04:06,000 --> 00:04:07,040
to

117
00:04:07,040 --> 00:04:09,280
really improve our situation by

118
00:04:09,280 --> 00:04:10,959
understanding these groups and actors

119
00:04:10,959 --> 00:04:12,840
and how they behave and what to

120
00:04:12,840 --> 00:04:15,760
do that's where active defense comes in

121
00:04:15,760 --> 00:04:18,238
but what is active defense

122
00:04:18,238 --> 00:04:19,199
so

123
00:04:19,199 --> 00:04:21,519
i love this graphic this was really fun

124
00:04:21,519 --> 00:04:23,360
to put together

125
00:04:23,360 --> 00:04:25,600
think of the pyramid of pain here it's a

126
00:04:25,600 --> 00:04:27,360
commonly used

127
00:04:27,360 --> 00:04:29,840
architecture model for describing

128
00:04:29,840 --> 00:04:31,440
both from a

129
00:04:31,440 --> 00:04:32,960
soft perspective and an intel

130
00:04:32,960 --> 00:04:35,440
perspective and how to deal with either

131
00:04:35,440 --> 00:04:37,440
hunting for

132
00:04:37,440 --> 00:04:39,440
iocs created by actors or adversary

133
00:04:39,440 --> 00:04:41,520
groups or stopping actors or adversary

134
00:04:41,520 --> 00:04:43,280
groups and

135
00:04:43,280 --> 00:04:45,120
i will get into that in a second but

136
00:04:45,120 --> 00:04:47,199
what is an active defense mission an

137
00:04:47,199 --> 00:04:48,479
active defense mission is an

138
00:04:48,479 --> 00:04:51,040
intelligence-led cross-team exercise i'm

139
00:04:51,040 --> 00:04:52,960
going to highlight that again cross-team

140
00:04:52,960 --> 00:04:54,880
exercise that evaluates an

141
00:04:54,880 --> 00:04:56,560
organization's readiness for a cyber

142
00:04:56,560 --> 00:04:59,440
attack by a specific adversary

143
00:04:59,440 --> 00:05:02,000
specific adversary in the in the mission

144
00:05:02,000 --> 00:05:04,080
cyber security teams leverage the

145
00:05:04,080 --> 00:05:06,160
intelligence gained on an adversary to

146
00:05:06,160 --> 00:05:08,400
harden security controls and enrich

147
00:05:08,400 --> 00:05:11,280
detective capabilities this is done to

148
00:05:11,280 --> 00:05:13,759
cause the most pain to the adversary

149
00:05:13,759 --> 00:05:16,639
i.e the bear trap there if they were to

150
00:05:16,639 --> 00:05:18,479
attack an organization

151
00:05:18,479 --> 00:05:20,800
so what does this mission test

152
00:05:20,800 --> 00:05:22,160
this is really interesting an

153
00:05:22,160 --> 00:05:24,560
organization's ability to identify and

154
00:05:24,560 --> 00:05:27,520
disrupt their ttps and their tools

155
00:05:27,520 --> 00:05:29,120
that's why we're going up to the top of

156
00:05:29,120 --> 00:05:30,880
the pyramid opinion

157
00:05:30,880 --> 00:05:32,639
so we're looking at it from a from a

158
00:05:32,639 --> 00:05:35,199
defense perspective if we can stop an

159
00:05:35,199 --> 00:05:37,520
actor from using their ttps and tools

160
00:05:37,520 --> 00:05:38,960
that will cause them the most pain

161
00:05:38,960 --> 00:05:40,560
because those are the most difficult to

162
00:05:40,560 --> 00:05:42,240
change or alter in the way that they

163
00:05:42,240 --> 00:05:43,280
operate

164
00:05:43,280 --> 00:05:44,720
we're going to test the efficacy of our

165
00:05:44,720 --> 00:05:46,240
security tools

166
00:05:46,240 --> 00:05:47,520
we're going to make improvements or

167
00:05:47,520 --> 00:05:49,919
updates to the security detection

168
00:05:49,919 --> 00:05:52,000
response logic of those tools we're

169
00:05:52,000 --> 00:05:53,759
going to be better at detecting the

170
00:05:53,759 --> 00:05:56,639
tools and tactics of these actor groups

171
00:05:56,639 --> 00:05:58,240
we're going to measure the pre and post

172
00:05:58,240 --> 00:05:59,759
state of the organization for one

173
00:05:59,759 --> 00:06:01,600
specific threat

174
00:06:01,600 --> 00:06:03,600
this is an excellent way

175
00:06:03,600 --> 00:06:05,199
for you to be able to provide to your

176
00:06:05,199 --> 00:06:08,000
leadership team hey i need this or that

177
00:06:08,000 --> 00:06:10,560
and here's a defined reason why with

178
00:06:10,560 --> 00:06:11,919
metrics

179
00:06:11,919 --> 00:06:14,160
and then the willingness and ability of

180
00:06:14,160 --> 00:06:15,759
the organization's security teams to

181
00:06:15,759 --> 00:06:17,520
cooperate and innovate

182
00:06:17,520 --> 00:06:19,120
it's not very often unless you're

183
00:06:19,120 --> 00:06:20,960
working a real incident where everyone's

184
00:06:20,960 --> 00:06:23,360
hair is on fire it feels like the walls

185
00:06:23,360 --> 00:06:25,360
are burning down that a security team

186
00:06:25,360 --> 00:06:27,600
will come together work together and

187
00:06:27,600 --> 00:06:28,400
really

188
00:06:28,400 --> 00:06:30,720
try to improve and fix something and

189
00:06:30,720 --> 00:06:32,560
this is going to be fixed again in a

190
00:06:32,560 --> 00:06:34,479
quarterly time frame we're going to be

191
00:06:34,479 --> 00:06:36,319
able to do something and show real

192
00:06:36,319 --> 00:06:37,840
response and real

193
00:06:37,840 --> 00:06:40,080
uh benefit and to the organization

194
00:06:40,080 --> 00:06:42,880
within a quarter

195
00:06:42,960 --> 00:06:44,400
so let's talk a little about the phases

196
00:06:44,400 --> 00:06:46,720
of active defense um i'll throw some

197
00:06:46,720 --> 00:06:49,039
timelines out here

198
00:06:49,039 --> 00:06:50,639
the

199
00:06:50,639 --> 00:06:52,720
spartan looking guy in the middle of

200
00:06:52,720 --> 00:06:54,080
this uh

201
00:06:54,080 --> 00:06:56,000
this mission cycle

202
00:06:56,000 --> 00:06:58,560
so really the mission begins with the

203
00:06:58,560 --> 00:07:00,240
selection and planning

204
00:07:00,240 --> 00:07:02,000
then you threat hunt and establish a

205
00:07:02,000 --> 00:07:04,400
baseline you do your security control

206
00:07:04,400 --> 00:07:06,160
validation and testing

207
00:07:06,160 --> 00:07:08,479
you do your security control hardening

208
00:07:08,479 --> 00:07:10,639
and then you re-test so you want to know

209
00:07:10,639 --> 00:07:12,880
how well did your hardening work

210
00:07:12,880 --> 00:07:14,560
and then you have to report you have to

211
00:07:14,560 --> 00:07:16,160
make your lessons learn

212
00:07:16,160 --> 00:07:18,000
so for the mission selection and

213
00:07:18,000 --> 00:07:20,319
planning phase we really look at it from

214
00:07:20,319 --> 00:07:23,520
a three to four week period again uh you

215
00:07:23,520 --> 00:07:25,599
have a more mature intel team or if

216
00:07:25,599 --> 00:07:26,800
you're working

217
00:07:26,800 --> 00:07:27,759
in

218
00:07:27,759 --> 00:07:29,680
i guess a cross-functional way like a

219
00:07:29,680 --> 00:07:31,680
fusion cell you may be able to reduce

220
00:07:31,680 --> 00:07:33,440
this time to maybe a week or two you may

221
00:07:33,440 --> 00:07:35,440
have some missions on hand

222
00:07:35,440 --> 00:07:36,560
some more the

223
00:07:36,560 --> 00:07:39,919
more mature teams that i've worked with

224
00:07:39,919 --> 00:07:41,599
there's a good repository of missions

225
00:07:41,599 --> 00:07:42,960
that you would want to test and as you

226
00:07:42,960 --> 00:07:44,479
start doing this and start building this

227
00:07:44,479 --> 00:07:46,400
capability that gets a lot quicker

228
00:07:46,400 --> 00:07:48,000
because you know how to do it you have

229
00:07:48,000 --> 00:07:49,759
templates

230
00:07:49,759 --> 00:07:51,039
it flies

231
00:07:51,039 --> 00:07:52,720
so then you go into threat hunting and

232
00:07:52,720 --> 00:07:54,800
establishing a baseline this is where

233
00:07:54,800 --> 00:07:56,479
you look for indicators of compromise

234
00:07:56,479 --> 00:07:58,080
across your environment that takes about

235
00:07:58,080 --> 00:07:59,840
one to two weeks again depending on the

236
00:07:59,840 --> 00:08:02,240
maturity and availability of

237
00:08:02,240 --> 00:08:04,479
your blue team or endpoint detection

238
00:08:04,479 --> 00:08:06,479
response team

239
00:08:06,479 --> 00:08:07,759
then you look at it from security

240
00:08:07,759 --> 00:08:09,840
control validation testing

241
00:08:09,840 --> 00:08:12,240
you're at the whim of your purple or red

242
00:08:12,240 --> 00:08:14,080
team at this point so again more mature

243
00:08:14,080 --> 00:08:16,800
team more personnel dedicated resources

244
00:08:16,800 --> 00:08:18,160
to this

245
00:08:18,160 --> 00:08:19,759
two to three weeks

246
00:08:19,759 --> 00:08:22,800
and then the caveat here is the

247
00:08:22,800 --> 00:08:24,879
scope of the assessment more tools that

248
00:08:24,879 --> 00:08:27,360
you want to test and see how well their

249
00:08:27,360 --> 00:08:29,360
security controls work the longer it's

250
00:08:29,360 --> 00:08:30,879
going to take it's just going to be more

251
00:08:30,879 --> 00:08:32,559
infrastructure that the purple or red

252
00:08:32,559 --> 00:08:34,799
team has to build out and they have to

253
00:08:34,799 --> 00:08:37,360
learn more nuances to the way in which

254
00:08:37,360 --> 00:08:40,799
they can respond to and build out

255
00:08:40,799 --> 00:08:42,719
their attack plan or methodology based

256
00:08:42,719 --> 00:08:45,040
off of the intel you give them

257
00:08:45,040 --> 00:08:46,240
and then you had security control

258
00:08:46,240 --> 00:08:48,080
hardening three to four weeks there's

259
00:08:48,080 --> 00:08:51,040
also a qa process built into that so

260
00:08:51,040 --> 00:08:53,200
hopefully one to two weeks of actually

261
00:08:53,200 --> 00:08:54,959
building the new controls

262
00:08:54,959 --> 00:08:56,959
uh there's some really interesting and

263
00:08:56,959 --> 00:08:59,200
novel ways of building that into your

264
00:08:59,200 --> 00:09:01,279
validation testing again depending on

265
00:09:01,279 --> 00:09:03,600
how skilled your purple and red team are

266
00:09:03,600 --> 00:09:04,880
if they have the

267
00:09:04,880 --> 00:09:07,200
defensiveness i guess wherewithal or

268
00:09:07,200 --> 00:09:09,360
know-how then they can also build some

269
00:09:09,360 --> 00:09:11,279
of your controls in there and

270
00:09:11,279 --> 00:09:12,880
add that to the security control

271
00:09:12,880 --> 00:09:15,200
hardening piece and then it's just qa

272
00:09:15,200 --> 00:09:17,279
and testing for your

273
00:09:17,279 --> 00:09:19,120
technology owners but if the technology

274
00:09:19,120 --> 00:09:20,640
owners are the ones building it it may

275
00:09:20,640 --> 00:09:22,720
take a little bit longer

276
00:09:22,720 --> 00:09:23,680
and then

277
00:09:23,680 --> 00:09:25,680
validation testing again so this is your

278
00:09:25,680 --> 00:09:29,360
retest this is where you test the same

279
00:09:29,360 --> 00:09:32,640
same mission exactly same commands input

280
00:09:32,640 --> 00:09:35,120
same active base emulation on your

281
00:09:35,120 --> 00:09:37,600
controls after they were hardened

282
00:09:37,600 --> 00:09:38,720
that should be pretty quick all the

283
00:09:38,720 --> 00:09:40,959
infrastructure and tie-in

284
00:09:40,959 --> 00:09:42,399
should be built out everything should

285
00:09:42,399 --> 00:09:44,640
just be as simple as

286
00:09:44,640 --> 00:09:46,720
entering in the strokes of the keyboard

287
00:09:46,720 --> 00:09:49,519
or clicking an automatic automated

288
00:09:49,519 --> 00:09:50,720
attack

289
00:09:50,720 --> 00:09:52,320
then you got to do reporting in lessons

290
00:09:52,320 --> 00:09:53,760
learned this takes a little bit of time

291
00:09:53,760 --> 00:09:54,800
again

292
00:09:54,800 --> 00:09:56,800
the more mature your unit is if you have

293
00:09:56,800 --> 00:10:00,480
templates it it goes a lot faster

294
00:10:00,480 --> 00:10:02,880
so mission planning mission selection

295
00:10:02,880 --> 00:10:04,640
planning

296
00:10:04,640 --> 00:10:06,560
this is probably one of the most fun

297
00:10:06,560 --> 00:10:10,320
parts of this for me as an intel guy

298
00:10:10,320 --> 00:10:12,880
how do we choose the best topic

299
00:10:12,880 --> 00:10:14,880
you need to have leadership and the

300
00:10:14,880 --> 00:10:17,440
committee buy-in i recommend having more

301
00:10:17,440 --> 00:10:19,519
than one person deciding the missions

302
00:10:19,519 --> 00:10:21,839
you've taken stock from your experts

303
00:10:21,839 --> 00:10:23,760
within your security team because they

304
00:10:23,760 --> 00:10:25,440
may be following things that you're not

305
00:10:25,440 --> 00:10:27,040
as a leader

306
00:10:27,040 --> 00:10:30,480
again lead by committee with this one

307
00:10:30,480 --> 00:10:32,240
i also i recommend keeping the group

308
00:10:32,240 --> 00:10:33,839
small you don't want too many chefs in

309
00:10:33,839 --> 00:10:36,000
the kitchen you but you do want good

310
00:10:36,000 --> 00:10:37,920
people in there if you're working in

311
00:10:37,920 --> 00:10:39,440
that fusion cell

312
00:10:39,440 --> 00:10:40,399
style

313
00:10:40,399 --> 00:10:42,800
do invite the other parties involved so

314
00:10:42,800 --> 00:10:44,160
if you're working with your blue team

315
00:10:44,160 --> 00:10:46,160
your red team invite them into the room

316
00:10:46,160 --> 00:10:48,160
ask them what they think is important

317
00:10:48,160 --> 00:10:49,760
for the for the environment they may

318
00:10:49,760 --> 00:10:51,440
have insights that you don't have as an

319
00:10:51,440 --> 00:10:52,560
intel

320
00:10:52,560 --> 00:10:54,880
guy or gal

321
00:10:54,880 --> 00:10:57,200
all right so once you have that

322
00:10:57,200 --> 00:10:58,959
one of the best things that i've done

323
00:10:58,959 --> 00:11:02,240
working in this active defense

324
00:11:02,240 --> 00:11:04,399
style missions is to incorporate a

325
00:11:04,399 --> 00:11:06,720
revolving mission lead what does that

326
00:11:06,720 --> 00:11:09,120
mean exactly that means that

327
00:11:09,120 --> 00:11:11,920
a member of my team would switch as

328
00:11:11,920 --> 00:11:14,160
mission lead each quarter that gives an

329
00:11:14,160 --> 00:11:15,839
opportunity for growth that gives an

330
00:11:15,839 --> 00:11:18,000
opportunity for

331
00:11:18,000 --> 00:11:19,680
changes and new insights into the

332
00:11:19,680 --> 00:11:21,440
process that you wouldn't get by keeping

333
00:11:21,440 --> 00:11:24,480
the same leader and keeping it stagnant

334
00:11:24,480 --> 00:11:27,120
it's really good it really builds a

335
00:11:27,120 --> 00:11:30,640
level of dynamic nature to the missions

336
00:11:30,640 --> 00:11:33,120
okay so now we know how to do that but

337
00:11:33,120 --> 00:11:35,839
what makes a good mission topic

338
00:11:35,839 --> 00:11:38,320
so it needs to be specific you can do an

339
00:11:38,320 --> 00:11:40,640
adversary based active defense mission

340
00:11:40,640 --> 00:11:42,399
you can have a campaign-based active

341
00:11:42,399 --> 00:11:44,560
defense mission but it also needs to be

342
00:11:44,560 --> 00:11:46,160
relevant it needs to be tied to your

343
00:11:46,160 --> 00:11:48,480
threat landscape it needs to be relevant

344
00:11:48,480 --> 00:11:50,880
for your organization your suppliers

345
00:11:50,880 --> 00:11:53,279
your peers these are all good examples

346
00:11:53,279 --> 00:11:55,120
supply chain attacks are something on

347
00:11:55,120 --> 00:11:56,880
the rise so i would

348
00:11:56,880 --> 00:11:58,160
recommend looking into that if you

349
00:11:58,160 --> 00:12:00,240
wanted to roll this out but again if

350
00:12:00,240 --> 00:12:01,760
you're just starting out look at your

351
00:12:01,760 --> 00:12:03,279
organization

352
00:12:03,279 --> 00:12:04,720
talk to your blue team about the

353
00:12:04,720 --> 00:12:06,800
incidents they're responding to

354
00:12:06,800 --> 00:12:07,839
and

355
00:12:07,839 --> 00:12:09,839
who is attacking you and then build your

356
00:12:09,839 --> 00:12:12,399
missions off of that

357
00:12:12,399 --> 00:12:15,360
next is there enough relevant data

358
00:12:15,360 --> 00:12:16,800
can you build a threat model about

359
00:12:16,800 --> 00:12:18,800
what's out there is there enough is

360
00:12:18,800 --> 00:12:20,079
there enough to test against your

361
00:12:20,079 --> 00:12:22,480
security controls are you able to go out

362
00:12:22,480 --> 00:12:25,200
and do open source research or if you

363
00:12:25,200 --> 00:12:27,360
have the resources the closed sources

364
00:12:27,360 --> 00:12:30,079
that you have do you have enough

365
00:12:30,079 --> 00:12:32,160
do you have enough data to build out an

366
00:12:32,160 --> 00:12:35,360
understanding of how these actors work

367
00:12:35,360 --> 00:12:37,279
what techniques they're using is there a

368
00:12:37,279 --> 00:12:38,800
way that you can translate it in a

369
00:12:38,800 --> 00:12:41,440
common lexicon

370
00:12:41,440 --> 00:12:42,560
do you have

371
00:12:42,560 --> 00:12:44,880
analysis on their malware

372
00:12:44,880 --> 00:12:47,360
these are all things that you need to

373
00:12:47,360 --> 00:12:50,000
orient your actor emulation testing

374
00:12:50,000 --> 00:12:51,680
and then really validate your security

375
00:12:51,680 --> 00:12:54,399
controls against it

376
00:12:54,399 --> 00:12:55,519
again

377
00:12:55,519 --> 00:12:56,720
read the news

378
00:12:56,720 --> 00:12:58,320
the reason i throw this slide back up

379
00:12:58,320 --> 00:13:00,639
here is that these are all examples of

380
00:13:00,639 --> 00:13:03,279
things your c levels are talking about

381
00:13:03,279 --> 00:13:05,600
this is another possible good source for

382
00:13:05,600 --> 00:13:07,279
identifying a mission they're all very

383
00:13:07,279 --> 00:13:09,760
specific they have actors tied to them

384
00:13:09,760 --> 00:13:12,160
the news loves putting a name to

385
00:13:12,160 --> 00:13:14,320
the bad to the quote unquote bad guy

386
00:13:14,320 --> 00:13:15,519
here so

387
00:13:15,519 --> 00:13:17,360
these are all opportunities to test

388
00:13:17,360 --> 00:13:20,560
these types of attacks and it keeps your

389
00:13:20,560 --> 00:13:23,360
cxos or your senior leadership happy

390
00:13:23,360 --> 00:13:25,920
because you're looking at the cutting

391
00:13:25,920 --> 00:13:28,160
edge of attacks and what's going on in

392
00:13:28,160 --> 00:13:30,880
the threat landscape

393
00:13:30,880 --> 00:13:32,800
i recommend threat modeling

394
00:13:32,800 --> 00:13:35,839
and this is a very complex slide so what

395
00:13:35,839 --> 00:13:38,320
i would recommend getting out of this

396
00:13:38,320 --> 00:13:40,560
you need to understand your business

397
00:13:40,560 --> 00:13:42,720
context your system context your threat

398
00:13:42,720 --> 00:13:44,720
context and your risk context of your

399
00:13:44,720 --> 00:13:47,120
organization you need to know yourself

400
00:13:47,120 --> 00:13:48,880
and then by knowing yourself you know

401
00:13:48,880 --> 00:13:51,360
who could potentially attack you what

402
00:13:51,360 --> 00:13:53,199
what their means are again talk with the

403
00:13:53,199 --> 00:13:54,880
other security teams to understand if

404
00:13:54,880 --> 00:13:57,120
there is one group or another focusing

405
00:13:57,120 --> 00:13:58,480
on

406
00:13:58,480 --> 00:13:59,760
then you build the profile you

407
00:13:59,760 --> 00:14:01,519
understand how they attack

408
00:14:01,519 --> 00:14:03,440
but the key to threat modeling is

409
00:14:03,440 --> 00:14:07,360
building a complex multi-staged scenario

410
00:14:07,360 --> 00:14:09,920
and you target your threat

411
00:14:09,920 --> 00:14:12,000
you target or threaten your critical

412
00:14:12,000 --> 00:14:14,240
assets your crown jewels that's what the

413
00:14:14,240 --> 00:14:15,839
mission should be looking at that that's

414
00:14:15,839 --> 00:14:17,680
who you should model your attacks your

415
00:14:17,680 --> 00:14:20,480
active defense around those groups and

416
00:14:20,480 --> 00:14:21,360
then

417
00:14:21,360 --> 00:14:22,880
with that information and that

418
00:14:22,880 --> 00:14:24,720
understanding those threat centric use

419
00:14:24,720 --> 00:14:26,800
cases you can start to build better

420
00:14:26,800 --> 00:14:28,480
detection and use that to feed your

421
00:14:28,480 --> 00:14:30,160
intelligence life cycle and collect more

422
00:14:30,160 --> 00:14:32,720
data on actor groups or adversaries that

423
00:14:32,720 --> 00:14:34,959
you do have gaps for

424
00:14:34,959 --> 00:14:38,639
but in short build a multi-stage complex

425
00:14:38,639 --> 00:14:41,680
attack chain that you want to test

426
00:14:41,680 --> 00:14:43,279
i recommend using the miter attack

427
00:14:43,279 --> 00:14:45,519
framework the lino miter attack threat

428
00:14:45,519 --> 00:14:47,440
model there's really good resources out

429
00:14:47,440 --> 00:14:48,720
there

430
00:14:48,720 --> 00:14:50,800
siberian and miter attack have built

431
00:14:50,800 --> 00:14:52,240
together

432
00:14:52,240 --> 00:14:54,639
the mad training and certification line

433
00:14:54,639 --> 00:14:57,120
the training is free go out there have

434
00:14:57,120 --> 00:14:59,120
one of your team members learn it or if

435
00:14:59,120 --> 00:15:00,959
you're the individual contributor

436
00:15:00,959 --> 00:15:03,199
working on this go out and learn this it

437
00:15:03,199 --> 00:15:06,160
is a invaluable skill in today's

438
00:15:06,160 --> 00:15:09,680
really intel or defense

439
00:15:09,680 --> 00:15:11,920
response mechanism

440
00:15:11,920 --> 00:15:13,839
so you want to what are the benefits of

441
00:15:13,839 --> 00:15:15,920
using active defense and miter attack

442
00:15:15,920 --> 00:15:17,760
together building one of these threat

443
00:15:17,760 --> 00:15:19,839
models that allows you to prioritize the

444
00:15:19,839 --> 00:15:21,680
testing of

445
00:15:21,680 --> 00:15:23,760
and remediation of in the wild observe

446
00:15:23,760 --> 00:15:25,680
attack techniques everything in mitre

447
00:15:25,680 --> 00:15:27,839
has been observed in the wild and when

448
00:15:27,839 --> 00:15:30,720
it's tied out to a specific adversary

449
00:15:30,720 --> 00:15:32,240
those techniques have been observed

450
00:15:32,240 --> 00:15:34,480
there's data behind it you know that the

451
00:15:34,480 --> 00:15:36,160
actor or adversary that you're looking

452
00:15:36,160 --> 00:15:39,360
at has used these in the past

453
00:15:39,360 --> 00:15:41,440
it also looks great when you're

454
00:15:41,440 --> 00:15:43,440
presenting to your leadership team

455
00:15:43,440 --> 00:15:45,519
having a heat map like this providing

456
00:15:45,519 --> 00:15:47,839
information on which techniques and

457
00:15:47,839 --> 00:15:49,759
which phase of the the attack chain or

458
00:15:49,759 --> 00:15:51,519
life cycle kill chain whatever word you

459
00:15:51,519 --> 00:15:53,600
want to use for it

460
00:15:53,600 --> 00:15:55,199
this is very helpful for them to

461
00:15:55,199 --> 00:15:57,199
understand what's important to us and

462
00:15:57,199 --> 00:15:59,360
why is it important

463
00:15:59,360 --> 00:16:01,199
it also provides a common lexicon that

464
00:16:01,199 --> 00:16:03,920
can be shared across your teams

465
00:16:03,920 --> 00:16:05,440
so your red team will be able to

466
00:16:05,440 --> 00:16:07,040
understand this and your blue team will

467
00:16:07,040 --> 00:16:09,680
be able to understand this your

468
00:16:09,680 --> 00:16:11,279
network security teams will be able to

469
00:16:11,279 --> 00:16:13,040
understand the way in which these actors

470
00:16:13,040 --> 00:16:14,079
groups

471
00:16:14,079 --> 00:16:16,320
use these techniques because it's

472
00:16:16,320 --> 00:16:19,360
defined there is a set layout it's

473
00:16:19,360 --> 00:16:21,040
evolving it's getting

474
00:16:21,040 --> 00:16:23,040
more enriched

475
00:16:23,040 --> 00:16:25,360
i highly recommend using this

476
00:16:25,360 --> 00:16:27,759
to convey thoughts and concepts and

477
00:16:27,759 --> 00:16:30,000
really your active defense mission

478
00:16:30,000 --> 00:16:32,079
across teams

479
00:16:32,079 --> 00:16:33,759
again like i said they're building new

480
00:16:33,759 --> 00:16:35,759
campaigns and attack methodologies so

481
00:16:35,759 --> 00:16:37,920
that it can be better tested

482
00:16:37,920 --> 00:16:39,680
it's constantly evolving they're adding

483
00:16:39,680 --> 00:16:41,279
new techniques and sub techniques

484
00:16:41,279 --> 00:16:45,519
there's 14 i think now tactics like 185

485
00:16:45,519 --> 00:16:48,839
or 187 techniques and then

486
00:16:48,839 --> 00:16:51,839
367 sub techniques that's massive that

487
00:16:51,839 --> 00:16:54,399
goes back to the complex nature of the

488
00:16:54,399 --> 00:16:57,199
threat models you're trying to build

489
00:16:57,199 --> 00:17:00,639
it also maps back to this sb 853

490
00:17:00,639 --> 00:17:02,639
this provides potential security and

491
00:17:02,639 --> 00:17:05,199
privacy controls and audit potential for

492
00:17:05,199 --> 00:17:07,760
your organization to go just beyond this

493
00:17:07,760 --> 00:17:09,839
attacker-centric view you can go back

494
00:17:09,839 --> 00:17:12,959
and work with this model and talk policy

495
00:17:12,959 --> 00:17:16,240
if that's something you want to do

496
00:17:16,240 --> 00:17:17,760
so then you have to craft the narrative

497
00:17:17,760 --> 00:17:20,160
and mission scope i'm going to use the

498
00:17:20,160 --> 00:17:22,400
example of wizard spider wizard spider

499
00:17:22,400 --> 00:17:26,400
is a sophisticated uh eastern european

500
00:17:26,400 --> 00:17:27,919
attributed

501
00:17:27,919 --> 00:17:30,240
cyber crime group they create a

502
00:17:30,240 --> 00:17:32,640
sophisticated arsenal of tools they

503
00:17:32,640 --> 00:17:35,120
perform big game hunting they're very

504
00:17:35,120 --> 00:17:38,160
active they're behind trick bot ryuk and

505
00:17:38,160 --> 00:17:40,320
the kanti ransomware

506
00:17:40,320 --> 00:17:41,200
so

507
00:17:41,200 --> 00:17:43,039
they don't

508
00:17:43,039 --> 00:17:45,360
they don't openly advertise their tools

509
00:17:45,360 --> 00:17:46,799
like a lot of other groups on

510
00:17:46,799 --> 00:17:48,480
underground forums they work with a

511
00:17:48,480 --> 00:17:52,720
small subset of well-vetted um

512
00:17:52,720 --> 00:17:54,320
operators that they

513
00:17:54,320 --> 00:17:56,240
then take a piece of whatever they do

514
00:17:56,240 --> 00:17:58,240
when they implement the ryuk or conte

515
00:17:58,240 --> 00:18:00,320
ransomware

516
00:18:00,320 --> 00:18:02,640
here's a timeline of the ransomwares and

517
00:18:02,640 --> 00:18:04,720
different malware trojans backdoors

518
00:18:04,720 --> 00:18:06,320
spams

519
00:18:06,320 --> 00:18:08,400
you name it this group has been building

520
00:18:08,400 --> 00:18:10,720
and actively working on so this is kind

521
00:18:10,720 --> 00:18:13,280
of a timeline of the tools they've used

522
00:18:13,280 --> 00:18:14,640
at least from the research that i was

523
00:18:14,640 --> 00:18:16,400
able to put together they're interesting

524
00:18:16,400 --> 00:18:17,919
for a mission

525
00:18:17,919 --> 00:18:20,559
scenario

526
00:18:21,919 --> 00:18:24,160
all right so let's take this back to

527
00:18:24,160 --> 00:18:25,760
mitre attack that's the threat model

528
00:18:25,760 --> 00:18:28,240
that i recommended using so i want to

529
00:18:28,240 --> 00:18:29,840
understand a little bit more about the

530
00:18:29,840 --> 00:18:32,080
way this group

531
00:18:32,080 --> 00:18:34,640
does their scripting and their execution

532
00:18:34,640 --> 00:18:36,559
of malware i want to understand the way

533
00:18:36,559 --> 00:18:39,120
that they modify system processes for

534
00:18:39,120 --> 00:18:40,799
exfiltration i want to understand how

535
00:18:40,799 --> 00:18:42,480
they use command and control channels

536
00:18:42,480 --> 00:18:44,720
and also alternate protocols i want to

537
00:18:44,720 --> 00:18:46,720
understand the remote services

538
00:18:46,720 --> 00:18:48,720
as the exploitation of those remote

539
00:18:48,720 --> 00:18:50,320
services and then the use of external

540
00:18:50,320 --> 00:18:51,760
remote services

541
00:18:51,760 --> 00:18:54,799
but let's take this a bit deeper so

542
00:18:54,799 --> 00:18:56,480
deep diving into the way the actor

543
00:18:56,480 --> 00:18:58,080
groups the threat models that are out

544
00:18:58,080 --> 00:19:00,480
there for them tied back to mitre so

545
00:19:00,480 --> 00:19:02,480
they use this um

546
00:19:02,480 --> 00:19:03,600
i'm not going to go through each of

547
00:19:03,600 --> 00:19:05,919
these but let's let's grab the first one

548
00:19:05,919 --> 00:19:07,120
so let's talk about their use of

549
00:19:07,120 --> 00:19:09,520
powershell so this ties back to the

550
00:19:09,520 --> 00:19:11,799
mitre attack technique

551
00:19:11,799 --> 00:19:14,640
t1059 which is command and scripting

552
00:19:14,640 --> 00:19:16,880
interpreter the sub technique they use

553
00:19:16,880 --> 00:19:19,600
is zero zero one which is power shell so

554
00:19:19,600 --> 00:19:21,440
wizard spider has been observed using

555
00:19:21,440 --> 00:19:23,760
macros to execute powershell scripts to

556
00:19:23,760 --> 00:19:26,160
download malware on victim machines it

557
00:19:26,160 --> 00:19:28,240
has also used powershell to execute

558
00:19:28,240 --> 00:19:30,400
commands and move laterally through a

559
00:19:30,400 --> 00:19:32,000
victim network

560
00:19:32,000 --> 00:19:33,679
this is interesting to test if you want

561
00:19:33,679 --> 00:19:35,600
to know your organization's ability to

562
00:19:35,600 --> 00:19:38,720
defend against something like this

563
00:19:38,720 --> 00:19:40,799
expanding on that i also want to look at

564
00:19:40,799 --> 00:19:42,640
t1543

565
00:19:42,640 --> 00:19:44,160
which is creative modify system

566
00:19:44,160 --> 00:19:46,320
processes and i want to look at zero

567
00:19:46,320 --> 00:19:48,559
zero three as a sub technique which is

568
00:19:48,559 --> 00:19:50,880
using windows command shell to do that

569
00:19:50,880 --> 00:19:53,160
so wizard spider has been observed using

570
00:19:53,160 --> 00:19:55,520
command.exe to execute commands on a

571
00:19:55,520 --> 00:19:56,880
victim's machine

572
00:19:56,880 --> 00:19:58,720
and i have a few more techniques and

573
00:19:58,720 --> 00:20:00,640
this is how i go through this is what i

574
00:20:00,640 --> 00:20:02,880
recommend your teams doing is working

575
00:20:02,880 --> 00:20:04,640
through to putting together a list of

576
00:20:04,640 --> 00:20:07,120
these ttps and understanding again tie

577
00:20:07,120 --> 00:20:09,039
back to mitre so that you can have more

578
00:20:09,039 --> 00:20:10,320
of a

579
00:20:10,320 --> 00:20:12,080
conversation with other teams so that

580
00:20:12,080 --> 00:20:13,679
it's a common language that you're

581
00:20:13,679 --> 00:20:16,159
speaking to them and also a common way

582
00:20:16,159 --> 00:20:19,840
to reflect your remediations once you

583
00:20:19,840 --> 00:20:21,679
identify where your gaps are and i'll

584
00:20:21,679 --> 00:20:24,799
show you that in a little bit

585
00:20:26,000 --> 00:20:29,520
so keeping with planning your mission

586
00:20:29,520 --> 00:20:31,520
it can get out of hand there's a lot of

587
00:20:31,520 --> 00:20:33,200
different teams involved

588
00:20:33,200 --> 00:20:35,440
what i recommend doing is

589
00:20:35,440 --> 00:20:36,799
at the beginning of your mission

590
00:20:36,799 --> 00:20:38,320
deciding the stakeholders you want

591
00:20:38,320 --> 00:20:39,280
involved

592
00:20:39,280 --> 00:20:40,960
some key stakeholders that i've worked

593
00:20:40,960 --> 00:20:42,320
with in the past and these missions have

594
00:20:42,320 --> 00:20:44,720
included blue teams of course your intel

595
00:20:44,720 --> 00:20:46,960
team your endpoint detection response

596
00:20:46,960 --> 00:20:49,120
team maybe they own your your endpoint

597
00:20:49,120 --> 00:20:52,000
solution your network security team your

598
00:20:52,000 --> 00:20:53,679
knock if that's the thing that you have

599
00:20:53,679 --> 00:20:55,200
in your organization

600
00:20:55,200 --> 00:20:57,200
your firewall team your cloud team your

601
00:20:57,200 --> 00:20:59,120
data loss prevention team your digital

602
00:20:59,120 --> 00:21:00,640
forensics and instant response the

603
00:21:00,640 --> 00:21:03,120
vulnerability management and red team

604
00:21:03,120 --> 00:21:04,799
that's a pretty diverse group of

605
00:21:04,799 --> 00:21:06,400
security teams

606
00:21:06,400 --> 00:21:07,600
but you can build them all into your

607
00:21:07,600 --> 00:21:09,120
mission plan

608
00:21:09,120 --> 00:21:11,440
so what is the deliverable that you want

609
00:21:11,440 --> 00:21:13,840
after this first phase

610
00:21:13,840 --> 00:21:15,440
feels like forever ago we've already

611
00:21:15,440 --> 00:21:17,440
been talking about how to build this out

612
00:21:17,440 --> 00:21:19,120
but again this is just one piece to the

613
00:21:19,120 --> 00:21:20,320
puzzle here

614
00:21:20,320 --> 00:21:23,120
we're looking at having a after defense

615
00:21:23,120 --> 00:21:24,720
mission plan you want a document that

616
00:21:24,720 --> 00:21:26,320
states what you're going to do why

617
00:21:26,320 --> 00:21:28,480
you're going to do it who you're testing

618
00:21:28,480 --> 00:21:29,600
against

619
00:21:29,600 --> 00:21:31,679
and which controls that you want to see

620
00:21:31,679 --> 00:21:33,360
the efficacy for

621
00:21:33,360 --> 00:21:34,799
you need to have a kickoff meeting you

622
00:21:34,799 --> 00:21:37,039
need to make everyone aware recruit your

623
00:21:37,039 --> 00:21:38,799
leadership make sure that they have

624
00:21:38,799 --> 00:21:40,880
their sign off in there but you need to

625
00:21:40,880 --> 00:21:42,400
make sure everyone's aware of what the

626
00:21:42,400 --> 00:21:44,640
mission is why you're doing it and have

627
00:21:44,640 --> 00:21:46,720
them on board that's your chance to sell

628
00:21:46,720 --> 00:21:48,960
this and show how awesome of a mission

629
00:21:48,960 --> 00:21:50,320
that you're going to be able to

630
00:21:50,320 --> 00:21:52,559
implement

631
00:21:52,559 --> 00:21:55,440
another thing again this comes to the

632
00:21:55,440 --> 00:21:57,600
manager in me i want to know the metrics

633
00:21:57,600 --> 00:21:59,440
on the time to plan this mission how

634
00:21:59,440 --> 00:22:01,360
long did it take is there points for

635
00:22:01,360 --> 00:22:03,760
improvement is was there

636
00:22:03,760 --> 00:22:05,440
a dissension in the group i want to

637
00:22:05,440 --> 00:22:06,799
understand

638
00:22:06,799 --> 00:22:09,120
why the mission took how long it did to

639
00:22:09,120 --> 00:22:11,520
plan it good bad or indifferent just so

640
00:22:11,520 --> 00:22:14,480
you can always constantly improve

641
00:22:14,480 --> 00:22:16,400
so threat hunting and establishing a

642
00:22:16,400 --> 00:22:18,559
baseline this is the second phase of

643
00:22:18,559 --> 00:22:20,400
active defense

644
00:22:20,400 --> 00:22:22,720
so threat hunting overview why are you

645
00:22:22,720 --> 00:22:23,840
doing this

646
00:22:23,840 --> 00:22:25,360
and what are you doing so you're

647
00:22:25,360 --> 00:22:28,640
collecting a set of indicators

648
00:22:28,640 --> 00:22:30,480
associated with the adversarial campaign

649
00:22:30,480 --> 00:22:31,760
again we were talking about wizard

650
00:22:31,760 --> 00:22:33,440
spiders so we'll get into an example for

651
00:22:33,440 --> 00:22:35,280
that in a second but we're looking to

652
00:22:35,280 --> 00:22:36,640
collect the indicators compromise

653
00:22:36,640 --> 00:22:38,880
associated with the adversary or

654
00:22:38,880 --> 00:22:42,159
campaign detailed in your mission plan

655
00:22:42,159 --> 00:22:44,000
but why are we doing this well we want

656
00:22:44,000 --> 00:22:46,400
to know whether an adversary or campaign

657
00:22:46,400 --> 00:22:48,080
that we're testing against is currently

658
00:22:48,080 --> 00:22:50,080
affecting our organization we want to

659
00:22:50,080 --> 00:22:53,760
know if any of the iocs detected

660
00:22:53,760 --> 00:22:55,919
showing up in any of our logs and the

661
00:22:55,919 --> 00:22:58,480
reason we want to do this is so that we

662
00:22:58,480 --> 00:23:00,400
can establish this baseline have an

663
00:23:00,400 --> 00:23:02,320
understanding that we have a clean slate

664
00:23:02,320 --> 00:23:04,880
we're working off so any of the red team

665
00:23:04,880 --> 00:23:06,880
or purple teams testing of our security

666
00:23:06,880 --> 00:23:09,120
controls is just that it's a test

667
00:23:09,120 --> 00:23:11,600
created by the red or purple team and we

668
00:23:11,600 --> 00:23:13,520
have that

669
00:23:13,520 --> 00:23:15,679
true understanding and belief and trust

670
00:23:15,679 --> 00:23:17,679
in their results saying we don't think

671
00:23:17,679 --> 00:23:19,440
it's anything else there's no

672
00:23:19,440 --> 00:23:21,520
false positives or in this case would be

673
00:23:21,520 --> 00:23:24,000
true positives if the after adversary

674
00:23:24,000 --> 00:23:26,720
were attacking in the environment

675
00:23:26,720 --> 00:23:29,120
the following teams would be uh involved

676
00:23:29,120 --> 00:23:30,559
in this phase so it would be your blue

677
00:23:30,559 --> 00:23:32,400
team your endpoint detection response

678
00:23:32,400 --> 00:23:33,200
team

679
00:23:33,200 --> 00:23:34,880
any of the teams that are actually going

680
00:23:34,880 --> 00:23:36,799
out and hunting for the iocs that's who

681
00:23:36,799 --> 00:23:39,440
would volunteer again your intel team in

682
00:23:39,440 --> 00:23:41,600
this methodology would be the ones

683
00:23:41,600 --> 00:23:43,919
driving the whole phase so they're in

684
00:23:43,919 --> 00:23:47,600
every uh step in the process

685
00:23:47,600 --> 00:23:49,279
all right this is a fun one how do we

686
00:23:49,279 --> 00:23:51,279
collect indicators there's a lot of

687
00:23:51,279 --> 00:23:54,400
different ways to do that

688
00:23:55,279 --> 00:23:56,720
one example is using a tool like

689
00:23:56,720 --> 00:23:58,720
reported future there's open source

690
00:23:58,720 --> 00:24:01,200
providers like threat miner

691
00:24:01,200 --> 00:24:03,600
maupedia is another good one going out

692
00:24:03,600 --> 00:24:05,279
and looking at vendor reports that are

693
00:24:05,279 --> 00:24:06,240
released

694
00:24:06,240 --> 00:24:08,080
trying to find any indicators that are

695
00:24:08,080 --> 00:24:10,080
mentioned in active and relevant

696
00:24:10,080 --> 00:24:11,840
campaigns to the group that you're

697
00:24:11,840 --> 00:24:14,480
looking at

698
00:24:14,720 --> 00:24:16,240
there's a lot of different ways to do

699
00:24:16,240 --> 00:24:17,279
this

700
00:24:17,279 --> 00:24:19,279
again by the maturity of your team you

701
00:24:19,279 --> 00:24:21,600
should have some processes there to

702
00:24:21,600 --> 00:24:24,080
do ad hoc indicator

703
00:24:24,080 --> 00:24:26,880
hunting or enrichment

704
00:24:26,880 --> 00:24:27,679
so

705
00:24:27,679 --> 00:24:29,200
once you have those indicators you've

706
00:24:29,200 --> 00:24:31,440
gone out and hunted for them the the

707
00:24:31,440 --> 00:24:32,880
blue team would then perform threat

708
00:24:32,880 --> 00:24:35,120
hunting for to identify host related

709
00:24:35,120 --> 00:24:38,240
iocs for the wizards fighter

710
00:24:38,240 --> 00:24:39,919
adversary we're going to look for their

711
00:24:39,919 --> 00:24:41,679
those tactics that we have we try to

712
00:24:41,679 --> 00:24:44,320
associate iocs to them but again we want

713
00:24:44,320 --> 00:24:46,000
to know if there's any wizard spider

714
00:24:46,000 --> 00:24:48,720
activity or attributed activity to

715
00:24:48,720 --> 00:24:50,880
wizard spider in our environment

716
00:24:50,880 --> 00:24:52,320
we're going to use the edr team to look

717
00:24:52,320 --> 00:24:54,080
for some of the command line activity

718
00:24:54,080 --> 00:24:55,679
again for wizard spiders command and

719
00:24:55,679 --> 00:24:57,520
control persistence and lateral movement

720
00:24:57,520 --> 00:24:59,840
techniques

721
00:24:59,840 --> 00:25:02,080
also a really interesting project i

722
00:25:02,080 --> 00:25:03,600
recommend you all checking out is the

723
00:25:03,600 --> 00:25:05,200
sigma project

724
00:25:05,200 --> 00:25:07,760
this is scene based rules for detection

725
00:25:07,760 --> 00:25:09,039
so i

726
00:25:09,039 --> 00:25:11,520
i normally recommend my teams to go out

727
00:25:11,520 --> 00:25:12,240
and

728
00:25:12,240 --> 00:25:13,840
reach out to the blue team and say hey i

729
00:25:13,840 --> 00:25:16,320
know you're working on your uh seam here

730
00:25:16,320 --> 00:25:17,919
these are the

731
00:25:17,919 --> 00:25:19,919
sigma rules that can be used to hunt

732
00:25:19,919 --> 00:25:22,159
wizard spiders technique so maybe later

733
00:25:22,159 --> 00:25:23,760
on if your seam's not one of the

734
00:25:23,760 --> 00:25:25,520
technologies you're testing this could

735
00:25:25,520 --> 00:25:27,360
be a good way as a follow-up or

736
00:25:27,360 --> 00:25:30,159
recommendation that you have later on

737
00:25:30,159 --> 00:25:31,600
so what do you get out of this phase of

738
00:25:31,600 --> 00:25:33,600
the mission you understand the activity

739
00:25:33,600 --> 00:25:35,840
baseline if you come back zero you're in

740
00:25:35,840 --> 00:25:38,640
really good shape to know that this

741
00:25:38,640 --> 00:25:40,880
adversary is not in your environment and

742
00:25:40,880 --> 00:25:42,480
any tests being done and anything

743
00:25:42,480 --> 00:25:44,640
observed from this point forward would

744
00:25:44,640 --> 00:25:47,600
be your purple or red team

745
00:25:47,600 --> 00:25:48,240
and

746
00:25:48,240 --> 00:25:50,400
conversely if you get the opposite then

747
00:25:50,400 --> 00:25:52,000
you have a bigger issue pause the

748
00:25:52,000 --> 00:25:54,159
mission escalate and

749
00:25:54,159 --> 00:25:56,559
deep dive into what is causing that

750
00:25:56,559 --> 00:25:58,559
activity so you can either know whether

751
00:25:58,559 --> 00:26:00,559
you're under attack or

752
00:26:00,559 --> 00:26:03,200
you can treat them as a false positive

753
00:26:03,200 --> 00:26:04,960
and move forward and use that as part of

754
00:26:04,960 --> 00:26:07,039
the data going forward

755
00:26:07,039 --> 00:26:08,640
you'll have metrics on the iocs

756
00:26:08,640 --> 00:26:10,799
identified how good is your team at

757
00:26:10,799 --> 00:26:13,440
identifying usable iocs for the blue or

758
00:26:13,440 --> 00:26:15,200
edr teams

759
00:26:15,200 --> 00:26:16,559
this can help you improve your

760
00:26:16,559 --> 00:26:18,480
intelligence collecting process and

761
00:26:18,480 --> 00:26:20,640
again metrics metric metrics we're going

762
00:26:20,640 --> 00:26:23,200
to take some time to understand how long

763
00:26:23,200 --> 00:26:25,039
did it take for us to

764
00:26:25,039 --> 00:26:26,799
hunt for the iocs involved were there

765
00:26:26,799 --> 00:26:28,960
any hiccups is there any issues with our

766
00:26:28,960 --> 00:26:31,679
technologies

767
00:26:32,640 --> 00:26:34,000
now we're getting into the interesting

768
00:26:34,000 --> 00:26:36,000
stuff so let's talk security control

769
00:26:36,000 --> 00:26:38,400
validation testing

770
00:26:38,400 --> 00:26:39,200
so

771
00:26:39,200 --> 00:26:41,039
what is security control validation

772
00:26:41,039 --> 00:26:42,799
testing

773
00:26:42,799 --> 00:26:44,480
this is the phase of the active defense

774
00:26:44,480 --> 00:26:46,240
mission that involves a purple or red

775
00:26:46,240 --> 00:26:48,480
team utilizing the intelligence provided

776
00:26:48,480 --> 00:26:50,320
by the cti team

777
00:26:50,320 --> 00:26:52,240
the miter attack threat model and

778
00:26:52,240 --> 00:26:54,480
command slash process is leveraged in

779
00:26:54,480 --> 00:26:56,080
adversary

780
00:26:56,080 --> 00:26:57,760
in by the adversary detailed in the

781
00:26:57,760 --> 00:26:59,440
mission plan

782
00:26:59,440 --> 00:27:00,720
this is to be

783
00:27:00,720 --> 00:27:02,720
done so you can emulate a realistic

784
00:27:02,720 --> 00:27:04,400
attack against the organization's

785
00:27:04,400 --> 00:27:06,880
defense control so you have your little

786
00:27:06,880 --> 00:27:08,960
castle here you know where your openings

787
00:27:08,960 --> 00:27:10,640
are but

788
00:27:10,640 --> 00:27:13,120
is this really the state of your defense

789
00:27:13,120 --> 00:27:14,559
do you that's what you want to know do

790
00:27:14,559 --> 00:27:16,960
you want to know how

791
00:27:16,960 --> 00:27:19,600
well your priests mission controls are

792
00:27:19,600 --> 00:27:21,760
detecting alerting and blocking the

793
00:27:21,760 --> 00:27:23,919
techniques of the adversary of interest

794
00:27:23,919 --> 00:27:26,080
again our scenarios around wizard spider

795
00:27:26,080 --> 00:27:30,559
so how good are our security controls in

796
00:27:30,559 --> 00:27:32,720
detecting wizard spider activity

797
00:27:32,720 --> 00:27:34,399
alerting us on that is something going

798
00:27:34,399 --> 00:27:36,080
to be built out with the proper use

799
00:27:36,080 --> 00:27:37,120
cases

800
00:27:37,120 --> 00:27:37,919
is

801
00:27:37,919 --> 00:27:40,000
our end point really going to fire and

802
00:27:40,000 --> 00:27:41,840
let us know when something's happening

803
00:27:41,840 --> 00:27:43,360
or is it going to block the techniques

804
00:27:43,360 --> 00:27:45,360
that we observe

805
00:27:45,360 --> 00:27:46,720
this is the point of this part of the

806
00:27:46,720 --> 00:27:47,760
mission

807
00:27:47,760 --> 00:27:49,919
again though who's involved

808
00:27:49,919 --> 00:27:51,600
uh your red or purple team or whoever's

809
00:27:51,600 --> 00:27:53,679
conducting your test and then your intel

810
00:27:53,679 --> 00:27:55,600
team

811
00:27:55,600 --> 00:27:58,240
so going with this wizard spider example

812
00:27:58,240 --> 00:28:00,399
we're going to have we as the intel team

813
00:28:00,399 --> 00:28:01,919
are going to have the red team or purple

814
00:28:01,919 --> 00:28:03,200
team

815
00:28:03,200 --> 00:28:05,200
use the miter attack threat model and

816
00:28:05,200 --> 00:28:06,480
then

817
00:28:06,480 --> 00:28:09,039
the techniques we've provided them to to

818
00:28:09,039 --> 00:28:11,360
run a test and see either automated or

819
00:28:11,360 --> 00:28:14,640
manual the efficacy of our tools so are

820
00:28:14,640 --> 00:28:17,360
we going to again detect alert or block

821
00:28:17,360 --> 00:28:19,600
what we see from the activity that the

822
00:28:19,600 --> 00:28:21,840
purple red team are emulating wizard

823
00:28:21,840 --> 00:28:23,360
spider for

824
00:28:23,360 --> 00:28:25,360
purple team is going to give us a

825
00:28:25,360 --> 00:28:27,520
current state analysis so we're going to

826
00:28:27,520 --> 00:28:29,440
understand what the security controls

827
00:28:29,440 --> 00:28:31,919
that are within scope are able to do

828
00:28:31,919 --> 00:28:33,120
and they're going to brief us and

829
00:28:33,120 --> 00:28:34,480
they're going to walk us through their

830
00:28:34,480 --> 00:28:38,000
assessment results and recommendations

831
00:28:38,000 --> 00:28:40,320
all right so phase delivery here what

832
00:28:40,320 --> 00:28:42,480
are we giving back to

833
00:28:42,480 --> 00:28:44,240
us as the intel team what do we expect

834
00:28:44,240 --> 00:28:47,200
to receive from our purple or red team

835
00:28:47,200 --> 00:28:48,720
uh well we

836
00:28:48,720 --> 00:28:50,880
initially the assessment results

837
00:28:50,880 --> 00:28:53,840
what what is fire what hasn't

838
00:28:53,840 --> 00:28:55,520
what improvement recommendations do they

839
00:28:55,520 --> 00:28:56,799
make they're experts in the way

840
00:28:56,799 --> 00:28:59,360
attackers work how could we better

841
00:28:59,360 --> 00:29:01,200
enrich our defensive controls based off

842
00:29:01,200 --> 00:29:02,799
of their perspective

843
00:29:02,799 --> 00:29:06,080
metrics on the efficacy of the controls

844
00:29:06,080 --> 00:29:07,520
how good are they against the miter

845
00:29:07,520 --> 00:29:08,960
attack framework i'll show you that in a

846
00:29:08,960 --> 00:29:10,159
second but

847
00:29:10,159 --> 00:29:11,760
we also want to know

848
00:29:11,760 --> 00:29:14,080
how much time did it take to test the

849
00:29:14,080 --> 00:29:15,200
controls

850
00:29:15,200 --> 00:29:16,880
where can we find improvements for the

851
00:29:16,880 --> 00:29:18,240
purple and red team as part of this

852
00:29:18,240 --> 00:29:20,559
mission

853
00:29:20,880 --> 00:29:23,279
this is an example this is again a

854
00:29:23,279 --> 00:29:25,840
graphic display of the wizard spider

855
00:29:25,840 --> 00:29:28,240
techniques so we put their miter attack

856
00:29:28,240 --> 00:29:30,240
tactic on the left-hand side we put

857
00:29:30,240 --> 00:29:31,679
their miter attack technique in the

858
00:29:31,679 --> 00:29:34,320
middle to explain what we're testing you

859
00:29:34,320 --> 00:29:36,000
can even throw another column in here

860
00:29:36,000 --> 00:29:38,640
that would be the specific commands run

861
00:29:38,640 --> 00:29:40,399
by your red or purple team

862
00:29:40,399 --> 00:29:42,159
and then you have your pre-mission

863
00:29:42,159 --> 00:29:44,720
endpoint detection rate so how well did

864
00:29:44,720 --> 00:29:47,200
your endpoint detection

865
00:29:47,200 --> 00:29:49,520
tool or sensor or

866
00:29:49,520 --> 00:29:52,080
really your security control work

867
00:29:52,080 --> 00:29:53,440
against

868
00:29:53,440 --> 00:29:55,919
the technique that you chose and the

869
00:29:55,919 --> 00:29:57,600
mission is based around

870
00:29:57,600 --> 00:29:59,679
in this example we did very poorly as an

871
00:29:59,679 --> 00:30:02,159
organization but that's not good or bad

872
00:30:02,159 --> 00:30:03,279
that means that there's room for

873
00:30:03,279 --> 00:30:04,720
improvement and by the end of the

874
00:30:04,720 --> 00:30:06,840
mission we'll be way better

875
00:30:06,840 --> 00:30:11,600
off so security control hearted

876
00:30:15,919 --> 00:30:17,600
all right

877
00:30:17,600 --> 00:30:19,279
let's see our little penguin friend here

878
00:30:19,279 --> 00:30:20,960
he's going to help us fix the issues

879
00:30:20,960 --> 00:30:22,799
that we just saw we didn't do very good

880
00:30:22,799 --> 00:30:25,120
on our

881
00:30:25,120 --> 00:30:27,840
our control validation testing

882
00:30:27,840 --> 00:30:30,159
so now we come to the hardening phase

883
00:30:30,159 --> 00:30:32,320
so we look at this and say

884
00:30:32,320 --> 00:30:35,279
based on the test that we received

885
00:30:35,279 --> 00:30:37,600
how can we improve the design and

886
00:30:37,600 --> 00:30:39,360
implementation of our detection and

887
00:30:39,360 --> 00:30:40,799
response object

888
00:30:40,799 --> 00:30:42,080
this needs to be the guiding force

889
00:30:42,080 --> 00:30:43,440
behind this needs to be our purple or

890
00:30:43,440 --> 00:30:44,640
red team

891
00:30:44,640 --> 00:30:46,320
and the results we got from the previous

892
00:30:46,320 --> 00:30:47,200
phase

893
00:30:47,200 --> 00:30:49,279
there is nothing better of a

894
00:30:49,279 --> 00:30:51,279
conversation starter than taking that

895
00:30:51,279 --> 00:30:53,760
purple team report or red team report

896
00:30:53,760 --> 00:30:56,159
walking it over to your security control

897
00:30:56,159 --> 00:30:58,960
or technology owners and saying look

898
00:30:58,960 --> 00:31:00,960
this is what they did

899
00:31:00,960 --> 00:31:02,480
be an open book here give them the

900
00:31:02,480 --> 00:31:04,559
answers to the test this is what they

901
00:31:04,559 --> 00:31:06,960
did and this is what the tool did

902
00:31:06,960 --> 00:31:08,399
we need your help

903
00:31:08,399 --> 00:31:10,320
and you make it about needing their help

904
00:31:10,320 --> 00:31:12,480
to fix the situation this isn't that

905
00:31:12,480 --> 00:31:14,799
they did their job improperly this is us

906
00:31:14,799 --> 00:31:16,640
as an organization working together it's

907
00:31:16,640 --> 00:31:18,399
that collaboration it's a communication

908
00:31:18,399 --> 00:31:20,799
that we need to have as an organization

909
00:31:20,799 --> 00:31:22,399
to be able to

910
00:31:22,399 --> 00:31:24,480
build a better defense

911
00:31:24,480 --> 00:31:27,039
defense in depth and stop actors from

912
00:31:27,039 --> 00:31:29,519
being able to attack us

913
00:31:29,519 --> 00:31:30,399
again

914
00:31:30,399 --> 00:31:31,600
taking that

915
00:31:31,600 --> 00:31:33,120
collaborative approach

916
00:31:33,120 --> 00:31:34,960
we're going to walk over

917
00:31:34,960 --> 00:31:37,039
work with our partners who own the

918
00:31:37,039 --> 00:31:38,320
technology

919
00:31:38,320 --> 00:31:39,919
and then we're they're going to use this

920
00:31:39,919 --> 00:31:42,159
information to harden things such as

921
00:31:42,159 --> 00:31:44,159
your email network endpoint security

922
00:31:44,159 --> 00:31:45,200
controls

923
00:31:45,200 --> 00:31:47,919
and try to sure up the gaps identified

924
00:31:47,919 --> 00:31:50,320
during that validation testing

925
00:31:50,320 --> 00:31:51,840
who's involved

926
00:31:51,840 --> 00:31:53,519
i highly recommend having the red or

927
00:31:53,519 --> 00:31:55,840
purple team debrief those technology

928
00:31:55,840 --> 00:31:57,919
owners personally

929
00:31:57,919 --> 00:31:58,799
they

930
00:31:58,799 --> 00:32:00,480
something may be lost in conversation

931
00:32:00,480 --> 00:32:03,200
with you as the intel team trying to

932
00:32:03,200 --> 00:32:05,679
regurgitate their report findings bring

933
00:32:05,679 --> 00:32:08,000
them in have them brief the technology

934
00:32:08,000 --> 00:32:09,600
owners on what they saw in their

935
00:32:09,600 --> 00:32:13,199
recommendations for improving it

936
00:32:13,279 --> 00:32:15,519
all right our lovely friends at wizard

937
00:32:15,519 --> 00:32:17,840
spider so let's use this example again

938
00:32:17,840 --> 00:32:19,840
uh we're we're going to talk through the

939
00:32:19,840 --> 00:32:21,200
current state

940
00:32:21,200 --> 00:32:23,120
we're we're going to

941
00:32:23,120 --> 00:32:25,279
use that report to share and brief the

942
00:32:25,279 --> 00:32:27,200
technology owners of

943
00:32:27,200 --> 00:32:28,880
the improvements to the alerting logic

944
00:32:28,880 --> 00:32:30,240
that we need

945
00:32:30,240 --> 00:32:31,360
maybe you're going to have your email

946
00:32:31,360 --> 00:32:33,760
hygiene team and show the rules block

947
00:32:33,760 --> 00:32:35,679
the known phishing attachments for

948
00:32:35,679 --> 00:32:37,360
wizard spider maybe you're going to have

949
00:32:37,360 --> 00:32:38,880
your edr team

950
00:32:38,880 --> 00:32:41,360
test new alerting and response logic to

951
00:32:41,360 --> 00:32:42,799
ensure the endpoint sensors will

952
00:32:42,799 --> 00:32:43,840
properly

953
00:32:43,840 --> 00:32:45,679
fire when wizard spider activity is

954
00:32:45,679 --> 00:32:47,279
occurring

955
00:32:47,279 --> 00:32:48,880
maybe you'll have your knock team if

956
00:32:48,880 --> 00:32:52,000
they own the ids set some new rules

957
00:32:52,000 --> 00:32:54,320
to detect and respond against wizard

958
00:32:54,320 --> 00:32:55,360
spider command and control

959
00:32:55,360 --> 00:32:58,240
infrastructure or communications

960
00:32:58,240 --> 00:32:59,200
what do we get at the end of this

961
00:32:59,200 --> 00:33:00,880
mission phase

962
00:33:00,880 --> 00:33:01,840
well we're going to get a list of

963
00:33:01,840 --> 00:33:03,919
security control improvements we're

964
00:33:03,919 --> 00:33:05,760
going to take the metrics around how

965
00:33:05,760 --> 00:33:07,279
long did it take to

966
00:33:07,279 --> 00:33:09,519
improve our security controls

967
00:33:09,519 --> 00:33:11,200
you need this list of improvements so

968
00:33:11,200 --> 00:33:12,640
you can call that out in your after

969
00:33:12,640 --> 00:33:14,240
action report or

970
00:33:14,240 --> 00:33:16,640
your debrief or recap however you want

971
00:33:16,640 --> 00:33:18,960
to call your end final report on the

972
00:33:18,960 --> 00:33:20,640
mission you need those controls and you

973
00:33:20,640 --> 00:33:22,880
need to document throughout the process

974
00:33:22,880 --> 00:33:25,440
start early start often and

975
00:33:25,440 --> 00:33:27,360
it makes your job at the end easier you

976
00:33:27,360 --> 00:33:28,960
don't have to

977
00:33:28,960 --> 00:33:30,960
go and find people and say hey look i

978
00:33:30,960 --> 00:33:32,159
know you're finished with your part of

979
00:33:32,159 --> 00:33:33,279
the mission but can you get me those

980
00:33:33,279 --> 00:33:35,919
results again

981
00:33:36,080 --> 00:33:38,720
so this is an example of how to report

982
00:33:38,720 --> 00:33:41,279
across your hardening result

983
00:33:41,279 --> 00:33:42,960
so

984
00:33:42,960 --> 00:33:45,039
again here's our minor attack tactic

985
00:33:45,039 --> 00:33:46,559
here's our technique

986
00:33:46,559 --> 00:33:48,799
and then you put down again just

987
00:33:48,799 --> 00:33:51,679
focusing on your endpoint detection

988
00:33:51,679 --> 00:33:55,039
and your potential your ids we say where

989
00:33:55,039 --> 00:33:56,880
the rules fired and where things were

990
00:33:56,880 --> 00:33:59,840
created so our endpoint was really bad

991
00:33:59,840 --> 00:34:02,399
so we created new rules across the board

992
00:34:02,399 --> 00:34:04,399
for ids maybe the two that we had

993
00:34:04,399 --> 00:34:06,240
success on we didn't need to create new

994
00:34:06,240 --> 00:34:08,639
rules for so we ended up creating four

995
00:34:08,639 --> 00:34:11,119
not six

996
00:34:12,879 --> 00:34:15,119
all right security control validation

997
00:34:15,119 --> 00:34:17,839
retesting

998
00:34:19,359 --> 00:34:20,399
all right

999
00:34:20,399 --> 00:34:23,520
um it's very similar to the test should

1000
00:34:23,520 --> 00:34:25,359
be a little bit easier to execute as

1001
00:34:25,359 --> 00:34:27,359
well

1002
00:34:27,359 --> 00:34:28,800
you see our capsule got a little bit

1003
00:34:28,800 --> 00:34:29,760
bigger

1004
00:34:29,760 --> 00:34:31,760
we added more security controls we're a

1005
00:34:31,760 --> 00:34:34,079
little more confident in the way that

1006
00:34:34,079 --> 00:34:36,000
our defenses are set up against this

1007
00:34:36,000 --> 00:34:37,359
adversary

1008
00:34:37,359 --> 00:34:40,000
so we then would reach out to our purple

1009
00:34:40,000 --> 00:34:42,879
or red team and say hey can you reassess

1010
00:34:42,879 --> 00:34:45,599
our security controls we took

1011
00:34:45,599 --> 00:34:47,359
we took your answer key

1012
00:34:47,359 --> 00:34:48,879
went back

1013
00:34:48,879 --> 00:34:51,760
revised our tests let us know how we did

1014
00:34:51,760 --> 00:34:53,199
then they retest the environment your

1015
00:34:53,199 --> 00:34:56,159
purple red team will come back and say

1016
00:34:56,159 --> 00:34:59,359
similarly to what we showed previously

1017
00:34:59,359 --> 00:35:00,320
did

1018
00:35:00,320 --> 00:35:01,599
did the control

1019
00:35:01,599 --> 00:35:02,960
was the control alerted on was it

1020
00:35:02,960 --> 00:35:05,680
controlled blocked was it detected how

1021
00:35:05,680 --> 00:35:06,800
did the

1022
00:35:06,800 --> 00:35:09,040
specific technology respond to our

1023
00:35:09,040 --> 00:35:10,720
attack

1024
00:35:10,720 --> 00:35:13,920
parties involved red team purple team

1025
00:35:13,920 --> 00:35:17,839
and then cti team

1026
00:35:18,160 --> 00:35:20,880
again using the wizard spider example

1027
00:35:20,880 --> 00:35:23,280
cti team request

1028
00:35:23,280 --> 00:35:24,960
with the wizard spider techniques be

1029
00:35:24,960 --> 00:35:27,839
retested there is a current state

1030
00:35:27,839 --> 00:35:30,160
assessment of the organization's

1031
00:35:30,160 --> 00:35:32,320
security controls the current state now

1032
00:35:32,320 --> 00:35:35,280
is post remediation so you can have that

1033
00:35:35,280 --> 00:35:37,440
before and after look into it

1034
00:35:37,440 --> 00:35:39,359
so you have your validation assessment

1035
00:35:39,359 --> 00:35:40,320
results

1036
00:35:40,320 --> 00:35:41,920
any improvement recommendations from

1037
00:35:41,920 --> 00:35:43,359
here you're constantly seeking

1038
00:35:43,359 --> 00:35:45,520
improvement and then the metrics on the

1039
00:35:45,520 --> 00:35:48,640
security controls

1040
00:35:48,960 --> 00:35:51,359
this looks a little bit better now

1041
00:35:51,359 --> 00:35:53,440
this would make me feel as a leader

1042
00:35:53,440 --> 00:35:55,440
more confident comfortable i can sleep

1043
00:35:55,440 --> 00:35:57,440
better my insomnia is cured i don't

1044
00:35:57,440 --> 00:36:00,079
think we're just going to be

1045
00:36:00,079 --> 00:36:02,079
absolutely overwhelmed with spiders here

1046
00:36:02,079 --> 00:36:03,200
so

1047
00:36:03,200 --> 00:36:05,200
we have our tactics on the left-hand

1048
00:36:05,200 --> 00:36:08,160
side we have our technique after that we

1049
00:36:08,160 --> 00:36:09,839
have our pre-mission and post-mission

1050
00:36:09,839 --> 00:36:12,240
results side by side the reason we have

1051
00:36:12,240 --> 00:36:14,160
it side by side is that it's a powerful

1052
00:36:14,160 --> 00:36:15,520
graphic to show

1053
00:36:15,520 --> 00:36:17,599
the working collaboration the teams that

1054
00:36:17,599 --> 00:36:18,880
we're involved

1055
00:36:18,880 --> 00:36:21,440
have committed to this project and have

1056
00:36:21,440 --> 00:36:24,400
done to fix everything involved so we've

1057
00:36:24,400 --> 00:36:27,440
gone from zero to hero in the span of a

1058
00:36:27,440 --> 00:36:29,839
quarter

1059
00:36:30,000 --> 00:36:33,200
so reporting and lessons learned

1060
00:36:33,200 --> 00:36:34,880
this is all what it comes down to this

1061
00:36:34,880 --> 00:36:36,720
is how you show the value in the work

1062
00:36:36,720 --> 00:36:39,280
that you've done this is how you sell

1063
00:36:39,280 --> 00:36:40,960
the story of what you're doing and this

1064
00:36:40,960 --> 00:36:42,560
is how you do more

1065
00:36:42,560 --> 00:36:44,960
and get better buy-in from leadership

1066
00:36:44,960 --> 00:36:46,960
and promote security awareness across

1067
00:36:46,960 --> 00:36:49,359
the organization

1068
00:36:49,359 --> 00:36:51,440
so there's some keys to reporting that i

1069
00:36:51,440 --> 00:36:53,359
would like to call out

1070
00:36:53,359 --> 00:36:55,280
different styles different organizations

1071
00:36:55,280 --> 00:36:57,359
with those caveats they may some

1072
00:36:57,359 --> 00:36:59,280
organizations may be more receptive to

1073
00:36:59,280 --> 00:37:01,440
other reporting styles but these are

1074
00:37:01,440 --> 00:37:03,520
very general i highly recommend

1075
00:37:03,520 --> 00:37:05,760
listening to them and see where you can

1076
00:37:05,760 --> 00:37:07,440
take something and bring it back to your

1077
00:37:07,440 --> 00:37:09,599
organization and

1078
00:37:09,599 --> 00:37:11,520
really just try to improve the way that

1079
00:37:11,520 --> 00:37:13,440
you report the data

1080
00:37:13,440 --> 00:37:15,680
so have an executive summary try to keep

1081
00:37:15,680 --> 00:37:17,200
it to one page

1082
00:37:17,200 --> 00:37:19,359
i've run into teams that have tried to

1083
00:37:19,359 --> 00:37:20,839
just

1084
00:37:20,839 --> 00:37:23,599
overwhelm non-technical audience with

1085
00:37:23,599 --> 00:37:26,079
with just so much data that they they

1086
00:37:26,079 --> 00:37:28,000
don't know how to consume it the average

1087
00:37:28,000 --> 00:37:29,599
executive doesn't have enough time to

1088
00:37:29,599 --> 00:37:31,839
read a 50-page report they'll look at

1089
00:37:31,839 --> 00:37:34,400
the first page and try to

1090
00:37:34,400 --> 00:37:36,480
distill as much information as they can

1091
00:37:36,480 --> 00:37:38,560
down make their job easy put together an

1092
00:37:38,560 --> 00:37:41,359
executive summary have lots of charts

1093
00:37:41,359 --> 00:37:43,920
short paragraphs explaining exactly what

1094
00:37:43,920 --> 00:37:46,079
the charts are and the success of the

1095
00:37:46,079 --> 00:37:48,079
mission

1096
00:37:48,079 --> 00:37:49,599
i'm going to repeat this again use

1097
00:37:49,599 --> 00:37:51,839
graphics you can represent several

1098
00:37:51,839 --> 00:37:55,040
paragraphs in a single chart do it

1099
00:37:55,040 --> 00:37:57,520
keep it simple where possible uh the

1100
00:37:57,520 --> 00:37:59,359
report is not an opportunity to show how

1101
00:37:59,359 --> 00:38:01,440
technical you or your team are yes

1102
00:38:01,440 --> 00:38:02,800
you're dealing with very technical

1103
00:38:02,800 --> 00:38:04,560
things you're talking about the way

1104
00:38:04,560 --> 00:38:06,560
adversaries are compromising

1105
00:38:06,560 --> 00:38:08,880
organizations the nuances to their

1106
00:38:08,880 --> 00:38:10,160
malware

1107
00:38:10,160 --> 00:38:11,920
you understand that the technical

1108
00:38:11,920 --> 00:38:13,920
stakeholders understand that the

1109
00:38:13,920 --> 00:38:15,760
consumers of your reports don't

1110
00:38:15,760 --> 00:38:17,599
necessarily need to understand that

1111
00:38:17,599 --> 00:38:19,280
unless this is a technical report and

1112
00:38:19,280 --> 00:38:20,480
that was the purpose of what you're

1113
00:38:20,480 --> 00:38:21,839
doing

1114
00:38:21,839 --> 00:38:23,760
have a style guide and follow it to

1115
00:38:23,760 --> 00:38:25,359
ensure the document is congruent

1116
00:38:25,359 --> 00:38:26,320
throughout

1117
00:38:26,320 --> 00:38:28,800
i've run into this a lot in my career

1118
00:38:28,800 --> 00:38:30,400
when you start having different size

1119
00:38:30,400 --> 00:38:33,119
fonts not everything is uniform

1120
00:38:33,119 --> 00:38:35,760
you you will get a very picky leader who

1121
00:38:35,760 --> 00:38:38,400
just will disregard your work because

1122
00:38:38,400 --> 00:38:40,560
you haven't followed a consistent flow

1123
00:38:40,560 --> 00:38:42,000
or format

1124
00:38:42,000 --> 00:38:43,760
sometimes organizations have this i

1125
00:38:43,760 --> 00:38:45,839
recommend having a person on your team

1126
00:38:45,839 --> 00:38:47,599
responsible for designing the style

1127
00:38:47,599 --> 00:38:49,599
guide following proper procedure for

1128
00:38:49,599 --> 00:38:52,320
building that out

1129
00:38:52,320 --> 00:38:54,240
it's important to stick to it if you've

1130
00:38:54,240 --> 00:38:55,520
built something out and this is the

1131
00:38:55,520 --> 00:38:56,640
understanding

1132
00:38:56,640 --> 00:38:58,880
then you use it if you want to change it

1133
00:38:58,880 --> 00:39:01,119
you hold a meeting you work with your

1134
00:39:01,119 --> 00:39:03,119
your team to say look this is what we

1135
00:39:03,119 --> 00:39:05,040
want to do so you don't have those

1136
00:39:05,040 --> 00:39:06,400
one-offs coming out because not

1137
00:39:06,400 --> 00:39:08,160
everyone's aware of the changes to the

1138
00:39:08,160 --> 00:39:10,000
style guide

1139
00:39:10,000 --> 00:39:12,000
i highly recommend seeking feedback on

1140
00:39:12,000 --> 00:39:14,560
the drafts that you share before you

1141
00:39:14,560 --> 00:39:15,760
share it out

1142
00:39:15,760 --> 00:39:17,680
highlight the success and failures as

1143
00:39:17,680 --> 00:39:18,480
well

1144
00:39:18,480 --> 00:39:20,720
so when you go through it's not all

1145
00:39:20,720 --> 00:39:22,560
sunshine and rainbows you need to call

1146
00:39:22,560 --> 00:39:25,280
out what has happened that was negative

1147
00:39:25,280 --> 00:39:26,640
because this is an opportunity for

1148
00:39:26,640 --> 00:39:28,640
improvement just because something

1149
00:39:28,640 --> 00:39:30,640
failed doesn't mean that it was the team

1150
00:39:30,640 --> 00:39:32,800
or the mission's fault you need to

1151
00:39:32,800 --> 00:39:34,960
understand the root cause of the issues

1152
00:39:34,960 --> 00:39:37,119
and where you can find improvement

1153
00:39:37,119 --> 00:39:39,040
no matter what success or failure you

1154
00:39:39,040 --> 00:39:41,119
can find improvement and

1155
00:39:41,119 --> 00:39:43,119
a way to get better and that's the end

1156
00:39:43,119 --> 00:39:44,400
of the day what these active

1157
00:39:44,400 --> 00:39:46,240
transmissions are about is getting

1158
00:39:46,240 --> 00:39:48,800
better at security

1159
00:39:48,800 --> 00:39:50,720
you need to include recognition and

1160
00:39:50,720 --> 00:39:52,000
share the credit with all members

1161
00:39:52,000 --> 00:39:52,960
involved

1162
00:39:52,960 --> 00:39:54,800
this is super important this is these

1163
00:39:54,800 --> 00:39:56,400
missions are a lot of work it's a

1164
00:39:56,400 --> 00:39:58,480
quarter of your time

1165
00:39:58,480 --> 00:40:00,880
there's a lot of benefit to doing them

1166
00:40:00,880 --> 00:40:02,800
make sure everyone's recognized

1167
00:40:02,800 --> 00:40:07,040
it'll ensure buy-in for future missions

1168
00:40:08,400 --> 00:40:11,040
continuing remember your target audience

1169
00:40:11,040 --> 00:40:12,800
so

1170
00:40:12,800 --> 00:40:14,480
if it's a technical audience you can

1171
00:40:14,480 --> 00:40:16,480
include technical information it's an

1172
00:40:16,480 --> 00:40:19,280
executive audience remember that as well

1173
00:40:19,280 --> 00:40:21,040
i would recommend

1174
00:40:21,040 --> 00:40:22,880
tailoring versions of your report to the

1175
00:40:22,880 --> 00:40:24,800
different audiences so maybe your

1176
00:40:24,800 --> 00:40:26,480
executives don't want to read a report

1177
00:40:26,480 --> 00:40:29,040
maybe they want powerpoint slides

1178
00:40:29,040 --> 00:40:30,800
it's not about you and the way you want

1179
00:40:30,800 --> 00:40:32,240
to report things it's about the way that

1180
00:40:32,240 --> 00:40:34,160
your consumers want to consume the

1181
00:40:34,160 --> 00:40:35,280
information

1182
00:40:35,280 --> 00:40:38,400
so tailor it that way

1183
00:40:38,400 --> 00:40:40,079
when reporting gap durations at the end

1184
00:40:40,079 --> 00:40:41,920
of the mission make sure to provide a

1185
00:40:41,920 --> 00:40:43,760
recommendation for fixing the issue or

1186
00:40:43,760 --> 00:40:45,119
filling the gap

1187
00:40:45,119 --> 00:40:47,040
some advice i got a long time ago when i

1188
00:40:47,040 --> 00:40:48,480
was a consultant

1189
00:40:48,480 --> 00:40:49,520
was

1190
00:40:49,520 --> 00:40:51,440
you want to leave your client with a

1191
00:40:51,440 --> 00:40:52,400
headache

1192
00:40:52,400 --> 00:40:53,440
you don't want to leave them with a

1193
00:40:53,440 --> 00:40:55,760
migraine and no aspirin

1194
00:40:55,760 --> 00:40:57,440
very rudimentary but

1195
00:40:57,440 --> 00:40:59,520
it persists here if you're going to call

1196
00:40:59,520 --> 00:41:01,200
out issues at the end of your mission or

1197
00:41:01,200 --> 00:41:02,319
something that's going on with your

1198
00:41:02,319 --> 00:41:04,720
organization and why you can't detect or

1199
00:41:04,720 --> 00:41:07,280
protect against an adversary then you

1200
00:41:07,280 --> 00:41:09,839
need to provide some way to fix it even

1201
00:41:09,839 --> 00:41:11,359
if the organization doesn't go with your

1202
00:41:11,359 --> 00:41:12,880
suggestion

1203
00:41:12,880 --> 00:41:14,480
you need to provide a way for the

1204
00:41:14,480 --> 00:41:16,960
organization to fix it to fill the gap

1205
00:41:16,960 --> 00:41:19,599
to make the organization better that's

1206
00:41:19,599 --> 00:41:23,440
your responsibility as a security team

1207
00:41:23,440 --> 00:41:25,280
so good recommendations are underpinned

1208
00:41:25,280 --> 00:41:27,119
by industry accepted methodologies of

1209
00:41:27,119 --> 00:41:28,319
frameworks

1210
00:41:28,319 --> 00:41:30,560
uh earlier i called out mitre attack

1211
00:41:30,560 --> 00:41:31,920
nist

1212
00:41:31,920 --> 00:41:34,640
i would also call it defend here try to

1213
00:41:34,640 --> 00:41:37,040
tie your recommendations to

1214
00:41:37,040 --> 00:41:39,200
industry standard

1215
00:41:39,200 --> 00:41:41,520
and accepted frameworks

1216
00:41:41,520 --> 00:41:44,640
it makes things easier when conveying

1217
00:41:44,640 --> 00:41:46,560
it makes sure that you get buy-in for

1218
00:41:46,560 --> 00:41:49,040
making those remediations

1219
00:41:49,040 --> 00:41:50,480
very rarely will you get someone to

1220
00:41:50,480 --> 00:41:52,720
argue against an approved framework like

1221
00:41:52,720 --> 00:41:54,640
this

1222
00:41:54,640 --> 00:41:57,200
always hold a post mission debrief with

1223
00:41:57,200 --> 00:41:59,359
the parties and who participated

1224
00:41:59,359 --> 00:42:01,119
i'm going to say one more time hold your

1225
00:42:01,119 --> 00:42:03,440
post mission debrief i know how

1226
00:42:03,440 --> 00:42:06,000
how busy internal security teams are i

1227
00:42:06,000 --> 00:42:08,000
live it on a day-to-day basis

1228
00:42:08,000 --> 00:42:09,680
even if it has to be two or three weeks

1229
00:42:09,680 --> 00:42:11,119
out

1230
00:42:11,119 --> 00:42:12,960
take the opportunity to celebrate the

1231
00:42:12,960 --> 00:42:14,000
success

1232
00:42:14,000 --> 00:42:15,520
learn from the failures and just get

1233
00:42:15,520 --> 00:42:17,599
everybody in the room

1234
00:42:17,599 --> 00:42:19,040
you'll hear things that you weren't

1235
00:42:19,040 --> 00:42:21,520
expecting you don't know what everyone's

1236
00:42:21,520 --> 00:42:22,720
thinking so

1237
00:42:22,720 --> 00:42:24,319
getting an opportunity for everyone to

1238
00:42:24,319 --> 00:42:26,319
share their thoughts and ideas for

1239
00:42:26,319 --> 00:42:27,920
improvement they'll make your next

1240
00:42:27,920 --> 00:42:29,040
mission

1241
00:42:29,040 --> 00:42:31,839
way way better

1242
00:42:32,160 --> 00:42:34,240
so when you're looking at lessons

1243
00:42:34,240 --> 00:42:36,240
learned in an active act after action

1244
00:42:36,240 --> 00:42:37,599
report or

1245
00:42:37,599 --> 00:42:40,720
again your recap so what happened what

1246
00:42:40,720 --> 00:42:42,960
was supposed to happen what can we learn

1247
00:42:42,960 --> 00:42:46,000
about it why was there a difference

1248
00:42:46,000 --> 00:42:47,920
you want to segment your

1249
00:42:47,920 --> 00:42:49,839
observed facts and the evidence that you

1250
00:42:49,839 --> 00:42:53,040
have on why things failed with opinions

1251
00:42:53,040 --> 00:42:54,160
everybody's going to have an opinion

1252
00:42:54,160 --> 00:42:56,960
when somebody when something fails

1253
00:42:56,960 --> 00:42:58,720
you do take stock in that as well but

1254
00:42:58,720 --> 00:43:00,960
you separate the two these are the facts

1255
00:43:00,960 --> 00:43:03,440
of the situation this is what happened

1256
00:43:03,440 --> 00:43:05,440
this is what the beliefs and opinions

1257
00:43:05,440 --> 00:43:08,079
are this is how we suggest to improve it

1258
00:43:08,079 --> 00:43:10,079
here are the facts on improvement and

1259
00:43:10,079 --> 00:43:12,640
here are the suggestions or opinions on

1260
00:43:12,640 --> 00:43:15,118
improvement

1261
00:43:15,839 --> 00:43:18,640
question and answer

1262
00:43:19,119 --> 00:43:21,440
again thank you all so much for coming

1263
00:43:21,440 --> 00:43:22,960
out and listening to my presentation

1264
00:43:22,960 --> 00:43:25,599
today i'm happy to take any questions

1265
00:43:25,599 --> 00:43:27,760
you have and thank you all very very

1266
00:43:27,760 --> 00:43:30,760
much

