1
00:00:03,360 --> 00:00:05,759
hello everyone and welcome to this talk

2
00:00:05,759 --> 00:00:08,160
title knocking on heaven's door not

3
00:00:08,160 --> 00:00:10,400
sketch that knocking on cloud store

4
00:00:10,400 --> 00:00:12,559
because we'll be talking you know like

5
00:00:12,559 --> 00:00:14,639
all about trenting in a cloud

6
00:00:14,639 --> 00:00:17,039
specifically a 080 and how you can use a

7
00:00:17,039 --> 00:00:19,520
tool called azula created by me

8
00:00:19,520 --> 00:00:21,760
to help you you know with your

9
00:00:21,760 --> 00:00:24,160
challenging operation and i'm tas task

10
00:00:24,160 --> 00:00:27,119
manager on twitter uh let's go

11
00:00:27,119 --> 00:00:29,039
so quick disclaimer

12
00:00:29,039 --> 00:00:30,640
the opinions expressed in this

13
00:00:30,640 --> 00:00:32,960
presentation are solely mine so i'm not

14
00:00:32,960 --> 00:00:35,280
necessarily my employer

15
00:00:35,280 --> 00:00:36,079
and

16
00:00:36,079 --> 00:00:38,719
this talk is not sponsored whatsoever by

17
00:00:38,719 --> 00:00:40,800
microsoft nor is this a product pitch so

18
00:00:40,800 --> 00:00:43,440
this is all pure my experience when i'm

19
00:00:43,440 --> 00:00:46,480
using microsoft azure technology

20
00:00:46,480 --> 00:00:49,039
so let's let's you know like i have some

21
00:00:49,039 --> 00:00:51,520
introduction with myself like i'm test

22
00:00:51,520 --> 00:00:54,000
task manager interior as i mentioned i'm

23
00:00:54,000 --> 00:00:56,000
currently working as a senior consultant

24
00:00:56,000 --> 00:00:56,960
and

25
00:00:56,960 --> 00:01:00,160
big four um consulting firm uh

26
00:01:00,160 --> 00:01:02,239
performing tasks within their managed

27
00:01:02,239 --> 00:01:04,159
detection response service

28
00:01:04,159 --> 00:01:05,519
uh so i'm

29
00:01:05,519 --> 00:01:07,360
you know like responsible handling their

30
00:01:07,360 --> 00:01:09,280
detection engineering threat hunting

31
00:01:09,280 --> 00:01:11,680
trial research on top of that we need to

32
00:01:11,680 --> 00:01:13,920
escalate some of the findings that we do

33
00:01:13,920 --> 00:01:17,680
fine and we'll do dfir and you know like

34
00:01:17,680 --> 00:01:19,439
on top of that you know like these days

35
00:01:19,439 --> 00:01:21,360
automation is everything so that's also

36
00:01:21,360 --> 00:01:23,040
one of my responsibilities

37
00:01:23,040 --> 00:01:25,439
i really enjoy being in the community

38
00:01:25,439 --> 00:01:27,920
i'm a contributor for the dfir report so

39
00:01:27,920 --> 00:01:30,240
if you notice that one uh you know

40
00:01:30,240 --> 00:01:32,400
twitter account that keep posting about

41
00:01:32,400 --> 00:01:34,159
you know breaches and then they listed

42
00:01:34,159 --> 00:01:36,640
all the ttps all the iuc so i'm part of

43
00:01:36,640 --> 00:01:38,000
the contributor

44
00:01:38,000 --> 00:01:41,600
uh i'm also a contributor for oecd which

45
00:01:41,600 --> 00:01:43,840
is open source detection community uh

46
00:01:43,840 --> 00:01:46,799
cdf.ide it's indonesian uh cybersecurity

47
00:01:46,799 --> 00:01:48,079
where i'm from

48
00:01:48,079 --> 00:01:49,439
originally

49
00:01:49,439 --> 00:01:52,159
and certain college is a session member

50
00:01:52,159 --> 00:01:54,960
i'm actually wearing their like thirsty

51
00:01:54,960 --> 00:01:57,759
like uh you know like uh hoodie

52
00:01:57,759 --> 00:02:00,799
uh and yeah i also love presenting as

53
00:02:00,799 --> 00:02:02,399
you can see why i'm here presenting

54
00:02:02,399 --> 00:02:04,240
sharing my knowledge with everybody else

55
00:02:04,240 --> 00:02:05,600
and i've presented before in the

56
00:02:05,600 --> 00:02:07,439
numerous uh international conferences

57
00:02:07,439 --> 00:02:08,720
also

58
00:02:08,720 --> 00:02:10,479
so outside of work outside of cyber

59
00:02:10,479 --> 00:02:13,360
security i love doing fun

60
00:02:13,360 --> 00:02:16,080
and eating good food

61
00:02:16,080 --> 00:02:19,040
so i i do enjoy photography specifically

62
00:02:19,040 --> 00:02:20,879
astrophotography and landscape

63
00:02:20,879 --> 00:02:22,879
photography and those are some of my

64
00:02:22,879 --> 00:02:25,840
racing recent texts uh i love to do fun

65
00:02:25,840 --> 00:02:29,200
stuff new stuff atv i like shootings i

66
00:02:29,200 --> 00:02:31,680
love good food i do cook and as i

67
00:02:31,680 --> 00:02:33,200
mentioned before i'm from indonesia and

68
00:02:33,200 --> 00:02:36,480
we are really common with good food so

69
00:02:36,480 --> 00:02:37,920
if you're gonna try something new maybe

70
00:02:37,920 --> 00:02:39,440
thanks next restaurant new video it's

71
00:02:39,440 --> 00:02:41,760
gonna be indonesian restaurant um

72
00:02:41,760 --> 00:02:42,879
proficient

73
00:02:42,879 --> 00:02:45,280
in apparently more proficient in memes

74
00:02:45,280 --> 00:02:46,879
compared to minor attack which is kind

75
00:02:46,879 --> 00:02:49,360
of funny but we'll see how it is uh

76
00:02:49,360 --> 00:02:51,680
going in the next few slides

77
00:02:51,680 --> 00:02:54,080
uh so who are you exactly so

78
00:02:54,080 --> 00:02:56,239
uh let's talk about you right so you're

79
00:02:56,239 --> 00:02:59,040
probably a defender or a red teamer or

80
00:02:59,040 --> 00:03:00,879
just like me detection engineer who try

81
00:03:00,879 --> 00:03:03,680
wanna build detection uh sometimes

82
00:03:03,680 --> 00:03:05,519
you can think okay this presentation is

83
00:03:05,519 --> 00:03:07,440
pretty good we use azure id blah blah

84
00:03:07,440 --> 00:03:09,599
blah maybe your boss think about that

85
00:03:09,599 --> 00:03:11,760
and you have to go to this one now uh

86
00:03:11,760 --> 00:03:13,599
maybe you just get the

87
00:03:13,599 --> 00:03:15,360
you know like uh

88
00:03:15,360 --> 00:03:17,920
the reference the guts and roses title

89
00:03:17,920 --> 00:03:20,400
or the azula which is coming from you

90
00:03:20,400 --> 00:03:23,120
know like avatar the last airbender uh

91
00:03:23,120 --> 00:03:25,280
like a nickelodeon cartoon

92
00:03:25,280 --> 00:03:27,360
or maybe you just lost you're not sure

93
00:03:27,360 --> 00:03:29,280
what top to watch and you just stumbled

94
00:03:29,280 --> 00:03:31,599
upon this talk but please stay

95
00:03:31,599 --> 00:03:33,120
um

96
00:03:33,120 --> 00:03:35,200
make sure that you learn something new

97
00:03:35,200 --> 00:03:36,560
uh yeah

98
00:03:36,560 --> 00:03:37,440
so

99
00:03:37,440 --> 00:03:39,040
why are you here today so these are the

100
00:03:39,040 --> 00:03:40,239
topics that we're gonna talk today i

101
00:03:40,239 --> 00:03:42,000
will introduce you to

102
00:03:42,000 --> 00:03:43,840
myself everything else which we already

103
00:03:43,840 --> 00:03:46,080
done uh i'll introduce you to the azure

104
00:03:46,080 --> 00:03:48,799
80. so you're under you understand what

105
00:03:48,799 --> 00:03:52,000
is azure 80 compared to traditional 80

106
00:03:52,000 --> 00:03:54,319
uh regarding the reports azure id

107
00:03:54,319 --> 00:03:56,560
reports which is the logging mechanism

108
00:03:56,560 --> 00:03:58,319
of the azure 80 itself

109
00:03:58,319 --> 00:04:00,480
and then let's jump to like how can we

110
00:04:00,480 --> 00:04:03,599
tread han using these reports and then

111
00:04:03,599 --> 00:04:05,920
i'll take you to a quick demo of my

112
00:04:05,920 --> 00:04:08,560
tools azula uh based on python all the

113
00:04:08,560 --> 00:04:10,959
details will be there um all the

114
00:04:10,959 --> 00:04:13,840
features will be there and lastly we'll

115
00:04:13,840 --> 00:04:16,238
go to closing we'll have uh some you

116
00:04:16,238 --> 00:04:17,839
know some notes

117
00:04:17,839 --> 00:04:18,959
and

118
00:04:18,959 --> 00:04:19,918
yeah

119
00:04:19,918 --> 00:04:21,600
and then at the end of course we'll have

120
00:04:21,600 --> 00:04:23,919
some time for question i'll be in the

121
00:04:23,919 --> 00:04:26,800
uh you know like discord room uh ready

122
00:04:26,800 --> 00:04:28,639
to answer all your questions looking

123
00:04:28,639 --> 00:04:30,639
forward to that

124
00:04:30,639 --> 00:04:33,520
so let's talk about azure 80. so

125
00:04:33,520 --> 00:04:34,320
very

126
00:04:34,320 --> 00:04:35,840
very likely you're here you're already

127
00:04:35,840 --> 00:04:37,360
familiar with your id and you just want

128
00:04:37,360 --> 00:04:39,600
to improve your security but i don't

129
00:04:39,600 --> 00:04:41,120
want to assume that so i'm going to

130
00:04:41,120 --> 00:04:43,040
introduce you know maybe some of you to

131
00:04:43,040 --> 00:04:45,280
a new concept called azure 80. so this

132
00:04:45,280 --> 00:04:47,520
is this is an

133
00:04:47,520 --> 00:04:49,600
active directory concept that is a

134
00:04:49,600 --> 00:04:50,720
little bit different compared to

135
00:04:50,720 --> 00:04:52,400
traditional

136
00:04:52,400 --> 00:04:55,759
because azure 80 are now in cloud so

137
00:04:55,759 --> 00:04:58,479
it's not your on-premise old-school you

138
00:04:58,479 --> 00:05:01,360
know like 80 environment so

139
00:05:01,360 --> 00:05:03,600
uh on top of that because it's on azure

140
00:05:03,600 --> 00:05:05,759
microsoft azure it's connected to other

141
00:05:05,759 --> 00:05:08,160
azure services we can we are talking

142
00:05:08,160 --> 00:05:11,199
about hr systems i am etc

143
00:05:11,199 --> 00:05:14,160
um and then they call those stuff now as

144
00:05:14,160 --> 00:05:17,840
an apps so not not anymore like uh

145
00:05:17,840 --> 00:05:19,440
you know like uh you know like

146
00:05:19,440 --> 00:05:22,639
components or like uh devices so these

147
00:05:22,639 --> 00:05:25,440
are all apps which is the future for

148
00:05:25,440 --> 00:05:26,720
cloud stuff

149
00:05:26,720 --> 00:05:28,240
uh

150
00:05:28,240 --> 00:05:30,639
and yeah you can actually include

151
00:05:30,639 --> 00:05:32,400
a lot of stuff in it we are talking

152
00:05:32,400 --> 00:05:35,120
about mobile devices computers of course

153
00:05:35,120 --> 00:05:37,440
of course you can include computers uh

154
00:05:37,440 --> 00:05:40,479
servers vms kubernetes like all those

155
00:05:40,479 --> 00:05:42,720
fancy new stuff yeah you can do that you

156
00:05:42,720 --> 00:05:44,320
can include apps of course because

157
00:05:44,320 --> 00:05:45,840
that's the future of it so we can

158
00:05:45,840 --> 00:05:47,919
include a lot of stuff compared to you

159
00:05:47,919 --> 00:05:49,680
know just windows to bring system

160
00:05:49,680 --> 00:05:52,479
devices back on the traditional 80.

161
00:05:52,479 --> 00:05:55,520
uh another differences will be azure you

162
00:05:55,520 --> 00:05:57,440
will face internet because that's how

163
00:05:57,440 --> 00:05:58,960
cloud works

164
00:05:58,960 --> 00:06:01,039
the question is will it be less secure

165
00:06:01,039 --> 00:06:04,319
or is it even more secure so we will see

166
00:06:04,319 --> 00:06:07,360
we'll answer that question pretty soon

167
00:06:07,360 --> 00:06:11,039
uh and then yeah there's no more domain

168
00:06:11,039 --> 00:06:12,720
groups you call it your roles and

169
00:06:12,720 --> 00:06:15,120
there's like pin on top of that

170
00:06:15,120 --> 00:06:17,199
you're not only using password but now

171
00:06:17,199 --> 00:06:19,360
you're using intelligent password

172
00:06:19,360 --> 00:06:21,440
you're using of course the mfa

173
00:06:21,440 --> 00:06:23,280
passwordless authentication if you're

174
00:06:23,280 --> 00:06:24,319
able to

175
00:06:24,319 --> 00:06:26,080
uh you know and then for the

176
00:06:26,080 --> 00:06:28,000
authentication authentication options

177
00:06:28,000 --> 00:06:30,160
you get samo open id

178
00:06:30,160 --> 00:06:31,120
all out

179
00:06:31,120 --> 00:06:33,600
federation ws which is completely

180
00:06:33,600 --> 00:06:35,840
different than you know like kerberos

181
00:06:35,840 --> 00:06:37,440
and tlm like those stuff on the

182
00:06:37,440 --> 00:06:38,960
traditional nd

183
00:06:38,960 --> 00:06:41,199
microsoft graph or azure edit graph will

184
00:06:41,199 --> 00:06:44,240
be used mainly uh to manage this uh you

185
00:06:44,240 --> 00:06:47,600
know like uh azure 80 system and then

186
00:06:47,600 --> 00:06:50,560
external users uh now known as guests

187
00:06:50,560 --> 00:06:52,720
instead of normally being called charts

188
00:06:52,720 --> 00:06:54,479
on a traditional 80.

189
00:06:54,479 --> 00:06:56,639
in terms of first assessment of zero 80

190
00:06:56,639 --> 00:06:58,560
if you're comparing it with the windows

191
00:06:58,560 --> 00:07:00,720
so you get azure 8 on the left on top of

192
00:07:00,720 --> 00:07:03,520
that i also added office 365

193
00:07:03,520 --> 00:07:05,440
compared to windows metric so you can

194
00:07:05,440 --> 00:07:06,240
see

195
00:07:06,240 --> 00:07:08,560
uh there's definitely more

196
00:07:08,560 --> 00:07:10,560
techniques ttp's

197
00:07:10,560 --> 00:07:13,360
tactics even in the windows metrics but

198
00:07:13,360 --> 00:07:14,840
but the question

199
00:07:14,840 --> 00:07:16,960
is uh

200
00:07:16,960 --> 00:07:19,919
yeah is it really reflected so of course

201
00:07:19,919 --> 00:07:21,440
this is over simplification but from

202
00:07:21,440 --> 00:07:23,520
here we can actually see that

203
00:07:23,520 --> 00:07:26,319
uh azure 80 have flash attack factor we

204
00:07:26,319 --> 00:07:27,599
can say

205
00:07:27,599 --> 00:07:28,840
but

206
00:07:28,840 --> 00:07:31,680
i had some talk with uh people from

207
00:07:31,680 --> 00:07:34,080
microsoft and it's really interesting uh

208
00:07:34,080 --> 00:07:37,120
the way we approach uh you know like uh

209
00:07:37,120 --> 00:07:38,960
a cloud we shouldn't approach it like

210
00:07:38,960 --> 00:07:41,280
the you know on-premise but we'll we'll

211
00:07:41,280 --> 00:07:42,880
talk about it maybe later on in the

212
00:07:42,880 --> 00:07:44,479
other occasion

213
00:07:44,479 --> 00:07:45,280
so

214
00:07:45,280 --> 00:07:46,720
john lambert

215
00:07:46,720 --> 00:07:49,840
vp of mystic uh through intelligence

216
00:07:49,840 --> 00:07:52,160
center for microsoft say

217
00:07:52,160 --> 00:07:54,000
uh defenders think and list attack our

218
00:07:54,000 --> 00:07:56,319
things in graph as long as this is true

219
00:07:56,319 --> 00:08:00,240
attackers win which is true

220
00:08:00,240 --> 00:08:02,639
so that's the defenders we need to you

221
00:08:02,639 --> 00:08:05,440
know overhaul the way we think

222
00:08:05,440 --> 00:08:07,840
uh so we need to think and craft so we

223
00:08:07,840 --> 00:08:09,840
initial access will connect the rest of

224
00:08:09,840 --> 00:08:12,240
the tactics with the attackers attackers

225
00:08:12,240 --> 00:08:14,240
coming from the outside

226
00:08:14,240 --> 00:08:16,560
and then they need to access the system

227
00:08:16,560 --> 00:08:18,560
so from there if you stop them on the

228
00:08:18,560 --> 00:08:23,520
initial access it will be more important

229
00:08:23,759 --> 00:08:25,360
you know it will be

230
00:08:25,360 --> 00:08:26,960
better to stop them there and then we

231
00:08:26,960 --> 00:08:28,639
can actually worry less on the other

232
00:08:28,639 --> 00:08:29,919
part

233
00:08:29,919 --> 00:08:31,680
of the matrix

234
00:08:31,680 --> 00:08:33,599
so some attack factors

235
00:08:33,599 --> 00:08:35,679
uh before initial axis after initial

236
00:08:35,679 --> 00:08:37,919
axis but i want to highlight the the one

237
00:08:37,919 --> 00:08:39,039
in red

238
00:08:39,039 --> 00:08:42,159
non-mfa legacy users

239
00:08:42,159 --> 00:08:44,720
so this is commonly being brute force

240
00:08:44,720 --> 00:08:47,200
uh mfa user negligence sometimes you

241
00:08:47,200 --> 00:08:48,959
have mfa but the user doesn't really

242
00:08:48,959 --> 00:08:50,240
understand what it is so they just

243
00:08:50,240 --> 00:08:52,720
accept random mfa requests

244
00:08:52,720 --> 00:08:55,279
it sounds stupid but it happens not once

245
00:08:55,279 --> 00:08:57,360
not twice multiple times

246
00:08:57,360 --> 00:08:59,839
uh on the real world scenario so real

247
00:08:59,839 --> 00:09:01,440
employees doing that

248
00:09:01,440 --> 00:09:03,600
uh so you get alerts you get a logging

249
00:09:03,600 --> 00:09:06,240
that you don't monitor normally to do

250
00:09:06,240 --> 00:09:07,680
stuff above so that's kind of something

251
00:09:07,680 --> 00:09:09,680
that you miss you need to you know like

252
00:09:09,680 --> 00:09:11,839
start paying attention to

253
00:09:11,839 --> 00:09:13,839
credential staffing you know

254
00:09:13,839 --> 00:09:16,000
people got bridge uh

255
00:09:16,000 --> 00:09:18,000
and they are using same credentials with

256
00:09:18,000 --> 00:09:20,080
the one in your company so they are

257
00:09:20,080 --> 00:09:22,640
using the same credentials to get into

258
00:09:22,640 --> 00:09:25,200
your company and of course we've seen

259
00:09:25,200 --> 00:09:26,640
quite a lot of

260
00:09:26,640 --> 00:09:27,440
uh

261
00:09:27,440 --> 00:09:28,399
like

262
00:09:28,399 --> 00:09:30,160
pretty high increase in the brute force

263
00:09:30,160 --> 00:09:31,519
base attack

264
00:09:31,519 --> 00:09:34,000
brute force password spray

265
00:09:34,000 --> 00:09:36,320
one of the presentation from microsoft

266
00:09:36,320 --> 00:09:38,720
person in sans blue team actually

267
00:09:38,720 --> 00:09:40,959
mentioned 230 percent increase in

268
00:09:40,959 --> 00:09:43,920
password state attacks in the last

269
00:09:43,920 --> 00:09:45,920
few period of time which is really high

270
00:09:45,920 --> 00:09:48,000
so we might want to start focusing on

271
00:09:48,000 --> 00:09:50,800
that making sure that uh

272
00:09:50,800 --> 00:09:52,720
we got no user being compromised from

273
00:09:52,720 --> 00:09:54,080
that attack

274
00:09:54,080 --> 00:09:56,800
so protection mechanism from azure 80 we

275
00:09:56,800 --> 00:09:57,920
have quite

276
00:09:57,920 --> 00:09:59,120
a lot of them

277
00:09:59,120 --> 00:10:00,399
of course

278
00:10:00,399 --> 00:10:04,399
we got of course the infamous mfa

279
00:10:04,399 --> 00:10:06,560
we get conditional access policy which

280
00:10:06,560 --> 00:10:09,040
is of course you need to adjust it first

281
00:10:09,040 --> 00:10:12,160
before you are using it right away

282
00:10:12,160 --> 00:10:14,560
uh attack surface reduction which is

283
00:10:14,560 --> 00:10:17,360
pretty neat so

284
00:10:17,360 --> 00:10:19,680
the the door let's say let's call it the

285
00:10:19,680 --> 00:10:21,600
door the door will be available just in

286
00:10:21,600 --> 00:10:23,839
time when you need to use it so a fader

287
00:10:23,839 --> 00:10:25,760
time it's not gonna be there which is

288
00:10:25,760 --> 00:10:27,760
pretty cool uh blocking legacy

289
00:10:27,760 --> 00:10:29,600
authentication uh as i mentioned like

290
00:10:29,600 --> 00:10:31,360
this authentication often get brute

291
00:10:31,360 --> 00:10:34,560
force if we can stop you know

292
00:10:34,560 --> 00:10:35,519
uh

293
00:10:35,519 --> 00:10:37,839
people logging in from those legacy

294
00:10:37,839 --> 00:10:39,680
authentication application will be

295
00:10:39,680 --> 00:10:41,600
secure for us for sure you can go

296
00:10:41,600 --> 00:10:44,000
passwordless whenever you're ready a lot

297
00:10:44,000 --> 00:10:45,920
of preparation needs to be done on that

298
00:10:45,920 --> 00:10:47,120
uh

299
00:10:47,120 --> 00:10:48,320
and then the last three would be the one

300
00:10:48,320 --> 00:10:50,240
that we're gonna talk most like they got

301
00:10:50,240 --> 00:10:52,959
all-in-one security portal

302
00:10:52,959 --> 00:10:55,279
and some other security solution uh that

303
00:10:55,279 --> 00:10:56,399
you can use

304
00:10:56,399 --> 00:10:58,720
under microsoft products uh

305
00:10:58,720 --> 00:11:00,560
wrist detection so this is like machine

306
00:11:00,560 --> 00:11:02,480
learning model uh called azure id

307
00:11:02,480 --> 00:11:04,720
identity protection automation that will

308
00:11:04,720 --> 00:11:08,160
detect risky sign-ins risky user and

309
00:11:08,160 --> 00:11:10,079
then yeah on top of that you'll

310
00:11:10,079 --> 00:11:11,920
everything will be recorded in your

311
00:11:11,920 --> 00:11:13,839
locks in the reporting as already

312
00:11:13,839 --> 00:11:15,600
reporting so you get audit locks

313
00:11:15,600 --> 00:11:17,839
whatever change in them in the system

314
00:11:17,839 --> 00:11:19,440
assigning logs

315
00:11:19,440 --> 00:11:21,680
everybody coming in everybody you know

316
00:11:21,680 --> 00:11:24,320
like trying to sign in fail successfully

317
00:11:24,320 --> 00:11:26,720
will be recorded and a risky user just

318
00:11:26,720 --> 00:11:29,279
based on the the risk detection above it

319
00:11:29,279 --> 00:11:32,480
will tell you if this user is actually

320
00:11:32,480 --> 00:11:34,560
suspicious or not

321
00:11:34,560 --> 00:11:36,000
so that this is signature from the

322
00:11:36,000 --> 00:11:37,760
microsoft so like israeli protection

323
00:11:37,760 --> 00:11:40,320
summarized i got four of them already

324
00:11:40,320 --> 00:11:42,800
listed down there

325
00:11:42,800 --> 00:11:45,440
as already ml recitation we'll talk more

326
00:11:45,440 --> 00:11:46,560
about it

327
00:11:46,560 --> 00:11:47,760
later

328
00:11:47,760 --> 00:11:50,720
uh let's talk about azure 80

329
00:11:50,720 --> 00:11:52,720
reports now and then see like what's

330
00:11:52,720 --> 00:11:54,240
going on here right

331
00:11:54,240 --> 00:11:57,279
so what is azure report so as simple as

332
00:11:57,279 --> 00:11:59,519
it's profiling you would comprehend a

333
00:11:59,519 --> 00:12:00,399
few

334
00:12:00,399 --> 00:12:02,079
of all the activities in your

335
00:12:02,079 --> 00:12:04,800
environment so there's different type of

336
00:12:04,800 --> 00:12:06,639
reports such as

337
00:12:06,639 --> 00:12:09,120
user flight for race

338
00:12:09,120 --> 00:12:10,560
because they are you know performing

339
00:12:10,560 --> 00:12:13,200
certain combination of risky activities

340
00:12:13,200 --> 00:12:17,440
uh risky signing reports uh which is

341
00:12:17,440 --> 00:12:18,880
you know

342
00:12:18,880 --> 00:12:21,279
uh obtained from their signings report

343
00:12:21,279 --> 00:12:23,279
they contain majority same information

344
00:12:23,279 --> 00:12:25,600
but on the risky signings you'll have

345
00:12:25,600 --> 00:12:27,200
you know like recently related

346
00:12:27,200 --> 00:12:29,120
information and i will get audit logs to

347
00:12:29,120 --> 00:12:30,480
help you with like

348
00:12:30,480 --> 00:12:33,440
uh what happened when a user sign in or

349
00:12:33,440 --> 00:12:35,760
is there any action taken inside

350
00:12:35,760 --> 00:12:38,160
so the beauty of this all reports are

351
00:12:38,160 --> 00:12:40,639
interconnected so you can connect it for

352
00:12:40,639 --> 00:12:42,720
example by ip address you can connect it

353
00:12:42,720 --> 00:12:43,760
by

354
00:12:43,760 --> 00:12:46,079
the user you know like email or

355
00:12:46,079 --> 00:12:48,720
principal username they call it

356
00:12:48,720 --> 00:12:49,680
and then

357
00:12:49,680 --> 00:12:51,279
you can even connect it to some other

358
00:12:51,279 --> 00:12:53,360
external resources all three

359
00:12:53,360 --> 00:12:56,160
365 logs you can actually see once they

360
00:12:56,160 --> 00:12:58,240
logged in you get the ip and then you

361
00:12:58,240 --> 00:13:00,079
correlate the ip with the activity in

362
00:13:00,079 --> 00:13:03,200
the o365 logs and you can say okay these

363
00:13:03,200 --> 00:13:05,040
user delete certain emails after they're

364
00:13:05,040 --> 00:13:07,279
logged in so is this

365
00:13:07,279 --> 00:13:08,800
suspicious or not so it's up to you to

366
00:13:08,800 --> 00:13:10,480
decide later

367
00:13:10,480 --> 00:13:13,600
how do you access azure id reports

368
00:13:13,600 --> 00:13:15,600
there's several ways the easiest way

369
00:13:15,600 --> 00:13:17,040
just go to the

370
00:13:17,040 --> 00:13:19,200
ad as your id menu and go to the

371
00:13:19,200 --> 00:13:21,839
monitoring section as seen in the

372
00:13:21,839 --> 00:13:23,040
screenshot

373
00:13:23,040 --> 00:13:25,920
in the slide you can analyze it using

374
00:13:25,920 --> 00:13:28,560
api and then you can you know play with

375
00:13:28,560 --> 00:13:29,279
it

376
00:13:29,279 --> 00:13:30,880
on the sentinel

377
00:13:30,880 --> 00:13:33,040
another processing and instruction is

378
00:13:33,040 --> 00:13:35,200
there or you can actually see the data

379
00:13:35,200 --> 00:13:37,839
in life you stream it to your scene

380
00:13:37,839 --> 00:13:39,360
uh you can build detection and stuff of

381
00:13:39,360 --> 00:13:41,600
that so there's a lot of guide available

382
00:13:41,600 --> 00:13:44,079
for reservation monitor logs arc sites

383
00:13:44,079 --> 00:13:45,600
plug elastic

384
00:13:45,600 --> 00:13:47,839
uh by utilizing file game so all the

385
00:13:47,839 --> 00:13:50,480
data presented here are using

386
00:13:50,480 --> 00:13:54,639
uh elastico dfe uh which is the

387
00:13:54,639 --> 00:13:58,959
amazon branch of the elastic

388
00:13:58,959 --> 00:14:01,199
so four different you know azure reports

389
00:14:01,199 --> 00:14:04,560
as i mentioned before user flag for is

390
00:14:04,560 --> 00:14:07,839
whenever users are you know dm risk

391
00:14:07,839 --> 00:14:09,920
risky by the azure id machine learning

392
00:14:09,920 --> 00:14:11,680
it will flag it as that

393
00:14:11,680 --> 00:14:14,320
uh there are additional sources such as

394
00:14:14,320 --> 00:14:17,279
straight intel or leak credentials uh

395
00:14:17,279 --> 00:14:18,959
that will help

396
00:14:18,959 --> 00:14:20,480
you know the machine learning with that

397
00:14:20,480 --> 00:14:22,079
so we don't we're not gonna talk about

398
00:14:22,079 --> 00:14:23,360
it too much here

399
00:14:23,360 --> 00:14:25,360
uh we get you know i'm gonna jump to the

400
00:14:25,360 --> 00:14:27,839
last one signings so continual sign

401
00:14:27,839 --> 00:14:29,279
information

402
00:14:29,279 --> 00:14:31,920
who is sending in what's the ip you know

403
00:14:31,920 --> 00:14:34,000
like from which device

404
00:14:34,000 --> 00:14:36,240
uh you know is it interactive or not

405
00:14:36,240 --> 00:14:38,399
fail or success is the mfa single factor

406
00:14:38,399 --> 00:14:40,880
i will tell you there

407
00:14:40,880 --> 00:14:43,120
so this can be used to track sign in

408
00:14:43,120 --> 00:14:44,399
pattern you know you can create

409
00:14:44,399 --> 00:14:46,720
statistic you can create baseline for

410
00:14:46,720 --> 00:14:49,279
example okay 50 000 users sign in every

411
00:14:49,279 --> 00:14:51,360
month suddenly we are seeing

412
00:14:51,360 --> 00:14:53,440
less user maybe there's some problem you

413
00:14:53,440 --> 00:14:54,959
know on your

414
00:14:54,959 --> 00:14:57,600
uh azure ad management

415
00:14:57,600 --> 00:14:59,519
user management site so this actually

416
00:14:59,519 --> 00:15:01,760
can help you not only security but even

417
00:15:01,760 --> 00:15:04,800
like more to like uh management

418
00:15:04,800 --> 00:15:07,440
monitoring so risky signing on top of

419
00:15:07,440 --> 00:15:09,760
that you will have you know the risky

420
00:15:09,760 --> 00:15:12,959
model available for you that will flags

421
00:15:12,959 --> 00:15:15,360
instead of user it will flag sign-ins so

422
00:15:15,360 --> 00:15:16,959
for example this sign-in from this

423
00:15:16,959 --> 00:15:18,959
appears from for example

424
00:15:18,959 --> 00:15:21,279
um country indonesia you don't have you

425
00:15:21,279 --> 00:15:23,120
know like user indonesia you're not

426
00:15:23,120 --> 00:15:24,000
supposed to

427
00:15:24,000 --> 00:15:26,639
see any of that

428
00:15:26,639 --> 00:15:28,240
and then yeah from there you determine

429
00:15:28,240 --> 00:15:30,480
if it's legitimate or not

430
00:15:30,480 --> 00:15:31,600
it could be

431
00:15:31,600 --> 00:15:33,680
either real time or offline it will take

432
00:15:33,680 --> 00:15:37,120
two to one day two hour to one day delay

433
00:15:37,120 --> 00:15:39,839
uh for medium and high

434
00:15:39,839 --> 00:15:41,360
risky signings

435
00:15:41,360 --> 00:15:43,600
it's available for everyone but

436
00:15:43,600 --> 00:15:45,759
for the low one only available for a p2

437
00:15:45,759 --> 00:15:47,199
license which is the most expensive

438
00:15:47,199 --> 00:15:48,480
license for

439
00:15:48,480 --> 00:15:49,920
azure 80.

440
00:15:49,920 --> 00:15:51,680
for the audit locks

441
00:15:51,680 --> 00:15:53,360
it's just as simple as like what's going

442
00:15:53,360 --> 00:15:55,040
on in your

443
00:15:55,040 --> 00:15:57,279
system in terms of management's changes

444
00:15:57,279 --> 00:15:59,519
performed by users and also admins so

445
00:15:59,519 --> 00:16:03,519
it's just available or like all licenses

446
00:16:03,519 --> 00:16:06,320
so signing

447
00:16:06,560 --> 00:16:09,120
logs so we have important attributes of

448
00:16:09,120 --> 00:16:10,079
course

449
00:16:10,079 --> 00:16:11,680
um well

450
00:16:11,680 --> 00:16:13,360
one thing that we want to see of course

451
00:16:13,360 --> 00:16:14,800
from there

452
00:16:14,800 --> 00:16:16,399
it is

453
00:16:16,399 --> 00:16:17,600
uh that

454
00:16:17,600 --> 00:16:19,839
ipaddress which i appear as is trying to

455
00:16:19,839 --> 00:16:23,360
log into my cloud you know like domain

456
00:16:23,360 --> 00:16:24,480
and then they get some enrich

457
00:16:24,480 --> 00:16:27,120
information like location-wise countries

458
00:16:27,120 --> 00:16:29,279
uh i think the new one they also provide

459
00:16:29,279 --> 00:16:32,480
asn so like autonomous

460
00:16:32,480 --> 00:16:33,839
a number

461
00:16:33,839 --> 00:16:35,600
uh and then from there you can determine

462
00:16:35,600 --> 00:16:37,120
if it's malicious or not or are they

463
00:16:37,120 --> 00:16:39,360
supposed to log in from there

464
00:16:39,360 --> 00:16:41,839
uh just take uh we're going to sell some

465
00:16:41,839 --> 00:16:43,759
of the information might be inaccurate

466
00:16:43,759 --> 00:16:45,360
that's why

467
00:16:45,360 --> 00:16:48,240
um we as an organization we actually

468
00:16:48,240 --> 00:16:49,759
double check it with additional ocean

469
00:16:49,759 --> 00:16:51,519
resources just to make sure everything

470
00:16:51,519 --> 00:16:53,519
all the information is correct

471
00:16:53,519 --> 00:16:55,600
uh application and defense information

472
00:16:55,600 --> 00:16:57,279
of course it will tell you what which

473
00:16:57,279 --> 00:16:58,560
user agent

474
00:16:58,560 --> 00:16:59,440
uh

475
00:16:59,440 --> 00:17:01,519
which you know like applications the

476
00:17:01,519 --> 00:17:03,759
user trying to access like from which

477
00:17:03,759 --> 00:17:06,240
device operating system which is really

478
00:17:06,240 --> 00:17:08,160
neat

479
00:17:08,160 --> 00:17:11,119
and then you can see

480
00:17:11,119 --> 00:17:13,679
user information such as name id

481
00:17:13,679 --> 00:17:16,480
principle name and the type and then

482
00:17:16,480 --> 00:17:18,959
you'll see error failure you know like

483
00:17:18,959 --> 00:17:21,919
uh for example if the

484
00:17:21,919 --> 00:17:24,240
user failed to log in

485
00:17:24,240 --> 00:17:26,319
is it because they fail mfa is it

486
00:17:26,319 --> 00:17:28,880
because they fail you know like password

487
00:17:28,880 --> 00:17:31,200
is it because some other errors

488
00:17:31,200 --> 00:17:33,760
sometimes you will see uh error results

489
00:17:33,760 --> 00:17:36,160
called others

490
00:17:36,160 --> 00:17:37,760
when that happened you need to see the

491
00:17:37,760 --> 00:17:39,520
code and then you need to look that up

492
00:17:39,520 --> 00:17:42,000
in the that link i provided microsoft

493
00:17:42,000 --> 00:17:44,320
online dot com slash hour

494
00:17:44,320 --> 00:17:45,919
and then there's time information which

495
00:17:45,919 --> 00:17:48,559
is really critical here so the the

496
00:17:48,559 --> 00:17:50,640
properties that created the time or

497
00:17:50,640 --> 00:17:52,320
create the time

498
00:17:52,320 --> 00:17:53,520
uh

499
00:17:53,520 --> 00:17:56,160
this is created uh when it whenever the

500
00:17:56,160 --> 00:17:58,320
event is actually created so like

501
00:17:58,320 --> 00:18:00,720
okay it happened and the time is in utc

502
00:18:00,720 --> 00:18:03,520
so in this example it's 437

503
00:18:03,520 --> 00:18:05,200
uh utc

504
00:18:05,200 --> 00:18:06,240
uh

505
00:18:06,240 --> 00:18:08,080
3437

506
00:18:08,080 --> 00:18:09,360
30 seconds

507
00:18:09,360 --> 00:18:11,360
meanwhile the nq time this is when the

508
00:18:11,360 --> 00:18:14,640
signings is being completely done

509
00:18:14,640 --> 00:18:17,120
after being processed by

510
00:18:17,120 --> 00:18:17,840
the

511
00:18:17,840 --> 00:18:20,400
you know like risky signing model and

512
00:18:20,400 --> 00:18:21,919
then

513
00:18:21,919 --> 00:18:22,880
if

514
00:18:22,880 --> 00:18:24,640
and it will be local time and the time

515
00:18:24,640 --> 00:18:27,440
that we are having it's in the est or

516
00:18:27,440 --> 00:18:30,480
edt which is four hours ahead

517
00:18:30,480 --> 00:18:31,760
and then

518
00:18:31,760 --> 00:18:33,840
if you can see there's actually four

519
00:18:33,840 --> 00:18:35,200
minutes delay because it's on the

520
00:18:35,200 --> 00:18:38,320
minutes 37 when it's created and it's on

521
00:18:38,320 --> 00:18:40,080
the minute 41

522
00:18:40,080 --> 00:18:43,600
when it is you know like completely uh

523
00:18:43,600 --> 00:18:44,960
processed by

524
00:18:44,960 --> 00:18:46,960
you know microsoft machine machine

525
00:18:46,960 --> 00:18:48,480
learning model

526
00:18:48,480 --> 00:18:49,600
so

527
00:18:49,600 --> 00:18:51,440
uh

528
00:18:51,440 --> 00:18:53,840
more other stuff from the signings will

529
00:18:53,840 --> 00:18:55,520
tell you about mfa and conditional

530
00:18:55,520 --> 00:18:56,480
access

531
00:18:56,480 --> 00:18:57,919
stuff

532
00:18:57,919 --> 00:19:00,720
for example the first

533
00:19:00,720 --> 00:19:03,120
you know screenshot on the top left it

534
00:19:03,120 --> 00:19:04,400
is

535
00:19:04,400 --> 00:19:06,320
conditional access policies so which

536
00:19:06,320 --> 00:19:08,160
conditional access policy apply for this

537
00:19:08,160 --> 00:19:10,160
particular signage it will tell you if

538
00:19:10,160 --> 00:19:12,080
it passes it or not

539
00:19:12,080 --> 00:19:13,919
uh and then commercial access policy is

540
00:19:13,919 --> 00:19:15,520
actually only available for certain

541
00:19:15,520 --> 00:19:17,039
israeli licenses so you need to pay

542
00:19:17,039 --> 00:19:18,640
attention to that

543
00:19:18,640 --> 00:19:20,720
uh you know like now you get

544
00:19:20,720 --> 00:19:22,960
authentication details which tell you is

545
00:19:22,960 --> 00:19:25,280
it single factor multi-factor

546
00:19:25,280 --> 00:19:27,600
uh which which model of you know like

547
00:19:27,600 --> 00:19:29,919
authentication that they are

548
00:19:29,919 --> 00:19:31,679
using could be

549
00:19:31,679 --> 00:19:33,760
you know as simple as uh pressure

550
00:19:33,760 --> 00:19:36,160
authentication pta or they are using the

551
00:19:36,160 --> 00:19:36,840
hash

552
00:19:36,840 --> 00:19:39,200
synchronization or is it using for the

553
00:19:39,200 --> 00:19:42,640
mfa is using the azure id app or etc and

554
00:19:42,640 --> 00:19:44,000
lastly we get

555
00:19:44,000 --> 00:19:46,480
uh you know like the conditional access

556
00:19:46,480 --> 00:19:49,360
status such as like failure uh

557
00:19:49,360 --> 00:19:51,840
you know the authentication

558
00:19:51,840 --> 00:19:53,280
you know like uh

559
00:19:53,280 --> 00:19:55,120
information such as a multi-factor

560
00:19:55,120 --> 00:19:56,400
single factor

561
00:19:56,400 --> 00:19:57,919
which you can actually take from the

562
00:19:57,919 --> 00:19:58,880
previous

563
00:19:58,880 --> 00:20:00,320
uh few

564
00:20:00,320 --> 00:20:03,520
you know like uh

565
00:20:05,039 --> 00:20:09,120
information or like attributes

566
00:20:12,799 --> 00:20:14,720
so lastly that we're going to talk about

567
00:20:14,720 --> 00:20:17,440
it's going to be

568
00:20:17,760 --> 00:20:18,840
the risky

569
00:20:18,840 --> 00:20:21,360
signing i'm not lastly actually there's

570
00:20:21,360 --> 00:20:24,640
some more stuff but uh risky sign is the

571
00:20:24,640 --> 00:20:26,640
the one related to the signings one so

572
00:20:26,640 --> 00:20:29,440
you'll have risk information on it uh

573
00:20:29,440 --> 00:20:30,960
such as

574
00:20:30,960 --> 00:20:33,520
like is it at risk or not you know it's

575
00:20:33,520 --> 00:20:35,440
pretty pretty straightforward

576
00:20:35,440 --> 00:20:37,840
the level which is as i mentioned loads

577
00:20:37,840 --> 00:20:40,320
only available for the p2 licenses

578
00:20:40,320 --> 00:20:42,799
uh and then on top of that it will tell

579
00:20:42,799 --> 00:20:44,799
you like which even types so we're gonna

580
00:20:44,799 --> 00:20:46,880
talk about their risky even types in the

581
00:20:46,880 --> 00:20:49,840
next slide

582
00:20:49,919 --> 00:20:50,880
yeah

583
00:20:50,880 --> 00:20:52,799
as i mentioned the risky will take some

584
00:20:52,799 --> 00:20:54,880
times to load could be from 2 hours to

585
00:20:54,880 --> 00:20:56,799
24 hour

586
00:20:56,799 --> 00:20:58,960
so there are different you know signing

587
00:20:58,960 --> 00:21:00,559
event types

588
00:21:00,559 --> 00:21:03,760
there are i i i try to categorize it

589
00:21:03,760 --> 00:21:04,960
based on the

590
00:21:04,960 --> 00:21:06,960
you know like uh bigger

591
00:21:06,960 --> 00:21:09,200
types so you get location based race you

592
00:21:09,200 --> 00:21:12,320
get ip address base rates anomaly basers

593
00:21:12,320 --> 00:21:14,640
and some other race such as for the

594
00:21:14,640 --> 00:21:16,880
location you get a typical travel

595
00:21:16,880 --> 00:21:18,880
impossible traffic new country so this

596
00:21:18,880 --> 00:21:20,559
is pretty much

597
00:21:20,559 --> 00:21:21,520
if

598
00:21:21,520 --> 00:21:23,919
a signing is coming from

599
00:21:23,919 --> 00:21:26,240
unusual location pretty much and then

600
00:21:26,240 --> 00:21:28,240
appearance base so this is being

601
00:21:28,240 --> 00:21:30,720
enriched with intel information such as

602
00:21:30,720 --> 00:21:32,080
emotions that be addressed this is

603
00:21:32,080 --> 00:21:34,880
anonymous we're talking vpn tor

604
00:21:34,880 --> 00:21:37,520
uh again malwaring appetizers related to

605
00:21:37,520 --> 00:21:39,840
the first one malicious appearance

606
00:21:39,840 --> 00:21:42,080
and activity anonymous appearance is

607
00:21:42,080 --> 00:21:43,120
actually

608
00:21:43,120 --> 00:21:45,600
related to the second one

609
00:21:45,600 --> 00:21:47,679
normally base risks uh we're really

610
00:21:47,679 --> 00:21:50,640
talking about enormous token

611
00:21:50,640 --> 00:21:52,640
or like token issue anomaly so for

612
00:21:52,640 --> 00:21:54,720
example a new

613
00:21:54,720 --> 00:21:57,679
identity provider being introduced

614
00:21:57,679 --> 00:21:59,840
that can cause this

615
00:21:59,840 --> 00:22:02,480
you know anomaly suspicious browser

616
00:22:02,480 --> 00:22:04,799
other sign-in properties user agent

617
00:22:04,799 --> 00:22:07,600
application etc so

618
00:22:07,600 --> 00:22:09,600
in comparing the logged in

619
00:22:09,600 --> 00:22:11,280
of designing

620
00:22:11,280 --> 00:22:13,760
uh of this user with the historical data

621
00:22:13,760 --> 00:22:15,280
that they have and then from there the

622
00:22:15,280 --> 00:22:17,039
machine learning model decide is it

623
00:22:17,039 --> 00:22:20,000
suspicious or not

624
00:22:20,159 --> 00:22:22,320
and then if they do something on the

625
00:22:22,320 --> 00:22:25,120
office 665 related stuff it can tell you

626
00:22:25,120 --> 00:22:27,039
if it's suspicious or not some other

627
00:22:27,039 --> 00:22:27,919
risks

628
00:22:27,919 --> 00:22:30,880
uh try and tell uh you know like the

629
00:22:30,880 --> 00:22:32,640
admin can actually confirm the user

630
00:22:32,640 --> 00:22:35,360
compromise uh password spray

631
00:22:35,360 --> 00:22:37,679
uh i think that's a good one to have and

632
00:22:37,679 --> 00:22:39,600
an additional risk detected

633
00:22:39,600 --> 00:22:42,000
which is can be anything based on the

634
00:22:42,000 --> 00:22:43,280
risk model that

635
00:22:43,280 --> 00:22:44,480
microsoft

636
00:22:44,480 --> 00:22:47,280
is you know providing

637
00:22:47,280 --> 00:22:49,039
for the audit logs uh

638
00:22:49,039 --> 00:22:51,919
we don't have much here

639
00:22:51,919 --> 00:22:53,520
pretty straightforward so you can manage

640
00:22:53,520 --> 00:22:55,440
user you can manage group you can manage

641
00:22:55,440 --> 00:22:57,360
application you can buy natural there's

642
00:22:57,360 --> 00:22:58,720
more

643
00:22:58,720 --> 00:23:00,159
management

644
00:23:00,159 --> 00:23:02,000
you know types

645
00:23:02,000 --> 00:23:04,080
in there but this is the common four

646
00:23:04,080 --> 00:23:06,880
so such as creating new user you

647
00:23:06,880 --> 00:23:08,880
restoring group password you're getting

648
00:23:08,880 --> 00:23:12,880
policies for the group uh you set up mfa

649
00:23:12,880 --> 00:23:14,640
on certain application

650
00:23:14,640 --> 00:23:17,360
you're issuing token or

651
00:23:17,360 --> 00:23:20,000
authentication code for the user

652
00:23:20,000 --> 00:23:22,320
and for the role management

653
00:23:22,320 --> 00:23:24,720
uh you can add device stream of user to

654
00:23:24,720 --> 00:23:27,120
device on that particular role again

655
00:23:27,120 --> 00:23:28,960
conditional policies for a particular

656
00:23:28,960 --> 00:23:29,760
role

657
00:23:29,760 --> 00:23:32,400
so it's pretty straightforward uh the

658
00:23:32,400 --> 00:23:34,559
lists are provided in the microsoft

659
00:23:34,559 --> 00:23:36,799
website so if you want to know more

660
00:23:36,799 --> 00:23:39,919
but uh yeah so that's for the audit logs

661
00:23:39,919 --> 00:23:42,400
uh now let's let's move forward

662
00:23:42,400 --> 00:23:44,000
and you know

663
00:23:44,000 --> 00:23:47,360
uh let's play a bit more with the azure

664
00:23:47,360 --> 00:23:49,760
audio reports now

665
00:23:49,760 --> 00:23:52,000
so let's do try hunting with it so

666
00:23:52,000 --> 00:23:54,000
prerequisite so you need to understand

667
00:23:54,000 --> 00:23:56,080
your organization first before you try

668
00:23:56,080 --> 00:23:57,840
to do hunting in it

669
00:23:57,840 --> 00:23:59,840
um

670
00:23:59,840 --> 00:24:01,600
you're required to material security and

671
00:24:01,600 --> 00:24:03,679
compliance policies also so you need to

672
00:24:03,679 --> 00:24:04,960
know

673
00:24:04,960 --> 00:24:06,799
like things like where are my employees

674
00:24:06,799 --> 00:24:09,200
do i have contractors my subsidiaries my

675
00:24:09,200 --> 00:24:10,320
vendors

676
00:24:10,320 --> 00:24:13,279
and then are those contractors

677
00:24:13,279 --> 00:24:15,440
are using vpn technologies to log into

678
00:24:15,440 --> 00:24:18,480
our system are they using proxy so

679
00:24:18,480 --> 00:24:21,200
do we use other you know application in

680
00:24:21,200 --> 00:24:22,720
the cloud

681
00:24:22,720 --> 00:24:23,919
um

682
00:24:23,919 --> 00:24:26,880
or even just can regular user use vpn

683
00:24:26,880 --> 00:24:29,200
like you know i'm talking about nordvpn

684
00:24:29,200 --> 00:24:30,320
like

685
00:24:30,320 --> 00:24:33,039
you know like all this vpn is against

686
00:24:33,039 --> 00:24:35,840
our policy again back to mature security

687
00:24:35,840 --> 00:24:38,080
and compliance policy can they use it

688
00:24:38,080 --> 00:24:38,960
all right

689
00:24:38,960 --> 00:24:41,039
and can can user bring their own device

690
00:24:41,039 --> 00:24:42,960
or are we provisioning our own devices

691
00:24:42,960 --> 00:24:45,279
so if yours for example for this one if

692
00:24:45,279 --> 00:24:47,840
you're seeing a new device that is

693
00:24:47,840 --> 00:24:50,960
not you know yours so that's definitely

694
00:24:50,960 --> 00:24:52,960
something questionable happening

695
00:24:52,960 --> 00:24:55,440
and then those policy you can actually

696
00:24:55,440 --> 00:24:57,840
translate them to conditional access

697
00:24:57,840 --> 00:24:59,520
policy in azure

698
00:24:59,520 --> 00:25:02,000
and it will actually add extra layer

699
00:25:02,000 --> 00:25:04,400
because your policy it's now actionable

700
00:25:04,400 --> 00:25:05,760
items by

701
00:25:05,760 --> 00:25:08,400
azure 80 security

702
00:25:08,400 --> 00:25:10,240
so you need to understand the zeroth

703
00:25:10,240 --> 00:25:12,080
security operation so like

704
00:25:12,080 --> 00:25:13,679
when something suspicious when it just

705
00:25:13,679 --> 00:25:15,520
happened like what what i'm gonna do can

706
00:25:15,520 --> 00:25:17,760
i refocus their session uh how do i

707
00:25:17,760 --> 00:25:20,880
change user password or how do i you

708
00:25:20,880 --> 00:25:23,919
know like uh enable mfa for users

709
00:25:23,919 --> 00:25:25,600
uh so things like that you need to

710
00:25:25,600 --> 00:25:27,360
understand first it could be you it

711
00:25:27,360 --> 00:25:29,919
could be your additional you know like a

712
00:25:29,919 --> 00:25:33,279
managed security provider or etc

713
00:25:33,279 --> 00:25:34,159
uh

714
00:25:34,159 --> 00:25:36,159
it will be great if you can understand

715
00:25:36,159 --> 00:25:38,400
the attack concept or even just azure ad

716
00:25:38,400 --> 00:25:41,760
concept in general like how saml all out

717
00:25:41,760 --> 00:25:44,720
you enter cloud lingo here work

718
00:25:44,720 --> 00:25:47,360
uh what about edfs you know like health

719
00:25:47,360 --> 00:25:49,440
cloud health on premise so if you

720
00:25:49,440 --> 00:25:51,360
understand that information

721
00:25:51,360 --> 00:25:52,880
uh you're definitely

722
00:25:52,880 --> 00:25:55,679
able to do threat hands and of course

723
00:25:55,679 --> 00:25:57,760
you need access to azure ready

724
00:25:57,760 --> 00:26:00,320
to get those locks as your data reports

725
00:26:00,320 --> 00:26:02,720
and sim is actually recommended because

726
00:26:02,720 --> 00:26:04,480
it gives you better visibility actually

727
00:26:04,480 --> 00:26:06,720
gives you better functionality such as

728
00:26:06,720 --> 00:26:08,840
aggregation you can start

729
00:26:08,840 --> 00:26:11,200
visualization and you can you know like

730
00:26:11,200 --> 00:26:14,159
uh create easy like statistic just by

731
00:26:14,159 --> 00:26:18,320
doing that so it's really recommended

732
00:26:18,320 --> 00:26:21,039
so attacks that can be detected via the

733
00:26:21,039 --> 00:26:22,559
report so we get attacks on the left

734
00:26:22,559 --> 00:26:24,480
side and then some additional stuff that

735
00:26:24,480 --> 00:26:26,159
might interest you on the right side

736
00:26:26,159 --> 00:26:28,880
password spray 230 percent increase you

737
00:26:28,880 --> 00:26:31,760
want to try to detect that specifically

738
00:26:31,760 --> 00:26:33,360
legacy application and single factor

739
00:26:33,360 --> 00:26:35,200
account brute force you know like

740
00:26:35,200 --> 00:26:37,120
multiple brute force on a single factor

741
00:26:37,120 --> 00:26:39,919
account mfa would force

742
00:26:39,919 --> 00:26:42,720
they just spam users with mfa requests

743
00:26:42,720 --> 00:26:45,679
until they approve it and then you can

744
00:26:45,679 --> 00:26:47,679
get combination of them

745
00:26:47,679 --> 00:26:50,840
and then your username recon and then

746
00:26:50,840 --> 00:26:54,159
lastly compromise account so credentials

747
00:26:54,159 --> 00:26:56,559
get fish uh clients will get a leak uh

748
00:26:56,559 --> 00:26:58,799
companies get rich uh credentials being

749
00:26:58,799 --> 00:26:59,760
reused

750
00:26:59,760 --> 00:27:02,640
by your user so yeah on-premise password

751
00:27:02,640 --> 00:27:04,799
compromise mfa which is like user

752
00:27:04,799 --> 00:27:07,120
approving mfa pretty much which i tell

753
00:27:07,120 --> 00:27:09,520
like really funny really stupid but it

754
00:27:09,520 --> 00:27:12,480
happens not once a lot of times

755
00:27:12,480 --> 00:27:15,679
so yeah breaking news password reuse

756
00:27:15,679 --> 00:27:18,240
leads to account compromise yes i'm

757
00:27:18,240 --> 00:27:21,120
actually been

758
00:27:21,120 --> 00:27:24,000
a victim to that so i reuse password i

759
00:27:24,000 --> 00:27:26,480
know security person doing not security

760
00:27:26,480 --> 00:27:28,559
stuff but yeah i reuse password in one

761
00:27:28,559 --> 00:27:30,640
of my account and get compromise and the

762
00:27:30,640 --> 00:27:32,559
attacker use credit card blah blah blah

763
00:27:32,559 --> 00:27:35,120
and then i learned from that actually

764
00:27:35,120 --> 00:27:37,760
so yeah i'm trying to bring that

765
00:27:37,760 --> 00:27:40,080
to here also on top of that on top of

766
00:27:40,080 --> 00:27:42,480
attacks you can actually detect

767
00:27:42,480 --> 00:27:45,360
unusual suspicious signals such as

768
00:27:45,360 --> 00:27:47,840
a single factor in the mfa environment

769
00:27:47,840 --> 00:27:50,559
why there is a single fighter when i

770
00:27:50,559 --> 00:27:53,520
when my policy it's mfa so you can

771
00:27:53,520 --> 00:27:55,039
actually investigate that

772
00:27:55,039 --> 00:27:57,039
malicious appearance trying to connect

773
00:27:57,039 --> 00:27:59,120
to my

774
00:27:59,120 --> 00:28:01,919
you know like network why is that

775
00:28:01,919 --> 00:28:03,360
what about the sibling outfitters i'm

776
00:28:03,360 --> 00:28:05,760
talking about the same ways and same

777
00:28:05,760 --> 00:28:07,360
subnet

778
00:28:07,360 --> 00:28:08,399
you know

779
00:28:08,399 --> 00:28:10,799
suspicious asn thor exit node in my

780
00:28:10,799 --> 00:28:14,480
network vpn vps when our policy

781
00:28:14,480 --> 00:28:16,880
say we don't need it uh we're not

782
00:28:16,880 --> 00:28:18,960
allowing it that the center hosting

783
00:28:18,960 --> 00:28:22,000
trying to bombard our you know likes uh

784
00:28:22,000 --> 00:28:24,000
network so you can find all the answers

785
00:28:24,000 --> 00:28:25,360
there and then you can decide if it's

786
00:28:25,360 --> 00:28:27,919
delicious or not suspicious application

787
00:28:27,919 --> 00:28:30,240
why are we seeing legacy application

788
00:28:30,240 --> 00:28:32,480
although we already blocked them so

789
00:28:32,480 --> 00:28:34,799
it could be potentially can be an attack

790
00:28:34,799 --> 00:28:36,960
or something you know like shadow it you

791
00:28:36,960 --> 00:28:38,480
just don't know it's there and

792
00:28:38,480 --> 00:28:40,799
suspicious user agent you know sometimes

793
00:28:40,799 --> 00:28:43,760
you'll see things like scanner

794
00:28:43,760 --> 00:28:45,840
sometimes you can see legacy user agent

795
00:28:45,840 --> 00:28:47,760
that's being actively exploited let's

796
00:28:47,760 --> 00:28:50,480
just i'll take the example path to aero

797
00:28:50,480 --> 00:28:52,320
pc which is the

798
00:28:52,320 --> 00:28:54,559
exchange active sync

799
00:28:54,559 --> 00:28:56,159
actively

800
00:28:56,159 --> 00:28:57,200
you know

801
00:28:57,200 --> 00:28:58,399
finally speaking

802
00:28:58,399 --> 00:29:01,279
actively being used to

803
00:29:01,279 --> 00:29:04,159
to to obtain credentials using password

804
00:29:04,159 --> 00:29:06,240
spray and then an initial user agent you

805
00:29:06,240 --> 00:29:08,320
just need to answer a question why it is

806
00:29:08,320 --> 00:29:10,480
there so you can look for all this

807
00:29:10,480 --> 00:29:12,799
information using you know like this

808
00:29:12,799 --> 00:29:14,240
logging system

809
00:29:14,240 --> 00:29:16,159
um

810
00:29:16,159 --> 00:29:18,640
and then yeah let's talk about

811
00:29:18,640 --> 00:29:19,600
you know

812
00:29:19,600 --> 00:29:21,360
uh what type of attacks they can be

813
00:29:21,360 --> 00:29:24,799
detected so for the password spray

814
00:29:24,799 --> 00:29:26,880
detection you know like a logic as

815
00:29:26,880 --> 00:29:27,919
you're seeing

816
00:29:27,919 --> 00:29:30,240
a high number failed single factor

817
00:29:30,240 --> 00:29:33,600
there's some success unusual eyepiece so

818
00:29:33,600 --> 00:29:35,679
normally you correlate it by eyepiece

819
00:29:35,679 --> 00:29:38,000
but you can also correlate it by

820
00:29:38,000 --> 00:29:41,120
user agent you can correlate it by you

821
00:29:41,120 --> 00:29:42,559
know like

822
00:29:42,559 --> 00:29:44,880
the application that we targeted which

823
00:29:44,880 --> 00:29:47,039
is sometimes really being used by your

824
00:29:47,039 --> 00:29:49,279
users so

825
00:29:49,279 --> 00:29:52,000
you can use that and then you can

826
00:29:52,000 --> 00:29:53,360
sometimes you'll have

827
00:29:53,360 --> 00:29:55,360
multiple users being attacked

828
00:29:55,360 --> 00:29:57,200
most of the times i would say

829
00:29:57,200 --> 00:29:58,799
you get legacy and single factor

830
00:29:58,799 --> 00:30:00,799
application being used because you know

831
00:30:00,799 --> 00:30:03,200
they try to downgrade your mfa to single

832
00:30:03,200 --> 00:30:05,039
factor

833
00:30:05,039 --> 00:30:06,799
so yeah for the password force the

834
00:30:06,799 --> 00:30:08,480
difference will be

835
00:30:08,480 --> 00:30:10,880
you know like that

836
00:30:10,880 --> 00:30:13,039
application might not be like you see a

837
00:30:13,039 --> 00:30:15,279
single factor so they did maybe they

838
00:30:15,279 --> 00:30:17,039
didn't know that you have mfa

839
00:30:17,039 --> 00:30:18,640
and then from there

840
00:30:18,640 --> 00:30:19,440
you

841
00:30:19,440 --> 00:30:21,039
they actually just keep trying and then

842
00:30:21,039 --> 00:30:22,880
they find everything they'll do the mfa

843
00:30:22,880 --> 00:30:25,520
brute force which is the next one

844
00:30:25,520 --> 00:30:29,039
on top of that uh debuff one you'll have

845
00:30:29,039 --> 00:30:31,440
single factor success high number of

846
00:30:31,440 --> 00:30:35,360
lmfa which is really funny

847
00:30:35,360 --> 00:30:36,880
when when that happened i think the user

848
00:30:36,880 --> 00:30:37,919
will probably

849
00:30:37,919 --> 00:30:39,679
aware of it but you know sometimes they

850
00:30:39,679 --> 00:30:42,000
just get better they click it and then

851
00:30:42,000 --> 00:30:44,640
you know the attacker get in

852
00:30:44,640 --> 00:30:47,279
uh normally they'll use the mobile app

853
00:30:47,279 --> 00:30:49,039
notification or phone call because it's

854
00:30:49,039 --> 00:30:52,080
more annoying compared to tax

855
00:30:52,080 --> 00:30:54,320
you get unusual ips

856
00:30:54,320 --> 00:30:55,840
very likely hosting and we're talking

857
00:30:55,840 --> 00:30:57,519
about aws

858
00:30:57,519 --> 00:31:00,240
ovh uh it could be also digital ocean

859
00:31:00,240 --> 00:31:02,159
ipads

860
00:31:02,159 --> 00:31:04,159
and then you will see an issue or user

861
00:31:04,159 --> 00:31:07,120
agent could be like microsoft office

862
00:31:07,120 --> 00:31:10,559
uh you know like the some other stuff

863
00:31:10,559 --> 00:31:11,840
also

864
00:31:11,840 --> 00:31:13,360
uh and then it could be single or

865
00:31:13,360 --> 00:31:16,080
multiple users so

866
00:31:16,080 --> 00:31:18,240
here you can see also error codes that

867
00:31:18,240 --> 00:31:19,679
you might want to

868
00:31:19,679 --> 00:31:20,559
watch

869
00:31:20,559 --> 00:31:22,000
uh for

870
00:31:22,000 --> 00:31:24,480
this scenarios and then for the response

871
00:31:24,480 --> 00:31:26,240
what you want to do when you know

872
00:31:26,240 --> 00:31:27,519
you got you're being attacked you need

873
00:31:27,519 --> 00:31:28,880
to make sure you collect all the

874
00:31:28,880 --> 00:31:31,840
attacker up here as you try to collect

875
00:31:31,840 --> 00:31:33,600
you know all of them maybe it's a

876
00:31:33,600 --> 00:31:36,399
sibling appearance like ace and bass

877
00:31:36,399 --> 00:31:39,120
on or you know like uh

878
00:31:39,120 --> 00:31:41,679
they're from the same subnets

879
00:31:41,679 --> 00:31:43,840
you want to look for error code zero

880
00:31:43,840 --> 00:31:45,519
firstly

881
00:31:45,519 --> 00:31:47,200
because you need to make sure

882
00:31:47,200 --> 00:31:50,000
that that ip address is

883
00:31:50,000 --> 00:31:52,480
none of them are successfully logged in

884
00:31:52,480 --> 00:31:54,159
you can actually check on your office

885
00:31:54,159 --> 00:31:56,480
365 logs for authentication logs just to

886
00:31:56,480 --> 00:31:58,240
make sure double check it

887
00:31:58,240 --> 00:32:01,919
once you have all the ip addresses uh

888
00:32:01,919 --> 00:32:04,880
if any success for single factor so it

889
00:32:04,880 --> 00:32:06,880
means password compromise so you need to

890
00:32:06,880 --> 00:32:08,799
review audit locks you need to review

891
00:32:08,799 --> 00:32:10,720
365 logs and see what's going on with

892
00:32:10,720 --> 00:32:12,880
the user what what are they doing inside

893
00:32:12,880 --> 00:32:14,799
after they're successful logged in and

894
00:32:14,799 --> 00:32:16,480
then while doing that you need to

895
00:32:16,480 --> 00:32:18,559
refocus session you need to reset user

896
00:32:18,559 --> 00:32:21,440
password enable mfa when possible

897
00:32:21,440 --> 00:32:22,399
if the

898
00:32:22,399 --> 00:32:25,039
you know like uh successful

899
00:32:25,039 --> 00:32:26,960
uh you know like a compromise account

900
00:32:26,960 --> 00:32:29,360
was actually multi-factor

901
00:32:29,360 --> 00:32:32,000
again reviewing the locks it's important

902
00:32:32,000 --> 00:32:34,399
you need to reset password

903
00:32:34,399 --> 00:32:37,200
you need to add new id face

904
00:32:37,200 --> 00:32:38,480
and then

905
00:32:38,480 --> 00:32:40,720
sometimes attacker will make changes and

906
00:32:40,720 --> 00:32:44,240
you need to undo all of that including

907
00:32:44,240 --> 00:32:46,480
the one that i saw quite often is they

908
00:32:46,480 --> 00:32:49,279
are replacing the mfa devices with their

909
00:32:49,279 --> 00:32:50,960
own devices so they locked up their

910
00:32:50,960 --> 00:32:53,360
users so you need to make sure you take

911
00:32:53,360 --> 00:32:56,320
that out and bring the users mfa or even

912
00:32:56,320 --> 00:32:59,039
you can lock.com until the users

913
00:32:59,039 --> 00:32:59,760
are

914
00:32:59,760 --> 00:33:02,640
ready to do the mfa process

915
00:33:02,640 --> 00:33:04,799
and then yeah you can block it the ip

916
00:33:04,799 --> 00:33:06,399
addresses or you can report it to the

917
00:33:06,399 --> 00:33:08,240
authority

918
00:33:08,240 --> 00:33:10,880
for the less frequent attack less volume

919
00:33:10,880 --> 00:33:13,600
such as compromise password compromise

920
00:33:13,600 --> 00:33:16,880
password and mfa and then a recon

921
00:33:16,880 --> 00:33:18,000
you'll see

922
00:33:18,000 --> 00:33:20,559
mainly majority will be successful like

923
00:33:20,559 --> 00:33:22,000
single factor

924
00:33:22,000 --> 00:33:24,240
could be in the middle of brute force or

925
00:33:24,240 --> 00:33:27,120
password spray and the ip address will

926
00:33:27,120 --> 00:33:28,559
normally coming from you know like

927
00:33:28,559 --> 00:33:32,158
hosting vpn tor

928
00:33:32,559 --> 00:33:35,120
you will see like unusual user agent or

929
00:33:35,120 --> 00:33:38,000
devices you can correlate it using that

930
00:33:38,000 --> 00:33:40,000
and then you'll see multiple users or

931
00:33:40,000 --> 00:33:42,960
maybe even single users if it's just out

932
00:33:42,960 --> 00:33:44,240
of the

933
00:33:44,240 --> 00:33:45,760
you know like normality for that

934
00:33:45,760 --> 00:33:47,679
particular user so this is unusual for

935
00:33:47,679 --> 00:33:48,799
the users

936
00:33:48,799 --> 00:33:50,320
so

937
00:33:50,320 --> 00:33:52,559
so yeah so this is what you want to do

938
00:33:52,559 --> 00:33:54,640
uh when you're seeing that uh for the

939
00:33:54,640 --> 00:33:56,640
username recon you'll probably see

940
00:33:56,640 --> 00:33:59,440
a lot more invalid username or password

941
00:33:59,440 --> 00:34:00,559
which is in this case it will be

942
00:34:00,559 --> 00:34:02,720
username

943
00:34:02,720 --> 00:34:04,240
uh and then

944
00:34:04,240 --> 00:34:05,679
what you're gonna do for the response

945
00:34:05,679 --> 00:34:07,600
it's pretty much the same

946
00:34:07,600 --> 00:34:10,719
collect the attacker ip address

947
00:34:10,719 --> 00:34:12,800
look for error code 0 for success

948
00:34:12,800 --> 00:34:15,520
because you don't want that

949
00:34:15,520 --> 00:34:18,719
again refuel aux uh refuxation when

950
00:34:18,719 --> 00:34:19,679
needed

951
00:34:19,679 --> 00:34:21,440
and you need to make sure that you

952
00:34:21,440 --> 00:34:24,800
enable mfa when possible if the attacker

953
00:34:24,800 --> 00:34:27,359
makes some changes into your environment

954
00:34:27,359 --> 00:34:31,119
you need to make sure that you actually

955
00:34:31,119 --> 00:34:33,280
you know

956
00:34:33,280 --> 00:34:35,199
undo their changes all right as i

957
00:34:35,199 --> 00:34:38,239
mentioned before uh you can

958
00:34:38,239 --> 00:34:40,639
report them uh block

959
00:34:40,639 --> 00:34:43,119
uh according to your company policy

960
00:34:43,119 --> 00:34:45,199
sometimes if when it's not possible you

961
00:34:45,199 --> 00:34:47,119
wanna attract them so you can add them

962
00:34:47,119 --> 00:34:49,199
to your intel platform could be miss

963
00:34:49,199 --> 00:34:51,679
could be some other intel platform

964
00:34:51,679 --> 00:34:53,119
uh

965
00:34:53,119 --> 00:34:56,079
so yeah the problem with this hun

966
00:34:56,079 --> 00:34:57,440
uh

967
00:34:57,440 --> 00:35:00,079
you'll you you'll see a lot of data uh

968
00:35:00,079 --> 00:35:01,440
especially when you're a large company

969
00:35:01,440 --> 00:35:03,200
multinational company

970
00:35:03,200 --> 00:35:06,000
uh threat hunting it's not it's not can

971
00:35:06,000 --> 00:35:07,680
it will be hard

972
00:35:07,680 --> 00:35:09,760
based on the experience that i have uh

973
00:35:09,760 --> 00:35:11,200
working in

974
00:35:11,200 --> 00:35:13,839
you know several big organizations

975
00:35:13,839 --> 00:35:17,400
like false positive

976
00:35:17,440 --> 00:35:21,040
will occur on the different majority

977
00:35:21,040 --> 00:35:22,960
event types

978
00:35:22,960 --> 00:35:24,000
so

979
00:35:24,000 --> 00:35:26,720
for the location base right a typical

980
00:35:26,720 --> 00:35:29,359
travel impossible travel new country

981
00:35:29,359 --> 00:35:31,839
your employee will travel eventually

982
00:35:31,839 --> 00:35:33,440
could be from business travel could be

983
00:35:33,440 --> 00:35:36,800
from vacation external consultant on vpn

984
00:35:36,800 --> 00:35:39,200
uh you know especially in this pandemic

985
00:35:39,200 --> 00:35:41,760
era like people working from home they

986
00:35:41,760 --> 00:35:43,440
need to use vpn sometimes to connect

987
00:35:43,440 --> 00:35:45,280
sometimes they go to different countries

988
00:35:45,280 --> 00:35:47,119
with their family and they work from

989
00:35:47,119 --> 00:35:48,720
there so you need to take that into

990
00:35:48,720 --> 00:35:51,599
consideration the malicious ip address

991
00:35:51,599 --> 00:35:53,440
uh or omniscience

992
00:35:53,440 --> 00:35:55,599
malware link appears we could be still

993
00:35:55,599 --> 00:35:58,640
try intel we're talking these days like

994
00:35:58,640 --> 00:36:00,320
threat intel i don't know it wouldn't

995
00:36:00,320 --> 00:36:02,640
last like few weeks it's become still

996
00:36:02,640 --> 00:36:04,480
because everything is on the host thing

997
00:36:04,480 --> 00:36:06,720
right so those information might be

998
00:36:06,720 --> 00:36:08,320
wrong

999
00:36:08,320 --> 00:36:11,119
and then yeah maybe they just share

1000
00:36:11,119 --> 00:36:13,520
you know a common ip address maybe one

1001
00:36:13,520 --> 00:36:15,680
of the user for example within the telco

1002
00:36:15,680 --> 00:36:17,680
network that compromise

1003
00:36:17,680 --> 00:36:18,560
but

1004
00:36:18,560 --> 00:36:19,520
uh

1005
00:36:19,520 --> 00:36:21,920
it's not your user what they are sharing

1006
00:36:21,920 --> 00:36:23,680
that one ip address

1007
00:36:23,680 --> 00:36:24,880
so for

1008
00:36:24,880 --> 00:36:27,839
anonymous you know address activities so

1009
00:36:27,839 --> 00:36:29,040
vpn

1010
00:36:29,040 --> 00:36:30,720
is being used normally these days for

1011
00:36:30,720 --> 00:36:32,960
the users it's up to you can they allow

1012
00:36:32,960 --> 00:36:34,720
are they allowed to use it

1013
00:36:34,720 --> 00:36:36,640
for work or not sometimes they just

1014
00:36:36,640 --> 00:36:38,800
forget they're logged in from their

1015
00:36:38,800 --> 00:36:40,400
mobile devices and

1016
00:36:40,400 --> 00:36:42,720
the vpn is on because they you know they

1017
00:36:42,720 --> 00:36:44,800
watch netflix you know like from canada

1018
00:36:44,800 --> 00:36:45,920
in the us

1019
00:36:45,920 --> 00:36:48,800
uh so it could happen all the time uh

1020
00:36:48,800 --> 00:36:50,480
suspicious browser and phone reciting

1021
00:36:50,480 --> 00:36:51,920
properties

1022
00:36:51,920 --> 00:36:53,520
uh this can happen when they're using

1023
00:36:53,520 --> 00:36:54,480
vpn

1024
00:36:54,480 --> 00:36:56,880
this can happen when they are you know

1025
00:36:56,880 --> 00:37:00,320
like just being different for once uh

1026
00:37:00,320 --> 00:37:02,320
visiting family they borrow their laptop

1027
00:37:02,320 --> 00:37:04,160
i wanna check my email can i you know

1028
00:37:04,160 --> 00:37:06,320
borrow your laptop or they have a new

1029
00:37:06,320 --> 00:37:07,599
phone

1030
00:37:07,599 --> 00:37:09,359
false positive everywhere

1031
00:37:09,359 --> 00:37:10,400
so

1032
00:37:10,400 --> 00:37:11,839
in order to approach this you can

1033
00:37:11,839 --> 00:37:13,040
actually

1034
00:37:13,040 --> 00:37:15,280
approaching it on the tier level so you

1035
00:37:15,280 --> 00:37:17,920
go for the high one first once you get

1036
00:37:17,920 --> 00:37:19,040
you know

1037
00:37:19,040 --> 00:37:20,960
get familiar with that you can go to the

1038
00:37:20,960 --> 00:37:23,520
medium to the low eventually you can

1039
00:37:23,520 --> 00:37:25,440
actually take all the data

1040
00:37:25,440 --> 00:37:26,720
and you know

1041
00:37:26,720 --> 00:37:29,760
like not the risky sign-ins data maybe

1042
00:37:29,760 --> 00:37:31,440
more than that all of the data all the

1043
00:37:31,440 --> 00:37:33,520
sinus data and you start processing it

1044
00:37:33,520 --> 00:37:36,400
yourself you might find more stuff

1045
00:37:36,400 --> 00:37:38,960
but of course they require resources and

1046
00:37:38,960 --> 00:37:41,599
talent to do that

1047
00:37:41,599 --> 00:37:44,640
uh yeah moving forward uh how do we

1048
00:37:44,640 --> 00:37:46,640
reduce the false positive

1049
00:37:46,640 --> 00:37:48,000
question mark

1050
00:37:48,000 --> 00:37:50,480
great question right so sometimes uh

1051
00:37:50,480 --> 00:37:52,560
once you know you baseline your user you

1052
00:37:52,560 --> 00:37:53,680
can actually

1053
00:37:53,680 --> 00:37:55,200
know like which

1054
00:37:55,200 --> 00:37:58,400
telco companies or my user coming from

1055
00:37:58,400 --> 00:38:01,040
um please note

1056
00:38:01,040 --> 00:38:01,839
like

1057
00:38:01,839 --> 00:38:03,839
having a list of known having a list of

1058
00:38:03,839 --> 00:38:05,520
like benign something

1059
00:38:05,520 --> 00:38:06,720
there will be

1060
00:38:06,720 --> 00:38:08,800
you know like a blind spot so it's just

1061
00:38:08,800 --> 00:38:11,520
this is an acceptable blind spot for you

1062
00:38:11,520 --> 00:38:12,640
uh

1063
00:38:12,640 --> 00:38:15,119
for example yeah is it fender is it

1064
00:38:15,119 --> 00:38:18,400
consultant what if defender get bridge

1065
00:38:18,400 --> 00:38:21,119
i mean it's probably really like small

1066
00:38:21,119 --> 00:38:22,800
percentage but

1067
00:38:22,800 --> 00:38:23,839
are you

1068
00:38:23,839 --> 00:38:25,599
you know are you comfortable with that

1069
00:38:25,599 --> 00:38:27,520
risk uh

1070
00:38:27,520 --> 00:38:29,599
you got a list of known vpn and tory

1071
00:38:29,599 --> 00:38:31,599
user sometimes the security people need

1072
00:38:31,599 --> 00:38:33,119
to your store so you might want to what

1073
00:38:33,119 --> 00:38:34,160
list that

1074
00:38:34,160 --> 00:38:36,160
or like you know like allow that

1075
00:38:36,160 --> 00:38:37,520
collection

1076
00:38:37,520 --> 00:38:40,240
a list of known country or city you know

1077
00:38:40,240 --> 00:38:42,240
sometimes

1078
00:38:42,240 --> 00:38:44,320
you'll have people

1079
00:38:44,320 --> 00:38:46,720
traveling uh and then

1080
00:38:46,720 --> 00:38:49,040
you know this country within you know

1081
00:38:49,040 --> 00:38:50,960
like you have offices in this country

1082
00:38:50,960 --> 00:38:53,200
and then that should be fine

1083
00:38:53,200 --> 00:38:56,000
if your company have having business uh

1084
00:38:56,000 --> 00:38:58,240
or like have offices in china for

1085
00:38:58,240 --> 00:38:59,920
example

1086
00:38:59,920 --> 00:39:02,880
it's okay like it's not attacker because

1087
00:39:02,880 --> 00:39:04,880
sometimes some people have business

1088
00:39:04,880 --> 00:39:07,359
travel to china

1089
00:39:07,359 --> 00:39:08,400
it could be

1090
00:39:08,400 --> 00:39:11,520
you know like uh you can have a list of

1091
00:39:11,520 --> 00:39:13,599
user with legacy application single

1092
00:39:13,599 --> 00:39:15,680
factor authentication

1093
00:39:15,680 --> 00:39:16,960
application

1094
00:39:16,960 --> 00:39:18,560
so

1095
00:39:18,560 --> 00:39:20,480
here you will

1096
00:39:20,480 --> 00:39:22,240
yeah that's the thing you need to have

1097
00:39:22,240 --> 00:39:24,320
this knowledge first before applying

1098
00:39:24,320 --> 00:39:25,680
this

1099
00:39:25,680 --> 00:39:27,599
you know reduction right

1100
00:39:27,599 --> 00:39:28,800
you can have a list of approve

1101
00:39:28,800 --> 00:39:31,760
application uh device type user agent so

1102
00:39:31,760 --> 00:39:33,359
anything on top of that

1103
00:39:33,359 --> 00:39:34,960
it's

1104
00:39:34,960 --> 00:39:37,200
you know you will say 99 malicious

1105
00:39:37,200 --> 00:39:38,960
because it's not a proof

1106
00:39:38,960 --> 00:39:41,280
or at least they breach the policy so

1107
00:39:41,280 --> 00:39:43,280
this is this is still something you want

1108
00:39:43,280 --> 00:39:44,800
to see

1109
00:39:44,800 --> 00:39:47,920
and lastly maybe not maybe you should

1110
00:39:47,920 --> 00:39:49,920
always compare user behavior with their

1111
00:39:49,920 --> 00:39:52,800
past behavior uh using the azure signing

1112
00:39:52,800 --> 00:39:53,839
logs

1113
00:39:53,839 --> 00:39:55,359
so you can actually

1114
00:39:55,359 --> 00:39:56,800
if you put it in your scene we can

1115
00:39:56,800 --> 00:39:59,200
actually have you know like data all the

1116
00:39:59,200 --> 00:40:01,359
way back to 30 days 90 days and you can

1117
00:40:01,359 --> 00:40:03,280
easily compare them you can search them

1118
00:40:03,280 --> 00:40:05,920
by appearance you can search them by

1119
00:40:05,920 --> 00:40:09,760
you know like uh user principle name etc

1120
00:40:09,760 --> 00:40:11,599
so these are ways to reduce false

1121
00:40:11,599 --> 00:40:13,920
positive

1122
00:40:13,920 --> 00:40:16,240
so introducing azula

1123
00:40:16,240 --> 00:40:18,880
yes the lady on the side's azula from

1124
00:40:18,880 --> 00:40:21,200
the avatar glass airbender

1125
00:40:21,200 --> 00:40:22,880
tv show

1126
00:40:22,880 --> 00:40:26,319
and yeah uh disclaimer first this tool

1127
00:40:26,319 --> 00:40:28,640
is still in deformant i'm working on it

1128
00:40:28,640 --> 00:40:31,200
really slowly uh the one that i have

1129
00:40:31,200 --> 00:40:32,800
right now it's not great it's not

1130
00:40:32,800 --> 00:40:34,480
optimized i don't want to release it so

1131
00:40:34,480 --> 00:40:37,599
i will be releasing it as a poc

1132
00:40:37,599 --> 00:40:39,760
modification is

1133
00:40:39,760 --> 00:40:41,680
you know 100 percent

1134
00:40:41,680 --> 00:40:43,520
you know like required for this for

1135
00:40:43,520 --> 00:40:45,520
operational use because

1136
00:40:45,520 --> 00:40:46,400
uh

1137
00:40:46,400 --> 00:40:48,240
i'm not gonna share what we are seeing

1138
00:40:48,240 --> 00:40:49,760
in our environment because first thing

1139
00:40:49,760 --> 00:40:53,200
first it's it's our stuff uh you know

1140
00:40:53,200 --> 00:40:56,160
like legality privacy etc and the second

1141
00:40:56,160 --> 00:40:56,960
thing

1142
00:40:56,960 --> 00:40:58,560
it will not work with your environment

1143
00:40:58,560 --> 00:41:01,280
because there's no one environment

1144
00:41:01,280 --> 00:41:04,079
you know is the same in the world so

1145
00:41:04,079 --> 00:41:07,040
those are just disclaimer uh so yeah so

1146
00:41:07,040 --> 00:41:11,359
azula when almost is not good enough

1147
00:41:11,359 --> 00:41:13,520
so we get everything here we get attack

1148
00:41:13,520 --> 00:41:15,520
detection response pattern

1149
00:41:15,520 --> 00:41:17,520
we get hunting at scale you know the

1150
00:41:17,520 --> 00:41:19,599
problem we know like what we need to

1151
00:41:19,599 --> 00:41:22,720
watch we know ways uh to reduce false

1152
00:41:22,720 --> 00:41:23,760
positive

1153
00:41:23,760 --> 00:41:24,800
so

1154
00:41:24,800 --> 00:41:26,880
all of that is great but it will still

1155
00:41:26,880 --> 00:41:28,800
take a lot of time to do based on

1156
00:41:28,800 --> 00:41:31,040
experience uh

1157
00:41:31,040 --> 00:41:33,440
it takes hours and hours to process data

1158
00:41:33,440 --> 00:41:35,760
i mean like we do process a lot of uh

1159
00:41:35,760 --> 00:41:38,400
users but i believe you will also be

1160
00:41:38,400 --> 00:41:40,400
processing a lot of users so it is

1161
00:41:40,400 --> 00:41:42,079
almost worth right

1162
00:41:42,079 --> 00:41:45,280
until azula so azula is already unified

1163
00:41:45,280 --> 00:41:47,440
lightweight automated

1164
00:41:47,440 --> 00:41:49,839
uh you can see like how i try to push it

1165
00:41:49,839 --> 00:41:52,560
but i make it work um so it's a python

1166
00:41:52,560 --> 00:41:54,720
based automation uh with some data

1167
00:41:54,720 --> 00:41:57,920
analytics and historical historical

1168
00:41:57,920 --> 00:41:59,440
reference systems

1169
00:41:59,440 --> 00:42:02,880
so comparison uh in short so it rely

1170
00:42:02,880 --> 00:42:04,480
mainly on the signings and risky

1171
00:42:04,480 --> 00:42:07,760
signings reports uh audit logs and some

1172
00:42:07,760 --> 00:42:09,520
other logs will be used for

1173
00:42:09,520 --> 00:42:12,720
investigation easily

1174
00:42:13,680 --> 00:42:15,599
so yeah there's five main components

1175
00:42:15,599 --> 00:42:18,160
austin enrichment as i mentioned we like

1176
00:42:18,160 --> 00:42:20,480
to compare with other austrian sources

1177
00:42:20,480 --> 00:42:23,280
so check the guip asn

1178
00:42:23,280 --> 00:42:26,319
check if it's a vpn or data center

1179
00:42:26,319 --> 00:42:27,760
on top of that

1180
00:42:27,760 --> 00:42:29,520
later there's some improvement that you

1181
00:42:29,520 --> 00:42:32,240
can do i'll share with you

1182
00:42:32,240 --> 00:42:34,079
look at the logic engine

1183
00:42:34,079 --> 00:42:36,800
uh which is uh

1184
00:42:36,800 --> 00:42:37,920
you know like

1185
00:42:37,920 --> 00:42:40,319
it will help you to process the data for

1186
00:42:40,319 --> 00:42:41,680
example if you know you have north

1187
00:42:41,680 --> 00:42:43,280
american contractor for example in

1188
00:42:43,280 --> 00:42:44,720
mexico in

1189
00:42:44,720 --> 00:42:46,560
canada and your companies in the us you

1190
00:42:46,560 --> 00:42:47,920
might want to start

1191
00:42:47,920 --> 00:42:48,800
uh

1192
00:42:48,800 --> 00:42:51,599
you know like in a sense suppressing

1193
00:42:51,599 --> 00:42:52,720
the

1194
00:42:52,720 --> 00:42:54,240
you know invalid

1195
00:42:54,240 --> 00:42:56,880
uh risky signings from that so if there

1196
00:42:56,880 --> 00:42:59,040
is a vpn and location based in north

1197
00:42:59,040 --> 00:43:00,160
america

1198
00:43:00,160 --> 00:43:01,040
and

1199
00:43:01,040 --> 00:43:02,720
specific account maybe they start with

1200
00:43:02,720 --> 00:43:05,280
you know uh prefix co and tr for

1201
00:43:05,280 --> 00:43:08,079
contractors so scanner success logged in

1202
00:43:08,079 --> 00:43:09,920
so if you see scanner in the last you

1203
00:43:09,920 --> 00:43:11,599
know

1204
00:43:11,599 --> 00:43:13,680
you observe brute force for example last

1205
00:43:13,680 --> 00:43:16,079
30 days and then you store it in your

1206
00:43:16,079 --> 00:43:19,040
miss and that if this particular app

1207
00:43:19,040 --> 00:43:21,200
coming in

1208
00:43:21,200 --> 00:43:24,880
uh successfully locked in error code 0

1209
00:43:24,880 --> 00:43:25,680
you

1210
00:43:25,680 --> 00:43:27,119
want to know that

1211
00:43:27,119 --> 00:43:29,839
so so that's that's like some some

1212
00:43:29,839 --> 00:43:32,720
sample scenarios that you can have of

1213
00:43:32,720 --> 00:43:34,720
course it you need to tailor it to up to

1214
00:43:34,720 --> 00:43:37,119
you this is why this tool is not

1215
00:43:37,119 --> 00:43:39,359
uh you need to configure it first in a

1216
00:43:39,359 --> 00:43:41,920
sense we get two reference db known and

1217
00:43:41,920 --> 00:43:44,720
bad so for example if you have b9s and

1218
00:43:44,720 --> 00:43:46,640
if you have fender s and

1219
00:43:46,640 --> 00:43:49,599
known vpn vpn or tor user you can add it

1220
00:43:49,599 --> 00:43:51,520
to this file and you can

1221
00:43:51,520 --> 00:43:54,400
you know like work on the logic on the

1222
00:43:54,400 --> 00:43:56,319
logic engine side

1223
00:43:56,319 --> 00:43:59,520
bad user agent suspicious as and

1224
00:43:59,520 --> 00:44:01,680
legacy user agents legacy applications

1225
00:44:01,680 --> 00:44:03,760
so this is just letting you know like

1226
00:44:03,760 --> 00:44:05,760
for example some legacy applications

1227
00:44:05,760 --> 00:44:07,440
being used and your policy for example

1228
00:44:07,440 --> 00:44:08,480
is not

1229
00:44:08,480 --> 00:44:10,880
allowing that so

1230
00:44:10,880 --> 00:44:13,599
and lastly we get reports input output

1231
00:44:13,599 --> 00:44:14,480
engine

1232
00:44:14,480 --> 00:44:16,800
so this is uh

1233
00:44:16,800 --> 00:44:18,560
just processing so we can't actually

1234
00:44:18,560 --> 00:44:20,640
using csv files

1235
00:44:20,640 --> 00:44:23,520
because it's fairly easy to get report

1236
00:44:23,520 --> 00:44:25,760
as a csv this day i think

1237
00:44:25,760 --> 00:44:28,800
most of the tools uh sim uh even the

1238
00:44:28,800 --> 00:44:30,400
microsoft tools are actually providing

1239
00:44:30,400 --> 00:44:33,680
csv files so from there uh you'll get

1240
00:44:33,680 --> 00:44:35,440
the

1241
00:44:35,440 --> 00:44:37,520
the you know like the data recorder and

1242
00:44:37,520 --> 00:44:39,760
then you put it into the input and then

1243
00:44:39,760 --> 00:44:41,920
you'll get a comment uh with some

1244
00:44:41,920 --> 00:44:43,040
enrichment

1245
00:44:43,040 --> 00:44:45,680
uh into the file after it's being you

1246
00:44:45,680 --> 00:44:48,319
know enriched by

1247
00:44:48,839 --> 00:44:51,680
azula so yeah azula step by step if i

1248
00:44:51,680 --> 00:44:54,480
try to break down what it it does

1249
00:44:54,480 --> 00:44:56,160
so you prepare the csv with the right

1250
00:44:56,160 --> 00:44:58,640
information uh you turn the azula will

1251
00:44:58,640 --> 00:45:00,800
transform the data just with the pandas

1252
00:45:00,800 --> 00:45:01,760
you know

1253
00:45:01,760 --> 00:45:05,280
modern big data stuff i will enrich ip

1254
00:45:05,280 --> 00:45:08,240
address information

1255
00:45:08,720 --> 00:45:10,000
it will apply the logic that you have

1256
00:45:10,000 --> 00:45:12,720
decided and you have coded i will conf

1257
00:45:12,720 --> 00:45:15,280
compare it with the reference db

1258
00:45:15,280 --> 00:45:17,440
bet and on of course depending on the

1259
00:45:17,440 --> 00:45:19,440
logic it will add the commands and add

1260
00:45:19,440 --> 00:45:21,599
the enrichment and the analyst threat

1261
00:45:21,599 --> 00:45:23,599
hunters will review it and complete the

1262
00:45:23,599 --> 00:45:25,440
result so this is definitely will bring

1263
00:45:25,440 --> 00:45:28,400
down the works of the

1264
00:45:28,720 --> 00:45:30,000
human

1265
00:45:30,000 --> 00:45:32,880
on this side so some screenshots so the

1266
00:45:32,880 --> 00:45:36,400
the logic so for example we get the

1267
00:45:36,400 --> 00:45:38,640
suspicious user agent we have phone

1268
00:45:38,640 --> 00:45:41,200
application so we know this is our

1269
00:45:41,200 --> 00:45:44,640
common application from phone

1270
00:45:44,800 --> 00:45:47,680
you get for example suspicious user

1271
00:45:47,680 --> 00:45:50,240
agent being used so this is the logic

1272
00:45:50,240 --> 00:45:52,640
and the middle one there to get we got

1273
00:45:52,640 --> 00:45:54,720
bina and telco for for example people in

1274
00:45:54,720 --> 00:45:56,240
canada people in india for our

1275
00:45:56,240 --> 00:45:58,160
consultant people in us for our

1276
00:45:58,160 --> 00:46:01,760
contractors consultant

1277
00:46:01,760 --> 00:46:04,079
so yeah so these tools will also enrich

1278
00:46:04,079 --> 00:46:05,520
the appearance so this is the form of

1279
00:46:05,520 --> 00:46:08,560
enrich ip address so we get the ip

1280
00:46:08,560 --> 00:46:11,119
we get is it data center is it you know

1281
00:46:11,119 --> 00:46:13,839
like vpn is it

1282
00:46:13,839 --> 00:46:14,720
we got

1283
00:46:14,720 --> 00:46:16,880
location city we got

1284
00:46:16,880 --> 00:46:20,000
the asn and we got the host name when it

1285
00:46:20,000 --> 00:46:21,760
found of course

1286
00:46:21,760 --> 00:46:24,400
uh so yeah pretty much the azula will

1287
00:46:24,400 --> 00:46:26,400
turn the one on the top so all the all

1288
00:46:26,400 --> 00:46:28,560
those information coming from

1289
00:46:28,560 --> 00:46:30,240
the

1290
00:46:30,240 --> 00:46:34,000
azure risky signing also signer reports

1291
00:46:34,000 --> 00:46:35,119
and then

1292
00:46:35,119 --> 00:46:37,680
on the after processing you'll get you

1293
00:46:37,680 --> 00:46:39,119
know ip info

1294
00:46:39,119 --> 00:46:41,119
because this is our

1295
00:46:41,119 --> 00:46:42,800
the arrangement that we do from app info

1296
00:46:42,800 --> 00:46:45,599
super.us to let you know is it

1297
00:46:45,599 --> 00:46:46,880
um

1298
00:46:46,880 --> 00:46:50,800
you know like is it a hosting is it a

1299
00:46:50,800 --> 00:46:53,920
data center is it a vpn is it a tour and

1300
00:46:53,920 --> 00:46:55,359
then from there all the logics

1301
00:46:55,359 --> 00:46:57,359
processing it will provide you with some

1302
00:46:57,359 --> 00:46:58,880
comments sometimes it will be empty

1303
00:46:58,880 --> 00:47:00,480
because there's no logic that apply to

1304
00:47:00,480 --> 00:47:01,920
that so those are the stuff that you

1305
00:47:01,920 --> 00:47:03,680
need to focus on you can actually see

1306
00:47:03,680 --> 00:47:05,920
some suspicious stuff from legacy

1307
00:47:05,920 --> 00:47:08,240
application the last few lines so it's

1308
00:47:08,240 --> 00:47:10,480
being flagged saying this is possibly

1309
00:47:10,480 --> 00:47:12,480
brute force as you can note on the count

1310
00:47:12,480 --> 00:47:13,599
on the very

1311
00:47:13,599 --> 00:47:15,920
right side bottom bottom right

1312
00:47:15,920 --> 00:47:17,599
it's pretty high so this is why the

1313
00:47:17,599 --> 00:47:19,040
application telling this is actually

1314
00:47:19,040 --> 00:47:20,400
brute force

1315
00:47:20,400 --> 00:47:22,480
demonstration just like

1316
00:47:22,480 --> 00:47:24,800
demonstrating missoula fighting versus

1317
00:47:24,800 --> 00:47:25,680
hank

1318
00:47:25,680 --> 00:47:29,680
uh so yeah let's let's play the video

1319
00:47:29,680 --> 00:47:32,079
i'm gonna grab my mouse so as you can

1320
00:47:32,079 --> 00:47:33,680
see this is the excel and all the

1321
00:47:33,680 --> 00:47:36,839
information as i mentioned is provided

1322
00:47:36,839 --> 00:47:39,760
by uh your

1323
00:47:39,760 --> 00:47:41,760
you know azurity

1324
00:47:41,760 --> 00:47:44,000
uh reports and then from there we are

1325
00:47:44,000 --> 00:47:46,240
recording from which is just username ip

1326
00:47:46,240 --> 00:47:49,040
address user agent application access

1327
00:47:49,040 --> 00:47:51,599
error code failure reason

1328
00:47:51,599 --> 00:47:53,680
just for you know like better for our

1329
00:47:53,680 --> 00:47:56,640
eyes uh risk reason

1330
00:47:56,640 --> 00:47:58,480
and then count

1331
00:47:58,480 --> 00:48:00,559
so what gonna

1332
00:48:00,559 --> 00:48:02,880
happen

1333
00:48:02,880 --> 00:48:05,119
uh so yeah we just close that we we put

1334
00:48:05,119 --> 00:48:07,440
it in the folder that were

1335
00:48:07,440 --> 00:48:08,720
i don't think

1336
00:48:08,720 --> 00:48:09,920
whatever

1337
00:48:09,920 --> 00:48:11,680
the other script will read it and mainly

1338
00:48:11,680 --> 00:48:13,359
it's now in the download folder so if

1339
00:48:13,359 --> 00:48:15,520
you put the reference file

1340
00:48:15,520 --> 00:48:17,599
uh sorry the input there and we'll read

1341
00:48:17,599 --> 00:48:19,520
it from there directly because we use

1342
00:48:19,520 --> 00:48:22,960
elastic and kibana's save

1343
00:48:22,960 --> 00:48:25,440
csv directly to download folder

1344
00:48:25,440 --> 00:48:26,480
we just

1345
00:48:26,480 --> 00:48:28,880
practicality pretty much so some ascii

1346
00:48:28,880 --> 00:48:29,920
are

1347
00:48:29,920 --> 00:48:32,640
an enrichment reading from just be done

1348
00:48:32,640 --> 00:48:33,680
i will

1349
00:48:33,680 --> 00:48:35,280
tell you how many app addresses they are

1350
00:48:35,280 --> 00:48:37,280
sitting unique also

1351
00:48:37,280 --> 00:48:39,680
and then you know enrichment uh for some

1352
00:48:39,680 --> 00:48:40,800
reason i

1353
00:48:40,800 --> 00:48:43,760
forget to scroll down on the console

1354
00:48:43,760 --> 00:48:45,760
so i'm running it on pycharm you can run

1355
00:48:45,760 --> 00:48:48,160
it using you know console you can apply

1356
00:48:48,160 --> 00:48:49,440
it to your

1357
00:48:49,440 --> 00:48:51,680
uh automated solution right away it's

1358
00:48:51,680 --> 00:48:55,119
it's just a piece of code um

1359
00:48:55,119 --> 00:48:56,960
yeah and then from there it will tell

1360
00:48:56,960 --> 00:48:58,720
you okay you have this file that you

1361
00:48:58,720 --> 00:49:01,359
need to open and it's already enriched

1362
00:49:01,359 --> 00:49:04,880
and i'm opening that file now there

1363
00:49:05,920 --> 00:49:07,520
so yeah

1364
00:49:07,520 --> 00:49:08,400
so

1365
00:49:08,400 --> 00:49:11,359
we are almost there

1366
00:49:11,359 --> 00:49:13,760
as you can see ipinfo is being enriched

1367
00:49:13,760 --> 00:49:16,240
there's some encoding problems with you

1368
00:49:16,240 --> 00:49:17,680
know

1369
00:49:17,680 --> 00:49:19,680
extra characters so that's something

1370
00:49:19,680 --> 00:49:21,520
that you want to

1371
00:49:21,520 --> 00:49:24,880
play around as an improvement

1372
00:49:24,880 --> 00:49:27,200
but i'll tell you uh

1373
00:49:27,200 --> 00:49:28,640
city

1374
00:49:28,640 --> 00:49:31,280
which asn and the host name will found

1375
00:49:31,280 --> 00:49:33,520
and then spur us will tell you

1376
00:49:33,520 --> 00:49:35,680
pretty much is it data center is it you

1377
00:49:35,680 --> 00:49:37,839
know like a vpn

1378
00:49:37,839 --> 00:49:40,000
and it will comment it as you can see it

1379
00:49:40,000 --> 00:49:42,160
come in most most of everything but

1380
00:49:42,160 --> 00:49:43,280
there is

1381
00:49:43,280 --> 00:49:45,760
a benign one that we already see we know

1382
00:49:45,760 --> 00:49:47,200
based from our experience from

1383
00:49:47,200 --> 00:49:49,119
historical data that the user from

1384
00:49:49,119 --> 00:49:50,559
certain isp

1385
00:49:50,559 --> 00:49:52,800
from certain location it's normally

1386
00:49:52,800 --> 00:49:55,599
contractors or consultant and we get you

1387
00:49:55,599 --> 00:49:56,960
know like some

1388
00:49:56,960 --> 00:50:00,160
phone observe

1389
00:50:00,160 --> 00:50:02,400
and then we get b9

1390
00:50:02,400 --> 00:50:05,280
stuff also so we get for example

1391
00:50:05,280 --> 00:50:06,960
a

1392
00:50:06,960 --> 00:50:08,720
mobile application being used which is

1393
00:50:08,720 --> 00:50:11,359
outlook mobile which is line four

1394
00:50:11,359 --> 00:50:13,200
from phone and then we get some bad one

1395
00:50:13,200 --> 00:50:14,880
on the bottom we can actually detect

1396
00:50:14,880 --> 00:50:16,480
it's possibly an attack because it's

1397
00:50:16,480 --> 00:50:18,000
coming from

1398
00:50:18,000 --> 00:50:19,520
um

1399
00:50:19,520 --> 00:50:21,200
you know

1400
00:50:21,200 --> 00:50:23,040
similar app addresses trying to access

1401
00:50:23,040 --> 00:50:24,559
different account

1402
00:50:24,559 --> 00:50:27,440
and trying to combination creating a lot

1403
00:50:27,440 --> 00:50:29,920
of error messages using

1404
00:50:29,920 --> 00:50:31,760
uh you know like suspicious user agent

1405
00:50:31,760 --> 00:50:34,160
which is the microsoft active

1406
00:50:34,160 --> 00:50:35,920
uh sync

1407
00:50:35,920 --> 00:50:39,680
and yeah so based on account also so

1408
00:50:39,680 --> 00:50:41,119
this is our

1409
00:50:41,119 --> 00:50:42,079
uh

1410
00:50:42,079 --> 00:50:45,680
the demo of the azula

1411
00:50:45,680 --> 00:50:48,000
so i'm gonna move to the next slide and

1412
00:50:48,000 --> 00:50:50,720
we're gonna go to some closing remarks

1413
00:50:50,720 --> 00:50:52,480
uh

1414
00:50:52,480 --> 00:50:54,480
blind spots

1415
00:50:54,480 --> 00:50:56,960
so as your wrist model it's great but of

1416
00:50:56,960 --> 00:50:58,720
course it can miss some of the attacks

1417
00:50:58,720 --> 00:51:01,280
so it's always a good idea to review all

1418
00:51:01,280 --> 00:51:03,040
sign-in locks

1419
00:51:03,040 --> 00:51:05,119
when you can don't try to push it right

1420
00:51:05,119 --> 00:51:06,559
away don't try to okay i'm going to

1421
00:51:06,559 --> 00:51:08,079
review all the sign-in logs i'm telling

1422
00:51:08,079 --> 00:51:09,200
you there's like

1423
00:51:09,200 --> 00:51:11,760
millions if not billions of them

1424
00:51:11,760 --> 00:51:13,520
coming in

1425
00:51:13,520 --> 00:51:15,920
you know all the time so

1426
00:51:15,920 --> 00:51:17,920
set your priority rights and the model

1427
00:51:17,920 --> 00:51:20,079
is really great but it can miss

1428
00:51:20,079 --> 00:51:22,400
something make sure to keep that in mind

1429
00:51:22,400 --> 00:51:23,200
uh

1430
00:51:23,200 --> 00:51:24,880
intel information can be misleading

1431
00:51:24,880 --> 00:51:26,240
sometimes

1432
00:51:26,240 --> 00:51:27,599
even if you compare it from different

1433
00:51:27,599 --> 00:51:30,079
sources because sometimes they just pull

1434
00:51:30,079 --> 00:51:32,880
it from one real sources

1435
00:51:32,880 --> 00:51:35,280
so yeah still intel

1436
00:51:35,280 --> 00:51:37,839
accidentally added intel

1437
00:51:37,839 --> 00:51:40,160
you know uh so it could happen so make

1438
00:51:40,160 --> 00:51:42,880
sure that you're aware of that uh

1439
00:51:42,880 --> 00:51:44,960
you can actually confirm with the user

1440
00:51:44,960 --> 00:51:48,480
uh if you're questioning uh some of the

1441
00:51:48,480 --> 00:51:50,800
you know like ip addressing you're

1442
00:51:50,800 --> 00:51:53,839
seeing on your environment

1443
00:51:53,839 --> 00:51:55,119
so

1444
00:51:55,119 --> 00:51:57,280
creating a known lease or like a low

1445
00:51:57,280 --> 00:52:00,240
lease i would say based on signals

1446
00:52:00,240 --> 00:52:01,839
uh

1447
00:52:01,839 --> 00:52:04,559
it will create a blind spots so you need

1448
00:52:04,559 --> 00:52:06,559
to trade it carefully so i'm talking

1449
00:52:06,559 --> 00:52:09,200
about what uh approving

1450
00:52:09,200 --> 00:52:11,280
or like making known list based on the

1451
00:52:11,280 --> 00:52:14,319
a's and based on ip address block

1452
00:52:14,319 --> 00:52:16,800
based on you know a certain application

1453
00:52:16,800 --> 00:52:19,760
so it will be blind spot trade carefully

1454
00:52:19,760 --> 00:52:21,680
and make sure before you do it you need

1455
00:52:21,680 --> 00:52:23,440
to accept the risks and you understand

1456
00:52:23,440 --> 00:52:25,520
that there is there

1457
00:52:25,520 --> 00:52:27,119
improvement ideas

1458
00:52:27,119 --> 00:52:28,800
so we got correlation with historical

1459
00:52:28,800 --> 00:52:29,680
data

1460
00:52:29,680 --> 00:52:32,960
it's a live stream of data using sim api

1461
00:52:32,960 --> 00:52:35,760
so you can use it with elastic and 0 and

1462
00:52:35,760 --> 00:52:36,800
splunk

1463
00:52:36,800 --> 00:52:38,160
some other stuff

1464
00:52:38,160 --> 00:52:39,599
you can actually do additional

1465
00:52:39,599 --> 00:52:41,920
enrichment so you remember that

1466
00:52:41,920 --> 00:52:44,079
when when their error code contains

1467
00:52:44,079 --> 00:52:46,480
others you need actually to look up for

1468
00:52:46,480 --> 00:52:48,800
it i actually have a prototype

1469
00:52:48,800 --> 00:52:50,480
in the code that actually scraped the

1470
00:52:50,480 --> 00:52:51,920
microsoft page and it's just

1471
00:52:51,920 --> 00:52:54,559
automatically pull the data based on the

1472
00:52:54,559 --> 00:52:56,960
error code unfortunately i don't have it

1473
00:52:56,960 --> 00:53:00,000
ready yet but it's an idea there uh ip

1474
00:53:00,000 --> 00:53:02,880
abuse database this is known as scanner

1475
00:53:02,880 --> 00:53:06,240
gray noise uh maybe you can even enrich

1476
00:53:06,240 --> 00:53:08,160
uh your user

1477
00:53:08,160 --> 00:53:10,000
with the hr system so you can pull their

1478
00:53:10,000 --> 00:53:12,000
location you can pull where their office

1479
00:53:12,000 --> 00:53:14,640
is you can pull like which time zone

1480
00:53:14,640 --> 00:53:16,319
you're working so if you see some login

1481
00:53:16,319 --> 00:53:18,960
in the weird time then okay this is

1482
00:53:18,960 --> 00:53:20,319
probably not the user it's probably

1483
00:53:20,319 --> 00:53:23,680
someone else you can connect uh

1484
00:53:23,680 --> 00:53:26,160
loggings from different sources audit

1485
00:53:26,160 --> 00:53:28,640
locks from the you know azure 80 logs

1486
00:53:28,640 --> 00:53:31,760
and all 3x65 locks you can actually

1487
00:53:31,760 --> 00:53:33,599
lock them

1488
00:53:33,599 --> 00:53:35,119
use those logs

1489
00:53:35,119 --> 00:53:38,319
and you know compare it

1490
00:53:38,319 --> 00:53:39,440
with the

1491
00:53:39,440 --> 00:53:41,760
situation before what changes they made

1492
00:53:41,760 --> 00:53:44,240
after a compromise

1493
00:53:44,240 --> 00:53:46,160
you can actually use proper database

1494
00:53:46,160 --> 00:53:48,079
instead of text to file like what i'm

1495
00:53:48,079 --> 00:53:50,800
doing here you can use mongodb json base

1496
00:53:50,800 --> 00:53:53,680
or you can use sql it's up to you

1497
00:53:53,680 --> 00:53:55,599
we are building something like that in

1498
00:53:55,599 --> 00:53:57,440
production for us and we are using

1499
00:53:57,440 --> 00:53:58,880
mongodb so

1500
00:53:58,880 --> 00:54:01,200
txt file is great for now but once you

1501
00:54:01,200 --> 00:54:02,960
scale it it's probably not going to be

1502
00:54:02,960 --> 00:54:04,800
great in terms of like input output

1503
00:54:04,800 --> 00:54:06,160
processing

1504
00:54:06,160 --> 00:54:09,359
uh so yeah so thank you so much everyone

1505
00:54:09,359 --> 00:54:12,240
uh if my time is not wrong i think we

1506
00:54:12,240 --> 00:54:13,440
are having

1507
00:54:13,440 --> 00:54:15,839
pretty good uh time here

1508
00:54:15,839 --> 00:54:18,480
and there's still time for question you

1509
00:54:18,480 --> 00:54:20,559
go to the discord and ask questions i'll

1510
00:54:20,559 --> 00:54:22,000
be there or you can

1511
00:54:22,000 --> 00:54:24,480
contact me on you know like twitter

1512
00:54:24,480 --> 00:54:26,319
linkedin uh

1513
00:54:26,319 --> 00:54:30,000
yeah my information is available on the

1514
00:54:30,000 --> 00:54:31,680
texas cyber summit page thank you so

1515
00:54:31,680 --> 00:54:34,000
much everyone uh i hope you have a great

1516
00:54:34,000 --> 00:54:36,400
time here i hope you have a great day

1517
00:54:36,400 --> 00:54:41,160
uh yeah thank you

