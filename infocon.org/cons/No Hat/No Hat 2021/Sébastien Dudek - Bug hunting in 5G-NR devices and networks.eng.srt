1
00:00:02,480 --> 00:00:05,260
uh

2
00:00:05,260 --> 00:00:08,500
[Music]

3
00:00:10,700 --> 00:00:21,039
[Music]

4
00:00:21,039 --> 00:00:24,039
me

5
00:00:24,410 --> 00:00:31,679
[Music]

6
00:00:31,679 --> 00:00:33,840
thank you thank you marco thank you also

7
00:00:33,840 --> 00:00:35,600
for the invitation it's like a real

8
00:00:35,600 --> 00:00:37,680
pleasure it's the first time since two

9
00:00:37,680 --> 00:00:39,600
years that i'm actually doing a

10
00:00:39,600 --> 00:00:42,800
face-to-face uh presentation today uh

11
00:00:42,800 --> 00:00:45,360
and it is like it is it is not like

12
00:00:45,360 --> 00:00:46,640
youtube like you are streaming to

13
00:00:46,640 --> 00:00:49,200
youtube actually so kind of surprising

14
00:00:49,200 --> 00:00:52,000
so uh welcome to the last talk i know

15
00:00:52,000 --> 00:00:53,920
there is like a big pressure uh for me

16
00:00:53,920 --> 00:00:56,160
because um i mean i'm just like in the

17
00:00:56,160 --> 00:00:59,760
middle of this presentation and the beer

18
00:00:59,760 --> 00:01:02,160
event so oh yeah i know that

19
00:01:02,160 --> 00:01:04,559
he won't probably the beer but let's

20
00:01:04,559 --> 00:01:06,400
just like do this talk

21
00:01:06,400 --> 00:01:08,400
just before that so welcome to the

22
00:01:08,400 --> 00:01:11,200
bulkhunting in 5g and air and device

23
00:01:11,200 --> 00:01:12,560
network so

24
00:01:12,560 --> 00:01:15,200
this presentation is about how to

25
00:01:15,200 --> 00:01:17,520
do some assessments on the radio side on

26
00:01:17,520 --> 00:01:20,320
the course side and also look forward

27
00:01:20,320 --> 00:01:23,280
with some protocol stack vulnerability

28
00:01:23,280 --> 00:01:25,520
but it will not go into all the details

29
00:01:25,520 --> 00:01:26,960
about that i will probably just like

30
00:01:26,960 --> 00:01:29,040
release some videos about that but it

31
00:01:29,040 --> 00:01:30,240
will just

32
00:01:30,240 --> 00:01:32,400
give you some steps that will allow you

33
00:01:32,400 --> 00:01:33,759
for example to

34
00:01:33,759 --> 00:01:36,320
i mean to progress into this domain

35
00:01:36,320 --> 00:01:39,040
so i'm dex sebastian i'm the founder of

36
00:01:39,040 --> 00:01:41,200
the pentest company you know already

37
00:01:41,200 --> 00:01:42,720
that i founded the company which is

38
00:01:42,720 --> 00:01:44,960
called painters uh i'm alone in this

39
00:01:44,960 --> 00:01:47,680
company but sometimes people also

40
00:01:47,680 --> 00:01:49,759
wants me to to use some

41
00:01:49,759 --> 00:01:52,560
i mean fancy titles like cto ceo so i

42
00:01:52,560 --> 00:01:54,720
was like maybe thinking that or i can

43
00:01:54,720 --> 00:01:56,640
maybe uh just provide in my cart

44
00:01:56,640 --> 00:01:59,520
business card i'm a cto that means

45
00:01:59,520 --> 00:02:02,399
chief taxes officers at some point but

46
00:02:02,399 --> 00:02:03,680
uh yeah

47
00:02:03,680 --> 00:02:05,520
this is one of the things that i can

48
00:02:05,520 --> 00:02:06,719
just like

49
00:02:06,719 --> 00:02:09,280
write on my uh business card today um

50
00:02:09,280 --> 00:02:12,640
and also um the marco didn't say but so

51
00:02:12,640 --> 00:02:14,160
i was like i mean

52
00:02:14,160 --> 00:02:16,800
uh i did my company during the coffee

53
00:02:16,800 --> 00:02:18,879
time and then also joined um three micro

54
00:02:18,879 --> 00:02:20,400
so i'm working also

55
00:02:20,400 --> 00:02:22,480
with marco on ftr

56
00:02:22,480 --> 00:02:26,800
doing industrial iot mobile et cetera

57
00:02:26,800 --> 00:02:28,319
and yeah if you're interested i will not

58
00:02:28,319 --> 00:02:30,239
bother you about all these services that

59
00:02:30,239 --> 00:02:31,360
pentest provides but if you're

60
00:02:31,360 --> 00:02:33,200
interested about trainings in sdr radio

61
00:02:33,200 --> 00:02:35,040
etc you can always like go to the

62
00:02:35,040 --> 00:02:38,400
website so as a company which works on

63
00:02:38,400 --> 00:02:40,319
radio

64
00:02:40,319 --> 00:02:42,560
i'm working a lot with sdr stuff with a

65
00:02:42,560 --> 00:02:46,000
lot of radio analyzers so here is just

66
00:02:46,000 --> 00:02:48,720
part of my stuff you don't see or the i

67
00:02:48,720 --> 00:02:51,040
mean the other side which is kind of

68
00:02:51,040 --> 00:02:52,480
messy because there's like a lot of

69
00:02:52,480 --> 00:02:54,160
boxes everywhere and i don't have like a

70
00:02:54,160 --> 00:02:56,000
lot of space but still you can see like

71
00:02:56,000 --> 00:02:57,920
part of the yes there that i'm using and

72
00:02:57,920 --> 00:03:00,239
part of this the air i'm using is also

73
00:03:00,239 --> 00:03:03,440
used on the 2g to 5g actually

74
00:03:03,440 --> 00:03:07,040
so our um i mean as the

75
00:03:07,040 --> 00:03:08,959
title purpose we will talk about 5g

76
00:03:08,959 --> 00:03:11,120
stuff so i will see the evolution of

77
00:03:11,120 --> 00:03:12,720
mobile network in brief because we

78
00:03:12,720 --> 00:03:15,519
cannot i cannot talk about what happened

79
00:03:15,519 --> 00:03:17,519
30 years and more than 30 years ago but

80
00:03:17,519 --> 00:03:19,519
i would just like you know do a quick

81
00:03:19,519 --> 00:03:21,040
presentation then

82
00:03:21,040 --> 00:03:23,040
we will talk about uh how to perform

83
00:03:23,040 --> 00:03:25,519
assessment in radio with 5g

84
00:03:25,519 --> 00:03:28,319
how to work with 5g new call network and

85
00:03:28,319 --> 00:03:30,640
then look for i mean look further on

86
00:03:30,640 --> 00:03:32,319
protocol stack vulnerability which could

87
00:03:32,319 --> 00:03:34,319
be like also interesting

88
00:03:34,319 --> 00:03:35,840
and then conclude

89
00:03:35,840 --> 00:03:38,480
uh so now let's talk about the evolution

90
00:03:38,480 --> 00:03:40,720
you know uh at the beginning when you

91
00:03:40,720 --> 00:03:41,760
know

92
00:03:41,760 --> 00:03:43,440
some of some of you are probably like

93
00:03:43,440 --> 00:03:44,560
too young

94
00:03:44,560 --> 00:03:46,480
some others knows exactly what i'm

95
00:03:46,480 --> 00:03:48,400
talking about with the one g so with the

96
00:03:48,400 --> 00:03:49,920
one g you remember the phone that was

97
00:03:49,920 --> 00:03:52,799
like bigger than you had so uh you had

98
00:03:52,799 --> 00:03:55,519
these things actually but now

99
00:03:55,519 --> 00:03:58,000
you know in 2021 you have five i mean

100
00:03:58,000 --> 00:04:00,000
you have 4g actually you are you have

101
00:04:00,000 --> 00:04:03,439
the 5g nsa that i will talk about and in

102
00:04:03,439 --> 00:04:06,319
normally in 2022 you will have the real

103
00:04:06,319 --> 00:04:09,680
5g but yet you you just have like uh i

104
00:04:09,680 --> 00:04:12,159
mean the transition between the real 5g

105
00:04:12,159 --> 00:04:15,360
and the 4g actually so

106
00:04:15,360 --> 00:04:16,959
and also what is interesting is that

107
00:04:16,959 --> 00:04:20,000
yeah we are already already in 2021

108
00:04:20,000 --> 00:04:22,960
we are actually moving into the real 5g

109
00:04:22,960 --> 00:04:26,160
but we are already talking about 6g so i

110
00:04:26,160 --> 00:04:28,000
will not talk about 6g but we can always

111
00:04:28,000 --> 00:04:30,080
like talk after that uh during some

112
00:04:30,080 --> 00:04:33,360
beers but yeah let's just focus on what

113
00:04:33,360 --> 00:04:36,720
will happen in 2022 actually

114
00:04:36,720 --> 00:04:38,720
um and yeah

115
00:04:38,720 --> 00:04:40,080
about

116
00:04:40,080 --> 00:04:42,240
the differences between 2g and 4g for

117
00:04:42,240 --> 00:04:44,479
example you should probably see that

118
00:04:44,479 --> 00:04:46,479
there are some similarities between for

119
00:04:46,479 --> 00:04:48,080
example 2g

120
00:04:48,080 --> 00:04:52,240
uh and 2d 2.5 g which is gprs edge etc

121
00:04:52,240 --> 00:04:55,040
and also umts because umgs use exactly

122
00:04:55,040 --> 00:04:57,600
the same bricks as before and 4g is

123
00:04:57,600 --> 00:04:59,520
actually also the same bricks but a

124
00:04:59,520 --> 00:05:04,160
little bit more evolved from from 3g but

125
00:05:04,160 --> 00:05:05,039
then

126
00:05:05,039 --> 00:05:07,759
you are you normally currently i don't

127
00:05:07,759 --> 00:05:10,880
know if it is the case but in france we

128
00:05:10,880 --> 00:05:13,919
have we are smoothly moving into 5g and

129
00:05:13,919 --> 00:05:16,479
the move is actually using the for the

130
00:05:16,479 --> 00:05:18,720
4g architecture and

131
00:05:18,720 --> 00:05:21,759
and also putting an antenna or in a 5g

132
00:05:21,759 --> 00:05:23,680
antenna which will actually communicate

133
00:05:23,680 --> 00:05:26,000
with the 4g antenna in order to provide

134
00:05:26,000 --> 00:05:28,240
you the 5g so actually the 5g antenna

135
00:05:28,240 --> 00:05:31,039
you will see is called a 5g nsa so it is

136
00:05:31,039 --> 00:05:33,199
a non-steadalone

137
00:05:33,199 --> 00:05:34,479
antenna

138
00:05:34,479 --> 00:05:37,039
and it will actually also

139
00:05:37,039 --> 00:05:40,479
be dependent on a 5g of a 4g antenna

140
00:05:40,479 --> 00:05:42,320
sorry to be able to provide you the

141
00:05:42,320 --> 00:05:44,400
network and it will reuse exactly the

142
00:05:44,400 --> 00:05:46,560
same networks as 4g because it is using

143
00:05:46,560 --> 00:05:48,560
the 4g networks in the 4g architecture

144
00:05:48,560 --> 00:05:50,080
at some point but

145
00:05:50,080 --> 00:05:52,720
normally in 2022 you will see uh

146
00:05:52,720 --> 00:05:55,280
something like that so and then uh there

147
00:05:55,280 --> 00:05:57,199
will be like a clear evolution because

148
00:05:57,199 --> 00:05:59,440
not only the radio access will be very

149
00:05:59,440 --> 00:06:01,840
fast uh because more efficient because

150
00:06:01,840 --> 00:06:05,039
we use like better anchoring better uh

151
00:06:05,039 --> 00:06:06,479
i mean mapping

152
00:06:06,479 --> 00:06:08,560
for for the samples in order to provide

153
00:06:08,560 --> 00:06:10,880
uh this uh a lot of samples over there

154
00:06:10,880 --> 00:06:14,160
but also we will use uh a network

155
00:06:14,160 --> 00:06:16,800
which will be very uh i mean scalable uh

156
00:06:16,800 --> 00:06:19,440
because the network will be virtualized

157
00:06:19,440 --> 00:06:21,440
at some point so even for example some

158
00:06:21,440 --> 00:06:23,759
providers like amazon or google et

159
00:06:23,759 --> 00:06:25,280
cetera will be able for example to

160
00:06:25,280 --> 00:06:28,319
provide the all the the back ends which

161
00:06:28,319 --> 00:06:31,759
will allow you for example to uh to

162
00:06:31,759 --> 00:06:34,319
i mean to communicate at some point so

163
00:06:34,319 --> 00:06:37,520
normally uh in the oldest architecture

164
00:06:37,520 --> 00:06:39,759
the the operators was responsible for

165
00:06:39,759 --> 00:06:41,120
all the uh

166
00:06:41,120 --> 00:06:44,080
all the stuff how the car behind but

167
00:06:44,080 --> 00:06:46,639
uh in the real 5g uh

168
00:06:46,639 --> 00:06:48,960
it's it will be much much like that is

169
00:06:48,960 --> 00:06:51,599
that the operator will be able to host

170
00:06:51,599 --> 00:06:54,720
some parts and then the uh

171
00:06:54,720 --> 00:06:57,599
aws and google et cetera will be hosting

172
00:06:57,599 --> 00:06:59,680
also uh the same thing in order for

173
00:06:59,680 --> 00:07:02,000
example for the operator to just like do

174
00:07:02,000 --> 00:07:04,319
some economy

175
00:07:04,319 --> 00:07:06,960
so now let's talk about the radio and uh

176
00:07:06,960 --> 00:07:07,759
um

177
00:07:07,759 --> 00:07:10,960
doing the 5g i mean i was interesting to

178
00:07:10,960 --> 00:07:12,639
go straight to the point go straight to

179
00:07:12,639 --> 00:07:15,120
the 5gsa so i just bought a lot of

180
00:07:15,120 --> 00:07:17,120
devices i mean a lot of devices i do

181
00:07:17,120 --> 00:07:19,599
like six segment devices and here you

182
00:07:19,599 --> 00:07:22,639
just like see one one part of it and uh

183
00:07:22,639 --> 00:07:24,639
each of these devices are from different

184
00:07:24,639 --> 00:07:26,479
bands so you can see like there's like a

185
00:07:26,479 --> 00:07:28,240
samsung it is not obvious but there's a

186
00:07:28,240 --> 00:07:30,800
samsung there's also a simcom uh there's

187
00:07:30,800 --> 00:07:34,479
a y way uh there's also an oppo uh uh

188
00:07:34,479 --> 00:07:35,680
phone in here

189
00:07:35,680 --> 00:07:38,000
and the other one is an lg velvet

190
00:07:38,000 --> 00:07:41,520
actually but yeah with all these targets

191
00:07:41,520 --> 00:07:43,360
all these targets are using also a

192
00:07:43,360 --> 00:07:46,319
different modem modern vendors so some

193
00:07:46,319 --> 00:07:48,960
of some devices use qualcomm some others

194
00:07:48,960 --> 00:07:53,680
use ic silicon some others are using

195
00:07:53,840 --> 00:07:54,960
exynos

196
00:07:54,960 --> 00:07:57,440
so yeah i pick just like different

197
00:07:57,440 --> 00:07:59,120
targets with different modems in order

198
00:07:59,120 --> 00:08:00,720
to see what are the differences but also

199
00:08:00,720 --> 00:08:02,240
to find some vulnerability on those

200
00:08:02,240 --> 00:08:04,479
targets so yeah

201
00:08:04,479 --> 00:08:06,319
and the the thing is that spicerport you

202
00:08:06,319 --> 00:08:08,080
see the card the the sim card which is

203
00:08:08,080 --> 00:08:09,599
in here i mean the sim card the simcom

204
00:08:09,599 --> 00:08:11,440
card which is in here which is the pci

205
00:08:11,440 --> 00:08:14,000
card in the middle is something that is

206
00:08:14,000 --> 00:08:16,639
mostly used for example in iot stuff

207
00:08:16,639 --> 00:08:19,759
generally it is not in pci it is mostly

208
00:08:19,759 --> 00:08:21,759
soldered on the chip but i use that

209
00:08:21,759 --> 00:08:23,919
because it is easy for me for example to

210
00:08:23,919 --> 00:08:26,879
plug it and to put it for example in the

211
00:08:26,879 --> 00:08:30,800
in a dev kit uh mcu etc in order to just

212
00:08:30,800 --> 00:08:33,120
like play with that and we will see also

213
00:08:33,120 --> 00:08:34,799
what is interesting here with that with

214
00:08:34,799 --> 00:08:36,640
this kind of model

215
00:08:36,640 --> 00:08:39,200
so yeah mostly these devices are used

216
00:08:39,200 --> 00:08:41,279
for example i mean they provide you the

217
00:08:41,279 --> 00:08:42,559
5g stack

218
00:08:42,559 --> 00:08:44,320
but we will see that

219
00:08:44,320 --> 00:08:45,760
at some point it will not provide you

220
00:08:45,760 --> 00:08:48,880
the full 5g stack with some some

221
00:08:48,880 --> 00:08:51,760
some targets but also these targets can

222
00:08:51,760 --> 00:08:55,680
also do 2g 3g etc except for example

223
00:08:55,680 --> 00:08:57,200
the module which is

224
00:08:57,200 --> 00:09:00,480
uh on you know on the middle

225
00:09:00,480 --> 00:09:02,800
and also because

226
00:09:02,800 --> 00:09:03,760
i mean

227
00:09:03,760 --> 00:09:05,920
using for example a network or an

228
00:09:05,920 --> 00:09:07,839
operator network i mean spawning for

229
00:09:07,839 --> 00:09:10,800
example a network is not allowed

230
00:09:10,800 --> 00:09:12,959
if you want to do that uh try to isolate

231
00:09:12,959 --> 00:09:14,480
this network so there's like plenty of

232
00:09:14,480 --> 00:09:16,240
ways to do that i have actually a

233
00:09:16,240 --> 00:09:18,080
faraday cage for that so i can just like

234
00:09:18,080 --> 00:09:19,279
put all the

235
00:09:19,279 --> 00:09:21,760
uh the antenna i need and i can then do

236
00:09:21,760 --> 00:09:24,240
a pair for my test without having my my

237
00:09:24,240 --> 00:09:26,480
neighbor think that hey this is like a

238
00:09:26,480 --> 00:09:28,240
strange signal in here blah blah blah so

239
00:09:28,240 --> 00:09:30,080
yeah it will avoid you a lot of things

240
00:09:30,080 --> 00:09:32,000
and also we have regulators that are

241
00:09:32,000 --> 00:09:33,839
always checking around what you are

242
00:09:33,839 --> 00:09:35,440
doing sometimes in france which is

243
00:09:35,440 --> 00:09:38,160
called the nrf uh which always pass with

244
00:09:38,160 --> 00:09:39,600
like a i mean

245
00:09:39,600 --> 00:09:40,800
with a bus

246
00:09:40,800 --> 00:09:42,959
and some antennas to sport some

247
00:09:42,959 --> 00:09:45,680
fake base station etc so you have to be

248
00:09:45,680 --> 00:09:47,920
sometimes careful about that but still

249
00:09:47,920 --> 00:09:49,519
there are some cheap ways to avoid for

250
00:09:49,519 --> 00:09:51,120
example to buy some stuff you can always

251
00:09:51,120 --> 00:09:54,160
like do your homemade um viral decay

252
00:09:54,160 --> 00:09:56,720
just just for example using a simple

253
00:09:56,720 --> 00:09:59,440
sugar box like that mmx box and then on

254
00:09:59,440 --> 00:10:02,240
software you can just like

255
00:10:02,240 --> 00:10:05,600
use for example some uh attenuators and

256
00:10:05,600 --> 00:10:07,600
also in the hardware um between the

257
00:10:07,600 --> 00:10:09,440
files but the antenna and also the the

258
00:10:09,440 --> 00:10:11,519
fake base station you can use uh some

259
00:10:11,519 --> 00:10:13,440
attenuators too so you can do that in

260
00:10:13,440 --> 00:10:16,560
software as as well as hardware

261
00:10:16,560 --> 00:10:19,040
but still it is not certified but here

262
00:10:19,040 --> 00:10:21,839
it will at some point it will isolate um

263
00:10:21,839 --> 00:10:23,120
i mean it will

264
00:10:23,120 --> 00:10:24,720
it will allows you to advise about you

265
00:10:24,720 --> 00:10:28,399
to do like an isolated environment

266
00:10:28,399 --> 00:10:30,640
so yeah the setup here with sdr and 2g

267
00:10:30,640 --> 00:10:33,279
looks like as follows so you just like

268
00:10:33,279 --> 00:10:36,720
you just need like 30 uh i mean 300 euro

269
00:10:36,720 --> 00:10:39,680
in order to run a 2g base station but in

270
00:10:39,680 --> 00:10:40,640
3g

271
00:10:40,640 --> 00:10:43,120
uh things evolved so i'm also the budget

272
00:10:43,120 --> 00:10:44,800
evolved because you have only one

273
00:10:44,800 --> 00:10:46,720
software for example in sdr in order to

274
00:10:46,720 --> 00:10:48,640
allow i mean to allow you for example to

275
00:10:48,640 --> 00:10:51,600
spawn a 3g base station it is open bts

276
00:10:51,600 --> 00:10:55,360
umts which only works with usp series

277
00:10:55,360 --> 00:10:56,640
of

278
00:10:56,640 --> 00:10:58,560
of sdr device but you have also other

279
00:10:58,560 --> 00:11:00,480
ways using femtocell and femtocell you

280
00:11:00,480 --> 00:11:02,320
can also use in 4g

281
00:11:02,320 --> 00:11:04,880
4g has

282
00:11:04,880 --> 00:11:07,279
many other choices because still there's

283
00:11:07,279 --> 00:11:09,440
like a software called ssrun which

284
00:11:09,440 --> 00:11:11,200
allows you for example to spawn a 4g

285
00:11:11,200 --> 00:11:13,360
station which is quite good

286
00:11:13,360 --> 00:11:14,800
and also you have like open air

287
00:11:14,800 --> 00:11:16,320
interface which also allows you for

288
00:11:16,320 --> 00:11:19,200
example to spawn like an lte advanced uh

289
00:11:19,200 --> 00:11:20,399
network

290
00:11:20,399 --> 00:11:22,160
uh you have also commercial version like

291
00:11:22,160 --> 00:11:25,600
amary soft uh ss1 with uh nb iot

292
00:11:25,600 --> 00:11:27,120
extension which allows you for example

293
00:11:27,120 --> 00:11:29,440
to spawn our base station for our

294
00:11:29,440 --> 00:11:31,920
narrow-bound iot

295
00:11:31,920 --> 00:11:34,480
and you have also rodded schwarz

296
00:11:34,480 --> 00:11:35,360
setup

297
00:11:35,360 --> 00:11:37,839
and in 5g now you can see that for

298
00:11:37,839 --> 00:11:38,959
example

299
00:11:38,959 --> 00:11:40,720
you know at the beginning if you want to

300
00:11:40,720 --> 00:11:43,040
do that with all i mean a smaller budget

301
00:11:43,040 --> 00:11:45,600
uh with 300 euro you can do that in 4g

302
00:11:45,600 --> 00:11:47,920
but in 5g for the moment you don't have

303
00:11:47,920 --> 00:11:50,320
like many choices you can for example

304
00:11:50,320 --> 00:11:52,959
directly use open source uh stuff like

305
00:11:52,959 --> 00:11:54,639
ss run that

306
00:11:54,639 --> 00:11:56,320
since uh

307
00:11:56,320 --> 00:11:58,959
since october uh allows you for example

308
00:11:58,959 --> 00:12:01,200
to spawn like a nsa non-standalone

309
00:12:01,200 --> 00:12:03,920
network in 5g a little bit limited but

310
00:12:03,920 --> 00:12:06,240
still it is something interesting but

311
00:12:06,240 --> 00:12:08,000
the problem is that the hardware is cost

312
00:12:08,000 --> 00:12:10,480
like a lot of money so

313
00:12:10,480 --> 00:12:11,600
yeah

314
00:12:11,600 --> 00:12:13,680
and if you look at commercial versions

315
00:12:13,680 --> 00:12:15,760
uh commercial versions it is exactly the

316
00:12:15,760 --> 00:12:17,839
same price because you are you will have

317
00:12:17,839 --> 00:12:19,600
to pay for the license and the hardware

318
00:12:19,600 --> 00:12:21,279
so it is exactly the same price that you

319
00:12:21,279 --> 00:12:24,480
will actually spend for to to spam

320
00:12:24,480 --> 00:12:26,880
a 5g nsa

321
00:12:26,880 --> 00:12:28,959
network at least but the amounts of

322
00:12:28,959 --> 00:12:32,720
version is for nsa is much much higher

323
00:12:32,720 --> 00:12:34,399
than that because if you want

324
00:12:34,399 --> 00:12:36,959
nsa and sa working you will have to

325
00:12:36,959 --> 00:12:40,880
spend three uh i mean 30 000 euros for

326
00:12:40,880 --> 00:12:43,519
that so yeah this is just for the budget

327
00:12:43,519 --> 00:12:44,639
information

328
00:12:44,639 --> 00:12:45,680
now

329
00:12:45,680 --> 00:12:48,160
if you want for example to um to play

330
00:12:48,160 --> 00:12:49,839
with a 5g device

331
00:12:49,839 --> 00:12:51,760
whether or not

332
00:12:51,760 --> 00:12:54,480
module you can for example try to uh to

333
00:12:54,480 --> 00:12:56,959
downgrade for example the security uh in

334
00:12:56,959 --> 00:12:58,800
order for example to put it in 2g so

335
00:12:58,800 --> 00:13:00,000
like that you don't have mutual

336
00:13:00,000 --> 00:13:01,360
notification and so like that you can

337
00:13:01,360 --> 00:13:02,399
also

338
00:13:02,399 --> 00:13:04,240
i mean inspect on the communication you

339
00:13:04,240 --> 00:13:05,920
can see if you can just extract some

340
00:13:05,920 --> 00:13:07,920
secrets

341
00:13:07,920 --> 00:13:10,000
but at some case in some cases you will

342
00:13:10,000 --> 00:13:11,920
not have choice sometimes the module is

343
00:13:11,920 --> 00:13:14,880
only playing for in 5g and you will not

344
00:13:14,880 --> 00:13:17,279
have any choice but just to use

345
00:13:17,279 --> 00:13:19,920
5g but if you can downgrade it there are

346
00:13:19,920 --> 00:13:22,160
plenty of uh manners you can find up or

347
00:13:22,160 --> 00:13:24,320
use one of the two that i have developed

348
00:13:24,320 --> 00:13:25,600
uh which is a

349
00:13:25,600 --> 00:13:27,680
modern map and normal gem which will be

350
00:13:27,680 --> 00:13:29,760
also soon available in 5g actually

351
00:13:29,760 --> 00:13:31,839
because modern map is actually mapping

352
00:13:31,839 --> 00:13:35,120
all the 2g 3g 4g

353
00:13:35,120 --> 00:13:36,480
base stations

354
00:13:36,480 --> 00:13:38,560
but soon you will also have like the 5g

355
00:13:38,560 --> 00:13:41,359
nsa at least

356
00:13:41,519 --> 00:13:43,760
but you have to be aware that also if

357
00:13:43,760 --> 00:13:45,920
you are playing with the 5g stack as

358
00:13:45,920 --> 00:13:47,920
much as you have stacked to downgrade as

359
00:13:47,920 --> 00:13:49,519
much it would be complicated as much

360
00:13:49,519 --> 00:13:51,519
resource you will have to to have in

361
00:13:51,519 --> 00:13:54,000
order to downgrade this uh this mod into

362
00:13:54,000 --> 00:13:56,560
5g so yeah you have to to be aware about

363
00:13:56,560 --> 00:13:58,639
that if you want for example to uh to

364
00:13:58,639 --> 00:14:01,279
use the 2g in order to see what is going

365
00:14:01,279 --> 00:14:03,199
on

366
00:14:03,199 --> 00:14:05,600
so then um

367
00:14:05,600 --> 00:14:06,959
you have to be aware that for example

368
00:14:06,959 --> 00:14:08,800
with 5g as you have like mutual

369
00:14:08,800 --> 00:14:11,440
notification you have to use uh some

370
00:14:11,440 --> 00:14:13,600
using custom your sim card i know that a

371
00:14:13,600 --> 00:14:16,079
lot of people here will just like say

372
00:14:16,079 --> 00:14:17,680
hey it's a little bit cheating of using

373
00:14:17,680 --> 00:14:18,639
your

374
00:14:18,639 --> 00:14:21,279
nice sim card in order to uh to inspect

375
00:14:21,279 --> 00:14:24,079
some communication on modules but

376
00:14:24,079 --> 00:14:26,399
we see that there's another way

377
00:14:26,399 --> 00:14:28,079
to get an access for example in core

378
00:14:28,079 --> 00:14:29,519
networks

379
00:14:29,519 --> 00:14:31,040
that could be like that could complete

380
00:14:31,040 --> 00:14:33,120
for example an assessment so with the

381
00:14:33,120 --> 00:14:34,560
client for example i'm just like telling

382
00:14:34,560 --> 00:14:36,880
that i will put like a custom

383
00:14:36,880 --> 00:14:38,160
sim card in order to inspect the

384
00:14:38,160 --> 00:14:39,440
communication in order to see if i can

385
00:14:39,440 --> 00:14:41,680
extract some secrets after that to use

386
00:14:41,680 --> 00:14:44,959
against the the endpoint etc but

387
00:14:44,959 --> 00:14:47,199
um sometimes also the clients say hey

388
00:14:47,199 --> 00:14:49,279
it's a little bit i mean you're cheating

389
00:14:49,279 --> 00:14:51,120
a little bit doing that because uh

390
00:14:51,120 --> 00:14:52,959
actually the attacker will not be able

391
00:14:52,959 --> 00:14:54,560
for example to uh

392
00:14:54,560 --> 00:14:56,880
uh to do that i mean

393
00:14:56,880 --> 00:14:58,959
i mean what's what's the risk of that

394
00:14:58,959 --> 00:15:00,800
and i'm saying okay if for example the

395
00:15:00,800 --> 00:15:03,199
attacker is just taking your module and

396
00:15:03,199 --> 00:15:06,000
then uh you know using use by the custom

397
00:15:06,000 --> 00:15:08,160
card custom your sim card he can for

398
00:15:08,160 --> 00:15:09,360
example just inspect for the

399
00:15:09,360 --> 00:15:10,800
communication and then attack your back

400
00:15:10,800 --> 00:15:12,720
end at some point there's also another

401
00:15:12,720 --> 00:15:14,240
another thing is that for example if the

402
00:15:14,240 --> 00:15:17,040
attacker has like an access to uh to the

403
00:15:17,040 --> 00:15:18,800
core network at some point for example

404
00:15:18,800 --> 00:15:20,240
you know that your mobile phone is

405
00:15:20,240 --> 00:15:21,760
roaming at some point so using for

406
00:15:21,760 --> 00:15:24,000
support the roaming uh an attacker can

407
00:15:24,000 --> 00:15:26,320
just like have an access alleged access

408
00:15:26,320 --> 00:15:27,440
to uh

409
00:15:27,440 --> 00:15:28,720
to some

410
00:15:28,720 --> 00:15:30,560
operator uh

411
00:15:30,560 --> 00:15:32,240
networks so like that you can also

412
00:15:32,240 --> 00:15:34,240
negotiate for example just spawning like

413
00:15:34,240 --> 00:15:36,000
effect base station you can just like uh

414
00:15:36,000 --> 00:15:37,839
try to negotiate to provide the secrets

415
00:15:37,839 --> 00:15:40,560
to the uh to the legits i mean to the to

416
00:15:40,560 --> 00:15:42,959
the device but we will talk about how an

417
00:15:42,959 --> 00:15:44,800
attacker from the outside can also get

418
00:15:44,800 --> 00:15:47,360
access to the car network uh so that

419
00:15:47,360 --> 00:15:48,560
would be like some interesting stuff

420
00:15:48,560 --> 00:15:51,839
also in 5g uh but first let's just focus

421
00:15:51,839 --> 00:15:54,160
on how to actually use a sim card so you

422
00:15:54,160 --> 00:15:56,160
can i mean i will not go into the detail

423
00:15:56,160 --> 00:15:58,079
of that but you can actually shop this

424
00:15:58,079 --> 00:16:00,720
the uh this i sim cards uh using this

425
00:16:00,720 --> 00:16:01,680
link

426
00:16:01,680 --> 00:16:04,240
or in aliexpress if you want it's it is

427
00:16:04,240 --> 00:16:06,000
like a little bit cheaper like that you

428
00:16:06,000 --> 00:16:07,680
can have like some secrets that you can

429
00:16:07,680 --> 00:16:10,000
then provide to your effect base station

430
00:16:10,000 --> 00:16:12,639
in order to then make register the the

431
00:16:12,639 --> 00:16:16,240
modular in it and then you can try to uh

432
00:16:16,240 --> 00:16:18,079
make the the phone register but first

433
00:16:18,079 --> 00:16:19,759
you have to be aware that for example in

434
00:16:19,759 --> 00:16:22,079
five gsa which were my case which was my

435
00:16:22,079 --> 00:16:24,480
case is that in fact gsa

436
00:16:24,480 --> 00:16:26,320
you have to be aware about what the

437
00:16:26,320 --> 00:16:28,399
phone or what the model is supporting

438
00:16:28,399 --> 00:16:30,720
which band actually so this is one of

439
00:16:30,720 --> 00:16:32,160
the things that you have to check before

440
00:16:32,160 --> 00:16:34,240
you can you spawn any

441
00:16:34,240 --> 00:16:36,480
sales because you will see that

442
00:16:36,480 --> 00:16:37,839
even if the uh

443
00:16:37,839 --> 00:16:40,800
the phone is supporting 5g sa etc if you

444
00:16:40,800 --> 00:16:42,639
don't respect a lot of configuration you

445
00:16:42,639 --> 00:16:44,880
will be just spending like a lot of time

446
00:16:44,880 --> 00:16:46,880
trying to to just make the phone

447
00:16:46,880 --> 00:16:48,880
register or make the phone just see the

448
00:16:48,880 --> 00:16:51,199
network actually so uh this is one of

449
00:16:51,199 --> 00:16:52,240
the

450
00:16:52,240 --> 00:16:54,000
uh the complication but you will see

451
00:16:54,000 --> 00:16:55,920
that there's like all the complications

452
00:16:55,920 --> 00:16:58,160
so here is like a website uh that also

453
00:16:58,160 --> 00:17:00,480
shows you some aspects of some modems so

454
00:17:00,480 --> 00:17:02,160
you can just like for example if you if

455
00:17:02,160 --> 00:17:04,480
you are looking for some targets uh you

456
00:17:04,480 --> 00:17:05,839
can just see that for example your

457
00:17:05,839 --> 00:17:09,280
target is actually uh supporting the sa

458
00:17:09,280 --> 00:17:10,400
mode

459
00:17:10,400 --> 00:17:13,039
and so it supports just one bending here

460
00:17:13,039 --> 00:17:13,839
but

461
00:17:13,839 --> 00:17:16,000
uh also you have to be aware about the

462
00:17:16,000 --> 00:17:18,480
the configuration about the channel uh

463
00:17:18,480 --> 00:17:21,280
uh i mean the the spread channel

464
00:17:21,280 --> 00:17:22,480
spectrum

465
00:17:22,480 --> 00:17:24,799
uh and also the bandwidth etc so a lot

466
00:17:24,799 --> 00:17:26,240
of configuration to take in account in

467
00:17:26,240 --> 00:17:29,120
order to spawn a station that will be

468
00:17:29,120 --> 00:17:31,600
able to register your phone

469
00:17:31,600 --> 00:17:33,520
and then

470
00:17:33,520 --> 00:17:35,760
when you go i mean further with all the

471
00:17:35,760 --> 00:17:37,919
modules or the the targets you see that

472
00:17:37,919 --> 00:17:40,960
for example the target uh is actually uh

473
00:17:40,960 --> 00:17:41,919
i mean

474
00:17:41,919 --> 00:17:43,840
on the paper and also on the commercial

475
00:17:43,840 --> 00:17:47,440
papers is supporting 5g nsa 5gsa but it

476
00:17:47,440 --> 00:17:48,640
is not

477
00:17:48,640 --> 00:17:50,799
because sometimes also for example for

478
00:17:50,799 --> 00:17:52,000
some phones

479
00:17:52,000 --> 00:17:54,240
you have to for example use the mccmc

480
00:17:54,240 --> 00:17:56,480
which is related to the country

481
00:17:56,480 --> 00:17:58,480
of the phone so for example for some

482
00:17:58,480 --> 00:18:01,200
iphone you have to spawn for example mcc

483
00:18:01,200 --> 00:18:03,840
mnc which is a chinese one and not the

484
00:18:03,840 --> 00:18:06,160
over sometimes you have also to program

485
00:18:06,160 --> 00:18:09,679
a sim card with this kind of mccmc code

486
00:18:09,679 --> 00:18:11,679
so there's like a lot of things to take

487
00:18:11,679 --> 00:18:13,840
in account in order to i mean make it

488
00:18:13,840 --> 00:18:17,280
happen at some point and sometimes

489
00:18:17,280 --> 00:18:19,600
you're feeling like you are just buying

490
00:18:19,600 --> 00:18:23,120
a pizza with a pineapple uh i mean just

491
00:18:23,120 --> 00:18:24,880
like i'm just telling that for italian

492
00:18:24,880 --> 00:18:27,360
people because it is like not possible

493
00:18:27,360 --> 00:18:29,039
but uh yeah

494
00:18:29,039 --> 00:18:30,880
when i just like both for example the lg

495
00:18:30,880 --> 00:18:34,480
velvet 5g phone uh just by respecting

496
00:18:34,480 --> 00:18:36,480
all this specification i just saw that

497
00:18:36,480 --> 00:18:38,640
for example my phone was unable to

498
00:18:38,640 --> 00:18:41,760
connect to this 5g nsa and 5g network

499
00:18:41,760 --> 00:18:44,400
and i was like shoot why and inspecting

500
00:18:44,400 --> 00:18:46,480
with 4g actually i could just like take

501
00:18:46,480 --> 00:18:48,080
the capabilities of the phone and on the

502
00:18:48,080 --> 00:18:49,919
capability of the phone you can see that

503
00:18:49,919 --> 00:18:52,480
the n1 one was missing and that is an

504
00:18:52,480 --> 00:18:54,640
indicator that the phone actually is not

505
00:18:54,640 --> 00:18:57,840
doing 5 gsa even if the commercial

506
00:18:57,840 --> 00:19:00,080
writing is telling you so even if for

507
00:19:00,080 --> 00:19:03,200
example in here combo combos is also

508
00:19:03,200 --> 00:19:04,880
telling you that it's supporting the the

509
00:19:04,880 --> 00:19:05,840
bands

510
00:19:05,840 --> 00:19:08,000
because at some points in here in the

511
00:19:08,000 --> 00:19:09,039
slide

512
00:19:09,039 --> 00:19:10,960
the constructor for you know for some

513
00:19:10,960 --> 00:19:13,200
countries uh just like

514
00:19:13,200 --> 00:19:15,679
lock also the base band so in china for

515
00:19:15,679 --> 00:19:18,480
example for huawei huawei is locking at

516
00:19:18,480 --> 00:19:20,000
some points also the basement to be

517
00:19:20,000 --> 00:19:23,200
working on 5gsa in europe especially uh

518
00:19:23,200 --> 00:19:25,280
for new version if you don't grade the

519
00:19:25,280 --> 00:19:27,760
version if you are about to to downgrade

520
00:19:27,760 --> 00:19:30,160
the version to uh or an oldest one you

521
00:19:30,160 --> 00:19:32,640
can at some point made it make it work

522
00:19:32,640 --> 00:19:35,679
but yeah uh you have to know that

523
00:19:35,679 --> 00:19:37,120
you know depending on the observation

524
00:19:37,120 --> 00:19:39,440
that i saw for europe if you want for

525
00:19:39,440 --> 00:19:42,640
example to test uh 5gsa target you have

526
00:19:42,640 --> 00:19:45,840
to use today a snapdragon x

527
00:19:45,840 --> 00:19:48,960
5x for the moment so yeah this is one of

528
00:19:48,960 --> 00:19:50,720
the constraints for example when i was

529
00:19:50,720 --> 00:19:52,400
like wanted to actually

530
00:19:52,400 --> 00:19:55,600
test five gsa devices so once you do

531
00:19:55,600 --> 00:19:58,960
that you can uh when uh 5gsa device is

532
00:19:58,960 --> 00:20:01,039
capable of connecting and registering to

533
00:20:01,039 --> 00:20:02,640
you to your base station you can

534
00:20:02,640 --> 00:20:04,400
actually debug what is going on you can

535
00:20:04,400 --> 00:20:06,080
see that also in the right there's a

536
00:20:06,080 --> 00:20:09,200
nice constellation uh map um yeah

537
00:20:09,200 --> 00:20:11,120
microsoft is pretty weird because it is

538
00:20:11,120 --> 00:20:14,960
also when you're using it as a as a gnb

539
00:20:14,960 --> 00:20:17,440
uh it still has like some mention of enb

540
00:20:17,440 --> 00:20:19,039
which is like the e not b

541
00:20:19,039 --> 00:20:21,440
for 4g but yeah it doesn't matter i mean

542
00:20:21,440 --> 00:20:23,039
if you if you shoot at the configuration

543
00:20:23,039 --> 00:20:24,799
in 5g and you will see also that the

544
00:20:24,799 --> 00:20:26,720
negotiation that will be in 5g

545
00:20:26,720 --> 00:20:28,240
it would be clear that you are actually

546
00:20:28,240 --> 00:20:30,559
spawning a 5g network

547
00:20:30,559 --> 00:20:31,600
so now

548
00:20:31,600 --> 00:20:33,280
answer you can do that for example with

549
00:20:33,280 --> 00:20:35,039
some more those ponders that can be used

550
00:20:35,039 --> 00:20:37,440
for the point cars etc uh the thing is

551
00:20:37,440 --> 00:20:39,360
that i will just like try to

552
00:20:39,360 --> 00:20:41,280
make register for example this kind of

553
00:20:41,280 --> 00:20:44,159
model in my uh my base station

554
00:20:44,159 --> 00:20:46,880
and so making the the module going to

555
00:20:46,880 --> 00:20:48,720
the base station i can for example then

556
00:20:48,720 --> 00:20:50,559
inspect on the communication and see

557
00:20:50,559 --> 00:20:52,000
what are the secrets that are exchanged

558
00:20:52,000 --> 00:20:53,840
between for example the network and the

559
00:20:53,840 --> 00:20:55,679
device because we know that for example

560
00:20:55,679 --> 00:20:57,679
the uh i mean here is just a simulation

561
00:20:57,679 --> 00:20:59,840
but uh for example the devices are

562
00:20:59,840 --> 00:21:01,360
exchanging plenty of stuff and if the

563
00:21:01,360 --> 00:21:03,039
devices for example my clients is just

564
00:21:03,039 --> 00:21:05,280
uh have for example some some question

565
00:21:05,280 --> 00:21:07,600
about uh is the security i mean is the

566
00:21:07,600 --> 00:21:09,600
communication encrypted between the

567
00:21:09,600 --> 00:21:11,280
backend and the device because they

568
00:21:11,280 --> 00:21:13,360
don't i mean for example mobile

569
00:21:13,360 --> 00:21:16,559
automobile stuff they don't really know

570
00:21:16,559 --> 00:21:18,880
what is going on between the model and

571
00:21:18,880 --> 00:21:20,880
the network so actually they want also

572
00:21:20,880 --> 00:21:22,880
to to know exactly what is going on if

573
00:21:22,880 --> 00:21:24,640
the communication is encrypted and if

574
00:21:24,640 --> 00:21:26,400
it's not encrypted an attacker for

575
00:21:26,400 --> 00:21:27,840
example having access to the core

576
00:21:27,840 --> 00:21:30,480
network can actually also uh i mean play

577
00:21:30,480 --> 00:21:32,080
with that because he can spawn effect

578
00:21:32,080 --> 00:21:34,480
base station do the naked illustration i

579
00:21:34,480 --> 00:21:36,960
mean as a ram as a roaming

580
00:21:36,960 --> 00:21:39,200
antenna and like that he can extract the

581
00:21:39,200 --> 00:21:40,960
circuit

582
00:21:40,960 --> 00:21:42,240
if you're working for example with

583
00:21:42,240 --> 00:21:44,799
automobile and other uh other other

584
00:21:44,799 --> 00:21:46,400
devices you will see that for example

585
00:21:46,400 --> 00:21:48,799
you will face maybe an embedded sim card

586
00:21:48,799 --> 00:21:50,480
and everyday sim cards are a little bit

587
00:21:50,480 --> 00:21:53,520
painful because you can actually try to

588
00:21:53,520 --> 00:21:54,880
to uh

589
00:21:54,880 --> 00:21:57,360
you can just like try to

590
00:21:57,360 --> 00:21:59,039
i mean remove it and

591
00:21:59,039 --> 00:22:01,360
put your sim card uh

592
00:22:01,360 --> 00:22:04,320
just after that but um without going

593
00:22:04,320 --> 00:22:06,640
into all of that you can also sometimes

594
00:22:06,640 --> 00:22:08,960
just try to spot on the chip if there is

595
00:22:08,960 --> 00:22:11,600
like a second sim card possible if

596
00:22:11,600 --> 00:22:13,760
there's like any slot for the second sim

597
00:22:13,760 --> 00:22:15,600
card and doing so you can just like for

598
00:22:15,600 --> 00:22:17,919
example uh see that there's like a slot

599
00:22:17,919 --> 00:22:20,400
for sim one and this is our slot for sim

600
00:22:20,400 --> 00:22:22,720
q in here and in this slot you can just

601
00:22:22,720 --> 00:22:25,120
like put your custom sim card and like

602
00:22:25,120 --> 00:22:27,679
that tap some 80 commands if you can do

603
00:22:27,679 --> 00:22:29,600
that also because you have also a serial

604
00:22:29,600 --> 00:22:31,280
access and like that you can force by

605
00:22:31,280 --> 00:22:33,440
support the module to use the sim card

606
00:22:33,440 --> 00:22:34,799
too and like that inspect for the

607
00:22:34,799 --> 00:22:36,640
communications

608
00:22:36,640 --> 00:22:39,280
now let's talk about the 5g sa

609
00:22:39,280 --> 00:22:41,200
i mean the 5g network

610
00:22:41,200 --> 00:22:43,280
and you will see i mean you will you

611
00:22:43,280 --> 00:22:44,880
will know i mean you will

612
00:22:44,880 --> 00:22:46,799
you will see why also this kind of

613
00:22:46,799 --> 00:22:48,400
attack i mean

614
00:22:48,400 --> 00:22:50,880
of course using a customizing card is

615
00:22:50,880 --> 00:22:52,960
cheating but it's just showing a

616
00:22:52,960 --> 00:22:55,120
scenario where an attacker has an access

617
00:22:55,120 --> 00:22:58,640
and let's now talk about that so

618
00:22:58,640 --> 00:23:00,799
um access to the network normally is not

619
00:23:00,799 --> 00:23:02,400
an easy tax you have like a two ways you

620
00:23:02,400 --> 00:23:04,640
have a legit way like paying an access

621
00:23:04,640 --> 00:23:08,480
for an sss sls s7 diameter 5g

622
00:23:08,480 --> 00:23:09,840
so you need like to do a lot of

623
00:23:09,840 --> 00:23:11,760
paperwork and also

624
00:23:11,760 --> 00:23:13,919
give a lot of dollars or you have also

625
00:23:13,919 --> 00:23:16,799
no legit attacking way where you can

626
00:23:16,799 --> 00:23:19,120
just like attack some exporters uh

627
00:23:19,120 --> 00:23:21,840
gateways and this is the way that i will

628
00:23:21,840 --> 00:23:23,840
just like show you with some examples

629
00:23:23,840 --> 00:23:26,240
and some examples that i also found

630
00:23:26,240 --> 00:23:29,360
not only in my clients but also uh in

631
00:23:29,360 --> 00:23:31,679
some challenges like the five digital

632
00:23:31,679 --> 00:23:34,080
security hack challenge that is like a

633
00:23:34,080 --> 00:23:36,720
good exercise to see how the 5g works

634
00:23:36,720 --> 00:23:38,720
and also what are the the common

635
00:23:38,720 --> 00:23:40,400
problems because it is like a bug booty

636
00:23:40,400 --> 00:23:43,760
for 5g actually core networks um

637
00:23:43,760 --> 00:23:48,000
and so in our 2019 we had like a 5g

638
00:23:48,000 --> 00:23:50,320
vertical hackathon which was like a

639
00:23:50,320 --> 00:23:53,039
pretty interesting because um we um

640
00:23:53,039 --> 00:23:55,360
we they asked us for for example to hack

641
00:23:55,360 --> 00:23:57,679
for example the uh the 5g connection in

642
00:23:57,679 --> 00:23:59,760
order to get access to the vr glasses

643
00:23:59,760 --> 00:24:02,159
and then try to impersonate for example

644
00:24:02,159 --> 00:24:04,400
uh some stuff in here uh because

645
00:24:04,400 --> 00:24:06,400
normally you have like a passion in here

646
00:24:06,400 --> 00:24:08,320
you will see indirect how the patient is

647
00:24:08,320 --> 00:24:10,000
going on but you can for example the

648
00:24:10,000 --> 00:24:11,760
task was like to replace for example the

649
00:24:11,760 --> 00:24:14,880
images which will be actually uh see i

650
00:24:14,880 --> 00:24:16,640
mean that for example the doctor will

651
00:24:16,640 --> 00:24:18,400
see in remote

652
00:24:18,400 --> 00:24:20,960
so just try to do some impersonation out

653
00:24:20,960 --> 00:24:23,360
of that and what was interesting is that

654
00:24:23,360 --> 00:24:26,240
at some point uh we were looking so at

655
00:24:26,240 --> 00:24:28,159
some vectors of attack for example we we

656
00:24:28,159 --> 00:24:29,520
looked at for example the public ip

657
00:24:29,520 --> 00:24:31,440
address that was spawned for by the sim

658
00:24:31,440 --> 00:24:33,279
card so like that we just like try to

659
00:24:33,279 --> 00:24:35,440
see what is the the range of the ip

660
00:24:35,440 --> 00:24:38,559
which is uh you know uh i mean allowed i

661
00:24:38,559 --> 00:24:39,679
mean

662
00:24:39,679 --> 00:24:42,640
it is allocated for the for the operator

663
00:24:42,640 --> 00:24:44,720
and like that you we just scan

664
00:24:44,720 --> 00:24:47,840
everything on that we use also the legit

665
00:24:47,840 --> 00:24:49,600
sim card in order to see if there's like

666
00:24:49,600 --> 00:24:52,960
any isolation and of course in this uh

667
00:24:52,960 --> 00:24:55,360
in this exercise there there was like no

668
00:24:55,360 --> 00:24:57,120
isolation at all and actually this is

669
00:24:57,120 --> 00:24:59,440
one of the sim cards that they provided

670
00:24:59,440 --> 00:25:01,200
so we have sim card you can do like

671
00:25:01,200 --> 00:25:04,000
pretty a lot of stuff uh especially if

672
00:25:04,000 --> 00:25:07,200
this sim card is used in m2m uh for m2m

673
00:25:07,200 --> 00:25:10,159
uh purposes so generally like uh iot

674
00:25:10,159 --> 00:25:11,760
stuff etc

675
00:25:11,760 --> 00:25:12,960
and so

676
00:25:12,960 --> 00:25:14,320
this sim card by the top of this sim

677
00:25:14,320 --> 00:25:16,080
card we could use trash route in order

678
00:25:16,080 --> 00:25:18,159
to just like spot all the gateways then

679
00:25:18,159 --> 00:25:21,200
we just uh for example with all the dips

680
00:25:21,200 --> 00:25:23,600
subnets we could just like perform an

681
00:25:23,600 --> 00:25:25,840
end map on it and we found like a lot of

682
00:25:25,840 --> 00:25:28,400
exported services like that we have been

683
00:25:28,400 --> 00:25:30,960
able for example to uh spot some uh

684
00:25:30,960 --> 00:25:32,400
interesting service like for example

685
00:25:32,400 --> 00:25:35,039
managing services which use only some

686
00:25:35,039 --> 00:25:37,200
default passwords uh on it so we could

687
00:25:37,200 --> 00:25:39,679
just like go into that and then uh we

688
00:25:39,679 --> 00:25:41,200
could like manipulate a lot of that a

689
00:25:41,200 --> 00:25:44,080
lot of i mean a lot of interfaces were

690
00:25:44,080 --> 00:25:47,120
were just like um configured

691
00:25:47,120 --> 00:25:48,720
i mean with default password and this is

692
00:25:48,720 --> 00:25:51,039
the thing that we see also in the in

693
00:25:51,039 --> 00:25:53,360
some operators uh because some operators

694
00:25:53,360 --> 00:25:55,440
think that as it is trusted as for

695
00:25:55,440 --> 00:25:57,600
example the all the interfaces

696
00:25:57,600 --> 00:25:59,600
are in the core network you see plenty

697
00:25:59,600 --> 00:26:00,960
of things like that uh plenty of

698
00:26:00,960 --> 00:26:03,360
misconfiguration like that but here in

699
00:26:03,360 --> 00:26:05,840
this civil security challenge it is like

700
00:26:05,840 --> 00:26:09,120
i mean the perfect exercise to see that

701
00:26:09,120 --> 00:26:11,760
and what was good is that at the end of

702
00:26:11,760 --> 00:26:13,679
the journey we will be able after after

703
00:26:13,679 --> 00:26:16,640
24 hours we have been able to uh get a

704
00:26:16,640 --> 00:26:19,279
root access to the mmu which was able uh

705
00:26:19,279 --> 00:26:20,880
which allows us to also to get the

706
00:26:20,880 --> 00:26:22,159
secrets in order to decrypt the

707
00:26:22,159 --> 00:26:24,480
communication and also uh

708
00:26:24,480 --> 00:26:25,520
i mean

709
00:26:25,520 --> 00:26:27,440
impersonate all the things

710
00:26:27,440 --> 00:26:29,279
so yeah if you're interesting about the

711
00:26:29,279 --> 00:26:31,760
attacks etc you can also uh i mean use

712
00:26:31,760 --> 00:26:34,400
this link you have also a similar story

713
00:26:34,400 --> 00:26:36,480
if you remember at the beginning of this

714
00:26:36,480 --> 00:26:38,320
day we were talking about the spring i

715
00:26:38,320 --> 00:26:40,720
mean the the card the one car that

716
00:26:40,720 --> 00:26:43,919
crashed uh because it was manipulated in

717
00:26:43,919 --> 00:26:46,559
remote so this is also one of the story

718
00:26:46,559 --> 00:26:49,200
which is very related for example to the

719
00:26:49,200 --> 00:26:50,240
uh

720
00:26:50,240 --> 00:26:52,020
the jeep hacking by uh

721
00:26:52,020 --> 00:26:53,360
[Music]

722
00:26:53,360 --> 00:26:55,520
well i don't have the name now now i

723
00:26:55,520 --> 00:26:57,360
have a stroke but yeah if you look at

724
00:26:57,360 --> 00:26:59,120
this paper you will see that because of

725
00:26:59,120 --> 00:27:01,840
the by designation of sprint m2m network

726
00:27:01,840 --> 00:27:03,760
of the hacker were able for example to

727
00:27:03,760 --> 00:27:05,120
get access to the car and control the

728
00:27:05,120 --> 00:27:08,080
car remotely so yeah this is exactly the

729
00:27:08,080 --> 00:27:09,039
same thing

730
00:27:09,039 --> 00:27:11,520
now let's talk about the five gsa so 5g

731
00:27:11,520 --> 00:27:14,320
say uh we had also a challenge where we

732
00:27:14,320 --> 00:27:15,600
had like some

733
00:27:15,600 --> 00:27:17,840
some you know some iot stuff in here and

734
00:27:17,840 --> 00:27:20,880
the iot stuff in here we we had also to

735
00:27:20,880 --> 00:27:22,640
you know to try to

736
00:27:22,640 --> 00:27:25,120
um uh we had to control the network at

737
00:27:25,120 --> 00:27:26,640
some point we are we had to mess with

738
00:27:26,640 --> 00:27:28,880
the network at some point so but

739
00:27:28,880 --> 00:27:30,640
the exercise in here they just like give

740
00:27:30,640 --> 00:27:32,960
us some ip address they give us also ssh

741
00:27:32,960 --> 00:27:34,880
because it was only remote this time

742
00:27:34,880 --> 00:27:37,120
they don't provide us any sim card but

743
00:27:37,120 --> 00:27:39,360
we were able to just like spot some

744
00:27:39,360 --> 00:27:40,960
interesting range and with this

745
00:27:40,960 --> 00:27:42,799
interesting range what we've done is

746
00:27:42,799 --> 00:27:44,480
that we have just like scanned all the

747
00:27:44,480 --> 00:27:46,960
range actually and the story is exactly

748
00:27:46,960 --> 00:27:49,039
like the same as positive technology

749
00:27:49,039 --> 00:27:50,880
presented also and also

750
00:27:50,880 --> 00:27:52,799
right about and

751
00:27:52,799 --> 00:27:55,520
with that we supported some tcp

752
00:27:55,520 --> 00:27:57,840
interfaces and with this interfaces we

753
00:27:57,840 --> 00:27:59,440
could for example

754
00:27:59,440 --> 00:28:00,799
spot a login

755
00:28:00,799 --> 00:28:04,159
login on the core network of some

756
00:28:04,159 --> 00:28:07,200
uh it is hiding in here on some uh

757
00:28:07,200 --> 00:28:09,200
call network i mean it's like not a

758
00:28:09,200 --> 00:28:11,120
commercial but private i mean close

759
00:28:11,120 --> 00:28:14,159
source call networking here that we they

760
00:28:14,159 --> 00:28:17,600
needed us to to actually uh pen test

761
00:28:17,600 --> 00:28:19,679
and so we just saw that it was possible

762
00:28:19,679 --> 00:28:22,799
to bypass the login by just doing like a

763
00:28:22,799 --> 00:28:24,240
simple uh

764
00:28:24,240 --> 00:28:26,240
i mean a simple bypass so because just

765
00:28:26,240 --> 00:28:28,640
like by brute forcing the the web

766
00:28:28,640 --> 00:28:30,559
directories we are we were able to spot

767
00:28:30,559 --> 00:28:32,960
for example a page and with this page we

768
00:28:32,960 --> 00:28:34,480
had some links and with these links we

769
00:28:34,480 --> 00:28:37,200
were able to export our dma size plus

770
00:28:37,200 --> 00:28:39,279
the key secrets which are the secrets

771
00:28:39,279 --> 00:28:41,039
used by the sim card so actually we

772
00:28:41,039 --> 00:28:43,279
could like for example we could have the

773
00:28:43,279 --> 00:28:45,440
the secrets used by the sim card and so

774
00:28:45,440 --> 00:28:47,760
like that we could we can either provide

775
00:28:47,760 --> 00:28:49,760
a fake network as we have the secrets of

776
00:28:49,760 --> 00:28:52,240
the card we can also for example trap

777
00:28:52,240 --> 00:28:55,039
any any device like that but this is not

778
00:28:55,039 --> 00:28:56,960
done yet because there's also another

779
00:28:56,960 --> 00:29:00,240
thing which is interested is the um

780
00:29:00,240 --> 00:29:01,679
you know the the 5g is completely

781
00:29:01,679 --> 00:29:04,320
different as i said it use the cloud in

782
00:29:04,320 --> 00:29:05,840
order to provide you services and the

783
00:29:05,840 --> 00:29:08,640
services are all virtualized and what is

784
00:29:08,640 --> 00:29:09,919
core is that you have like a some

785
00:29:09,919 --> 00:29:11,840
function that'll virtualize

786
00:29:11,840 --> 00:29:14,320
by the vnf which is the virtual network

787
00:29:14,320 --> 00:29:16,720
functions so you have like with that we

788
00:29:16,720 --> 00:29:17,919
have you have like a very fast

789
00:29:17,919 --> 00:29:19,360
connectivity you have a lot of

790
00:29:19,360 --> 00:29:22,240
applications that are featured

791
00:29:22,240 --> 00:29:23,200
and

792
00:29:23,200 --> 00:29:24,799
what is cool is that

793
00:29:24,799 --> 00:29:27,760
this uh this thing is using restful api

794
00:29:27,760 --> 00:29:30,000
so it is not the same protocol as used

795
00:29:30,000 --> 00:29:32,000
before for example by the operators like

796
00:29:32,000 --> 00:29:35,200
complex protocol in sctp but it is now

797
00:29:35,200 --> 00:29:37,440
the web and so as it is using another

798
00:29:37,440 --> 00:29:39,279
technology most

799
00:29:39,279 --> 00:29:41,679
i mean like it is like a web technology

800
00:29:41,679 --> 00:29:43,679
uh you will mostly find also web of

801
00:29:43,679 --> 00:29:45,600
vulnerability on that so yeah actually

802
00:29:45,600 --> 00:29:48,240
this has doing a web pen test on the on

803
00:29:48,240 --> 00:29:50,640
the core network now so

804
00:29:50,640 --> 00:29:53,600
uh if you want to interact with the dnrf

805
00:29:53,600 --> 00:29:54,880
you have to know a lot of things you

806
00:29:54,880 --> 00:29:56,559
have to know what is the port of the

807
00:29:56,559 --> 00:29:59,440
service that is actually spawning that

808
00:29:59,440 --> 00:30:01,760
and also the api so the api is public so

809
00:30:01,760 --> 00:30:03,600
you can also just like pass

810
00:30:03,600 --> 00:30:06,320
the api for that and uh yeah and like

811
00:30:06,320 --> 00:30:08,159
that you can interact with it so as you

812
00:30:08,159 --> 00:30:10,159
have like some access after just like a

813
00:30:10,159 --> 00:30:12,480
point opening the the interface you can

814
00:30:12,480 --> 00:30:16,000
just then uh um we develop some tools in

815
00:30:16,000 --> 00:30:18,399
order to pass all the specifications all

816
00:30:18,399 --> 00:30:21,200
the open api because the the open app

817
00:30:21,200 --> 00:30:23,520
api also in burp was crashing at some

818
00:30:23,520 --> 00:30:25,840
point it was not able to

819
00:30:25,840 --> 00:30:28,000
to pass the um the specification so we

820
00:30:28,000 --> 00:30:30,559
had to uh to do a module which will be

821
00:30:30,559 --> 00:30:32,559
able to do that and then also forward

822
00:30:32,559 --> 00:30:34,640
all the requires to uh

823
00:30:34,640 --> 00:30:37,440
to repeater in order to then uh play

824
00:30:37,440 --> 00:30:39,440
some uh some some queries and like that

825
00:30:39,440 --> 00:30:42,640
where we have been able to uh

826
00:30:42,640 --> 00:30:44,320
to to see that

827
00:30:44,320 --> 00:30:46,880
uh it didn't require any logging any

828
00:30:46,880 --> 00:30:49,279
authentication in nrf so

829
00:30:49,279 --> 00:30:52,080
this is by default by default the the

830
00:30:52,080 --> 00:30:54,880
notification is not enforced uh and

831
00:30:54,880 --> 00:30:57,120
it was for this challenge but also uh

832
00:30:57,120 --> 00:30:59,919
for some setups in one client they were

833
00:30:59,919 --> 00:31:01,519
not they were not

834
00:31:01,519 --> 00:31:03,039
they were net

835
00:31:03,039 --> 00:31:05,039
they weren't uh

836
00:31:05,039 --> 00:31:06,880
aware about the authentication of that

837
00:31:06,880 --> 00:31:09,039
stuff so like that as an attacker you

838
00:31:09,039 --> 00:31:09,919
can

839
00:31:09,919 --> 00:31:11,679
if you have that access and you know

840
00:31:11,679 --> 00:31:14,080
exactly how to request that you know you

841
00:31:14,080 --> 00:31:15,679
can actually just like create some

842
00:31:15,679 --> 00:31:17,679
networks create some functions you can

843
00:31:17,679 --> 00:31:19,120
you can mess with that actually and you

844
00:31:19,120 --> 00:31:21,200
can leak some things i mean you can

845
00:31:21,200 --> 00:31:22,640
control everything because all the

846
00:31:22,640 --> 00:31:25,440
applications actually uh

847
00:31:25,440 --> 00:31:28,240
are actually using that

848
00:31:28,240 --> 00:31:30,159
so now

849
00:31:30,159 --> 00:31:31,440
all the things that could be interesting

850
00:31:31,440 --> 00:31:34,080
in 5g and as in other stacks are these

851
00:31:34,080 --> 00:31:35,679
like uh the

852
00:31:35,679 --> 00:31:36,480
um

853
00:31:36,480 --> 00:31:37,919
baseband attacks babe baseball and

854
00:31:37,919 --> 00:31:41,200
liberty uh uh hunting and this is much

855
00:31:41,200 --> 00:31:43,279
more complicated because um that's um

856
00:31:43,279 --> 00:31:45,440
you know in 2g at the time

857
00:31:45,440 --> 00:31:47,679
you had like a lot of devices or i mean

858
00:31:47,679 --> 00:31:49,279
these devices were

859
00:31:49,279 --> 00:31:51,840
much more easy to i mean much more easy

860
00:31:51,840 --> 00:31:54,000
to target but much more easy to exploit

861
00:31:54,000 --> 00:31:55,039
but now

862
00:31:55,039 --> 00:31:56,480
things are a little bit i mean

863
00:31:56,480 --> 00:31:58,240
complicated but still

864
00:31:58,240 --> 00:31:59,360
for example

865
00:31:59,360 --> 00:32:01,360
uh if you are able for example to export

866
00:32:01,360 --> 00:32:03,679
uh a target uh for example the the

867
00:32:03,679 --> 00:32:05,200
protocol stack you can do like pretty

868
00:32:05,200 --> 00:32:07,120
bad stuff like trigger the silent call

869
00:32:07,120 --> 00:32:09,279
you can also send some sms's you can do

870
00:32:09,279 --> 00:32:11,200
like pretty much a lot of things and you

871
00:32:11,200 --> 00:32:12,720
can also have an access to the

872
00:32:12,720 --> 00:32:14,720
application side by for example uh

873
00:32:14,720 --> 00:32:18,640
bypassing the mmu on mcu uh but yeah uh

874
00:32:18,640 --> 00:32:20,960
still you're a little bit restrained uh

875
00:32:20,960 --> 00:32:23,679
to to to access to interact with the

876
00:32:23,679 --> 00:32:25,120
application side but still you can do

877
00:32:25,120 --> 00:32:26,720
some pretty nice stuff

878
00:32:26,720 --> 00:32:28,480
um and yeah

879
00:32:28,480 --> 00:32:30,640
for the emulation i mean for the fuzzing

880
00:32:30,640 --> 00:32:31,840
if you want to find vulnerability on

881
00:32:31,840 --> 00:32:33,600
that you you perform some fuzzing test

882
00:32:33,600 --> 00:32:36,080
you can do that also doing some manual

883
00:32:36,080 --> 00:32:38,559
cut analysis of course but uh you are

884
00:32:38,559 --> 00:32:39,919
you can do like

885
00:32:39,919 --> 00:32:41,919
a footing of your radio which is very

886
00:32:41,919 --> 00:32:44,240
long you can do uh emulation or you can

887
00:32:44,240 --> 00:32:46,480
do also some reversing so the preferred

888
00:32:46,480 --> 00:32:48,559
approach is to do hybrid

889
00:32:48,559 --> 00:32:49,919
and what is interesting for the point

890
00:32:49,919 --> 00:32:53,360
gsm and gprs um i i really like for

891
00:32:53,360 --> 00:32:55,120
example for putting this target because

892
00:32:55,120 --> 00:32:56,640
you you can actually

893
00:32:56,640 --> 00:33:00,559
i mean every uh i mean every frames are

894
00:33:00,559 --> 00:33:02,000
i mean you have like a lot of friends

895
00:33:02,000 --> 00:33:04,000
that are not notificated a lot of frames

896
00:33:04,000 --> 00:33:05,679
are not

897
00:33:05,679 --> 00:33:07,760
protected so you can actually as an

898
00:33:07,760 --> 00:33:10,240
attacker without authentication without

899
00:33:10,240 --> 00:33:11,039
i mean

900
00:33:11,039 --> 00:33:12,080
anything

901
00:33:12,080 --> 00:33:14,559
any protection you can send to to the

902
00:33:14,559 --> 00:33:17,679
device some clear text

903
00:33:17,679 --> 00:33:19,679
click text frames and like that you can

904
00:33:19,679 --> 00:33:21,519
maybe expect to crash the target and

905
00:33:21,519 --> 00:33:23,679
maybe explore the target so here are

906
00:33:23,679 --> 00:33:25,279
some you know some

907
00:33:25,279 --> 00:33:26,399
some layers that could be like

908
00:33:26,399 --> 00:33:27,679
interesting like especially the

909
00:33:27,679 --> 00:33:30,880
connection management uh uh i mean level

910
00:33:30,880 --> 00:33:32,480
you have the modability management i

911
00:33:32,480 --> 00:33:34,559
mean all the three layers are very

912
00:33:34,559 --> 00:33:36,320
interesting to look at because you have

913
00:33:36,320 --> 00:33:38,399
like some type iit message type but also

914
00:33:38,399 --> 00:33:41,120
some tlv to attack so you can just mess

915
00:33:41,120 --> 00:33:42,960
around with the length and also the

916
00:33:42,960 --> 00:33:45,440
values that will be passed because then

917
00:33:45,440 --> 00:33:47,120
you have also a password which

918
00:33:47,120 --> 00:33:49,360
you try go through in order to exploit

919
00:33:49,360 --> 00:33:51,279
and if you want to do some mutation

920
00:33:51,279 --> 00:33:53,120
generation uh you have like some some

921
00:33:53,120 --> 00:33:54,880
good tool like leap mitch which was good

922
00:33:54,880 --> 00:33:57,360
for gsm gprs but uh for all the

923
00:33:57,360 --> 00:33:59,360
technology like 4g 5g et cetera you have

924
00:33:59,360 --> 00:34:02,240
peak pike rat which is like now the the

925
00:34:02,240 --> 00:34:03,679
tools to work with

926
00:34:03,679 --> 00:34:05,840
but the problem with bike rats compared

927
00:34:05,840 --> 00:34:08,000
to litmus is that limit was good to

928
00:34:08,000 --> 00:34:09,760
enable all the elements so like that you

929
00:34:09,760 --> 00:34:11,760
could crush the the target or you could

930
00:34:11,760 --> 00:34:13,280
just like uh

931
00:34:13,280 --> 00:34:14,159
you know

932
00:34:14,159 --> 00:34:16,719
i mean see observe like a strange

933
00:34:16,719 --> 00:34:18,480
behavior but with pikered you have to

934
00:34:18,480 --> 00:34:20,800
enable all of that by end so you have to

935
00:34:20,800 --> 00:34:23,440
to know a little bit um how to i mean

936
00:34:23,440 --> 00:34:25,119
you have to also to look a little bit on

937
00:34:25,119 --> 00:34:26,719
documentation in order to see how you

938
00:34:26,719 --> 00:34:29,359
can enable for example an element for

939
00:34:29,359 --> 00:34:31,599
example so yeah

940
00:34:31,599 --> 00:34:33,839
for for 2g gsm you could do that for

941
00:34:33,839 --> 00:34:35,520
example if you open bts which allows you

942
00:34:35,520 --> 00:34:36,800
for example with the test call feature

943
00:34:36,800 --> 00:34:38,719
to send directly the the payload uh with

944
00:34:38,719 --> 00:34:40,879
a bts you could also modify it and also

945
00:34:40,879 --> 00:34:42,639
small bts you could modify it to send

946
00:34:42,639 --> 00:34:46,800
some raw pillows but yeah in 3g since 3g

947
00:34:46,800 --> 00:34:49,199
it is much more difficult because you

948
00:34:49,199 --> 00:34:51,040
have less packets that are click text so

949
00:34:51,040 --> 00:34:53,119
at some points when you will have to

950
00:34:53,119 --> 00:34:54,639
expect for example targets you will have

951
00:34:54,639 --> 00:34:57,119
to be at some point authenticated so uh

952
00:34:57,119 --> 00:34:59,839
still uh there will be like some um you

953
00:34:59,839 --> 00:35:02,960
know unencrypted frames but uh there's

954
00:35:02,960 --> 00:35:04,720
like a not a lot of things that you can

955
00:35:04,720 --> 00:35:07,119
actually send to to the targets uh in

956
00:35:07,119 --> 00:35:08,160
encrypted

957
00:35:08,160 --> 00:35:10,480
and there's also another target that was

958
00:35:10,480 --> 00:35:13,200
like uh interesting to see um because uh

959
00:35:13,200 --> 00:35:15,680
marco gracie uh just like presented some

960
00:35:15,680 --> 00:35:18,320
stuff on the volte so in vlt he was

961
00:35:18,320 --> 00:35:20,400
capable for example to

962
00:35:20,400 --> 00:35:22,400
because it is sip at some point you can

963
00:35:22,400 --> 00:35:24,079
also for example

964
00:35:24,079 --> 00:35:25,040
i mean

965
00:35:25,040 --> 00:35:26,880
exploit a vulnerability in order to get

966
00:35:26,880 --> 00:35:29,359
a remote common execution on that so i

967
00:35:29,359 --> 00:35:32,480
mean code execution on that so actually

968
00:35:32,480 --> 00:35:34,079
it was very interesting to see that

969
00:35:34,079 --> 00:35:36,880
because uh maybe also just

970
00:35:36,880 --> 00:35:38,480
just like um

971
00:35:38,480 --> 00:35:41,119
focusing only on the 5g uh

972
00:35:41,119 --> 00:35:43,200
frames is maybe not enough maybe we

973
00:35:43,200 --> 00:35:44,960
could we can also look at all the

974
00:35:44,960 --> 00:35:47,440
services that 5g will provide because in

975
00:35:47,440 --> 00:35:49,440
here for a reality

976
00:35:49,440 --> 00:35:51,359
we can find a lot of things but with 5g

977
00:35:51,359 --> 00:35:53,440
we'll have much more services so it's

978
00:35:53,440 --> 00:35:55,599
really good to see what kind of services

979
00:35:55,599 --> 00:35:57,359
we can actually uh

980
00:35:57,359 --> 00:35:59,599
fuds

981
00:35:59,599 --> 00:36:01,040
and so if you want to send the open

982
00:36:01,040 --> 00:36:03,040
loads in 5g you don't have like a lot of

983
00:36:03,040 --> 00:36:04,640
choice in nsa

984
00:36:04,640 --> 00:36:06,560
of course you can use sls run but in

985
00:36:06,560 --> 00:36:08,560
essay you have to modify because it is

986
00:36:08,560 --> 00:36:10,880
close source and it is also the same

987
00:36:10,880 --> 00:36:13,520
thing that michael gracie presented yeah

988
00:36:13,520 --> 00:36:15,599
i don't know um michael jassy for

989
00:36:15,599 --> 00:36:17,680
example just like presented how to fight

990
00:36:17,680 --> 00:36:21,520
cdma so uh some cdma stuff he just like

991
00:36:21,520 --> 00:36:22,880
took for example some

992
00:36:22,880 --> 00:36:25,839
some closed source

993
00:36:25,839 --> 00:36:28,320
i mean commercial for example

994
00:36:28,320 --> 00:36:29,839
a system that was able for example to

995
00:36:29,839 --> 00:36:32,240
spawn a cdma station and he modified it

996
00:36:32,240 --> 00:36:34,480
in order to send some raw payload in

997
00:36:34,480 --> 00:36:37,119
order to export the targets and in here

998
00:36:37,119 --> 00:36:39,520
it is exactly the same with amary soft

999
00:36:39,520 --> 00:36:42,560
you have to patch ltn at b and then also

1000
00:36:42,560 --> 00:36:44,960
you have to get around with the stripped

1001
00:36:44,960 --> 00:36:48,000
binary because now since uh a year or

1002
00:36:48,000 --> 00:36:50,480
two the binary is now

1003
00:36:50,480 --> 00:36:52,560
stripped and maybe maybe maybe more than

1004
00:36:52,560 --> 00:36:55,440
that maybe three years but before like

1005
00:36:55,440 --> 00:36:57,920
four years ago it was completely uh i

1006
00:36:57,920 --> 00:36:58,720
mean

1007
00:36:58,720 --> 00:37:01,119
you could patch it like very simply i

1008
00:37:01,119 --> 00:37:02,240
still have like you know the all the

1009
00:37:02,240 --> 00:37:04,560
references and i use that for example to

1010
00:37:04,560 --> 00:37:06,240
directly patch it and send some pillows

1011
00:37:06,240 --> 00:37:08,240
on that

1012
00:37:08,240 --> 00:37:10,160
if you want to map also the devices

1013
00:37:10,160 --> 00:37:12,640
because also when you target the device

1014
00:37:12,640 --> 00:37:14,640
it is not easy to see for example your

1015
00:37:14,640 --> 00:37:16,640
your target will be like a samsung guest

1016
00:37:16,640 --> 00:37:17,880
i don't know

1017
00:37:17,880 --> 00:37:21,520
st11 i mean or an apple x or something

1018
00:37:21,520 --> 00:37:22,400
like that

1019
00:37:22,400 --> 00:37:24,240
you can always use the tag the type

1020
00:37:24,240 --> 00:37:26,079
allocation code in order to classify for

1021
00:37:26,079 --> 00:37:27,839
example which target you are looking at

1022
00:37:27,839 --> 00:37:29,440
you can also use the

1023
00:37:29,440 --> 00:37:32,000
gmsa uh so

1024
00:37:32,000 --> 00:37:33,920
gsa gsma

1025
00:37:33,920 --> 00:37:35,839
commercial db which allows you also to

1026
00:37:35,839 --> 00:37:37,119
have like much more information about

1027
00:37:37,119 --> 00:37:38,480
the target because you can just provide

1028
00:37:38,480 --> 00:37:41,280
the mei and like that you can see that

1029
00:37:41,280 --> 00:37:43,520
it is this phone so i can just like send

1030
00:37:43,520 --> 00:37:45,200
the payload or the the appropriate

1031
00:37:45,200 --> 00:37:46,640
pillow to this one

1032
00:37:46,640 --> 00:37:48,000
and yeah

1033
00:37:48,000 --> 00:37:48,880
still

1034
00:37:48,880 --> 00:37:50,720
for base station if you want to uh

1035
00:37:50,720 --> 00:37:51,920
through for example target the base

1036
00:37:51,920 --> 00:37:52,960
station you want to trigger

1037
00:37:52,960 --> 00:37:54,720
vulnerability on base station it is much

1038
00:37:54,720 --> 00:37:56,240
more complex because you have to work on

1039
00:37:56,240 --> 00:37:58,320
the behavior or the base station uh you

1040
00:37:58,320 --> 00:38:00,320
know when you work for example i mean

1041
00:38:00,320 --> 00:38:03,040
with a brand are true you can spot some

1042
00:38:03,040 --> 00:38:04,880
differences on how

1043
00:38:04,880 --> 00:38:06,720
things are sent but it's much more

1044
00:38:06,720 --> 00:38:08,640
difficult for example yeah if you don't

1045
00:38:08,640 --> 00:38:10,240
know the operator what the operator is

1046
00:38:10,240 --> 00:38:12,160
using uh what technology the operator is

1047
00:38:12,160 --> 00:38:13,839
using

1048
00:38:13,839 --> 00:38:16,079
and then so yeah the euro check texture

1049
00:38:16,079 --> 00:38:17,920
so um you have to know that for example

1050
00:38:17,920 --> 00:38:19,440
for the emulation it could be like very

1051
00:38:19,440 --> 00:38:20,640
interesting to know that for example

1052
00:38:20,640 --> 00:38:22,800
your target is mostly uh running arm

1053
00:38:22,800 --> 00:38:25,359
because arm is easy piece to to actually

1054
00:38:25,359 --> 00:38:27,280
emulate i mean as a ps because you have

1055
00:38:27,280 --> 00:38:29,119
also to do like a lot of work on

1056
00:38:29,119 --> 00:38:32,800
byzantine the context everything so

1057
00:38:32,800 --> 00:38:34,160
yeah

1058
00:38:34,160 --> 00:38:35,680
so you have to take in mind that for

1059
00:38:35,680 --> 00:38:38,240
example if you want to uh to learn some

1060
00:38:38,240 --> 00:38:40,880
stuff on a baseband exploitation i i

1061
00:38:40,880 --> 00:38:42,640
consider for example using exynos at

1062
00:38:42,640 --> 00:38:44,400
some point because xenos

1063
00:38:44,400 --> 00:38:45,839
see if you have like the access of the

1064
00:38:45,839 --> 00:38:49,280
old uh samsung s6 it's perfect for you

1065
00:38:49,280 --> 00:38:51,760
know to begin uh if you have the uh the

1066
00:38:51,760 --> 00:38:52,880
later one

1067
00:38:52,880 --> 00:38:54,160
it's not a problem you will have like

1068
00:38:54,160 --> 00:38:55,839
much more trouble to restore some

1069
00:38:55,839 --> 00:38:58,160
context so you have to build a context

1070
00:38:58,160 --> 00:39:00,400
that will work and then try to see if

1071
00:39:00,400 --> 00:39:02,480
you can actually trigger the bug for i

1072
00:39:02,480 --> 00:39:04,160
silicon this will be like much more

1073
00:39:04,160 --> 00:39:06,160
complicated because at some points now

1074
00:39:06,160 --> 00:39:08,240
the icon baseband

1075
00:39:08,240 --> 00:39:09,520
if you want to look at the firmware the

1076
00:39:09,520 --> 00:39:11,520
firmware is encrypted so

1077
00:39:11,520 --> 00:39:14,480
i mean even if it is using arm uh it's

1078
00:39:14,480 --> 00:39:17,200
the access is not easy uh some mtk

1079
00:39:17,200 --> 00:39:18,560
devices

1080
00:39:18,560 --> 00:39:20,480
use also arm qualcomm devices all the

1081
00:39:20,480 --> 00:39:23,040
qualcomm devices uh use arm

1082
00:39:23,040 --> 00:39:26,320
uh and yeah you have xk86 mips etc so

1083
00:39:26,320 --> 00:39:27,680
yeah now you have to take an account

1084
00:39:27,680 --> 00:39:30,079
what type of how you can actually

1085
00:39:30,079 --> 00:39:31,839
debug the stuff how we can exploit it

1086
00:39:31,839 --> 00:39:33,359
and at some point you need at some point

1087
00:39:33,359 --> 00:39:34,720
some emulation

1088
00:39:34,720 --> 00:39:37,200
so yeah uh there's like some uh

1089
00:39:37,200 --> 00:39:38,720
something that you already know how to

1090
00:39:38,720 --> 00:39:40,640
emulate for the target with killing or

1091
00:39:40,640 --> 00:39:43,359
with our unicorn with a lot of things so

1092
00:39:43,359 --> 00:39:45,040
this for forum there's like plenty of

1093
00:39:45,040 --> 00:39:47,359
things but for qualcomm

1094
00:39:47,359 --> 00:39:49,280
10 years ago it was ready because it was

1095
00:39:49,280 --> 00:39:50,720
just simple arm

1096
00:39:50,720 --> 00:39:53,440
and you had also something that was

1097
00:39:53,440 --> 00:39:55,440
developed by one of

1098
00:39:55,440 --> 00:39:57,520
one of my colleagues at sugetti at the

1099
00:39:57,520 --> 00:40:00,079
time which was cucumber dbg but now

1100
00:40:00,079 --> 00:40:02,160
there's like no tools at all i mean

1101
00:40:02,160 --> 00:40:04,640
there's like only like some uh

1102
00:40:04,640 --> 00:40:07,359
ada engines in order to uh to reverse

1103
00:40:07,359 --> 00:40:10,880
that there's also trace 32 um from

1104
00:40:10,880 --> 00:40:12,480
20 uh

1105
00:40:12,480 --> 00:40:16,960
19 you have also a qmu hexagon for q um

1106
00:40:16,960 --> 00:40:19,440
dsp six but

1107
00:40:19,440 --> 00:40:21,920
yeah it is failing a little bit or to to

1108
00:40:21,920 --> 00:40:23,760
emulate it is not as easy to as

1109
00:40:23,760 --> 00:40:25,520
emulating facebook and arm architecture

1110
00:40:25,520 --> 00:40:28,400
but yeah maybe uh you know

1111
00:40:28,400 --> 00:40:30,480
in some years i will be able to to

1112
00:40:30,480 --> 00:40:32,640
emulate it more properly than that but

1113
00:40:32,640 --> 00:40:33,599
still

1114
00:40:33,599 --> 00:40:36,480
it's like complicated so generally what

1115
00:40:36,480 --> 00:40:38,079
i'm doing is that you know we've traced

1116
00:40:38,079 --> 00:40:41,440
32 and also uh other things and i try

1117
00:40:41,440 --> 00:40:43,599
also to look at the debug information

1118
00:40:43,599 --> 00:40:45,839
provided by qsgm so to do that for

1119
00:40:45,839 --> 00:40:48,319
example i have to have like a uh

1120
00:40:48,319 --> 00:40:49,599
i mean

1121
00:40:49,599 --> 00:40:52,400
the jag access and to get their access

1122
00:40:52,400 --> 00:40:54,079
you can file per user module the module

1123
00:40:54,079 --> 00:40:55,680
generally provides you the drag access

1124
00:40:55,680 --> 00:40:57,760
but it doesn't provide you the gi access

1125
00:40:57,760 --> 00:40:59,680
with only 80 commands you can still look

1126
00:40:59,680 --> 00:41:01,599
at some hide-and-go-command in order to

1127
00:41:01,599 --> 00:41:04,480
enable the data access and so like that

1128
00:41:04,480 --> 00:41:06,800
and especially in here i can also enable

1129
00:41:06,800 --> 00:41:08,800
adb and which is interesting is that

1130
00:41:08,800 --> 00:41:10,960
this kind of module uh

1131
00:41:10,960 --> 00:41:11,839
i mean

1132
00:41:11,839 --> 00:41:13,440
in this module you have an android

1133
00:41:13,440 --> 00:41:16,400
running so um in the application side

1134
00:41:16,400 --> 00:41:18,160
you have the android you have the base

1135
00:41:18,160 --> 00:41:19,520
button then

1136
00:41:19,520 --> 00:41:21,520
and so just like typing this 80 command

1137
00:41:21,520 --> 00:41:24,480
i'm about to uh you know to pro i mean

1138
00:41:24,480 --> 00:41:27,119
to provide an adb service on which i can

1139
00:41:27,119 --> 00:41:29,359
connect to it and connect it to it i can

1140
00:41:29,359 --> 00:41:31,520
just like send some comments on the on

1141
00:41:31,520 --> 00:41:33,520
the module not on the base banner but

1142
00:41:33,520 --> 00:41:35,280
only on the module on the application

1143
00:41:35,280 --> 00:41:36,480
side and like that i can do some

1144
00:41:36,480 --> 00:41:38,160
debugging stuff

1145
00:41:38,160 --> 00:41:40,000
so yeah and you have also some civil

1146
00:41:40,000 --> 00:41:44,160
similar ways with um some other qualcomm

1147
00:41:44,160 --> 00:41:47,280
modules like uh ac20 from cactel or

1148
00:41:47,280 --> 00:41:50,160
agiva 25g etc

1149
00:41:50,160 --> 00:41:51,599
so yeah if you're interesting about

1150
00:41:51,599 --> 00:41:52,640
fuzzing

1151
00:41:52,640 --> 00:41:53,359
on

1152
00:41:53,359 --> 00:41:56,000
mobile there's like plenty of plenty of

1153
00:41:56,000 --> 00:41:58,240
reading i have also done some reading on

1154
00:41:58,240 --> 00:42:01,599
gsm protocol stuff you know at the time

1155
00:42:01,599 --> 00:42:03,359
and they are there's like here there's

1156
00:42:03,359 --> 00:42:05,280
like a listing of good reading to

1157
00:42:05,280 --> 00:42:06,960
actually begin on

1158
00:42:06,960 --> 00:42:09,359
so yeah the conclusion is that phage

1159
00:42:09,359 --> 00:42:12,160
failed gnar is maybe complex but it is

1160
00:42:12,160 --> 00:42:13,839
also different it's used also it is

1161
00:42:13,839 --> 00:42:15,119
using some technology that we are

1162
00:42:15,119 --> 00:42:17,920
actually using for many years uh so

1163
00:42:17,920 --> 00:42:20,240
actually you saw for example that now we

1164
00:42:20,240 --> 00:42:22,720
have a ipa rest in the core network

1165
00:42:22,720 --> 00:42:24,800
which now allows for example for web

1166
00:42:24,800 --> 00:42:26,480
security researcher to actually perform

1167
00:42:26,480 --> 00:42:29,280
some pen test uh because it is something

1168
00:42:29,280 --> 00:42:32,880
that he knows but it doesn't i mean uh

1169
00:42:32,880 --> 00:42:34,960
yeah you don't have to to say that yeah

1170
00:42:34,960 --> 00:42:36,800
of course

1171
00:42:36,800 --> 00:42:38,800
in the oldest technology it was like

1172
00:42:38,800 --> 00:42:41,839
pretty uh i mean it was pretty buggy and

1173
00:42:41,839 --> 00:42:44,240
you had also to send like some weird

1174
00:42:44,240 --> 00:42:46,960
sctp frames now it is web so you can

1175
00:42:46,960 --> 00:42:50,000
also try to find some web verity on that

1176
00:42:50,000 --> 00:42:51,599
and um

1177
00:42:51,599 --> 00:42:54,319
you see that for 2g uh

1178
00:42:54,319 --> 00:42:55,520
from 2g to

1179
00:42:55,520 --> 00:42:58,480
4g it was not very expensive to actually

1180
00:42:58,480 --> 00:43:00,319
um you know do some assessment on the

1181
00:43:00,319 --> 00:43:02,800
radio and also other things but now with

1182
00:43:02,800 --> 00:43:05,280
5g it will likely be you know at this

1183
00:43:05,280 --> 00:43:07,200
price because you need to afford for the

1184
00:43:07,200 --> 00:43:09,839
hardware for that so this is kind of um

1185
00:43:09,839 --> 00:43:12,480
i mean kind of sad but maybe some

1186
00:43:12,480 --> 00:43:14,319
constructors some sda constructor will

1187
00:43:14,319 --> 00:43:16,640
probably just provide a cheaper version

1188
00:43:16,640 --> 00:43:18,960
which will allow you for example to uh

1189
00:43:18,960 --> 00:43:21,200
to to perform some 5g stuff in the radio

1190
00:43:21,200 --> 00:43:23,760
but for the moment it will be like a

1191
00:43:23,760 --> 00:43:25,839
little bit expensive on the radio side

1192
00:43:25,839 --> 00:43:28,240
uh but yeah attacking the record radio

1193
00:43:28,240 --> 00:43:30,160
would it's a very interesting thing

1194
00:43:30,160 --> 00:43:32,000
because i didn't talk about the slicers

1195
00:43:32,000 --> 00:43:34,800
uh which is used by other types of

1196
00:43:34,800 --> 00:43:37,760
devices so it is also i mean a mystery

1197
00:43:37,760 --> 00:43:39,520
use i mean mysterious there's like

1198
00:43:39,520 --> 00:43:41,680
plenty of stuff to discover on this side

1199
00:43:41,680 --> 00:43:44,319
uh and yeah this is like still of i mean

1200
00:43:44,319 --> 00:43:46,240
a lot of tools are missing on 5gsa

1201
00:43:46,240 --> 00:43:48,800
actually i just developed one of tools

1202
00:43:48,800 --> 00:43:50,160
that can be interesting but there's like

1203
00:43:50,160 --> 00:43:53,280
plenty of tools that are missing and

1204
00:43:53,280 --> 00:43:55,040
that means that this area actually is

1205
00:43:55,040 --> 00:43:57,200
like not a gold mine but i think that

1206
00:43:57,200 --> 00:43:58,800
there's like plenty of stuff still to

1207
00:43:58,800 --> 00:44:02,000
discover and we just in here we just see

1208
00:44:02,000 --> 00:44:04,400
i mean the the surface of that so yeah

1209
00:44:04,400 --> 00:44:06,240
and yeah of course i wanted to talk i

1210
00:44:06,240 --> 00:44:07,680
mean about qualcomm i talked about

1211
00:44:07,680 --> 00:44:09,440
qualcomm target could be like a nice

1212
00:44:09,440 --> 00:44:11,359
target actually two-thirds but still as

1213
00:44:11,359 --> 00:44:13,280
you know there's like not plenty much a

1214
00:44:13,280 --> 00:44:16,880
lot of tools uh but as it is complex

1215
00:44:16,880 --> 00:44:18,960
less people also

1216
00:44:18,960 --> 00:44:20,880
look at it so yeah this is something

1217
00:44:20,880 --> 00:44:22,880
that i will much more i mean i will work

1218
00:44:22,880 --> 00:44:24,800
much more closely at that maybe i will

1219
00:44:24,800 --> 00:44:26,480
not find anything on that because it

1220
00:44:26,480 --> 00:44:28,000
will be much more difficult but yeah

1221
00:44:28,000 --> 00:44:30,800
still let's let's get a try so yeah

1222
00:44:30,800 --> 00:44:32,800
thank you very much guys uh if you have

1223
00:44:32,800 --> 00:44:35,280
any questions etc no don't hesitate also

1224
00:44:35,280 --> 00:44:36,960
to contact me you can also watch my

1225
00:44:36,960 --> 00:44:39,280
youtube channel where i can also provide

1226
00:44:39,280 --> 00:44:40,880
much more deeper information because in

1227
00:44:40,880 --> 00:44:43,599
here i compensated a lot of things here

1228
00:44:43,599 --> 00:44:46,240
but i will go in more details about

1229
00:44:46,240 --> 00:44:48,000
every part but yeah

1230
00:44:48,000 --> 00:44:49,520
thank you very much and if you have any

1231
00:44:49,520 --> 00:44:50,800
questions

1232
00:44:50,800 --> 00:44:54,119
please ask

1233
00:44:56,110 --> 00:45:04,400
[Music]

1234
00:45:04,400 --> 00:45:07,230
okay

1235
00:45:07,230 --> 00:45:14,270
[Music]

