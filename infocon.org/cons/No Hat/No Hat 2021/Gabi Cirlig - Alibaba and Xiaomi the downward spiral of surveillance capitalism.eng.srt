1
00:00:02,480 --> 00:00:05,260
uh

2
00:00:05,260 --> 00:00:08,500
[Music]

3
00:00:10,700 --> 00:00:21,039
[Music]

4
00:00:21,039 --> 00:00:24,039
me

5
00:00:24,410 --> 00:00:30,960
[Music]

6
00:00:30,960 --> 00:00:32,159
it is working

7
00:00:32,159 --> 00:00:33,520
uh hello

8
00:00:33,520 --> 00:00:35,200
uh i'm gabby

9
00:00:35,200 --> 00:00:36,079
uh

10
00:00:36,079 --> 00:00:37,840
just a small disclaimer all of the

11
00:00:37,840 --> 00:00:39,440
research that i'm gonna present here

12
00:00:39,440 --> 00:00:40,480
today

13
00:00:40,480 --> 00:00:41,440
is

14
00:00:41,440 --> 00:00:43,200
independent research it has no

15
00:00:43,200 --> 00:00:45,120
affiliation with

16
00:00:45,120 --> 00:00:46,879
whitetops or the future company where

17
00:00:46,879 --> 00:00:48,320
i'll be working

18
00:00:48,320 --> 00:00:50,399
so um

19
00:00:50,399 --> 00:00:54,239
it's going to be a deep dive into how

20
00:00:54,239 --> 00:00:56,879
big companies go out of their ways to

21
00:00:56,879 --> 00:00:59,280
basically spy on their users and mostly

22
00:00:59,280 --> 00:01:01,039
when

23
00:01:01,039 --> 00:01:02,640
the product is cheap

24
00:01:02,640 --> 00:01:06,320
you are the product

25
00:01:08,640 --> 00:01:10,799
first thing first

26
00:01:10,799 --> 00:01:13,600
as i said i'm gabby they call me the

27
00:01:13,600 --> 00:01:16,880
public transportation hacker back home i

28
00:01:16,880 --> 00:01:19,200
hacked the publishing transit system in

29
00:01:19,200 --> 00:01:20,479
bucharest

30
00:01:20,479 --> 00:01:21,680
um

31
00:01:21,680 --> 00:01:24,720
after that it turns out i couldn't

32
00:01:24,720 --> 00:01:26,960
travel anymore uh for free with the

33
00:01:26,960 --> 00:01:30,079
public transit system back home so

34
00:01:30,079 --> 00:01:32,960
i had my car turns out it knew a lot

35
00:01:32,960 --> 00:01:34,560
more about

36
00:01:34,560 --> 00:01:37,200
me than i knew about myself i mean go

37
00:01:37,200 --> 00:01:40,640
figure and after that i just started

38
00:01:40,640 --> 00:01:42,720
hunting for um

39
00:01:42,720 --> 00:01:45,040
bad threats on the internet uh mostly

40
00:01:45,040 --> 00:01:47,680
bots and privacy issues

41
00:01:47,680 --> 00:01:48,880
um

42
00:01:48,880 --> 00:01:51,200
that being said let's find out a bit

43
00:01:51,200 --> 00:01:53,040
more about yourselves

44
00:01:53,040 --> 00:01:55,280
raise your hand whoever has a mobile

45
00:01:55,280 --> 00:01:57,600
phone

46
00:01:59,119 --> 00:02:00,880
all right seems like we still have some

47
00:02:00,880 --> 00:02:01,920
guys that

48
00:02:01,920 --> 00:02:04,640
are really old school

49
00:02:04,640 --> 00:02:06,240
raise your hand who if you have an

50
00:02:06,240 --> 00:02:08,720
android

51
00:02:08,720 --> 00:02:09,520
now

52
00:02:09,520 --> 00:02:12,399
if you have ios

53
00:02:12,400 --> 00:02:14,879
cool cool i have something for both

54
00:02:14,879 --> 00:02:17,280
sides basically unfortunately i don't

55
00:02:17,280 --> 00:02:19,040
have anything for like

56
00:02:19,040 --> 00:02:22,160
windows linux desktops but it's going to

57
00:02:22,160 --> 00:02:24,480
be juicing

58
00:02:24,480 --> 00:02:27,920
in mobile spyware

59
00:02:27,920 --> 00:02:29,760
so

60
00:02:29,760 --> 00:02:33,518
who knows what this is

61
00:02:33,680 --> 00:02:34,879
anyone

62
00:02:34,879 --> 00:02:36,560
anyone okay

63
00:02:36,560 --> 00:02:39,200
how about a little hint

64
00:02:39,200 --> 00:02:40,800
do you know about these guys

65
00:02:40,800 --> 00:02:43,120
i guess you do

66
00:02:43,120 --> 00:02:44,400
all right

67
00:02:44,400 --> 00:02:47,599
they decided to get a browser because

68
00:02:47,599 --> 00:02:49,040
that's the quickest way to access

69
00:02:49,040 --> 00:02:52,720
somebody's data nowadays

70
00:02:52,720 --> 00:02:54,239
that happened

71
00:02:54,239 --> 00:02:55,840
six years ago

72
00:02:55,840 --> 00:02:58,800
they bought a company called uc web

73
00:02:58,800 --> 00:03:02,640
uc web has one of the biggest browsers

74
00:03:02,640 --> 00:03:05,120
in asia basically

75
00:03:05,120 --> 00:03:06,159
um

76
00:03:06,159 --> 00:03:08,560
and turns out that it's not only them

77
00:03:08,560 --> 00:03:10,959
that are in for the for the user this

78
00:03:10,959 --> 00:03:13,840
data uh raise your hand if you know

79
00:03:13,840 --> 00:03:16,239
about these guys

80
00:03:16,239 --> 00:03:18,800
yeah those are xiaomi for whoever

81
00:03:18,800 --> 00:03:22,480
doesn't know right now they have

82
00:03:22,480 --> 00:03:24,879
one of the biggest market shares i think

83
00:03:24,879 --> 00:03:27,280
in android in certain areas of the world

84
00:03:27,280 --> 00:03:30,879
they are basically number one

85
00:03:31,760 --> 00:03:33,120
now

86
00:03:33,120 --> 00:03:36,480
they don't only make android phones they

87
00:03:36,480 --> 00:03:38,159
were

88
00:03:38,159 --> 00:03:40,640
founded uh

89
00:03:40,640 --> 00:03:42,720
11 years ago

90
00:03:42,720 --> 00:03:45,280
they're called like the uber of asia

91
00:03:45,280 --> 00:03:46,799
they make

92
00:03:46,799 --> 00:03:50,080
smartphone tablets batteries mice tvs

93
00:03:50,080 --> 00:03:52,319
bluetooth speakers selfie sticks

94
00:03:52,319 --> 00:03:53,840
umbrellas

95
00:03:53,840 --> 00:03:54,879
toys

96
00:03:54,879 --> 00:03:57,040
and all of their send data and to be

97
00:03:57,040 --> 00:03:58,720
honest i mean

98
00:03:58,720 --> 00:04:00,879
we're basically screwed so they might as

99
00:04:00,879 --> 00:04:03,040
well make some sex plays as well

100
00:04:03,040 --> 00:04:05,439
to do it properly

101
00:04:05,439 --> 00:04:07,120
um

102
00:04:07,120 --> 00:04:08,319
as i said

103
00:04:08,319 --> 00:04:11,120
uh they own the biggest market share

104
00:04:11,120 --> 00:04:13,599
i think the graph is in india

105
00:04:13,599 --> 00:04:15,920
and the black guys over there are

106
00:04:15,920 --> 00:04:17,839
their market share

107
00:04:17,839 --> 00:04:19,600
in that area no wonder that they got

108
00:04:19,600 --> 00:04:21,600
banned at some point and can no longer

109
00:04:21,600 --> 00:04:24,639
push the products

110
00:04:26,840 --> 00:04:30,240
now a year and a half ago i decided to

111
00:04:30,240 --> 00:04:32,240
get a new phone

112
00:04:32,240 --> 00:04:33,520
and

113
00:04:33,520 --> 00:04:37,120
i found the note 8 d i think that's the

114
00:04:37,120 --> 00:04:40,400
name it looked really cool it was really

115
00:04:40,400 --> 00:04:43,280
cheap like extremely cheap

116
00:04:43,280 --> 00:04:46,080
it had a um

117
00:04:46,080 --> 00:04:48,240
good camera it was powerful

118
00:04:48,240 --> 00:04:50,400
uh it had nfc so you can do all kinds of

119
00:04:50,400 --> 00:04:51,759
mi fair hacks

120
00:04:51,759 --> 00:04:53,440
uh solid display

121
00:04:53,440 --> 00:04:56,400
and what's the catch right i mean how

122
00:04:56,400 --> 00:04:59,440
can a phone that's 150 euros

123
00:04:59,440 --> 00:05:02,320
have so many features packed in

124
00:05:02,320 --> 00:05:03,520
um

125
00:05:03,520 --> 00:05:06,880
that's why i basically started doing the

126
00:05:06,880 --> 00:05:10,479
usual tear down process of whenever i

127
00:05:10,479 --> 00:05:12,720
get a new device i start sniffing on the

128
00:05:12,720 --> 00:05:16,880
traffic in order to determine if

129
00:05:16,880 --> 00:05:19,360
there's something shady about it

130
00:05:19,360 --> 00:05:20,240
and

131
00:05:20,240 --> 00:05:21,520
i rooted it

132
00:05:21,520 --> 00:05:23,919
by the way the root process is extremely

133
00:05:23,919 --> 00:05:25,039
painful

134
00:05:25,039 --> 00:05:28,160
it's it takes like one week in which you

135
00:05:28,160 --> 00:05:30,800
have to use the phone after you applied

136
00:05:30,800 --> 00:05:31,520
for

137
00:05:31,520 --> 00:05:33,520
unlocking the bootloader because it

138
00:05:33,520 --> 00:05:35,759
turns out that other companies

139
00:05:35,759 --> 00:05:38,560
buy xiaomi phones they root them they

140
00:05:38,560 --> 00:05:41,600
rebrand them and resell them in order to

141
00:05:41,600 --> 00:05:43,759
turn in some quick cash without allowing

142
00:05:43,759 --> 00:05:46,240
them data to the switch

143
00:05:46,240 --> 00:05:48,400
without allowing them access to the data

144
00:05:48,400 --> 00:05:50,880
of the user

145
00:05:51,039 --> 00:05:53,199
and this is what i found

146
00:05:53,199 --> 00:05:55,039
straight out

147
00:05:55,039 --> 00:05:56,000
like

148
00:05:56,000 --> 00:05:57,360
new phone

149
00:05:57,360 --> 00:05:59,680
in

150
00:05:59,759 --> 00:06:01,919
30 uh in a few hours

151
00:06:01,919 --> 00:06:03,520
a lot of requests

152
00:06:03,520 --> 00:06:05,360
it's gonna get a lot worse just you wait

153
00:06:05,360 --> 00:06:07,600
and this is done basically but not by

154
00:06:07,600 --> 00:06:10,560
not doing anything

155
00:06:11,120 --> 00:06:14,080
so naturally when there's so much data

156
00:06:14,080 --> 00:06:16,400
being exfiltrated there must be

157
00:06:16,400 --> 00:06:18,960
something shady going around and i can

158
00:06:18,960 --> 00:06:21,520
do a live demo but i have the next best

159
00:06:21,520 --> 00:06:24,639
thing i have a recording and i'm just

160
00:06:24,639 --> 00:06:26,800
launching the default browser

161
00:06:26,800 --> 00:06:28,479
on a xiaomi phone

162
00:06:28,479 --> 00:06:30,720
i'm incognito

163
00:06:30,720 --> 00:06:34,639
and i am doing some random history facts

164
00:06:34,639 --> 00:06:37,759
research you know

165
00:06:37,840 --> 00:06:41,758
and we have the first call right there

166
00:06:43,919 --> 00:06:45,919
unfortunately we can't see anything

167
00:06:45,919 --> 00:06:48,639
i mean in incognito they block

168
00:06:48,639 --> 00:06:51,599
streaming the display

169
00:06:52,240 --> 00:06:56,639
and we're gonna get a new hit soon

170
00:06:56,639 --> 00:06:57,759
you can see

171
00:06:57,759 --> 00:07:00,720
all of the requests

172
00:07:00,720 --> 00:07:03,840
another hit

173
00:07:05,360 --> 00:07:09,360
and now i switched off uh incognito mode

174
00:07:09,360 --> 00:07:11,759
making sure that i'm gonna be like put

175
00:07:11,759 --> 00:07:14,840
on some lists over there in

176
00:07:14,840 --> 00:07:16,800
asia now

177
00:07:16,800 --> 00:07:20,319
this is a base64

178
00:07:20,639 --> 00:07:24,400
that's being sent in plain text

179
00:07:25,120 --> 00:07:28,000
and you can see

180
00:07:28,960 --> 00:07:32,720
that my search query was sent

181
00:07:32,720 --> 00:07:35,199
to their servers

182
00:07:35,199 --> 00:07:37,919
just like that

183
00:07:39,039 --> 00:07:41,440
in incognito mode

184
00:07:41,440 --> 00:07:45,599
correlated with the miui id that i have

185
00:07:45,599 --> 00:07:48,000
and the miui id is correlated with a

186
00:07:48,000 --> 00:07:48,879
real

187
00:07:48,879 --> 00:07:50,560
uh address

188
00:07:50,560 --> 00:07:52,400
that i use there's

189
00:07:52,400 --> 00:07:54,960
no other way to skip it basically and in

190
00:07:54,960 --> 00:07:56,319
addition to that

191
00:07:56,319 --> 00:07:59,039
there's all of my

192
00:07:59,039 --> 00:08:02,800
browsing history up to that point

193
00:08:06,319 --> 00:08:07,919
now

194
00:08:07,919 --> 00:08:10,479
let's dive a bit more into the details

195
00:08:10,479 --> 00:08:11,680
so i can

196
00:08:11,680 --> 00:08:13,759
basically give the tools for everybody

197
00:08:13,759 --> 00:08:16,960
who wants to dive into android research

198
00:08:16,960 --> 00:08:20,000
how they can to enable them to do

199
00:08:20,000 --> 00:08:22,800
the kind of research that i did as well

200
00:08:22,800 --> 00:08:24,400
so

201
00:08:24,400 --> 00:08:26,400
you can see that

202
00:08:26,400 --> 00:08:28,319
they are sending

203
00:08:28,319 --> 00:08:29,759
this request

204
00:08:29,759 --> 00:08:32,640
over there date underscore list we have

205
00:08:32,640 --> 00:08:35,120
to remember that

206
00:08:35,120 --> 00:08:37,599
to an ip

207
00:08:37,599 --> 00:08:39,039
to a domain

208
00:08:39,039 --> 00:08:40,479
that's being

209
00:08:40,479 --> 00:08:44,000
registered in china and that was the big

210
00:08:44,000 --> 00:08:45,440
like red flag

211
00:08:45,440 --> 00:08:46,480
then

212
00:08:46,480 --> 00:08:49,120
the domain points to three ips based on

213
00:08:49,120 --> 00:08:51,600
the location where you are for usd sends

214
00:08:51,600 --> 00:08:54,240
the data to us for rashad russia for the

215
00:08:54,240 --> 00:08:56,640
rest of the world to singapore

216
00:08:56,640 --> 00:09:00,240
allegedly in a neutral data center

217
00:09:00,240 --> 00:09:02,560
so a new phone no apps

218
00:09:02,560 --> 00:09:05,279
34 calls to their server in three hours

219
00:09:05,279 --> 00:09:09,839
just idling to a chinese infrastructure

220
00:09:10,640 --> 00:09:12,800
remember the parameter data underscore

221
00:09:12,800 --> 00:09:14,320
list all right

222
00:09:14,320 --> 00:09:16,640
now we pull out jdx which is the de

223
00:09:16,640 --> 00:09:17,680
facto

224
00:09:17,680 --> 00:09:19,839
android compiler

225
00:09:19,839 --> 00:09:22,800
and we look for that parameter

226
00:09:22,800 --> 00:09:24,800
you can see it right there

227
00:09:24,800 --> 00:09:27,760
where it's being used inside the gun zip

228
00:09:27,760 --> 00:09:30,320
uh function a bit

229
00:09:30,320 --> 00:09:32,720
higher up

230
00:09:33,920 --> 00:09:34,959
right

231
00:09:34,959 --> 00:09:37,519
here

232
00:09:37,519 --> 00:09:39,760
now we can just do some

233
00:09:39,760 --> 00:09:42,399
manual stuff unfortunately i'm not that

234
00:09:42,399 --> 00:09:45,360
savvy to automate this kind of of

235
00:09:45,360 --> 00:09:47,200
research i just

236
00:09:47,200 --> 00:09:48,480
went by

237
00:09:48,480 --> 00:09:51,279
by hand from one request to another i

238
00:09:51,279 --> 00:09:52,720
discovered that it was going over the

239
00:09:52,720 --> 00:09:53,920
wire

240
00:09:53,920 --> 00:09:55,200
and then

241
00:09:55,200 --> 00:09:57,519
the data was being encoded

242
00:09:57,519 --> 00:10:01,680
in a good gzip output stream

243
00:10:01,839 --> 00:10:05,360
and then after unzipping it you would

244
00:10:05,360 --> 00:10:06,640
get

245
00:10:06,640 --> 00:10:09,440
this whole packet

246
00:10:09,440 --> 00:10:12,560
this whole json being sent to china

247
00:10:12,560 --> 00:10:16,000
which contained the visited url

248
00:10:16,000 --> 00:10:18,560
the network to which were connected

249
00:10:18,560 --> 00:10:20,720
the device info

250
00:10:20,720 --> 00:10:24,560
this was the android advertising id for

251
00:10:24,560 --> 00:10:26,880
whoever is familiar with that

252
00:10:26,880 --> 00:10:28,720
it can be reset

253
00:10:28,720 --> 00:10:30,800
unfortunately is the kind of data that

254
00:10:30,800 --> 00:10:34,079
every ad exchange has also access to so

255
00:10:34,079 --> 00:10:36,000
it can be very easily correlated back to

256
00:10:36,000 --> 00:10:38,640
you even though it's allegedly

257
00:10:38,640 --> 00:10:41,439
anonymized

258
00:10:42,240 --> 00:10:43,839
and a bit more

259
00:10:43,839 --> 00:10:44,839
it even

260
00:10:44,839 --> 00:10:47,279
contained whatever the user was in

261
00:10:47,279 --> 00:10:48,800
incognito mode

262
00:10:48,800 --> 00:10:52,000
so i guess do the data shifting a bit

263
00:10:52,000 --> 00:10:53,600
faster

264
00:10:53,600 --> 00:10:56,480
and the miui id which is right here

265
00:10:56,480 --> 00:10:59,519
now in order to get the miui id on

266
00:10:59,519 --> 00:11:01,600
xiaomi phone

267
00:11:01,600 --> 00:11:03,360
all xiaomi phones run what is called

268
00:11:03,360 --> 00:11:06,720
miui it's a spin-off of

269
00:11:06,720 --> 00:11:09,760
android that looks a bit more like an

270
00:11:09,760 --> 00:11:11,760
ios device

271
00:11:11,760 --> 00:11:14,560
anyway potato potato it's basically

272
00:11:14,560 --> 00:11:16,000
android

273
00:11:16,000 --> 00:11:17,279
chinese version

274
00:11:17,279 --> 00:11:20,000
and in order to get the miui id you have

275
00:11:20,000 --> 00:11:21,600
to register

276
00:11:21,600 --> 00:11:24,800
using your mobile phone number or your

277
00:11:24,800 --> 00:11:27,200
personal email address you can do it

278
00:11:27,200 --> 00:11:29,120
otherwise and they also have a block

279
00:11:29,120 --> 00:11:31,760
list for email addresses so you can use

280
00:11:31,760 --> 00:11:33,519
five minute email and stuff like that

281
00:11:33,519 --> 00:11:35,279
they really want to make sure that that

282
00:11:35,279 --> 00:11:39,959
is like your legitimate id

283
00:11:42,160 --> 00:11:44,480
it's populated inside the distinct id

284
00:11:44,480 --> 00:11:48,000
field and this even happens nowadays

285
00:11:48,000 --> 00:11:49,920
and it's being sent to something called

286
00:11:49,920 --> 00:11:52,639
sensor analytics we'll get into that a

287
00:11:52,639 --> 00:11:55,880
bit later

288
00:11:57,920 --> 00:11:59,440
up until now

289
00:11:59,440 --> 00:12:00,959
we learned that

290
00:12:00,959 --> 00:12:03,440
xiaomi sends all of the urls that you

291
00:12:03,440 --> 00:12:06,240
visit on the pre-installed browser

292
00:12:06,240 --> 00:12:08,839
your browsing history your search engine

293
00:12:08,839 --> 00:12:11,519
history your browsing behavior because

294
00:12:11,519 --> 00:12:14,079
it also sends touch events as well

295
00:12:14,079 --> 00:12:15,920
inside the website for

296
00:12:15,920 --> 00:12:18,959
god knows what reason

297
00:12:19,200 --> 00:12:21,760
and everything can be correlated

298
00:12:21,760 --> 00:12:23,040
with

299
00:12:23,040 --> 00:12:25,120
your

300
00:12:25,120 --> 00:12:27,519
real persona

301
00:12:27,519 --> 00:12:31,600
and it happens even in incognito mode

302
00:12:33,279 --> 00:12:36,839
now my miui phone had the news app

303
00:12:36,839 --> 00:12:39,600
and i just um

304
00:12:39,600 --> 00:12:42,959
clicked a piece of news right

305
00:12:43,440 --> 00:12:45,120
and of course

306
00:12:45,120 --> 00:12:46,800
it went to china

307
00:12:46,800 --> 00:12:49,279
and it said hey

308
00:12:49,279 --> 00:12:50,880
this guy is looking at this piece of

309
00:12:50,880 --> 00:12:53,839
news right now

310
00:12:54,160 --> 00:12:56,959
the my xiaomi phone had

311
00:12:56,959 --> 00:12:58,800
a music app

312
00:12:58,800 --> 00:13:00,639
and i was gonna listen to some music

313
00:13:00,639 --> 00:13:04,079
that i downloaded offline

314
00:13:04,320 --> 00:13:06,480
and of course it sent

315
00:13:06,480 --> 00:13:08,880
the name of the song

316
00:13:08,880 --> 00:13:11,519
to china

317
00:13:13,519 --> 00:13:16,240
and it didn't only happen on my phone

318
00:13:16,240 --> 00:13:18,560
turns out this is a

319
00:13:18,560 --> 00:13:20,800
feature

320
00:13:20,800 --> 00:13:24,639
pre-baked into all phones that run me ui

321
00:13:24,639 --> 00:13:26,800
so naturally i pulled

322
00:13:26,800 --> 00:13:28,320
and this is when the fun automation

323
00:13:28,320 --> 00:13:31,040
kicks in i pulled all of the binaries

324
00:13:31,040 --> 00:13:34,560
like the blobs the firmware blobs

325
00:13:34,560 --> 00:13:36,399
for all of their phones

326
00:13:36,399 --> 00:13:39,839
i used a broadly extractor

327
00:13:39,839 --> 00:13:42,880
then something called sdat to image

328
00:13:42,880 --> 00:13:46,880
written by a guy like really smart

329
00:13:46,880 --> 00:13:51,440
i pull the apks and the videxes

330
00:13:51,440 --> 00:13:55,279
and then run some static analysis over

331
00:13:55,279 --> 00:13:56,240
all of that

332
00:13:56,240 --> 00:13:59,519
and it was no surprise that all of them

333
00:13:59,519 --> 00:14:01,920
all of them contain the same code that i

334
00:14:01,920 --> 00:14:04,560
showed you before that was actually

335
00:14:04,560 --> 00:14:06,160
sending

336
00:14:06,160 --> 00:14:09,120
the data from my phone from the browser

337
00:14:09,120 --> 00:14:11,360
from the news app from the video player

338
00:14:11,360 --> 00:14:12,880
and the home screen as well i forgot to

339
00:14:12,880 --> 00:14:14,480
mention about that one the name of the

340
00:14:14,480 --> 00:14:15,839
folders that you make in your phone

341
00:14:15,839 --> 00:14:18,800
screen yeah they go to china as well

342
00:14:18,800 --> 00:14:22,079
there's no exception to that

343
00:14:22,240 --> 00:14:24,880
and it's being processed by a company

344
00:14:24,880 --> 00:14:27,040
called sensor analytics as i've

345
00:14:27,040 --> 00:14:29,279
mentioned before

346
00:14:29,279 --> 00:14:32,320
which basically

347
00:14:32,320 --> 00:14:34,160
have a bunch of

348
00:14:34,160 --> 00:14:36,399
chinese clients

349
00:14:36,399 --> 00:14:38,399
and no ties to the west

350
00:14:38,399 --> 00:14:40,000
and they removed this from their web

351
00:14:40,000 --> 00:14:41,680
page but at some point they were

352
00:14:41,680 --> 00:14:44,880
bragging that they can you can you can

353
00:14:44,880 --> 00:14:48,800
contact them for information about

354
00:14:48,800 --> 00:14:51,279
data on your website

355
00:14:51,279 --> 00:14:53,279
uh like user behavior data on your

356
00:14:53,279 --> 00:14:55,199
website even though you didn't embed

357
00:14:55,199 --> 00:14:56,639
their sensors

358
00:14:56,639 --> 00:14:59,279
and i wonder where they get got that

359
00:14:59,279 --> 00:15:00,240
data

360
00:15:00,240 --> 00:15:03,920
now the cfo for sensor analytics was in

361
00:15:03,920 --> 00:15:06,079
really close ties with xiaomi

362
00:15:06,079 --> 00:15:07,040
so

363
00:15:07,040 --> 00:15:10,079
like of the record

364
00:15:10,079 --> 00:15:13,040
somebody is really keen on siphoning uh

365
00:15:13,040 --> 00:15:15,040
browsing data

366
00:15:15,040 --> 00:15:18,399
but anyway enough xiaomi bashing

367
00:15:18,399 --> 00:15:19,440
um

368
00:15:19,440 --> 00:15:20,880
actually no let's not stop with the

369
00:15:20,880 --> 00:15:22,800
xiaomi basic bashing because i actually

370
00:15:22,800 --> 00:15:24,320
got something

371
00:15:24,320 --> 00:15:25,199
done

372
00:15:25,199 --> 00:15:27,600
and together with this fine gentleman

373
00:15:27,600 --> 00:15:30,399
right here we started doing

374
00:15:30,399 --> 00:15:33,759
raising awareness about that and

375
00:15:33,759 --> 00:15:36,800
what can i say doing uh

376
00:15:36,800 --> 00:15:40,880
constructive discussions on twitter

377
00:15:40,880 --> 00:15:42,240
with xiaomi

378
00:15:42,240 --> 00:15:44,480
we got forbes to

379
00:15:44,480 --> 00:15:47,839
to get notice of that

380
00:15:47,839 --> 00:15:50,480
and a lot of other publication including

381
00:15:50,480 --> 00:15:53,199
android ones

382
00:15:53,680 --> 00:15:56,240
and went through this whole scenario

383
00:15:56,240 --> 00:15:58,560
i mean they ignored me

384
00:15:58,560 --> 00:16:00,800
at first then they laughed at me they

385
00:16:00,800 --> 00:16:03,759
fought us but we won i mean this is one

386
00:16:03,759 --> 00:16:05,279
of the cases where the collective

387
00:16:05,279 --> 00:16:07,920
collective uh or quality let's call it

388
00:16:07,920 --> 00:16:10,160
the hacker cooperative managed to

389
00:16:10,160 --> 00:16:12,079
actually influence a big product and do

390
00:16:12,079 --> 00:16:14,320
something

391
00:16:14,320 --> 00:16:16,079
so

392
00:16:16,079 --> 00:16:18,160
xiaomi was disappointed to read that the

393
00:16:18,160 --> 00:16:20,959
recent article from forbes we feel that

394
00:16:20,959 --> 00:16:23,279
they have misunderstood what we

395
00:16:23,279 --> 00:16:24,720
communicated

396
00:16:24,720 --> 00:16:27,600
this was the lasting phase

397
00:16:27,600 --> 00:16:29,519
then they moved to fighting

398
00:16:29,519 --> 00:16:32,720
below are four certifications xiaomi

399
00:16:32,720 --> 00:16:34,320
received from widely acclaimed

400
00:16:34,320 --> 00:16:35,920
international third-party companies and

401
00:16:35,920 --> 00:16:38,160
organizations blah blah blah they

402
00:16:38,160 --> 00:16:41,440
started like throwing isos and all of

403
00:16:41,440 --> 00:16:43,680
the accreditations they had like hey

404
00:16:43,680 --> 00:16:45,440
guys these guys are talking

405
00:16:45,440 --> 00:16:46,880
it's not

406
00:16:46,880 --> 00:16:48,480
um

407
00:16:48,480 --> 00:16:51,040
then

408
00:16:51,040 --> 00:16:53,160
forbes might be

409
00:16:53,160 --> 00:16:56,160
misinterpretative of the facts

410
00:16:56,160 --> 00:16:57,199
i mean

411
00:16:57,199 --> 00:16:59,519
our users privacy and security are top

412
00:16:59,519 --> 00:17:01,440
priority they didn't encrypt the data i

413
00:17:01,440 --> 00:17:04,880
mean come on what's that at least you

414
00:17:04,880 --> 00:17:06,720
would like do it properly you know and

415
00:17:06,720 --> 00:17:08,400
we're gonna see how this is properly

416
00:17:08,400 --> 00:17:11,199
done like in the follow-up

417
00:17:11,199 --> 00:17:13,760
and in the end we would like to express

418
00:17:13,760 --> 00:17:15,520
our appreciation for researches

419
00:17:15,520 --> 00:17:17,599
engagement passionate and constructive

420
00:17:17,599 --> 00:17:19,359
criticism

421
00:17:19,359 --> 00:17:22,479
and we did it guys

422
00:17:25,839 --> 00:17:28,079
all of this

423
00:17:28,079 --> 00:17:31,079
for

424
00:17:32,400 --> 00:17:34,799
the enhanced incognito mode that you

425
00:17:34,799 --> 00:17:36,320
have to turn off

426
00:17:36,320 --> 00:17:38,720
if you want to stay private

427
00:17:38,720 --> 00:17:42,240
and it's turned on by default

428
00:17:43,280 --> 00:17:46,559
at least we put like a checkbox and uh

429
00:17:46,559 --> 00:17:48,480
they called it a day but the data is

430
00:17:48,480 --> 00:17:50,320
still and this is only for the browser

431
00:17:50,320 --> 00:17:52,160
the data is still being aggregated from

432
00:17:52,160 --> 00:17:54,559
your home screen from everywhere and it

433
00:17:54,559 --> 00:17:57,200
goes over the wire and everybody's like

434
00:17:57,200 --> 00:17:58,640
yeah let's get xiaomi phones because

435
00:17:58,640 --> 00:18:00,880
they're so cheap well if your privacy is

436
00:18:00,880 --> 00:18:02,720
that cheap then yeah go ahead and get

437
00:18:02,720 --> 00:18:04,960
one

438
00:18:05,360 --> 00:18:08,240
now i decided to do an experiment

439
00:18:08,240 --> 00:18:10,799
they build a lot of devices right

440
00:18:10,799 --> 00:18:12,559
let's get a band

441
00:18:12,559 --> 00:18:14,559
on a xiaomi phone pair it with the

442
00:18:14,559 --> 00:18:16,000
xiaomi phone

443
00:18:16,000 --> 00:18:20,080
with miui let's see what happens

444
00:18:22,480 --> 00:18:24,480
we've got like

445
00:18:24,480 --> 00:18:27,039
i i have less fingers than

446
00:18:27,039 --> 00:18:28,880
the number of requests a bunch of

447
00:18:28,880 --> 00:18:31,760
requests in four minutes

448
00:18:31,760 --> 00:18:32,960
uh

449
00:18:32,960 --> 00:18:35,440
a lot of them and it was going all the

450
00:18:35,440 --> 00:18:37,039
time all the time all the time in

451
00:18:37,039 --> 00:18:39,360
addition to draining my battery

452
00:18:39,360 --> 00:18:41,520
they're also sending this can you spot

453
00:18:41,520 --> 00:18:42,880
like

454
00:18:42,880 --> 00:18:44,720
what's wrong

455
00:18:44,720 --> 00:18:46,320
that's wrong

456
00:18:46,320 --> 00:18:48,400
all of the apps that i have installed

457
00:18:48,400 --> 00:18:51,520
are being sent by by smartband somewhere

458
00:18:51,520 --> 00:18:52,799
in china

459
00:18:52,799 --> 00:18:55,919
because reasons i guess they want to

460
00:18:55,919 --> 00:18:58,400
like optimize the notifications for me

461
00:18:58,400 --> 00:18:59,600
they could have

462
00:18:59,600 --> 00:19:01,760
hashed the name of the apps or something

463
00:19:01,760 --> 00:19:03,120
like but no

464
00:19:03,120 --> 00:19:04,559
it's okay they need to know that they

465
00:19:04,559 --> 00:19:06,240
have telegrams to leave whatsapp

466
00:19:06,240 --> 00:19:07,840
instagram and the

467
00:19:07,840 --> 00:19:10,840
wire

468
00:19:10,880 --> 00:19:13,039
now let's talk about somebody who did it

469
00:19:13,039 --> 00:19:14,799
like professionally

470
00:19:14,799 --> 00:19:16,320
and

471
00:19:16,320 --> 00:19:18,400
it was a lot harder i actually had to do

472
00:19:18,400 --> 00:19:21,039
like legit reverse engineering to to

473
00:19:21,039 --> 00:19:23,600
bypass them and this happens happened on

474
00:19:23,600 --> 00:19:25,120
both ios

475
00:19:25,120 --> 00:19:27,120
and still happens on android spoiler

476
00:19:27,120 --> 00:19:28,559
alert

477
00:19:28,559 --> 00:19:31,840
um this is alibaba's browser

478
00:19:31,840 --> 00:19:33,120
they have a

479
00:19:33,120 --> 00:19:35,360
tiny market alissa can brag is the first

480
00:19:35,360 --> 00:19:37,360
biggest browser in the world

481
00:19:37,360 --> 00:19:40,720
i guess but in asia where this data is

482
00:19:40,720 --> 00:19:43,760
not that aggregated they're big

483
00:19:43,760 --> 00:19:46,320
like it's alibaba they have a browser

484
00:19:46,320 --> 00:19:50,159
it's optimized for privacy

485
00:19:51,360 --> 00:19:54,719
powered by the cccp

486
00:19:55,120 --> 00:19:57,919
i'm gonna do another demo

487
00:19:57,919 --> 00:19:59,919
this is on the same ui phone

488
00:19:59,919 --> 00:20:01,679
quality stuff

489
00:20:01,679 --> 00:20:05,600
it's got alibaba browser installed

490
00:20:05,600 --> 00:20:07,760
it's in niconito mode

491
00:20:07,760 --> 00:20:13,240
i'm going on my website boom requests

492
00:20:24,720 --> 00:20:27,120
we just have to

493
00:20:27,120 --> 00:20:31,360
take the request spoiler alert say yes

494
00:20:31,360 --> 00:20:34,400
and you can see that they're sending

495
00:20:34,400 --> 00:20:35,200
the

496
00:20:35,200 --> 00:20:37,919
address that i just visited

497
00:20:37,919 --> 00:20:40,559
to china

498
00:20:41,600 --> 00:20:44,880
i like that they're consistent at least

499
00:20:44,880 --> 00:20:45,919
so

500
00:20:45,919 --> 00:20:47,760
this is also an ios

501
00:20:47,760 --> 00:20:52,080
you can see i'm in incognito mode

502
00:20:53,440 --> 00:20:55,600
and they send the data like straight

503
00:20:55,600 --> 00:20:57,919
from the get go

504
00:20:57,919 --> 00:21:02,120
who can recognize this header

505
00:21:02,799 --> 00:21:05,039
it's something something zip

506
00:21:05,039 --> 00:21:07,440
something

507
00:21:08,000 --> 00:21:10,480
you can zip it

508
00:21:10,480 --> 00:21:13,120
and you can see that

509
00:21:13,120 --> 00:21:17,360
they contained in plain text

510
00:21:17,360 --> 00:21:20,240
the unique url that i was visiting on my

511
00:21:20,240 --> 00:21:22,480
website

512
00:21:22,480 --> 00:21:24,559
on my own an ios device apple didn't

513
00:21:24,559 --> 00:21:27,919
like that needless to say they got

514
00:21:27,919 --> 00:21:31,679
they just went medieval on them

515
00:21:31,679 --> 00:21:34,240
it also sent at one point the mac

516
00:21:34,240 --> 00:21:36,880
address or it does send the mac address

517
00:21:36,880 --> 00:21:40,000
in some locations around the world

518
00:21:40,000 --> 00:21:41,520
the email

519
00:21:41,520 --> 00:21:43,360
it also sent the serial number of the of

520
00:21:43,360 --> 00:21:46,400
the ios device and a lot more metadata

521
00:21:46,400 --> 00:21:48,720
that unfortunately is kind of like

522
00:21:48,720 --> 00:21:52,559
common practice to send nowadays

523
00:21:52,559 --> 00:21:55,440
it's got like the cccp's eagle eye over

524
00:21:55,440 --> 00:21:57,520
here

525
00:21:57,520 --> 00:21:59,679
on android the situation was a bit more

526
00:21:59,679 --> 00:22:01,919
complicated because i was seeing a lot

527
00:22:01,919 --> 00:22:04,320
of garbage i couldn't recognize any kind

528
00:22:04,320 --> 00:22:07,280
of useful headers in the

529
00:22:07,280 --> 00:22:09,760
traffic analysis

530
00:22:09,760 --> 00:22:11,679
i just looked some

531
00:22:11,679 --> 00:22:13,200
funny facts about

532
00:22:13,200 --> 00:22:16,480
china's political party

533
00:22:17,120 --> 00:22:18,480
and yeah

534
00:22:18,480 --> 00:22:22,080
a lot of traffic going on

535
00:22:22,080 --> 00:22:23,840
now

536
00:22:23,840 --> 00:22:26,880
the domain was being sent unencrypted

537
00:22:26,880 --> 00:22:28,000
for

538
00:22:28,000 --> 00:22:30,000
statistics i guess at least they didn't

539
00:22:30,000 --> 00:22:31,840
send the url but they did send the

540
00:22:31,840 --> 00:22:35,120
domain that i was visiting

541
00:22:38,720 --> 00:22:41,120
in order to get the data from the aes

542
00:22:41,120 --> 00:22:42,480
encrypted stuff

543
00:22:42,480 --> 00:22:44,559
i had to at least

544
00:22:44,559 --> 00:22:46,640
identify if the data was being

545
00:22:46,640 --> 00:22:48,559
exfiltrated

546
00:22:48,559 --> 00:22:50,320
there's this really great

547
00:22:50,320 --> 00:22:53,520
tutorial on hooking with rida on android

548
00:22:53,520 --> 00:22:56,799
you need the rooted device and you

549
00:22:56,799 --> 00:22:58,960
spawn it's like a debugger basically but

550
00:22:58,960 --> 00:23:00,559
for people that don't know debugging

551
00:23:00,559 --> 00:23:02,000
like me

552
00:23:02,000 --> 00:23:03,679
and

553
00:23:03,679 --> 00:23:05,919
i got i intercepted

554
00:23:05,919 --> 00:23:08,960
the plain text before being sent to

555
00:23:08,960 --> 00:23:10,080
encryption

556
00:23:10,080 --> 00:23:12,159
right

557
00:23:12,159 --> 00:23:13,760
and it was

558
00:23:13,760 --> 00:23:16,080
the domain and the url

559
00:23:16,080 --> 00:23:19,679
and a lot more metadata like the android

560
00:23:19,679 --> 00:23:20,799
id

561
00:23:20,799 --> 00:23:23,280
the e from each two sent and all that

562
00:23:23,280 --> 00:23:25,520
stuff

563
00:23:25,520 --> 00:23:27,120
this is the

564
00:23:27,120 --> 00:23:31,039
hooking in action i could catch

565
00:23:31,039 --> 00:23:33,440
i also like through an exception

566
00:23:33,440 --> 00:23:35,679
where i would get an aes

567
00:23:35,679 --> 00:23:38,720
some as data being intercepted and i

568
00:23:38,720 --> 00:23:42,480
basically started going through

569
00:23:42,480 --> 00:23:45,919
these points in the source code after

570
00:23:45,919 --> 00:23:48,960
decompiling the app with

571
00:23:48,960 --> 00:23:50,559
jdx

572
00:23:50,559 --> 00:23:53,440
and needless to say i found

573
00:23:53,440 --> 00:23:55,760
a cipher being instantiated and the do

574
00:23:55,760 --> 00:23:57,919
final being called on it which does the

575
00:23:57,919 --> 00:24:01,120
actual encryption

576
00:24:01,760 --> 00:24:05,679
and i managed to isolate the aes key

577
00:24:05,679 --> 00:24:07,919
that was being used

578
00:24:07,919 --> 00:24:10,400
we won

579
00:24:10,559 --> 00:24:13,279
not yet not yet

580
00:24:13,279 --> 00:24:15,840
so i used that

581
00:24:15,840 --> 00:24:17,200
key

582
00:24:17,200 --> 00:24:20,000
i decrypted the data and i got like

583
00:24:20,000 --> 00:24:22,240
conclusive proof that what i was seeing

584
00:24:22,240 --> 00:24:24,159
being hooked before because i wanted to

585
00:24:24,159 --> 00:24:25,600
have proof that this was sent over the

586
00:24:25,600 --> 00:24:28,000
wire i didn't want like to get on the

587
00:24:28,000 --> 00:24:31,600
bad side of some nasty people

588
00:24:31,600 --> 00:24:34,159
for no reason i i want like conclusive

589
00:24:34,159 --> 00:24:36,320
proof

590
00:24:36,320 --> 00:24:38,000
and of course all of the data was being

591
00:24:38,000 --> 00:24:40,080
sent to china

592
00:24:40,080 --> 00:24:42,640
in some of their

593
00:24:42,640 --> 00:24:44,840
ips in the alibaba

594
00:24:44,840 --> 00:24:48,080
cloud now

595
00:24:48,080 --> 00:24:50,240
can you see what's missing

596
00:24:50,240 --> 00:24:52,960
over here after i started like

597
00:24:52,960 --> 00:24:54,640
doing the usual

598
00:24:54,640 --> 00:24:57,360
twitter storm

599
00:24:58,159 --> 00:25:00,400
there's no uc web browser

600
00:25:00,400 --> 00:25:02,480
at least for europe

601
00:25:02,480 --> 00:25:05,360
there's the apple got really mad

602
00:25:05,360 --> 00:25:08,000
pull the browser instantly right now you

603
00:25:08,000 --> 00:25:11,360
cannot install it on an ios device

604
00:25:11,360 --> 00:25:12,840
you know that apple

605
00:25:12,840 --> 00:25:15,520
also implemented the policy where you

606
00:25:15,520 --> 00:25:17,279
have to

607
00:25:17,279 --> 00:25:19,600
declare the permissions the data that

608
00:25:19,600 --> 00:25:20,880
your app is

609
00:25:20,880 --> 00:25:24,720
is sending to their to the servers

610
00:25:24,720 --> 00:25:27,679
they manage to circumvent that

611
00:25:27,679 --> 00:25:30,799
kind of like declaration verbosity by

612
00:25:30,799 --> 00:25:32,960
just not updating the app

613
00:25:32,960 --> 00:25:34,960
you don't update it you don't have to

614
00:25:34,960 --> 00:25:37,279
declare anything

615
00:25:37,279 --> 00:25:38,159
um

616
00:25:38,159 --> 00:25:39,440
yeah

617
00:25:39,440 --> 00:25:41,039
unfortunately on android they just

618
00:25:41,039 --> 00:25:43,279
didn't care

619
00:25:43,279 --> 00:25:45,279
google was like yeah man it's their app

620
00:25:45,279 --> 00:25:47,039
with their data they do whatever they

621
00:25:47,039 --> 00:25:47,919
want

622
00:25:47,919 --> 00:25:50,880
um uc will be still up on the android

623
00:25:50,880 --> 00:25:54,159
store i don't know maybe we need to do a

624
00:25:54,159 --> 00:25:56,559
bigger coordinated effort to

625
00:25:56,559 --> 00:25:58,480
stop them from doing

626
00:25:58,480 --> 00:26:01,279
that kind of stuff

627
00:26:01,279 --> 00:26:02,720
remember guys

628
00:26:02,720 --> 00:26:04,480
it is our duty

629
00:26:04,480 --> 00:26:05,679
to do

630
00:26:05,679 --> 00:26:07,039
the right

631
00:26:07,039 --> 00:26:10,000
thing

632
00:26:10,000 --> 00:26:12,240
i'm gabby and thank you for listening to

633
00:26:12,240 --> 00:26:12,590
me

634
00:26:12,590 --> 00:26:16,320
[Applause]

635
00:26:17,360 --> 00:26:19,600
and

636
00:26:22,080 --> 00:26:25,600
remember that rights are very easy

637
00:26:25,600 --> 00:26:28,320
to lose and very hard to obtain

638
00:26:28,320 --> 00:26:30,240
so for privacy

639
00:26:30,240 --> 00:26:32,000
this is a fairly like modern concept

640
00:26:32,000 --> 00:26:34,400
that we have we have to fight for it and

641
00:26:34,400 --> 00:26:36,400
fight all of the companies that are

642
00:26:36,400 --> 00:26:41,320
actually slurping our data thank you

643
00:26:46,630 --> 00:27:04,789
[Music]

644
00:27:07,360 --> 00:27:09,439
you

