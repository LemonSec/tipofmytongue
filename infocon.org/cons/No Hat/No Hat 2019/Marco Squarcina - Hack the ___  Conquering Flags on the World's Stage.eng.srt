1
00:00:15,550 --> 00:00:22,260
[Applause]

2
00:00:25,930 --> 00:00:31,250
this guy in italy us english calls

3
00:00:31,250 --> 00:00:40,870
my head 6 may saints i'm italian english

4
00:00:40,870 --> 00:00:43,860
in italy hi

5
00:00:43,860 --> 00:00:46,870
[Music]

6
00:00:46,870 --> 00:00:49,699
ok to the first part in italian first

7
00:00:49,699 --> 00:00:51,320
look that it is more at a high level and in

8
00:00:51,320 --> 00:00:55,760
italian the second in english i

9
00:00:55,760 --> 00:00:56,930
couldn't  speaking neither of the two

10
00:00:56,930 --> 00:00:59,270
languages anyway so oh well then in the

11
00:00:59,270 --> 00:01:02,000
meantime, nice to be here and it is also

12
00:01:02,000 --> 00:01:03,350
an excellent opportunity to speak after stefano

13
00:01:03,350 --> 00:01:05,780
zanero the memory a few years ago

14
00:01:05,780 --> 00:01:08,690
we were rome do you remember a meeting of

15
00:01:08,690 --> 00:01:11,149
the national laboratory serves security and

16
00:01:11,149 --> 00:01:12,830
I talked a little about the activities of

17
00:01:12,830 --> 00:01:14,180
hacking we did at ca foscari

18
00:01:14,180 --> 00:01:16,160
venice at the time i was from in

19
00:01:16,160 --> 00:01:19,310
venice i made an intervention after

20
00:01:19,310 --> 00:01:21,350
me stefano and stefano spoke showed

21
00:01:21,350 --> 00:01:24,500
the city of time ranking which is

22
00:01:24,500 --> 00:01:26,720
precisely a ranking that collects a

23
00:01:26,720 --> 00:01:28,790
bit the performances of the various teams of

24
00:01:28,790 --> 00:01:31,220
stf for the world to show that the

25
00:01:31,220 --> 00:01:32,390
milan team was above that of

26
00:01:32,390 --> 00:01:35,030
venice the following year i do sec

27
00:01:35,030 --> 00:01:36,650
the same thing happened but with

28
00:01:36,650 --> 00:01:38,420
reversed parts I spoke later about  he and I

29
00:01:38,420 --> 00:01:40,100
showed that steven hess was above the

30
00:01:40,100 --> 00:01:43,970
milan team but this fortunately

31
00:01:43,970 --> 00:01:45,110
I hope it will not happen again

32
00:01:45,110 --> 00:01:47,240
and we are no longer here to show ourselves to

33
00:01:47,240 --> 00:01:49,100
the cydia style ranking but we are

34
00:01:49,100 --> 00:01:50,720
talking about the phone for the second

35
00:01:50,720 --> 00:01:52,549
time in a row so in short this is

36
00:01:52,549 --> 00:01:54,710
a  in short, the success we achieved

37
00:01:54,710 --> 00:01:57,789
with the various waste

38
00:02:01,070 --> 00:02:03,409
go out publicly ingratiate

39
00:02:03,409 --> 00:02:04,729
stefano with the contribution he gave us

40
00:02:04,729 --> 00:02:05,360


41
00:02:05,360 --> 00:02:08,750
you know why you are given a hand I know

42
00:02:08,750 --> 00:02:11,480
in short it was really fundamental

43
00:02:11,480 --> 00:02:14,540
ok the title of the talk is a first

44
00:02:14,540 --> 00:02:21,500
quarter of the public and it is no  landslides also

45
00:02:21,500 --> 00:02:24,890
planet is a historical phase of the film is that

46
00:02:24,890 --> 00:02:27,830
they of 93

47
00:02:27,830 --> 00:02:35,150
this beginning is not a

48
00:02:35,150 --> 00:02:41,540
reference film enough it is worth however

49
00:02:41,540 --> 00:02:44,270
let's start who I am I took a

50
00:02:44,270 --> 00:02:48,190
quiz of a ca foscari venice and I am a

51
00:02:48,190 --> 00:02:51,500
security researcher in vienna and I deal

52
00:02:51,500 --> 00:02:52,840
with  web security

53
00:02:52,840 --> 00:02:56,420
i started participating sts in

54
00:02:56,420 --> 00:02:58,700
2009 and i am one of the founders of

55
00:02:58,700 --> 00:03:02,480
cookies and denis or even co founded the

56
00:03:02,480 --> 00:03:04,880
macaroni team and we went to the

57
00:03:04,880 --> 00:03:07,340
finals  of the def with las vegas for two

58
00:03:07,340 --> 00:03:08,120
years in a row

59
00:03:08,120 --> 00:03:10,760
we returned precisely in august of

60
00:03:10,760 --> 00:03:12,110
this year in august of

61
00:03:12,110 --> 00:03:15,700
last year's discard I also play with other

62
00:03:15,700 --> 00:03:19,130
vision teams in vienna the wii or one in another

63
00:03:19,130 --> 00:03:19,700


64
00:03:19,700 --> 00:03:21,860
team my students of my course of

65
00:03:21,860 --> 00:03:24,380
security and then I am precisely responsible

66
00:03:24,380 --> 00:03:27,380
for initiating abominations like the

67
00:03:27,380 --> 00:03:30,260
tower of books that you can imagine

68
00:03:30,260 --> 00:03:32,120
are a fusion between the table for us and

69
00:03:32,120 --> 00:03:33,860
with whom set denis that is the team of the

70
00:03:33,860 --> 00:03:35,959
polytechnic of milan and venice and

71
00:03:35,959 --> 00:03:38,120
this suffered a bit the precursor of

72
00:03:38,120 --> 00:03:40,790
what  macaroni then

73
00:03:40,790 --> 00:03:43,910
bacaro tour which instead is a team joint

74
00:03:43,910 --> 00:03:48,980
between padua venice but it would have been

75
00:03:48,980 --> 00:03:49,310
better

76
00:03:49,310 --> 00:03:53,840
ah ah dear tour and then macaroni too

77
00:03:53,840 --> 00:03:55,820
and instead the fusion between macaroni and

78
00:03:55,820 --> 00:03:58,390


79
00:04:00,500 --> 00:04:02,450
ionio was also among the

80
00:04:02,450 --> 00:04:04,190
national organizers of the cyber challenge

81
00:04:04,190 --> 00:04:05,870
punto project.  it of this extremely

82
00:04:05,870 --> 00:04:07,579
proud I think it is an

83
00:04:07,579 --> 00:04:09,880
extremely cool project

84
00:04:09,880 --> 00:04:11,770
for Italy we are the only ones in Europe

85
00:04:11,770 --> 00:04:13,960
who have a training project and I

86
00:04:13,960 --> 00:04:17,230
don't know about revaluation  in the IT security field

87
00:04:17,230 --> 00:04:20,860
and I was also coach of

88
00:04:20,860 --> 00:04:22,870
the Italian team for two years in a row then

89
00:04:22,870 --> 00:04:25,630
I moved to Austria he said maybe it

90
00:04:25,630 --> 00:04:28,240
is the case that I do not have to pay the

91
00:04:28,240 --> 00:04:31,360
salary from the state that

92
00:04:31,360 --> 00:04:33,010
with which I then go to play then  I

93
00:04:33,010 --> 00:04:34,750
said better if someone else does it

94
00:04:34,750 --> 00:04:35,470
towards the pil

95
00:04:35,470 --> 00:04:38,200
the coach of the italian team and mario

96
00:04:38,200 --> 00:04:41,890
folino of the politecnico di milano and I am

97
00:04:41,890 --> 00:04:45,520
also the one from how they say in

98
00:04:45,520 --> 00:04:49,480
Italian to blame the one to blame

99
00:04:49,480 --> 00:04:52,420
for the name maccheroni that came

100
00:04:52,420 --> 00:04:55,090
out in short a  night in an

101
00:04:55,090 --> 00:04:59,620
alcoholic night look good i guess you all

102
00:04:59,620 --> 00:05:01,540
know more or less what i am in ctf

103
00:05:01,540 --> 00:05:02,620
if you did not

104
00:05:02,620 --> 00:05:04,660
know you understood from the introduction that

105
00:05:04,660 --> 00:05:07,480
marco did however in short they are

106
00:05:07,480 --> 00:05:10,420
computer security games where the

107
00:05:10,420 --> 00:05:12,250
aim is to break some

108
00:05:12,250 --> 00:05:14,200
electric toy apps shawn

109
00:05:14,200 --> 00:05:16,960
and flag to flag are like

110
00:05:16,960 --> 00:05:20,260
this here is the headline and this is

111
00:05:20,260 --> 00:05:24,580
somehow proof that

112
00:05:24,580 --> 00:05:26,680
your exploitation has gone well since  and

113
00:05:26,680 --> 00:05:29,500
that you manage to extract this

114
00:05:29,500 --> 00:05:32,020
secret information from the system sent

115
00:05:32,020 --> 00:05:33,280
to the organizers this

116
00:05:33,280 --> 00:05:35,230
flag this string and

117
00:05:35,230 --> 00:05:37,000
points are made it works

118
00:05:37,000 --> 00:05:41,290
so that years ago the coaches did something

119
00:05:41,290 --> 00:05:44,440
innovative in the sense that especially in

120
00:05:44,440 --> 00:05:46,330
academic law there were few

121
00:05:46,330 --> 00:05:49,860
universities that  they did ctf for

122
00:05:49,860 --> 00:05:51,490
within their university courses

123
00:05:51,490 --> 00:05:52,260


124
00:05:52,260 --> 00:05:54,760
so i said since last november i

125
00:05:54,760 --> 00:05:56,410
went to university to

126
00:05:56,410 --> 00:05:58,810
the vienna team i said well i have

127
00:05:58,810 --> 00:06:00,490
some experience in organizing and

128
00:06:00,490 --> 00:06:03,760
participating in ctf competitions i will have

129
00:06:03,760 --> 00:06:05,800
my own course i do in my

130
00:06:05,800 --> 00:06:07,840
psychiatrist course  that I discovered that there were

131
00:06:07,840 --> 00:06:10,270
already two other groups in vienna

132
00:06:10,270 --> 00:06:12,760
who were organizing city f as university courses

133
00:06:12,760 --> 00:06:14,830


134
00:06:14,830 --> 00:06:16,210
and therefore precisely it is not that it was

135
00:06:16,210 --> 00:06:17,980
just who knows how innovative

136
00:06:17,980 --> 00:06:21,280
the idea is that now stf are

137
00:06:21,280 --> 00:06:23,830
widely used they are not academy but

138
00:06:23,830 --> 00:06:26,580
only one  what quite do you want fred

139
00:06:26,580 --> 00:06:28,840
so anyway we still won

140
00:06:28,840 --> 00:06:32,640
an etf had them 300  students 1600

141
00:06:32,640 --> 00:06:35,080
flags recovered then 1600

142
00:06:35,080 --> 00:06:39,070
expolit and schmidt single and the

143
00:06:39,070 --> 00:06:40,480
platform is the same that we

144
00:06:40,480 --> 00:06:42,760
used for the cyber challenge and to

145
00:06:42,760 --> 00:06:44,650
organize other af open source sites and

146
00:06:44,650 --> 00:06:46,360
you can take a look if you are interested

147
00:06:46,360 --> 00:06:48,220
there is not only if t et di

148
00:06:48,220 --> 00:06:52,450
introduce tf but look for this here in a

149
00:06:52,450 --> 00:06:54,940
short recap for those who do not know about

150
00:06:54,940 --> 00:06:57,090
what are the various types of

151
00:06:57,090 --> 00:06:58,510
competition

152
00:06:58,510 --> 00:07:01,240
know sky party simple as

153
00:07:01,240 --> 00:07:03,430
as a structure there are a set of

154
00:07:03,430 --> 00:07:05,710
problems of various categories type

155
00:07:05,710 --> 00:07:09,040
wrote ponsard former ordinary politicians

156
00:07:09,040 --> 00:07:13,290
mainly reversing web security

157
00:07:13,690 --> 00:07:16,930
every time one manages to solve a

158
00:07:16,930 --> 00:07:19,330
problem of these categories,

159
00:07:19,330 --> 00:07:21,610
points are assigned which

160
00:07:21,610 --> 00:07:24,220
generally depend on how difficult it is to be able to

161
00:07:24,220 --> 00:07:26,350
expolit areas that challenge and whoever

162
00:07:26,350 --> 00:07:29,740
scores more points says simple then there are the coaches

163
00:07:29,740 --> 00:07:32,260
who did that in defense which instead are

164
00:07:32,260 --> 00:07:35,350
more ahead they like to say that they are

165
00:07:35,350 --> 00:07:36,760
almost another sport

166
00:07:36,760 --> 00:07:38,470
if your spouse and require a lot more

167
00:07:38,470 --> 00:07:40,330
tooling than many organizations  much more

168
00:07:40,330 --> 00:07:43,240
teamwork and they work mainly in

169
00:07:43,240 --> 00:07:45,100
this way there are various teams that

170
00:07:45,100 --> 00:07:46,540
compete against each

171
00:07:46,540 --> 00:07:49,930
other and each team is one that can be

172
00:07:49,930 --> 00:07:51,790
virtual or can be physical with

173
00:07:51,790 --> 00:07:55,450
services these services are

174
00:07:55,450 --> 00:07:57,940
ok custom applications written to the organizers and

175
00:07:57,940 --> 00:07:59,500
these oysters do not  in front of various times they

176
00:07:59,500 --> 00:08:00,430
are identical

177
00:08:00,430 --> 00:08:03,070
so each team has a car that is the

178
00:08:03,070 --> 00:08:05,410
same as all the other machines purpose

179
00:08:05,410 --> 00:08:07,960
of the game is basically to fix the

180
00:08:07,960 --> 00:08:10,150
safety problems that are present

181
00:08:10,150 --> 00:08:13,030
in their services and at the same time

182
00:08:13,030 --> 00:08:14,860
attack all the services of all the

183
00:08:14,860 --> 00:08:15,490
other teams

184
00:08:15,490 --> 00:08:17,230
the organizers  what do the organizers do they

185
00:08:17,230 --> 00:08:19,110
periodically send

186
00:08:19,110 --> 00:08:22,480
flags to all the services of

187
00:08:22,480 --> 00:08:23,110
all the teams

188
00:08:23,110 --> 00:08:26,750
ok so it is precisely to a

189
00:08:26,750 --> 00:08:28,820
certain team the flags and collect the

190
00:08:28,820 --> 00:08:30,680
flags of the others also the

191
00:08:30,680 --> 00:08:32,479
organizers also check that the

192
00:08:32,479 --> 00:08:34,549
services are working in the

193
00:08:34,549 --> 00:08:37,099
correct way and therefore precisely that a  team

194
00:08:37,099 --> 00:08:39,469
non-fiction service removing

195
00:08:39,469 --> 00:08:41,599
functionality for example would be fac  ile

196
00:08:41,599 --> 00:08:42,830
serves as unplugging the

197
00:08:42,830 --> 00:08:44,179
computer at that point the computer is

198
00:08:44,179 --> 00:08:47,120
safe this clearly is not

199
00:08:47,120 --> 00:08:52,220
possible to do it the most famous stf

200
00:08:52,220 --> 00:08:54,410
as regards precisely the stf attacks

201
00:08:54,410 --> 00:08:56,860
de france is probably the russi tears

202
00:08:56,860 --> 00:08:58,760
organized in russia now more than

203
00:08:58,760 --> 00:09:00,760
ten years old  this competition

204
00:09:00,760 --> 00:09:03,410
the last edition was won after

205
00:09:03,410 --> 00:09:06,710
years of uninterrupted russian domination it

206
00:09:06,710 --> 00:09:08,240
was won by the team of the polytechnic of

207
00:09:08,240 --> 00:09:09,140
milan

208
00:09:09,140 --> 00:09:12,590
and instead the joint in venice padua was

209
00:09:12,590 --> 00:09:14,900
ranked in fourth position so they

210
00:09:14,900 --> 00:09:21,760
are good good at them

211
00:09:23,490 --> 00:09:27,970
ok this was then conditioned by the

212
00:09:27,970 --> 00:09:29,920
variations on the theme for sense the theme I

213
00:09:29,920 --> 00:09:32,920
'm like instead of networking them in the

214
00:09:32,920 --> 00:09:33,519
territories

215
00:09:33,519 --> 00:09:35,560
let's do it in others of six so we don't

216
00:09:35,560 --> 00:09:37,449
give all the tools that the teams have

217
00:09:37,449 --> 00:09:40,360
written over the years I said okay

218
00:09:40,360 --> 00:09:41,889
since it will be a total failure

219
00:09:41,889 --> 00:09:43,569
since all our  tour will

220
00:09:43,569 --> 00:09:45,519
break try to play this

221
00:09:45,519 --> 00:09:47,379
competition with the guys my

222
00:09:47,379 --> 00:09:51,819
security course not collected a bit 6 set

223
00:09:51,819 --> 00:09:53,199
we did just that he participates  from

224
00:09:53,199 --> 00:09:54,699
these competitions we had a good

225
00:09:54,699 --> 00:09:56,709
day to prepare and these poor

226
00:09:56,709 --> 00:09:58,480
guys I had never done seven years

227
00:09:58,480 --> 00:10:01,149
in my life they have readjusted existing tools

228
00:10:01,149 --> 00:10:02,680
they wrote some

229
00:10:02,680 --> 00:10:04,509
valuable stuff in the end in short, with a bit of

230
00:10:04,509 --> 00:10:05,949
organization

231
00:10:05,949 --> 00:10:07,779
we still managed to arrive tenths

232
00:10:07,779 --> 00:10:11,050
this  it was the news and we also

233
00:10:11,050 --> 00:10:13,470
managed to conquer three first blood

234
00:10:13,470 --> 00:10:15,699
means that we were the first at

235
00:10:15,699 --> 00:10:18,339
equitalia three different services

236
00:10:18,339 --> 00:10:19,810
later if you are interested offline I tell me

237
00:10:19,810 --> 00:10:23,889
how because it's funny it went like this

238
00:10:23,889 --> 00:10:27,129
in short even if you start recently

239
00:10:27,129 --> 00:10:29,559
on the sites al fatah that  in the sense that with

240
00:10:29,559 --> 00:10:31,149
a good organization but also in a

241
00:10:31,149 --> 00:10:35,589
day someone who tells you what to do and

242
00:10:35,589 --> 00:10:37,629
when to do it you can get

243
00:10:37,629 --> 00:10:39,370
results that in short are quite

244
00:10:39,370 --> 00:10:42,759
satisfactory then in

245
00:10:42,759 --> 00:10:46,170
hybrid competitions where the rules are decided

246
00:10:46,170 --> 00:10:50,110
custom for that competition is the

247
00:10:50,110 --> 00:10:51,370
most competition  famous above all in

248
00:10:51,370 --> 00:10:52,660
the academic field and not half as large as

249
00:10:52,660 --> 00:10:54,759
if it is also the oldest

250
00:10:54,759 --> 00:10:59,819
more historically relevant is the stf

251
00:10:59,819 --> 00:11:01,720
prestiti he attended by him seeing

252
00:11:01,720 --> 00:11:04,389
santa barbara and and by giovanni via

253
00:11:04,389 --> 00:11:05,920
precisely an italian professor one of the

254
00:11:05,920 --> 00:11:07,600
greatest exponents in short in the

255
00:11:07,600 --> 00:11:09,939
academic field and not in the

256
00:11:09,939 --> 00:11:14,800
world cybersecurity panorama this year I

257
00:11:14,800 --> 00:11:16,059
played with the ionio

258
00:11:16,059 --> 00:11:19,930
seems to be second not bad  ass a thing

259
00:11:19,930 --> 00:11:21,610
was the following

260
00:11:21,610 --> 00:11:24,670
it was not possible to protect the

261
00:11:24,670 --> 00:11:26,079
services by doing a sort of man in the

262
00:11:26,079 --> 00:11:28,269
middle of their own of their

263
00:11:28,269 --> 00:11:30,339
own challenges because the services were

264
00:11:30,339 --> 00:11:32,320
all hosted on a virtual machine that

265
00:11:32,320 --> 00:11:34,120
was not directly accessible to us

266
00:11:34,120 --> 00:11:36,370
ok so we couldn't just  interact

267
00:11:36,370 --> 00:11:38,230
with services but we did not have a

268
00:11:38,230 --> 00:11:42,310
root shell on the machine there were

269
00:11:42,310 --> 00:11:44,970
also challenges and not only services

270
00:11:44,970 --> 00:11:47,760
but the cells simply inserted to

271
00:11:47,760 --> 00:11:51,010
enable easier endpoints to

272
00:11:51,010 --> 00:11:54,339
export than the services as

273
00:11:54,339 --> 00:11:58,630
they were assigned to us and it was still

274
00:11:58,630 --> 00:12:00,790
possible to analyze  network traffic and

275
00:12:00,790 --> 00:12:02,769
therefore potentially stealing

276
00:12:02,769 --> 00:12:05,350
the expo and others  team going to

277
00:12:05,350 --> 00:12:07,779
study network traffic and find

278
00:12:07,779 --> 00:12:09,399
out what others test doing

279
00:12:09,399 --> 00:12:12,820
against us fans and stings there weren't some

280
00:12:12,820 --> 00:12:16,570
attack points were awarded

281
00:12:16,570 --> 00:12:18,630
only based on the number of services that were

282
00:12:18,630 --> 00:12:21,160
functioning correctly and that

283
00:12:21,160 --> 00:12:23,339
were not his data from  other team has been

284
00:12:23,339 --> 00:12:26,410
sympathetically rebranding as if tf

285
00:12:26,410 --> 00:12:28,720
defense difference and this is

286
00:12:28,720 --> 00:12:32,290
why we are talking about gas with data with

287
00:12:32,290 --> 00:12:35,019
more or less a city is made who thinks about it

288
00:12:35,019 --> 00:12:39,940
but with variations it is longer

289
00:12:39,940 --> 00:12:42,070
than you do not normal tf stf who

290
00:12:42,070 --> 00:12:43,990
thinks about it 2  at 8 to 10 hours

291
00:12:43,990 --> 00:12:46,600
this usually lasts three days and above all two

292
00:12:46,600 --> 00:12:50,199
sleepless nights basically there were

293
00:12:50,199 --> 00:12:52,750
seven services that are extremely

294
00:12:52,750 --> 00:12:55,120
complex are much more complex than the

295
00:12:55,120 --> 00:12:57,279
services you will find in a CD that lasts

296
00:12:57,279 --> 00:12:59,860
10 hours precisely because the time is much

297
00:12:59,860 --> 00:13:01,870
longer and  it was a

298
00:13:01,870 --> 00:13:05,680
standard competition and it works more in a

299
00:13:05,680 --> 00:13:07,630
similar way to what was the ctf i

300
00:13:07,630 --> 00:13:09,699
showed before so there is

301
00:13:09,699 --> 00:13:13,209
no access to the dm directly there were the

302
00:13:13,209 --> 00:13:15,279
pic  k up so it was possible to analyze

303
00:13:15,279 --> 00:13:17,079
the traffic but the pips the pick up

304
00:13:17,079 --> 00:13:19,300
were released very very late for the

305
00:13:19,300 --> 00:13:22,360
services so they were not very useful in

306
00:13:22,360 --> 00:13:26,920
terms of scoring there were notes in

307
00:13:26,920 --> 00:13:29,140
attack points in defense and there were no

308
00:13:29,140 --> 00:13:32,350
points in sls  she means

309
00:13:32,350 --> 00:13:35,050
means if she had tears it

310
00:13:35,050 --> 00:13:37,870
means that the service is working and that

311
00:13:37,870 --> 00:13:39,970
it is not a feature that have been

312
00:13:39,970 --> 00:13:43,000
removed so it works and means it is not

313
00:13:43,000 --> 00:13:45,910
corrupted ram correctly etc

314
00:13:45,910 --> 00:13:48,580
etc there was no this entry because

315
00:13:48,580 --> 00:13:50,560
the axis she was controlled by the

316
00:13:50,560 --> 00:13:52,480
organizers in  pressing phase

317
00:13:52,480 --> 00:13:55,540
so we lived in a patch we were

318
00:13:55,540 --> 00:13:56,890
limits on the flaws we can

319
00:13:56,890 --> 00:14:00,010
only change 10 bytes 12 bytes one hundred

320
00:14:00,010 --> 00:14:02,829
bytes so it was still difficult to

321
00:14:02,829 --> 00:14:06,519
change the way the theme

322
00:14:06,519 --> 00:14:09,279
of the service falls by interacting on

323
00:14:09,279 --> 00:14:11,200
this limited number of bytes on

324
00:14:11,200 --> 00:14:13,110
its track

325
00:14:13,110 --> 00:14:16,779
and  then there were three challenge king of the

326
00:14:16,779 --> 00:14:18,700
field these were also introduced

327
00:14:18,700 --> 00:14:20,440
last year the format of the competition

328
00:14:20,440 --> 00:14:21,640
so this year is the same qu  ello

329
00:14:21,640 --> 00:14:24,700
last year and it means that only the

330
00:14:24,700 --> 00:14:26,880
first five teams score points

331
00:14:26,880 --> 00:14:31,029
depending on their position

332
00:14:31,029 --> 00:14:33,490
in the temporary ranking at each at

333
00:14:33,490 --> 00:14:35,040
each tech

334
00:14:35,040 --> 00:14:37,810
this is the overall score so

335
00:14:37,810 --> 00:14:40,300
you see 40 percent defenses 40 percent

336
00:14:40,300 --> 00:14:42,670
attack and 20 percent kingdom

337
00:14:42,670 --> 00:14:44,800
this is  one example says lance kindle

338
00:14:44,800 --> 00:14:49,390
kindle and this is extremely cool

339
00:14:49,390 --> 00:14:50,770
in my opinion for those with no experience with

340
00:14:50,770 --> 00:14:52,630
this world because you can

341
00:14:52,630 --> 00:14:55,660
visually see what is going on

342
00:14:55,660 --> 00:14:57,520
i.e this was controlling a spaceship

343
00:14:57,520 --> 00:15:00,310
doing a rock chain ok then

344
00:15:00,310 --> 00:15:03,730
dynamically saying a rock chain taking the

345
00:15:03,730 --> 00:15:08,740
gadget from a 500 megabyte blob of

346
00:15:08,740 --> 00:15:10,510
random age

347
00:15:10,510 --> 00:15:12,490
and this roxanne had to control the

348
00:15:12,490 --> 00:15:14,800
movements of the spaceship also the

349
00:15:14,800 --> 00:15:17,200
strategy to hit the other ships from

350
00:15:17,200 --> 00:15:18,790
three spaceships you can

351
00:15:18,790 --> 00:15:20,170
actually see that there is a war

352
00:15:20,170 --> 00:15:22,300
going on here are the various  teams that are

353
00:15:22,300 --> 00:15:24,430
shooting at each other eliminating each other and

354
00:15:24,430 --> 00:15:27,089
then only we are left we are this here

355
00:15:27,089 --> 00:15:30,579
we have a strategy in this in

356
00:15:30,579 --> 00:15:33,370
this moment  or that plans to stand

357
00:15:33,370 --> 00:15:35,470
still and shoot a bit at random and then

358
00:15:35,470 --> 00:15:36,570
we

359
00:15:36,570 --> 00:15:40,800
start circling around the perimeter and

360
00:15:40,800 --> 00:15:43,590
we look for we killed one and then

361
00:15:43,590 --> 00:15:45,750
we try to take the other

362
00:15:45,750 --> 00:15:48,860
other teams and hit them like this

363
00:15:48,860 --> 00:15:51,510
this is a video it should work

364
00:15:51,510 --> 00:15:54,960
let's see this  year the organizers of the

365
00:15:54,960 --> 00:15:57,540
desco antonio bianchi who explain between

366
00:15:57,540 --> 00:16:00,589
staff how the game works

367
00:16:04,130 --> 00:16:07,970
the weather today while keeping the rest

368
00:16:07,970 --> 00:16:10,040
[Music]

369
00:16:10,040 --> 00:16:13,550
incredible strategic study

370
00:16:13,970 --> 00:16:15,059


371
00:16:15,059 --> 00:16:18,030
is recovered

372
00:16:18,030 --> 00:16:20,290
[Music]

373
00:16:20,290 --> 00:16:21,660


374
00:16:21,660 --> 00:16:24,889
righetto remains fragile bayern m who makes

375
00:16:24,889 --> 00:16:27,459
passions wings

376
00:16:29,490 --> 00:16:48,420
and venice alps and director  and the

377
00:16:50,730 --> 00:16:57,850
members in arena macaroni in vena and

378
00:16:57,850 --> 00:17:06,400
otium clones or then the Italian worker

379
00:17:06,400 --> 00:17:07,589


380
00:17:07,589 --> 00:17:09,490
we promised that we will not remake

381
00:17:09,490 --> 00:17:14,260
the two languages in Switzerland so there are

382
00:17:14,260 --> 00:17:16,030
many macaroni in the suite and a few

383
00:17:16,030 --> 00:17:18,670
macaroni in the arena these computers

384
00:17:18,670 --> 00:17:21,459
you see here are actually the

385
00:17:21,459 --> 00:17:23,550
computers we had and they were

386
00:17:23,550 --> 00:17:25,119
only essential to run

387
00:17:25,119 --> 00:17:27,220
the infrastructure so they weren't

388
00:17:27,220 --> 00:17:29,410
necessarily complete by the players they

389
00:17:29,410 --> 00:17:32,820
were just c  omputer for the infrastructure

390
00:17:32,820 --> 00:17:36,130
you see that the arena and the suite were

391
00:17:36,130 --> 00:17:38,530
connected since novi pm and through the same

392
00:17:38,530 --> 00:17:40,360
bpm it is possible to go on the internet had

393
00:17:40,360 --> 00:17:42,940
many of the services on the cloud

394
00:17:42,940 --> 00:17:45,750
then just the arena was connected to

395
00:17:45,750 --> 00:17:47,290
the infrastructure of the organizers

396
00:17:47,290 --> 00:17:49,720
this here  in red with the check system

397
00:17:49,720 --> 00:17:52,180
and the organizers is also the suite

398
00:17:52,180 --> 00:17:54,820
could access the levone box and through

399
00:17:54,820 --> 00:17:55,390
the vpn

400
00:17:55,390 --> 00:17:59,680
ok this tour here basically I

401
00:17:59,680 --> 00:18:02,620
brought back almost all of

402
00:18:02,620 --> 00:18:05,950
our services that we had between suite and

403
00:18:05,950 --> 00:18:06,820


404
00:18:06,820 --> 00:18:09,670
arena just to give you a '  idea we had like in the

405
00:18:09,670 --> 00:18:15,490
arena the program that managed the tucker

406
00:18:15,490 --> 00:18:20,950
so in fact the execution of expoit

407
00:18:20,950 --> 00:18:23,050
in parallel on all the various

408
00:18:23,050 --> 00:18:27,580
teams and also summit arele flag all ex

409
00:18:27,580 --> 00:18:29,620
remain the organizers but we

410
00:18:29,620 --> 00:18:32,560
also had a backup a backup solutions to

411
00:18:32,560 --> 00:18:34,690
attack the summit

412
00:18:34,690 --> 00:18:38,250
we had the system of  traffic analysis

413
00:18:38,250 --> 00:18:41,050
but we had a total of three

414
00:18:41,050 --> 00:18:43,540
traffic analysis systems another is this one here

415
00:18:43,540 --> 00:18:45,310
again in the arena is another and I leave

416
00:18:45,310 --> 00:18:48,910
the database replica here in the cloud

417
00:18:48,910 --> 00:18:51,790
you had an idea and the darling servers

418
00:18:51,790 --> 00:18:54,520
that are used to do towards

419
00:18:54,520 --> 00:18:57,910
shared engineering mater show however

420
00:18:57,910 --> 00:19:00,850
communication is file for the exchange of

421
00:19:00,850 --> 00:19:04,330
files etherpad to exchange

422
00:19:04,330 --> 00:19:10,120
notes quickly mirrors of the

423
00:19:10,120 --> 00:19:12,100
packages of the various distributions so in

424
00:19:12,100 --> 00:19:13,540
fact it saves time compared to

425
00:19:13,540 --> 00:19:15,580
doing face from  internet etcetera

426
00:19:15,580 --> 00:19:16,450
etcetera etcetera

427
00:19:16,450 --> 00:19:18,760
as you can see that the setup is not it

428
00:19:18,760 --> 00:19:21,160
was not trivial how it turned out

429
00:19:21,160 --> 00:19:23,560
is a cup ex born so on 16 teams

430
00:19:23,560 --> 00:19:26,020
and we were the first European team

431
00:19:26,020 --> 00:19:31,080
so satisfied

432
00:19:36,160 --> 00:19:41,770
I hold on we still make Italian

433
00:19:41,770 --> 00:19:44,480
then the title of this section  è

434
00:19:44,480 --> 00:19:46,460
vivo asks totò and application paolo

435
00:19:46,460 --> 00:19:48,260
detail first but I will show you that

436
00:19:48,260 --> 00:19:52,220
in the modern ctf it is a bit let's say that the

437
00:19:52,220 --> 00:19:54,680
difficulties have risen the targets

438
00:19:54,680 --> 00:19:58,640
have become more difficult and I bring you

439
00:19:58,640 --> 00:20:00,440
a few examples that concern precisely

440
00:20:00,440 --> 00:20:02,990
with a non-skill  known before and also

441
00:20:02,990 --> 00:20:05,930
entire classes of attack or other

442
00:20:05,930 --> 00:20:07,460
attack methodologies that

443
00:20:07,460 --> 00:20:10,510
were not that previously

444
00:20:12,050 --> 00:20:15,350
ok then this  ta is a challenge of 35

445
00:20:15,350 --> 00:20:18,170
c 3 stf that we won as macaroni

446
00:20:18,170 --> 00:20:22,040
together with the chigi yes this is an

447
00:20:22,040 --> 00:20:26,300
expression engine is an open source cms

448
00:20:26,300 --> 00:20:29,570
that used even less according to the

449
00:20:29,570 --> 00:20:31,130
description of the challenge that

450
00:20:31,130 --> 00:20:33,290
this one was also by donald trump I

451
00:20:33,290 --> 00:20:35,720
don't know if  changed it and also from other

452
00:20:35,720 --> 00:20:38,090
organizations such as nike etc.

453
00:20:38,090 --> 00:20:38,960
etc.

454
00:20:38,960 --> 00:20:40,370
so something I also used in the

455
00:20:40,370 --> 00:20:45,380
enterprise field to be clear they were found

456
00:20:45,380 --> 00:20:49,370
during the competition 30 days is one

457
00:20:49,370 --> 00:20:51,350
of the zero days was the solution

458
00:20:51,350 --> 00:20:53,540
therefore probably means whoever developed

459
00:20:53,540 --> 00:20:54,590
the challenge

460
00:20:54,590 --> 00:20:56,120
or rather who has  released this

461
00:20:56,120 --> 00:20:59,540
challenge he knew about the security action

462
00:20:59,540 --> 00:21:04,390
on the north erbai at a certain point of the

463
00:21:04,390 --> 00:21:07,280
concert in point of the pipes

464
00:21:07,280 --> 00:21:08,620
but who then did the analysis

465
00:21:08,620 --> 00:21:10,700
after the conclusion of the

466
00:21:10,700 --> 00:21:14,060
city and I discovered at 32 with a skill

467
00:21:14,060 --> 00:21:19,310
and remote code execution they don't have many

468
00:21:19,310 --> 00:21:21,320
asks  so first I would like to do so many

469
00:21:21,320 --> 00:21:23,570
cations have come out to have remote code

470
00:21:23,570 --> 00:21:26,780
execution which one is also very funny

471
00:21:26,780 --> 00:21:30,080
through the m values  odifier of the prec match

472
00:21:30,080 --> 00:21:31,370
and prec

473
00:21:31,370 --> 00:21:36,560
what ever functions.php so yes this

474
00:21:36,560 --> 00:21:38,240
was not an application like you see

475
00:21:38,240 --> 00:21:43,310
this was a real cms also used in

476
00:21:43,310 --> 00:21:45,680
the enterprise environment that

477
00:21:45,680 --> 00:21:47,120
deliberately presented zero day

478
00:21:47,120 --> 00:21:49,130
the true gods were used to solve the

479
00:21:49,130 --> 00:21:51,980
challenge they were just part

480
00:21:51,980 --> 00:21:55,790
of the  solution three days after the city

481
00:21:55,790 --> 00:21:57,950
f in fact the next version was released

482
00:21:57,950 --> 00:22:01,940
that fixes a vulnerable potential and

483
00:22:01,940 --> 00:22:03,980
scajola injection and a

484
00:22:03,980 --> 00:22:05,690
potential for many codest fiction

485
00:22:05,690 --> 00:22:10,340
vulnerabilities in psp file

486
00:22:10,340 --> 00:22:12,440
funny thing that was not the only zero day

487
00:22:12,440 --> 00:22:15,830
intended present in this set if but

488
00:22:15,830 --> 00:22:17,660
there were four others there were a

489
00:22:17,660 --> 00:22:20,990
total of 50 of the necessary to solve

490
00:22:20,990 --> 00:22:23,870
in an intended Lecce way proposals

491
00:22:23,870 --> 00:22:29,840
during this if tf who knows the

492
00:22:29,840 --> 00:22:32,240
quaver xs Saudi you are the hand if you

493
00:22:32,240 --> 00:22:36,679
know it not so

494
00:22:36,679 --> 00:22:39,710
well then what is romics and sau di  tor

495
00:22:39,710 --> 00:22:43,429
is a mitigation present in chrome that is

496
00:22:43,429 --> 00:22:47,390
used to somehow reduce the

497
00:22:47,390 --> 00:22:51,200
attack surface of the ex ss of the

498
00:22:51,200 --> 00:22:53,630
reflected type therefore functions  ona like this

499
00:22:53,630 --> 00:22:58,520
here if you have a program that

500
00:22:58,520 --> 00:22:59,780
simply prints what you pass to it

501
00:22:59,780 --> 00:23:01,970
as gaspare mita on the page without

502
00:23:01,970 --> 00:23:05,809
doing any kind of scaling you have nexus

503
00:23:05,809 --> 00:23:10,910
s ok and then you put script on the one xs and

504
00:23:10,910 --> 00:23:13,520
the page also gets addressed by the

505
00:23:13,520 --> 00:23:17,030
server you wrote alert xss  this

506
00:23:17,030 --> 00:23:18,170
has already been written that it is followed

507
00:23:18,170 --> 00:23:20,240
you have a start if you can compromise

508
00:23:20,240 --> 00:23:22,910
the session of the user who is

509
00:23:22,910 --> 00:23:23,390
logged in

510
00:23:23,390 --> 00:23:27,260
ok what the auditor romics does the

511
00:23:27,260 --> 00:23:30,410
saudi chronic looks for malicious payloads

512
00:23:30,410 --> 00:23:33,740
in the 2 ml ok and if these malicious periods

513
00:23:33,740 --> 00:23:37,160
in the l are reflected in the page  they

514
00:23:37,160 --> 00:23:39,740
are found in the page then hexagon

515
00:23:39,740 --> 00:23:43,370
action initially did rose sniping

516
00:23:43,370 --> 00:23:45,020
of the script that was present in the

517
00:23:45,020 --> 00:23:46,059
page

518
00:23:46,059 --> 00:23:48,590
later

519
00:23:48,590 --> 00:23:50,630
they realized that this could

520
00:23:50,630 --> 00:23:53,330
have security problems and then

521
00:23:53,330 --> 00:23:55,730
they thought google to change the

522
00:23:55,730 --> 00:23:59,630
default behavior of the leeds exhausted to

523
00:23:59,630 --> 00:24:01,340
completely block making the  page

524
00:24:01,340 --> 00:24:05,000
in the browser of the person who is

525
00:24:05,000 --> 00:24:09,909
triggered precisely by the former auditor ok

526
00:24:12,400 --> 00:24:15,559
according to vo  i it is possible to abuse this

527
00:24:15,559 --> 00:24:16,880
system

528
00:24:16,880 --> 00:24:18,559
this mitigation to introduce

529
00:24:18,559 --> 00:24:20,510
vulnerabilities in applications that

530
00:24:20,510 --> 00:24:24,230
would otherwise be if the answer is yes

531
00:24:24,230 --> 00:24:26,179
because otherwise I would not be here to make

532
00:24:26,179 --> 00:24:28,460
these slides ok now now let's see

533
00:24:28,460 --> 00:24:32,380
how then this is another challenge

534
00:24:32,380 --> 00:24:37,370
taken by the 35 c 3 st f

535
00:24:37,370 --> 00:24:40,760
in this case we are not talking about zero day

536
00:24:40,760 --> 00:24:43,490
but we are talking about new techniques of

537
00:24:43,490 --> 00:24:45,679
exploitation techniques that

538
00:24:45,679 --> 00:24:48,980
were not known before or that are a variant of

539
00:24:48,980 --> 00:24:50,809
something that was circulating on the internet but

540
00:24:50,809 --> 00:24:54,399
that it is not yet clear what

541
00:24:54,399 --> 00:24:56,390
crossed what

542
00:24:56,390 --> 00:25:00,950
this challenge entailed anyway.  'it was a very

543
00:25:00,950 --> 00:25:03,020
simple website that allowed you to upload files

544
00:25:03,020 --> 00:25:08,179
and then allow you to search for the content

545
00:25:08,179 --> 00:25:10,850
of these files then the

546
00:25:10,850 --> 00:25:13,010
administrator connected to the site by downloading a file

547
00:25:13,010 --> 00:25:16,640
containing the flag and then had a search

548
00:25:16,640 --> 00:25:19,370
form where he could write a sub-

549
00:25:19,370 --> 00:25:21,850
star of the  flag if its force

550
00:25:21,850 --> 00:25:25,610
kissed ok the the contents of the file with

551
00:25:25,610 --> 00:25:28,730
the flag the flag remained pata ok but

552
00:25:28,730 --> 00:25:31,700
only in the admin session yes

553
00:25:31,700 --> 00:25:34,179
c  clearly you users are like paolino donald

554
00:25:34,179 --> 00:25:37,490
you do not know the

555
00:25:37,490 --> 00:25:39,260
flag and you cannot in any way

556
00:25:39,260 --> 00:25:41,539
access the flag file

557
00:25:41,539 --> 00:25:45,770
ok there were no good skills there were no

558
00:25:45,770 --> 00:25:49,039
x7 usable there were no injection cycles

559
00:25:49,039 --> 00:25:50,299
there were no cross site request forgery

560
00:25:50,299 --> 00:25:52,190
tex there is nothing

561
00:25:52,190 --> 00:25:53,720
the only thing that could be done was to

562
00:25:53,720 --> 00:25:56,270
send a link to the administrator

563
00:25:56,270 --> 00:25:58,520
then the administrator took the link

564
00:25:58,520 --> 00:26:00,540
that you sent me and

565
00:26:00,540 --> 00:26:03,390
in his authenticated session with the

566
00:26:03,390 --> 00:26:07,050
website he opened your link

567
00:26:07,050 --> 00:26:12,240
if there is  unix s clearly you can

568
00:26:12,240 --> 00:26:15,030
do some bad things but in this

569
00:26:15,030 --> 00:26:16,830
case there was no type of

570
00:26:16,830 --> 00:26:22,170
vulnerability that the

571
00:26:22,170 --> 00:26:24,870
attacker and dakar browser does then and

572
00:26:24,870 --> 00:26:27,240
forgiveness of the admin and chrome headless and

573
00:26:27,240 --> 00:26:29,340
this is given to productions as  in the

574
00:26:29,340 --> 00:26:32,060
description of the challenge

575
00:26:32,060 --> 00:26:36,150
we also noticed that explain options which is

576
00:26:36,150 --> 00:26:37,740
an eder that is used to prevent a

577
00:26:37,740 --> 00:26:40,830
page from being friends from another page

578
00:26:40,830 --> 00:26:43,290
was not currently present so it is

579
00:26:43,290 --> 00:26:45,960
actually possible to create a

580
00:26:45,960 --> 00:26:49,110
page  on another site and include as

581
00:26:49,110 --> 00:26:54,300
iframe the application of the site where

582
00:26:54,300 --> 00:26:56,370
the flag was loaded in short, ok

583
00:26:56,370 --> 00:26:58,380
then our challenger and this someone

584
00:26:58,380 --> 00:26:59,910
framing speech take last that

585
00:26:59,910 --> 00:27:04,440
I never missed this this eder here a

586
00:27:04,440 --> 00:27:07,680
month before the stf this blog came out

587
00:27:07,680 --> 00:27:12,570
post that has gone a bit into

588
00:27:12,570 --> 00:27:15,090
the background was not given much

589
00:27:15,090 --> 00:27:17,970
importance this blog post was about

590
00:27:17,970 --> 00:27:21,360
how to implement a port scan in a

591
00:27:21,360 --> 00:27:25,320
browser by framing another

592
00:27:25,320 --> 00:27:29,730
website an extremely interesting technician

593
00:27:29,730 --> 00:27:31,860
what was found which was precisely the

594
00:27:31,860 --> 00:27:33,900
solution intended  for this challenge

595
00:27:33,900 --> 00:27:36,060
the solution in this cell in the evening with

596
00:27:36,060 --> 00:27:38,130
to implement an oracle and oracle

597
00:27:38,130 --> 00:27:39,480
work in this way but here not

598
00:27:39,480 --> 00:27:42,780
what it is is something

599
00:27:42,780 --> 00:27:48,120
ok a website a system in general

600
00:27:48,120 --> 00:27:50,100
that based on a certain condition that you

601
00:27:50,100 --> 00:27:52,320
you can control it responds in

602
00:27:52,320 --> 00:27:54,120
a different way or on which you can

603
00:27:54,120 --> 00:27:55,920
still notice a

604
00:27:55,920 --> 00:27:57,750
different behavior and then you can enter the

605
00:27:57,750 --> 00:27:59,390
conclusions

606
00:27:59,390 --> 00:28:01,860
then the g  ution what it was was to create

607
00:28:01,860 --> 00:28:06,320
a site that contained an iframe

608
00:28:06,320 --> 00:28:08,400
to the application of the rome between

609
00:28:08,400 --> 00:28:10,559
challenge ok

610
00:28:10,559 --> 00:28:15,269
observe the behavior of the page

611
00:28:15,269 --> 00:28:17,340
that was included doing what

612
00:28:17,340 --> 00:28:20,429
practically inserting a policy

613
00:28:20,429 --> 00:28:24,120
of the string of the flag ok making a

614
00:28:24,120 --> 00:28:26,460
gas that could be painted xel of the

615
00:28:26,460 --> 00:28:34,110
of the flag  there is a power outlet

616
00:28:34,110 --> 00:28:37,229
[Music]

617
00:28:37,970 --> 00:29:04,289
sorry important thanks for the

618
00:29:04,289 --> 00:29:06,019
report

619
00:29:06,019 --> 00:29:10,340
so it was practically possible to

620
00:29:10,340 --> 00:29:13,259
dynamically control the

621
00:29:13,259 --> 00:29:16,019
behavior of the former auditor in

622
00:29:16,019 --> 00:29:17,759
the victim's browser in this case in the

623
00:29:17,759 --> 00:29:20,519
weapon browser doing as by inserting

624
00:29:20,519 --> 00:29:24,149
a piece of the javascript that appeared

625
00:29:24,149 --> 00:29:27,450
only when unpli fix of the flag of

626
00:29:27,450 --> 00:29:30,840
inserted in the query string of the browser

627
00:29:30,840 --> 00:29:33,600
doing in this way sat that

628
00:29:33,600 --> 00:29:35,730
in case there was a kit of a

629
00:29:35,730 --> 00:29:37,799
riff of the string then a gas that

630
00:29:37,799 --> 00:29:42,389
put the flag string first

631
00:29:42,389 --> 00:29:44,669
activated in inquiries sauri ton and  the

632
00:29:44,669 --> 00:29:45,240


633
00:29:45,240 --> 00:29:46,980
obviously broken page was blocked by the

634
00:29:46,980 --> 00:29:49,080
browser this generated a

635
00:29:49,080 --> 00:29:51,299
different behavior c  he could

636
00:29:51,299 --> 00:29:54,360
also be analyzed from the parc page in this way

637
00:29:54,360 --> 00:29:56,519
an oracle was increased and a bite at a

638
00:29:56,519 --> 00:30:00,860
time could be done there that of africa it

639
00:30:01,159 --> 00:30:02,800
is this

640
00:30:02,800 --> 00:30:04,750
that was not known before it was combined

641
00:30:04,750 --> 00:30:07,720
precisely with the knowledge on the sau di tor it is

642
00:30:07,720 --> 00:30:09,700
a technique precisely  presented a month

643
00:30:09,700 --> 00:30:12,750
before the start

644
00:30:13,810 --> 00:30:15,900
what happened then it happened that

645
00:30:15,900 --> 00:30:19,330
google said ok there are some

646
00:30:19,330 --> 00:30:22,740
problems with the current

647
00:30:22,740 --> 00:30:25,510
auditor behavior let's go back to the

648
00:30:25,510 --> 00:30:27,150
previous behavior so instead of

649
00:30:27,150 --> 00:30:29,440
completely blocking the pages

650
00:30:29,440 --> 00:30:31,000
let's go sniping then let's go

651
00:30:31,000 --> 00:30:34,360
kill  to remove from the page only

652
00:30:34,360 --> 00:30:38,020
the scripts that come that match

653
00:30:38,020 --> 00:30:40,060
have precisely the malevolent hair that

654
00:30:40,060 --> 00:30:42,460
wars present but this is known

655
00:30:42,460 --> 00:30:43,690
to create problems

656
00:30:43,690 --> 00:30:46,570
and a very simple problem is that an

657
00:30:46,570 --> 00:30:48,010
attacker in this way can

658
00:30:48,010 --> 00:30:50,800
control exactly which scripts in

659
00:30:50,800 --> 00:30:53,620
line to execute  and which ones are not ok

660
00:30:53,620 --> 00:30:56,680
and this was used to remove

661
00:30:56,680 --> 00:30:59,170
protections like don't you redo going

662
00:30:59,170 --> 00:31:01,990
to snai ping a certain script

663
00:31:01,990 --> 00:31:04,750
in l  ine which represents on the

664
00:31:04,750 --> 00:31:06,400
[Music] page

665
00:31:06,400 --> 00:31:08,230
then followed precisely these

666
00:31:08,230 --> 00:31:10,410
considerations google said the time

667
00:31:10,410 --> 00:31:14,110
of the time precisely for the ex Saudi was

668
00:31:14,110 --> 00:31:15,730
the proceeds ended lasted ten years

669
00:31:15,730 --> 00:31:19,480
and was removed in August there is therefore

670
00:31:19,480 --> 00:31:23,890
the month  last demo was removed

671
00:31:23,890 --> 00:31:25,570
instead of another challenge which is

672
00:31:25,570 --> 00:31:27,940
similar in spirit to the more just

673
00:31:27,940 --> 00:31:30,040
shown and this younes and tf

674
00:31:30,040 --> 00:31:32,380
organized by tokyo western

675
00:31:32,380 --> 00:31:35,320
japanese team three weeks ago a month

676
00:31:35,320 --> 00:31:37,780
ago probably knows that this

677
00:31:37,780 --> 00:31:39,610
is very simple application application

678
00:31:39,610 --> 00:31:42,520
allowed to register priest

679
00:31:42,520 --> 00:31:44,350
name surname nickname

680
00:31:44,350 --> 00:31:48,150
you log in and this page appears

681
00:31:48,150 --> 00:31:52,810
you can insert a note ok say fall

682
00:31:52,810 --> 00:31:55,830
asleep di now talk

683
00:31:56,150 --> 00:31:59,510
and these are the cookies ok

684
00:31:59,510 --> 00:32:01,130
you see that among the cookies there is a burkini

685
00:32:01,130 --> 00:32:04,660
it is called not which contains data  in

686
00:32:04,660 --> 00:32:08,210
the holy valley 4 means that the notes are

687
00:32:08,210 --> 00:32:10,370
somehow saved

688
00:32:10,370 --> 00:32:12,830
inside the puc and itself are not

689
00:32:12,830 --> 00:32:13,820
saved server side

690
00:32:13,820 --> 00:32:19,010
ok by analyzing the response headers

691
00:32:19,010 --> 00:32:20,690
of the server

692
00:32:20,690 --> 00:32:23,720
v  and we see that the server on which the

693
00:32:23,720 --> 00:32:28,250
challenge runs is windows with mark soft l'ires

694
00:32:28,250 --> 00:32:33,050
10 and thp updated 739 which is usually

695
00:32:33,050 --> 00:32:34,880
strange usually the cells run

696
00:32:34,880 --> 00:32:35,870
on

697
00:32:35,870 --> 00:32:39,100
linux unless there is a particular reason

698
00:32:39,590 --> 00:32:41,210
and the source code

699
00:32:41,210 --> 00:32:42,650
of the  challenge

700
00:32:42,650 --> 00:32:45,110
then we can study it let's

701
00:32:45,110 --> 00:32:49,100
study it and we see precisely that it gives it

702
00:32:49,100 --> 00:32:50,990
to the wedding and it is given in this

703
00:32:50,990 --> 00:32:53,180
way so there is a verification function

704
00:32:53,180 --> 00:32:56,600
that takes as a parameter the cookie note

705
00:32:56,600 --> 00:33:00,830
and the cookie and c mac the tops that the signature

706
00:33:00,830 --> 00:33:05,900
ok of the data

707
00:33:05,900 --> 00:33:07,640
if  precisely the verify function

708
00:33:07,640 --> 00:33:10,160
returns through then to true then

709
00:33:10,160 --> 00:33:14,300
you do lance i realize the cookie not

710
00:33:14,300 --> 00:33:16,640
ok otherwise a false note is set up

711
00:33:16,640 --> 00:33:19,840
the goods function you do is this here

712
00:33:19,840 --> 00:33:24,680
ok and you see that it takes a secret from the

713
00:33:24,680 --> 00:33:26,510
session and the session

714
00:33:26,510 --> 00:33:30,500
you have a file then takes a  secret from

715
00:33:30,500 --> 00:33:36,530
a file in the file system and reassembles the

716
00:33:36,530 --> 00:33:40,370
macs starting from the data so this

717
00:33:40,370 --> 00:33:44,480
case in fact the cookie not re computa

718
00:33:44,480 --> 00:33:47,240
reads mac with the secret

719
00:33:47,240 --> 00:33:49,880
and if you maybe computed cor  it responds

720
00:33:49,880 --> 00:33:52,600
to the c mac that is present in the cookie

721
00:33:52,600 --> 00:33:56,600
then returns clear through how it

722
00:33:56,600 --> 00:34:00,280
works more or less ok

723
00:34:00,280 --> 00:34:03,010
how a class works note the

724
00:34:03,010 --> 00:34:05,770
known class is this there is a constructor with an

725
00:34:05,770 --> 00:34:08,429
admin parameter if we can pass

726
00:34:08,429 --> 00:34:11,830
through on the constructor parameter

727
00:34:11,830 --> 00:34:14,409
we arrive the function  get flag to get flash method the

728
00:34:14,409 --> 00:34:15,010


729
00:34:15,010 --> 00:34:18,190
get flash action that takes the note

730
00:34:18,190 --> 00:34:21,699
was the flag so easy no if

731
00:34:21,699 --> 00:34:23,469
we can implement this code

732
00:34:23,469 --> 00:34:25,510
we have won this thing is and what it does

733
00:34:25,510 --> 00:34:28,960
creates a new note by setting

734
00:34:28,960 --> 00:34:30,730
the constructor parameter other then the

735
00:34:30,730 --> 00:34:33,400
psalms in  equal to true it is made

736
00:34:33,400 --> 00:34:37,179
the well 64 back safety for young code and

737
00:34:37,179 --> 00:34:40,900
then recomposed the mac law we put

738
00:34:40,900 --> 00:34:43,210
these two values in the cooking oct enel cookies mac these two

739
00:34:43,210 --> 00:34:47,980
values we have won nozzo fast what

740
00:34:47,980 --> 00:34:48,909
problem the problem is that we do not have the

741
00:34:48,909 --> 00:34:53,590
right secret without initials we can

742
00:34:53,590 --> 00:34:59,590
not re  compute our macs so I

743
00:34:59,590 --> 00:35:01,480
started reading a

744
00:35:01,480 --> 00:35:04,180
php documentation trying to enhance the

745
00:35:04,180 --> 00:35:06,490
security and function problems  i

746
00:35:06,490 --> 00:35:10,570
used like in the case of the

747
00:35:10,570 --> 00:35:15,340
slide which is the type that the quad ex mac

748
00:35:15,340 --> 00:35:18,430
see if there were any corner houses for

749
00:35:18,430 --> 00:35:19,870
which they could return

750
00:35:19,870 --> 00:35:22,450
some strange guy did not find

751
00:35:22,450 --> 00:35:27,160
anything to come back here so they

752
00:35:27,160 --> 00:35:29,770
said ok maybe it is a behavior not

753
00:35:29,770 --> 00:35:32,380
documented let's take php sources

754
00:35:32,380 --> 00:35:34,360
that are written in there let's go to the law

755
00:35:34,360 --> 00:35:36,310
let's try to understand if those

756
00:35:36,310 --> 00:35:39,280
functions can have some zero day

757
00:35:39,280 --> 00:35:40,990
some undocumented behavior

758
00:35:40,990 --> 00:35:41,790
etc. etc.

759
00:35:41,790 --> 00:35:46,600
nothing php in two different versions for

760
00:35:46,600 --> 00:35:49,240
windows and for linux we take them

761
00:35:49,240 --> 00:35:51,490
since precisely the silence  runs on windows and

762
00:35:51,490 --> 00:35:53,980
we compare the sources to see if there is

763
00:35:53,980 --> 00:35:55,420
any difference

764
00:35:55,420 --> 00:35:59,290
nothing let us realize that

765
00:35:59,290 --> 00:36:00,450
there are no bugs in this

766
00:36:00,450 --> 00:36:04,330
application and let us despair this is

767
00:36:04,330 --> 00:36:05,910
what we did

768
00:36:05,910 --> 00:36:08,860
then one must said but I remember

769
00:36:08,860 --> 00:36:11,080
that on twitter  recently there was

770
00:36:11,080 --> 00:36:11,369


771
00:36:11,369 --> 00:36:14,779
something about windows windows defender

772
00:36:14,779 --> 00:36:18,509
sloppiness search on twitter post

773
00:36:18,509 --> 00:36:23,640
welcome found this  what here and new

774
00:36:23,640 --> 00:36:25,559
technique trek have been tried information

775
00:36:25,559 --> 00:36:28,109
from protected servers and therefore spend

776
00:36:28,109 --> 00:36:30,269
well developed by the thought and western

777
00:36:30,269 --> 00:36:33,210
team few westerns are the

778
00:36:33,210 --> 00:36:35,730
organizers of this cdf said ok the

779
00:36:35,730 --> 00:36:38,089
technique is certainly the same

780
00:36:38,089 --> 00:36:41,700
we went to see the technique tried

781
00:36:41,700 --> 00:36:43,920
to understand how it worked  and planned to

782
00:36:43,920 --> 00:36:46,259
use a new sites and through

783
00:36:46,259 --> 00:36:47,999
the windows antivirus

784
00:36:47,999 --> 00:36:51,180
ok then wait what these

785
00:36:51,180 --> 00:36:52,980
standers do takes the files that are present

786
00:36:52,980 --> 00:36:55,079
in the file system and analyzes them to

787
00:36:55,079 --> 00:36:56,880
find viruses to find

788
00:36:56,880 --> 00:36:59,039
malicious payloads

789
00:36:59,039 --> 00:37:01,829
if the content is malicious then if the virus

790
00:37:01,829 --> 00:37:04,920
it has been identified in a file the file

791
00:37:04,920 --> 00:37:09,539
is deleted larg engine ii adel is

792
00:37:09,539 --> 00:37:11,490
a component of the

793
00:37:11,490 --> 00:37:16,160
windows antivirus and supports the panda 4 decoder

794
00:37:16,160 --> 00:37:21,029
also methods to decompress package it is

795
00:37:21,029 --> 00:37:23,690
also a javascript execution environment

796
00:37:23,690 --> 00:37:25,200
ok

797
00:37:25,200 --> 00:37:28,380
this because to do it

798
00:37:28,380 --> 00:37:30,509
payload detection  which may be

799
00:37:30,509 --> 00:37:33,359
somewhat tarnished which may be

800
00:37:33,359 --> 00:37:35,430
slightly changed to go  just

801
00:37:35,430 --> 00:37:39,450
to do the to go to confuse the

802
00:37:39,450 --> 00:37:44,910
systems of arti vhils ok so this

803
00:37:44,910 --> 00:37:47,309
looks extremely promising ok

804
00:37:47,309 --> 00:37:49,650
what the antivirus does is this the

805
00:37:49,650 --> 00:37:51,029
way the session is observed

806
00:37:51,029 --> 00:37:52,319
so this is the file that is

807
00:37:52,319 --> 00:37:54,569
saved in the file system by the challenge

808
00:37:54,569 --> 00:37:56,400
ok  so what is our approach

809
00:37:56,400 --> 00:37:58,890
our approach is we know that the

810
00:37:58,890 --> 00:38:01,200
secret that the thing we want to take

811
00:38:01,200 --> 00:38:03,660
we want to do there is already present in the

812
00:38:03,660 --> 00:38:05,940
file system and is present in a file that we

813
00:38:05,940 --> 00:38:08,069
partially control because like the

814
00:38:08,069 --> 00:38:09,569
name we put it and also the  nick

815
00:38:09,569 --> 00:38:11,900
name redman are and therefore the idea which

816
00:38:11,900 --> 00:38:16,769
we try to activate the javascript

817
00:38:16,769 --> 00:38:19,289
engine present in the windows antivirus

818
00:38:19,289 --> 00:38:22,000
in order to put a condition

819
00:38:22,000 --> 00:38:24,690
in here and then we leverage the

820
00:38:24,690 --> 00:38:25,870
malware

821
00:38:25,870 --> 00:38:29,080
ok but we leverage the malware only

822
00:38:29,080 --> 00:38:31,720
both our condition is

823
00:38:31,720 --> 00:38:33,310
true here  we go to recompose the string

824
00:38:33,310 --> 00:38:35,080
in some way of the malware only if

825
00:38:35,080 --> 00:38:36,370
our condition is true

826
00:38:36,370 --> 00:38:38,140
otherwise we do nothing

827
00:38:38,140 --> 00:38:40,360
what it means  says that if the condition is

828
00:38:40,360 --> 00:38:41,140
true

829
00:38:41,140 --> 00:38:43,330
the session procedure is deleted and

830
00:38:43,330 --> 00:38:46,810
let's say logged out of the system that

831
00:38:46,810 --> 00:38:49,690
we are disconnected from the system and this

832
00:38:49,690 --> 00:38:50,950
we can use to implement as

833
00:38:50,950 --> 00:38:53,290
before an oracle that leaks one

834
00:38:53,290 --> 00:39:01,110
bite at a time the problem was that

835
00:39:01,110 --> 00:39:05,410
I do not  I had no experience with the

836
00:39:05,410 --> 00:39:08,620
first of these challenges that it was not

837
00:39:08,620 --> 00:39:13,750
possible to activate the layer engine in the

838
00:39:13,750 --> 00:39:15,760
windows defender from these two pilots

839
00:39:15,760 --> 00:39:19,150
ok the first and second according to you which

840
00:39:19,150 --> 00:39:21,370
of the two activates

841
00:39:21,370 --> 00:39:28,570
windows defender how much the first how many

842
00:39:28,570 --> 00:39:34,800
second ok the second payload is not

843
00:39:34,800 --> 00:39:36,670
identified by windows defender

844
00:39:36,670 --> 00:39:39,850
I challenge you create a veto machine has

845
00:39:39,850 --> 00:39:42,310
used your windows practice a file that

846
00:39:42,310 --> 00:39:45,760
contains this with individuals a pc

847
00:39:45,760 --> 00:39:48,820
is not detected by windows

848
00:39:48,820 --> 00:39:51,880
defender the first yes so I felt

849
00:39:51,880 --> 00:39:54,130
just like this mom trying

850
00:39:54,130 --> 00:39:57,040
to please and  coercive that tries to do

851
00:39:57,040 --> 00:39:57,970
something

852
00:39:57,970 --> 00:39:59,710
the problem was not only to do

853
00:39:59,710 --> 00:40:01,660
the activation in the windows defender but it

854
00:40:01,660 --> 00:40:03,070
was just to do  and the activation

855
00:40:03,070 --> 00:40:07,089
of the gs gene precisely what

856
00:40:07,089 --> 00:40:08,499
I could not do in a

857
00:40:08,499 --> 00:40:10,239
deterministic way or in any case it does not make us

858
00:40:10,239 --> 00:40:11,680
understand how it worked

859
00:40:11,680 --> 00:40:13,059
there was clearly no time to do

860
00:40:13,059 --> 00:40:15,700
versino defender and veneto which is a

861
00:40:15,700 --> 00:40:18,219
black box approach it works okay

862
00:40:18,219 --> 00:40:19,839
but it must be done in  a little more

863
00:40:19,839 --> 00:40:21,849
structured way so what did they ever do to me

864
00:40:21,849 --> 00:40:24,819
created a virtual machine on google

865
00:40:24,819 --> 00:40:27,489
cloud and we withdrew the challenge is

866
00:40:27,489 --> 00:40:31,239
completely on cloud and we

867
00:40:31,239 --> 00:40:35,049
took the club video state bass and we

868
00:40:35,049 --> 00:40:36,789
systematically tried all the payloads

869
00:40:36,789 --> 00:40:38,739
until we were able to

870
00:40:38,739 --> 00:40:41,229
run some  exhausted code

871
00:40:41,229 --> 00:40:41,880
basically we made it

872
00:40:41,880 --> 00:40:44,170
this is the payload we

873
00:40:44,170 --> 00:40:46,749
used this is clearly just a

874
00:40:46,749 --> 00:40:49,779
string that goes a bit to represent the

875
00:40:49,779 --> 00:40:51,489
real malware we encountered in here

876
00:40:51,489 --> 00:40:55,920
and we managed to write

877
00:40:55,920 --> 00:40:58,989
this session file and we

878
00:40:58,989 --> 00:41:01,960
enclosed it in tags  open mind and tag

879
00:41:01,960 --> 00:41:05,109
closed mind our secret and then

880
00:41:05,109 --> 00:41:07,210
we have how di cage did using

881
00:41:07,210 --> 00:41:11,249
a bucket and search like this

882
00:41:11,339 --> 00:41:14,019
qu  this is the former priest as how it is

883
00:41:14,019 --> 00:41:19,520
performed so we are

884
00:41:19,520 --> 00:41:21,440
slowly the windows antivirus as

885
00:41:21,440 --> 00:41:23,240
side chandon to take an

886
00:41:23,240 --> 00:41:25,130
information one bit of information at a

887
00:41:25,130 --> 00:41:28,070
time and make the link through a trivial

888
00:41:28,070 --> 00:41:31,400
search of the string this here then

889
00:41:31,400 --> 00:41:33,110
we take the secret this we are

890
00:41:33,110 --> 00:41:35,390
to complete the c mac we play it e

891
00:41:35,390 --> 00:41:40,060
di monguidi nick today

892
00:41:40,060 --> 00:41:48,140
ok so in conclusion why do str

893
00:41:48,140 --> 00:41:50,720
because there is a lot of research that comes

894
00:41:50,720 --> 00:41:53,530
having it daily essentially

895
00:41:53,530 --> 00:41:56,450
icts allow you to keep up with

896
00:41:56,450 --> 00:41:57,830
the times to understand what are the latest

897
00:41:57,830 --> 00:42:00,590
latest techniques  vulnerabilities that

898
00:42:00,590 --> 00:42:05,360
are out there and also allows you to understand

899
00:42:05,360 --> 00:42:08,230
if it is actually a

900
00:42:08,230 --> 00:42:10,670
correct understanding of the technique or not because it

901
00:42:10,670 --> 00:42:13,670
is put in front of the problem and must

902
00:42:13,670 --> 00:42:16,700
solve it so I invite you not to be a

903
00:42:16,700 --> 00:42:19,130
security tourist but be a

904
00:42:19,130 --> 00:42:21,620
hacker get your hands dirty and let yourself be if

905
00:42:21,620 --> 00:42:25,120
you are  the same

906
00:42:33,990 --> 00:42:38,050
if you have any questions you can also find me at the bar

907
00:42:38,050 --> 00:42:44,970
tonight the only disregarded

908
00:43:06,970 --> 00:43:08,620
first of all

909
00:43:08,620 --> 00:43:12,910
for me was a fan  tastic I have seen the

910
00:43:12,910 --> 00:43:14,320
things that are more interested

911
00:43:14,320 --> 00:43:17,730
above all that the ss auditorium chrome

912
00:43:17,730 --> 00:43:20,740
another thing I have seen that in the bhp there was

913
00:43:20,740 --> 00:43:23,650
the function in series to live which takes

914
00:43:23,650 --> 00:43:28,980
as an argument of things that

915
00:43:33,840 --> 00:43:36,280
did not necessarily put you in any case to have

916
00:43:36,280 --> 00:43:38,950
some methods  that can lead you

917
00:43:38,950 --> 00:43:40,990
to have a crush inclusion the fact is

918
00:43:40,990 --> 00:43:42,520
that in this case it was not called

919
00:43:42,520 --> 00:43:44,670
lance i realize if village mac does not pass

920
00:43:44,670 --> 00:43:46,570
then the first that will pass however

921
00:43:46,570 --> 00:43:49,060
says mac and control on the former mac and little they

922
00:43:49,060 --> 00:43:50,980
call you live trap in this case

923
00:43:50,980 --> 00:43:52,450
I am not convinced that if he managed to

924
00:43:52,450 --> 00:43:53,710
have a closed courtesy not on the

925
00:43:53,710 --> 00:43:55,120
challenge but what we were interested in

926
00:43:55,120 --> 00:43:57,400
doing alone change the constructor of the

927
00:43:57,400 --> 00:44:08,550
method and then it was a myth question

928
00:44:12,910 --> 00:44:15,380
first of all thank you because you

929
00:44:15,380 --> 00:44:16,930
removed a doubt about why they had

930
00:44:16,930 --> 00:44:24,140
deprecated it in the second  exactly as you

931
00:44:24,140 --> 00:44:26,030
noticed the involving the difference in the

932
00:44:26,030 --> 00:44:27,470
behavior of the iv rail of

933
00:44:27,470 --> 00:44:29,750
course through ramite it is not,

934
00:44:29,750 --> 00:44:31,970
however, it is a bit complicated to explain we

935
00:44:31,970 --> 00:44:34,490
can  or in rose proposals after however

936
00:44:34,490 --> 00:44:37,070
through the injury

937
00:44:37,070 --> 00:44:39,860
it is not the keyword but if you look at that

938
00:44:39,860 --> 00:44:44,300
blog post which is about the swings you will find

939
00:44:44,300 --> 00:44:45,980
details on how it works and then just

940
00:44:45,980 --> 00:44:48,650
compose that technique with

941
00:44:48,650 --> 00:44:50,750
how the former auditor works you understand that

942
00:44:50,750 --> 00:44:54,080
peace  is blocked and you understand

943
00:44:54,080 --> 00:44:55,550
how the technique works there is also a video

944
00:44:55,550 --> 00:44:57,200
on live on the flop that explains

945
00:44:57,200 --> 00:44:58,880
the approach well that is fifteen minutes

946
00:44:58,880 --> 00:45:00,620
instead of minutes he understands how everything works

947
00:45:00,620 --> 00:45:02,859


948
00:45:11,230 --> 00:45:17,590
[Applause]

