1
00:00:00,850 --> 00:00:07,310
[Music]

2
00:00:11,000 --> 00:00:13,080
thank you

3
00:00:13,080 --> 00:00:15,240
all right so

4
00:00:15,240 --> 00:00:17,340
thank you for the introduction

5
00:00:17,340 --> 00:00:19,380
it's a pleasure to be here and thank you

6
00:00:19,380 --> 00:00:22,560
all first and foremost for being here so

7
00:00:22,560 --> 00:00:26,400
without further Ado let's start

8
00:00:26,400 --> 00:00:29,640
maybe some yeah some very quick notes I

9
00:00:29,640 --> 00:00:31,199
would say that Michael's already

10
00:00:31,199 --> 00:00:34,500
introduced me very very well so

11
00:00:34,500 --> 00:00:35,940
I'm part I'm one of the security

12
00:00:35,940 --> 00:00:38,820
researchers at no zombie Network's Labs

13
00:00:38,820 --> 00:00:40,680
um I have two main responsibility

14
00:00:40,680 --> 00:00:43,620
basically my job that is one is break

15
00:00:43,620 --> 00:00:47,100
devices and secondly unfortunately but

16
00:00:47,100 --> 00:00:49,500
still it's part of the job have long

17
00:00:49,500 --> 00:00:51,300
discussions very very long discussions

18
00:00:51,300 --> 00:00:54,360
with manufacturers to have them fixed

19
00:00:54,360 --> 00:00:57,000
um I'm responsible for 30th CBS in the

20
00:00:57,000 --> 00:00:59,039
last two years but others are still

21
00:00:59,039 --> 00:01:01,920
upcoming and well

22
00:01:01,920 --> 00:01:04,979
I've already know I mean other talks

23
00:01:04,979 --> 00:01:06,900
that have done so far but what about

24
00:01:06,900 --> 00:01:07,799
today

25
00:01:07,799 --> 00:01:10,560
today we're going to talk about Beyond

26
00:01:10,560 --> 00:01:12,900
sales that those devices that are not

27
00:01:12,900 --> 00:01:15,600
very well known in OT and iot devices

28
00:01:15,600 --> 00:01:17,900
so I will start with an introduction

29
00:01:17,900 --> 00:01:20,520
ambiences we'll continue walking through

30
00:01:20,520 --> 00:01:23,580
all the steps of our research we show

31
00:01:23,580 --> 00:01:25,979
you a complete attack demo that ends

32
00:01:25,979 --> 00:01:27,600
with the destruction of the industrial

33
00:01:27,600 --> 00:01:28,619
process

34
00:01:28,619 --> 00:01:31,140
and I will finish with a summary and

35
00:01:31,140 --> 00:01:35,100
some key takeaways so

36
00:01:35,100 --> 00:01:37,860
first and foremost let's start with some

37
00:01:37,860 --> 00:01:40,560
background on the Peugeot model that

38
00:01:40,560 --> 00:01:42,840
might be obscure to all of you that

39
00:01:42,840 --> 00:01:44,520
don't work directly with industrial

40
00:01:44,520 --> 00:01:47,159
control systems so

41
00:01:47,159 --> 00:01:49,200
the Purdue model is a reference

42
00:01:49,200 --> 00:01:51,000
architecture that divides an industrial

43
00:01:51,000 --> 00:01:53,460
Network into basically filed levels

44
00:01:53,460 --> 00:01:55,200
there is also a sixth level in some

45
00:01:55,200 --> 00:01:58,020
diagrams that is called level file what

46
00:01:58,020 --> 00:02:01,020
seems pretty much like this so

47
00:02:01,020 --> 00:02:05,040
we'll find at level 4 and 5 the

48
00:02:05,040 --> 00:02:07,020
Enterprise ID Network maybe some

49
00:02:07,020 --> 00:02:08,880
business planning and Logistics so we

50
00:02:08,880 --> 00:02:11,520
will find devices such as image servers

51
00:02:11,520 --> 00:02:14,400
cameras printers Etc

52
00:02:14,400 --> 00:02:17,400
then we have then we have an upper

53
00:02:17,400 --> 00:02:19,800
dominatory Zone that is the transfer

54
00:02:19,800 --> 00:02:23,099
Network between it and OT devices

55
00:02:23,099 --> 00:02:26,220
then we have an operations Network it is

56
00:02:26,220 --> 00:02:29,099
the first OT Network and here we will

57
00:02:29,099 --> 00:02:31,260
find systems that provide I.T services

58
00:02:31,260 --> 00:02:33,900
such as for instance the DNS to the

59
00:02:33,900 --> 00:02:36,420
lower levels and that collect historical

60
00:02:36,420 --> 00:02:38,819
data so for instance historians

61
00:02:38,819 --> 00:02:42,480
then we have a level 2.5 Network that is

62
00:02:42,480 --> 00:02:44,760
the lower the military zone it is

63
00:02:44,760 --> 00:02:46,200
optional actually

64
00:02:46,200 --> 00:02:49,200
now we find the first process Network so

65
00:02:49,200 --> 00:02:51,060
we'll find systems that use those ID

66
00:02:51,060 --> 00:02:53,580
services from the laboratory that

67
00:02:53,580 --> 00:02:57,360
control or acquire data from the lower

68
00:02:57,360 --> 00:02:59,400
level so we will find engineering

69
00:02:59,400 --> 00:03:02,519
workstations human machine interfaces

70
00:03:02,519 --> 00:03:04,640
Etc

71
00:03:04,980 --> 00:03:07,500
um then we have the level one so systems

72
00:03:07,500 --> 00:03:09,480
that collect and transmit data to the

73
00:03:09,480 --> 00:03:10,739
fill devices

74
00:03:10,739 --> 00:03:13,319
and for instance we'll find a

75
00:03:13,319 --> 00:03:17,099
programmable logic controllers rtus

76
00:03:17,099 --> 00:03:21,360
um dcis Etc and finally The Fill Network

77
00:03:21,360 --> 00:03:24,180
that tells the network that contains the

78
00:03:24,180 --> 00:03:27,180
actual sensors and actuators that are

79
00:03:27,180 --> 00:03:30,180
that control and monitor the industrial

80
00:03:30,180 --> 00:03:33,060
process that we want to and we want to

81
00:03:33,060 --> 00:03:34,379
control

82
00:03:34,379 --> 00:03:38,159
so given this clear segmentation it's

83
00:03:38,159 --> 00:03:39,659
easy to understand why this model

84
00:03:39,659 --> 00:03:42,540
although be more than 30 years old now

85
00:03:42,540 --> 00:03:46,200
has been and is still adopted as a cyber

86
00:03:46,200 --> 00:03:48,959
security reference model but during this

87
00:03:48,959 --> 00:03:51,840
presentation we will see how this model

88
00:03:51,840 --> 00:03:55,440
will be severally tested

89
00:03:55,440 --> 00:03:58,019
but now let's talk about this baseball

90
00:03:58,019 --> 00:04:00,739
management controllers or Beyond sales

91
00:04:00,739 --> 00:04:05,519
so what exactly is a BMC

92
00:04:05,519 --> 00:04:08,099
it's a supplementary system on chip

93
00:04:08,099 --> 00:04:10,260
designed for the remote monitoring and

94
00:04:10,260 --> 00:04:12,599
management of a computer

95
00:04:12,599 --> 00:04:14,640
it is tightly coupled with the hardware

96
00:04:14,640 --> 00:04:16,918
in order to allow to perform low level

97
00:04:16,918 --> 00:04:18,720
operations on systems completely

98
00:04:18,720 --> 00:04:20,040
remotely

99
00:04:20,040 --> 00:04:22,139
it is either embedded in the hardware

100
00:04:22,139 --> 00:04:24,840
motherboard or sold as an optional

101
00:04:24,840 --> 00:04:27,840
expansion card and famous Brands

102
00:04:27,840 --> 00:04:31,440
embedding BNC Solutions are Asus style

103
00:04:31,440 --> 00:04:35,280
gigabyte so many many of those

104
00:04:35,280 --> 00:04:36,540
so

105
00:04:36,540 --> 00:04:38,280
in this slide I projected the

106
00:04:38,280 --> 00:04:40,979
specifications of a BNC from a speed

107
00:04:40,979 --> 00:04:44,100
which is a popular manufacturer and you

108
00:04:44,100 --> 00:04:46,199
can clearly see that it is basically a

109
00:04:46,199 --> 00:04:49,560
piece of within a PC it has its own CPU

110
00:04:49,560 --> 00:04:52,620
that is usually Arm based it has its own

111
00:04:52,620 --> 00:04:55,560
RAM does its own VGA controllers they

112
00:04:55,560 --> 00:04:58,440
even develop VGA drivers for many many

113
00:04:58,440 --> 00:05:02,460
hours because ibnc must be on sales are

114
00:05:02,460 --> 00:05:04,500
able to provide basic Graphics

115
00:05:04,500 --> 00:05:07,620
capabilities to the to the host to the

116
00:05:07,620 --> 00:05:10,680
managers the staff so that even if it

117
00:05:10,680 --> 00:05:12,600
doesn't have a graphics adapter inside

118
00:05:12,600 --> 00:05:14,940
it's still able to provide a graphic

119
00:05:14,940 --> 00:05:15,960
sample

120
00:05:15,960 --> 00:05:18,900
its own land its own flash memory so

121
00:05:18,900 --> 00:05:21,300
it's basically a fully fully fledged

122
00:05:21,300 --> 00:05:22,680
computer

123
00:05:22,680 --> 00:05:26,639
and well let's see now a book diagram of

124
00:05:26,639 --> 00:05:29,220
a motherboard is equipped with a BNC to

125
00:05:29,220 --> 00:05:31,860
understand the interconnectivity and the

126
00:05:31,860 --> 00:05:34,259
beyond what the BNC can control

127
00:05:34,259 --> 00:05:38,340
so let's focus now on The BMC and you

128
00:05:38,340 --> 00:05:40,259
can clearly see that it is needing this

129
00:05:40,259 --> 00:05:42,600
schema this for instance first and

130
00:05:42,600 --> 00:05:44,580
foremost is connected through the PCI

131
00:05:44,580 --> 00:05:47,820
Express lines to the CPU it is connected

132
00:05:47,820 --> 00:05:51,000
to the M2 slot so to the hard drive of

133
00:05:51,000 --> 00:05:54,539
the host it is connected to the ethernet

134
00:05:54,539 --> 00:05:56,699
interfaces that are being used by The

135
00:05:56,699 --> 00:05:57,539
Host

136
00:05:57,539 --> 00:05:59,580
it is it provides its own management

137
00:05:59,580 --> 00:06:02,880
line it has the VGA output or an HDMI

138
00:06:02,880 --> 00:06:06,180
output whatever a communication port and

139
00:06:06,180 --> 00:06:08,100
it's also connected to the USB bus of

140
00:06:08,100 --> 00:06:09,360
the system

141
00:06:09,360 --> 00:06:13,380
but okay but what exactly can a BNC

142
00:06:13,380 --> 00:06:15,660
control with respect to the host

143
00:06:15,660 --> 00:06:19,259
so on this slide I put on the left a

144
00:06:19,259 --> 00:06:21,479
list of capabilities that are provided

145
00:06:21,479 --> 00:06:22,860
by VLC

146
00:06:22,860 --> 00:06:25,080
under the right how pilling they are to

147
00:06:25,080 --> 00:06:26,400
a hacker

148
00:06:26,400 --> 00:06:27,539
so

149
00:06:27,539 --> 00:06:29,340
we will start with some Hardware

150
00:06:29,340 --> 00:06:32,160
monitoring capabilities and logic of

151
00:06:32,160 --> 00:06:35,220
events regarding to this monitoring so

152
00:06:35,220 --> 00:06:37,919
we can monitor temperatures of our rows

153
00:06:37,919 --> 00:06:40,500
the voltage is the various components of

154
00:06:40,500 --> 00:06:42,360
the metabol the power loads the fan

155
00:06:42,360 --> 00:06:44,639
speed we have an inventor of device pass

156
00:06:44,639 --> 00:06:46,800
which is man I mean interesting but

157
00:06:46,800 --> 00:06:49,319
still not really much

158
00:06:49,319 --> 00:06:50,639
but then

159
00:06:50,639 --> 00:06:52,740
we can consider that bncs can also

160
00:06:52,740 --> 00:06:55,020
provide a remote system power control

161
00:06:55,020 --> 00:06:59,460
that is power off reset or even power on

162
00:06:59,460 --> 00:07:00,720
their host

163
00:07:00,720 --> 00:07:03,360
an important thing to remember of bncs

164
00:07:03,360 --> 00:07:06,660
as a matter of fact is that as soon as

165
00:07:06,660 --> 00:07:08,520
you plug a device that is equipped with

166
00:07:08,520 --> 00:07:12,900
a BNC the power Network the bncs goes on

167
00:07:12,900 --> 00:07:16,620
and stays on all the time you are not

168
00:07:16,620 --> 00:07:18,419
supposed to shut it off you cannot even

169
00:07:18,419 --> 00:07:20,280
shut it off it doesn't provide that

170
00:07:20,280 --> 00:07:22,620
feature so it's always on and that's

171
00:07:22,620 --> 00:07:26,280
exactly why it allows you to um turn on

172
00:07:26,280 --> 00:07:29,359
the managed device

173
00:07:30,120 --> 00:07:33,120
can provide screen recording well it has

174
00:07:33,120 --> 00:07:35,280
its own Graphics adapter so why not just

175
00:07:35,280 --> 00:07:37,199
record the output of this Graphics

176
00:07:37,199 --> 00:07:38,780
adapter

177
00:07:38,780 --> 00:07:42,360
it can provide keyboard and mouse

178
00:07:42,360 --> 00:07:44,580
interaction straight from the bootstrap

179
00:07:44,580 --> 00:07:47,639
that is we can never enter the BIOS

180
00:07:47,639 --> 00:07:49,680
setup and change settings Through The

181
00:07:49,680 --> 00:07:50,759
BMC

182
00:07:50,759 --> 00:07:53,580
and we can even remotely Mount CDL DVD

183
00:07:53,580 --> 00:07:56,639
images or HDD images that would appear

184
00:07:56,639 --> 00:07:58,380
to the host as if they were directly

185
00:07:58,380 --> 00:07:59,880
connected to it

186
00:07:59,880 --> 00:08:04,020
but finally we can also refresh the BIOS

187
00:08:04,020 --> 00:08:06,599
and Beyonce firmware many many times

188
00:08:06,599 --> 00:08:08,580
from the Beyonce itself

189
00:08:08,580 --> 00:08:12,060
so you can immediately understand how

190
00:08:12,060 --> 00:08:15,319
powerful this device is

191
00:08:15,479 --> 00:08:19,199
Okay so let's now do a recap of the

192
00:08:19,199 --> 00:08:21,539
normal exposed Network Services via

193
00:08:21,539 --> 00:08:22,860
Beyonce

194
00:08:22,860 --> 00:08:26,220
so for sure it has a web interface that

195
00:08:26,220 --> 00:08:29,699
is one of them main Services by which

196
00:08:29,699 --> 00:08:32,820
you're supposed to control your BMC

197
00:08:32,820 --> 00:08:34,979
it has this

198
00:08:34,979 --> 00:08:37,320
um ipmi service that stands for

199
00:08:37,320 --> 00:08:39,059
intelligent platform management

200
00:08:39,059 --> 00:08:42,479
interface here's a sort of service by

201
00:08:42,479 --> 00:08:44,700
which you can send commands to a

202
00:08:44,700 --> 00:08:46,200
basically command line interface for

203
00:08:46,200 --> 00:08:48,720
instance in this case this screenshots

204
00:08:48,720 --> 00:08:51,720
depicts the usage of ipmi tool and by

205
00:08:51,720 --> 00:08:53,700
which we can send command to The BMC and

206
00:08:53,700 --> 00:08:55,440
we can either acquired data from the

207
00:08:55,440 --> 00:08:57,660
host such as here or we can issue

208
00:08:57,660 --> 00:09:00,540
commands that control the host

209
00:09:00,540 --> 00:09:03,420
it provides an SMP service nothing no

210
00:09:03,420 --> 00:09:06,120
big deal here nothing new

211
00:09:06,120 --> 00:09:07,380
it provides this

212
00:09:07,380 --> 00:09:10,980
service but mind you here KVM does not

213
00:09:10,980 --> 00:09:13,260
stand for kernel battle machine but

214
00:09:13,260 --> 00:09:16,019
stands for keyboard video on Mouse this

215
00:09:16,019 --> 00:09:18,959
is a sort of evolution of of VNC

216
00:09:18,959 --> 00:09:21,839
basically it allows you to not only to

217
00:09:21,839 --> 00:09:23,339
have keyboard and mouse interaction but

218
00:09:23,339 --> 00:09:25,080
also to mount those Medias as it was

219
00:09:25,080 --> 00:09:27,000
anticipated

220
00:09:27,000 --> 00:09:30,180
and finally some bmcs also have an SSH

221
00:09:30,180 --> 00:09:33,660
interface that usually grants you access

222
00:09:33,660 --> 00:09:36,000
to a restricted shell

223
00:09:36,000 --> 00:09:38,180
foreign

224
00:09:38,300 --> 00:09:41,640
we have seen a generic Beyonce let's now

225
00:09:41,640 --> 00:09:43,980
talk about a specific solution that is

226
00:09:43,980 --> 00:09:47,640
the American megatrons of mega rock SPX

227
00:09:47,640 --> 00:09:51,060
so what is the micro SPX it's Amy

228
00:09:51,060 --> 00:09:54,300
software or firmware solution for bmcs

229
00:09:54,300 --> 00:09:56,519
it is almost

230
00:09:56,519 --> 00:09:59,580
an operating system that was that this

231
00:09:59,580 --> 00:10:02,040
is developed by Amy and specifically for

232
00:10:02,040 --> 00:10:03,959
Beyond sales

233
00:10:03,959 --> 00:10:06,060
it features all the services that we

234
00:10:06,060 --> 00:10:08,220
have just mentioned so the web interface

235
00:10:08,220 --> 00:10:10,800
with redfish API support which is a

236
00:10:10,800 --> 00:10:12,779
standard set of apis by which you can

237
00:10:12,779 --> 00:10:17,100
control multiple of pencils it supports

238
00:10:17,100 --> 00:10:21,240
ipmi supports Assam P KVM Etc

239
00:10:21,240 --> 00:10:22,920
um to the best of my knowledge this is

240
00:10:22,920 --> 00:10:24,480
closed Source there is also an open

241
00:10:24,480 --> 00:10:27,959
source version of this BNC software but

242
00:10:27,959 --> 00:10:30,180
it's based on openvnc and it's

243
00:10:30,180 --> 00:10:32,040
completely different than the SPX

244
00:10:32,040 --> 00:10:34,680
version and each OEM can decide to

245
00:10:34,680 --> 00:10:37,440
customize it according to its needs

246
00:10:37,440 --> 00:10:38,700
so

247
00:10:38,700 --> 00:10:41,820
common is the Amy McGraw SPX

248
00:10:41,820 --> 00:10:44,399
this lag collects a few oems known to

249
00:10:44,399 --> 00:10:48,060
use it in their own products so Asus

250
00:10:48,060 --> 00:10:52,019
uses the magrock SPX in its ASM beta and

251
00:10:52,019 --> 00:10:54,920
ikvm solution and many others

252
00:10:54,920 --> 00:10:57,720
that was found using the megarcast PX

253
00:10:57,720 --> 00:11:00,779
Dal is famous for his own hydrax

254
00:11:00,779 --> 00:11:04,079
solution that provides more capabilities

255
00:11:04,079 --> 00:11:07,200
Etc but still for some devices it has

256
00:11:07,200 --> 00:11:09,540
chosen the mega SPX

257
00:11:09,540 --> 00:11:13,200
gigabyte uses the mega cast PX

258
00:11:13,200 --> 00:11:16,100
unit Packard again uses the microcast PX

259
00:11:16,100 --> 00:11:18,360
the situation is pretty much the same

260
00:11:18,360 --> 00:11:21,060
with dial so you will pack up a develop

261
00:11:21,060 --> 00:11:23,160
its own integrated lights out solution

262
00:11:23,160 --> 00:11:26,399
the ILO but still for some devices it

263
00:11:26,399 --> 00:11:29,160
has chosen the mega SPX

264
00:11:29,160 --> 00:11:32,579
Lenovo uses the magara caspiax

265
00:11:32,579 --> 00:11:36,120
Nvidia was found using the magaraka SPX

266
00:11:36,120 --> 00:11:39,420
so I mean it is pretty pretty common but

267
00:11:39,420 --> 00:11:42,480
one important thing to mention is that

268
00:11:42,480 --> 00:11:46,260
all these oems in Batman says it mostly

269
00:11:46,260 --> 00:11:48,180
I.T Solutions

270
00:11:48,180 --> 00:11:50,700
recently this is changing

271
00:11:50,700 --> 00:11:54,120
so here is Lana Lana is a popular

272
00:11:54,120 --> 00:11:57,120
manufacturer of emboded solution of

273
00:11:57,120 --> 00:11:59,519
Industrial Automation Solutions

274
00:11:59,519 --> 00:12:01,800
and guess what if you look at the

275
00:12:01,800 --> 00:12:04,740
documentation under its own website you

276
00:12:04,740 --> 00:12:06,720
will find the mega cast PX inside their

277
00:12:06,720 --> 00:12:07,800
own product

278
00:12:07,800 --> 00:12:11,220
or here is Diane tire is another popular

279
00:12:11,220 --> 00:12:13,500
brand that it's under the mitak Holding

280
00:12:13,500 --> 00:12:16,200
Group and it has its own branch that

281
00:12:16,200 --> 00:12:18,360
develops embedded solutions that Target

282
00:12:18,360 --> 00:12:21,360
for instance iot telecommunications

283
00:12:21,360 --> 00:12:23,420
networking Industrial Automation

284
00:12:23,420 --> 00:12:26,880
military medical and hacker

285
00:12:26,880 --> 00:12:29,760
and guess what here it is here is the

286
00:12:29,760 --> 00:12:32,760
Mega cast BX again in their own products

287
00:12:32,760 --> 00:12:34,939
foreign

288
00:12:35,779 --> 00:12:38,339
model right so

289
00:12:38,339 --> 00:12:40,260
let's keep the Peugeot model on the left

290
00:12:40,260 --> 00:12:41,820
of this slide

291
00:12:41,820 --> 00:12:44,040
let's put the beyonc black diagram on

292
00:12:44,040 --> 00:12:45,420
the right

293
00:12:45,420 --> 00:12:47,160
um let's imagine for a minute that the

294
00:12:47,160 --> 00:12:48,959
device of this block diagram is an OT

295
00:12:48,959 --> 00:12:51,120
device and let's focus on the network

296
00:12:51,120 --> 00:12:52,860
interfaces

297
00:12:52,860 --> 00:12:54,480
so

298
00:12:54,480 --> 00:12:56,940
um regarding the two gigabyte interfaces

299
00:12:56,940 --> 00:13:00,120
if this is an OT device those will be

300
00:13:00,120 --> 00:13:02,639
found connected to the lava tree or lava

301
00:13:02,639 --> 00:13:05,880
2 networks but now

302
00:13:05,880 --> 00:13:08,279
what about the management land

303
00:13:08,279 --> 00:13:10,920
it is actually customary to find it

304
00:13:10,920 --> 00:13:13,079
connected to level 4 because after all

305
00:13:13,079 --> 00:13:15,540
the Beyonce is used for monitoring and

306
00:13:15,540 --> 00:13:17,700
management purposes so it is mainly used

307
00:13:17,700 --> 00:13:19,740
in it tasks

308
00:13:19,740 --> 00:13:23,160
thus it becomes absolutely important

309
00:13:23,160 --> 00:13:25,680
that the BNC is as protected as possible

310
00:13:25,680 --> 00:13:28,100
because if that is not the case

311
00:13:28,100 --> 00:13:30,720
considering all the functionalities that

312
00:13:30,720 --> 00:13:33,060
the BNC provides and the possibility to

313
00:13:33,060 --> 00:13:36,120
deeply control the host the BNC could be

314
00:13:36,120 --> 00:13:39,060
easily abused to jump from oil from it

315
00:13:39,060 --> 00:13:41,760
to OT Networks

316
00:13:41,760 --> 00:13:44,700
so over the course of the last year

317
00:13:44,700 --> 00:13:46,740
we've conducted the research on the

318
00:13:46,740 --> 00:13:49,500
security of bmcs focused on OT and iot

319
00:13:49,500 --> 00:13:50,459
devices

320
00:13:50,459 --> 00:13:54,240
and here at no heart we anticipate the

321
00:13:54,240 --> 00:13:57,180
first results of our analysis

322
00:13:57,180 --> 00:13:58,320
so

323
00:13:58,320 --> 00:14:00,180
this is the first bunch of

324
00:14:00,180 --> 00:14:02,880
vulnerabilities affecting the mega base

325
00:14:02,880 --> 00:14:05,220
beyond the firmware of OT and iot

326
00:14:05,220 --> 00:14:06,420
devices

327
00:14:06,420 --> 00:14:08,220
as you can see there are 13

328
00:14:08,220 --> 00:14:11,100
vulnerabilities and five of them are

329
00:14:11,100 --> 00:14:12,959
critical

330
00:14:12,959 --> 00:14:15,480
in the next section of this presentation

331
00:14:15,480 --> 00:14:17,040
we're going to walk you through our

332
00:14:17,040 --> 00:14:19,440
research methodology in that described a

333
00:14:19,440 --> 00:14:21,000
subset of those dishes because we don't

334
00:14:21,000 --> 00:14:22,860
have the time to do all of them and

335
00:14:22,860 --> 00:14:25,440
present their impacts and as you can see

336
00:14:25,440 --> 00:14:26,880
at the bottom there are also other

337
00:14:26,880 --> 00:14:28,440
vulnerabilities to be released

338
00:14:28,440 --> 00:14:30,300
unfortunately they're still in the

339
00:14:30,300 --> 00:14:31,920
process of to be fixed and as such we

340
00:14:31,920 --> 00:14:33,779
cannot disclose them right now but stay

341
00:14:33,779 --> 00:14:35,639
tuned for updates later this year and in

342
00:14:35,639 --> 00:14:37,320
the next year

343
00:14:37,320 --> 00:14:39,380
so

344
00:14:39,380 --> 00:14:42,360
first and foremost let's

345
00:14:42,360 --> 00:14:43,220
let's

346
00:14:43,220 --> 00:14:45,720
analyze the device that we used a Cisco

347
00:14:45,720 --> 00:14:47,100
beta device that we used for our

348
00:14:47,100 --> 00:14:49,860
analysis so during our research we

349
00:14:49,860 --> 00:14:52,800
analyzed a liner and ca5220a which is

350
00:14:52,800 --> 00:14:54,300
recommend appliance that can be

351
00:14:54,300 --> 00:14:55,820
configured for industrial applications

352
00:14:55,820 --> 00:14:58,980
but more specifically we focused on the

353
00:14:58,980 --> 00:15:02,279
ISC ASD 2500 module that is the

354
00:15:02,279 --> 00:15:04,199
expansion card that provides Beyonce

355
00:15:04,199 --> 00:15:05,540
capabilities

356
00:15:05,540 --> 00:15:07,320
anticipated

357
00:15:07,320 --> 00:15:08,940
um some Brands decide to offer Beyonce

358
00:15:08,940 --> 00:15:10,380
capabilities through a special color

359
00:15:10,380 --> 00:15:12,120
here is one case

360
00:15:12,120 --> 00:15:14,880
and firmware is based on the Amy mega

361
00:15:14,880 --> 00:15:17,040
rock SPX

362
00:15:17,040 --> 00:15:20,519
so as a reminder the determining factors

363
00:15:20,519 --> 00:15:22,980
of the possibility to easily assess the

364
00:15:22,980 --> 00:15:25,560
security posture of the system are the

365
00:15:25,560 --> 00:15:28,440
firmware availability so how is this it

366
00:15:28,440 --> 00:15:30,839
to obtain the firmware the firmware

367
00:15:30,839 --> 00:15:33,300
observability is it possible to analyze

368
00:15:33,300 --> 00:15:35,220
the firmware or apparent obfuscation

369
00:15:35,220 --> 00:15:37,800
steps and the device accessibility so

370
00:15:37,800 --> 00:15:40,920
does the device allow to be inspected

371
00:15:40,920 --> 00:15:44,279
now as for the vulnerable ability it is

372
00:15:44,279 --> 00:15:45,779
not publicly downloadable from the

373
00:15:45,779 --> 00:15:48,660
official website however Lana readily

374
00:15:48,660 --> 00:15:50,760
shares few more images to customers so

375
00:15:50,760 --> 00:15:53,459
just simply by asking them via email so

376
00:15:53,459 --> 00:15:55,920
it was an easy task here

377
00:15:55,920 --> 00:15:57,959
in terms of a several activity apart

378
00:15:57,959 --> 00:15:59,579
from the installation of the required

379
00:15:59,579 --> 00:16:01,019
the panel says again this simple

380
00:16:01,019 --> 00:16:03,420
resulted in one viewer command so the

381
00:16:03,420 --> 00:16:05,579
entire framework for structure was was

382
00:16:05,579 --> 00:16:07,860
extracted and it was possible to browse

383
00:16:07,860 --> 00:16:09,899
all files on the custom Linux operating

384
00:16:09,899 --> 00:16:11,040
system

385
00:16:11,040 --> 00:16:12,779
it was the device accessibility that

386
00:16:12,779 --> 00:16:15,180
proved to be the trickest point as no

387
00:16:15,180 --> 00:16:18,060
SSH remote access was allowed

388
00:16:18,060 --> 00:16:19,620
um the only exposed services are

389
00:16:19,620 --> 00:16:23,820
basically as an mph totps ipmi escp and

390
00:16:23,820 --> 00:16:25,620
and unrecognized one which turned out to

391
00:16:25,620 --> 00:16:28,079
be succulently related this means that

392
00:16:28,079 --> 00:16:30,060
either we proceed for static analysis

393
00:16:30,060 --> 00:16:31,920
only or we try to find an alternative

394
00:16:31,920 --> 00:16:34,320
way to dynamically debug the device for

395
00:16:34,320 --> 00:16:36,300
instance by robust engineering the

396
00:16:36,300 --> 00:16:38,040
filmer and modifying it to add debugging

397
00:16:38,040 --> 00:16:39,420
functionalities

398
00:16:39,420 --> 00:16:41,399
in this specific case we decided to

399
00:16:41,399 --> 00:16:43,019
start with a static approach and an

400
00:16:43,019 --> 00:16:44,699
invest the time for dynamic approach

401
00:16:44,699 --> 00:16:47,459
only if necessary

402
00:16:47,459 --> 00:16:48,959
so

403
00:16:48,959 --> 00:16:51,000
um the web application is usually a

404
00:16:51,000 --> 00:16:53,759
juicy Target and said to be the most

405
00:16:53,759 --> 00:16:56,579
promising service of all of one so we

406
00:16:56,579 --> 00:16:59,459
started analyzing it and let's show here

407
00:16:59,459 --> 00:17:02,100
the login process I mean

408
00:17:02,100 --> 00:17:04,079
it's not particular

409
00:17:04,079 --> 00:17:06,059
difference I mean it's pretty pretty

410
00:17:06,059 --> 00:17:09,059
basic you enter the credentials you wait

411
00:17:09,059 --> 00:17:10,919
some seconds for them to be processed by

412
00:17:10,919 --> 00:17:14,939
the Beyond Sears and you're in so

413
00:17:14,939 --> 00:17:16,740
no big deal right

414
00:17:16,740 --> 00:17:20,400
wait but what was that dialogue box so

415
00:17:20,400 --> 00:17:22,740
if another user is plugged into the same

416
00:17:22,740 --> 00:17:25,260
account that we want to access the web

417
00:17:25,260 --> 00:17:27,540
application asks if we want to overwrite

418
00:17:27,540 --> 00:17:28,620
that session

419
00:17:28,620 --> 00:17:31,440
and this is implemented via an

420
00:17:31,440 --> 00:17:34,380
authenticated post request to API kill

421
00:17:34,380 --> 00:17:37,440
duplicate user as a matter of fact you

422
00:17:37,440 --> 00:17:39,720
can see the Q session ID cookie in the

423
00:17:39,720 --> 00:17:41,640
request so

424
00:17:41,640 --> 00:17:44,340
my eyes this looked exactly like one of

425
00:17:44,340 --> 00:17:46,620
those boring components that nobody does

426
00:17:46,620 --> 00:17:50,400
because you know it's a dialog box what

427
00:17:50,400 --> 00:17:52,620
could possibly go wrong with it

428
00:17:52,620 --> 00:17:56,220
what let's find out so if you record

429
00:17:56,220 --> 00:17:58,440
from a previous slide a map identified

430
00:17:58,440 --> 00:18:00,360
the server running on the device as a

431
00:18:00,360 --> 00:18:03,559
light tpd and I look at the com file

432
00:18:03,559 --> 00:18:06,720
reveal that request to API are handled

433
00:18:06,720 --> 00:18:10,080
by this SPX service this binary that is

434
00:18:10,080 --> 00:18:12,419
responsible for all API there are

435
00:18:12,419 --> 00:18:15,780
interactions and the kill duplicate user

436
00:18:15,780 --> 00:18:18,600
Handler is registered by the misfunction

437
00:18:18,600 --> 00:18:20,640
that is called during domain

438
00:18:20,640 --> 00:18:24,179
and this is how the compile function

439
00:18:24,179 --> 00:18:25,700
begins

440
00:18:25,700 --> 00:18:28,740
and well but

441
00:18:28,740 --> 00:18:31,620
where are the authentication checks

442
00:18:31,620 --> 00:18:34,500
so although the post request contains

443
00:18:34,500 --> 00:18:37,140
accusations the kill duplicate user does

444
00:18:37,140 --> 00:18:39,419
not validate it and you can clearly see

445
00:18:39,419 --> 00:18:41,820
it by comparing this function with

446
00:18:41,820 --> 00:18:43,679
others that are defined the binary what

447
00:18:43,679 --> 00:18:45,660
both checks on the session cook as well

448
00:18:45,660 --> 00:18:48,480
as in the anti-scissor token are present

449
00:18:48,480 --> 00:18:51,120
I mean this already means that not

450
00:18:51,120 --> 00:18:53,100
indicated that attacker can perform

451
00:18:53,100 --> 00:18:55,320
technology service attacks just and

452
00:18:55,320 --> 00:18:58,559
biometric emulating sessions

453
00:18:58,559 --> 00:19:02,580
but wait that's more so this is how the

454
00:19:02,580 --> 00:19:07,140
function continues and I will post here

455
00:19:07,140 --> 00:19:10,500
um let's look at it for a few seconds

456
00:19:10,500 --> 00:19:13,200
I hope that you are able to read the

457
00:19:13,200 --> 00:19:14,520
call

458
00:19:14,520 --> 00:19:18,179
um await some other second four three

459
00:19:18,179 --> 00:19:20,400
two one

460
00:19:20,400 --> 00:19:25,700
before showing you this so oh my

461
00:19:25,740 --> 00:19:28,260
so the function for Star locates The

462
00:19:28,260 --> 00:19:30,660
Limited size buffer on the stack and you

463
00:19:30,660 --> 00:19:33,360
know what I'm going and then copies in

464
00:19:33,360 --> 00:19:35,640
that buffer an abundant user

465
00:19:35,640 --> 00:19:37,740
controllable input that is the username

466
00:19:37,740 --> 00:19:40,919
parameter and by itself this is already

467
00:19:40,919 --> 00:19:42,600
an authenticated that's the previous

468
00:19:42,600 --> 00:19:44,520
vulnerability stack based buffer

469
00:19:44,520 --> 00:19:47,220
overflow even in a poorly 45 binary of

470
00:19:47,220 --> 00:19:48,240
course we

471
00:19:48,240 --> 00:19:51,179
but of course you have spotted the

472
00:19:51,179 --> 00:19:53,280
common injection point there it is just

473
00:19:53,280 --> 00:19:55,440
now a matter of understanding how safe

474
00:19:55,440 --> 00:19:59,640
this curiously called safe system is and

475
00:19:59,640 --> 00:20:02,820
what this function is implemented in the

476
00:20:02,820 --> 00:20:05,220
lip set system shot object and

477
00:20:05,220 --> 00:20:06,960
apparently the only Security check is

478
00:20:06,960 --> 00:20:09,299
done on the length of the string and by

479
00:20:09,299 --> 00:20:11,580
this curious the name um Chuck buffer

480
00:20:11,580 --> 00:20:14,760
overflow function so no common injector

481
00:20:14,760 --> 00:20:17,419
specific validations are done

482
00:20:17,419 --> 00:20:20,940
finally to make everything worse all

483
00:20:20,940 --> 00:20:23,340
processes run as root on the device

484
00:20:23,340 --> 00:20:26,820
so in short by chaining all these

485
00:20:26,820 --> 00:20:29,039
vulnerabilities misconfiguration some

486
00:20:29,039 --> 00:20:31,860
failures and unauthenticated root remote

487
00:20:31,860 --> 00:20:34,799
code execution can be obtained

488
00:20:34,799 --> 00:20:36,900
all of this because of a better

489
00:20:36,900 --> 00:20:40,460
programming confirmation dialog

490
00:20:40,980 --> 00:20:42,660
now

491
00:20:42,660 --> 00:20:45,600
so we have compromised the Beyonce the

492
00:20:45,600 --> 00:20:48,000
next step is to compromise the host and

493
00:20:48,000 --> 00:20:50,039
there are many ways to do that

494
00:20:50,039 --> 00:20:52,140
so the simplest one is by abusing the

495
00:20:52,140 --> 00:20:55,620
kvr VNC service so as we have the

496
00:20:55,620 --> 00:20:57,840
possibility to mount remote CD devices

497
00:20:57,840 --> 00:20:59,640
and interact with the host during the

498
00:20:59,640 --> 00:21:02,039
bootstrap we can easily boot from a live

499
00:21:02,039 --> 00:21:04,440
distribution and do arbitrary operations

500
00:21:04,440 --> 00:21:06,539
on the hard drive for instance rate fast

501
00:21:06,539 --> 00:21:09,059
by past the lock screen at Barber

502
00:21:09,059 --> 00:21:10,700
basically you name it at this point

503
00:21:10,700 --> 00:21:14,220
however this requires a reboot and the

504
00:21:14,220 --> 00:21:18,860
HTTP to be unencrypted right well

505
00:21:20,360 --> 00:21:22,860
can be bypassed as well

506
00:21:22,860 --> 00:21:25,320
so here I've included a screenshot of

507
00:21:25,320 --> 00:21:27,120
this proof of concept developed for the

508
00:21:27,120 --> 00:21:30,240
hpilo that Max Plus in the dark memory

509
00:21:30,240 --> 00:21:32,460
access and some volatility code

510
00:21:32,460 --> 00:21:34,380
it allows to lock the windows preset

511
00:21:34,380 --> 00:21:36,720
Direct on memory

512
00:21:36,720 --> 00:21:38,880
now for the sake of this presentation I

513
00:21:38,880 --> 00:21:40,440
will show how this can be done using the

514
00:21:40,440 --> 00:21:42,539
KVM as this approach could be external

515
00:21:42,539 --> 00:21:43,380
land

516
00:21:43,380 --> 00:21:46,380
and to boost the KVM service it is first

517
00:21:46,380 --> 00:21:48,000
and necessary to understand how sessions

518
00:21:48,000 --> 00:21:50,039
are generated

519
00:21:50,039 --> 00:21:52,500
um that's the extra service makes use of

520
00:21:52,500 --> 00:21:54,419
libq decoder for the session management

521
00:21:54,419 --> 00:21:56,760
and you can see here for instance in the

522
00:21:56,760 --> 00:21:59,100
log game function uh the call to the

523
00:21:59,100 --> 00:22:02,640
queue suggests as save function and the

524
00:22:02,640 --> 00:22:04,980
lipicu decoder simply creates two files

525
00:22:04,980 --> 00:22:07,200
that are called dot properties on dot X

526
00:22:07,200 --> 00:22:09,780
bar with the name of the session ID that

527
00:22:09,780 --> 00:22:11,460
has been temporarily generated for that

528
00:22:11,460 --> 00:22:14,400
session and those by defaults are stored

529
00:22:14,400 --> 00:22:17,820
in the thumb folder of Linux so crafting

530
00:22:17,820 --> 00:22:20,100
a session is simply a matter of writing

531
00:22:20,100 --> 00:22:22,919
a new file following the same format and

532
00:22:22,919 --> 00:22:25,140
this allows to bypass the login process

533
00:22:25,140 --> 00:22:27,539
and access the web application with

534
00:22:27,539 --> 00:22:29,520
admin privileges

535
00:22:29,520 --> 00:22:32,280
so it's now possible to exchange this

536
00:22:32,280 --> 00:22:34,620
crafted session cookie for a valid KVM

537
00:22:34,620 --> 00:22:37,440
token so here you can see a request or

538
00:22:37,440 --> 00:22:39,659
for sure the cookie and the scissorf

539
00:22:39,659 --> 00:22:41,520
token have not been generated by the web

540
00:22:41,520 --> 00:22:44,400
application but in exchange for those we

541
00:22:44,400 --> 00:22:48,600
got a very very valid KVM token

542
00:22:48,600 --> 00:22:51,780
now KVM access is granted and the good

543
00:22:51,780 --> 00:22:54,600
trick of swapping the 70 with the

544
00:22:54,600 --> 00:22:56,100
ultimate by pass the Windows login

545
00:22:56,100 --> 00:22:57,720
screen still works

546
00:22:57,720 --> 00:23:00,120
so we can now have full control on the

547
00:23:00,120 --> 00:23:04,520
host and access the device as well

548
00:23:05,280 --> 00:23:07,500
Okay so

549
00:23:07,500 --> 00:23:09,120
we have talked about the possible attack

550
00:23:09,120 --> 00:23:11,220
chain that an attacker can abuse to

551
00:23:11,220 --> 00:23:13,200
compromise the Beyonce and we have

552
00:23:13,200 --> 00:23:15,720
discussed how to jump from the BNC

553
00:23:15,720 --> 00:23:18,600
directly to the host itself

554
00:23:18,600 --> 00:23:21,840
now let's pack everything together and

555
00:23:21,840 --> 00:23:24,179
show how an attacker starting from an IT

556
00:23:24,179 --> 00:23:26,340
Network can disrupt an industrial

557
00:23:26,340 --> 00:23:28,620
process in this demo that features our

558
00:23:28,620 --> 00:23:32,658
production line replica in our lab

559
00:23:33,419 --> 00:23:36,900
so here is our production line demo that

560
00:23:36,900 --> 00:23:39,120
is a faithful replica of reproduction

561
00:23:39,120 --> 00:23:40,140
lines

562
00:23:40,140 --> 00:23:42,960
and as you can see there are four cable

563
00:23:42,960 --> 00:23:45,840
boxes spinning on a plate that is being

564
00:23:45,840 --> 00:23:47,940
basically rotated by an electric motor

565
00:23:47,940 --> 00:23:50,220
that is commanded by a required

566
00:23:50,220 --> 00:23:51,240
controller

567
00:23:51,240 --> 00:23:53,940
so on each box there is the barcode tag

568
00:23:53,940 --> 00:23:55,860
then you have this production line

569
00:23:55,860 --> 00:23:57,539
replicas that the controller

570
00:23:57,539 --> 00:23:59,400
communicates with the bucket reader on

571
00:23:59,400 --> 00:24:02,280
the right with the backup tag on the

572
00:24:02,280 --> 00:24:04,740
card but if it is correctly red it makes

573
00:24:04,740 --> 00:24:06,539
the motor spin to proceed to the next

574
00:24:06,539 --> 00:24:07,860
one

575
00:24:07,860 --> 00:24:10,679
on the left you can see the laner and

576
00:24:10,679 --> 00:24:13,740
ca5220 always install the engineering

577
00:24:13,740 --> 00:24:16,440
software that programs the controller so

578
00:24:16,440 --> 00:24:19,260
there are two interfaces I will consider

579
00:24:19,260 --> 00:24:21,900
to cables there so one is the Beyonce

580
00:24:21,900 --> 00:24:25,200
interface that is connected to this mock

581
00:24:25,200 --> 00:24:27,900
level 4 it management Network and the

582
00:24:27,900 --> 00:24:29,880
other is the host interface that is

583
00:24:29,880 --> 00:24:32,340
connected to the level 2 process Network

584
00:24:32,340 --> 00:24:35,760
so in our scenario we will pose as

585
00:24:35,760 --> 00:24:37,860
attackers that are on the it management

586
00:24:37,860 --> 00:24:40,440
Network and want to ultimately disrupt

587
00:24:40,440 --> 00:24:42,860
this process

588
00:24:42,960 --> 00:24:44,820
we are now seeing the web interface of

589
00:24:44,820 --> 00:24:47,100
this beyonc uh we attempt to login with

590
00:24:47,100 --> 00:24:49,860
the hexer credentials but of course this

591
00:24:49,860 --> 00:24:51,600
does not work we don't notice

592
00:24:51,600 --> 00:24:54,720
credentials however we know that the BNC

593
00:24:54,720 --> 00:24:57,780
is affected by these vulnerabilities and

594
00:24:57,780 --> 00:24:59,700
we have developed an expert proof of

595
00:24:59,700 --> 00:25:01,620
concept that combines exactly the chain

596
00:25:01,620 --> 00:25:03,360
described before and as you can see our

597
00:25:03,360 --> 00:25:05,820
exploit requires only two parameters our

598
00:25:05,820 --> 00:25:08,460
IP address and the remote tag

599
00:25:08,460 --> 00:25:12,600
so let's launch this ax plate and

600
00:25:12,600 --> 00:25:14,820
let's suppose here and command 1 to

601
00:25:14,820 --> 00:25:17,159
exploit us has done so the goal of the

602
00:25:17,159 --> 00:25:19,020
expert is to bypass the login screen by

603
00:25:19,020 --> 00:25:21,480
crafting a new session and this request

604
00:25:21,480 --> 00:25:23,640
right in the properties file and the

605
00:25:23,640 --> 00:25:26,100
x-bar file the right of the properties

606
00:25:26,100 --> 00:25:28,140
file is done in three steps due to those

607
00:25:28,140 --> 00:25:29,820
land limitations that we were talking

608
00:25:29,820 --> 00:25:31,980
about when we talked about the safe

609
00:25:31,980 --> 00:25:34,559
system and at the end the expert

610
00:25:34,559 --> 00:25:37,140
verifies it has succeeded and if so

611
00:25:37,140 --> 00:25:40,080
prints out the HTTP response that the

612
00:25:40,080 --> 00:25:42,299
attacker needs to use replacing the

613
00:25:42,299 --> 00:25:44,700
legitimate one this makes the

614
00:25:44,700 --> 00:25:46,860
client-side JavaScript code on the

615
00:25:46,860 --> 00:25:48,539
application that is running on the

616
00:25:48,539 --> 00:25:51,240
browser of the attacker process the

617
00:25:51,240 --> 00:25:53,159
crafted session cooking as well as the

618
00:25:53,159 --> 00:25:55,260
anti-c surf token that were generated

619
00:25:55,260 --> 00:25:58,679
for this crafted session so what we're

620
00:25:58,679 --> 00:26:00,720
doing now basically we are selecting

621
00:26:00,720 --> 00:26:03,539
this HTTP response

622
00:26:03,539 --> 00:26:06,240
okay let's copy it and now we go back to

623
00:26:06,240 --> 00:26:09,480
the our web interface we intercept this

624
00:26:09,480 --> 00:26:12,480
login request we also intercept the

625
00:26:12,480 --> 00:26:15,299
response and we replace this response

626
00:26:15,299 --> 00:26:17,039
with the one that has been generated by

627
00:26:17,039 --> 00:26:20,039
our our exploit code that has of course

628
00:26:20,039 --> 00:26:21,720
previously generated the recession on

629
00:26:21,720 --> 00:26:23,760
the server and as you can see we were

630
00:26:23,760 --> 00:26:26,940
able to completely bypass this login web

631
00:26:26,940 --> 00:26:30,960
page now having done that we go straight

632
00:26:30,960 --> 00:26:33,120
to the remote control functionality of

633
00:26:33,120 --> 00:26:34,440
this Beyonce

634
00:26:34,440 --> 00:26:37,440
and you can see that here true simply a

635
00:26:37,440 --> 00:26:39,299
web browser we are able to directly

636
00:26:39,299 --> 00:26:42,179
interact with the remote server now

637
00:26:42,179 --> 00:26:43,740
we're created by the Windows login

638
00:26:43,740 --> 00:26:45,360
screen of course we don't know those

639
00:26:45,360 --> 00:26:47,760
credentials because our attackers we

640
00:26:47,760 --> 00:26:49,620
don't know this particular profile but

641
00:26:49,620 --> 00:26:51,840
still we can mountainize the image so we

642
00:26:51,840 --> 00:26:53,640
will Mount the zombies image of whatever

643
00:26:53,640 --> 00:26:56,700
Linux distribution and we will start the

644
00:26:56,700 --> 00:27:00,900
host and as soon as it starts we start

645
00:27:00,900 --> 00:27:02,100
the media

646
00:27:02,100 --> 00:27:04,320
now as you can see we are seeing the

647
00:27:04,320 --> 00:27:06,600
bootstrap live that is what I was

648
00:27:06,600 --> 00:27:08,820
anticipating before with the BNC we can

649
00:27:08,820 --> 00:27:11,880
into the setup and so what we simply do

650
00:27:11,880 --> 00:27:13,860
at this point is just change the boot

651
00:27:13,860 --> 00:27:16,260
order to boot from our ISO image and as

652
00:27:16,260 --> 00:27:17,940
you can see the BIOS since the size of

653
00:27:17,940 --> 00:27:20,100
image as if it were directly connected

654
00:27:20,100 --> 00:27:21,740
to the host itself

655
00:27:21,740 --> 00:27:25,320
and here we are doing the boot of our

656
00:27:25,320 --> 00:27:27,960
the Linux distribution that we have

657
00:27:27,960 --> 00:27:30,360
decided to use for this specific case

658
00:27:30,360 --> 00:27:31,980
and

659
00:27:31,980 --> 00:27:35,220
let's wait some seconds so that it loads

660
00:27:35,220 --> 00:27:37,140
so we are still doing all the steps to

661
00:27:37,140 --> 00:27:40,080
the web to a web interface that as you

662
00:27:40,080 --> 00:27:41,520
can see provides keyboard and mouse

663
00:27:41,520 --> 00:27:43,020
interaction whatever

664
00:27:43,020 --> 00:27:46,200
now what having done the boot we simply

665
00:27:46,200 --> 00:27:49,140
go to the storage of this device we go

666
00:27:49,140 --> 00:27:51,419
to the windows folder to the system32

667
00:27:51,419 --> 00:27:52,320
folder

668
00:27:52,320 --> 00:27:55,679
here we are and we open a commander

669
00:27:55,679 --> 00:27:59,400
commercial there m what we simply do is

670
00:27:59,400 --> 00:28:02,520
override the utilman.x that is the

671
00:28:02,520 --> 00:28:04,140
service on Windows that provides

672
00:28:04,140 --> 00:28:06,659
accessibility functionalities and a

673
00:28:06,659 --> 00:28:08,940
transit system in case you didn't know

674
00:28:08,940 --> 00:28:12,440
that and we replace it with this classic

675
00:28:12,440 --> 00:28:14,760
CMD or Windows

676
00:28:14,760 --> 00:28:17,340
so having done this step where you

677
00:28:17,340 --> 00:28:19,799
simply stop reboot our system we stop

678
00:28:19,799 --> 00:28:21,960
the media so that in the at the next

679
00:28:21,960 --> 00:28:24,659
boot the Windows system comes out

680
00:28:24,659 --> 00:28:27,419
we wait for a few seconds and here we

681
00:28:27,419 --> 00:28:29,400
are greeted by the login screen on

682
00:28:29,400 --> 00:28:30,539
windows but now if we press

683
00:28:30,539 --> 00:28:33,919
accessibility button of Windows we can

684
00:28:33,919 --> 00:28:36,360
obtain a system shell on the device

685
00:28:36,360 --> 00:28:39,059
itself so now the bypass well this is

686
00:28:39,059 --> 00:28:40,740
just one of the possibilities of that we

687
00:28:40,740 --> 00:28:42,299
could have downloaded already gasoline

688
00:28:42,299 --> 00:28:44,039
amount of things which is just a way to

689
00:28:44,039 --> 00:28:46,380
compromise the host so we create a new

690
00:28:46,380 --> 00:28:49,860
hackster user a vector user on this

691
00:28:49,860 --> 00:28:53,039
device nah we just attempt to login on

692
00:28:53,039 --> 00:28:54,659
this user

693
00:28:54,659 --> 00:28:56,460
oh no we are not interested in that

694
00:28:56,460 --> 00:28:58,320
thank you Windows okay so let's keep

695
00:28:58,320 --> 00:29:02,279
this part and now that we have obtained

696
00:29:02,279 --> 00:29:05,220
complete control of the windows user

697
00:29:05,220 --> 00:29:08,039
interface what we do is that we launch

698
00:29:08,039 --> 00:29:10,380
the Rockwell software the engineering

699
00:29:10,380 --> 00:29:12,720
software that allows to program the Roku

700
00:29:12,720 --> 00:29:14,460
controller

701
00:29:14,460 --> 00:29:18,299
so some seconds in order to allow him to

702
00:29:18,299 --> 00:29:19,919
boot up

703
00:29:19,919 --> 00:29:24,000
and okay so here it is we do need to

704
00:29:24,000 --> 00:29:26,580
press the go online button because in

705
00:29:26,580 --> 00:29:28,620
this way we can directly communicate

706
00:29:28,620 --> 00:29:32,340
with the safety PLC of this demo so we

707
00:29:32,340 --> 00:29:33,600
press the go online

708
00:29:33,600 --> 00:29:36,559
wait for seconds okay we are now online

709
00:29:36,559 --> 00:29:39,659
and what we want to do now is we go to

710
00:29:39,659 --> 00:29:41,820
the motor access we issue motion direct

711
00:29:41,820 --> 00:29:44,760
command and the idea is to issue a

712
00:29:44,760 --> 00:29:47,159
command the safety plus C that overrides

713
00:29:47,159 --> 00:29:50,039
the current program that is being run by

714
00:29:50,039 --> 00:29:52,860
the that's 50 PLC so we decided to use a

715
00:29:52,860 --> 00:29:55,679
specific set of settings and at the end

716
00:29:55,679 --> 00:29:58,020
we press the execute button and let's

717
00:29:58,020 --> 00:30:00,559
see what happened

718
00:30:01,140 --> 00:30:03,840
and definitely it's not stopping the

719
00:30:03,840 --> 00:30:06,360
Affinity is not stopping and let's wait

720
00:30:06,360 --> 00:30:09,960
a few seconds so here we are so

721
00:30:09,960 --> 00:30:12,539
as you can see we were on the it

722
00:30:12,539 --> 00:30:14,220
management Network and we ultimately

723
00:30:14,220 --> 00:30:16,320
were about thanks to this chain of

724
00:30:16,320 --> 00:30:17,580
vulnerabilities

725
00:30:17,580 --> 00:30:20,399
to disrupt this industrial process

726
00:30:20,399 --> 00:30:22,559
um this exact demo is still displayfully

727
00:30:22,559 --> 00:30:24,059
functional at our boot so if you have

728
00:30:24,059 --> 00:30:26,399
some time please come and say hi and we

729
00:30:26,399 --> 00:30:28,200
will produce this attack live for you

730
00:30:28,200 --> 00:30:29,940
again

731
00:30:29,940 --> 00:30:31,260
okay

732
00:30:31,260 --> 00:30:33,960
so we are near the end of this

733
00:30:33,960 --> 00:30:37,260
presentation so let's conclude it with

734
00:30:37,260 --> 00:30:41,899
with a summary and some key takeaways

735
00:30:41,940 --> 00:30:45,480
um so first off the Purdue model is

736
00:30:45,480 --> 00:30:47,640
still vastly adopted as a noticeable

737
00:30:47,640 --> 00:30:50,100
security pillar although it definitely

738
00:30:50,100 --> 00:30:52,440
starts showing sprinkles as you have

739
00:30:52,440 --> 00:30:55,020
seen so besides being a button manuality

740
00:30:55,020 --> 00:30:58,020
devices bmcs are rapidly getting popular

741
00:30:58,020 --> 00:31:01,919
also in the OT and iot sector

742
00:31:01,919 --> 00:31:03,600
um we have rebuilt the team

743
00:31:03,600 --> 00:31:05,940
vulnerabilities affecting the BNC

744
00:31:05,940 --> 00:31:08,520
firmware of OT and iot devices but

745
00:31:08,520 --> 00:31:11,039
others are yet to be disclosed and we

746
00:31:11,039 --> 00:31:12,840
have demonstrated that by chaining all

747
00:31:12,840 --> 00:31:14,880
this Bernardo that has misconfiguration

748
00:31:14,880 --> 00:31:17,340
some failures it is possible to

749
00:31:17,340 --> 00:31:19,620
compromise the Beyonce and the manage

750
00:31:19,620 --> 00:31:22,799
those jumping from it to OT networks

751
00:31:22,799 --> 00:31:26,299
you've just seen it in the demo

752
00:31:26,299 --> 00:31:29,460
to end this presentation here are some

753
00:31:29,460 --> 00:31:31,919
actionable takeaways that I want all of

754
00:31:31,919 --> 00:31:34,140
you to remember and apply from now on

755
00:31:34,140 --> 00:31:36,299
your telework activities especially if

756
00:31:36,299 --> 00:31:38,399
you work with this kind of devices

757
00:31:38,399 --> 00:31:39,720
so

758
00:31:39,720 --> 00:31:42,360
with increasing connectivity of OT

759
00:31:42,360 --> 00:31:44,880
devices new risk-based cyber security

760
00:31:44,880 --> 00:31:48,000
standards need to be adopted

761
00:31:48,000 --> 00:31:50,520
um the puju model used as a cyber

762
00:31:50,520 --> 00:31:52,860
security references more and more unable

763
00:31:52,860 --> 00:31:55,020
to keep up with increasing connectivity

764
00:31:55,020 --> 00:31:59,179
of OT devices models such as the ISC

765
00:31:59,179 --> 00:32:02,220
62443 that are instead are risk-based

766
00:32:02,220 --> 00:32:04,380
are much better now at managing the

767
00:32:04,380 --> 00:32:06,659
security of newer and more complex

768
00:32:06,659 --> 00:32:08,640
systems

769
00:32:08,640 --> 00:32:11,039
care must be applied while porting

770
00:32:11,039 --> 00:32:13,320
Solutions designed for the I.T domain

771
00:32:13,320 --> 00:32:15,960
into OT environments as the requirements

772
00:32:15,960 --> 00:32:17,399
greatly differ

773
00:32:17,399 --> 00:32:19,919
as you all remembered the risk is the

774
00:32:19,919 --> 00:32:21,240
product of the likelihood with the

775
00:32:21,240 --> 00:32:23,340
impact and if the likelihood is arguable

776
00:32:23,340 --> 00:32:25,320
because it also depends on external

777
00:32:25,320 --> 00:32:27,899
threats the impact for sure is going to

778
00:32:27,899 --> 00:32:29,940
increase what during the jump from it to

779
00:32:29,940 --> 00:32:31,440
OT simply because of the safety

780
00:32:31,440 --> 00:32:34,140
Dimension attack so notice systems have

781
00:32:34,140 --> 00:32:36,960
physical effects on humans and on the

782
00:32:36,960 --> 00:32:39,299
environment and as such require much

783
00:32:39,299 --> 00:32:41,220
stricter security requirements to keep

784
00:32:41,220 --> 00:32:43,200
the risk manageable

785
00:32:43,200 --> 00:32:46,020
and finally an evergreen

786
00:32:46,020 --> 00:32:48,240
there are attack Surfers that are little

787
00:32:48,240 --> 00:32:50,580
understood but that have significant

788
00:32:50,580 --> 00:32:53,460
consequences if compromised

789
00:32:53,460 --> 00:32:55,980
presentation demonstrates once again

790
00:32:55,980 --> 00:32:58,559
that it is important to evaluate the

791
00:32:58,559 --> 00:33:01,620
entire attack surface and never Focus

792
00:33:01,620 --> 00:33:04,200
only on specific Parts overlooking

793
00:33:04,200 --> 00:33:05,100
others

794
00:33:05,100 --> 00:33:06,960
you could have applied the strictest

795
00:33:06,960 --> 00:33:09,539
security measures ever on the host

796
00:33:09,539 --> 00:33:11,640
but this would have been completely

797
00:33:11,640 --> 00:33:14,700
useless due to a tiny chip embedded in

798
00:33:14,700 --> 00:33:17,100
your motherboard that maybe you did not

799
00:33:17,100 --> 00:33:19,679
even know it existed everything is

800
00:33:19,679 --> 00:33:21,179
important in security

801
00:33:21,179 --> 00:33:22,810
so thank you

802
00:33:22,810 --> 00:33:27,480
[Applause]

803
00:33:27,480 --> 00:33:33,769
[Music]

